' ==========================================================================
'  システム名       :  LM
'  サブシステム名   :  LMC       : 出荷管理
'  プログラムID     :  LMC010    : 出荷データ検索
'  作  成  者       :  [金ヘスル]:
' ==========================================================================
Imports System.Text
Imports System.Data.SqlClient
Imports Jp.Co.Nrs.Com.Const
Imports Jp.Co.Nrs.LM.Const
Imports System.Reflection

''' <summary>
''' LMC010DACクラス
''' </summary>
''' <remarks></remarks>
Public Class LMC010DAC
    Inherits Jp.Co.Nrs.LM.Base.DAC.LMBaseDAC

#Region "Const"


#Region "検索処理 SQL"

    ''' <summary>
    ''' カウント用
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_SELECT_COUNT As String = " SELECT COUNT(C_OUTKA_L.OUTKA_NO_L)		            AS SELECT_CNT       " & vbNewLine

    'START YANAI メモ②No.2
    'Private Const SQL_SELECT_DATA As String = " SELECT                                                                      " & vbNewLine _
    '                                        & " C_OUTKA_L.CUST_ORD_NO                               AS CUST_ORD_NO  " & vbNewLine _
    '                                        & ",Z1.KBN_NM1                                          AS OUTKA_STATE_KB_NM    " & vbNewLine _
    '                                        & ",C_OUTKA_L.OUTKA_PLAN_DATE                           AS OUTKA_PLAN_DATE	    " & vbNewLine _
    '                                        & ",C_OUTKA_L.ARR_PLAN_DATE                             AS ARR_PLAN_DATE	    " & vbNewLine _
    '                                        & ",M_CUST.CUST_NM_L + '　' + M_CUST.CUST_NM_M          AS CUST_NM              " & vbNewLine _
    '                                        & ",CASE WHEN C_OUTKA_L.DEST_KB = '00' THEN M_DEST.DEST_NM                      " & vbNewLine _
    '                                        & " ELSE C_OUTKA_L.DEST_NM                                                      " & vbNewLine _
    '                                        & " END AS DEST_NM                                                              " & vbNewLine _
    '                                        & ",M_GOODS.GOODS_NM_1                                  AS GOODS_NM	            " & vbNewLine _
    '                                        & ",C_OUTKA_L.OUTKA_PKG_NB                              AS OUTKA_PKG_NB 	    " & vbNewLine _
    '                                        & ",C_OUTKA_M.OUTKA_TTL_NB                              AS OUTKA_TTL_NB         " & vbNewLine _
    '                                        & ",C_OUTKA_M.BACKLOG_NB                                AS BACKLOG_NB           " & vbNewLine _
    '                                        & ",C_OUTKA_M.BACKLOG_QT                                AS BACKLOG_QT           " & vbNewLine _
    '                                        & ",CASE WHEN C_OUTKA_L.DEST_KB = '00' THEN M_DEST.AD_1                         " & vbNewLine _
    '                                        & " ELSE C_OUTKA_L.DEST_AD_1                                                    " & vbNewLine _
    '                                        & " END AS DEST_AD                                                              " & vbNewLine _
    '                                        & ",C_OUTKA_L.DENP_NO                                   AS DENP_NO 	            " & vbNewLine _
    '                                        & ",M_UNSOCO.UNSOCO_NM + '　' + M_UNSOCO.UNSOCO_BR_NM   AS UNSOCO_NM	        " & vbNewLine _
    '                                        & ",ISNULL(MCNT.M_COUNT,0)                              AS M_COUNT	            " & vbNewLine _
    '                                        & ",ISNULL(SCNT.S_COUNT,0)                              AS S_COUNT	            " & vbNewLine _
    '                                        & ",C_OUTKA_L.OUTKA_NO_L                                AS OUTKA_NO_L	        " & vbNewLine _
    '                                        & ",Z2.KBN_NM1                                          AS SYUBETU_KB_NM        " & vbNewLine _
    '                                        & ",M_SOKO.WH_NM                                        AS WH_NM	            " & vbNewLine _
    '                                        & ",M_NRS_BR.NRS_BR_NM                                  AS NRS_BR_NM	        " & vbNewLine _
    '                                        & ",TANTO_USER.USER_NM                                  AS TANTO_USER	        " & vbNewLine _
    '                                        & ",ENT_USER.USER_NM                                    AS SYS_ENT_USER         " & vbNewLine _
    '                                        & ",UPD_USER.USER_NM                                    AS SYS_UPD_USER         " & vbNewLine _
    '                                        & ",C_OUTKA_L.LAST_PRINT_DATE                           AS LAST_PRINT_DATE      " & vbNewLine _
    '                                        & ",C_OUTKA_L.LAST_PRINT_TIME                           AS LAST_PRINT_TIME      " & vbNewLine _
    '                                        & ",C_OUTKA_L.SYS_UPD_DATE                              AS SYS_UPD_DATE         " & vbNewLine _
    '                                        & ",C_OUTKA_L.SYS_UPD_TIME                              AS SYS_UPD_TIME         " & vbNewLine _
    '                                        & ",C_OUTKA_L.NRS_BR_CD                                 AS NRS_BR_CD            " & vbNewLine _
    '                                        & ",C_OUTKA_L.WH_CD                                     AS WH_CD                " & vbNewLine _
    '                                        & ",C_OUTKA_L.PICK_KB                                   AS PICK_KB              " & vbNewLine _
    '                                        & ",M_SOKO.OUTKA_SASHIZU_PRT_YN                         AS OUTKA_SASHIZU_PRT_YN " & vbNewLine _
    '                                        & ",M_SOKO.OUTOKA_KANRYO_YN                             AS OUTOKA_KANRYO_YN     " & vbNewLine _
    '                                        & ",M_SOKO.OUTKA_KENPIN_YN                              AS OUTKA_KENPIN_YN      " & vbNewLine _
    '                                        & ",C_OUTKA_L.CUST_CD_L                                 AS CUST_CD_L            " & vbNewLine _
    '                                        & ",C_OUTKA_L.CUST_CD_M                                 AS CUST_CD_M            " & vbNewLine _
    '                                        & ",C_OUTKA_M_MIN.GOODS_CD_NRS                          AS GOODS_CD_NRS         " & vbNewLine _
    '                                        & ",C_OUTKA_L.DEST_CD                                   AS DEST_CD              " & vbNewLine _
    '                                        & ",C_OUTKA_L.OUTKA_STATE_KB                            AS OUTKA_STATE_KB       " & vbNewLine _
    '                                        & ",F_UNSO_L.UNSO_CD                                    AS UNSO_CD              " & vbNewLine _
    '                                        & ",F_UNSO_L.UNSO_BR_CD                                 AS UNSO_BR_CD           " & vbNewLine _
    '                                        & ",F_UNSO_L.UNSO_NO_L                                  AS UNSO_NO_L            " & vbNewLine _
    '                                        & ",F_UNSO_L.SYS_UPD_DATE                               AS UNSO_SYS_UPD_DATE    " & vbNewLine _
    '                                        & ",F_UNSO_L.SYS_UPD_TIME                               AS UNSO_SYS_UPD_TIME    " & vbNewLine _
    '                                        & ",C_OUTKA_M_MIN.LOT_NO                                AS LOT_NO               " & vbNewLine _
    '                                        & ",F_UNCHIN_TRS.SEIQ_FIXED_FLAG                        AS SEIQ_FIXED_FLAG      " & vbNewLine _
    '                                        & ",C_OUTKA_L.FURI_NO                                   AS FURI_NO              " & vbNewLine _
    '                                        & ",M_UNSOCO.NIHUDA_YN                                  AS NIHUDA_YN            " & vbNewLine _
    'START YANAI 要望番号748
    '''' <summary>
    '''' C_OUTKA_Lデータ抽出用
    '''' </summary>
    '''' <remarks></remarks>
    'Private Const SQL_SELECT_DATA As String = " SELECT                                                                      " & vbNewLine _
    '                                            & " C_OUTKA_L.CUST_ORD_NO                               AS CUST_ORD_NO  " & vbNewLine _
    '                                            & ",Z1.KBN_NM1                                          AS OUTKA_STATE_KB_NM    " & vbNewLine _
    '                                            & ",C_OUTKA_L.OUTKA_PLAN_DATE                           AS OUTKA_PLAN_DATE	    " & vbNewLine _
    '                                            & ",C_OUTKA_L.ARR_PLAN_DATE                             AS ARR_PLAN_DATE	    " & vbNewLine _
    '                                            & ",M_CUST.CUST_NM_L + '　' + M_CUST.CUST_NM_M          AS CUST_NM              " & vbNewLine _
    '                                            & ",CASE WHEN C_OUTKA_L.DEST_KB = '00' THEN M_DEST.DEST_NM                      " & vbNewLine _
    '                                            & " ELSE C_OUTKA_L.DEST_NM                                                      " & vbNewLine _
    '                                            & " END AS DEST_NM                                                              " & vbNewLine _
    '                                            & ",M_GOODS.GOODS_NM_1                                  AS GOODS_NM	            " & vbNewLine _
    '                                            & ",C_OUTKA_L.OUTKA_PKG_NB                              AS OUTKA_PKG_NB 	    " & vbNewLine _
    '                                            & ",C_OUTKA_M.OUTKA_TTL_NB                              AS OUTKA_TTL_NB         " & vbNewLine _
    '                                            & ",C_OUTKA_M.BACKLOG_NB                                AS BACKLOG_NB           " & vbNewLine _
    '                                            & ",C_OUTKA_M.BACKLOG_QT                                AS BACKLOG_QT           " & vbNewLine _
    '                                            & ",CASE WHEN C_OUTKA_L.DEST_KB = '00' THEN M_DEST.AD_1                         " & vbNewLine _
    '                                            & " ELSE C_OUTKA_L.DEST_AD_1                                                    " & vbNewLine _
    '                                            & " END AS DEST_AD                                                              " & vbNewLine _
    '                                            & ",C_OUTKA_L.DENP_NO                                   AS DENP_NO 	            " & vbNewLine _
    '                                            & ",M_UNSOCO.UNSOCO_NM + '　' + M_UNSOCO.UNSOCO_BR_NM   AS UNSOCO_NM	        " & vbNewLine _
    '                                            & ",ISNULL(MCNT.M_COUNT,0)                              AS M_COUNT	            " & vbNewLine _
    '                                            & ",ISNULL(SCNT.S_COUNT,0)                              AS S_COUNT	            " & vbNewLine _
    '                                            & ",C_OUTKA_L.OUTKA_NO_L                                AS OUTKA_NO_L	        " & vbNewLine _
    '                                            & ",Z2.KBN_NM1                                          AS SYUBETU_KB_NM        " & vbNewLine _
    '                                            & ",M_SOKO.WH_NM                                        AS WH_NM	            " & vbNewLine _
    '                                            & ",M_NRS_BR.NRS_BR_NM                                  AS NRS_BR_NM	        " & vbNewLine _
    '                                            & ",TANTO_USER.USER_NM                                  AS TANTO_USER	        " & vbNewLine _
    '                                            & ",ENT_USER.USER_NM                                    AS SYS_ENT_USER         " & vbNewLine _
    '                                            & ",UPD_USER.USER_NM                                    AS SYS_UPD_USER         " & vbNewLine _
    '                                            & ",C_OUTKA_L.LAST_PRINT_DATE                           AS LAST_PRINT_DATE      " & vbNewLine _
    '                                            & ",C_OUTKA_L.LAST_PRINT_TIME                           AS LAST_PRINT_TIME      " & vbNewLine _
    '                                            & ",C_OUTKA_L.SYS_UPD_DATE                              AS SYS_UPD_DATE         " & vbNewLine _
    '                                            & ",C_OUTKA_L.SYS_UPD_TIME                              AS SYS_UPD_TIME         " & vbNewLine _
    '                                            & ",C_OUTKA_L.NRS_BR_CD                                 AS NRS_BR_CD            " & vbNewLine _
    '                                            & ",C_OUTKA_L.WH_CD                                     AS WH_CD                " & vbNewLine _
    '                                            & ",C_OUTKA_L.PICK_KB                                   AS PICK_KB              " & vbNewLine _
    '                                            & ",M_SOKO.OUTKA_SASHIZU_PRT_YN                         AS OUTKA_SASHIZU_PRT_YN " & vbNewLine _
    '                                            & ",M_SOKO.OUTOKA_KANRYO_YN                             AS OUTOKA_KANRYO_YN     " & vbNewLine _
    '                                            & ",M_SOKO.OUTKA_KENPIN_YN                              AS OUTKA_KENPIN_YN      " & vbNewLine _
    '                                            & ",C_OUTKA_L.CUST_CD_L                                 AS CUST_CD_L            " & vbNewLine _
    '                                            & ",C_OUTKA_L.CUST_CD_M                                 AS CUST_CD_M            " & vbNewLine _
    '                                            & ",C_OUTKA_M_MIN.GOODS_CD_NRS                          AS GOODS_CD_NRS         " & vbNewLine _
    '                                            & ",C_OUTKA_L.DEST_CD                                   AS DEST_CD              " & vbNewLine _
    '                                            & ",C_OUTKA_L.OUTKA_STATE_KB                            AS OUTKA_STATE_KB       " & vbNewLine _
    '                                            & ",F_UNSO_L.UNSO_CD                                    AS UNSO_CD              " & vbNewLine _
    '                                            & ",F_UNSO_L.UNSO_BR_CD                                 AS UNSO_BR_CD           " & vbNewLine _
    '                                            & ",F_UNSO_L.UNSO_NO_L                                  AS UNSO_NO_L            " & vbNewLine _
    '                                            & ",F_UNSO_L.SYS_UPD_DATE                               AS UNSO_SYS_UPD_DATE    " & vbNewLine _
    '                                            & ",F_UNSO_L.SYS_UPD_TIME                               AS UNSO_SYS_UPD_TIME    " & vbNewLine _
    '                                            & ",C_OUTKA_M_MIN.LOT_NO                                AS LOT_NO               " & vbNewLine _
    '                                            & ",F_UNCHIN_TRS.SEIQ_FIXED_FLAG                        AS SEIQ_FIXED_FLAG      " & vbNewLine _
    '                                            & ",C_OUTKA_L.FURI_NO                                   AS FURI_NO              " & vbNewLine _
    '                                            & ",M_UNSOCO.NIHUDA_YN                                  AS NIHUDA_YN            " & vbNewLine _
    '                                            & ",C_OUTKA_L.SASZ_USER                                 AS SASZ_USER            " & vbNewLine
    'START YANAI 要望番号1158 一覧画面　引当前の出荷で納品書の印刷が出来てしまう
    '''' <summary>
    '''' C_OUTKA_Lデータ抽出用
    '''' </summary>
    '''' <remarks></remarks>
    'Private Const SQL_SELECT_DATA As String = " SELECT                                                                      " & vbNewLine _
    '                                            & " C_OUTKA_L.CUST_ORD_NO                               AS CUST_ORD_NO  " & vbNewLine _
    '                                            & ",Z1.KBN_NM1                                          AS OUTKA_STATE_KB_NM    " & vbNewLine _
    '                                            & ",C_OUTKA_L.OUTKA_PLAN_DATE                           AS OUTKA_PLAN_DATE	    " & vbNewLine _
    '                                            & ",C_OUTKA_L.ARR_PLAN_DATE                             AS ARR_PLAN_DATE	    " & vbNewLine _
    '                                            & ",M_CUST.CUST_NM_L + '　' + M_CUST.CUST_NM_M          AS CUST_NM              " & vbNewLine _
    '                                            & ",M_GOODS.CUST_CD_S                                   AS CUST_CD_S      	    " & vbNewLine _
    '                                            & ",CASE WHEN C_OUTKA_L.DEST_KB = '00' THEN M_DEST.DEST_NM                      " & vbNewLine _
    '                                            & " ELSE C_OUTKA_L.DEST_NM                                                      " & vbNewLine _
    '                                            & " END AS DEST_NM                                                              " & vbNewLine _
    '                                            & ",M_GOODS.GOODS_NM_1                                  AS GOODS_NM	            " & vbNewLine _
    '                                            & ",C_OUTKA_L.OUTKA_PKG_NB                              AS OUTKA_PKG_NB 	    " & vbNewLine _
    '                                            & ",C_OUTKA_M.OUTKA_TTL_NB                              AS OUTKA_TTL_NB         " & vbNewLine _
    '                                            & ",C_OUTKA_M.BACKLOG_NB                                AS BACKLOG_NB           " & vbNewLine _
    '                                            & ",C_OUTKA_M.BACKLOG_QT                                AS BACKLOG_QT           " & vbNewLine _
    '                                            & ",CASE WHEN C_OUTKA_L.DEST_KB = '00' THEN M_DEST.AD_1                         " & vbNewLine _
    '                                            & " ELSE C_OUTKA_L.DEST_AD_1                                                    " & vbNewLine _
    '                                            & " END AS DEST_AD                                                              " & vbNewLine _
    '                                            & ",C_OUTKA_L.DENP_NO                                   AS DENP_NO 	            " & vbNewLine _
    '                                            & ",M_UNSOCO.UNSOCO_NM + '　' + M_UNSOCO.UNSOCO_BR_NM   AS UNSOCO_NM	        " & vbNewLine _
    '                                            & ",ISNULL(MCNT.M_COUNT,0)                              AS M_COUNT	            " & vbNewLine _
    '                                            & ",ISNULL(SCNT.S_COUNT,0)                              AS S_COUNT	            " & vbNewLine _
    '                                            & ",C_OUTKA_L.OUTKA_NO_L                                AS OUTKA_NO_L	        " & vbNewLine _
    '                                            & ",Z2.KBN_NM1                                          AS SYUBETU_KB_NM        " & vbNewLine _
    '                                            & ",M_SOKO.WH_NM                                        AS WH_NM	            " & vbNewLine _
    '                                            & ",M_NRS_BR.NRS_BR_NM                                  AS NRS_BR_NM	        " & vbNewLine _
    '                                            & ",TANTO_USER.USER_NM                                  AS TANTO_USER	        " & vbNewLine _
    '                                            & ",ENT_USER.USER_NM                                    AS SYS_ENT_USER         " & vbNewLine _
    '                                            & ",UPD_USER.USER_NM                                    AS SYS_UPD_USER         " & vbNewLine _
    '                                            & ",C_OUTKA_L.LAST_PRINT_DATE                           AS LAST_PRINT_DATE      " & vbNewLine _
    '                                            & ",C_OUTKA_L.LAST_PRINT_TIME                           AS LAST_PRINT_TIME      " & vbNewLine _
    '                                            & ",C_OUTKA_L.SYS_UPD_DATE                              AS SYS_UPD_DATE         " & vbNewLine _
    '                                            & ",C_OUTKA_L.SYS_UPD_TIME                              AS SYS_UPD_TIME         " & vbNewLine _
    '                                            & ",C_OUTKA_L.NRS_BR_CD                                 AS NRS_BR_CD            " & vbNewLine _
    '                                            & ",C_OUTKA_L.WH_CD                                     AS WH_CD                " & vbNewLine _
    '                                            & ",C_OUTKA_L.PICK_KB                                   AS PICK_KB              " & vbNewLine _
    '                                            & ",M_SOKO.OUTKA_SASHIZU_PRT_YN                         AS OUTKA_SASHIZU_PRT_YN " & vbNewLine _
    '                                            & ",M_SOKO.OUTOKA_KANRYO_YN                             AS OUTOKA_KANRYO_YN     " & vbNewLine _
    '                                            & ",M_SOKO.OUTKA_KENPIN_YN                              AS OUTKA_KENPIN_YN      " & vbNewLine _
    '                                            & ",C_OUTKA_L.CUST_CD_L                                 AS CUST_CD_L            " & vbNewLine _
    '                                            & ",C_OUTKA_L.CUST_CD_M                                 AS CUST_CD_M            " & vbNewLine _
    '                                            & ",C_OUTKA_M_MIN.GOODS_CD_NRS                          AS GOODS_CD_NRS         " & vbNewLine _
    '                                            & ",C_OUTKA_L.DEST_CD                                   AS DEST_CD              " & vbNewLine _
    '                                            & ",C_OUTKA_L.OUTKA_STATE_KB                            AS OUTKA_STATE_KB       " & vbNewLine _
    '                                            & ",F_UNSO_L.UNSO_CD                                    AS UNSO_CD              " & vbNewLine _
    '                                            & ",F_UNSO_L.UNSO_BR_CD                                 AS UNSO_BR_CD           " & vbNewLine _
    '                                            & ",F_UNSO_L.UNSO_NO_L                                  AS UNSO_NO_L            " & vbNewLine _
    '                                            & ",F_UNSO_L.SYS_UPD_DATE                               AS UNSO_SYS_UPD_DATE    " & vbNewLine _
    '                                            & ",F_UNSO_L.SYS_UPD_TIME                               AS UNSO_SYS_UPD_TIME    " & vbNewLine _
    '                                            & ",C_OUTKA_M_MIN.LOT_NO                                AS LOT_NO               " & vbNewLine _
    '                                            & ",F_UNCHIN_TRS.SEIQ_FIXED_FLAG                        AS SEIQ_FIXED_FLAG      " & vbNewLine _
    '                                            & ",C_OUTKA_L.FURI_NO                                   AS FURI_NO              " & vbNewLine _
    '                                            & ",M_UNSOCO.NIHUDA_YN                                  AS NIHUDA_YN            " & vbNewLine _
    '                                            & ",C_OUTKA_L.SASZ_USER                                 AS SASZ_USER            " & vbNewLine _
    '                                            & "-- (2012.03.08) 納品書用の再発行フラグ取得 --- START ---                     " & vbNewLine _
    '                                            & ",C_OUTKA_L.NHS_FLAG                                  AS NHS_FLAG             " & vbNewLine _
    '                                            & "-- (2012.03.08) 納品書用の再発行フラグ取得 ---  END  ---                     " & vbNewLine
    'START YANAI 要望番号1286 入荷・出荷画面の機能追加（出荷検索にロット、シリアル）
    '''' <summary>
    '''' C_OUTKA_Lデータ抽出用
    '''' </summary>
    '''' <remarks></remarks>
    'Private Const SQL_SELECT_DATA As String = " SELECT                                                                      " & vbNewLine _
    '                                            & " C_OUTKA_L.CUST_ORD_NO                               AS CUST_ORD_NO  " & vbNewLine _
    '                                            & ",Z1.KBN_NM1                                          AS OUTKA_STATE_KB_NM    " & vbNewLine _
    '                                            & ",C_OUTKA_L.OUTKA_PLAN_DATE                           AS OUTKA_PLAN_DATE	    " & vbNewLine _
    '                                            & ",C_OUTKA_L.ARR_PLAN_DATE                             AS ARR_PLAN_DATE	    " & vbNewLine _
    '                                            & ",M_CUST.CUST_NM_L + '　' + M_CUST.CUST_NM_M          AS CUST_NM              " & vbNewLine _
    '                                            & ",M_GOODS.CUST_CD_S                                   AS CUST_CD_S      	    " & vbNewLine _
    '                                            & ",CASE WHEN C_OUTKA_L.DEST_KB = '00' THEN M_DEST.DEST_NM                      " & vbNewLine _
    '                                            & " ELSE C_OUTKA_L.DEST_NM                                                      " & vbNewLine _
    '                                            & " END AS DEST_NM                                                              " & vbNewLine _
    '                                            & ",M_GOODS.GOODS_NM_1                                  AS GOODS_NM	            " & vbNewLine _
    '                                            & ",C_OUTKA_L.OUTKA_PKG_NB                              AS OUTKA_PKG_NB 	    " & vbNewLine _
    '                                            & ",C_OUTKA_M.OUTKA_TTL_NB                              AS OUTKA_TTL_NB         " & vbNewLine _
    '                                            & ",C_OUTKA_M.BACKLOG_NB                                AS BACKLOG_NB           " & vbNewLine _
    '                                            & ",C_OUTKA_M.BACKLOG_QT                                AS BACKLOG_QT           " & vbNewLine _
    '                                            & ",CASE WHEN C_OUTKA_L.DEST_KB = '00' THEN M_DEST.AD_1                         " & vbNewLine _
    '                                            & " ELSE C_OUTKA_L.DEST_AD_1                                                    " & vbNewLine _
    '                                            & " END AS DEST_AD                                                              " & vbNewLine _
    '                                            & ",C_OUTKA_L.DENP_NO                                   AS DENP_NO 	            " & vbNewLine _
    '                                            & ",M_UNSOCO.UNSOCO_NM + '　' + M_UNSOCO.UNSOCO_BR_NM   AS UNSOCO_NM	        " & vbNewLine _
    '                                            & ",ISNULL(MCNT.M_COUNT,0)                              AS M_COUNT	            " & vbNewLine _
    '                                            & ",ISNULL(SCNT.S_COUNT,0)                              AS S_COUNT	            " & vbNewLine _
    '                                            & ",C_OUTKA_L.OUTKA_NO_L                                AS OUTKA_NO_L	        " & vbNewLine _
    '                                            & ",Z2.KBN_NM1                                          AS SYUBETU_KB_NM        " & vbNewLine _
    '                                            & ",M_SOKO.WH_NM                                        AS WH_NM	            " & vbNewLine _
    '                                            & ",M_NRS_BR.NRS_BR_NM                                  AS NRS_BR_NM	        " & vbNewLine _
    '                                            & ",TANTO_USER.USER_NM                                  AS TANTO_USER	        " & vbNewLine _
    '                                            & ",ENT_USER.USER_NM                                    AS SYS_ENT_USER         " & vbNewLine _
    '                                            & ",UPD_USER.USER_NM                                    AS SYS_UPD_USER         " & vbNewLine _
    '                                            & ",C_OUTKA_L.LAST_PRINT_DATE                           AS LAST_PRINT_DATE      " & vbNewLine _
    '                                            & ",C_OUTKA_L.LAST_PRINT_TIME                           AS LAST_PRINT_TIME      " & vbNewLine _
    '                                            & ",C_OUTKA_L.SYS_UPD_DATE                              AS SYS_UPD_DATE         " & vbNewLine _
    '                                            & ",C_OUTKA_L.SYS_UPD_TIME                              AS SYS_UPD_TIME         " & vbNewLine _
    '                                            & ",C_OUTKA_L.NRS_BR_CD                                 AS NRS_BR_CD            " & vbNewLine _
    '                                            & ",C_OUTKA_L.WH_CD                                     AS WH_CD                " & vbNewLine _
    '                                            & ",C_OUTKA_L.PICK_KB                                   AS PICK_KB              " & vbNewLine _
    '                                            & ",M_SOKO.OUTKA_SASHIZU_PRT_YN                         AS OUTKA_SASHIZU_PRT_YN " & vbNewLine _
    '                                            & ",M_SOKO.OUTOKA_KANRYO_YN                             AS OUTOKA_KANRYO_YN     " & vbNewLine _
    '                                            & ",M_SOKO.OUTKA_KENPIN_YN                              AS OUTKA_KENPIN_YN      " & vbNewLine _
    '                                            & ",C_OUTKA_L.CUST_CD_L                                 AS CUST_CD_L            " & vbNewLine _
    '                                            & ",C_OUTKA_L.CUST_CD_M                                 AS CUST_CD_M            " & vbNewLine _
    '                                            & ",C_OUTKA_M_MIN.GOODS_CD_NRS                          AS GOODS_CD_NRS         " & vbNewLine _
    '                                            & ",C_OUTKA_L.DEST_CD                                   AS DEST_CD              " & vbNewLine _
    '                                            & ",C_OUTKA_L.OUTKA_STATE_KB                            AS OUTKA_STATE_KB       " & vbNewLine _
    '                                            & ",F_UNSO_L.UNSO_CD                                    AS UNSO_CD              " & vbNewLine _
    '                                            & ",F_UNSO_L.UNSO_BR_CD                                 AS UNSO_BR_CD           " & vbNewLine _
    '                                            & ",F_UNSO_L.UNSO_NO_L                                  AS UNSO_NO_L            " & vbNewLine _
    '                                            & ",F_UNSO_L.SYS_UPD_DATE                               AS UNSO_SYS_UPD_DATE    " & vbNewLine _
    '                                            & ",F_UNSO_L.SYS_UPD_TIME                               AS UNSO_SYS_UPD_TIME    " & vbNewLine _
    '                                            & ",C_OUTKA_M_MIN.LOT_NO                                AS LOT_NO               " & vbNewLine _
    '                                            & ",F_UNCHIN_TRS.SEIQ_FIXED_FLAG                        AS SEIQ_FIXED_FLAG      " & vbNewLine _
    '                                            & ",C_OUTKA_L.FURI_NO                                   AS FURI_NO              " & vbNewLine _
    '                                            & ",M_UNSOCO.NIHUDA_YN                                  AS NIHUDA_YN            " & vbNewLine _
    '                                            & ",C_OUTKA_L.SASZ_USER                                 AS SASZ_USER            " & vbNewLine _
    '                                            & ",C_OUTKA_L.NHS_FLAG                                  AS NHS_FLAG             " & vbNewLine _
    '                                            & ",C_OUTKA_M.MIN_ALCTD_NB                              AS MIN_ALCTD_NB         " & vbNewLine _
    '                                            & ",C_OUTKA_M.MIN_ALCTD_QT                              AS MIN_ALCTD_QT         " & vbNewLine
    ''' <summary>
    ''' C_OUTKA_Lデータ抽出用
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_SELECT_DATA As String = " SELECT                                                                          " & vbNewLine _
                                                & " C_OUTKA_L.CUST_ORD_NO                               AS CUST_ORD_NO          " & vbNewLine _
                                                & ",Z1.KBN_NM1                                          AS OUTKA_STATE_KB_NM    " & vbNewLine _
                                                & ",C_OUTKA_L.OUTKA_PLAN_DATE                           AS OUTKA_PLAN_DATE	    " & vbNewLine _
                                                & ",C_OUTKA_L.ARR_PLAN_DATE                             AS ARR_PLAN_DATE	    " & vbNewLine _
                                                & ",M_CUST.CUST_NM_L + '　' + M_CUST.CUST_NM_M          AS CUST_NM              " & vbNewLine _
                                                & ",M_GOODS.CUST_CD_S                                   AS CUST_CD_S      	    " & vbNewLine _
                                                & ",CASE WHEN C_OUTKA_L.DEST_KB = '00' THEN M_DEST.DEST_NM                      " & vbNewLine _
                                                & " ELSE C_OUTKA_L.DEST_NM                                                      " & vbNewLine _
                                                & " END AS DEST_NM                                                              " & vbNewLine _
                                                & ",M_GOODS.GOODS_NM_1                                  AS GOODS_NM	            " & vbNewLine _
                                                & ",C_OUTKA_L.OUTKA_PKG_NB                              AS OUTKA_PKG_NB 	    " & vbNewLine _
                                                & ",C_OUTKA_M.OUTKA_TTL_NB                              AS OUTKA_TTL_NB         " & vbNewLine _
                                                & ",C_OUTKA_M.BACKLOG_NB                                AS BACKLOG_NB           " & vbNewLine _
                                                & ",C_OUTKA_M.BACKLOG_QT                                AS BACKLOG_QT           " & vbNewLine _
                                                & ",CASE WHEN C_OUTKA_L.DEST_KB = '00' THEN M_DEST.AD_1                         " & vbNewLine _
                                                & " ELSE C_OUTKA_L.DEST_AD_1                                                    " & vbNewLine _
                                                & " END AS DEST_AD                                                              " & vbNewLine _
                                                & "--2018/03/06 001203 20180222【LMS】自動送状番号_検索機能追加(千葉坂巻)対応 Annen upd start" & vbNewLine _
                                                & ",CASE WHEN C_OUTKA_L.DENP_NO ='' THEN F_UNSO_L.AUTO_DENP_NO                  " & vbNewLine _
                                                & " ELSE C_OUTKA_L.DENP_NO END                          AS DENP_NO              " & vbNewLine _
                                                & "--,C_OUTKA_L.DENP_NO                                   AS DENP_NO 	            " & vbNewLine _
                                                & "--2018/03/06 001203 20180222【LMS】自動送状番号_検索機能追加(千葉坂巻)対応 Annen upd end" & vbNewLine _
                                                & ",M_UNSOCO.UNSOCO_NM + '　' + M_UNSOCO.UNSOCO_BR_NM   AS UNSOCO_NM	        " & vbNewLine _
                                                & ",ISNULL(MCNT.M_COUNT,0)                              AS M_COUNT	            " & vbNewLine _
                                                & ",ISNULL(SCNT.S_COUNT,0)                              AS S_COUNT	            " & vbNewLine _
                                                & "--2018/04/20 001547 【LMS】出荷データ検索画面_注文番号項目追加(千葉BC物管２_石井) Annen add start " & vbNewLine _
                                                & " ,C_OUTKA_L.BUYER_ORD_NO                               AS BUYER_ORD_NO        " & vbNewLine _
                                                & "--2018/04/20 001547 【LMS】出荷データ検索画面_注文番号項目追加(千葉BC物管２_石井) Annen add end   " & vbNewLine _
                                                & ",C_OUTKA_L.OUTKA_NO_L                                AS OUTKA_NO_L	        " & vbNewLine _
                                                & ",Z2.KBN_NM1                                          AS SYUBETU_KB_NM        " & vbNewLine _
                                                & ",M_SOKO.WH_NM                                        AS WH_NM	            " & vbNewLine _
                                                & ",M_NRS_BR.NRS_BR_NM                                  AS NRS_BR_NM	        " & vbNewLine _
                                                & ",TANTO_USER.USER_NM                                  AS TANTO_USER	        " & vbNewLine _
                                                & ",ENT_USER.USER_NM                                    AS SYS_ENT_USER         " & vbNewLine _
                                                & ",UPD_USER.USER_NM                                    AS SYS_UPD_USER         " & vbNewLine _
                                                & ",C_OUTKA_L.LAST_PRINT_DATE                           AS LAST_PRINT_DATE      " & vbNewLine _
                                                & ",C_OUTKA_L.LAST_PRINT_TIME                           AS LAST_PRINT_TIME      " & vbNewLine _
                                                & ",C_OUTKA_L.SYS_UPD_DATE                              AS SYS_UPD_DATE         " & vbNewLine _
                                                & ",C_OUTKA_L.SYS_UPD_TIME                              AS SYS_UPD_TIME         " & vbNewLine _
                                                & ",C_OUTKA_L.NRS_BR_CD                                 AS NRS_BR_CD            " & vbNewLine _
                                                & ",C_OUTKA_L.WH_CD                                     AS WH_CD                " & vbNewLine _
                                                & ",C_OUTKA_L.PICK_KB                                   AS PICK_KB              " & vbNewLine _
                                                & ",M_SOKO.OUTKA_SASHIZU_PRT_YN                         AS OUTKA_SASHIZU_PRT_YN " & vbNewLine _
                                                & ",M_SOKO.OUTOKA_KANRYO_YN                             AS OUTOKA_KANRYO_YN     " & vbNewLine _
                                                & ",M_SOKO.OUTKA_KENPIN_YN                              AS OUTKA_KENPIN_YN      " & vbNewLine _
                                                & ",C_OUTKA_L.CUST_CD_L                                 AS CUST_CD_L            " & vbNewLine _
                                                & ",C_OUTKA_L.CUST_CD_M                                 AS CUST_CD_M            " & vbNewLine _
                                                & ",C_OUTKA_M_MIN.GOODS_CD_NRS                          AS GOODS_CD_NRS         " & vbNewLine _
                                                & ",C_OUTKA_L.DEST_CD                                   AS DEST_CD              " & vbNewLine _
                                                & ",C_OUTKA_L.OUTKA_STATE_KB                            AS OUTKA_STATE_KB       " & vbNewLine _
                                                & ",F_UNSO_L.UNSO_CD                                    AS UNSO_CD              " & vbNewLine _
                                                & ",F_UNSO_L.UNSO_BR_CD                                 AS UNSO_BR_CD           " & vbNewLine _
                                                & ",F_UNSO_L.UNSO_NO_L                                  AS UNSO_NO_L            " & vbNewLine _
                                                & ",F_UNSO_L.SYS_UPD_DATE                               AS UNSO_SYS_UPD_DATE    " & vbNewLine _
                                                & ",F_UNSO_L.SYS_UPD_TIME                               AS UNSO_SYS_UPD_TIME    " & vbNewLine _
                                                & ",C_OUTKA_M_MIN.LOT_NO                                AS LOT_NO               " & vbNewLine _
                                                & ",F_UNCHIN_TRS.SEIQ_FIXED_FLAG                        AS SEIQ_FIXED_FLAG      " & vbNewLine _
                                                & ",C_OUTKA_L.FURI_NO                                   AS FURI_NO              " & vbNewLine _
                                                & ",M_UNSOCO.NIHUDA_YN                                  AS NIHUDA_YN            " & vbNewLine _
                                                & ",C_OUTKA_L.SASZ_USER                                 AS SASZ_USER            " & vbNewLine _
                                                & ",C_OUTKA_L.NHS_FLAG                                  AS NHS_FLAG             " & vbNewLine _
                                                & ",C_OUTKA_M.MIN_ALCTD_NB                              AS MIN_ALCTD_NB         " & vbNewLine _
                                                & ",C_OUTKA_M.MIN_ALCTD_QT                              AS MIN_ALCTD_QT         " & vbNewLine _
                                                & ",C_OUTKA_M.LOT_NO                                    AS LOT_NO_S             " & vbNewLine _
                                                & ",C_OUTKA_M.SERIAL_NO                                 AS SERIAL_NO_S          " & vbNewLine _
                                                & "--'要望番号1369:(支払-運送会社変更時、タリフを再取得し、再計算をおこなう⇒運行が紐付いている場合には、運行の運送会社変更時のみ動作) 2012/08/24 本明 Start " & vbNewLine _
                                                & ",F_UNSO_L.TRIP_NO                                    AS TRIP_NO              " & vbNewLine _
                                                & ",F_UNSO_L.TRIP_NO_SYUKA                              AS TRIP_NO_SYUKA        " & vbNewLine _
                                                & ",F_UNSO_L.TRIP_NO_TYUKEI                             AS TRIP_NO_TYUKEI       " & vbNewLine _
                                                & ",F_UNSO_L.TRIP_NO_HAIKA                              AS TRIP_NO_HAIKA        " & vbNewLine _
                                                & ",F_SHIHARAI_TRS.SHIHARAI_FIXED_FLAG                  AS SHIHARAI_FIXED_FLAG  " & vbNewLine _
                                                & "--'要望番号1369:(支払-運送会社変更時、タリフを再取得し、再計算をおこなう⇒運行が紐付いている場合には、運行の運送会社変更時のみ動作) 2012/08/24 本明 End   " & vbNewLine _
                                                & ",F_UNSO_L.REMARK                                     AS REMARK_UNSO          " & vbNewLine _
                                                & "--2013.02.27 / Notes1897開始                                                 " & vbNewLine _
                                                & ",F_UNSO_L.BIN_KB                                     AS BIN_KB               " & vbNewLine _
                                                & ",BIN_Z.KBN_NM1                                       AS BIN_KB_NM            " & vbNewLine _
                                                & "--2013.02.27 / Notes1897終了                                                 " & vbNewLine _
                                                & "--要望番号1961 20130322 まとめ送状対応(BPC対応) 追加START                    " & vbNewLine _
                                                & ",M_DEST.CUST_DEST_CD                                 AS CUST_DEST_CD         " & vbNewLine _
                                                & "--要望番号1961 20130322 まとめ送状対応(BPC対応) 追加END                      " & vbNewLine _
                                                & "-- 西濃自動送り状番号対応                                                    " & vbNewLine _
                                                & ", F_UNSO_L.AUTO_DENP_KBN                             AS AUTO_DENP_KBN        " & vbNewLine _
                                                & ", F_UNSO_L.AUTO_DENP_NO                              AS AUTO_DENP_NO         " & vbNewLine _
                                                & "-- 出荷作業ステータス対応                                                    " & vbNewLine _
                                                & ", CASE WHEN LEN(WK_STATUS_L.KBN_CD) > 0                                      " & vbNewLine _
                                                & "       THEN ISNULL(WK_STATUS_L.#KBN# , '')                                   " & vbNewLine _
                                                & "       ELSE ISNULL(WK_STATUS_M.#KBN# , '')                                   " & vbNewLine _
                                                & "   END                                               AS WH_WORK_STATUS_NM    " & vbNewLine _
                                                & "--' 届出実行追加対応 2012/08/24 Annen START                                  " & vbNewLine _
                                                & ",C_OUTKA_L.DEST_KB                                   AS DEST_KB              " & vbNewLine _
                                                & "--' 届出実行追加対応 2012/08/24 Annen END                                    " & vbNewLine _
                                                & ",C_OUTKA_L.SYUBETU_KB                                AS SYUBETU_KB           " & vbNewLine _
                                                & ",ISNULL(WEB_OUTKA_L.WEB_OUTKA_NO_L ,'')              AS WEB_OUTKA_NO_L       " & vbNewLine _
                                                & ",ISNULL(TAB_STATUS.#KBN# ,'')                        AS WH_TAB_STATUS_NM     " & vbNewLine _
                                                & ",ISNULL(KBN_COAUMU.KBN_NM1,'')                       AS COA_UMU              " & vbNewLine



    'END YANAI 要望番号1286 入荷・出荷画面の機能追加（出荷検索にロット、シリアル）
    'END YANAI 要望番号1158 一覧画面　引当前の出荷で納品書の印刷が出来てしまう
    'END YANAI 要望番号748
    'END YANAI メモ②No.2

    'Private Const SQL_GROUP_BY As String = "GROUP BY   

    'START YANAI 要望番号1158 一覧画面　引当前の出荷で納品書の印刷が出来てしまう
    '''' <summary>
    '''' 検索用SQLFROM句
    '''' </summary>
    '''' <remarks></remarks>
    'Private Const SQL_FROM As String = "FROM                                                           " & vbNewLine _
    '                                    & "$LM_TRN$..C_OUTKA_L                                            " & vbNewLine _
    '                                    & "LEFT JOIN                                                      " & vbNewLine _
    '                                    & "$LM_MST$..Z_KBN                        Z1                      " & vbNewLine _
    '                                    & "ON                                                             " & vbNewLine _
    '                                    & "C_OUTKA_L.OUTKA_STATE_KB = Z1.KBN_CD                           " & vbNewLine _
    '                                    & "AND                                                            " & vbNewLine _
    '                                    & "Z1.KBN_GROUP_CD = 'S010'                                       " & vbNewLine _
    '                                    & "LEFT JOIN                                                      " & vbNewLine _
    '                                    & "$LM_MST$..M_CUST                       M_CUST                  " & vbNewLine _
    '                                    & "ON                                                             " & vbNewLine _
    '                                    & "C_OUTKA_L.NRS_BR_CD = M_CUST.NRS_BR_CD                         " & vbNewLine _
    '                                    & "AND                                                            " & vbNewLine _
    '                                    & "C_OUTKA_L.CUST_CD_L = M_CUST.CUST_CD_L                         " & vbNewLine _
    '                                    & "AND                                                            " & vbNewLine _
    '                                    & "C_OUTKA_L.CUST_CD_M = M_CUST.CUST_CD_M                         " & vbNewLine _
    '                                    & "AND                                                            " & vbNewLine _
    '                                    & "M_CUST.CUST_CD_S = '00'                                        " & vbNewLine _
    '                                    & "AND                                                            " & vbNewLine _
    '                                    & "M_CUST.CUST_CD_SS = '00'                                       " & vbNewLine _
    '                                    & "LEFT JOIN                                                      " & vbNewLine _
    '                                    & "(                                                              " & vbNewLine _
    '                                    & "SELECT                                                         " & vbNewLine _
    '                                    & " C_OUTKA_M.NRS_BR_CD                                           " & vbNewLine _
    '                                    & ",C_OUTKA_M.OUTKA_NO_L                                          " & vbNewLine _
    '                                    & ",MIN(C_OUTKA_M.OUTKA_NO_M) AS OUTKA_NO_M                       " & vbNewLine _
    '                                    & ",SUM(C_OUTKA_M.OUTKA_TTL_NB) AS OUTKA_TTL_NB                   " & vbNewLine _
    '                                    & ",SUM(C_OUTKA_M.BACKLOG_NB) AS BACKLOG_NB                       " & vbNewLine _
    '                                    & ",SUM(C_OUTKA_M.BACKLOG_QT) AS BACKLOG_QT                       " & vbNewLine _
    '                                    & ",C_OUTKA_M.SYS_DEL_FLG                                         " & vbNewLine _
    '                                    & "FROM                                                           " & vbNewLine _
    '                                    & "$LM_TRN$..C_OUTKA_M     C_OUTKA_M                              " & vbNewLine _
    '                                    & "WHERE                                                          " & vbNewLine _
    '                                    & "C_OUTKA_M.NRS_BR_CD = @NRS_BR_CD                               " & vbNewLine _
    '                                    & "AND                                                            " & vbNewLine _
    '                                    & "C_OUTKA_M.SYS_DEL_FLG = '0'                                    " & vbNewLine _
    '                                    & "GROUP BY                                                       " & vbNewLine _
    '                                    & " C_OUTKA_M.NRS_BR_CD                                           " & vbNewLine _
    '                                    & ",C_OUTKA_M.OUTKA_NO_L                                          " & vbNewLine _
    '                                    & ",C_OUTKA_M.SYS_DEL_FLG                                         " & vbNewLine _
    '                                    & ")                   C_OUTKA_M                                  " & vbNewLine _
    '                                    & "ON                                                             " & vbNewLine _
    '                                    & "C_OUTKA_L.NRS_BR_CD =C_OUTKA_M.NRS_BR_CD                       " & vbNewLine _
    '                                    & "AND                                                            " & vbNewLine _
    '                                    & "C_OUTKA_L.OUTKA_NO_L =C_OUTKA_M.OUTKA_NO_L                     " & vbNewLine _
    '                                    & "LEFT JOIN                                                      " & vbNewLine _
    '                                    & "$LM_TRN$..C_OUTKA_M             C_OUTKA_M_MIN                  " & vbNewLine _
    '                                    & "ON                                                             " & vbNewLine _
    '                                    & "C_OUTKA_M.NRS_BR_CD =C_OUTKA_M_MIN.NRS_BR_CD                   " & vbNewLine _
    '                                    & "AND                                                            " & vbNewLine _
    '                                    & "C_OUTKA_M.OUTKA_NO_L =C_OUTKA_M_MIN.OUTKA_NO_L                 " & vbNewLine _
    '                                    & "AND                                                            " & vbNewLine _
    '                                    & "C_OUTKA_M.OUTKA_NO_M =C_OUTKA_M_MIN.OUTKA_NO_M                 " & vbNewLine _
    '                                    & "AND                                                            " & vbNewLine _
    '                                    & "C_OUTKA_M.SYS_DEL_FLG ='0'                                     " & vbNewLine _
    '                                    & "LEFT JOIN                                                      " & vbNewLine _
    '                                    & "$LM_MST$..M_DEST                       M_DEST                  " & vbNewLine _
    '                                    & "ON                                                             " & vbNewLine _
    '                                    & "C_OUTKA_L.NRS_BR_CD = M_DEST.NRS_BR_CD                         " & vbNewLine _
    '                                    & "AND                                                            " & vbNewLine _
    '                                    & "C_OUTKA_L.CUST_CD_L = M_DEST.CUST_CD_L                         " & vbNewLine _
    '                                    & "AND                                                            " & vbNewLine _
    '                                    & "C_OUTKA_L.DEST_CD = M_DEST.DEST_CD                             " & vbNewLine _
    '                                    & "LEFT JOIN                                                      " & vbNewLine _
    '                                    & "$LM_MST$..M_GOODS              M_GOODS                         " & vbNewLine _
    '                                    & "ON                                                             " & vbNewLine _
    '                                    & "C_OUTKA_M_MIN.NRS_BR_CD =M_GOODS.NRS_BR_CD                     " & vbNewLine _
    '                                    & "AND                                                            " & vbNewLine _
    '                                    & "C_OUTKA_M_MIN.GOODS_CD_NRS = M_GOODS.GOODS_CD_NRS              " & vbNewLine _
    '                                    & "LEFT JOIN                                                      " & vbNewLine _
    '                                    & "$LM_TRN$..F_UNSO_L                     F_UNSO_L                " & vbNewLine _
    '                                    & "ON                                                             " & vbNewLine _
    '                                    & "C_OUTKA_L.NRS_BR_CD = F_UNSO_L.NRS_BR_CD                       " & vbNewLine _
    '                                    & "AND                                                            " & vbNewLine _
    '                                    & "C_OUTKA_L.OUTKA_NO_L = F_UNSO_L.INOUTKA_NO_L                   " & vbNewLine _
    '                                    & "AND                                                            " & vbNewLine _
    '                                    & "F_UNSO_L.MOTO_DATA_KB = '20'                                   " & vbNewLine _
    '                                    & "AND                                                            " & vbNewLine _
    '                                    & "F_UNSO_L.SYS_DEL_FLG ='0'                                      " & vbNewLine _
    '                                    & "LEFT JOIN                                                      " & vbNewLine _
    '                                    & "(                                                              " & vbNewLine _
    '                                    & "SELECT                                                         " & vbNewLine _
    '                                    & "NRS_BR_CD                                                      " & vbNewLine _
    '                                    & ", UNSO_NO_L                                                    " & vbNewLine _
    '                                    & ",MAX(SEIQ_FIXED_FLAG)        AS SEIQ_FIXED_FLAG                " & vbNewLine _
    '                                    & ",SYS_DEL_FLG                                                   " & vbNewLine _
    '                                    & "FROM                                                           " & vbNewLine _
    '                                    & "$LM_TRN$..F_UNCHIN_TRS                                         " & vbNewLine _
    '                                    & "WHERE                                                          " & vbNewLine _
    '                                    & "F_UNCHIN_TRS.NRS_BR_CD = @NRS_BR_CD                            " & vbNewLine _
    '                                    & "AND                                                            " & vbNewLine _
    '                                    & "F_UNCHIN_TRS.SYS_DEL_FLG ='0'                                  " & vbNewLine _
    '                                    & "GROUP BY                                                       " & vbNewLine _
    '                                    & "NRS_BR_CD, UNSO_NO_L, SYS_DEL_FLG                              " & vbNewLine _
    '                                    & ")            F_UNCHIN_TRS                                      " & vbNewLine _
    '                                    & "ON                                                             " & vbNewLine _
    '                                    & "F_UNSO_L.NRS_BR_CD = F_UNCHIN_TRS.NRS_BR_CD                    " & vbNewLine _
    '                                    & "AND                                                            " & vbNewLine _
    '                                    & "F_UNSO_L.UNSO_NO_L = F_UNCHIN_TRS.UNSO_NO_L                    " & vbNewLine _
    '                                    & "AND                                                            " & vbNewLine _
    '                                    & "F_UNCHIN_TRS.SYS_DEL_FLG = '0'                                 " & vbNewLine _
    '                                    & "LEFT JOIN                                                      " & vbNewLine _
    '                                    & "$LM_MST$..M_UNSOCO                 M_UNSOCO                    " & vbNewLine _
    '                                    & "ON                                                             " & vbNewLine _
    '                                    & "C_OUTKA_L.NRS_BR_CD = M_UNSOCO.NRS_BR_CD                       " & vbNewLine _
    '                                    & "AND                                                            " & vbNewLine _
    '                                    & "F_UNSO_L.UNSO_CD = M_UNSOCO.UNSOCO_CD                          " & vbNewLine _
    '                                    & "AND                                                            " & vbNewLine _
    '                                    & "F_UNSO_L.UNSO_BR_CD = M_UNSOCO.UNSOCO_BR_CD                    " & vbNewLine _
    '                                    & "LEFT JOIN                                                      " & vbNewLine _
    '                                    & "(                                                              " & vbNewLine _
    '                                    & "SELECT                                                         " & vbNewLine _
    '                                    & "C_OUTKA_M.OUTKA_NO_L                                           " & vbNewLine _
    '                                    & ",COUNT(C_OUTKA_M.OUTKA_NO_M)   AS  M_COUNT                     " & vbNewLine _
    '                                    & "FROM                                                           " & vbNewLine _
    '                                    & "$LM_TRN$..C_OUTKA_M   C_OUTKA_M                                " & vbNewLine _
    '                                    & "WHERE                                                          " & vbNewLine _
    '                                    & "C_OUTKA_M.NRS_BR_CD = @NRS_BR_CD                               " & vbNewLine _
    '                                    & "AND                                                            " & vbNewLine _
    '                                    & "C_OUTKA_M.SYS_DEL_FLG = '0'                                    " & vbNewLine _
    '                                    & "GROUP BY                                                       " & vbNewLine _
    '                                    & "C_OUTKA_M.OUTKA_NO_L                                           " & vbNewLine _
    '                                    & ")                           MCNT                               " & vbNewLine _
    '                                    & "ON                                                             " & vbNewLine _
    '                                    & "C_OUTKA_L.OUTKA_NO_L = MCNT.OUTKA_NO_L                         " & vbNewLine _
    '                                    & "LEFT JOIN                                                      " & vbNewLine _
    '                                    & "(                                                              " & vbNewLine _
    '                                    & "SELECT                                                         " & vbNewLine _
    '                                    & "C_OUTKA_S.OUTKA_NO_L                                           " & vbNewLine _
    '                                    & ",COUNT(C_OUTKA_S.OUTKA_NO_S)   AS  S_COUNT                     " & vbNewLine _
    '                                    & "FROM                                                           " & vbNewLine _
    '                                    & "$LM_TRN$..C_OUTKA_S   C_OUTKA_S                                " & vbNewLine _
    '                                    & "WHERE                                                          " & vbNewLine _
    '                                    & "C_OUTKA_S.NRS_BR_CD   = @NRS_BR_CD                             " & vbNewLine _
    '                                    & "AND                                                            " & vbNewLine _
    '                                    & "C_OUTKA_S.SYS_DEL_FLG = '0'                                    " & vbNewLine _
    '                                    & "GROUP BY                                                       " & vbNewLine _
    '                                    & "C_OUTKA_S.OUTKA_NO_L                                           " & vbNewLine _
    '                                    & ")                           SCNT                               " & vbNewLine _
    '                                    & "ON                                                             " & vbNewLine _
    '                                    & "C_OUTKA_L.OUTKA_NO_L = SCNT.OUTKA_NO_L                         " & vbNewLine _
    '                                    & "LEFT JOIN                                                      " & vbNewLine _
    '                                    & "$LM_MST$..Z_KBN                Z2                              " & vbNewLine _
    '                                    & "ON                                                             " & vbNewLine _
    '                                    & "C_OUTKA_L.SYUBETU_KB = Z2.KBN_CD                               " & vbNewLine _
    '                                    & "AND                                                            " & vbNewLine _
    '                                    & "Z2.KBN_GROUP_CD = 'S020'                                       " & vbNewLine _
    '                                    & "LEFT JOIN                                                      " & vbNewLine _
    '                                    & "$LM_MST$..M_SOKO               M_SOKO                          " & vbNewLine _
    '                                    & "ON                                                             " & vbNewLine _
    '                                    & "M_SOKO.NRS_BR_CD = C_OUTKA_L.NRS_BR_CD                         " & vbNewLine _
    '                                    & "AND                                                            " & vbNewLine _
    '                                    & "M_SOKO.WH_CD = C_OUTKA_L.WH_CD                                 " & vbNewLine _
    '                                    & "LEFT JOIN                                                      " & vbNewLine _
    '                                    & "$LM_MST$..M_NRS_BR                                             " & vbNewLine _
    '                                    & "ON                                                             " & vbNewLine _
    '                                    & "C_OUTKA_L.NRS_BR_CD = M_NRS_BR.NRS_BR_CD                       " & vbNewLine _
    '                                    & "LEFT JOIN                                                      " & vbNewLine _
    '                                    & "(                                                              " & vbNewLine _
    '                                    & "SELECT                                                         " & vbNewLine _
    '                                    & "M_TCUST.CUST_CD_L AS CUST_CD_L                                 " & vbNewLine _
    '                                    & ",min(USER_CD) AS USER_CD                                       " & vbNewLine _
    '                                    & "FROM                                                           " & vbNewLine _
    '                                    & "$LM_MST$..M_TCUST              M_TCUST                         " & vbNewLine _
    '                                    & "GROUP BY                                                       " & vbNewLine _
    '                                    & "M_TCUST.CUST_CD_L                                              " & vbNewLine _
    '                                    & ") M_TCUST                                                      " & vbNewLine _
    '                                    & "ON                                                             " & vbNewLine _
    '                                    & "C_OUTKA_L.CUST_CD_L = M_TCUST.CUST_CD_L                        " & vbNewLine _
    '                                    & "LEFT JOIN                                                      " & vbNewLine _
    '                                    & "$LM_MST$..S_USER               TANTO_USER                      " & vbNewLine _
    '                                    & "ON                                                             " & vbNewLine _
    '                                    & "M_TCUST.USER_CD = TANTO_USER.USER_CD                           " & vbNewLine _
    '                                    & "LEFT JOIN                                                      " & vbNewLine _
    '                                    & "$LM_MST$..S_USER               ENT_USER                        " & vbNewLine _
    '                                    & "ON                                                             " & vbNewLine _
    '                                    & "C_OUTKA_L.SYS_ENT_USER = ENT_USER.USER_CD                      " & vbNewLine _
    '                                    & "LEFT JOIN                                                      " & vbNewLine _
    '                                    & "$LM_MST$..S_USER               UPD_USER                        " & vbNewLine _
    '                                    & "ON                                                             " & vbNewLine _
    '                                    & "C_OUTKA_L.SYS_UPD_USER = UPD_USER.USER_CD                      " & vbNewLine
    'START YANAI 要望番号1286 入荷・出荷画面の機能追加（出荷検索にロット、シリアル）
    '''' <summary>
    '''' 検索用SQLFROM句
    '''' </summary>
    '''' <remarks></remarks>
    'Private Const SQL_FROM As String = "FROM                                                              " & vbNewLine _
    '                                    & "$LM_TRN$..C_OUTKA_L                                            " & vbNewLine _
    '                                    & "LEFT JOIN                                                      " & vbNewLine _
    '                                    & "$LM_MST$..Z_KBN                        Z1                      " & vbNewLine _
    '                                    & "ON                                                             " & vbNewLine _
    '                                    & "C_OUTKA_L.OUTKA_STATE_KB = Z1.KBN_CD                           " & vbNewLine _
    '                                    & "AND                                                            " & vbNewLine _
    '                                    & "Z1.KBN_GROUP_CD = 'S010'                                       " & vbNewLine _
    '                                    & "LEFT JOIN                                                      " & vbNewLine _
    '                                    & "$LM_MST$..M_CUST                       M_CUST                  " & vbNewLine _
    '                                    & "ON                                                             " & vbNewLine _
    '                                    & "C_OUTKA_L.NRS_BR_CD = M_CUST.NRS_BR_CD                         " & vbNewLine _
    '                                    & "AND                                                            " & vbNewLine _
    '                                    & "C_OUTKA_L.CUST_CD_L = M_CUST.CUST_CD_L                         " & vbNewLine _
    '                                    & "AND                                                            " & vbNewLine _
    '                                    & "C_OUTKA_L.CUST_CD_M = M_CUST.CUST_CD_M                         " & vbNewLine _
    '                                    & "AND                                                            " & vbNewLine _
    '                                    & "M_CUST.CUST_CD_S = '00'                                        " & vbNewLine _
    '                                    & "AND                                                            " & vbNewLine _
    '                                    & "M_CUST.CUST_CD_SS = '00'                                       " & vbNewLine _
    '                                    & "LEFT JOIN                                                      " & vbNewLine _
    '                                    & "(                                                              " & vbNewLine _
    '                                    & "SELECT                                                         " & vbNewLine _
    '                                    & " C_OUTKA_M.NRS_BR_CD                                           " & vbNewLine _
    '                                    & ",C_OUTKA_M.OUTKA_NO_L                                          " & vbNewLine _
    '                                    & ",MIN(C_OUTKA_M.OUTKA_NO_M) AS OUTKA_NO_M                       " & vbNewLine _
    '                                    & ",SUM(C_OUTKA_M.OUTKA_TTL_NB) AS OUTKA_TTL_NB                   " & vbNewLine _
    '                                    & ",SUM(C_OUTKA_M.BACKLOG_NB) AS BACKLOG_NB                       " & vbNewLine _
    '                                    & ",SUM(C_OUTKA_M.BACKLOG_QT) AS BACKLOG_QT                       " & vbNewLine _
    '                                    & ",MIN(C_OUTKA_M.ALCTD_NB) AS MIN_ALCTD_NB                       " & vbNewLine _
    '                                    & ",MIN(C_OUTKA_M.ALCTD_QT) AS MIN_ALCTD_QT                       " & vbNewLine _
    '                                    & ",C_OUTKA_M.SYS_DEL_FLG                                         " & vbNewLine _
    '                                    & "FROM                                                           " & vbNewLine _
    '                                    & "$LM_TRN$..C_OUTKA_M     C_OUTKA_M                              " & vbNewLine _
    '                                    & "WHERE                                                          " & vbNewLine _
    '                                    & "C_OUTKA_M.NRS_BR_CD = @NRS_BR_CD                               " & vbNewLine _
    '                                    & "AND                                                            " & vbNewLine _
    '                                    & "C_OUTKA_M.SYS_DEL_FLG = '0'                                    " & vbNewLine _
    '                                    & "GROUP BY                                                       " & vbNewLine _
    '                                    & " C_OUTKA_M.NRS_BR_CD                                           " & vbNewLine _
    '                                    & ",C_OUTKA_M.OUTKA_NO_L                                          " & vbNewLine _
    '                                    & ",C_OUTKA_M.SYS_DEL_FLG                                         " & vbNewLine _
    '                                    & ")                   C_OUTKA_M                                  " & vbNewLine _
    '                                    & "ON                                                             " & vbNewLine _
    '                                    & "C_OUTKA_L.NRS_BR_CD =C_OUTKA_M.NRS_BR_CD                       " & vbNewLine _
    '                                    & "AND                                                            " & vbNewLine _
    '                                    & "C_OUTKA_L.OUTKA_NO_L =C_OUTKA_M.OUTKA_NO_L                     " & vbNewLine _
    '                                    & "LEFT JOIN                                                      " & vbNewLine _
    '                                    & "$LM_TRN$..C_OUTKA_M             C_OUTKA_M_MIN                  " & vbNewLine _
    '                                    & "ON                                                             " & vbNewLine _
    '                                    & "C_OUTKA_M.NRS_BR_CD =C_OUTKA_M_MIN.NRS_BR_CD                   " & vbNewLine _
    '                                    & "AND                                                            " & vbNewLine _
    '                                    & "C_OUTKA_M.OUTKA_NO_L =C_OUTKA_M_MIN.OUTKA_NO_L                 " & vbNewLine _
    '                                    & "AND                                                            " & vbNewLine _
    '                                    & "C_OUTKA_M.OUTKA_NO_M =C_OUTKA_M_MIN.OUTKA_NO_M                 " & vbNewLine _
    '                                    & "AND                                                            " & vbNewLine _
    '                                    & "C_OUTKA_M.SYS_DEL_FLG ='0'                                     " & vbNewLine _
    '                                    & "LEFT JOIN                                                      " & vbNewLine _
    '                                    & "$LM_MST$..M_DEST                       M_DEST                  " & vbNewLine _
    '                                    & "ON                                                             " & vbNewLine _
    '                                    & "C_OUTKA_L.NRS_BR_CD = M_DEST.NRS_BR_CD                         " & vbNewLine _
    '                                    & "AND                                                            " & vbNewLine _
    '                                    & "C_OUTKA_L.CUST_CD_L = M_DEST.CUST_CD_L                         " & vbNewLine _
    '                                    & "AND                                                            " & vbNewLine _
    '                                    & "C_OUTKA_L.DEST_CD = M_DEST.DEST_CD                             " & vbNewLine _
    '                                    & "LEFT JOIN                                                      " & vbNewLine _
    '                                    & "$LM_MST$..M_GOODS              M_GOODS                         " & vbNewLine _
    '                                    & "ON                                                             " & vbNewLine _
    '                                    & "C_OUTKA_M_MIN.NRS_BR_CD =M_GOODS.NRS_BR_CD                     " & vbNewLine _
    '                                    & "AND                                                            " & vbNewLine _
    '                                    & "C_OUTKA_M_MIN.GOODS_CD_NRS = M_GOODS.GOODS_CD_NRS              " & vbNewLine _
    '                                    & "LEFT JOIN                                                      " & vbNewLine _
    '                                    & "$LM_TRN$..F_UNSO_L                     F_UNSO_L                " & vbNewLine _
    '                                    & "ON                                                             " & vbNewLine _
    '                                    & "C_OUTKA_L.NRS_BR_CD = F_UNSO_L.NRS_BR_CD                       " & vbNewLine _
    '                                    & "AND                                                            " & vbNewLine _
    '                                    & "C_OUTKA_L.OUTKA_NO_L = F_UNSO_L.INOUTKA_NO_L                   " & vbNewLine _
    '                                    & "AND                                                            " & vbNewLine _
    '                                    & "F_UNSO_L.MOTO_DATA_KB = '20'                                   " & vbNewLine _
    '                                    & "AND                                                            " & vbNewLine _
    '                                    & "F_UNSO_L.SYS_DEL_FLG ='0'                                      " & vbNewLine _
    '                                    & "LEFT JOIN                                                      " & vbNewLine _
    '                                    & "(                                                              " & vbNewLine _
    '                                    & "SELECT                                                         " & vbNewLine _
    '                                    & "NRS_BR_CD                                                      " & vbNewLine _
    '                                    & ", UNSO_NO_L                                                    " & vbNewLine _
    '                                    & ",MAX(SEIQ_FIXED_FLAG)        AS SEIQ_FIXED_FLAG                " & vbNewLine _
    '                                    & ",SYS_DEL_FLG                                                   " & vbNewLine _
    '                                    & "FROM                                                           " & vbNewLine _
    '                                    & "$LM_TRN$..F_UNCHIN_TRS                                         " & vbNewLine _
    '                                    & "WHERE                                                          " & vbNewLine _
    '                                    & "F_UNCHIN_TRS.NRS_BR_CD = @NRS_BR_CD                            " & vbNewLine _
    '                                    & "AND                                                            " & vbNewLine _
    '                                    & "F_UNCHIN_TRS.SYS_DEL_FLG ='0'                                  " & vbNewLine _
    '                                    & "GROUP BY                                                       " & vbNewLine _
    '                                    & "NRS_BR_CD, UNSO_NO_L, SYS_DEL_FLG                              " & vbNewLine _
    '                                    & ")            F_UNCHIN_TRS                                      " & vbNewLine _
    '                                    & "ON                                                             " & vbNewLine _
    '                                    & "F_UNSO_L.NRS_BR_CD = F_UNCHIN_TRS.NRS_BR_CD                    " & vbNewLine _
    '                                    & "AND                                                            " & vbNewLine _
    '                                    & "F_UNSO_L.UNSO_NO_L = F_UNCHIN_TRS.UNSO_NO_L                    " & vbNewLine _
    '                                    & "AND                                                            " & vbNewLine _
    '                                    & "F_UNCHIN_TRS.SYS_DEL_FLG = '0'                                 " & vbNewLine _
    '                                    & "LEFT JOIN                                                      " & vbNewLine _
    '                                    & "$LM_MST$..M_UNSOCO                 M_UNSOCO                    " & vbNewLine _
    '                                    & "ON                                                             " & vbNewLine _
    '                                    & "C_OUTKA_L.NRS_BR_CD = M_UNSOCO.NRS_BR_CD                       " & vbNewLine _
    '                                    & "AND                                                            " & vbNewLine _
    '                                    & "F_UNSO_L.UNSO_CD = M_UNSOCO.UNSOCO_CD                          " & vbNewLine _
    '                                    & "AND                                                            " & vbNewLine _
    '                                    & "F_UNSO_L.UNSO_BR_CD = M_UNSOCO.UNSOCO_BR_CD                    " & vbNewLine _
    '                                    & "LEFT JOIN                                                      " & vbNewLine _
    '                                    & "(                                                              " & vbNewLine _
    '                                    & "SELECT                                                         " & vbNewLine _
    '                                    & "C_OUTKA_M.OUTKA_NO_L                                           " & vbNewLine _
    '                                    & ",COUNT(C_OUTKA_M.OUTKA_NO_M)   AS  M_COUNT                     " & vbNewLine _
    '                                    & "FROM                                                           " & vbNewLine _
    '                                    & "$LM_TRN$..C_OUTKA_M   C_OUTKA_M                                " & vbNewLine _
    '                                    & "WHERE                                                          " & vbNewLine _
    '                                    & "C_OUTKA_M.NRS_BR_CD = @NRS_BR_CD                               " & vbNewLine _
    '                                    & "AND                                                            " & vbNewLine _
    '                                    & "C_OUTKA_M.SYS_DEL_FLG = '0'                                    " & vbNewLine _
    '                                    & "GROUP BY                                                       " & vbNewLine _
    '                                    & "C_OUTKA_M.OUTKA_NO_L                                           " & vbNewLine _
    '                                    & ")                           MCNT                               " & vbNewLine _
    '                                    & "ON                                                             " & vbNewLine _
    '                                    & "C_OUTKA_L.OUTKA_NO_L = MCNT.OUTKA_NO_L                         " & vbNewLine _
    '                                    & "LEFT JOIN                                                      " & vbNewLine _
    '                                    & "(                                                              " & vbNewLine _
    '                                    & "SELECT                                                         " & vbNewLine _
    '                                    & "C_OUTKA_S.OUTKA_NO_L                                           " & vbNewLine _
    '                                    & ",COUNT(C_OUTKA_S.OUTKA_NO_S)   AS  S_COUNT                     " & vbNewLine _
    '                                    & "FROM                                                           " & vbNewLine _
    '                                    & "$LM_TRN$..C_OUTKA_S   C_OUTKA_S                                " & vbNewLine _
    '                                    & "WHERE                                                          " & vbNewLine _
    '                                    & "C_OUTKA_S.NRS_BR_CD   = @NRS_BR_CD                             " & vbNewLine _
    '                                    & "AND                                                            " & vbNewLine _
    '                                    & "C_OUTKA_S.SYS_DEL_FLG = '0'                                    " & vbNewLine _
    '                                    & "GROUP BY                                                       " & vbNewLine _
    '                                    & "C_OUTKA_S.OUTKA_NO_L                                           " & vbNewLine _
    '                                    & ")                           SCNT                               " & vbNewLine _
    '                                    & "ON                                                             " & vbNewLine _
    '                                    & "C_OUTKA_L.OUTKA_NO_L = SCNT.OUTKA_NO_L                         " & vbNewLine _
    '                                    & "LEFT JOIN                                                      " & vbNewLine _
    '                                    & "$LM_MST$..Z_KBN                Z2                              " & vbNewLine _
    '                                    & "ON                                                             " & vbNewLine _
    '                                    & "C_OUTKA_L.SYUBETU_KB = Z2.KBN_CD                               " & vbNewLine _
    '                                    & "AND                                                            " & vbNewLine _
    '                                    & "Z2.KBN_GROUP_CD = 'S020'                                       " & vbNewLine _
    '                                    & "LEFT JOIN                                                      " & vbNewLine _
    '                                    & "$LM_MST$..M_SOKO               M_SOKO                          " & vbNewLine _
    '                                    & "ON                                                             " & vbNewLine _
    '                                    & "M_SOKO.NRS_BR_CD = C_OUTKA_L.NRS_BR_CD                         " & vbNewLine _
    '                                    & "AND                                                            " & vbNewLine _
    '                                    & "M_SOKO.WH_CD = C_OUTKA_L.WH_CD                                 " & vbNewLine _
    '                                    & "LEFT JOIN                                                      " & vbNewLine _
    '                                    & "$LM_MST$..M_NRS_BR                                             " & vbNewLine _
    '                                    & "ON                                                             " & vbNewLine _
    '                                    & "C_OUTKA_L.NRS_BR_CD = M_NRS_BR.NRS_BR_CD                       " & vbNewLine _
    '                                    & "LEFT JOIN                                                      " & vbNewLine _
    '                                    & "(                                                              " & vbNewLine _
    '                                    & "SELECT                                                         " & vbNewLine _
    '                                    & "M_TCUST.CUST_CD_L AS CUST_CD_L                                 " & vbNewLine _
    '                                    & ",min(USER_CD) AS USER_CD                                       " & vbNewLine _
    '                                    & "FROM                                                           " & vbNewLine _
    '                                    & "$LM_MST$..M_TCUST              M_TCUST                         " & vbNewLine _
    '                                    & "GROUP BY                                                       " & vbNewLine _
    '                                    & "M_TCUST.CUST_CD_L                                              " & vbNewLine _
    '                                    & ") M_TCUST                                                      " & vbNewLine _
    '                                    & "ON                                                             " & vbNewLine _
    '                                    & "C_OUTKA_L.CUST_CD_L = M_TCUST.CUST_CD_L                        " & vbNewLine _
    '                                    & "LEFT JOIN                                                      " & vbNewLine _
    '                                    & "$LM_MST$..S_USER               TANTO_USER                      " & vbNewLine _
    '                                    & "ON                                                             " & vbNewLine _
    '                                    & "M_TCUST.USER_CD = TANTO_USER.USER_CD                           " & vbNewLine _
    '                                    & "LEFT JOIN                                                      " & vbNewLine _
    '                                    & "$LM_MST$..S_USER               ENT_USER                        " & vbNewLine _
    '                                    & "ON                                                             " & vbNewLine _
    '                                    & "C_OUTKA_L.SYS_ENT_USER = ENT_USER.USER_CD                      " & vbNewLine _
    '                                    & "LEFT JOIN                                                      " & vbNewLine _
    '                                    & "$LM_MST$..S_USER               UPD_USER                        " & vbNewLine _
    '                                    & "ON                                                             " & vbNewLine _
    '                                    & "C_OUTKA_L.SYS_UPD_USER = UPD_USER.USER_CD                      " & vbNewLine
    ' ''' <summary>
    ' ''' 検索用SQLFROM句
    ' ''' </summary>
    ' ''' <remarks></remarks>
    'Private Const SQL_FROM As String = "FROM                                                              " & vbNewLine _
    '                                    & "$LM_TRN$..C_OUTKA_L                                            " & vbNewLine _
    '                                    & "LEFT JOIN                                                      " & vbNewLine _
    '                                    & "$LM_MST$..Z_KBN                        Z1                      " & vbNewLine _
    '                                    & "ON                                                             " & vbNewLine _
    '                                    & "C_OUTKA_L.OUTKA_STATE_KB = Z1.KBN_CD                           " & vbNewLine _
    '                                    & "AND                                                            " & vbNewLine _
    '                                    & "Z1.KBN_GROUP_CD = 'S010'                                       " & vbNewLine _
    '                                    & "LEFT JOIN                                                      " & vbNewLine _
    '                                    & "$LM_MST$..M_CUST                       M_CUST                  " & vbNewLine _
    '                                    & "ON                                                             " & vbNewLine _
    '                                    & "C_OUTKA_L.NRS_BR_CD = M_CUST.NRS_BR_CD                         " & vbNewLine _
    '                                    & "AND                                                            " & vbNewLine _
    '                                    & "C_OUTKA_L.CUST_CD_L = M_CUST.CUST_CD_L                         " & vbNewLine _
    '                                    & "AND                                                            " & vbNewLine _
    '                                    & "C_OUTKA_L.CUST_CD_M = M_CUST.CUST_CD_M                         " & vbNewLine _
    '                                    & "AND                                                            " & vbNewLine _
    '                                    & "M_CUST.CUST_CD_S = '00'                                        " & vbNewLine _
    '                                    & "AND                                                            " & vbNewLine _
    '                                    & "M_CUST.CUST_CD_SS = '00'                                       " & vbNewLine _
    '                                    & "INNER JOIN                                                     " & vbNewLine _
    '                                    & "(                                                              " & vbNewLine _
    '                                    & "SELECT                                                         " & vbNewLine _
    '                                    & " C_OUTKA_M.NRS_BR_CD                                           " & vbNewLine _
    '                                    & ",C_OUTKA_M.OUTKA_NO_L                                          " & vbNewLine _
    '                                    & ",MIN(C_OUTKA_M.OUTKA_NO_M) AS OUTKA_NO_M                       " & vbNewLine _
    '                                    & ",SUM(C_OUTKA_M.OUTKA_TTL_NB) AS OUTKA_TTL_NB                   " & vbNewLine _
    '                                    & ",SUM(C_OUTKA_M.BACKLOG_NB) AS BACKLOG_NB                       " & vbNewLine _
    '                                    & ",SUM(C_OUTKA_M.BACKLOG_QT) AS BACKLOG_QT                       " & vbNewLine _
    '                                    & ",MIN(C_OUTKA_M.ALCTD_NB) AS MIN_ALCTD_NB                       " & vbNewLine _
    '                                    & ",MIN(C_OUTKA_M.ALCTD_QT) AS MIN_ALCTD_QT                       " & vbNewLine _
    '                                    & ",MIN(C_OUTKA_M.LOT_NO) AS LOT_NO                               " & vbNewLine _
    '                                    & ",MIN(C_OUTKA_M.SERIAL_NO) AS SERIAL_NO                         " & vbNewLine _
    '                                    & ",C_OUTKA_M.SYS_DEL_FLG                                         " & vbNewLine _
    '                                    & "FROM                                                           " & vbNewLine _
    '                                    & "$LM_TRN$..C_OUTKA_M     C_OUTKA_M                              " & vbNewLine _
    '                                    & "WHERE                                                          " & vbNewLine _
    '                                    & "C_OUTKA_M.NRS_BR_CD = @NRS_BR_CD                               " & vbNewLine
    '20160615 tsunehira add start
    ''' <summary>
    ''' 検索用SQLFROM句
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_FROM As String = "FROM                                                              " & vbNewLine _
                                        & "$LM_TRN$..C_OUTKA_L                                            " & vbNewLine _
                                        & "LEFT JOIN                                                      " & vbNewLine _
                                        & "    (SELECT                                                    " & vbNewLine _
                                        & "        KBN1.KBN_CD,                                           " & vbNewLine _
                                        & "        " & " #KBN# " & "     AS KBN_NM1                       " & vbNewLine _
                                        & "     FROM $LM_MST$..Z_KBN AS KBN1                              " & vbNewLine _
                                        & "     WHERE                                                     " & vbNewLine _
                                        & "        KBN1.KBN_GROUP_CD = 'S010')Z1                          " & vbNewLine _
                                        & "  ON C_OUTKA_L.OUTKA_STATE_KB = Z1.KBN_CD                      " & vbNewLine _
                                        & "LEFT JOIN                                                      " & vbNewLine _
                                        & "$LM_MST$..M_CUST                       M_CUST                  " & vbNewLine _
                                        & "ON                                                             " & vbNewLine _
                                        & "C_OUTKA_L.NRS_BR_CD = M_CUST.NRS_BR_CD                         " & vbNewLine _
                                        & "AND                                                            " & vbNewLine _
                                        & "C_OUTKA_L.CUST_CD_L = M_CUST.CUST_CD_L                         " & vbNewLine _
                                        & "AND                                                            " & vbNewLine _
                                        & "C_OUTKA_L.CUST_CD_M = M_CUST.CUST_CD_M                         " & vbNewLine _
                                        & "AND                                                            " & vbNewLine _
                                        & "M_CUST.CUST_CD_S = '00'                                        " & vbNewLine _
                                        & "AND                                                            " & vbNewLine _
                                        & "M_CUST.CUST_CD_SS = '00'                                       " & vbNewLine _
                                        & "INNER JOIN                                                     " & vbNewLine _
                                        & "(                                                              " & vbNewLine _
                                        & "SELECT                                                         " & vbNewLine _
                                        & " C_OUTKA_M.NRS_BR_CD                                           " & vbNewLine _
                                        & ",C_OUTKA_M.OUTKA_NO_L                                          " & vbNewLine _
                                        & ",MIN(C_OUTKA_M.OUTKA_NO_M) AS OUTKA_NO_M                       " & vbNewLine _
                                        & ",SUM(C_OUTKA_M.OUTKA_TTL_NB) AS OUTKA_TTL_NB                   " & vbNewLine _
                                        & ",SUM(C_OUTKA_M.BACKLOG_NB) AS BACKLOG_NB                       " & vbNewLine _
                                        & ",SUM(C_OUTKA_M.BACKLOG_QT) AS BACKLOG_QT                       " & vbNewLine _
                                        & ",MIN(C_OUTKA_M.ALCTD_NB) AS MIN_ALCTD_NB                       " & vbNewLine _
                                        & ",MIN(C_OUTKA_M.ALCTD_QT) AS MIN_ALCTD_QT                       " & vbNewLine _
                                        & ",MIN(C_OUTKA_M.LOT_NO) AS LOT_NO                               " & vbNewLine _
                                        & ",MIN(C_OUTKA_M.SERIAL_NO) AS SERIAL_NO                         " & vbNewLine _
                                        & ",C_OUTKA_M.SYS_DEL_FLG                                         " & vbNewLine _
                                        & "FROM                                                           " & vbNewLine _
                                        & "$LM_TRN$..C_OUTKA_M     C_OUTKA_M                              " & vbNewLine _
                                        & "WHERE                                                          " & vbNewLine _
                                        & "C_OUTKA_M.NRS_BR_CD = @NRS_BR_CD                               " & vbNewLine
    '20160615 tsunehira add end


    ' ''' <summary>
    ' ''' 検索用SQLFROM句
    ' ''' </summary>
    ' ''' <remarks></remarks>
    'Private Const SQL_FROM2 As String = "AND                                                              " & vbNewLine _
    '                                    & "C_OUTKA_M.SYS_DEL_FLG = '0'                                    " & vbNewLine _
    '                                    & "GROUP BY                                                       " & vbNewLine _
    '                                    & " C_OUTKA_M.NRS_BR_CD                                           " & vbNewLine _
    '                                    & ",C_OUTKA_M.OUTKA_NO_L                                          " & vbNewLine _
    '                                    & ",C_OUTKA_M.SYS_DEL_FLG                                         " & vbNewLine _
    '                                    & ")                   C_OUTKA_M                                  " & vbNewLine _
    '                                    & "ON                                                             " & vbNewLine _
    '                                    & "C_OUTKA_L.NRS_BR_CD =C_OUTKA_M.NRS_BR_CD                       " & vbNewLine _
    '                                    & "AND                                                            " & vbNewLine _
    '                                    & "C_OUTKA_L.OUTKA_NO_L =C_OUTKA_M.OUTKA_NO_L                     " & vbNewLine _
    '                                    & "LEFT JOIN                                                      " & vbNewLine _
    '                                    & "$LM_TRN$..C_OUTKA_M             C_OUTKA_M_MIN                  " & vbNewLine _
    '                                    & "ON                                                             " & vbNewLine _
    '                                    & "C_OUTKA_M.NRS_BR_CD =C_OUTKA_M_MIN.NRS_BR_CD                   " & vbNewLine _
    '                                    & "AND                                                            " & vbNewLine _
    '                                    & "C_OUTKA_M.OUTKA_NO_L =C_OUTKA_M_MIN.OUTKA_NO_L                 " & vbNewLine _
    '                                    & "AND                                                            " & vbNewLine _
    '                                    & "C_OUTKA_M.OUTKA_NO_M =C_OUTKA_M_MIN.OUTKA_NO_M                 " & vbNewLine _
    '                                    & "AND                                                            " & vbNewLine _
    '                                    & "C_OUTKA_M.SYS_DEL_FLG ='0'                                     " & vbNewLine _
    '                                    & "LEFT JOIN                                                      " & vbNewLine _
    '                                    & "$LM_MST$..M_DEST                       M_DEST                  " & vbNewLine _
    '                                    & "ON                                                             " & vbNewLine _
    '                                    & "C_OUTKA_L.NRS_BR_CD = M_DEST.NRS_BR_CD                         " & vbNewLine _
    '                                    & "AND                                                            " & vbNewLine _
    '                                    & "C_OUTKA_L.CUST_CD_L = M_DEST.CUST_CD_L                         " & vbNewLine _
    '                                    & "AND                                                            " & vbNewLine _
    '                                    & "C_OUTKA_L.DEST_CD = M_DEST.DEST_CD                             " & vbNewLine _
    '                                    & "LEFT JOIN                                                      " & vbNewLine _
    '                                    & "$LM_MST$..M_GOODS              M_GOODS                         " & vbNewLine _
    '                                    & "ON                                                             " & vbNewLine _
    '                                    & "C_OUTKA_M_MIN.NRS_BR_CD =M_GOODS.NRS_BR_CD                     " & vbNewLine _
    '                                    & "AND                                                            " & vbNewLine _
    '                                    & "C_OUTKA_M_MIN.GOODS_CD_NRS = M_GOODS.GOODS_CD_NRS              " & vbNewLine _
    '                                    & "LEFT JOIN                                                      " & vbNewLine _
    '                                    & "$LM_TRN$..F_UNSO_L                     F_UNSO_L                " & vbNewLine _
    '                                    & "ON                                                             " & vbNewLine _
    '                                    & "C_OUTKA_L.NRS_BR_CD = F_UNSO_L.NRS_BR_CD                       " & vbNewLine _
    '                                    & "AND                                                            " & vbNewLine _
    '                                    & "C_OUTKA_L.OUTKA_NO_L = F_UNSO_L.INOUTKA_NO_L                   " & vbNewLine _
    '                                    & "AND                                                            " & vbNewLine _
    '                                    & "F_UNSO_L.MOTO_DATA_KB = '20'                                   " & vbNewLine _
    '                                    & "AND                                                            " & vbNewLine _
    '                                    & "F_UNSO_L.SYS_DEL_FLG ='0'                                      " & vbNewLine _
    '                                    & "--★2013.02.27 / Notes1897対応開始                             " & vbNewLine _
    '                                    & "LEFT JOIN                                                      " & vbNewLine _
    '                                    & "$LM_MST$..Z_KBN AS                     BIN_Z                   " & vbNewLine _
    '                                    & "ON                                                             " & vbNewLine _
    '                                    & "F_UNSO_L.BIN_KB =BIN_Z.KBN_CD                                  " & vbNewLine _
    '                                    & "AND                                                            " & vbNewLine _
    '                                    & "BIN_Z.KBN_GROUP_CD = 'U001'                                    " & vbNewLine _
    '                                    & "--★2013.02.27 / Notes1897対応終了                             " & vbNewLine _
    '                                    & "LEFT JOIN                                                      " & vbNewLine _
    '                                    & "(                                                              " & vbNewLine _
    '                                    & "SELECT                                                         " & vbNewLine _
    '                                    & "NRS_BR_CD                                                      " & vbNewLine _
    '                                    & ", UNSO_NO_L                                                    " & vbNewLine _
    '                                    & ",MAX(SEIQ_FIXED_FLAG)        AS SEIQ_FIXED_FLAG                " & vbNewLine _
    '                                    & ",SYS_DEL_FLG                                                   " & vbNewLine _
    '                                    & "FROM                                                           " & vbNewLine _
    '                                    & "$LM_TRN$..F_UNCHIN_TRS                                         " & vbNewLine _
    '                                    & "WHERE                                                          " & vbNewLine _
    '                                    & "F_UNCHIN_TRS.NRS_BR_CD = @NRS_BR_CD                            " & vbNewLine _
    '                                    & "AND                                                            " & vbNewLine _
    '                                    & "F_UNCHIN_TRS.SYS_DEL_FLG ='0'                                  " & vbNewLine _
    '                                    & "GROUP BY                                                       " & vbNewLine _
    '                                    & "NRS_BR_CD, UNSO_NO_L, SYS_DEL_FLG                              " & vbNewLine _
    '                                    & ")            F_UNCHIN_TRS                                      " & vbNewLine _
    '                                    & "ON                                                             " & vbNewLine _
    '                                    & "F_UNSO_L.NRS_BR_CD = F_UNCHIN_TRS.NRS_BR_CD                    " & vbNewLine _
    '                                    & "AND                                                            " & vbNewLine _
    '                                    & "F_UNSO_L.UNSO_NO_L = F_UNCHIN_TRS.UNSO_NO_L                    " & vbNewLine _
    '                                    & "AND                                                            " & vbNewLine _
    '                                    & "F_UNCHIN_TRS.SYS_DEL_FLG = '0'                                 " & vbNewLine _
    '                                    & "--'要望番号1369:(支払-運送会社変更時、タリフを再取得し、再計算をおこなう⇒運行が紐付いている場合には、運行の運送会社変更時のみ動作) 2012/08/24 本明 Start " & vbNewLine _
    '                                    & "LEFT JOIN                                                      " & vbNewLine _
    '                                    & "(                                                              " & vbNewLine _
    '                                    & "SELECT                                                         " & vbNewLine _
    '                                    & "NRS_BR_CD                                                      " & vbNewLine _
    '                                    & ", UNSO_NO_L                                                    " & vbNewLine _
    '                                    & ",MAX(SHIHARAI_FIXED_FLAG)        AS SHIHARAI_FIXED_FLAG        " & vbNewLine _
    '                                    & ",SYS_DEL_FLG                                                   " & vbNewLine _
    '                                    & "FROM                                                           " & vbNewLine _
    '                                    & "$LM_TRN$..F_SHIHARAI_TRS                                       " & vbNewLine _
    '                                    & "WHERE                                                          " & vbNewLine _
    '                                    & "F_SHIHARAI_TRS.NRS_BR_CD = @NRS_BR_CD                          " & vbNewLine _
    '                                    & "AND                                                            " & vbNewLine _
    '                                    & "F_SHIHARAI_TRS.SYS_DEL_FLG ='0'                                " & vbNewLine _
    '                                    & "GROUP BY                                                       " & vbNewLine _
    '                                    & "NRS_BR_CD, UNSO_NO_L, SYS_DEL_FLG                              " & vbNewLine _
    '                                    & ")            F_SHIHARAI_TRS                                    " & vbNewLine _
    '                                    & "ON                                                             " & vbNewLine _
    '                                    & "F_UNSO_L.NRS_BR_CD = F_SHIHARAI_TRS.NRS_BR_CD                  " & vbNewLine _
    '                                    & "AND                                                            " & vbNewLine _
    '                                    & "F_UNSO_L.UNSO_NO_L = F_SHIHARAI_TRS.UNSO_NO_L                  " & vbNewLine _
    '                                    & "AND                                                            " & vbNewLine _
    '                                    & "F_SHIHARAI_TRS.SYS_DEL_FLG = '0'                               " & vbNewLine _
    '                                    & "--'要望番号1369:(支払-運送会社変更時、タリフを再取得し、再計算をおこなう⇒運行が紐付いている場合には、運行の運送会社変更時のみ動作) 2012/08/24 本明 End   " & vbNewLine _
    '                                    & "LEFT JOIN                                                      " & vbNewLine _
    '                                    & "$LM_MST$..M_UNSOCO                 M_UNSOCO                    " & vbNewLine _
    '                                    & "ON                                                             " & vbNewLine _
    '                                    & "C_OUTKA_L.NRS_BR_CD = M_UNSOCO.NRS_BR_CD                       " & vbNewLine _
    '                                    & "AND                                                            " & vbNewLine _
    '                                    & "F_UNSO_L.UNSO_CD = M_UNSOCO.UNSOCO_CD                          " & vbNewLine _
    '                                    & "AND                                                            " & vbNewLine _
    '                                    & "F_UNSO_L.UNSO_BR_CD = M_UNSOCO.UNSOCO_BR_CD                    " & vbNewLine _
    '                                    & "LEFT JOIN                                                      " & vbNewLine _
    '                                    & "(                                                              " & vbNewLine _
    '                                    & "SELECT                                                         " & vbNewLine _
    '                                    & "C_OUTKA_M.OUTKA_NO_L                                           " & vbNewLine _
    '                                    & ",COUNT(C_OUTKA_M.OUTKA_NO_M)   AS  M_COUNT                     " & vbNewLine _
    '                                    & "FROM                                                           " & vbNewLine _
    '                                    & "$LM_TRN$..C_OUTKA_M   C_OUTKA_M                                " & vbNewLine _
    '                                    & "WHERE                                                          " & vbNewLine _
    '                                    & "C_OUTKA_M.NRS_BR_CD = @NRS_BR_CD                               " & vbNewLine _
    '                                    & "AND                                                            " & vbNewLine _
    '                                    & "C_OUTKA_M.SYS_DEL_FLG = '0'                                    " & vbNewLine _
    '                                    & "GROUP BY                                                       " & vbNewLine _
    '                                    & "C_OUTKA_M.OUTKA_NO_L                                           " & vbNewLine _
    '                                    & ")                           MCNT                               " & vbNewLine _
    '                                    & "ON                                                             " & vbNewLine _
    '                                    & "C_OUTKA_L.OUTKA_NO_L = MCNT.OUTKA_NO_L                         " & vbNewLine _
    '                                    & "LEFT JOIN                                                      " & vbNewLine _
    '                                    & "(                                                              " & vbNewLine _
    '                                    & "SELECT                                                         " & vbNewLine _
    '                                    & "C_OUTKA_S.OUTKA_NO_L                                           " & vbNewLine _
    '                                    & ",COUNT(C_OUTKA_S.OUTKA_NO_S)   AS  S_COUNT                     " & vbNewLine _
    '                                    & "FROM                                                           " & vbNewLine _
    '                                    & "$LM_TRN$..C_OUTKA_S   C_OUTKA_S                                " & vbNewLine _
    '                                    & "WHERE                                                          " & vbNewLine _
    '                                    & "C_OUTKA_S.NRS_BR_CD   = @NRS_BR_CD                             " & vbNewLine _
    '                                    & "AND                                                            " & vbNewLine _
    '                                    & "C_OUTKA_S.SYS_DEL_FLG = '0'                                    " & vbNewLine _
    '                                    & "GROUP BY                                                       " & vbNewLine _
    '                                    & "C_OUTKA_S.OUTKA_NO_L                                           " & vbNewLine _
    '                                    & ")                           SCNT                               " & vbNewLine _
    '                                    & "ON                                                             " & vbNewLine _
    '                                    & "C_OUTKA_L.OUTKA_NO_L = SCNT.OUTKA_NO_L                         " & vbNewLine _
    '                                    & "LEFT JOIN                                                      " & vbNewLine _
    '                                    & "$LM_MST$..Z_KBN                Z2                              " & vbNewLine _
    '                                    & "ON                                                             " & vbNewLine _
    '                                    & "C_OUTKA_L.SYUBETU_KB = Z2.KBN_CD                               " & vbNewLine _
    '                                    & "AND                                                            " & vbNewLine _
    '                                    & "Z2.KBN_GROUP_CD = 'S020'                                       " & vbNewLine _
    '                                    & "LEFT JOIN                                                      " & vbNewLine _
    '                                    & "$LM_MST$..M_SOKO               M_SOKO                          " & vbNewLine _
    '                                    & "ON                                                             " & vbNewLine _
    '                                    & "M_SOKO.NRS_BR_CD = C_OUTKA_L.NRS_BR_CD                         " & vbNewLine _
    '                                    & "AND                                                            " & vbNewLine _
    '                                    & "M_SOKO.WH_CD = C_OUTKA_L.WH_CD                                 " & vbNewLine _
    '                                    & "LEFT JOIN                                                      " & vbNewLine _
    '                                    & "$LM_MST$..M_NRS_BR                                             " & vbNewLine _
    '                                    & "ON                                                             " & vbNewLine _
    '                                    & "C_OUTKA_L.NRS_BR_CD = M_NRS_BR.NRS_BR_CD                       " & vbNewLine _
    '                                    & " -- (2012.09.03) 要望番号1359 修正 --- START ---               " & vbNewLine _
    '                                    & " --LEFT JOIN                                                   " & vbNewLine _
    '                                    & " --(                                                           " & vbNewLine _
    '                                    & " --SELECT                                                      " & vbNewLine _
    '                                    & " --M_TCUST.CUST_CD_L AS CUST_CD_L                              " & vbNewLine _
    '                                    & " --,min(USER_CD) AS USER_CD                                    " & vbNewLine _
    '                                    & " --FROM                                                        " & vbNewLine _
    '                                    & " --$LM_MST$..M_TCUST              M_TCUST                      " & vbNewLine _
    '                                    & " --GROUP BY                                                    " & vbNewLine _
    '                                    & " --M_TCUST.CUST_CD_L                                           " & vbNewLine _
    '                                    & " --) M_TCUST                                                   " & vbNewLine _
    '                                    & " --ON                                                          " & vbNewLine _
    '                                    & " --C_OUTKA_L.CUST_CD_L = M_TCUST.CUST_CD_L                     " & vbNewLine _
    '                                    & "--'要望番号1613:担当者は荷主MとJOINする 2012/11/19 馬野 Start  " & vbNewLine _
    '                                    & " -- 下記のJOINに変更                                           " & vbNewLine _
    '                                    & " --LEFT JOIN (SELECT                                             " & vbNewLine _
    '                                    & " --                  M_TCUST.CUST_CD_L    AS CUST_CD_L           " & vbNewLine _
    '                                    & " --                , MIN(M_TCUST.USER_CD) AS USER_CD             " & vbNewLine _
    '                                    & " --                , S_USER.NRS_BR_CD     AS NRS_BR_CD           " & vbNewLine _
    '                                    & " --             FROM $LM_MST$..M_TCUST M_TCUST                   " & vbNewLine _
    '                                    & " --                  LEFT JOIN $LM_MST$..S_USER S_USER           " & vbNewLine _
    '                                    & " --                         ON S_USER.USER_CD = M_TCUST.USER_CD  " & vbNewLine _
    '                                    & " --            GROUP BY                                          " & vbNewLine _
    '                                    & " --                  M_TCUST.CUST_CD_L                           " & vbNewLine _
    '                                    & " --                , S_USER.NRS_BR_CD                            " & vbNewLine _
    '                                    & " --           ) M_TCUST                                          " & vbNewLine _
    '                                    & " --       ON M_TCUST.CUST_CD_L = C_OUTKA_L.CUST_CD_L             " & vbNewLine _
    '                                    & " --      AND M_TCUST.NRS_BR_CD = C_OUTKA_L.NRS_BR_CD             " & vbNewLine _
    '                                    & " -- (2012.09.03) 要望番号1359 修正 --- END ---                 " & vbNewLine _
    '                                    & "LEFT JOIN                                                      " & vbNewLine _
    '                                    & "$LM_MST$..S_USER               TANTO_USER                      " & vbNewLine _
    '                                    & "ON                                                             " & vbNewLine _
    '                                    & "M_CUST.TANTO_CD = TANTO_USER.USER_CD                           " & vbNewLine _
    '                                    & "--AND M_CUST.NRS_BR_CD = TANTO_USER.NRS_BR_CD                   " & vbNewLine _
    '                                    & "--M_TCUST.USER_CD = TANTO_USER.USER_CD                           " & vbNewLine _
    '                                    & " -- (2012.09.03) 要望番号1359 追加 --- START ---               " & vbNewLine _
    '                                    & "--AND M_TCUST.NRS_BR_CD = TANTO_USER.NRS_BR_CD                   " & vbNewLine _
    '                                    & " -- (2012.09.03) 要望番号1359 追加 ---  END  ---               " & vbNewLine _
    '                                    & "--'要望番号1613:担当者は荷主MとJOINする 2012/11/19 馬野 END    " & vbNewLine _
    '                                    & "LEFT JOIN                                                      " & vbNewLine _
    '                                    & "$LM_MST$..S_USER               ENT_USER                        " & vbNewLine _
    '                                    & "ON                                                             " & vbNewLine _
    '                                    & "C_OUTKA_L.SYS_ENT_USER = ENT_USER.USER_CD                      " & vbNewLine _
    '                                    & "LEFT JOIN                                                      " & vbNewLine _
    '                                    & "$LM_MST$..S_USER               UPD_USER                        " & vbNewLine _
    '                                    & "ON                                                             " & vbNewLine _
    '                                    & "C_OUTKA_L.SYS_UPD_USER = UPD_USER.USER_CD                      " & vbNewLine
    'END YANAI 要望番号1286 入荷・出荷画面の機能追加（出荷検索にロット、シリアル）
    'END YANAI 要望番号1158 一覧画面　引当前の出荷で納品書の印刷が出来てしまう

    '20160615 tsunehira add start
    ''' <summary>
    ''' 検索用SQLFROM句
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_FROM2 As String = "AND                                                              " & vbNewLine _
                                        & "C_OUTKA_M.SYS_DEL_FLG = '0'                                    " & vbNewLine _
                                        & "GROUP BY                                                       " & vbNewLine _
                                        & " C_OUTKA_M.NRS_BR_CD                                           " & vbNewLine _
                                        & ",C_OUTKA_M.OUTKA_NO_L                                          " & vbNewLine _
                                        & ",C_OUTKA_M.SYS_DEL_FLG                                         " & vbNewLine _
                                        & ")                   C_OUTKA_M                                  " & vbNewLine _
                                        & "ON                                                             " & vbNewLine _
                                        & "C_OUTKA_L.NRS_BR_CD =C_OUTKA_M.NRS_BR_CD                       " & vbNewLine _
                                        & "AND                                                            " & vbNewLine _
                                        & "C_OUTKA_L.OUTKA_NO_L =C_OUTKA_M.OUTKA_NO_L                     " & vbNewLine _
                                        & "LEFT JOIN                                                      " & vbNewLine _
                                        & "$LM_TRN$..C_OUTKA_M             C_OUTKA_M_MIN                  " & vbNewLine _
                                        & "ON                                                             " & vbNewLine _
                                        & "C_OUTKA_M.NRS_BR_CD =C_OUTKA_M_MIN.NRS_BR_CD                   " & vbNewLine _
                                        & "AND                                                            " & vbNewLine _
                                        & "C_OUTKA_M.OUTKA_NO_L =C_OUTKA_M_MIN.OUTKA_NO_L                 " & vbNewLine _
                                        & "AND                                                            " & vbNewLine _
                                        & "C_OUTKA_M.OUTKA_NO_M =C_OUTKA_M_MIN.OUTKA_NO_M                 " & vbNewLine _
                                        & "AND                                                            " & vbNewLine _
                                        & "C_OUTKA_M.SYS_DEL_FLG ='0'                                     " & vbNewLine _
                                        & "LEFT JOIN                                                      " & vbNewLine _
                                        & "$LM_MST$..M_DEST                       M_DEST                  " & vbNewLine _
                                        & "ON                                                             " & vbNewLine _
                                        & "C_OUTKA_L.NRS_BR_CD = M_DEST.NRS_BR_CD                         " & vbNewLine _
                                        & "AND                                                            " & vbNewLine _
                                        & "C_OUTKA_L.CUST_CD_L = M_DEST.CUST_CD_L                         " & vbNewLine _
                                        & "AND                                                            " & vbNewLine _
                                        & "C_OUTKA_L.DEST_CD = M_DEST.DEST_CD                             " & vbNewLine _
                                        & "LEFT JOIN                                                      " & vbNewLine _
                                        & "$LM_MST$..M_GOODS              M_GOODS                         " & vbNewLine _
                                        & "ON                                                             " & vbNewLine _
                                        & "C_OUTKA_M_MIN.NRS_BR_CD =M_GOODS.NRS_BR_CD                     " & vbNewLine _
                                        & "AND                                                            " & vbNewLine _
                                        & "C_OUTKA_M_MIN.GOODS_CD_NRS = M_GOODS.GOODS_CD_NRS              " & vbNewLine _
                                        & "LEFT JOIN                                                      " & vbNewLine _
                                        & "$LM_TRN$..F_UNSO_L                     F_UNSO_L                " & vbNewLine _
                                        & "ON                                                             " & vbNewLine _
                                        & "C_OUTKA_L.NRS_BR_CD = F_UNSO_L.NRS_BR_CD                       " & vbNewLine _
                                        & "AND                                                            " & vbNewLine _
                                        & "C_OUTKA_L.OUTKA_NO_L = F_UNSO_L.INOUTKA_NO_L                   " & vbNewLine _
                                        & "AND                                                            " & vbNewLine _
                                        & "F_UNSO_L.MOTO_DATA_KB = '20'                                   " & vbNewLine _
                                        & "AND                                                            " & vbNewLine _
                                        & "F_UNSO_L.SYS_DEL_FLG ='0'                                      " & vbNewLine _
                                        & "--★2013.02.27 / Notes1897対応開始                             " & vbNewLine _
                                        & "LEFT JOIN                                                      " & vbNewLine _
                                        & "    (SELECT                                                    " & vbNewLine _
                                        & "        KBN1.KBN_CD,                                           " & vbNewLine _
                                        & "        " & " #KBN# " & "     AS KBN_NM1                       " & vbNewLine _
                                        & "     FROM $LM_MST$..Z_KBN AS KBN1                              " & vbNewLine _
                                        & "     WHERE                                                     " & vbNewLine _
                                        & "        KBN1.KBN_GROUP_CD = 'U001')BIN_Z                       " & vbNewLine _
                                        & "  ON F_UNSO_L.BIN_KB =BIN_Z.KBN_CD                             " & vbNewLine _
                                        & "--★2013.02.27 / Notes1897対応終了                             " & vbNewLine _
                                        & "LEFT JOIN                                                      " & vbNewLine _
                                        & "(                                                              " & vbNewLine _
                                        & "SELECT                                                         " & vbNewLine _
                                        & "NRS_BR_CD                                                      " & vbNewLine _
                                        & ", UNSO_NO_L                                                    " & vbNewLine _
                                        & ",MAX(SEIQ_FIXED_FLAG)        AS SEIQ_FIXED_FLAG                " & vbNewLine _
                                        & ",SYS_DEL_FLG                                                   " & vbNewLine _
                                        & "FROM                                                           " & vbNewLine _
                                        & "$LM_TRN$..F_UNCHIN_TRS                                         " & vbNewLine _
                                        & "WHERE                                                          " & vbNewLine _
                                        & "F_UNCHIN_TRS.NRS_BR_CD = @NRS_BR_CD                            " & vbNewLine _
                                        & "AND                                                            " & vbNewLine _
                                        & "F_UNCHIN_TRS.SYS_DEL_FLG ='0'                                  " & vbNewLine _
                                        & "GROUP BY                                                       " & vbNewLine _
                                        & "NRS_BR_CD, UNSO_NO_L, SYS_DEL_FLG                              " & vbNewLine _
                                        & ")            F_UNCHIN_TRS                                      " & vbNewLine _
                                        & "ON                                                             " & vbNewLine _
                                        & "F_UNSO_L.NRS_BR_CD = F_UNCHIN_TRS.NRS_BR_CD                    " & vbNewLine _
                                        & "AND                                                            " & vbNewLine _
                                        & "F_UNSO_L.UNSO_NO_L = F_UNCHIN_TRS.UNSO_NO_L                    " & vbNewLine _
                                        & "AND                                                            " & vbNewLine _
                                        & "F_UNCHIN_TRS.SYS_DEL_FLG = '0'                                 " & vbNewLine _
                                        & "--'要望番号1369:(支払-運送会社変更時、タリフを再取得し、再計算をおこなう⇒運行が紐付いている場合には、運行の運送会社変更時のみ動作) 2012/08/24 本明 Start " & vbNewLine _
                                        & "LEFT JOIN                                                      " & vbNewLine _
                                        & "(                                                              " & vbNewLine _
                                        & "SELECT                                                         " & vbNewLine _
                                        & "NRS_BR_CD                                                      " & vbNewLine _
                                        & ", UNSO_NO_L                                                    " & vbNewLine _
                                        & ",MAX(SHIHARAI_FIXED_FLAG)        AS SHIHARAI_FIXED_FLAG        " & vbNewLine _
                                        & ",SYS_DEL_FLG                                                   " & vbNewLine _
                                        & "FROM                                                           " & vbNewLine _
                                        & "$LM_TRN$..F_SHIHARAI_TRS                                       " & vbNewLine _
                                        & "WHERE                                                          " & vbNewLine _
                                        & "F_SHIHARAI_TRS.NRS_BR_CD = @NRS_BR_CD                          " & vbNewLine _
                                        & "AND                                                            " & vbNewLine _
                                        & "F_SHIHARAI_TRS.SYS_DEL_FLG ='0'                                " & vbNewLine _
                                        & "GROUP BY                                                       " & vbNewLine _
                                        & "NRS_BR_CD, UNSO_NO_L, SYS_DEL_FLG                              " & vbNewLine _
                                        & ")            F_SHIHARAI_TRS                                    " & vbNewLine _
                                        & "ON                                                             " & vbNewLine _
                                        & "F_UNSO_L.NRS_BR_CD = F_SHIHARAI_TRS.NRS_BR_CD                  " & vbNewLine _
                                        & "AND                                                            " & vbNewLine _
                                        & "F_UNSO_L.UNSO_NO_L = F_SHIHARAI_TRS.UNSO_NO_L                  " & vbNewLine _
                                        & "AND                                                            " & vbNewLine _
                                        & "F_SHIHARAI_TRS.SYS_DEL_FLG = '0'                               " & vbNewLine _
                                        & "--'要望番号1369:(支払-運送会社変更時、タリフを再取得し、再計算をおこなう⇒運行が紐付いている場合には、運行の運送会社変更時のみ動作) 2012/08/24 本明 End   " & vbNewLine _
                                        & "LEFT JOIN                                                      " & vbNewLine _
                                        & "$LM_MST$..M_UNSOCO                 M_UNSOCO                    " & vbNewLine _
                                        & "ON                                                             " & vbNewLine _
                                        & "C_OUTKA_L.NRS_BR_CD = M_UNSOCO.NRS_BR_CD                       " & vbNewLine _
                                        & "AND                                                            " & vbNewLine _
                                        & "F_UNSO_L.UNSO_CD = M_UNSOCO.UNSOCO_CD                          " & vbNewLine _
                                        & "AND                                                            " & vbNewLine _
                                        & "F_UNSO_L.UNSO_BR_CD = M_UNSOCO.UNSOCO_BR_CD                    " & vbNewLine _
                                        & "LEFT JOIN                                                      " & vbNewLine _
                                        & "(                                                              " & vbNewLine _
                                        & "SELECT                                                         " & vbNewLine _
                                        & "C_OUTKA_M.OUTKA_NO_L                                           " & vbNewLine _
                                        & ",COUNT(C_OUTKA_M.OUTKA_NO_M)   AS  M_COUNT                     " & vbNewLine _
                                        & "FROM                                                           " & vbNewLine _
                                        & "$LM_TRN$..C_OUTKA_M   C_OUTKA_M                                " & vbNewLine _
                                        & "WHERE                                                          " & vbNewLine _
                                        & "C_OUTKA_M.NRS_BR_CD = @NRS_BR_CD                               " & vbNewLine _
                                        & "AND                                                            " & vbNewLine _
                                        & "C_OUTKA_M.SYS_DEL_FLG = '0'                                    " & vbNewLine _
                                        & "GROUP BY                                                       " & vbNewLine _
                                        & "C_OUTKA_M.OUTKA_NO_L                                           " & vbNewLine _
                                        & ")                           MCNT                               " & vbNewLine _
                                        & "ON                                                             " & vbNewLine _
                                        & "C_OUTKA_L.OUTKA_NO_L = MCNT.OUTKA_NO_L                         " & vbNewLine _
                                        & "LEFT JOIN                                                      " & vbNewLine _
                                        & "(                                                              " & vbNewLine _
                                        & "SELECT                                                         " & vbNewLine _
                                        & "C_OUTKA_S.OUTKA_NO_L                                           " & vbNewLine _
                                        & ",COUNT(C_OUTKA_S.OUTKA_NO_S)   AS  S_COUNT                     " & vbNewLine _
                                        & "FROM                                                           " & vbNewLine _
                                        & "$LM_TRN$..C_OUTKA_S   C_OUTKA_S                                " & vbNewLine _
                                        & "WHERE                                                          " & vbNewLine _
                                        & "C_OUTKA_S.NRS_BR_CD   = @NRS_BR_CD                             " & vbNewLine _
                                        & "AND                                                            " & vbNewLine _
                                        & "C_OUTKA_S.SYS_DEL_FLG = '0'                                    " & vbNewLine _
                                        & "GROUP BY                                                       " & vbNewLine _
                                        & "C_OUTKA_S.OUTKA_NO_L                                           " & vbNewLine _
                                        & ")                           SCNT                               " & vbNewLine _
                                        & "ON                                                             " & vbNewLine _
                                        & "C_OUTKA_L.OUTKA_NO_L = SCNT.OUTKA_NO_L                         " & vbNewLine _
                                        & "LEFT JOIN                                                      " & vbNewLine _
                                        & "    (SELECT                                                    " & vbNewLine _
                                        & "        KBN1.KBN_CD,                                           " & vbNewLine _
                                        & "        " & " #KBN# " & "     AS KBN_NM1                       " & vbNewLine _
                                        & "     FROM $LM_MST$..Z_KBN AS KBN1                              " & vbNewLine _
                                        & "     WHERE                                                     " & vbNewLine _
                                        & "        KBN1.KBN_GROUP_CD = 'S020')Z2                          " & vbNewLine _
                                        & "  ON C_OUTKA_L.SYUBETU_KB = Z2.KBN_CD                          " & vbNewLine _
                                        & "LEFT JOIN                                                      " & vbNewLine _
                                        & "$LM_MST$..M_SOKO               M_SOKO                          " & vbNewLine _
                                        & "ON                                                             " & vbNewLine _
                                        & "M_SOKO.NRS_BR_CD = C_OUTKA_L.NRS_BR_CD                         " & vbNewLine _
                                        & "AND                                                            " & vbNewLine _
                                        & "M_SOKO.WH_CD = C_OUTKA_L.WH_CD                                 " & vbNewLine _
                                        & "LEFT JOIN                                                      " & vbNewLine _
                                        & "$LM_MST$..M_NRS_BR                                             " & vbNewLine _
                                        & "ON                                                             " & vbNewLine _
                                        & "C_OUTKA_L.NRS_BR_CD = M_NRS_BR.NRS_BR_CD                       " & vbNewLine _
                                        & "LEFT JOIN                                                        " & vbNewLine _
                                        & "$LM_MST$..S_USER               TANTO_USER                        " & vbNewLine _
                                        & "ON                                                               " & vbNewLine _
                                        & "M_CUST.TANTO_CD = TANTO_USER.USER_CD                             " & vbNewLine _
                                        & "LEFT JOIN                                                        " & vbNewLine _
                                        & "$LM_MST$..S_USER               ENT_USER                          " & vbNewLine _
                                        & "ON                                                               " & vbNewLine _
                                        & "C_OUTKA_L.SYS_ENT_USER = ENT_USER.USER_CD                        " & vbNewLine _
                                        & "LEFT JOIN                                                        " & vbNewLine _
                                        & "$LM_MST$..S_USER               UPD_USER                          " & vbNewLine _
                                        & "ON                                                               " & vbNewLine _
                                        & "C_OUTKA_L.SYS_UPD_USER = UPD_USER.USER_CD                        " & vbNewLine _
                                        & "LEFT JOIN                                                                " & vbNewLine _
                                        & "   ( SELECT UNNEEDED_KENPIN.NRS_BR_CD                                    " & vbNewLine _
                                        & "          , UNNEEDED_KENPIN.OUTKA_NO_L                                   " & vbNewLine _
                                        & "          , CASE WHEN UNNEEDED_KENPIN.MIN_FLG = '1'                      " & vbNewLine _
                                        & "                 THEN '03'                         -- 検品不要           " & vbNewLine _
                                        & "                 WHEN UNNEEDED_KENPIN.MIN_FLG = '0'                      " & vbNewLine _
                                        & "                  AND UNNEEDED_KENPIN.MAX_FLG = '1'                      " & vbNewLine _
                                        & "                  AND MAX(KENPIN_WK_STATUS) = '02'                       " & vbNewLine _
                                        & "                 THEN '04'                         -- 部分検品済         " & vbNewLine _
                                        & "                 ELSE MAX(KENPIN_WK_STATUS)                              " & vbNewLine _
                                        & "             END                                                         " & vbNewLine _
                                        & "         AS WH_KENPIN_WK_STATUS                                          " & vbNewLine _
                                        & "       FROM                                                              " & vbNewLine _
                                        & "          ( SELECT CM.NRS_BR_CD                                          " & vbNewLine _
                                        & "                 , CM.OUTKA_NO_L                                         " & vbNewLine _
                                        & "                 , MIN(ISNULL(MGD.SET_NAIYO, 0)) AS MIN_FLG              " & vbNewLine _
                                        & "                 , MAX(ISNULL(MGD.SET_NAIYO, 0)) AS MAX_FLG              " & vbNewLine _
                                        & "              FROM $LM_TRN$..C_OUTKA_M AS CM                             " & vbNewLine _
                                        & "              LEFT JOIN                                                  " & vbNewLine _
                                        & "                 ( SELECT MGD.NRS_BR_CD                                  " & vbNewLine _
                                        & "                        , MGD.GOODS_CD_NRS                               " & vbNewLine _
                                        & "                        , MAX(SET_NAIYO) AS SET_NAIYO                    " & vbNewLine _
                                        & "                     FROM $LM_MST$..M_GOODS_DETAILS AS MGD               " & vbNewLine _
                                        & "                    WHERE MGD.SYS_DEL_FLG  = '0'                         " & vbNewLine _
                                        & "                      AND MGD.SUB_KB       = '58'                        " & vbNewLine _
                                        & "                    GROUP BY                                             " & vbNewLine _
                                        & "                          MGD.NRS_BR_CD                                  " & vbNewLine _
                                        & "                        , MGD.GOODS_CD_NRS                               " & vbNewLine _
                                        & "                 ) AS MGD                                                " & vbNewLine _
                                        & "                ON MGD.NRS_BR_CD    = CM.NRS_BR_CD                       " & vbNewLine _
                                        & "               AND MGD.GOODS_CD_NRS = CM.GOODS_CD_NRS                    " & vbNewLine _
                                        & "             WHERE CM.NRS_BR_CD     = @NRS_BR_CD                         " & vbNewLine _
                                        & "               AND CM.SYS_DEL_FLG   = '0'                                " & vbNewLine _
                                        & "             GROUP BY                                                    " & vbNewLine _
                                        & "                   CM.NRS_BR_CD                                          " & vbNewLine _
                                        & "                 , CM.OUTKA_NO_L                                         " & vbNewLine _
                                        & "          ) AS UNNEEDED_KENPIN                                           " & vbNewLine _
                                        & "       LEFT JOIN                                                         " & vbNewLine _
                                        & "            $LM_TRN$..C_OUTKA_KENPIN_DETAIL_WK AS WK                     " & vbNewLine _
                                        & "         ON WK.NRS_BR_CD  = UNNEEDED_KENPIN.NRS_BR_CD                    " & vbNewLine _
                                        & "        AND WK.OUTKA_NO_L = UNNEEDED_KENPIN.OUTKA_NO_L                   " & vbNewLine _
                                        & "      GROUP BY                                                           " & vbNewLine _
                                        & "            UNNEEDED_KENPIN.NRS_BR_CD                                    " & vbNewLine _
                                        & "          , UNNEEDED_KENPIN.OUTKA_NO_L                                   " & vbNewLine _
                                        & "          , UNNEEDED_KENPIN.MIN_FLG                                      " & vbNewLine _
                                        & "          , UNNEEDED_KENPIN.MAX_FLG                                      " & vbNewLine _
                                        & "   ) AS KENPIN_WK                                                        " & vbNewLine _
                                        & "  ON KENPIN_WK.NRS_BR_CD  = C_OUTKA_L.NRS_BR_CD                          " & vbNewLine _
                                        & " AND KENPIN_WK.OUTKA_NO_L = C_OUTKA_L.OUTKA_NO_L                         " & vbNewLine _
                                        & "LEFT JOIN $LM_MST$..Z_KBN AS WK_STATUS_M                                 " & vbNewLine _
                                        & "  ON WK_STATUS_M.KBN_GROUP_CD = 'S107'                                   " & vbNewLine _
                                        & " AND WK_STATUS_M.KBN_CD       = KENPIN_WK.WH_KENPIN_WK_STATUS            " & vbNewLine _
                                        & "LEFT JOIN $LM_MST$..Z_KBN AS WK_STATUS_L                                 " & vbNewLine _
                                        & "  ON WK_STATUS_L.KBN_GROUP_CD = 'S107'                                   " & vbNewLine _
                                        & " AND WK_STATUS_L.KBN_CD       = C_OUTKA_L.WH_KENPIN_WK_STATUS            " & vbNewLine _
                                        & "--依頼番号 001990  2018/07/13 ADD                                        " & vbNewLine _
                                        & " -- 未印刷(納品書)時,纏めﾋﾟｯｸ済みは対象外                                " & vbNewLine _
                                        & "LEFT JOIN $LM_MST$..M_CUST_DETAILS MCD                                   " & vbNewLine _
                                        & "  ON MCD.NRS_BR_CD    = C_OUTKA_L.NRS_BR_CD                              " & vbNewLine _
                                        & " AND MCD.CUST_CD      = C_OUTKA_L.CUST_CD_L                              " & vbNewLine _
                                        & " AND MCD.SUB_KB       = '9F'                                             " & vbNewLine _
                                        & " AND MCD.SET_NAIYO    = '1'                                              " & vbNewLine _
                                        & " AND MCD.SYS_DEL_FLG  = '0'                                              " & vbNewLine _
                                        & "--依頼番号 001990  2018/07/13 END                                        " & vbNewLine _
                                        & "LEFT JOIN GL_DB..VB_OUTKA_L WEB_OUTKA_L                                  " & vbNewLine _
                                        & "  ON WEB_OUTKA_L.NRS_BR_CD  = C_OUTKA_L.NRS_BR_CD                        " & vbNewLine _
                                        & " AND WEB_OUTKA_L.OUTKA_NO_L = C_OUTKA_L.OUTKA_NO_L                       " & vbNewLine _
                                        & " AND WEB_OUTKA_L.SYS_DEL_FLG  = '0'                                      " & vbNewLine _
                                        & "LEFT JOIN $LM_MST$..Z_KBN AS TAB_STATUS                                  " & vbNewLine _
                                        & "  ON TAB_STATUS.KBN_GROUP_CD = 'S118'                                    " & vbNewLine _
                                        & " AND TAB_STATUS.KBN_CD       = C_OUTKA_L.WH_TAB_STATUS                   " & vbNewLine _
                                        & "--ADD Start 2019/06/19 004870                                                     " & vbNewLine _
                                        & "LEFT JOIN                                                                         " & vbNewLine _
                                        & "  ( SELECT CM.NRS_BR_CD                                                           " & vbNewLine _
                                        & "         , CM.OUTKA_NO_L                                                          " & vbNewLine _
                                        & "      FROM $LM_TRN$..C_OUTKA_L AS CL                                              " & vbNewLine _
                                        & "      LEFT JOIN $LM_TRN$..C_OUTKA_M AS CM                                         " & vbNewLine _
                                        & "        ON CM.OUTKA_NO_L  = CL.OUTKA_NO_L                                         " & vbNewLine _
                                        & "       AND CM.NRS_BR_CD   = CL.NRS_BR_CD                                          " & vbNewLine _
                                        & "       AND CM.COA_YN      = '01'                                                  " & vbNewLine _
                                        & "       AND CM.SYS_DEL_FLG = '0'                                                   " & vbNewLine _
                                        & "      LEFT JOIN $LM_MST$..M_COA AS COA                                            " & vbNewLine _
                                        & "        ON COA.GOODS_CD_NRS = CM.GOODS_CD_NRS                                     " & vbNewLine _
                                        & "       AND COA.LOT_NO       = CM.LOT_NO                                           " & vbNewLine _
                                        & "       AND COA.DEST_CD      = CL.SHIP_CD_L                                        " & vbNewLine _
                                        & "       AND COA.NRS_BR_CD    = CM.NRS_BR_CD                                        " & vbNewLine _
                                        & "       AND COA.SYS_DEL_FLG  = '0'                                                 " & vbNewLine _
                                        & "     WHERE CL.NRS_BR_CD     =  @NRS_BR_CD                                         " & vbNewLine _
                                        & "--       AND CL.CUST_CD_L     =  @CUST_CD_L_COA_UMU                                 " & vbNewLine _
                                        & "       AND CL.SYS_DEL_FLG   = '0'                                                 " & vbNewLine _
                                        & "       AND CM.NRS_BR_CD IS NOT NULL                                               " & vbNewLine _
                                        & "       AND COA.NRS_BR_CD IS NULL                                                  " & vbNewLine _
                                        & "     GROUP BY CM.NRS_BR_CD                                                        " & vbNewLine _
                                        & "            , CM.OUTKA_NO_L                                                       " & vbNewLine _
                                        & "  ) AS COA_CHK                                                                    " & vbNewLine _
                                        & " ON COA_CHK.NRS_BR_CD = C_OUTKA_L.NRS_BR_CD                                       " & vbNewLine _
                                        & " AND COA_CHK.OUTKA_NO_L = C_OUTKA_L.OUTKA_NO_L                                    " & vbNewLine _
                                        & "LEFT JOIN $LM_MST$..Z_KBN AS KBN_COAUMU                                           " & vbNewLine _
                                        & "  ON KBN_COAUMU.KBN_GROUP_CD = 'U009'                                             " & vbNewLine _
                                        & " AND KBN_COAUMU.KBN_CD       = CASE WHEN COA_CHK.OUTKA_NO_L IS NULL THEN '00'     " & vbNewLine _
                                        & "                                    ELSE '01' END                                 " & vbNewLine _
                                        & "--ADD End   2019/06/19 004870                                                     " & vbNewLine

    '20160615 tsunehira add end


    ''' <summary>
    ''' 運送会社マスタﾁｪｯｸ用SQL
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_UNSOCO_MST_CHECK As String = "SELECT                              " & vbNewLine _
                                                 & "   COUNT(UNSOCO_CD)  AS REC_CNT     " & vbNewLine _
                                                 & "FROM                                " & vbNewLine _
                                                 & "$LM_MST$..M_UNSOCO                  " & vbNewLine _
                                                 & "WHERE                               " & vbNewLine _
                                                 & "    NRS_BR_CD      = @NRS_BR_CD     " & vbNewLine _
                                                 & "AND UNSOCO_CD      = @UNSOCO_CD     " & vbNewLine _
                                                 & "AND UNSOCO_BR_CD   = @UNSOCO_BR_CD  " & vbNewLine



    'START YANAI 20110914 一括引当対応
    'Private Const SQL_SELECT_OUTKA_M As String = " SELECT                                                            " & vbNewLine _
    '                                    & "            OUTKAM.OUTKA_NO_L                                             " & vbNewLine _
    '                                    & "           ,OUTKAM.OUTKA_NO_M                                             " & vbNewLine _
    '                                    & "           ,OUTKAM.SERIAL_NO                                              " & vbNewLine _
    '                                    & "           ,OUTKAM.RSV_NO                                                 " & vbNewLine _
    '                                    & "           ,OUTKAM.IRIME                                                  " & vbNewLine _
    '                                    & "           ,OUTKAM.ALCTD_KB                                               " & vbNewLine _
    '                                    & "           ,OUTKAM.ALCTD_NB                                               " & vbNewLine _
    '                                    & "           ,OUTKAM.BACKLOG_NB                                             " & vbNewLine _
    '                                    & "           ,OUTKAM.ALCTD_QT                                               " & vbNewLine _
    '                                    & "           ,OUTKAM.BACKLOG_QT                                             " & vbNewLine _
    '                                    & "           ,OUTKAM.OUTKA_HASU                                             " & vbNewLine _
    '                                    & "           ,OUTKAM.OUTKA_TTL_NB                                           " & vbNewLine _
    '                                    & "           ,OUTKAM.OUTKA_TTL_QT                                           " & vbNewLine _
    '                                    & "           ,OUTKAM.OUTKA_PKG_NB                                           " & vbNewLine _
    '                                    & "           ,MAX(C_OUTKA_S.OUTKA_NO_S) AS OUTKA_NO_S                       " & vbNewLine _
    '                                    & "           ,@SYS_UPD_DATE             AS SYS_UPD_DATE                     " & vbNewLine _
    '                                    & "           ,@SYS_UPD_TIME             AS SYS_UPD_TIME                     " & vbNewLine _
    '                                    & "        FROM $LM_TRN$..C_OUTKA_M OUTKAM                                   " & vbNewLine _
    '                                    & "           LEFT JOIN                                                      " & vbNewLine _
    '                                    & "           $LM_TRN$..C_OUTKA_S                                            " & vbNewLine _
    '                                    & "           ON OUTKAM.NRS_BR_CD = C_OUTKA_S.NRS_BR_CD                      " & vbNewLine _
    '                                    & "           AND OUTKAM.OUTKA_NO_L = C_OUTKA_S.OUTKA_NO_L                   " & vbNewLine _
    '                                    & "           AND OUTKAM.OUTKA_NO_M = C_OUTKA_S.OUTKA_NO_M                   " & vbNewLine _
    '                                    & "        WHERE OUTKAM.NRS_BR_CD = @NRS_BR_CD                               " & vbNewLine _
    '                                    & "           AND OUTKAM.OUTKA_NO_L = @OUTKA_NO_L                            " & vbNewLine _
    '                                    & "           AND OUTKAM.SYS_DEL_FLG = '0'                                   " & vbNewLine _
    '                                    & "           GROUP BY                                                       " & vbNewLine _
    '                                    & "           OUTKAM.OUTKA_NO_L                                              " & vbNewLine _
    '                                    & "           ,OUTKAM.OUTKA_NO_M                                             " & vbNewLine _
    '                                    & "           ,OUTKAM.SERIAL_NO                                              " & vbNewLine _
    '                                    & "           ,OUTKAM.RSV_NO                                                 " & vbNewLine _
    '                                    & "           ,OUTKAM.IRIME                                                  " & vbNewLine _
    '                                    & "           ,OUTKAM.ALCTD_KB                                               " & vbNewLine _
    '                                    & "           ,OUTKAM.ALCTD_NB                                               " & vbNewLine _
    '                                    & "           ,OUTKAM.BACKLOG_NB                                             " & vbNewLine _
    '                                    & "           ,OUTKAM.ALCTD_QT                                               " & vbNewLine _
    '                                    & "           ,OUTKAM.BACKLOG_QT                                             " & vbNewLine _
    '                                    & "           ,OUTKAM.OUTKA_HASU                                             " & vbNewLine _
    '                                    & "           ,OUTKAM.OUTKA_TTL_NB                                           " & vbNewLine _
    '                                    & "           ,OUTKAM.OUTKA_TTL_QT                                           " & vbNewLine _
    '                                    & "           ,OUTKAM.OUTKA_PKG_NB                                           " & vbNewLine _
    '                                    & "           ,OUTKAM.OUTKA_NO_M                                             " & vbNewLine
    'START YANAI 要望番号585
    'Private Const SQL_SELECT_OUTKA_M As String = " SELECT                                                            " & vbNewLine _
    '                                    & "            OUTKAM.OUTKA_NO_L                                             " & vbNewLine _
    '                                    & "           ,OUTKAM.OUTKA_NO_M                                             " & vbNewLine _
    '                                    & "           ,OUTKAM.SERIAL_NO                                              " & vbNewLine _
    '                                    & "           ,OUTKAM.RSV_NO                                                 " & vbNewLine _
    '                                    & "           ,OUTKAM.IRIME                                                  " & vbNewLine _
    '                                    & "           ,OUTKAM.ALCTD_KB                                               " & vbNewLine _
    '                                    & "           ,OUTKAM.ALCTD_NB                                               " & vbNewLine _
    '                                    & "           ,OUTKAM.BACKLOG_NB                                             " & vbNewLine _
    '                                    & "           ,OUTKAM.ALCTD_QT                                               " & vbNewLine _
    '                                    & "           ,OUTKAM.BACKLOG_QT                                             " & vbNewLine _
    '                                    & "           ,OUTKAM.OUTKA_HASU                                             " & vbNewLine _
    '                                    & "           ,OUTKAM.OUTKA_TTL_NB                                           " & vbNewLine _
    '                                    & "           ,OUTKAM.OUTKA_TTL_QT                                           " & vbNewLine _
    '                                    & "           ,OUTKAM.OUTKA_PKG_NB                                           " & vbNewLine _
    '                                    & "           ,MAX(C_OUTKA_S.OUTKA_NO_S) AS OUTKA_NO_S                       " & vbNewLine _
    '                                    & "           ,OUTKAL.OUTKA_STATE_KB AS OUTKA_STATE_KB                       " & vbNewLine _
    '                                    & "           ,OUTKAL.PICK_KB AS PICK_KB                                     " & vbNewLine _
    '                                    & "           ,OUTKAL.WH_CD AS WH_CD                                         " & vbNewLine _
    '                                    & "           ,@SYS_UPD_DATE             AS SYS_UPD_DATE                     " & vbNewLine _
    '                                    & "           ,@SYS_UPD_TIME             AS SYS_UPD_TIME                     " & vbNewLine _
    '                                    & "           ,GOODS.PKG_NB AS PKG_NB                                        " & vbNewLine _
    '                                    & "           ,OUTKAM.GOODS_CD_NRS AS GOODS_CD_NRS                           " & vbNewLine _
    '                                    & "           ,GOODS.GOODS_NM_1 AS GOODS_NM                                  " & vbNewLine _
    '                                    & "           ,OUTKAM.LOT_NO AS LOT_NO                                       " & vbNewLine _
    '                                    & "           ,OUTKAM.GOODS_CD_NRS_FROM AS GOODS_CD_NRS_FROM                 " & vbNewLine _
    '                                    & "        FROM $LM_TRN$..C_OUTKA_M OUTKAM                                   " & vbNewLine _
    '                                    & "           LEFT JOIN                                                      " & vbNewLine _
    '                                    & "           $LM_TRN$..C_OUTKA_S                                            " & vbNewLine _
    '                                    & "           ON OUTKAM.NRS_BR_CD = C_OUTKA_S.NRS_BR_CD                      " & vbNewLine _
    '                                    & "           AND OUTKAM.OUTKA_NO_L = C_OUTKA_S.OUTKA_NO_L                   " & vbNewLine _
    '                                    & "           AND OUTKAM.OUTKA_NO_M = C_OUTKA_S.OUTKA_NO_M                   " & vbNewLine _
    '                                    & "           LEFT JOIN                                                      " & vbNewLine _
    '                                    & "           $LM_TRN$..C_OUTKA_L OUTKAL                                     " & vbNewLine _
    '                                    & "           ON OUTKAL.NRS_BR_CD = OUTKAM.NRS_BR_CD                         " & vbNewLine _
    '                                    & "           AND OUTKAL.OUTKA_NO_L = OUTKAM.OUTKA_NO_L                      " & vbNewLine _
    '                                    & "           AND OUTKAL.SYS_DEL_FLG = '0'                                   " & vbNewLine _
    '                                    & "           LEFT JOIN                                                      " & vbNewLine _
    '                                    & "           $LM_MST$..M_GOODS GOODS                                     " & vbNewLine _
    '                                    & "           ON OUTKAM.NRS_BR_CD = GOODS.NRS_BR_CD                         " & vbNewLine _
    '                                    & "           AND OUTKAM.GOODS_CD_NRS = GOODS.GOODS_CD_NRS                      " & vbNewLine _
    '                                    & "        WHERE OUTKAM.NRS_BR_CD = @NRS_BR_CD                               " & vbNewLine _
    '                                    & "           AND OUTKAM.OUTKA_NO_L = @OUTKA_NO_L                            " & vbNewLine _
    '                                    & "           AND (OUTKAM.BACKLOG_NB <> '0'                                  " & vbNewLine _
    '                                    & "            OR  OUTKAM.BACKLOG_QT <> '0')                                 " & vbNewLine _
    '                                    & "           AND OUTKAM.SYS_DEL_FLG = '0'                                   " & vbNewLine _
    '                                    & "           GROUP BY                                                       " & vbNewLine _
    '                                    & "           OUTKAM.OUTKA_NO_L                                              " & vbNewLine _
    '                                    & "           ,OUTKAM.OUTKA_NO_M                                             " & vbNewLine _
    '                                    & "           ,OUTKAM.SERIAL_NO                                              " & vbNewLine _
    '                                    & "           ,OUTKAM.RSV_NO                                                 " & vbNewLine _
    '                                    & "           ,OUTKAM.IRIME                                                  " & vbNewLine _
    '                                    & "           ,OUTKAM.ALCTD_KB                                               " & vbNewLine _
    '                                    & "           ,OUTKAM.ALCTD_NB                                               " & vbNewLine _
    '                                    & "           ,OUTKAM.BACKLOG_NB                                             " & vbNewLine _
    '                                    & "           ,OUTKAM.ALCTD_QT                                               " & vbNewLine _
    '                                    & "           ,OUTKAM.BACKLOG_QT                                             " & vbNewLine _
    '                                    & "           ,OUTKAM.OUTKA_HASU                                             " & vbNewLine _
    '                                    & "           ,OUTKAM.OUTKA_TTL_NB                                           " & vbNewLine _
    '                                    & "           ,OUTKAM.OUTKA_TTL_QT                                           " & vbNewLine _
    '                                    & "           ,OUTKAM.OUTKA_PKG_NB                                           " & vbNewLine _
    '                                    & "           ,OUTKAM.OUTKA_NO_M                                             " & vbNewLine _
    '                                    & "           ,OUTKAL.OUTKA_STATE_KB                                         " & vbNewLine _
    '                                    & "           ,OUTKAL.PICK_KB                                                " & vbNewLine _
    '                                    & "           ,OUTKAL.WH_CD                                                  " & vbNewLine _
    '                                    & "           ,GOODS.PKG_NB                                                  " & vbNewLine _
    '                                    & "           ,OUTKAM.GOODS_CD_NRS                                           " & vbNewLine _
    '                                    & "           ,GOODS.GOODS_NM_1                                              " & vbNewLine _
    '                                    & "           ,OUTKAM.LOT_NO                                                 " & vbNewLine _
    '                                    & "           ,OUTKAM.GOODS_CD_NRS_FROM                                      " & vbNewLine
    'START YANAI 要望番号638
    'Private Const SQL_SELECT_OUTKA_M As String = " SELECT                                                            " & vbNewLine _
    '                                    & "            OUTKAM.OUTKA_NO_L                                             " & vbNewLine _
    '                                    & "           ,OUTKAM.OUTKA_NO_M                                             " & vbNewLine _
    '                                    & "           ,OUTKAM.SERIAL_NO                                              " & vbNewLine _
    '                                    & "           ,OUTKAM.RSV_NO                                                 " & vbNewLine _
    '                                    & "           ,OUTKAM.IRIME                                                  " & vbNewLine _
    '                                    & "           ,OUTKAM.ALCTD_KB                                               " & vbNewLine _
    '                                    & "           ,OUTKAM.ALCTD_NB                                               " & vbNewLine _
    '                                    & "           ,OUTKAM.BACKLOG_NB                                             " & vbNewLine _
    '                                    & "           ,OUTKAM.ALCTD_QT                                               " & vbNewLine _
    '                                    & "           ,OUTKAM.BACKLOG_QT                                             " & vbNewLine _
    '                                    & "           ,OUTKAM.OUTKA_HASU                                             " & vbNewLine _
    '                                    & "           ,OUTKAM.OUTKA_TTL_NB                                           " & vbNewLine _
    '                                    & "           ,OUTKAM.OUTKA_TTL_QT                                           " & vbNewLine _
    '                                    & "           ,OUTKAM.OUTKA_PKG_NB                                           " & vbNewLine _
    '                                    & "           ,MAX(C_OUTKA_S.OUTKA_NO_S) AS OUTKA_NO_S                       " & vbNewLine _
    '                                    & "           ,OUTKAL.OUTKA_STATE_KB AS OUTKA_STATE_KB                       " & vbNewLine _
    '                                    & "           ,OUTKAL.PICK_KB AS PICK_KB                                     " & vbNewLine _
    '                                    & "           ,OUTKAL.WH_CD AS WH_CD                                         " & vbNewLine _
    '                                    & "           ,@SYS_UPD_DATE             AS SYS_UPD_DATE                     " & vbNewLine _
    '                                    & "           ,@SYS_UPD_TIME             AS SYS_UPD_TIME                     " & vbNewLine _
    '                                    & "           ,GOODS.PKG_NB AS PKG_NB                                        " & vbNewLine _
    '                                    & "           ,OUTKAM.GOODS_CD_NRS AS GOODS_CD_NRS                           " & vbNewLine _
    '                                    & "           ,GOODS.GOODS_NM_1 AS GOODS_NM                                  " & vbNewLine _
    '                                    & "           ,OUTKAM.LOT_NO AS LOT_NO                                       " & vbNewLine _
    '                                    & "           ,OUTKAM.GOODS_CD_NRS_FROM AS GOODS_CD_NRS_FROM                 " & vbNewLine _
    '                                    & "           ,ISNULL(UNSOCO.TARE_YN,'') AS TARE_YN                          " & vbNewLine _
    '                                    & "           ,ISNULL(UNSOL.UNSO_NO_L,'') AS UNSO_NO_L                       " & vbNewLine _
    '                                    & "           ,ISNULL(UNSOL.SYS_UPD_DATE,'') AS UNSOL_SYS_UPD_DATE           " & vbNewLine _
    '                                    & "           ,ISNULL(UNSOL.SYS_UPD_TIME,'') AS UNSOL_SYS_UPD_TIME           " & vbNewLine _
    '                                    & "        FROM $LM_TRN$..C_OUTKA_M OUTKAM                                   " & vbNewLine _
    '                                    & "           LEFT JOIN                                                      " & vbNewLine _
    '                                    & "           $LM_TRN$..C_OUTKA_S                                            " & vbNewLine _
    '                                    & "           ON OUTKAM.NRS_BR_CD = C_OUTKA_S.NRS_BR_CD                      " & vbNewLine _
    '                                    & "           AND OUTKAM.OUTKA_NO_L = C_OUTKA_S.OUTKA_NO_L                   " & vbNewLine _
    '                                    & "           AND OUTKAM.OUTKA_NO_M = C_OUTKA_S.OUTKA_NO_M                   " & vbNewLine _
    '                                    & "           LEFT JOIN                                                      " & vbNewLine _
    '                                    & "           $LM_TRN$..C_OUTKA_L OUTKAL                                     " & vbNewLine _
    '                                    & "           ON OUTKAL.NRS_BR_CD = OUTKAM.NRS_BR_CD                         " & vbNewLine _
    '                                    & "           AND OUTKAL.OUTKA_NO_L = OUTKAM.OUTKA_NO_L                      " & vbNewLine _
    '                                    & "           AND OUTKAL.SYS_DEL_FLG = '0'                                   " & vbNewLine _
    '                                    & "           LEFT JOIN                                                      " & vbNewLine _
    '                                    & "           $LM_MST$..M_GOODS GOODS                                     " & vbNewLine _
    '                                    & "           ON OUTKAM.NRS_BR_CD = GOODS.NRS_BR_CD                         " & vbNewLine _
    '                                    & "           AND OUTKAM.GOODS_CD_NRS = GOODS.GOODS_CD_NRS                      " & vbNewLine _
    '                                    & "           LEFT JOIN                                                      " & vbNewLine _
    '                                    & "           $LM_TRN$..F_UNSO_L UNSOL                                       " & vbNewLine _
    '                                    & "           ON UNSOL.NRS_BR_CD = OUTKAL.NRS_BR_CD                          " & vbNewLine _
    '                                    & "           AND UNSOL.INOUTKA_NO_L = OUTKAL.OUTKA_NO_L                     " & vbNewLine _
    '                                    & "           AND UNSOL.SYS_DEL_FLG = '0'                                    " & vbNewLine _
    '                                    & "           LEFT JOIN                                                      " & vbNewLine _
    '                                    & "           $LM_MST$..M_UNSOCO UNSOCO                                      " & vbNewLine _
    '                                    & "           ON UNSOCO.NRS_BR_CD = UNSOL.NRS_BR_CD                          " & vbNewLine _
    '                                    & "           AND UNSOCO.UNSOCO_CD = UNSOL.UNSO_CD                           " & vbNewLine _
    '                                    & "           AND UNSOCO.UNSOCO_BR_CD = UNSOL.UNSO_BR_CD                     " & vbNewLine _
    '                                    & "        WHERE OUTKAM.NRS_BR_CD = @NRS_BR_CD                               " & vbNewLine _
    '                                    & "           AND OUTKAM.OUTKA_NO_L = @OUTKA_NO_L                            " & vbNewLine _
    '                                    & "           AND (OUTKAM.BACKLOG_NB <> '0'                                  " & vbNewLine _
    '                                    & "            OR  OUTKAM.BACKLOG_QT <> '0')                                 " & vbNewLine _
    '                                    & "           AND OUTKAM.SYS_DEL_FLG = '0'                                   " & vbNewLine _
    '                                    & "           GROUP BY                                                       " & vbNewLine _
    '                                    & "           OUTKAM.OUTKA_NO_L                                              " & vbNewLine _
    '                                    & "           ,OUTKAM.OUTKA_NO_M                                             " & vbNewLine _
    '                                    & "           ,OUTKAM.SERIAL_NO                                              " & vbNewLine _
    '                                    & "           ,OUTKAM.RSV_NO                                                 " & vbNewLine _
    '                                    & "           ,OUTKAM.IRIME                                                  " & vbNewLine _
    '                                    & "           ,OUTKAM.ALCTD_KB                                               " & vbNewLine _
    '                                    & "           ,OUTKAM.ALCTD_NB                                               " & vbNewLine _
    '                                    & "           ,OUTKAM.BACKLOG_NB                                             " & vbNewLine _
    '                                    & "           ,OUTKAM.ALCTD_QT                                               " & vbNewLine _
    '                                    & "           ,OUTKAM.BACKLOG_QT                                             " & vbNewLine _
    '                                    & "           ,OUTKAM.OUTKA_HASU                                             " & vbNewLine _
    '                                    & "           ,OUTKAM.OUTKA_TTL_NB                                           " & vbNewLine _
    '                                    & "           ,OUTKAM.OUTKA_TTL_QT                                           " & vbNewLine _
    '                                    & "           ,OUTKAM.OUTKA_PKG_NB                                           " & vbNewLine _
    '                                    & "           ,OUTKAM.OUTKA_NO_M                                             " & vbNewLine _
    '                                    & "           ,OUTKAL.OUTKA_STATE_KB                                         " & vbNewLine _
    '                                    & "           ,OUTKAL.PICK_KB                                                " & vbNewLine _
    '                                    & "           ,OUTKAL.WH_CD                                                  " & vbNewLine _
    '                                    & "           ,GOODS.PKG_NB                                                  " & vbNewLine _
    '                                    & "           ,OUTKAM.GOODS_CD_NRS                                           " & vbNewLine _
    '                                    & "           ,GOODS.GOODS_NM_1                                              " & vbNewLine _
    '                                    & "           ,OUTKAM.LOT_NO                                                 " & vbNewLine _
    '                                    & "           ,OUTKAM.GOODS_CD_NRS_FROM                                      " & vbNewLine _
    '                                    & "           ,UNSOCO.TARE_YN                                                " & vbNewLine _
    '                                    & "           ,UNSOL.UNSO_NO_L                                               " & vbNewLine _
    '                                    & "           ,UNSOL.SYS_UPD_DATE                                            " & vbNewLine _
    '                                    & "           ,UNSOL.SYS_UPD_TIME                                            " & vbNewLine
    'START YANAI 要望番号1474 一括引当時、引当が出来ない場合のエラーメッセージ変更
    'Private Const SQL_SELECT_OUTKA_M As String = " SELECT                                                            " & vbNewLine _
    '                                        & "            OUTKAM.OUTKA_NO_L                                             " & vbNewLine _
    '                                        & "           ,OUTKAM.OUTKA_NO_M                                             " & vbNewLine _
    '                                        & "           ,OUTKAM.SERIAL_NO                                              " & vbNewLine _
    '                                        & "           ,OUTKAM.RSV_NO                                                 " & vbNewLine _
    '                                        & "           ,OUTKAM.IRIME                                                  " & vbNewLine _
    '                                        & "           ,OUTKAM.ALCTD_KB                                               " & vbNewLine _
    '                                        & "           ,OUTKAM.ALCTD_NB                                               " & vbNewLine _
    '                                        & "           ,OUTKAM.BACKLOG_NB                                             " & vbNewLine _
    '                                        & "           ,OUTKAM.ALCTD_QT                                               " & vbNewLine _
    '                                        & "           ,OUTKAM.BACKLOG_QT                                             " & vbNewLine _
    '                                        & "           ,OUTKAM.OUTKA_HASU                                             " & vbNewLine _
    '                                        & "           ,OUTKAM.OUTKA_TTL_NB                                           " & vbNewLine _
    '                                        & "           ,OUTKAM.OUTKA_TTL_QT                                           " & vbNewLine _
    '                                        & "           ,OUTKAM.OUTKA_PKG_NB                                           " & vbNewLine _
    '                                        & "           ,MAX(C_OUTKA_S.OUTKA_NO_S) AS OUTKA_NO_S                       " & vbNewLine _
    '                                        & "           ,OUTKAL.OUTKA_STATE_KB AS OUTKA_STATE_KB                       " & vbNewLine _
    '                                        & "           ,OUTKAL.PICK_KB AS PICK_KB                                     " & vbNewLine _
    '                                        & "           ,OUTKAL.WH_CD AS WH_CD                                         " & vbNewLine _
    '                                        & "           ,@SYS_UPD_DATE             AS SYS_UPD_DATE                     " & vbNewLine _
    '                                        & "           ,@SYS_UPD_TIME             AS SYS_UPD_TIME                     " & vbNewLine _
    '                                        & "           ,GOODS.PKG_NB AS PKG_NB                                        " & vbNewLine _
    '                                        & "           ,OUTKAM.GOODS_CD_NRS AS GOODS_CD_NRS                           " & vbNewLine _
    '                                        & "           ,GOODS.GOODS_NM_1 AS GOODS_NM                                  " & vbNewLine _
    '                                        & "           ,OUTKAM.LOT_NO AS LOT_NO                                       " & vbNewLine _
    '                                        & "           ,OUTKAM.GOODS_CD_NRS_FROM AS GOODS_CD_NRS_FROM                 " & vbNewLine _
    '                                        & "           ,ISNULL(UNSOCO.TARE_YN,'') AS TARE_YN                          " & vbNewLine _
    '                                        & "           ,ISNULL(UNSOL.UNSO_NO_L,'') AS UNSO_NO_L                       " & vbNewLine _
    '                                        & "           ,ISNULL(UNSOL.SYS_UPD_DATE,'') AS UNSOL_SYS_UPD_DATE           " & vbNewLine _
    '                                        & "           ,ISNULL(UNSOL.SYS_UPD_TIME,'') AS UNSOL_SYS_UPD_TIME           " & vbNewLine _
    '                                        & "           ,ISNULL(MAX(UNCHIN.UNSO_NO_M),'') AS UNSO_NO_M                 " & vbNewLine _
    '                                        & "           ,ISNULL(UNCHIN.SYS_UPD_DATE,'') AS UNCHIN_SYS_UPD_DATE         " & vbNewLine _
    '                                        & "           ,ISNULL(UNCHIN.SYS_UPD_TIME,'') AS UNCHIN_SYS_UPD_TIME         " & vbNewLine _
    '                                        & "           ,ISNULL(UNSOL.UNSO_TEHAI_KB,'') AS UNSO_TEHAI_KB               " & vbNewLine _
    '                                        & "        FROM $LM_TRN$..C_OUTKA_M OUTKAM                                   " & vbNewLine _
    '                                        & "           LEFT JOIN                                                      " & vbNewLine _
    '                                        & "           $LM_TRN$..C_OUTKA_S                                            " & vbNewLine _
    '                                        & "           ON OUTKAM.NRS_BR_CD = C_OUTKA_S.NRS_BR_CD                      " & vbNewLine _
    '                                        & "           AND OUTKAM.OUTKA_NO_L = C_OUTKA_S.OUTKA_NO_L                   " & vbNewLine _
    '                                        & "           AND OUTKAM.OUTKA_NO_M = C_OUTKA_S.OUTKA_NO_M                   " & vbNewLine _
    '                                        & "           LEFT JOIN                                                      " & vbNewLine _
    '                                        & "           $LM_TRN$..C_OUTKA_L OUTKAL                                     " & vbNewLine _
    '                                        & "           ON OUTKAL.NRS_BR_CD = OUTKAM.NRS_BR_CD                         " & vbNewLine _
    '                                        & "           AND OUTKAL.OUTKA_NO_L = OUTKAM.OUTKA_NO_L                      " & vbNewLine _
    '                                        & "           AND OUTKAL.SYS_DEL_FLG = '0'                                   " & vbNewLine _
    '                                        & "           LEFT JOIN                                                      " & vbNewLine _
    '                                        & "           $LM_MST$..M_GOODS GOODS                                        " & vbNewLine _
    '                                        & "           ON OUTKAM.NRS_BR_CD = GOODS.NRS_BR_CD                          " & vbNewLine _
    '                                        & "           AND OUTKAM.GOODS_CD_NRS = GOODS.GOODS_CD_NRS                   " & vbNewLine _
    '                                        & "           LEFT JOIN                                                      " & vbNewLine _
    '                                        & "           $LM_TRN$..F_UNSO_L UNSOL                                       " & vbNewLine _
    '                                        & "           ON UNSOL.NRS_BR_CD = OUTKAL.NRS_BR_CD                          " & vbNewLine _
    '                                        & "           AND UNSOL.INOUTKA_NO_L = OUTKAL.OUTKA_NO_L                     " & vbNewLine _
    '                                        & "           AND UNSOL.SYS_DEL_FLG = '0'                                    " & vbNewLine _
    '                                        & "           LEFT JOIN                                                      " & vbNewLine _
    '                                        & "           $LM_MST$..M_UNSOCO UNSOCO                                      " & vbNewLine _
    '                                        & "           ON UNSOCO.NRS_BR_CD = UNSOL.NRS_BR_CD                          " & vbNewLine _
    '                                        & "           AND UNSOCO.UNSOCO_CD = UNSOL.UNSO_CD                           " & vbNewLine _
    '                                        & "           AND UNSOCO.UNSOCO_BR_CD = UNSOL.UNSO_BR_CD                     " & vbNewLine _
    '                                        & "           LEFT JOIN                                                      " & vbNewLine _
    '                                        & "           $LM_TRN$..F_UNCHIN_TRS UNCHIN                                  " & vbNewLine _
    '                                        & "           ON UNCHIN.NRS_BR_CD = UNSOL.NRS_BR_CD                          " & vbNewLine _
    '                                        & "           AND UNCHIN.UNSO_NO_L = UNSOL.UNSO_NO_L                         " & vbNewLine _
    '                                        & "           AND UNCHIN.SYS_DEL_FLG = '0'                                   " & vbNewLine _
    '                                        & "        WHERE OUTKAM.NRS_BR_CD = @NRS_BR_CD                               " & vbNewLine _
    '                                        & "           AND OUTKAM.OUTKA_NO_L = @OUTKA_NO_L                            " & vbNewLine _
    '                                        & "           AND (OUTKAM.BACKLOG_NB <> '0'                                  " & vbNewLine _
    '                                        & "            OR  OUTKAM.BACKLOG_QT <> '0')                                 " & vbNewLine _
    '                                        & "           AND OUTKAM.SYS_DEL_FLG = '0'                                   " & vbNewLine _
    '                                        & "           GROUP BY                                                       " & vbNewLine _
    '                                        & "           OUTKAM.OUTKA_NO_L                                              " & vbNewLine _
    '                                        & "           ,OUTKAM.OUTKA_NO_M                                             " & vbNewLine _
    '                                        & "           ,OUTKAM.SERIAL_NO                                              " & vbNewLine _
    '                                        & "           ,OUTKAM.RSV_NO                                                 " & vbNewLine _
    '                                        & "           ,OUTKAM.IRIME                                                  " & vbNewLine _
    '                                        & "           ,OUTKAM.ALCTD_KB                                               " & vbNewLine _
    '                                        & "           ,OUTKAM.ALCTD_NB                                               " & vbNewLine _
    '                                        & "           ,OUTKAM.BACKLOG_NB                                             " & vbNewLine _
    '                                        & "           ,OUTKAM.ALCTD_QT                                               " & vbNewLine _
    '                                        & "           ,OUTKAM.BACKLOG_QT                                             " & vbNewLine _
    '                                        & "           ,OUTKAM.OUTKA_HASU                                             " & vbNewLine _
    '                                        & "           ,OUTKAM.OUTKA_TTL_NB                                           " & vbNewLine _
    '                                        & "           ,OUTKAM.OUTKA_TTL_QT                                           " & vbNewLine _
    '                                        & "           ,OUTKAM.OUTKA_PKG_NB                                           " & vbNewLine _
    '                                        & "           ,OUTKAM.OUTKA_NO_M                                             " & vbNewLine _
    '                                        & "           ,OUTKAL.OUTKA_STATE_KB                                         " & vbNewLine _
    '                                        & "           ,OUTKAL.PICK_KB                                                " & vbNewLine _
    '                                        & "           ,OUTKAL.WH_CD                                                  " & vbNewLine _
    '                                        & "           ,GOODS.PKG_NB                                                  " & vbNewLine _
    '                                        & "           ,OUTKAM.GOODS_CD_NRS                                           " & vbNewLine _
    '                                        & "           ,GOODS.GOODS_NM_1                                              " & vbNewLine _
    '                                        & "           ,OUTKAM.LOT_NO                                                 " & vbNewLine _
    '                                        & "           ,OUTKAM.GOODS_CD_NRS_FROM                                      " & vbNewLine _
    '                                        & "           ,UNSOCO.TARE_YN                                                " & vbNewLine _
    '                                        & "           ,UNSOL.UNSO_NO_L                                               " & vbNewLine _
    '                                        & "           ,UNSOL.SYS_UPD_DATE                                            " & vbNewLine _
    '                                        & "           ,UNSOL.SYS_UPD_TIME                                            " & vbNewLine _
    '                                        & "           ,UNCHIN.UNSO_NO_M                                              " & vbNewLine _
    '                                        & "           ,UNCHIN.SYS_UPD_DATE                                           " & vbNewLine _
    '                                        & "           ,UNCHIN.SYS_UPD_TIME                                           " & vbNewLine _
    '                                        & "           ,UNSOL.UNSO_TEHAI_KB                                           " & vbNewLine
    'START KIM START KIM 2012/10/10 要望番号：1499対応
    'Private Const SQL_SELECT_OUTKA_M As String = " SELECT                                                            " & vbNewLine _
    '                                    & "            OUTKAM.OUTKA_NO_L                                             " & vbNewLine _
    '                                    & "           ,OUTKAM.OUTKA_NO_M                                             " & vbNewLine _
    '                                    & "           ,OUTKAM.SERIAL_NO                                              " & vbNewLine _
    '                                    & "           ,OUTKAM.RSV_NO                                                 " & vbNewLine _
    '                                    & "           ,OUTKAM.IRIME                                                  " & vbNewLine _
    '                                    & "           ,OUTKAM.ALCTD_KB                                               " & vbNewLine _
    '                                    & "           ,OUTKAM.ALCTD_NB                                               " & vbNewLine _
    '                                    & "           ,OUTKAM.BACKLOG_NB                                             " & vbNewLine _
    '                                    & "           ,OUTKAM.ALCTD_QT                                               " & vbNewLine _
    '                                    & "           ,OUTKAM.BACKLOG_QT                                             " & vbNewLine _
    '                                    & "           ,OUTKAM.OUTKA_HASU                                             " & vbNewLine _
    '                                    & "           ,OUTKAM.OUTKA_TTL_NB                                           " & vbNewLine _
    '                                    & "           ,OUTKAM.OUTKA_TTL_QT                                           " & vbNewLine _
    '                                    & "           ,OUTKAM.OUTKA_PKG_NB                                           " & vbNewLine _
    '                                    & "           ,MAX(C_OUTKA_S.OUTKA_NO_S) AS OUTKA_NO_S                       " & vbNewLine _
    '                                    & "           ,OUTKAL.OUTKA_STATE_KB AS OUTKA_STATE_KB                       " & vbNewLine _
    '                                    & "           ,OUTKAL.PICK_KB AS PICK_KB                                     " & vbNewLine _
    '                                    & "           ,OUTKAL.WH_CD AS WH_CD                                         " & vbNewLine _
    '                                    & "           ,@SYS_UPD_DATE             AS SYS_UPD_DATE                     " & vbNewLine _
    '                                    & "           ,@SYS_UPD_TIME             AS SYS_UPD_TIME                     " & vbNewLine _
    '                                    & "           ,GOODS.PKG_NB AS PKG_NB                                        " & vbNewLine _
    '                                    & "           ,OUTKAM.GOODS_CD_NRS AS GOODS_CD_NRS                           " & vbNewLine _
    '                                    & "           ,GOODS.GOODS_NM_1 AS GOODS_NM                                  " & vbNewLine _
    '                                    & "           ,OUTKAM.LOT_NO AS LOT_NO                                       " & vbNewLine _
    '                                    & "           ,OUTKAM.GOODS_CD_NRS_FROM AS GOODS_CD_NRS_FROM                 " & vbNewLine _
    '                                    & "           ,ISNULL(UNSOCO.TARE_YN,'') AS TARE_YN                          " & vbNewLine _
    '                                    & "           ,ISNULL(UNSOL.UNSO_NO_L,'') AS UNSO_NO_L                       " & vbNewLine _
    '                                    & "           ,ISNULL(UNSOL.SYS_UPD_DATE,'') AS UNSOL_SYS_UPD_DATE           " & vbNewLine _
    '                                    & "           ,ISNULL(UNSOL.SYS_UPD_TIME,'') AS UNSOL_SYS_UPD_TIME           " & vbNewLine _
    '                                    & "           ,ISNULL(MAX(UNCHIN.UNSO_NO_M),'') AS UNSO_NO_M                 " & vbNewLine _
    '                                    & "           ,ISNULL(UNCHIN.SYS_UPD_DATE,'') AS UNCHIN_SYS_UPD_DATE         " & vbNewLine _
    '                                    & "           ,ISNULL(UNCHIN.SYS_UPD_TIME,'') AS UNCHIN_SYS_UPD_TIME         " & vbNewLine _
    '                                    & "           ,ISNULL(UNSOL.UNSO_TEHAI_KB,'') AS UNSO_TEHAI_KB               " & vbNewLine _
    '                                    & "           ,GOODS.GOODS_CD_CUST AS GOODS_CD_CUST                          " & vbNewLine _
    '                                    & "        FROM $LM_TRN$..C_OUTKA_M OUTKAM                                   " & vbNewLine _
    '                                    & "           LEFT JOIN                                                      " & vbNewLine _
    '                                    & "           $LM_TRN$..C_OUTKA_S                                            " & vbNewLine _
    '                                    & "           ON OUTKAM.NRS_BR_CD = C_OUTKA_S.NRS_BR_CD                      " & vbNewLine _
    '                                    & "           AND OUTKAM.OUTKA_NO_L = C_OUTKA_S.OUTKA_NO_L                   " & vbNewLine _
    '                                    & "           AND OUTKAM.OUTKA_NO_M = C_OUTKA_S.OUTKA_NO_M                   " & vbNewLine _
    '                                    & "           LEFT JOIN                                                      " & vbNewLine _
    '                                    & "           $LM_TRN$..C_OUTKA_L OUTKAL                                     " & vbNewLine _
    '                                    & "           ON OUTKAL.NRS_BR_CD = OUTKAM.NRS_BR_CD                         " & vbNewLine _
    '                                    & "           AND OUTKAL.OUTKA_NO_L = OUTKAM.OUTKA_NO_L                      " & vbNewLine _
    '                                    & "           AND OUTKAL.SYS_DEL_FLG = '0'                                   " & vbNewLine _
    '                                    & "           LEFT JOIN                                                      " & vbNewLine _
    '                                    & "           $LM_MST$..M_GOODS GOODS                                        " & vbNewLine _
    '                                    & "           ON OUTKAM.NRS_BR_CD = GOODS.NRS_BR_CD                          " & vbNewLine _
    '                                    & "           AND OUTKAM.GOODS_CD_NRS = GOODS.GOODS_CD_NRS                   " & vbNewLine _
    '                                    & "           LEFT JOIN                                                      " & vbNewLine _
    '                                    & "           $LM_TRN$..F_UNSO_L UNSOL                                       " & vbNewLine _
    '                                    & "           ON UNSOL.NRS_BR_CD = OUTKAL.NRS_BR_CD                          " & vbNewLine _
    '                                    & "           AND UNSOL.INOUTKA_NO_L = OUTKAL.OUTKA_NO_L                     " & vbNewLine _
    '                                    & "           AND UNSOL.SYS_DEL_FLG = '0'                                    " & vbNewLine _
    '                                    & "           LEFT JOIN                                                      " & vbNewLine _
    '                                    & "           $LM_MST$..M_UNSOCO UNSOCO                                      " & vbNewLine _
    '                                    & "           ON UNSOCO.NRS_BR_CD = UNSOL.NRS_BR_CD                          " & vbNewLine _
    '                                    & "           AND UNSOCO.UNSOCO_CD = UNSOL.UNSO_CD                           " & vbNewLine _
    '                                    & "           AND UNSOCO.UNSOCO_BR_CD = UNSOL.UNSO_BR_CD                     " & vbNewLine _
    '                                    & "           LEFT JOIN                                                      " & vbNewLine _
    '                                    & "           $LM_TRN$..F_UNCHIN_TRS UNCHIN                                  " & vbNewLine _
    '                                    & "           ON UNCHIN.NRS_BR_CD = UNSOL.NRS_BR_CD                          " & vbNewLine _
    '                                    & "           AND UNCHIN.UNSO_NO_L = UNSOL.UNSO_NO_L                         " & vbNewLine _
    '                                    & "           AND UNCHIN.SYS_DEL_FLG = '0'                                   " & vbNewLine _
    '                                    & "        WHERE OUTKAM.NRS_BR_CD = @NRS_BR_CD                               " & vbNewLine _
    '                                    & "           AND OUTKAM.OUTKA_NO_L = @OUTKA_NO_L                            " & vbNewLine _
    '                                    & "           AND (OUTKAM.BACKLOG_NB <> '0'                                  " & vbNewLine _
    '                                    & "            OR  OUTKAM.BACKLOG_QT <> '0')                                 " & vbNewLine _
    '                                    & "           AND OUTKAM.SYS_DEL_FLG = '0'                                   " & vbNewLine _
    '                                    & "           GROUP BY                                                       " & vbNewLine _
    '                                    & "           OUTKAM.OUTKA_NO_L                                              " & vbNewLine _
    '                                    & "           ,OUTKAM.OUTKA_NO_M                                             " & vbNewLine _
    '                                    & "           ,OUTKAM.SERIAL_NO                                              " & vbNewLine _
    '                                    & "           ,OUTKAM.RSV_NO                                                 " & vbNewLine _
    '                                    & "           ,OUTKAM.IRIME                                                  " & vbNewLine _
    '                                    & "           ,OUTKAM.ALCTD_KB                                               " & vbNewLine _
    '                                    & "           ,OUTKAM.ALCTD_NB                                               " & vbNewLine _
    '                                    & "           ,OUTKAM.BACKLOG_NB                                             " & vbNewLine _
    '                                    & "           ,OUTKAM.ALCTD_QT                                               " & vbNewLine _
    '                                    & "           ,OUTKAM.BACKLOG_QT                                             " & vbNewLine _
    '                                    & "           ,OUTKAM.OUTKA_HASU                                             " & vbNewLine _
    '                                    & "           ,OUTKAM.OUTKA_TTL_NB                                           " & vbNewLine _
    '                                    & "           ,OUTKAM.OUTKA_TTL_QT                                           " & vbNewLine _
    '                                    & "           ,OUTKAM.OUTKA_PKG_NB                                           " & vbNewLine _
    '                                    & "           ,OUTKAM.OUTKA_NO_M                                             " & vbNewLine _
    '                                    & "           ,OUTKAL.OUTKA_STATE_KB                                         " & vbNewLine _
    '                                    & "           ,OUTKAL.PICK_KB                                                " & vbNewLine _
    '                                    & "           ,OUTKAL.WH_CD                                                  " & vbNewLine _
    '                                    & "           ,GOODS.PKG_NB                                                  " & vbNewLine _
    '                                    & "           ,OUTKAM.GOODS_CD_NRS                                           " & vbNewLine _
    '                                    & "           ,GOODS.GOODS_NM_1                                              " & vbNewLine _
    '                                    & "           ,OUTKAM.LOT_NO                                                 " & vbNewLine _
    '                                    & "           ,OUTKAM.GOODS_CD_NRS_FROM                                      " & vbNewLine _
    '                                    & "           ,UNSOCO.TARE_YN                                                " & vbNewLine _
    '                                    & "           ,UNSOL.UNSO_NO_L                                               " & vbNewLine _
    '                                    & "           ,UNSOL.SYS_UPD_DATE                                            " & vbNewLine _
    '                                    & "           ,UNSOL.SYS_UPD_TIME                                            " & vbNewLine _
    '                                    & "           ,UNCHIN.UNSO_NO_M                                              " & vbNewLine _
    '                                    & "           ,UNCHIN.SYS_UPD_DATE                                           " & vbNewLine _
    '                                    & "           ,UNCHIN.SYS_UPD_TIME                                           " & vbNewLine _
    '                                    & "           ,UNSOL.UNSO_TEHAI_KB                                           " & vbNewLine _
    '                                    & "           ,GOODS.GOODS_CD_CUST                                           " & vbNewLine
    Private Const SQL_SELECT_OUTKA_M As String = " SELECT                                                            " & vbNewLine _
                                    & "            OUTKAM.OUTKA_NO_L                                             " & vbNewLine _
                                    & "           ,OUTKAM.OUTKA_NO_M                                             " & vbNewLine _
                                    & "           ,OUTKAM.SERIAL_NO                                              " & vbNewLine _
                                    & "           ,OUTKAM.RSV_NO                                                 " & vbNewLine _
                                    & "           ,OUTKAM.IRIME                                                  " & vbNewLine _
                                    & "           ,OUTKAM.ALCTD_KB                                               " & vbNewLine _
                                    & "           ,OUTKAM.ALCTD_NB                                               " & vbNewLine _
                                    & "           ,OUTKAM.BACKLOG_NB                                             " & vbNewLine _
                                    & "           ,OUTKAM.ALCTD_QT                                               " & vbNewLine _
                                    & "           ,OUTKAM.BACKLOG_QT                                             " & vbNewLine _
                                    & "           ,OUTKAM.OUTKA_HASU                                             " & vbNewLine _
                                    & "           ,OUTKAM.OUTKA_TTL_NB                                           " & vbNewLine _
                                    & "           ,OUTKAM.OUTKA_TTL_QT                                           " & vbNewLine _
                                    & "           ,OUTKAM.OUTKA_PKG_NB                                           " & vbNewLine _
                                    & "           ,MAX(C_OUTKA_S.OUTKA_NO_S) AS OUTKA_NO_S                       " & vbNewLine _
                                    & "           ,OUTKAL.OUTKA_STATE_KB AS OUTKA_STATE_KB                       " & vbNewLine _
                                    & "           ,OUTKAL.PICK_KB AS PICK_KB                                     " & vbNewLine _
                                    & "           ,OUTKAL.WH_CD AS WH_CD                                         " & vbNewLine _
                                    & "           ,@SYS_UPD_DATE             AS SYS_UPD_DATE                     " & vbNewLine _
                                    & "           ,@SYS_UPD_TIME             AS SYS_UPD_TIME                     " & vbNewLine _
                                    & "           ,GOODS.PKG_NB AS PKG_NB                                        " & vbNewLine _
                                    & "           ,OUTKAM.GOODS_CD_NRS AS GOODS_CD_NRS                           " & vbNewLine _
                                    & "           ,GOODS.GOODS_NM_1 AS GOODS_NM                                  " & vbNewLine _
                                    & "           ,OUTKAM.LOT_NO AS LOT_NO                                       " & vbNewLine _
                                    & "           ,OUTKAM.GOODS_CD_NRS_FROM AS GOODS_CD_NRS_FROM                 " & vbNewLine _
                                    & "           ,ISNULL(UNSOCO.TARE_YN,'') AS TARE_YN                          " & vbNewLine _
                                    & "           ,ISNULL(UNSOL.UNSO_NO_L,'') AS UNSO_NO_L                       " & vbNewLine _
                                    & "           ,ISNULL(UNSOL.SYS_UPD_DATE,'') AS UNSOL_SYS_UPD_DATE           " & vbNewLine _
                                    & "           ,ISNULL(UNSOL.SYS_UPD_TIME,'') AS UNSOL_SYS_UPD_TIME           " & vbNewLine _
                                    & "           ,ISNULL(MAX(UNCHIN.UNSO_NO_M),'') AS UNSO_NO_M                 " & vbNewLine _
                                    & "           ,ISNULL(UNCHIN.SYS_UPD_DATE,'') AS UNCHIN_SYS_UPD_DATE         " & vbNewLine _
                                    & "           ,ISNULL(UNCHIN.SYS_UPD_TIME,'') AS UNCHIN_SYS_UPD_TIME         " & vbNewLine _
                                    & "           ,ISNULL(UNSOL.UNSO_TEHAI_KB,'') AS UNSO_TEHAI_KB               " & vbNewLine _
                                    & "           ,GOODS.GOODS_CD_CUST AS GOODS_CD_CUST                          " & vbNewLine _
                                    & "           -- 西濃自動送り状番号対応                                      " & vbNewLine _
                                    & "           , CASE WHEN ISNULL(UNSOCO.AUTO_DENP_NO_FLG, '') = '1'          " & vbNewLine _
                                    & "                  THEN ISNULL(UNSOCO.AUTO_DENP_NO_KBN, '')                " & vbNewLine _
                                    & "                  ELSE '' END                      AS AUTO_DENP_KBN       " & vbNewLine _
                                    & "           , ISNULL(UNSOL.AUTO_DENP_NO, '')        AS AUTO_DENP_NO        " & vbNewLine _
                                    & "        FROM $LM_TRN$..C_OUTKA_M OUTKAM                                   " & vbNewLine _
                                    & "           LEFT JOIN                                                      " & vbNewLine _
                                    & "           $LM_TRN$..C_OUTKA_S                                            " & vbNewLine _
                                    & "           ON OUTKAM.NRS_BR_CD = C_OUTKA_S.NRS_BR_CD                      " & vbNewLine _
                                    & "           AND OUTKAM.OUTKA_NO_L = C_OUTKA_S.OUTKA_NO_L                   " & vbNewLine _
                                    & "           AND OUTKAM.OUTKA_NO_M = C_OUTKA_S.OUTKA_NO_M                   " & vbNewLine _
                                    & "           LEFT JOIN                                                      " & vbNewLine _
                                    & "           $LM_TRN$..C_OUTKA_L OUTKAL                                     " & vbNewLine _
                                    & "           ON OUTKAL.NRS_BR_CD = OUTKAM.NRS_BR_CD                         " & vbNewLine _
                                    & "           AND OUTKAL.OUTKA_NO_L = OUTKAM.OUTKA_NO_L                      " & vbNewLine _
                                    & "           AND OUTKAL.SYS_DEL_FLG = '0'                                   " & vbNewLine _
                                    & "           LEFT JOIN                                                      " & vbNewLine _
                                    & "           $LM_MST$..M_GOODS GOODS                                        " & vbNewLine _
                                    & "           ON OUTKAM.NRS_BR_CD = GOODS.NRS_BR_CD                          " & vbNewLine _
                                    & "           AND OUTKAM.GOODS_CD_NRS = GOODS.GOODS_CD_NRS                   " & vbNewLine _
                                    & "           LEFT JOIN                                                      " & vbNewLine _
                                    & "           $LM_TRN$..F_UNSO_L UNSOL                                       " & vbNewLine _
                                    & "           ON UNSOL.NRS_BR_CD = OUTKAL.NRS_BR_CD                          " & vbNewLine _
                                    & "           AND UNSOL.INOUTKA_NO_L = OUTKAL.OUTKA_NO_L                     " & vbNewLine _
                                    & "           AND UNSOL.SYS_DEL_FLG = '0'                                    " & vbNewLine _
                                    & "           LEFT JOIN                                                      " & vbNewLine _
                                    & "           $LM_MST$..M_UNSOCO UNSOCO                                      " & vbNewLine _
                                    & "           ON UNSOCO.NRS_BR_CD = UNSOL.NRS_BR_CD                          " & vbNewLine _
                                    & "           AND UNSOCO.UNSOCO_CD = UNSOL.UNSO_CD                           " & vbNewLine _
                                    & "           AND UNSOCO.UNSOCO_BR_CD = UNSOL.UNSO_BR_CD                     " & vbNewLine _
                                    & "           LEFT JOIN                                                      " & vbNewLine _
                                    & "           $LM_TRN$..F_UNCHIN_TRS UNCHIN                                  " & vbNewLine _
                                    & "           ON UNCHIN.NRS_BR_CD = UNSOL.NRS_BR_CD                          " & vbNewLine _
                                    & "           AND UNCHIN.UNSO_NO_L = UNSOL.UNSO_NO_L                         " & vbNewLine _
                                    & "           AND UNCHIN.SYS_DEL_FLG = '0'                                   " & vbNewLine _
                                    & "        WHERE OUTKAM.NRS_BR_CD = @NRS_BR_CD                               " & vbNewLine _
                                    & "           AND OUTKAM.OUTKA_NO_L = @OUTKA_NO_L                            " & vbNewLine _
                                    & ""
    Private Const SQL_SELECT_OUTKA_M_2 As String = "" _
                                    & "           AND (OUTKAM.BACKLOG_NB <> '0'                                  " & vbNewLine _
                                    & "            OR  OUTKAM.BACKLOG_QT <> '0'                                  " & vbNewLine _
                                    & "            OR  (OUTKAM.OUTKA_TTL_QT = 0  AND OUTKAM.BACKLOG_QT = '0') )  " & vbNewLine _
                                    & ""
    Private Const SQL_SELECT_OUTKA_M_3 As String = "" _
                                    & "           AND OUTKAM.SYS_DEL_FLG = '0'                                   " & vbNewLine _
                                    & "           GROUP BY                                                       " & vbNewLine _
                                    & "           OUTKAM.OUTKA_NO_L                                              " & vbNewLine _
                                    & "           ,OUTKAM.OUTKA_NO_M                                             " & vbNewLine _
                                    & "           ,OUTKAM.SERIAL_NO                                              " & vbNewLine _
                                    & "           ,OUTKAM.RSV_NO                                                 " & vbNewLine _
                                    & "           ,OUTKAM.IRIME                                                  " & vbNewLine _
                                    & "           ,OUTKAM.ALCTD_KB                                               " & vbNewLine _
                                    & "           ,OUTKAM.ALCTD_NB                                               " & vbNewLine _
                                    & "           ,OUTKAM.BACKLOG_NB                                             " & vbNewLine _
                                    & "           ,OUTKAM.ALCTD_QT                                               " & vbNewLine _
                                    & "           ,OUTKAM.BACKLOG_QT                                             " & vbNewLine _
                                    & "           ,OUTKAM.OUTKA_HASU                                             " & vbNewLine _
                                    & "           ,OUTKAM.OUTKA_TTL_NB                                           " & vbNewLine _
                                    & "           ,OUTKAM.OUTKA_TTL_QT                                           " & vbNewLine _
                                    & "           ,OUTKAM.OUTKA_PKG_NB                                           " & vbNewLine _
                                    & "           ,OUTKAM.OUTKA_NO_M                                             " & vbNewLine _
                                    & "           ,OUTKAL.OUTKA_STATE_KB                                         " & vbNewLine _
                                    & "           ,OUTKAL.PICK_KB                                                " & vbNewLine _
                                    & "           ,OUTKAL.WH_CD                                                  " & vbNewLine _
                                    & "           ,GOODS.PKG_NB                                                  " & vbNewLine _
                                    & "           ,OUTKAM.GOODS_CD_NRS                                           " & vbNewLine _
                                    & "           ,GOODS.GOODS_NM_1                                              " & vbNewLine _
                                    & "           ,OUTKAM.LOT_NO                                                 " & vbNewLine _
                                    & "           ,OUTKAM.GOODS_CD_NRS_FROM                                      " & vbNewLine _
                                    & "           ,UNSOCO.TARE_YN                                                " & vbNewLine _
                                    & "           ,UNSOL.UNSO_NO_L                                               " & vbNewLine _
                                    & "           ,UNSOL.SYS_UPD_DATE                                            " & vbNewLine _
                                    & "           ,UNSOL.SYS_UPD_TIME                                            " & vbNewLine _
                                    & "           ,UNCHIN.UNSO_NO_M                                              " & vbNewLine _
                                    & "           ,UNCHIN.SYS_UPD_DATE                                           " & vbNewLine _
                                    & "           ,UNCHIN.SYS_UPD_TIME                                           " & vbNewLine _
                                    & "           ,UNSOL.UNSO_TEHAI_KB                                           " & vbNewLine _
                                    & "           ,GOODS.GOODS_CD_CUST                                           " & vbNewLine _
                                    & "           ,UNSOCO.AUTO_DENP_NO_FLG                                       " & vbNewLine _
                                    & "           ,UNSOCO.AUTO_DENP_NO_KBN                                       " & vbNewLine _
                                    & "           ,UNSOL.AUTO_DENP_NO                                            " & vbNewLine
    'END YANAI 要望番号1474 一括引当時、引当が出来ない場合のエラーメッセージ変更
    'END YANAI 要望番号638
    'END YANAI 要望番号585
    'END YANAI 20110914 一括引当対応
    'END KIM START KIM 2012/10/10 要望番号：1499対応

    Private Const SQL_SELECT_COUNT_OUTKA_M As String = " SELECT COUNT(*) AS CNT                                  " & vbNewLine _
                                    & "            FROM $LM_TRN$..C_OUTKA_M AS CM                                " & vbNewLine _
                                    & "            WHERE CM.SYS_DEL_FLG = '0'                                    " & vbNewLine _
                                    & "            AND CM.OUTKA_NO_L = @OUTKA_NO_L                               " & vbNewLine _
                                    & "            AND NRS_BR_CD = @NRS_BR_CD                                    " & vbNewLine


    Private Const SQL_SELECT_UNSO_PRE As String = "SELECT                                                       " & vbNewLine _
                                                & "    NRS_BR_CD                                                " & vbNewLine _
                                                & "   ,UNSO_NO_L                                                " & vbNewLine _
                                                & "   ,SYS_UPD_DATE                                             " & vbNewLine _
                                                & "   ,SYS_UPD_TIME                                             " & vbNewLine _
                                                & "   ,UNSO_CD                                                  " & vbNewLine _
                                                & "   ,UNSO_BR_CD                                               " & vbNewLine _
                                                & "FROM $LM_TRN$..F_UNSO_L                                      " & vbNewLine _
                                                & "WHERE SYS_DEL_FLG = '0'                                      " & vbNewLine _
                                                & "  AND NRS_BR_CD = @NRS_BR_CD                                 " & vbNewLine _
                                                & "  AND UNSO_NO_L = @UNSO_NO_L                                 " & vbNewLine

    'START YANAI 要望番号741
    '''' <summary>
    '''' 分析票検索用SQL
    '''' </summary>
    '''' <remarks></remarks>
    'Private Const SQL_SELECT_BUNSEKI_OUTKA_M As String = " SELECT                                       " & vbNewLine _
    '                                                   & " OUTKAM.NRS_BR_CD                             " & vbNewLine _
    '                                                   & " ,OUTKAL.OUTKA_NO_L                           " & vbNewLine _
    '                                                   & " ,OUTKAL.CUST_CD_L                            " & vbNewLine _
    '                                                   & " ,CUST.CUST_NM_L                              " & vbNewLine _
    '                                                   & " ,OUTKAL.DEST_CD                              " & vbNewLine _
    '                                                   & " ,OUTKAM.GOODS_CD_NRS                         " & vbNewLine _
    '                                                   & " ,OUTKAM.LOT_NO                               " & vbNewLine _
    '                                                   & " ,@ROW_NO AS ROW_NO                           " & vbNewLine _
    '                                                   & " FROM $LM_TRN$..C_OUTKA_M OUTKAM                " & vbNewLine _
    '                                                   & " LEFT JOIN $LM_TRN$..C_OUTKA_L OUTKAL ON        " & vbNewLine _
    '                                                   & " OUTKAL.NRS_BR_CD = OUTKAM.NRS_BR_CD AND      " & vbNewLine _
    '                                                   & " OUTKAL.OUTKA_NO_L = OUTKAM.OUTKA_NO_L AND    " & vbNewLine _
    '                                                   & " OUTKAL.SYS_DEL_FLG = '0'                     " & vbNewLine _
    '                                                   & " LEFT JOIN $LM_MST$..M_GOODS GOODS ON           " & vbNewLine _
    '                                                   & " GOODS.NRS_BR_CD = OUTKAM.NRS_BR_CD           " & vbNewLine _
    '                                                   & " AND GOODS.GOODS_CD_NRS = OUTKAM.GOODS_CD_NRS " & vbNewLine _
    '                                                   & " LEFT JOIN $LM_MST$..M_CUST CUST ON             " & vbNewLine _
    '                                                   & " CUST.NRS_BR_CD = OUTKAM.NRS_BR_CD AND        " & vbNewLine _
    '                                                   & " CUST.CUST_CD_L = GOODS.CUST_CD_L AND         " & vbNewLine _
    '                                                   & " CUST.CUST_CD_M = GOODS.CUST_CD_M AND         " & vbNewLine _
    '                                                   & " CUST.CUST_CD_S = GOODS.CUST_CD_S AND         " & vbNewLine _
    '                                                   & " CUST.CUST_CD_SS = GOODS.CUST_CD_SS           " & vbNewLine _
    '                                                   & " WHERE OUTKAM.NRS_BR_CD = @NRS_BR_CD          " & vbNewLine _
    '                                                   & " AND OUTKAM.OUTKA_NO_L = @OUTKA_NO_L          " & vbNewLine _
    '                                                   & " AND OUTKAM.SYS_DEL_FLG = '0'                 " & vbNewLine

    '2013.02.18 アグリマート対応 START
#Region "SQL_GET_BP_EDI_OUT(BP運送重量再取得用)"

    Private Const SQL_SELECT_C_OUTKA_PICK_WK As String = " SELECT                                            " & vbNewLine _
                                & "            PICKWK.NRS_BR_CD                                              " & vbNewLine _
                                & "           ,PICKWK.OUTKA_NO_L                                             " & vbNewLine _
                                & "           ,PICKWK.OUTKA_NO_M                                             " & vbNewLine _
                                & "           ,PICKWK.SERIAL_NO                                              " & vbNewLine _
                                & "           ,PICKWK.HIKI_STATE_KBN                                         " & vbNewLine _
                                & "           ,PICKWK.SYS_UPD_DATE                                           " & vbNewLine _
                                & "           ,PICKWK.SYS_UPD_TIME                                           " & vbNewLine _
                                & "           ,PICKWK.SYS_DEL_FLG                                            " & vbNewLine _
                                & "        FROM $LM_TRN$..C_OUTKA_PICK_WK PICKWK                             " & vbNewLine _
                                & "        WHERE PICKWK.NRS_BR_CD = @NRS_BR_CD                               " & vbNewLine _
                                & "           AND PICKWK.OUTKA_NO_L = @OUTKA_NO_L                            " & vbNewLine _
                                & "           AND PICKWK.HIKI_STATE_KBN = '00'                               " & vbNewLine

#End Region
    '2013.02.18 アグリマート対応 END


    '2013.07.04 追加START
#Region "SQL_GET_BP_EDI_OUT(BP運送重量再取得用)"

    Private Const SQL_GET_BP_EDI_OUT As String = "SELECT  HBP.OUTKA_CTL_NO AS INOUTKA_NO_L " & vbNewLine _
                                        & "--(2014.01.22)要望番号2149 修正START      " & vbNewLine _
                                        & "      , SUM(TOTAL_QT) AS BP_UNSO_WT       " & vbNewLine _
                                        & "--      , SUM(TOTAL_WT) AS BP_UNSO_WT       " & vbNewLine _
                                        & "--(2014.01.22)要望番号2149 修正END        " & vbNewLine _
                                        & "  FROM $LM_TRN$..H_OUTKAEDI_DTL_BP HBP   " & vbNewLine _
                                        & "LEFT JOIN                                 " & vbNewLine _
                                        & "$LM_TRN$..C_OUTKA_L CL                   " & vbNewLine _
                                        & "ON                                        " & vbNewLine _
                                        & "HBP.NRS_BR_CD = CL.NRS_BR_CD              " & vbNewLine _
                                        & "AND                                       " & vbNewLine _
                                        & "HBP.OUTKA_CTL_NO = CL.OUTKA_NO_L          " & vbNewLine _
                                        & "LEFT JOIN                                 " & vbNewLine _
                                        & "$LM_TRN$..F_UNSO_L FL                    " & vbNewLine _
                                        & "ON                                        " & vbNewLine _
                                        & "CL.NRS_BR_CD = FL.NRS_BR_CD               " & vbNewLine _
                                        & "AND                                       " & vbNewLine _
                                        & "CL.OUTKA_NO_L = FL.INOUTKA_NO_L           " & vbNewLine _
                                        & "AND                                       " & vbNewLine _
                                        & "FL.MOTO_DATA_KB = '20'                    " & vbNewLine _
                                        & "LEFT JOIN                                 " & vbNewLine _
                                        & "$LM_MST$..M_CUST_DETAILS MCD              " & vbNewLine _
                                        & "ON                                        " & vbNewLine _
                                        & "MCD.NRS_BR_CD = HBP.NRS_BR_CD             " & vbNewLine _
                                        & "AND                                       " & vbNewLine _
                                        & "MCD.CUST_CD = HBP.CUST_CD_L               " & vbNewLine _
                                        & "WHERE                                     " & vbNewLine _
                                        & "FL.NRS_BR_CD = @NRS_BR_CD                 " & vbNewLine _
                                        & "AND                                       " & vbNewLine _
                                        & "FL.UNSO_NO_L = @UNSO_NO_L                 " & vbNewLine _
                                        & "AND                                       " & vbNewLine _
                                        & "FL.SYS_DEL_FLG = '0'                      " & vbNewLine _
                                        & "AND                                       " & vbNewLine _
                                        & "CL.SYS_DEL_FLG = '0'                      " & vbNewLine _
                                        & "AND                                       " & vbNewLine _
                                        & "HBP.SYS_DEL_FLG = '0'                     " & vbNewLine _
                                        & "AND                                       " & vbNewLine _
                                        & "MCD.SUB_KB = '58'                         " & vbNewLine _
                                        & "GROUP BY                                  " & vbNewLine _
                                        & "HBP.OUTKA_CTL_NO                          " & vbNewLine
#End Region
    '2013.07.04 追加END


    'START KIM 2012/09/19 特別荷主対応
#Region "SQL_SELECT_OUTKA_M_FOR_HW"

    Private Const SQL_SELECT_OUTKA_M_FOR_HW As String = " SELECT                                                                " & vbNewLine _
                                                      & "            OUTKAM.OUTKA_NO_L                 AS OUTKA_NO_L            " & vbNewLine _
                                                      & "           ,OUTKAM.OUTKA_NO_M                 AS OUTKA_NO_M            " & vbNewLine _
                                                      & "           ,OUTKAM.SERIAL_NO                  AS SERIAL_NO             " & vbNewLine _
                                                      & "           ,OUTKAM.RSV_NO                     AS RSV_NO                " & vbNewLine _
                                                      & "           ,OUTKAM.IRIME                      AS IRIME                 " & vbNewLine _
                                                      & "           ,OUTKAM.ALCTD_KB                   AS ALCTD_KB              " & vbNewLine _
                                                      & "           ,OUTKAM.ALCTD_NB                   AS ALCTD_NB              " & vbNewLine _
                                                      & "           ,OUTKAM.BACKLOG_NB                 AS BACKLOG_NB            " & vbNewLine _
                                                      & "           ,OUTKAM.ALCTD_QT                   AS ALCTD_QT              " & vbNewLine _
                                                      & "           ,OUTKAM.BACKLOG_QT                 AS BACKLOG_QT            " & vbNewLine _
                                                      & "           ,OUTKAM.OUTKA_HASU                 AS OUTKA_HASU            " & vbNewLine _
                                                      & "           ,OUTKAM.OUTKA_TTL_NB               AS OUTKA_TTL_NB          " & vbNewLine _
                                                      & "           ,OUTKAM.OUTKA_TTL_QT               AS OUTKA_TTL_QT          " & vbNewLine _
                                                      & "           ,OUTKAM.OUTKA_PKG_NB               AS OUTKA_PKG_NB          " & vbNewLine _
                                                      & "           ,MAX(C_OUTKA_S.OUTKA_NO_S)         AS OUTKA_NO_S            " & vbNewLine _
                                                      & "           ,OUTKAL.OUTKA_STATE_KB             AS OUTKA_STATE_KB        " & vbNewLine _
                                                      & "           ,OUTKAL.PICK_KB                    AS PICK_KB               " & vbNewLine _
                                                      & "           ,OUTKAL.WH_CD                      AS WH_CD                 " & vbNewLine _
                                                      & "           ,OUTKAL.SYS_UPD_DATE               AS SYS_UPD_DATE          " & vbNewLine _
                                                      & "           ,OUTKAL.SYS_UPD_TIME               AS SYS_UPD_TIME          " & vbNewLine _
                                                      & "           ,GOODS.PKG_NB                      AS PKG_NB                " & vbNewLine _
                                                      & "           ,OUTKAM.GOODS_CD_NRS               AS GOODS_CD_NRS          " & vbNewLine _
                                                      & "           ,GOODS.GOODS_NM_1                  AS GOODS_NM              " & vbNewLine _
                                                      & "           ,OUTKAM.LOT_NO                     AS LOT_NO                " & vbNewLine _
                                                      & "           ,OUTKAM.GOODS_CD_NRS_FROM          AS GOODS_CD_NRS_FROM     " & vbNewLine _
                                                      & "           ,ISNULL(UNSOCO.TARE_YN,'')         AS TARE_YN               " & vbNewLine _
                                                      & "           ,ISNULL(UNSOL.UNSO_NO_L,'')        AS UNSO_NO_L             " & vbNewLine _
                                                      & "           ,ISNULL(UNSOL.SYS_UPD_DATE,'')     AS UNSOL_SYS_UPD_DATE    " & vbNewLine _
                                                      & "           ,ISNULL(UNSOL.SYS_UPD_TIME,'')     AS UNSOL_SYS_UPD_TIME    " & vbNewLine _
                                                      & "           ,ISNULL(MAX(UNCHIN.UNSO_NO_M),'')  AS UNSO_NO_M             " & vbNewLine _
                                                      & "           ,ISNULL(UNCHIN.SYS_UPD_DATE,'')    AS UNCHIN_SYS_UPD_DATE   " & vbNewLine _
                                                      & "           ,ISNULL(UNCHIN.SYS_UPD_TIME,'')    AS UNCHIN_SYS_UPD_TIME   " & vbNewLine _
                                                      & "           ,ISNULL(UNSOL.UNSO_TEHAI_KB,'')    AS UNSO_TEHAI_KB         " & vbNewLine _
                                                      & "           ,OUTKAM.NRS_BR_CD                  AS NRS_BR_CD             " & vbNewLine _
                                                      & "           ,ISNULL(OUTKAL.CUST_CD_L,'')       AS CUST_CD_L             " & vbNewLine _
                                                      & "           ,ISNULL(OUTKAL.CUST_CD_M,'')       AS CUST_CD_M             " & vbNewLine _
                                                      & "           ,ISNULL(CUST.CUST_NM_L,'')         AS CUST_NM_L             " & vbNewLine _
                                                      & "           ,ISNULL(CUST.CUST_NM_M,'')         AS CUST_NM_M             " & vbNewLine _
                                                      & "           ,ISNULL(OUTKAL.OUTKA_PLAN_DATE,'') AS OUTKA_PLAN_DATE       " & vbNewLine _
                                                      & "           ,OUTKAL.SASZ_USER                  AS SASZ_USER             " & vbNewLine _
                                                      & "           ,OUTKAL.NHS_FLAG                   AS NHS_FLAG              " & vbNewLine _
                                                      & "        FROM $LM_TRN$..C_OUTKA_M OUTKAM                                " & vbNewLine _
                                                      & "           LEFT JOIN                                                   " & vbNewLine _
                                                      & "           $LM_TRN$..C_OUTKA_S                                         " & vbNewLine _
                                                      & "           ON OUTKAM.NRS_BR_CD = C_OUTKA_S.NRS_BR_CD                   " & vbNewLine _
                                                      & "           AND OUTKAM.OUTKA_NO_L = C_OUTKA_S.OUTKA_NO_L                " & vbNewLine _
                                                      & "           AND OUTKAM.OUTKA_NO_M = C_OUTKA_S.OUTKA_NO_M                " & vbNewLine _
                                                      & "           LEFT JOIN                                                   " & vbNewLine _
                                                      & "           $LM_TRN$..C_OUTKA_L OUTKAL                                  " & vbNewLine _
                                                      & "           ON OUTKAL.NRS_BR_CD = OUTKAM.NRS_BR_CD                      " & vbNewLine _
                                                      & "           AND OUTKAL.OUTKA_NO_L = OUTKAM.OUTKA_NO_L                   " & vbNewLine _
                                                      & "           AND OUTKAL.SYS_DEL_FLG = '0'                                " & vbNewLine _
                                                      & "           LEFT JOIN                                                   " & vbNewLine _
                                                      & "           $LM_MST$..M_GOODS GOODS                                     " & vbNewLine _
                                                      & "           ON OUTKAM.NRS_BR_CD = GOODS.NRS_BR_CD                       " & vbNewLine _
                                                      & "           AND OUTKAM.GOODS_CD_NRS = GOODS.GOODS_CD_NRS                " & vbNewLine _
                                                      & "           LEFT JOIN                                                   " & vbNewLine _
                                                      & "           $LM_TRN$..F_UNSO_L UNSOL                                    " & vbNewLine _
                                                      & "           ON UNSOL.NRS_BR_CD = OUTKAL.NRS_BR_CD                       " & vbNewLine _
                                                      & "           AND UNSOL.INOUTKA_NO_L = OUTKAL.OUTKA_NO_L                  " & vbNewLine _
                                                      & "           AND UNSOL.SYS_DEL_FLG = '0'                                 " & vbNewLine _
                                                      & "           LEFT JOIN                                                   " & vbNewLine _
                                                      & "           $LM_MST$..M_UNSOCO UNSOCO                                   " & vbNewLine _
                                                      & "           ON UNSOCO.NRS_BR_CD = UNSOL.NRS_BR_CD                       " & vbNewLine _
                                                      & "           AND UNSOCO.UNSOCO_CD = UNSOL.UNSO_CD                        " & vbNewLine _
                                                      & "           AND UNSOCO.UNSOCO_BR_CD = UNSOL.UNSO_BR_CD                  " & vbNewLine _
                                                      & "           LEFT JOIN                                                   " & vbNewLine _
                                                      & "           $LM_TRN$..F_UNCHIN_TRS UNCHIN                               " & vbNewLine _
                                                      & "           ON UNCHIN.NRS_BR_CD = UNSOL.NRS_BR_CD                       " & vbNewLine _
                                                      & "           AND UNCHIN.UNSO_NO_L = UNSOL.UNSO_NO_L                      " & vbNewLine _
                                                      & "           AND UNCHIN.SYS_DEL_FLG = '0'                                " & vbNewLine _
                                                      & "           LEFT JOIN                                                   " & vbNewLine _
                                                      & "           $LM_MST$..M_CUST CUST                                       " & vbNewLine _
                                                      & "            ON OUTKAL.NRS_BR_CD = CUST.NRS_BR_CD                       " & vbNewLine _
                                                      & "           AND OUTKAL.CUST_CD_L = CUST.CUST_CD_L                       " & vbNewLine _
                                                      & "           AND OUTKAL.CUST_CD_M = CUST.CUST_CD_M                       " & vbNewLine _
                                                      & "           AND CUST.CUST_CD_S   = '00'                                 " & vbNewLine _
                                                      & "           AND CUST.CUST_CD_SS  = '00'                                 " & vbNewLine _
                                                      & "        WHERE OUTKAM.NRS_BR_CD   = @NRS_BR_CD                          " & vbNewLine _
                                                      & "           AND OUTKAM.OUTKA_NO_L = @OUTKA_NO_L                         " & vbNewLine _
                                                      & "           AND OUTKAM.OUTKA_NO_M = @OUTKA_NO_M                         " & vbNewLine _
                                                      & "           AND (OUTKAM.BACKLOG_NB <> '0'                               " & vbNewLine _
                                                      & "            OR  OUTKAM.BACKLOG_QT <> '0')                              " & vbNewLine _
                                                      & "           AND OUTKAM.SYS_DEL_FLG = '0'                                " & vbNewLine _
                                                      & "           GROUP BY                                                    " & vbNewLine _
                                                      & "               OUTKAM.OUTKA_NO_L                                       " & vbNewLine _
                                                      & "              ,OUTKAM.OUTKA_NO_M                                       " & vbNewLine _
                                                      & "              ,OUTKAM.SERIAL_NO                                        " & vbNewLine _
                                                      & "              ,OUTKAM.RSV_NO                                           " & vbNewLine _
                                                      & "              ,OUTKAM.IRIME                                            " & vbNewLine _
                                                      & "              ,OUTKAM.ALCTD_KB                                         " & vbNewLine _
                                                      & "              ,OUTKAM.ALCTD_NB                                         " & vbNewLine _
                                                      & "              ,OUTKAM.BACKLOG_NB                                       " & vbNewLine _
                                                      & "              ,OUTKAM.ALCTD_QT                                         " & vbNewLine _
                                                      & "              ,OUTKAM.BACKLOG_QT                                       " & vbNewLine _
                                                      & "              ,OUTKAM.OUTKA_HASU                                       " & vbNewLine _
                                                      & "              ,OUTKAM.OUTKA_TTL_NB                                     " & vbNewLine _
                                                      & "              ,OUTKAM.OUTKA_TTL_QT                                     " & vbNewLine _
                                                      & "              ,OUTKAM.OUTKA_PKG_NB                                     " & vbNewLine _
                                                      & "              ,OUTKAM.OUTKA_NO_M                                       " & vbNewLine _
                                                      & "              ,OUTKAL.OUTKA_STATE_KB                                   " & vbNewLine _
                                                      & "              ,OUTKAL.PICK_KB                                          " & vbNewLine _
                                                      & "              ,OUTKAL.WH_CD                                            " & vbNewLine _
                                                      & "              ,GOODS.PKG_NB                                            " & vbNewLine _
                                                      & "              ,OUTKAM.GOODS_CD_NRS                                     " & vbNewLine _
                                                      & "              ,GOODS.GOODS_NM_1                                        " & vbNewLine _
                                                      & "              ,OUTKAM.LOT_NO                                           " & vbNewLine _
                                                      & "              ,OUTKAM.GOODS_CD_NRS_FROM                                " & vbNewLine _
                                                      & "              ,UNSOCO.TARE_YN                                          " & vbNewLine _
                                                      & "              ,UNSOL.UNSO_NO_L                                         " & vbNewLine _
                                                      & "              ,UNSOL.SYS_UPD_DATE                                      " & vbNewLine _
                                                      & "              ,UNSOL.SYS_UPD_TIME                                      " & vbNewLine _
                                                      & "              ,UNCHIN.UNSO_NO_M                                        " & vbNewLine _
                                                      & "              ,UNCHIN.SYS_UPD_DATE                                     " & vbNewLine _
                                                      & "              ,UNCHIN.SYS_UPD_TIME                                     " & vbNewLine _
                                                      & "              ,UNSOL.UNSO_TEHAI_KB                                     " & vbNewLine _
                                                      & "              ,OUTKAM.NRS_BR_CD                                        " & vbNewLine _
                                                      & "              ,OUTKAL.CUST_CD_L                                        " & vbNewLine _
                                                      & "              ,OUTKAL.CUST_CD_M                                        " & vbNewLine _
                                                      & "              ,CUST.CUST_NM_L                                          " & vbNewLine _
                                                      & "              ,CUST.CUST_NM_M                                          " & vbNewLine _
                                                      & "              ,OUTKAL.OUTKA_PLAN_DATE                                  " & vbNewLine _
                                                      & "              ,OUTKAL.SASZ_USER                                        " & vbNewLine _
                                                      & "              ,OUTKAL.NHS_FLAG                                         " & vbNewLine _
                                                      & "              ,OUTKAL.SYS_UPD_DATE                                     " & vbNewLine _
                                                      & "              ,OUTKAL.SYS_UPD_TIME                                     " & vbNewLine _
                                                      & "           ORDER BY                                                    " & vbNewLine _
                                                      & "               OUTKAM.OUTKA_NO_L                                       " & vbNewLine _
                                                      & "              ,OUTKAM.OUTKA_NO_M                                       " & vbNewLine


#End Region
    'END KIM 2012/09/19 特別荷主対応

    ''' <summary>
    ''' 分析票検索用SQL
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_SELECT_BUNSEKI_OUTKA_M As String = " SELECT                                       " & vbNewLine _
                                                       & " OUTKAM.NRS_BR_CD                             " & vbNewLine _
                                                       & " ,OUTKAL.OUTKA_NO_L                           " & vbNewLine _
                                                       & " ,OUTKAL.CUST_CD_L                            " & vbNewLine _
                                                       & " ,CUST.CUST_NM_L                              " & vbNewLine _
                                                       & "-- ,OUTKAL.DEST_CD                            " & vbNewLine _
                                                       & " ,CASE WHEN MCD.NRS_BR_CD IS NULL THEN OUTKAL.DEST_CD                                    " & vbNewLine _
                                                       & "       WHEN MCD.NRS_BR_CD IS NOT NULL AND OUTKAL.SHIP_CD_L <> '' THEN OUTKAL.SHIP_CD_L   " & vbNewLine _
                                                       & "       ELSE OUTKAL.DEST_CD END DEST_CD                                                   " & vbNewLine _
                                                       & " ,OUTKAM.GOODS_CD_NRS                         " & vbNewLine _
                                                       & " ,OUTKAS.LOT_NO                               " & vbNewLine _
                                                       & " ,@ROW_NO AS ROW_NO                           " & vbNewLine _
                                                       & " --(2014.10.02) 高取対応START                   " & vbNewLine _
                                                       & " ,GOODS.GOODS_CD_CUST                         " & vbNewLine _
                                                       & " --(2014.10.02) 高取対応END                   " & vbNewLine _
                                                       & " ,INKAL.INKA_DATE    --ADD 2018/11/14 要望番号001939 " & vbNewLine _
                                                       & " FROM $LM_TRN$..C_OUTKA_M OUTKAM                " & vbNewLine _
                                                       & " LEFT JOIN $LM_TRN$..C_OUTKA_L OUTKAL ON        " & vbNewLine _
                                                       & " OUTKAL.NRS_BR_CD = OUTKAM.NRS_BR_CD AND      " & vbNewLine _
                                                       & " OUTKAL.OUTKA_NO_L = OUTKAM.OUTKA_NO_L AND    " & vbNewLine _
                                                       & " OUTKAL.SYS_DEL_FLG = '0'                     " & vbNewLine _
                                                       & " LEFT JOIN $LM_TRN$..C_OUTKA_S OUTKAS ON        " & vbNewLine _
                                                       & " OUTKAS.NRS_BR_CD = OUTKAM.NRS_BR_CD AND      " & vbNewLine _
                                                       & " OUTKAS.OUTKA_NO_L = OUTKAM.OUTKA_NO_L AND    " & vbNewLine _
                                                       & " OUTKAS.OUTKA_NO_M = OUTKAM.OUTKA_NO_M AND    " & vbNewLine _
                                                       & " OUTKAS.SYS_DEL_FLG = '0'                     " & vbNewLine _
                                                       & " LEFT JOIN $LM_MST$..M_GOODS GOODS ON           " & vbNewLine _
                                                       & " GOODS.NRS_BR_CD = OUTKAM.NRS_BR_CD           " & vbNewLine _
                                                       & " AND GOODS.GOODS_CD_NRS = OUTKAM.GOODS_CD_NRS " & vbNewLine _
                                                       & " LEFT JOIN $LM_MST$..M_CUST CUST ON             " & vbNewLine _
                                                       & " CUST.NRS_BR_CD = OUTKAM.NRS_BR_CD AND        " & vbNewLine _
                                                       & " CUST.CUST_CD_L = GOODS.CUST_CD_L AND         " & vbNewLine _
                                                       & " CUST.CUST_CD_M = GOODS.CUST_CD_M AND         " & vbNewLine _
                                                       & " CUST.CUST_CD_S = GOODS.CUST_CD_S AND         " & vbNewLine _
                                                       & " CUST.CUST_CD_SS = GOODS.CUST_CD_SS           " & vbNewLine _
                                                       & " LEFT JOIN $LM_MST$..M_CUST_DETAILS MCD ON    " & vbNewLine _
                                                       & " MCD.NRS_BR_CD = OUTKAL.NRS_BR_CD AND         " & vbNewLine _
                                                       & " MCD.CUST_CD = OUTKAL.CUST_CD_L   AND         " & vbNewLine _
                                                       & " MCD.SUB_KB = '82'                AND         " & vbNewLine _
                                                       & " MCD.SYS_DEL_FLG = '0'                        " & vbNewLine _
                                                       & "--ADD START 2018/11/14 要望番号001939         " & vbNewLine _
                                                       & " LEFT JOIN $LM_TRN$..B_INKA_L INKAL ON        " & vbNewLine _
                                                       & " INKAL.NRS_BR_CD = OUTKAS.NRS_BR_CD AND       " & vbNewLine _
                                                       & " INKAL.INKA_NO_L = OUTKAS.INKA_NO_L AND       " & vbNewLine _
                                                       & " INKAL.SYS_DEL_FLG = '0'                      " & vbNewLine _
                                                       & "--ADD END   2018/11/14 要望番号001939         " & vbNewLine _
                                                       & " WHERE OUTKAM.NRS_BR_CD = @NRS_BR_CD          " & vbNewLine _
                                                       & " AND OUTKAM.OUTKA_NO_L = @OUTKA_NO_L          " & vbNewLine _
                                                       & " AND OUTKAM.COA_YN = '01'                     " & vbNewLine _
                                                       & " AND OUTKAM.SYS_DEL_FLG = '0'                 " & vbNewLine _
                                                       & " ORDER BY OUTKAS.LOT_NO                       " & vbNewLine _
                                                       & " ,OUTKAM.GOODS_CD_NRS                         " & vbNewLine
    'END YANAI 要望番号741

    ''' <summary>
    ''' イエローカード検索用SQL
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_SELECT_YCARD_OUTKA_M As String = "" _
            & " SELECT                                                          " & vbNewLine _
            & "   OUTKAM.NRS_BR_CD,                                             " & vbNewLine _
            & "   OUTKAL.OUTKA_NO_L,                                            " & vbNewLine _
            & "   OUTKAL.CUST_CD_L,                                             " & vbNewLine _
            & "   CUST.CUST_NM_L,                                               " & vbNewLine _
            & "   OUTKAM.GOODS_CD_NRS,                                          " & vbNewLine _
            & "   OUTKAS.LOT_NO,                                                " & vbNewLine _
            & "   @ROW_NO AS ROW_NO,                                            " & vbNewLine _
            & "   GOODS.GOODS_CD_CUST,                                          " & vbNewLine _
            & "   GOODS.SHOBO_CD,                                               " & vbNewLine _
            & "   CASE                                                          " & vbNewLine _
            & "     WHEN YCARD1.NRS_BR_CD IS NOT NULL THEN YCARD1.YCARD_LINK    " & vbNewLine _
            & "     WHEN YCARD2.NRS_BR_CD IS NOT NULL THEN YCARD2.YCARD_LINK    " & vbNewLine _
            & "     WHEN YCARD3.NRS_BR_CD IS NOT NULL THEN YCARD3.YCARD_LINK    " & vbNewLine _
            & "     ELSE ''                                                     " & vbNewLine _
            & "   END AS YCARD_LINK,                                            " & vbNewLine _
            & "   CASE                                                          " & vbNewLine _
            & "     WHEN YCARD1.NRS_BR_CD IS NOT NULL THEN YCARD1.YCARD_NAME    " & vbNewLine _
            & "     WHEN YCARD2.NRS_BR_CD IS NOT NULL THEN YCARD2.YCARD_NAME    " & vbNewLine _
            & "     WHEN YCARD3.NRS_BR_CD IS NOT NULL THEN YCARD3.YCARD_NAME    " & vbNewLine _
            & "     ELSE ''                                                     " & vbNewLine _
            & "   END AS YCARD_NAME                                             " & vbNewLine _
            & " FROM                                                            " & vbNewLine _
            & "   $LM_TRN$..C_OUTKA_M OUTKAM                                    " & vbNewLine _
            & " LEFT JOIN                                                       " & vbNewLine _
            & "   $LM_TRN$..C_OUTKA_L OUTKAL                                    " & vbNewLine _
            & "   ON                                                            " & vbNewLine _
            & "     OUTKAL.NRS_BR_CD = OUTKAM.NRS_BR_CD                         " & vbNewLine _
            & "     AND OUTKAL.OUTKA_NO_L = OUTKAM.OUTKA_NO_L                   " & vbNewLine _
            & "     AND OUTKAL.SYS_DEL_FLG = '0'                                " & vbNewLine _
            & " LEFT JOIN                                                       " & vbNewLine _
            & "   $LM_TRN$..C_OUTKA_S OUTKAS                                    " & vbNewLine _
            & "   ON                                                            " & vbNewLine _
            & "     OUTKAS.NRS_BR_CD = OUTKAM.NRS_BR_CD                         " & vbNewLine _
            & "     AND OUTKAS.OUTKA_NO_L = OUTKAM.OUTKA_NO_L                   " & vbNewLine _
            & "     AND OUTKAS.OUTKA_NO_M = OUTKAM.OUTKA_NO_M                   " & vbNewLine _
            & "     AND OUTKAS.SYS_DEL_FLG = '0'                                " & vbNewLine _
            & " LEFT JOIN                                                       " & vbNewLine _
            & "   $LM_MST$..M_GOODS GOODS                                       " & vbNewLine _
            & "   ON                                                            " & vbNewLine _
            & "     GOODS.NRS_BR_CD = OUTKAM.NRS_BR_CD                          " & vbNewLine _
            & "     AND GOODS.GOODS_CD_NRS = OUTKAM.GOODS_CD_NRS                " & vbNewLine _
            & "     AND GOODS.SYS_DEL_FLG = '0'                                 " & vbNewLine _
            & " LEFT JOIN                                                       " & vbNewLine _
            & "   $LM_MST$..M_CUST CUST                                         " & vbNewLine _
            & "   ON                                                            " & vbNewLine _
            & "     CUST.NRS_BR_CD = OUTKAM.NRS_BR_CD                           " & vbNewLine _
            & "     AND CUST.CUST_CD_L = GOODS.CUST_CD_L                        " & vbNewLine _
            & "     AND CUST.CUST_CD_M = GOODS.CUST_CD_M                        " & vbNewLine _
            & "     AND CUST.CUST_CD_S = GOODS.CUST_CD_S                        " & vbNewLine _
            & "     AND CUST.CUST_CD_SS = GOODS.CUST_CD_SS                      " & vbNewLine _
            & "     AND CUST.SYS_DEL_FLG = '0'                                  " & vbNewLine _
            & " LEFT JOIN                                                       " & vbNewLine _
            & "   $LM_MST$..M_YCARD YCARD1                                      " & vbNewLine _
            & "   ON                                                            " & vbNewLine _
            & "     YCARD1.NRS_BR_CD = OUTKAM.NRS_BR_CD                         " & vbNewLine _
            & "     AND YCARD1.CUST_CD_L = GOODS.CUST_CD_L                      " & vbNewLine _
            & "     AND YCARD1.CUST_CD_M = GOODS.CUST_CD_M                      " & vbNewLine _
            & "     AND YCARD1.GOODS_CD_NRS = OUTKAM.GOODS_CD_NRS               " & vbNewLine _
            & "     AND YCARD1.LOT_NO = OUTKAS.LOT_NO                           " & vbNewLine _
            & "     AND YCARD1.SYS_DEL_FLG = '0'                                " & vbNewLine _
            & " LEFT JOIN                                                       " & vbNewLine _
            & "   $LM_MST$..M_YCARD YCARD2                                      " & vbNewLine _
            & "   ON                                                            " & vbNewLine _
            & "     YCARD2.NRS_BR_CD = OUTKAM.NRS_BR_CD                         " & vbNewLine _
            & "     AND YCARD2.CUST_CD_L = GOODS.CUST_CD_L                      " & vbNewLine _
            & "     AND YCARD2.CUST_CD_M = GOODS.CUST_CD_M                      " & vbNewLine _
            & "     AND YCARD2.GOODS_CD_NRS = OUTKAM.GOODS_CD_NRS               " & vbNewLine _
            & "     AND YCARD2.LOT_NO = ''                                      " & vbNewLine _
            & "     AND YCARD2.SYS_DEL_FLG = '0'                                " & vbNewLine _
            & " LEFT JOIN                                                       " & vbNewLine _
            & "   $LM_MST$..M_YCARD YCARD3                                      " & vbNewLine _
            & "   ON                                                            " & vbNewLine _
            & "     YCARD3.NRS_BR_CD = OUTKAM.NRS_BR_CD                         " & vbNewLine _
            & "     AND YCARD3.CUST_CD_L = GOODS.CUST_CD_L                      " & vbNewLine _
            & "     AND YCARD3.CUST_CD_M = GOODS.CUST_CD_M                      " & vbNewLine _
            & "     AND YCARD3.SHOBO_CD = GOODS.SHOBO_CD                        " & vbNewLine _
            & "     AND YCARD3.SHOBO_CD <> ''                                   " & vbNewLine _
            & "     AND YCARD3.SYS_DEL_FLG = '0'                                " & vbNewLine _
            & " WHERE                                                           " & vbNewLine _
            & "   OUTKAM.NRS_BR_CD = @NRS_BR_CD                                 " & vbNewLine _
            & "   AND OUTKAM.OUTKA_NO_L = @OUTKA_NO_L                           " & vbNewLine _
            & "   AND OUTKAM.SYS_DEL_FLG = '0'                                  " & vbNewLine _
            & "   AND CASE                                                      " & vbNewLine _
            & "     WHEN YCARD1.NRS_BR_CD IS NOT NULL THEN YCARD1.YCARD_LINK    " & vbNewLine _
            & "     WHEN YCARD2.NRS_BR_CD IS NOT NULL THEN YCARD2.YCARD_LINK    " & vbNewLine _
            & "     WHEN YCARD3.NRS_BR_CD IS NOT NULL THEN YCARD3.YCARD_LINK    " & vbNewLine _
            & "     ELSE ''                                                     " & vbNewLine _
            & "   END <> ''                                                     " & vbNewLine _
            & "   AND CASE                                                      " & vbNewLine _
            & "     WHEN YCARD1.NRS_BR_CD IS NOT NULL THEN YCARD1.YCARD_NAME    " & vbNewLine _
            & "     WHEN YCARD2.NRS_BR_CD IS NOT NULL THEN YCARD2.YCARD_NAME    " & vbNewLine _
            & "     WHEN YCARD3.NRS_BR_CD IS NOT NULL THEN YCARD3.YCARD_NAME    " & vbNewLine _
            & "     ELSE ''                                                     " & vbNewLine _
            & "   END <> ''                                                     " & vbNewLine _
            & " ORDER BY                                                        " & vbNewLine _
            & "   OUTKAS.LOT_NO,                                                " & vbNewLine _
            & "   OUTKAM.GOODS_CD_NRS                                           " & vbNewLine

#Region "出荷報告・Excel出力対象データ抽出用"

    'START YANAI 要望番号773　報告書Excel対応
    ''' <summary>
    ''' 出荷報告・Excel出力対象データ抽出用 SELECT句
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_SELECT_HOUKOKU_EXCEL As String = " SELECT                                                                 " & vbNewLine _
                                                & " OUTKAL.CUST_ORD_NO                               AS CUST_ORD_NO             " & vbNewLine _
                                                & ",OUTKAL.OUTKA_NO_L                                AS OUTKA_NO_L              " & vbNewLine _
                                                & ",OUTKAM.OUTKA_NO_M                                AS OUTKA_NO_M              " & vbNewLine _
                                                & ",OUTKAM.CUST_ORD_NO_DTL                           AS CUST_ORD_NO_DTL         " & vbNewLine _
                                                & ",OUTKAL.OUTKA_PLAN_DATE                           AS OUTKA_PLAN_DATE         " & vbNewLine _
                                                & ",OUTKAL.DEST_CD                                   AS DEST_CD                 " & vbNewLine _
                                                & ",GOODS.GOODS_CD_CUST                              AS GOODS_CD_CUST           " & vbNewLine _
                                                & ",GOODS.GOODS_NM_1                                 AS GOODS_NM_1              " & vbNewLine _
                                                & ",OUTKAS.LOT_NO                                    AS LOT_NO                  " & vbNewLine _
                                                & ",MAX(OUTKAS.OUTKA_TTL_QT)                         AS OUTKA_TTL_QT            " & vbNewLine _
                                                & ",OUTKAL.DENP_NO                                   AS DENP_NO                 " & vbNewLine _
                                                & ",ISNULL(DEST.DEST_NM,OUTKAL.DEST_NM)              AS DEST_NM                 " & vbNewLine _
                                                & ",ISNULL(DEST.AD_1,OUTKAL.DEST_AD_1)               AS DEST_AD_1               " & vbNewLine _
                                                & ",ISNULL(DEST.AD_2,OUTKAL.DEST_AD_2)               AS DEST_AD_2               " & vbNewLine _
                                                & ",OUTKAL.DEST_AD_3                                 AS DEST_AD_3               " & vbNewLine _
                                                & ",UNSOCO.UNSOCO_NM                                 AS UNSOCO_NM               " & vbNewLine _
                                                & ",UNSOCO.UNSOCO_BR_NM                              AS UNSOCO_BR_NM            " & vbNewLine

    ''' <summary>
    ''' 出荷報告・Excel出力対象データ抽出用 FROM句
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_SELECT_FROM_HOUKOKU_EXCEL As String = "FROM                                                               " & vbNewLine _
                                                & "$LM_TRN$..C_OUTKA_L OUTKAL                                                   " & vbNewLine _
                                                & "LEFT JOIN                                                                    " & vbNewLine _
                                                & "$LM_TRN$..C_OUTKA_M OUTKAM                                                   " & vbNewLine _
                                                & "ON                                                                           " & vbNewLine _
                                                & "OUTKAM.NRS_BR_CD = OUTKAL.NRS_BR_CD                                          " & vbNewLine _
                                                & "AND                                                                          " & vbNewLine _
                                                & "OUTKAM.OUTKA_NO_L = OUTKAL.OUTKA_NO_L                                        " & vbNewLine _
                                                & "AND                                                                          " & vbNewLine _
                                                & "OUTKAM.SYS_DEL_FLG = '0'                                                     " & vbNewLine _
                                                & "LEFT JOIN                                                                    " & vbNewLine _
                                                & "$LM_TRN$..C_OUTKA_S OUTKAS                                                   " & vbNewLine _
                                                & "ON                                                                           " & vbNewLine _
                                                & "OUTKAS.NRS_BR_CD = OUTKAM.NRS_BR_CD                                          " & vbNewLine _
                                                & "AND                                                                          " & vbNewLine _
                                                & "OUTKAS.OUTKA_NO_L = OUTKAM.OUTKA_NO_L                                        " & vbNewLine _
                                                & "AND                                                                          " & vbNewLine _
                                                & "OUTKAS.OUTKA_NO_M = OUTKAM.OUTKA_NO_M                                        " & vbNewLine _
                                                & "AND                                                                          " & vbNewLine _
                                                & "OUTKAS.SYS_DEL_FLG = '0'                                                     " & vbNewLine _
                                                & "LEFT JOIN                                                                    " & vbNewLine _
                                                & "$LM_MST$..M_GOODS GOODS                                                      " & vbNewLine _
                                                & "ON                                                                           " & vbNewLine _
                                                & "GOODS.NRS_BR_CD = OUTKAM.NRS_BR_CD                                           " & vbNewLine _
                                                & "AND                                                                          " & vbNewLine _
                                                & "GOODS.GOODS_CD_NRS = OUTKAM.GOODS_CD_NRS                                     " & vbNewLine _
                                                & "LEFT JOIN                                                                    " & vbNewLine _
                                                & "$LM_MST$..M_DEST DEST                                                        " & vbNewLine _
                                                & "ON                                                                           " & vbNewLine _
                                                & "DEST.NRS_BR_CD = OUTKAL.NRS_BR_CD                                            " & vbNewLine _
                                                & "AND                                                                          " & vbNewLine _
                                                & "DEST.DEST_CD = OUTKAL.DEST_CD                                                " & vbNewLine _
                                                & "--(2013.11.18 追加START)                                                     " & vbNewLine _
                                                & "AND                                                                          " & vbNewLine _
                                                & "DEST.CUST_CD_L = OUTKAL.CUST_CD_L                                            " & vbNewLine _
                                                & "--(2013.11.18 追加END)                                                       " & vbNewLine _
                                                & "LEFT JOIN                                                                    " & vbNewLine _
                                                & "$LM_TRN$..F_UNSO_L UNSOL                                                     " & vbNewLine _
                                                & "ON                                                                           " & vbNewLine _
                                                & "UNSOL.NRS_BR_CD = OUTKAL.NRS_BR_CD                                           " & vbNewLine _
                                                & "AND                                                                          " & vbNewLine _
                                                & "UNSOL.INOUTKA_NO_L = OUTKAL.OUTKA_NO_L                                       " & vbNewLine _
                                                & "AND                                                                          " & vbNewLine _
                                                & "UNSOL.SYS_DEL_FLG = '0'                                                      " & vbNewLine _
                                                & "LEFT JOIN                                                                    " & vbNewLine _
                                                & "$LM_MST$..M_UNSOCO UNSOCO                                                    " & vbNewLine _
                                                & "ON                                                                           " & vbNewLine _
                                                & "UNSOCO.NRS_BR_CD = UNSOL.NRS_BR_CD                                           " & vbNewLine _
                                                & "AND                                                                          " & vbNewLine _
                                                & "UNSOCO.UNSOCO_CD = UNSOL.UNSO_CD                                             " & vbNewLine _
                                                & "AND                                                                          " & vbNewLine _
                                                & "UNSOCO.UNSOCO_BR_CD = UNSOL.UNSO_BR_CD                                       " & vbNewLine

    ''' <summary>
    ''' 出荷報告・Excel出力対象データ抽出用 GROUP BY句
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_SELECT_GROUP_HOUKOKU_EXCEL As String = " GROUP BY                                                         " & vbNewLine _
                                                & " OUTKAL.CUST_ORD_NO                                                          " & vbNewLine _
                                                & ",OUTKAL.OUTKA_NO_L                                                           " & vbNewLine _
                                                & ",OUTKAM.OUTKA_NO_M                                                           " & vbNewLine _
                                                & ",OUTKAM.CUST_ORD_NO_DTL                                                      " & vbNewLine _
                                                & ",OUTKAL.OUTKA_PLAN_DATE                                                      " & vbNewLine _
                                                & ",OUTKAL.DEST_CD                                                              " & vbNewLine _
                                                & ",GOODS.GOODS_CD_CUST                                                         " & vbNewLine _
                                                & ",GOODS.GOODS_NM_1                                                            " & vbNewLine _
                                                & ",OUTKAS.LOT_NO                                                               " & vbNewLine _
                                                & ",OUTKAL.DENP_NO                                                              " & vbNewLine _
                                                & ",DEST.DEST_NM                                                                " & vbNewLine _
                                                & ",OUTKAL.DEST_NM                                                              " & vbNewLine _
                                                & ",DEST.AD_1                                                                   " & vbNewLine _
                                                & ",OUTKAL.DEST_AD_1                                                            " & vbNewLine _
                                                & ",DEST.AD_2                                                                   " & vbNewLine _
                                                & ",OUTKAL.DEST_AD_2                                                            " & vbNewLine _
                                                & ",OUTKAL.DEST_AD_3                                                            " & vbNewLine _
                                                & ",UNSOCO.UNSOCO_NM                                                            " & vbNewLine _
                                                & ",UNSOCO.UNSOCO_BR_NM                                                         " & vbNewLine
    ''' <summary>
    ''' 出荷報告・Excel出力対象データ抽出用 ORDER BY句
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_SELECT_ORDER_HOUKOKU_EXCEL As String = " ORDER BY                                                         " & vbNewLine _
                                                & " OUTKAL.OUTKA_NO_L                                                           " & vbNewLine _
                                                & ",OUTKAM.OUTKA_NO_M                                                           " & vbNewLine
    'END YANAI 要望番号773　報告書Excel対応

    ''' <summary>
    ''' 出荷報告・Excel出力対象データ抽出用 SELECT句
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_SELECT_HOUKOKU_EXCEL_FOR_CHIBA As String = "SELECT                                                                               " & vbNewLine _
                                                                & " BASE.CUST_ORD_NO                               AS CUST_ORD_NO                       " & vbNewLine _
                                                                & ",BASE.OUTKA_NO_L                                AS OUTKA_NO_L                        " & vbNewLine _
                                                                & ",BASE.OUTKA_NO_M                                AS OUTKA_NO_M                        " & vbNewLine _
                                                                & ",BASE.CUST_ORD_NO_DTL                           AS CUST_ORD_NO_DTL                   " & vbNewLine _
                                                                & ",BASE.OUTKA_PLAN_DATE                           AS OUTKA_PLAN_DATE                   " & vbNewLine _
                                                                & ",CASE WHEN CNT > 0 THEN EDI_DEST_CD ELSE OUTKA_DEST_CD END AS DEST_CD                " & vbNewLine _
                                                                & ",BASE.GOODS_CD_CUST                              AS GOODS_CD_CUST                    " & vbNewLine _
                                                                & ",BASE.GOODS_NM_1                                 AS GOODS_NM_1                       " & vbNewLine _
                                                                & ",BASE.LOT_NO                                    AS LOT_NO                            " & vbNewLine _
                                                                & ",BASE.OUTKA_TTL_QT                         AS OUTKA_TTL_QT                           " & vbNewLine _
                                                                & ",BASE.DENP_NO                                   AS DENP_NO                           " & vbNewLine _
                                                                & ",CASE WHEN BASE.CNT > 0 THEN BASE.EDI_DEST_CD ELSE BASE.OUTKA_DEST_CD END AS DEST_CD                " & vbNewLine _
                                                                & ",CASE WHEN BASE.CNT > 0 THEN BASE.EDI_DEST_NM ELSE BASE.OUTKA_DEST_NM END AS DEST_NM                " & vbNewLine _
                                                                & ",CASE WHEN BASE.CNT > 0 THEN BASE.EDI_DEST_AD_1 ELSE BASE.OUTKA_DEST_AD_1 END AS DEST_AD_1          " & vbNewLine _
                                                                & ",CASE WHEN BASE.CNT > 0 THEN BASE.EDI_DEST_AD_2 ELSE BASE.OUTKA_DEST_AD_2 END AS DEST_AD_2          " & vbNewLine _
                                                                & ",CASE WHEN BASE.CNT > 0 THEN BASE.EDI_DEST_AD_3 ELSE BASE.OUTKA_DEST_AD_3 END AS DEST_AD_3          " & vbNewLine _
                                                                & ",BASE.UNSOCO_NM                                 AS UNSOCO_NM                         " & vbNewLine _
                                                                & ",BASE.UNSOCO_BR_NM                              AS UNSOCO_BR_NM                      " & vbNewLine _
                                                                & "FROM                                                                                 " & vbNewLine _
                                                                & "(                                                                                    " & vbNewLine _
                                                                & "SELECT                                                                               " & vbNewLine _
                                                                & "OUTKAL.CUST_ORD_NO                               AS CUST_ORD_NO                      " & vbNewLine _
                                                                & ",OUTKAL.OUTKA_NO_L                                AS OUTKA_NO_L                      " & vbNewLine _
                                                                & ",OUTKAM.OUTKA_NO_M                                AS OUTKA_NO_M                      " & vbNewLine _
                                                                & ",OUTKAM.CUST_ORD_NO_DTL                           AS CUST_ORD_NO_DTL                 " & vbNewLine _
                                                                & ",OUTKAL.OUTKA_PLAN_DATE                           AS OUTKA_PLAN_DATE                 " & vbNewLine _
                                                                & ",GOODS.GOODS_CD_CUST                              AS GOODS_CD_CUST                   " & vbNewLine _
                                                                & ",GOODS.GOODS_NM_1                                 AS GOODS_NM_1                      " & vbNewLine _
                                                                & ",OUTKAS.LOT_NO                                    AS LOT_NO                          " & vbNewLine _
                                                                & ",MAX(OUTKAS.OUTKA_TTL_QT)                         AS OUTKA_TTL_QT                    " & vbNewLine _
                                                                & ",OUTKAL.DENP_NO                                   AS DENP_NO                         " & vbNewLine _
                                                                & ",UNSOCO.UNSOCO_NM                                 AS UNSOCO_NM                       " & vbNewLine _
                                                                & ",UNSOCO.UNSOCO_BR_NM                              AS UNSOCO_BR_NM                    " & vbNewLine _
                                                                & ",EDIL.DEST_CD                                     AS EDI_DEST_CD                     " & vbNewLine _
                                                                & ",EDIL.DEST_NM                                     AS EDI_DEST_NM                     " & vbNewLine _
                                                                & ",EDIL.DEST_AD_1                                   AS EDI_DEST_AD_1                   " & vbNewLine _
                                                                & ",EDIL.DEST_AD_2                                   AS EDI_DEST_AD_2                   " & vbNewLine _
                                                                & ",EDIL.DEST_AD_3                                   AS EDI_DEST_AD_3                   " & vbNewLine _
                                                                & ",OUTKAL.DEST_CD                                   AS OUTKA_DEST_CD                   " & vbNewLine _
                                                                & ",ISNULL(DEST.DEST_NM,OUTKAL.DEST_NM)              AS OUTKA_DEST_NM                   " & vbNewLine _
                                                                & ",ISNULL(DEST.AD_1,OUTKAL.DEST_AD_1)               AS OUTKA_DEST_AD_1                 " & vbNewLine _
                                                                & ",ISNULL(DEST.AD_2,OUTKAL.DEST_AD_2)               AS OUTKA_DEST_AD_2                 " & vbNewLine _
                                                                & ",OUTKAL.DEST_AD_3                                 AS OUTKA_DEST_AD_3                 " & vbNewLine _
                                                                & ",(SELECT COUNT(*) FROM $LM_MST$..Z_KBN KBN WHERE KBN.KBN_GROUP_CD = 'D021' AND OUTKAL.NRS_BR_CD = KBN.KBN_NM1 AND OUTKAL.CUST_CD_L = KBN.KBN_NM2 AND OUTKAL.DEST_CD = KBN.KBN_NM3) AS CNT       " & vbNewLine

    ''' <summary>
    ''' 出荷報告・Excel出力対象データ抽出用 FROM句
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_SELECT_FROM_HOUKOKU_EXCEL_FOR_CHIBA_1 As String = "FROM                                                               " & vbNewLine _
                                                & "$LM_TRN$..C_OUTKA_L OUTKAL                                                   " & vbNewLine _
                                                & "LEFT JOIN                                                                    " & vbNewLine _
                                                & "$LM_TRN$..C_OUTKA_M OUTKAM                                                   " & vbNewLine _
                                                & "ON                                                                           " & vbNewLine _
                                                & "OUTKAM.NRS_BR_CD = OUTKAL.NRS_BR_CD                                          " & vbNewLine _
                                                & "AND                                                                          " & vbNewLine _
                                                & "OUTKAM.OUTKA_NO_L = OUTKAL.OUTKA_NO_L                                        " & vbNewLine _
                                                & "AND                                                                          " & vbNewLine _
                                                & "OUTKAM.SYS_DEL_FLG = '0'                                                     " & vbNewLine _
                                                & "LEFT JOIN                                                                    " & vbNewLine _
                                                & "$LM_TRN$..C_OUTKA_S OUTKAS                                                   " & vbNewLine _
                                                & "ON                                                                           " & vbNewLine _
                                                & "OUTKAS.NRS_BR_CD = OUTKAM.NRS_BR_CD                                          " & vbNewLine _
                                                & "AND                                                                          " & vbNewLine _
                                                & "OUTKAS.OUTKA_NO_L = OUTKAM.OUTKA_NO_L                                        " & vbNewLine _
                                                & "AND                                                                          " & vbNewLine _
                                                & "OUTKAS.OUTKA_NO_M = OUTKAM.OUTKA_NO_M                                        " & vbNewLine _
                                                & "AND                                                                          " & vbNewLine _
                                                & "OUTKAS.SYS_DEL_FLG = '0'                                                     " & vbNewLine _
                                                & " LEFT JOIN (                                                                                                                   " & vbNewLine _
                                                & "            SELECT                                                                                                             " & vbNewLine _
                                                & "                   NRS_BR_CD                                                                                                   " & vbNewLine _
                                                & "                 , EDI_CTL_NO                                                                                                  " & vbNewLine _
                                                & "                 , OUTKA_CTL_NO                                                                                                " & vbNewLine _
                                                & "             FROM (                                                                                                            " & vbNewLine _
                                                & "                    SELECT                                                                                                     " & vbNewLine _
                                                & "                           EDIOUTL.NRS_BR_CD                                                                                   " & vbNewLine _
                                                & "                         , EDIOUTL.EDI_CTL_NO                                                                                  " & vbNewLine _
                                                & "                         , EDIOUTL.OUTKA_CTL_NO                                                                                " & vbNewLine _
                                                & "                         , CASE WHEN EDIOUTL.OUTKA_CTL_NO = '' THEN 1                                                          " & vbNewLine _
                                                & "                           ELSE ROW_NUMBER() OVER (PARTITION BY EDIOUTL.NRS_BR_CD                                              " & vbNewLine _
                                                & "                                                              , EDIOUTL.OUTKA_CTL_NO                                           " & vbNewLine _
                                                & "                                                       ORDER BY EDIOUTL.NRS_BR_CD                                              " & vbNewLine _
                                                & "                                                              , EDIOUTL.EDI_CTL_NO                                             " & vbNewLine _
                                                & "                                                  )                                                                            " & vbNewLine _
                                                & "                           END AS IDX                                                                                          " & vbNewLine _
                                                & "                     FROM $LM_TRN$..H_OUTKAEDI_L EDIOUTL                                                                       " & vbNewLine _
                                                & "                    WHERE EDIOUTL.SYS_DEL_FLG  = '0'                                                                           " & vbNewLine _
                                                & "                      AND EDIOUTL.NRS_BR_CD    = @NRS_BR_CD                                                                    " & vbNewLine

    Private Const SQL_SELECT_FROM_HOUKOKU_EXCEL_FOR_CHIBA_2 As String = "                                                                                         " & vbNewLine _
                                                    & "                  ) EBASE                                                                                                      " & vbNewLine _
                                                    & "            WHERE EBASE.IDX = 1                                                                                                " & vbNewLine _
                                                    & "            ) TOPEDI                                                                                                           " & vbNewLine _
                                                    & "        ON TOPEDI.NRS_BR_CD    = OUTKAL.NRS_BR_CD                                                                                " & vbNewLine _
                                                    & "       AND TOPEDI.OUTKA_CTL_NO = OUTKAL.OUTKA_NO_L                                                                               " & vbNewLine _
                                                    & " LEFT JOIN $LM_TRN$..H_OUTKAEDI_L EDIL                                                                                         " & vbNewLine _
                                                    & "        ON EDIL.NRS_BR_CD  = TOPEDI.NRS_BR_CD                                                                                  " & vbNewLine _
                                                    & "       AND EDIL.EDI_CTL_NO = TOPEDI.EDI_CTL_NO                                                                                 " & vbNewLine _
                                                    & "LEFT JOIN                                                                    " & vbNewLine _
                                                    & "$LM_MST$..M_GOODS GOODS                                                      " & vbNewLine _
                                                    & "ON                                                                           " & vbNewLine _
                                                    & "GOODS.NRS_BR_CD = OUTKAM.NRS_BR_CD                                           " & vbNewLine _
                                                    & "AND                                                                          " & vbNewLine _
                                                    & "GOODS.GOODS_CD_NRS = OUTKAM.GOODS_CD_NRS                                     " & vbNewLine _
                                                    & "LEFT JOIN                                                                    " & vbNewLine _
                                                    & "$LM_MST$..M_DEST DEST                                                        " & vbNewLine _
                                                    & "ON                                                                           " & vbNewLine _
                                                    & "DEST.NRS_BR_CD = OUTKAL.NRS_BR_CD                                            " & vbNewLine _
                                                    & "AND                                                                          " & vbNewLine _
                                                    & "DEST.DEST_CD = OUTKAL.DEST_CD                                                " & vbNewLine _
                                                    & "--(2013.11.18 追加START)                                                     " & vbNewLine _
                                                    & "AND                                                                          " & vbNewLine _
                                                    & "DEST.CUST_CD_L = OUTKAL.CUST_CD_L                                            " & vbNewLine _
                                                    & "--(2013.11.18 追加END)                                                       " & vbNewLine _
                                                    & "LEFT JOIN                                                                    " & vbNewLine _
                                                    & "$LM_TRN$..F_UNSO_L UNSOL                                                     " & vbNewLine _
                                                    & "ON                                                                           " & vbNewLine _
                                                    & "UNSOL.NRS_BR_CD = OUTKAL.NRS_BR_CD                                           " & vbNewLine _
                                                    & "AND                                                                          " & vbNewLine _
                                                    & "UNSOL.INOUTKA_NO_L = OUTKAL.OUTKA_NO_L                                       " & vbNewLine _
                                                    & "AND                                                                          " & vbNewLine _
                                                    & "UNSOL.SYS_DEL_FLG = '0'                                                      " & vbNewLine _
                                                    & "LEFT JOIN                                                                    " & vbNewLine _
                                                    & "$LM_MST$..M_UNSOCO UNSOCO                                                    " & vbNewLine _
                                                    & "ON                                                                           " & vbNewLine _
                                                    & "UNSOCO.NRS_BR_CD = UNSOL.NRS_BR_CD                                           " & vbNewLine _
                                                    & "AND                                                                          " & vbNewLine _
                                                    & "UNSOCO.UNSOCO_CD = UNSOL.UNSO_CD                                             " & vbNewLine _
                                                    & "AND                                                                          " & vbNewLine _
                                                    & "UNSOCO.UNSOCO_BR_CD = UNSOL.UNSO_BR_CD                                       " & vbNewLine

    ''' <summary>
    ''' 出荷報告・Excel出力対象データ抽出用 GROUP BY句
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_SELECT_GROUP_HOUKOKU_EXCEL_FOR_CHIBA As String = "GROUP BY                      " & vbNewLine _
                                                                    & " OUTKAL.CUST_ORD_NO           " & vbNewLine _
                                                                    & ",OUTKAL.OUTKA_NO_L            " & vbNewLine _
                                                                    & ",OUTKAM.OUTKA_NO_M            " & vbNewLine _
                                                                    & ",OUTKAM.CUST_ORD_NO_DTL       " & vbNewLine _
                                                                    & ",OUTKAL.OUTKA_PLAN_DATE       " & vbNewLine _
                                                                    & ",OUTKAL.DEST_CD               " & vbNewLine _
                                                                    & ",EDIL.DEST_CD                 " & vbNewLine _
                                                                    & ",GOODS.GOODS_CD_CUST          " & vbNewLine _
                                                                    & ",GOODS.GOODS_NM_1             " & vbNewLine _
                                                                    & ",OUTKAS.LOT_NO                " & vbNewLine _
                                                                    & ",OUTKAL.DENP_NO               " & vbNewLine _
                                                                    & ",EDIL.DEST_NM                 " & vbNewLine _
                                                                    & ",EDIL.DEST_AD_1               " & vbNewLine _
                                                                    & ",EDIL.DEST_AD_2               " & vbNewLine _
                                                                    & ",EDIL.DEST_AD_3               " & vbNewLine _
                                                                    & ",OUTKAL.DEST_NM               " & vbNewLine _
                                                                    & ",OUTKAL.DEST_AD_1             " & vbNewLine _
                                                                    & ",OUTKAL.DEST_AD_2             " & vbNewLine _
                                                                    & ",OUTKAL.DEST_AD_3             " & vbNewLine _
                                                                    & ",DEST.DEST_NM                 " & vbNewLine _
                                                                    & ",DEST.AD_1                    " & vbNewLine _
                                                                    & ",DEST.AD_2                    " & vbNewLine _
                                                                    & ",UNSOCO.UNSOCO_NM             " & vbNewLine _
                                                                    & ",UNSOCO.UNSOCO_BR_NM          " & vbNewLine _
                                                                    & ",OUTKAL.NRS_BR_CD             " & vbNewLine _
                                                                    & ",OUTKAL.CUST_CD_L             " & vbNewLine _
                                                                    & ") BASE                        " & vbNewLine

    ''' <summary>
    ''' 出荷報告・Excel出力対象データ抽出用 ORDER BY句
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_SELECT_ORDER_HOUKOKU_EXCEL_FOR_CHIBA As String = " ORDER BY                                                         " & vbNewLine _
                                                & " BASE.OUTKA_NO_L                                                           " & vbNewLine _
                                                & ",BASE.OUTKA_NO_M     "
#End Region

    'START YANAI 要望番号853 まとめ処理対応
#Region "まとめ処理"

    ''' <summary>
    ''' SELECT(まとめ処理用)
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_SELECT_ZAI_MATOME As String = "SELECT                                          " & vbNewLine _
                                         & " SUM(ZAI.ALLOC_CAN_NB)      AS ALLOC_CAN_NB              " & vbNewLine _
                                         & ",SUM(ZAI.ALLOC_CAN_QT)      AS ALLOC_CAN_QT              " & vbNewLine

    ''' <summary>
    ''' FROM(まとめ処理用)
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_SELECT_FROM_ZAI_MATOME As String = "FROM                                       " & vbNewLine _
                                         & "$LM_TRN$..D_ZAI_TRS  ZAI                                 " & vbNewLine

    ''' <summary>
    ''' WHERE(まとめ処理用)
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_SELECT_WHERE_ZAI_MATOME As String = "WHERE                                     " & vbNewLine _
                                         & "    ZAI.NRS_BR_CD              = @NRS_BR_CD              " & vbNewLine _
                                         & "AND ZAI.GOODS_CD_NRS           = @GOODS_CD_NRS           " & vbNewLine _
                                         & "AND ZAI.LOT_NO                 = @LOT_NO                 " & vbNewLine _
                                         & "AND ZAI.IRIME                  = @IRIME                  " & vbNewLine _
                                         & "AND ZAI.TOU_NO                 = @TOU_NO                 " & vbNewLine _
                                         & "AND ZAI.SITU_NO                = @SITU_NO                " & vbNewLine _
                                         & "AND ZAI.ZONE_CD                = @ZONE_CD                " & vbNewLine _
                                         & "AND ZAI.LOCA                   = @LOCA                   " & vbNewLine _
                                         & "AND ZAI.GOODS_COND_KB_1        = @GOODS_COND_KB_1        " & vbNewLine _
                                         & "AND ZAI.GOODS_COND_KB_2        = @GOODS_COND_KB_2        " & vbNewLine _
                                         & "AND ZAI.REMARK_OUT             = @REMARK_OUT             " & vbNewLine _
                                         & "AND ZAI.REMARK                 = @REMARK                 " & vbNewLine _
                                         & "AND ZAI.LT_DATE                = @LT_DATE                " & vbNewLine _
                                         & "AND ZAI.OFB_KB                 = @OFB_KB                 " & vbNewLine _
                                         & "AND ZAI.SPD_KB                 = @SPD_KB                 " & vbNewLine _
                                         & "AND ZAI.RSV_NO                 = @RSV_NO                 " & vbNewLine _
                                         & "AND ZAI.SERIAL_NO              = @SERIAL_NO              " & vbNewLine _
                                         & "AND ZAI.GOODS_CRT_DATE         = @GOODS_CRT_DATE         " & vbNewLine _
                                         & "AND ZAI.ALLOC_PRIORITY         = @ALLOC_PRIORITY         " & vbNewLine _
                                         & "AND ZAI.SYS_DEL_FLG            = '0'                     " & vbNewLine

    ''' <summary>
    ''' WHERE(まとめ処理用)
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_WHERE_INKODATE As String = "AND ZAI.INKO_DATE              = @INKO_DATE              " & vbNewLine

    ''' <summary>
    ''' WHERE(まとめ処理用)
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_WHERE_INKOPLANDATE As String = "AND ZAI.INKO_PLAN_DATE         = @INKO_PLAN_DATE              " & vbNewLine

    ''' <summary>
    ''' GROUP(まとめ処理用)
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_SELECT_GROUP_ZAI_MATOME As String = "GROUP BY                               " & vbNewLine _
                                         & " ZAI.NRS_BR_CD                                        " & vbNewLine _
                                         & ",ZAI.GOODS_CD_NRS                                     " & vbNewLine _
                                         & ",ZAI.LOT_NO                                           " & vbNewLine _
                                         & ",ZAI.IRIME                                            " & vbNewLine _
                                         & ",ZAI.TOU_NO                                           " & vbNewLine _
                                         & ",ZAI.SITU_NO                                          " & vbNewLine _
                                         & ",ZAI.ZONE_CD                                          " & vbNewLine _
                                         & ",ZAI.LOCA                                             " & vbNewLine _
                                         & ",ZAI.GOODS_COND_KB_1                                  " & vbNewLine _
                                         & ",ZAI.GOODS_COND_KB_2                                  " & vbNewLine _
                                         & ",ZAI.REMARK_OUT                                       " & vbNewLine _
                                         & ",ZAI.REMARK                                           " & vbNewLine _
                                         & ",ZAI.LT_DATE                                          " & vbNewLine _
                                         & ",ZAI.OFB_KB                                           " & vbNewLine _
                                         & ",ZAI.SPD_KB                                           " & vbNewLine _
                                         & ",ZAI.RSV_NO                                           " & vbNewLine _
                                         & ",ZAI.SERIAL_NO                                        " & vbNewLine _
                                         & ",ZAI.GOODS_CRT_DATE                                   " & vbNewLine _
                                         & ",ZAI.ALLOC_PRIORITY                                   " & vbNewLine _
                                         & ",ZAI.SYS_DEL_FLG                                      " & vbNewLine
    ''' <summary>
    ''' GROUP(まとめ処理用)
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_GROUP_INKODATE As String = ",ZAI.INKO_DATE                                        " & vbNewLine

    ''' <summary>
    ''' GROUP(まとめ処理用)
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_GROUP_INKOPLANDATE As String = ",ZAI.INKO_PLAN_DATE                                        " & vbNewLine

#End Region
    'END YANAI 要望番号853 まとめ処理対応

    '社内入荷データ作成 terakawa Start
    ''' <summary>
    ''' 社内入荷データ抽出用
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_SELECT_INT_EDI As String _
        = " SELECT                                                      " & vbNewLine _
        & "	      INT_EDI_NM              AS INT_EDI_NM                 " & vbNewLine _
        & "	    , INT_EDI_CD              AS INT_EDI_CD                 " & vbNewLine _
        & "  FROM $LM_MST$..M_INT_EDI                                   " & vbNewLine _
        & "	WHERE SYS_DEL_FLG = '0'                                     " & vbNewLine _
        & " ORDER BY                                                    " & vbNewLine _
        & "          INT_EDI_CD                                         " & vbNewLine

    '社内入荷データ作成 terakawa End

#End Region

#Region "一括引当処理 SQL"

    'START YANAI 20110914 一括引当対応
    'Private Const SQL_OUTKAL_UPDATE As String = "UPDATE $LM_TRN$..C_OUTKA_L SET                           " & vbNewLine _
    '                                          & "                  SYS_UPD_DATE         = @SYS_UPD_DATE   " & vbNewLine _
    '                                          & "                 ,SYS_UPD_TIME         = @SYS_UPD_TIME   " & vbNewLine _
    '                                          & "                 ,SYS_UPD_PGID         = @SYS_UPD_PGID   " & vbNewLine _
    '                                          & "                 ,SYS_UPD_USER         = @SYS_UPD_USER   " & vbNewLine _
    '                                          & "                 WHERE                                   " & vbNewLine _
    '                                          & "                      NRS_BR_CD        = @NRS_BR_CD      " & vbNewLine _
    '                                          & "                      AND OUTKA_NO_L   = @OUTKA_NO_L     " & vbNewLine _
    '                                          & "                      AND SYS_UPD_DATE = @GUI_UPD_DATE   " & vbNewLine _
    '                                          & "                      AND SYS_UPD_TIME = @GUI_UPD_TIME   " & vbNewLine
    ''' <summary>
    ''' OUTKA_L UPDATE用
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_OUTKAL_UPDATE As String = "UPDATE $LM_TRN$..C_OUTKA_L SET                           " & vbNewLine _
                                              & "                  OUTKA_STATE_KB       = @OUTKA_STATE_KB " & vbNewLine _
                                              & "                 ,OUTKA_PKG_NB         =                 " & vbNewLine _
                                              & "                  (CASE WHEN OUTKA_PKG_NB <> '0' THEN  OUTKA_PKG_NB   " & vbNewLine _
                                              & "                   ELSE @OUTKA_PKG_NB END)                  " & vbNewLine _
                                              & "                 ,WH_TAB_STATUS        = @WH_TAB_STATUS  " & vbNewLine _
                                              & "                 ,WH_TAB_YN            = @WH_TAB_YN      " & vbNewLine _
                                              & "                 ,URGENT_YN            = @URGENT_YN      " & vbNewLine _
                                              & "                 ,SYS_UPD_DATE         = @SYS_UPD_DATE   " & vbNewLine _
                                              & "                 ,SYS_UPD_TIME         = @SYS_UPD_TIME   " & vbNewLine _
                                              & "                 ,SYS_UPD_PGID         = @SYS_UPD_PGID   " & vbNewLine _
                                              & "                 ,SYS_UPD_USER         = @SYS_UPD_USER   " & vbNewLine _
                                              & "                 WHERE                                   " & vbNewLine _
                                              & "                      NRS_BR_CD        = @NRS_BR_CD      " & vbNewLine _
                                              & "                      AND OUTKA_NO_L   = @OUTKA_NO_L     " & vbNewLine _
                                              & "                      AND SYS_UPD_DATE = @GUI_UPD_DATE   " & vbNewLine _
                                              & "                      AND SYS_UPD_TIME = @GUI_UPD_TIME   " & vbNewLine
    'END YANAI 20110914 一括引当対応

    Private Const SQL_DEST_OUTKAL_UPDATE As String = "UPDATE $LM_TRN$..C_OUTKA_L SET                           " & vbNewLine _
                                                   & "                  DEST_KB              = '00'            " & vbNewLine _
                                                   & "                 ,SYS_UPD_DATE         = @SYS_UPD_DATE   " & vbNewLine _
                                                   & "                 ,SYS_UPD_TIME         = @SYS_UPD_TIME   " & vbNewLine _
                                                   & "                 ,SYS_UPD_PGID         = @SYS_UPD_PGID   " & vbNewLine _
                                                   & "                 ,SYS_UPD_USER         = @SYS_UPD_USER   " & vbNewLine _
                                                   & "                 WHERE                                   " & vbNewLine _
                                                   & "                      NRS_BR_CD        = @NRS_BR_CD      " & vbNewLine _
                                                   & "                      AND OUTKA_NO_L   = @OUTKA_NO_L     " & vbNewLine _
                                                   & "                      AND SYS_UPD_DATE = @GUI_UPD_DATE   " & vbNewLine _
                                                   & "                      AND SYS_UPD_TIME = @GUI_UPD_TIME   " & vbNewLine

    'START YANAI 20110914 一括引当対応
    'Private Const SQL_OUTKAM_UPDATE As String = "UPDATE $LM_TRN$..C_OUTKA_M SET                           " & vbNewLine _
    '                                          & "                  ALCTD_NB =           @ALCTD_NB         " & vbNewLine _
    '                                          & "                 ,ALCTD_QT =           @ALCTD_QT         " & vbNewLine _
    '                                          & "                 ,BACKLOG_NB =         @BACKLOG_NB       " & vbNewLine _
    '                                          & "                 ,BACKLOG_QT =         @BACKLOG_QT       " & vbNewLine _
    '                                          & "                 ,SYS_UPD_DATE =       @SYS_UPD_DATE     " & vbNewLine _
    '                                          & "                 ,SYS_UPD_TIME =       @SYS_UPD_TIME     " & vbNewLine _
    '                                          & "                 ,SYS_UPD_PGID =       @SYS_UPD_PGID     " & vbNewLine _
    '                                          & "                 ,SYS_UPD_USER =       @SYS_UPD_USER     " & vbNewLine _
    '                                          & "                 WHERE                                   " & vbNewLine _
    '                                          & "                      NRS_BR_CD =      @NRS_BR_CD        " & vbNewLine _
    '                                          & "                      AND OUTKA_NO_L = @OUTKA_NO_L       " & vbNewLine _
    '                                          & "                      AND OUTKA_NO_M = @OUTKA_NO_M       " & vbNewLine
    ''' <summary>
    ''' OUTKA_M UPDATE用
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_OUTKAM_UPDATE As String = "UPDATE $LM_TRN$..C_OUTKA_M SET                           " & vbNewLine _
                                                & "                  ALCTD_NB =           @ALCTD_NB         " & vbNewLine _
                                                & "                 ,ALCTD_QT =           @ALCTD_QT         " & vbNewLine _
                                                & "                 ,BACKLOG_NB =         @BACKLOG_NB       " & vbNewLine _
                                                & "                 ,BACKLOG_QT =         @BACKLOG_QT       " & vbNewLine _
                                                & "                 ,OUTKA_M_PKG_NB =     @OUTKA_M_PKG_NB   " & vbNewLine _
                                                & "                 ,SYS_UPD_DATE =       @SYS_UPD_DATE     " & vbNewLine _
                                                & "                 ,SYS_UPD_TIME =       @SYS_UPD_TIME     " & vbNewLine _
                                                & "                 ,SYS_UPD_PGID =       @SYS_UPD_PGID     " & vbNewLine _
                                                & "                 ,SYS_UPD_USER =       @SYS_UPD_USER     " & vbNewLine _
                                                & "                 WHERE                                   " & vbNewLine _
                                                & "                      NRS_BR_CD =      @NRS_BR_CD        " & vbNewLine _
                                                & "                      AND OUTKA_NO_L = @OUTKA_NO_L       " & vbNewLine _
                                                & "                      AND OUTKA_NO_M = @OUTKA_NO_M       " & vbNewLine
    'END YANAI 20110914 一括引当対応


    ''' <summary>
    ''' OUTKA_S INSERT用
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_OUTLA_S_INSERT As String = "INSERT INTO $LM_TRN$..C_OUTKA_S                   " & vbNewLine _
                                              & " ( 		                                        " & vbNewLine _
                                              & " NRS_BR_CD, 		                                " & vbNewLine _
                                              & " OUTKA_NO_L, 		                                " & vbNewLine _
                                              & " OUTKA_NO_M, 		                                " & vbNewLine _
                                              & " OUTKA_NO_S, 		                                " & vbNewLine _
                                              & " TOU_NO, 		                                    " & vbNewLine _
                                              & " SITU_NO,                                          " & vbNewLine _
                                              & " ZONE_CD,                                          " & vbNewLine _
                                              & " LOCA,                                             " & vbNewLine _
                                              & " LOT_NO,                                           " & vbNewLine _
                                              & " SERIAL_NO,                                        " & vbNewLine _
                                              & " OUTKA_TTL_NB,                                     " & vbNewLine _
                                              & " OUTKA_TTL_QT,                                     " & vbNewLine _
                                              & " ZAI_REC_NO,                                       " & vbNewLine _
                                              & " INKA_NO_L,                                        " & vbNewLine _
                                              & " INKA_NO_M,                                        " & vbNewLine _
                                              & " INKA_NO_S,                                        " & vbNewLine _
                                              & " ZAI_UPD_FLAG,                                     " & vbNewLine _
                                              & " ALCTD_CAN_NB,                                     " & vbNewLine _
                                              & " ALCTD_NB,                                         " & vbNewLine _
                                              & " ALCTD_CAN_QT,                                     " & vbNewLine _
                                              & " ALCTD_QT,                                         " & vbNewLine _
                                              & " IRIME,                                            " & vbNewLine _
                                              & " BETU_WT,                                          " & vbNewLine _
                                              & " COA_FLAG,                                         " & vbNewLine _
                                              & " REMARK,                                           " & vbNewLine _
                                              & " SMPL_FLAG,                                        " & vbNewLine _
                                              & " SYS_ENT_DATE,                                     " & vbNewLine _
                                              & " SYS_ENT_TIME,                                     " & vbNewLine _
                                              & " SYS_ENT_PGID,                                     " & vbNewLine _
                                              & " SYS_ENT_USER,                                     " & vbNewLine _
                                              & " SYS_UPD_DATE,                                     " & vbNewLine _
                                              & " SYS_UPD_TIME,                                     " & vbNewLine _
                                              & " SYS_UPD_PGID,                                     " & vbNewLine _
                                              & " SYS_UPD_USER,                                     " & vbNewLine _
                                              & " SYS_DEL_FLG                                       " & vbNewLine _
                                              & " ) VALUES (                                        " & vbNewLine _
                                              & " @NRS_BR_CD,                                       " & vbNewLine _
                                              & " @OUTKA_NO_L,                                      " & vbNewLine _
                                              & " @OUTKA_NO_M,                                      " & vbNewLine _
                                              & " @OUTKA_NO_S,                                      " & vbNewLine _
                                              & " @TOU_NO,                                          " & vbNewLine _
                                              & " @SITU_NO,                                         " & vbNewLine _
                                              & " @ZONE_CD,                                         " & vbNewLine _
                                              & " @LOCA,                                            " & vbNewLine _
                                              & " @LOT_NO,                                          " & vbNewLine _
                                              & " @SERIAL_NO,                                       " & vbNewLine _
                                              & " @OUTKA_TTL_NB,                                    " & vbNewLine _
                                              & " @OUTKA_TTL_QT,                                    " & vbNewLine _
                                              & " @ZAI_REC_NO,                                      " & vbNewLine _
                                              & " @INKA_NO_L,                                       " & vbNewLine _
                                              & " @INKA_NO_M,                                       " & vbNewLine _
                                              & " @INKA_NO_S,                                       " & vbNewLine _
                                              & " @ZAI_UPD_FLAG,                                    " & vbNewLine _
                                              & " @ALCTD_CAN_NB,                                    " & vbNewLine _
                                              & " @ALCTD_NB,                                        " & vbNewLine _
                                              & " @ALCTD_CAN_QT,                                    " & vbNewLine _
                                              & " @ALCTD_QT,                                        " & vbNewLine _
                                              & " @IRIME,                                           " & vbNewLine _
                                              & " @BETU_WT,                                         " & vbNewLine _
                                              & " @COA_FLAG,                                        " & vbNewLine _
                                              & " @REMARK,                                          " & vbNewLine _
                                              & " @SMPL_FLAG,                                       " & vbNewLine _
                                              & " @SYS_ENT_DATE,                                    " & vbNewLine _
                                              & " @SYS_ENT_TIME,                                    " & vbNewLine _
                                              & " @SYS_ENT_PGID,                                    " & vbNewLine _
                                              & " @SYS_ENT_USER,                                    " & vbNewLine _
                                              & " @SYS_UPD_DATE,                                    " & vbNewLine _
                                              & " @SYS_UPD_TIME,                                    " & vbNewLine _
                                              & " @SYS_UPD_PGID,                                    " & vbNewLine _
                                              & " @SYS_UPD_USER,                                    " & vbNewLine _
                                              & " @SYS_DEL_FLG                                      " & vbNewLine _
                                              & " )                                                 " & vbNewLine


    ''' <summary>
    ''' ZAI_TRS UPDATE用
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_ZAITRS_UPDATE As String = "UPDATE $LM_TRN$..D_ZAI_TRS SET                              " & vbNewLine _
                                              & "      ALCTD_NB     =  CASE WHEN    @ALCTD_KB = '01'         " & vbNewLine _
                                              & "                                OR @ALCTD_KB = '02'         " & vbNewLine _
                                              & "                                OR @ALCTD_KB = '03'         " & vbNewLine _
                                              & "                           THEN ALCTD_NB + @ALCTD_NB        " & vbNewLine _
                                              & "                           ELSE ALCTD_NB END                " & vbNewLine _
                                              & "     ,ALLOC_CAN_NB =  CASE WHEN    @ALCTD_KB = '01'         " & vbNewLine _
                                              & "                                OR @ALCTD_KB = '02'         " & vbNewLine _
                                              & "                                OR @ALCTD_KB = '03'         " & vbNewLine _
                                              & "                           THEN ALLOC_CAN_NB - @ALLOC_CAN_NB" & vbNewLine _
                                              & "                           ELSE ALLOC_CAN_NB END            " & vbNewLine _
                                              & "     ,ALCTD_QT     =  CASE WHEN    @ALCTD_KB = '01'         " & vbNewLine _
                                              & "                                OR @ALCTD_KB = '02'         " & vbNewLine _
                                              & "                                OR @ALCTD_KB = '03'         " & vbNewLine _
                                              & "                           THEN ALCTD_QT + @ALCTD_QT        " & vbNewLine _
                                              & "                           ELSE ALCTD_QT END                " & vbNewLine _
                                              & "     ,ALLOC_CAN_QT =  CASE WHEN    @ALCTD_KB = '01'         " & vbNewLine _
                                              & "                                OR @ALCTD_KB = '02'         " & vbNewLine _
                                              & "                                OR @ALCTD_KB = '03'         " & vbNewLine _
                                              & "                           THEN ALLOC_CAN_QT - @ALLOC_CAN_QT" & vbNewLine _
                                              & "                           ELSE ALLOC_CAN_QT END            " & vbNewLine _
                                              & "     ,SYS_UPD_DATE = @SYS_UPD_DATE                          " & vbNewLine _
                                              & "     ,SYS_UPD_TIME = @SYS_UPD_TIME                          " & vbNewLine _
                                              & "     ,SYS_UPD_PGID = @SYS_UPD_PGID                          " & vbNewLine _
                                              & "     ,SYS_UPD_USER = @SYS_UPD_USER                          " & vbNewLine _
                                              & "WHERE NRS_BR_CD    = @NRS_BR_CD                             " & vbNewLine _
                                              & "  AND ZAI_REC_NO   = @ZAI_REC_NO                            " & vbNewLine _
                                              & "  AND SYS_UPD_DATE = @GUI_UPD_DATE                          " & vbNewLine _
                                              & "  AND SYS_UPD_TIME = @GUI_UPD_TIME                          " & vbNewLine

    'START YANAI 要望番号585
    'START YANAI 要望番号638
    '''' <summary>
    '''' UNSO_L UPDATE用
    '''' </summary>
    '''' <remarks></remarks>
    'Private Const SQL_UNSOL_UPDATE As String = "UPDATE $LM_TRN$..F_UNSO_L SET                             " & vbNewLine _
    '                                          & "                  UNSO_WT              = @UNSO_WT        " & vbNewLine _
    '                                          & "                 ,SYS_UPD_DATE         = @SYS_UPD_DATE   " & vbNewLine _
    '                                          & "                 ,SYS_UPD_TIME         = @SYS_UPD_TIME   " & vbNewLine _
    '                                          & "                 ,SYS_UPD_PGID         = @SYS_UPD_PGID   " & vbNewLine _
    '                                          & "                 ,SYS_UPD_USER         = @SYS_UPD_USER   " & vbNewLine _
    '                                          & "                 WHERE                                   " & vbNewLine _
    '                                          & "                      NRS_BR_CD        = @NRS_BR_CD      " & vbNewLine _
    '                                          & "                      AND UNSO_NO_L    = @UNSO_NO_L      " & vbNewLine _
    '                                          & "                      AND SYS_UPD_DATE = @UNSO_UPD_DATE  " & vbNewLine _
    '                                          & "                      AND SYS_UPD_TIME = @UNSO_UPD_TIME  " & vbNewLine
    ''' <summary>
    ''' UNSO_L UPDATE用
    ''' </summary>
    ''' <remarks></remarks>
#If False Then
    Private Const SQL_UNSOL_UPDATE As String = "UPDATE $LM_TRN$..F_UNSO_L SET                             " & vbNewLine _
                                              & "                  UNSO_WT              = @UNSO_WT        " & vbNewLine _
                                              & "                 ,UNSO_PKG_NB          = @UNSO_PKG_NB    " & vbNewLine _
                                              & "                 ,SYS_UPD_DATE         = @SYS_UPD_DATE   " & vbNewLine _
                                              & "                 ,SYS_UPD_TIME         = @SYS_UPD_TIME   " & vbNewLine _
                                              & "                 ,SYS_UPD_PGID         = @SYS_UPD_PGID   " & vbNewLine _
                                              & "                 ,SYS_UPD_USER         = @SYS_UPD_USER   " & vbNewLine _
                                              & "                 WHERE                                   " & vbNewLine _
                                              & "                      NRS_BR_CD        = @NRS_BR_CD      " & vbNewLine _
                                              & "                      AND UNSO_NO_L    = @UNSO_NO_L      " & vbNewLine _
                                              & "                      AND SYS_UPD_DATE = @UNSO_UPD_DATE  " & vbNewLine _
                                              & "                      AND SYS_UPD_TIME = @UNSO_UPD_TIME  " & vbNewLine
#Else
    Private Const SQL_UNSOL_UPDATE As String = "UPDATE $LM_TRN$..F_UNSO_L SET                             " & vbNewLine _
                                              & "                  UNSO_WT              = @UNSO_WT        " & vbNewLine _
                                              & "--2019/06/13 UPD 006199                 ,UNSO_PKG_NB          = @UNSO_PKG_NB    " & vbNewLine _
                                              & "                 ,UNSO_PKG_NB          =                            " & vbNewLine _
                                              & "                  (CASE WHEN UNSO_PKG_NB <> '0' THEN  UNSO_PKG_NB   " & vbNewLine _
                                              & "                        ELSE @UNSO_PKG_NB END)                      " & vbNewLine _
                                              & "                 ,AUTO_DENP_KBN        = @AUTO_DENP_KBN  " & vbNewLine _
                                              & "                 ,AUTO_DENP_NO         = @AUTO_DENP_NO   " & vbNewLine _
                                              & "                 ,SYS_UPD_DATE         = @SYS_UPD_DATE   " & vbNewLine _
                                              & "                 ,SYS_UPD_TIME         = @SYS_UPD_TIME   " & vbNewLine _
                                              & "                 ,SYS_UPD_PGID         = @SYS_UPD_PGID   " & vbNewLine _
                                              & "                 ,SYS_UPD_USER         = @SYS_UPD_USER   " & vbNewLine _
                                              & "                 WHERE                                   " & vbNewLine _
                                              & "                      NRS_BR_CD        = @NRS_BR_CD      " & vbNewLine _
                                              & "                      AND UNSO_NO_L    = @UNSO_NO_L      " & vbNewLine _
                                              & "                      AND SYS_UPD_DATE = @UNSO_UPD_DATE  " & vbNewLine _
                                              & "                      AND SYS_UPD_TIME = @UNSO_UPD_TIME  " & vbNewLine
#End If
    'END YANAI 要望番号638
    'END YANAI 要望番号585

    'START YANAI 要望番号638
    ''' <summary>
    ''' UNCHIN INSERT用
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_UNCHIN_INSERT As String = "INSERT INTO $LM_TRN$..F_UNCHIN_TRS" & vbNewLine _
                                              & "(                                 " & vbNewLine _
                                              & " YUSO_BR_CD                       " & vbNewLine _
                                              & ",NRS_BR_CD                        " & vbNewLine _
                                              & ",UNSO_NO_L                        " & vbNewLine _
                                              & ",UNSO_NO_M                        " & vbNewLine _
                                              & ",CUST_CD_L                        " & vbNewLine _
                                              & ",CUST_CD_M                        " & vbNewLine _
                                              & ",CUST_CD_S                        " & vbNewLine _
                                              & ",CUST_CD_SS                       " & vbNewLine _
                                              & ",SEIQ_GROUP_NO                    " & vbNewLine _
                                              & ",SEIQ_GROUP_NO_M                  " & vbNewLine _
                                              & ",SEIQTO_CD                        " & vbNewLine _
                                              & ",UNTIN_CALCULATION_KB             " & vbNewLine _
                                              & ",SEIQ_SYARYO_KB                   " & vbNewLine _
                                              & ",SEIQ_PKG_UT                      " & vbNewLine _
                                              & ",SEIQ_NG_NB                       " & vbNewLine _
                                              & ",SEIQ_DANGER_KB                   " & vbNewLine _
                                              & ",SEIQ_TARIFF_BUNRUI_KB            " & vbNewLine _
                                              & ",SEIQ_TARIFF_CD                   " & vbNewLine _
                                              & ",SEIQ_ETARIFF_CD                  " & vbNewLine _
                                              & ",SEIQ_KYORI                       " & vbNewLine _
                                              & ",SEIQ_WT                          " & vbNewLine _
                                              & ",SEIQ_UNCHIN                      " & vbNewLine _
                                              & ",SEIQ_CITY_EXTC                   " & vbNewLine _
                                              & ",SEIQ_WINT_EXTC                   " & vbNewLine _
                                              & ",SEIQ_RELY_EXTC                   " & vbNewLine _
                                              & ",SEIQ_TOLL                        " & vbNewLine _
                                              & ",SEIQ_INSU                        " & vbNewLine _
                                              & ",SEIQ_FIXED_FLAG                  " & vbNewLine _
                                              & ",DECI_NG_NB                       " & vbNewLine _
                                              & ",DECI_KYORI                       " & vbNewLine _
                                              & ",DECI_WT                          " & vbNewLine _
                                              & ",DECI_UNCHIN                      " & vbNewLine _
                                              & ",DECI_CITY_EXTC                   " & vbNewLine _
                                              & ",DECI_WINT_EXTC                   " & vbNewLine _
                                              & ",DECI_RELY_EXTC                   " & vbNewLine _
                                              & ",DECI_TOLL                        " & vbNewLine _
                                              & ",DECI_INSU                        " & vbNewLine _
                                              & ",KANRI_UNCHIN                     " & vbNewLine _
                                              & ",KANRI_CITY_EXTC                  " & vbNewLine _
                                              & ",KANRI_WINT_EXTC                  " & vbNewLine _
                                              & ",KANRI_RELY_EXTC                  " & vbNewLine _
                                              & ",KANRI_TOLL                       " & vbNewLine _
                                              & ",KANRI_INSU                       " & vbNewLine _
                                              & ",REMARK                           " & vbNewLine _
                                              & ",SIZE_KB                          " & vbNewLine _
                                              & ",TAX_KB                           " & vbNewLine _
                                              & ",SAGYO_KANRI                      " & vbNewLine _
                                              & ",SYS_ENT_DATE                     " & vbNewLine _
                                              & ",SYS_ENT_TIME                     " & vbNewLine _
                                              & ",SYS_ENT_PGID                     " & vbNewLine _
                                              & ",SYS_ENT_USER                     " & vbNewLine _
                                              & ",SYS_UPD_DATE                     " & vbNewLine _
                                              & ",SYS_UPD_TIME                     " & vbNewLine _
                                              & ",SYS_UPD_PGID                     " & vbNewLine _
                                              & ",SYS_UPD_USER                     " & vbNewLine _
                                              & ",SYS_DEL_FLG                      " & vbNewLine _
                                              & " )VALUES(                         " & vbNewLine _
                                              & " @YUSO_BR_CD                      " & vbNewLine _
                                              & ",@NRS_BR_CD                       " & vbNewLine _
                                              & ",@UNSO_NO_L                       " & vbNewLine _
                                              & ",@UNSO_NO_M                       " & vbNewLine _
                                              & ",@CUST_CD_L                       " & vbNewLine _
                                              & ",@CUST_CD_M                       " & vbNewLine _
                                              & ",@CUST_CD_S                       " & vbNewLine _
                                              & ",@CUST_CD_SS                      " & vbNewLine _
                                              & ",@SEIQ_GROUP_NO                   " & vbNewLine _
                                              & ",@SEIQ_GROUP_NO_M                 " & vbNewLine _
                                              & ",@SEIQTO_CD                       " & vbNewLine _
                                              & ",@UNTIN_CALCULATION_KB            " & vbNewLine _
                                              & ",@SEIQ_SYARYO_KB                  " & vbNewLine _
                                              & ",@SEIQ_PKG_UT                     " & vbNewLine _
                                              & ",@SEIQ_NG_NB                      " & vbNewLine _
                                              & ",@SEIQ_DANGER_KB                  " & vbNewLine _
                                              & ",@SEIQ_TARIFF_BUNRUI_KB           " & vbNewLine _
                                              & ",@SEIQ_TARIFF_CD                  " & vbNewLine _
                                              & ",@SEIQ_ETARIFF_CD                 " & vbNewLine _
                                              & ",@SEIQ_KYORI                      " & vbNewLine _
                                              & ",@SEIQ_WT                         " & vbNewLine _
                                              & ",@SEIQ_UNCHIN                     " & vbNewLine _
                                              & ",@SEIQ_CITY_EXTC                  " & vbNewLine _
                                              & ",@SEIQ_WINT_EXTC                  " & vbNewLine _
                                              & ",@SEIQ_RELY_EXTC                  " & vbNewLine _
                                              & ",@SEIQ_TOLL                       " & vbNewLine _
                                              & ",@SEIQ_INSU                       " & vbNewLine _
                                              & ",@SEIQ_FIXED_FLAG                 " & vbNewLine _
                                              & ",@DECI_NG_NB                      " & vbNewLine _
                                              & ",@DECI_KYORI                      " & vbNewLine _
                                              & ",@DECI_WT                         " & vbNewLine _
                                              & ",@DECI_UNCHIN                     " & vbNewLine _
                                              & ",@DECI_CITY_EXTC                  " & vbNewLine _
                                              & ",@DECI_WINT_EXTC                  " & vbNewLine _
                                              & ",@DECI_RELY_EXTC                  " & vbNewLine _
                                              & ",@DECI_TOLL                       " & vbNewLine _
                                              & ",@DECI_INSU                       " & vbNewLine _
                                              & ",@KANRI_UNCHIN                    " & vbNewLine _
                                              & ",@KANRI_CITY_EXTC                 " & vbNewLine _
                                              & ",@KANRI_WINT_EXTC                 " & vbNewLine _
                                              & ",@KANRI_RELY_EXTC                 " & vbNewLine _
                                              & ",@KANRI_TOLL                      " & vbNewLine _
                                              & ",@KANRI_INSU                      " & vbNewLine _
                                              & ",@REMARK                          " & vbNewLine _
                                              & ",@SIZE_KB                         " & vbNewLine _
                                              & ",@TAX_KB                          " & vbNewLine _
                                              & ",@SAGYO_KANRI                     " & vbNewLine _
                                              & ",@SYS_ENT_DATE                    " & vbNewLine _
                                              & ",@SYS_ENT_TIME                    " & vbNewLine _
                                              & ",@SYS_ENT_PGID                    " & vbNewLine _
                                              & ",@SYS_ENT_USER                    " & vbNewLine _
                                              & ",@SYS_UPD_DATE                    " & vbNewLine _
                                              & ",@SYS_UPD_TIME                    " & vbNewLine _
                                              & ",@SYS_UPD_PGID                    " & vbNewLine _
                                              & ",@SYS_UPD_USER                    " & vbNewLine _
                                              & ",@SYS_DEL_FLG                     " & vbNewLine _
                                              & ")                                 " & vbNewLine
    'END YANAI 要望番号638

    'START YANAI 要望番号1286 入荷・出荷画面の機能追加（出荷データ作成）
    ''' <summary>
    ''' SHIHARAI INSERT用
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_SHIHARAI_INSERT As String = "INSERT INTO $LM_TRN$..F_SHIHARAI_TRS" & vbNewLine _
                                              & "(                                 " & vbNewLine _
                                              & " YUSO_BR_CD                       " & vbNewLine _
                                              & ",NRS_BR_CD                        " & vbNewLine _
                                              & ",UNSO_NO_L                        " & vbNewLine _
                                              & ",UNSO_NO_M                        " & vbNewLine _
                                              & ",CUST_CD_L                        " & vbNewLine _
                                              & ",CUST_CD_M                        " & vbNewLine _
                                              & ",CUST_CD_S                        " & vbNewLine _
                                              & ",CUST_CD_SS                       " & vbNewLine _
                                              & ",SHIHARAI_GROUP_NO                " & vbNewLine _
                                              & ",SHIHARAI_GROUP_NO_M              " & vbNewLine _
                                              & ",SHIHARAITO_CD                    " & vbNewLine _
                                              & ",UNTIN_CALCULATION_KB             " & vbNewLine _
                                              & ",SHIHARAI_SYARYO_KB               " & vbNewLine _
                                              & ",SHIHARAI_PKG_UT                  " & vbNewLine _
                                              & ",SHIHARAI_NG_NB                   " & vbNewLine _
                                              & ",SHIHARAI_DANGER_KB               " & vbNewLine _
                                              & ",SHIHARAI_TARIFF_BUNRUI_KB        " & vbNewLine _
                                              & ",SHIHARAI_TARIFF_CD               " & vbNewLine _
                                              & ",SHIHARAI_ETARIFF_CD              " & vbNewLine _
                                              & ",SHIHARAI_KYORI                   " & vbNewLine _
                                              & ",SHIHARAI_WT                      " & vbNewLine _
                                              & ",SHIHARAI_UNCHIN                  " & vbNewLine _
                                              & ",SHIHARAI_CITY_EXTC               " & vbNewLine _
                                              & ",SHIHARAI_WINT_EXTC               " & vbNewLine _
                                              & ",SHIHARAI_RELY_EXTC               " & vbNewLine _
                                              & ",SHIHARAI_TOLL                    " & vbNewLine _
                                              & ",SHIHARAI_INSU                    " & vbNewLine _
                                              & ",SHIHARAI_FIXED_FLAG              " & vbNewLine _
                                              & ",DECI_NG_NB                       " & vbNewLine _
                                              & ",DECI_KYORI                       " & vbNewLine _
                                              & ",DECI_WT                          " & vbNewLine _
                                              & ",DECI_UNCHIN                      " & vbNewLine _
                                              & ",DECI_CITY_EXTC                   " & vbNewLine _
                                              & ",DECI_WINT_EXTC                   " & vbNewLine _
                                              & ",DECI_RELY_EXTC                   " & vbNewLine _
                                              & ",DECI_TOLL                        " & vbNewLine _
                                              & ",DECI_INSU                        " & vbNewLine _
                                              & ",KANRI_UNCHIN                     " & vbNewLine _
                                              & ",KANRI_CITY_EXTC                  " & vbNewLine _
                                              & ",KANRI_WINT_EXTC                  " & vbNewLine _
                                              & ",KANRI_RELY_EXTC                  " & vbNewLine _
                                              & ",KANRI_TOLL                       " & vbNewLine _
                                              & ",KANRI_INSU                       " & vbNewLine _
                                              & ",REMARK                           " & vbNewLine _
                                              & ",SIZE_KB                          " & vbNewLine _
                                              & ",TAX_KB                           " & vbNewLine _
                                              & ",SAGYO_KANRI                      " & vbNewLine _
                                              & ",SYS_ENT_DATE                     " & vbNewLine _
                                              & ",SYS_ENT_TIME                     " & vbNewLine _
                                              & ",SYS_ENT_PGID                     " & vbNewLine _
                                              & ",SYS_ENT_USER                     " & vbNewLine _
                                              & ",SYS_UPD_DATE                     " & vbNewLine _
                                              & ",SYS_UPD_TIME                     " & vbNewLine _
                                              & ",SYS_UPD_PGID                     " & vbNewLine _
                                              & ",SYS_UPD_USER                     " & vbNewLine _
                                              & ",SYS_DEL_FLG                      " & vbNewLine _
                                              & " )VALUES(                         " & vbNewLine _
                                              & " @YUSO_BR_CD                      " & vbNewLine _
                                              & ",@NRS_BR_CD                       " & vbNewLine _
                                              & ",@UNSO_NO_L                       " & vbNewLine _
                                              & ",@UNSO_NO_M                       " & vbNewLine _
                                              & ",@CUST_CD_L                       " & vbNewLine _
                                              & ",@CUST_CD_M                       " & vbNewLine _
                                              & ",@CUST_CD_S                       " & vbNewLine _
                                              & ",@CUST_CD_SS                      " & vbNewLine _
                                              & ",@SHIHARAI_GROUP_NO               " & vbNewLine _
                                              & ",@SHIHARAI_GROUP_NO_M             " & vbNewLine _
                                              & ",@SHIHARAITO_CD                   " & vbNewLine _
                                              & ",@UNTIN_CALCULATION_KB            " & vbNewLine _
                                              & ",@SHIHARAI_SYARYO_KB              " & vbNewLine _
                                              & ",@SHIHARAI_PKG_UT                 " & vbNewLine _
                                              & ",@SHIHARAI_NG_NB                  " & vbNewLine _
                                              & ",@SHIHARAI_DANGER_KB              " & vbNewLine _
                                              & ",@SHIHARAI_TARIFF_BUNRUI_KB       " & vbNewLine _
                                              & ",@SHIHARAI_TARIFF_CD              " & vbNewLine _
                                              & ",@SHIHARAI_ETARIFF_CD             " & vbNewLine _
                                              & ",@SHIHARAI_KYORI                  " & vbNewLine _
                                              & ",@SHIHARAI_WT                     " & vbNewLine _
                                              & ",@SHIHARAI_UNCHIN                 " & vbNewLine _
                                              & ",@SHIHARAI_CITY_EXTC              " & vbNewLine _
                                              & ",@SHIHARAI_WINT_EXTC              " & vbNewLine _
                                              & ",@SHIHARAI_RELY_EXTC              " & vbNewLine _
                                              & ",@SHIHARAI_TOLL                   " & vbNewLine _
                                              & ",@SHIHARAI_INSU                   " & vbNewLine _
                                              & ",@SHIHARAI_FIXED_FLAG             " & vbNewLine _
                                              & ",@DECI_NG_NB                      " & vbNewLine _
                                              & ",@DECI_KYORI                      " & vbNewLine _
                                              & ",@DECI_WT                         " & vbNewLine _
                                              & ",@DECI_UNCHIN                     " & vbNewLine _
                                              & ",@DECI_CITY_EXTC                  " & vbNewLine _
                                              & ",@DECI_WINT_EXTC                  " & vbNewLine _
                                              & ",@DECI_RELY_EXTC                  " & vbNewLine _
                                              & ",@DECI_TOLL                       " & vbNewLine _
                                              & ",@DECI_INSU                       " & vbNewLine _
                                              & ",@KANRI_UNCHIN                    " & vbNewLine _
                                              & ",@KANRI_CITY_EXTC                 " & vbNewLine _
                                              & ",@KANRI_WINT_EXTC                 " & vbNewLine _
                                              & ",@KANRI_RELY_EXTC                 " & vbNewLine _
                                              & ",@KANRI_TOLL                      " & vbNewLine _
                                              & ",@KANRI_INSU                      " & vbNewLine _
                                              & ",@REMARK                          " & vbNewLine _
                                              & ",@SIZE_KB                         " & vbNewLine _
                                              & ",@TAX_KB                          " & vbNewLine _
                                              & ",@SAGYO_KANRI                     " & vbNewLine _
                                              & ",@SYS_ENT_DATE                    " & vbNewLine _
                                              & ",@SYS_ENT_TIME                    " & vbNewLine _
                                              & ",@SYS_ENT_PGID                    " & vbNewLine _
                                              & ",@SYS_ENT_USER                    " & vbNewLine _
                                              & ",@SYS_UPD_DATE                    " & vbNewLine _
                                              & ",@SYS_UPD_TIME                    " & vbNewLine _
                                              & ",@SYS_UPD_PGID                    " & vbNewLine _
                                              & ",@SYS_UPD_USER                    " & vbNewLine _
                                              & ",@SYS_DEL_FLG                     " & vbNewLine _
                                              & ")                                 " & vbNewLine
    'END YANAI 要望番号1286 入荷・出荷画面の機能追加（出荷データ作成）

#End Region

#Region "運送会社変更"

    ''' <summary>
    ''' 出荷Lテーブル更新
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_UPDATE_IKKATU_OUTKAL As String = "UPDATE $LM_TRN$..C_OUTKA_L SET     " & vbNewLine _
                                                     & "    SYS_UPD_DATE = @SYS_UPD_DATE   " & vbNewLine _
                                                     & "   ,SYS_UPD_TIME = @SYS_UPD_TIME   " & vbNewLine _
                                                     & "   ,SYS_UPD_PGID = @SYS_UPD_PGID   " & vbNewLine _
                                                     & "   ,SYS_UPD_USER = @SYS_UPD_USER   " & vbNewLine _
                                                     & "WHERE                              " & vbNewLine _
                                                     & "    NRS_BR_CD    = @NRS_BR_CD      " & vbNewLine _
                                                     & "AND OUTKA_NO_L   = @OUTKA_NO_L     " & vbNewLine _
                                                     & "AND SYS_UPD_DATE = @HAITA_DATE     " & vbNewLine _
                                                     & "AND SYS_UPD_TIME = @HAITA_TIME     " & vbNewLine

    ''' <summary>
    ''' 運送Lテーブル更新
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_UPDATE_IKKATU_UNSOL As String = "UPDATE $LM_TRN$..F_UNSO_L SET     " & vbNewLine _
                                                    & "    UNSO_CD      = @UNSOCO_CD     " & vbNewLine _
                                                    & "   ,UNSO_BR_CD   = @UNSOCO_BR_CD  " & vbNewLine _
                                                    & "   ,SYS_UPD_DATE = @SYS_UPD_DATE  " & vbNewLine _
                                                    & "   ,SYS_UPD_TIME = @SYS_UPD_TIME  " & vbNewLine _
                                                    & "   ,SYS_UPD_PGID = @SYS_UPD_PGID  " & vbNewLine _
                                                    & "   ,SYS_UPD_USER = @SYS_UPD_USER  " & vbNewLine _
                                                    & "--'要望番号1369:(支払-運送会社変更時、タリフを再取得し、再計算をおこなう⇒運行が紐付いている場合には、運行の運送会社変更時のみ動作) 2012/08/24 本明 Start " & vbNewLine _
                                                    & "   ,SHIHARAI_TARIFF_CD = @SHIHARAI_TARIFF_CD  " & vbNewLine _
                                                    & "   ,SHIHARAI_ETARIFF_CD = @SHIHARAI_ETARIFF_CD  " & vbNewLine _
                                                    & "--'要望番号1369:(支払-運送会社変更時、タリフを再取得し、再計算をおこなう⇒運行が紐付いている場合には、運行の運送会社変更時のみ動作) 2012/08/24 本明 End   " & vbNewLine _
                                                    & "   ,AUTO_DENP_KBN = @AUTO_DENP_KBN " & vbNewLine _
                                                    & "   ,AUTO_DENP_NO  = @AUTO_DENP_NO  " & vbNewLine _
                                                    & "WHERE                             " & vbNewLine _
                                                    & "    NRS_BR_CD    = @NRS_BR_CD     " & vbNewLine _
                                                    & "AND UNSO_NO_L    = @UNSO_NO_L     " & vbNewLine _
                                                    & "AND SYS_UPD_DATE = @HAITA_DATE    " & vbNewLine _
                                                    & "AND SYS_UPD_TIME = @HAITA_TIME    " & vbNewLine
    ''' <summary>
    ''' 運送Lテーブル更新(運送会社が未設定だった場合)
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_UPDATE_IKKATU_UNSOL2 As String = "UPDATE $LM_TRN$..F_UNSO_L SET     " & vbNewLine _
                                                    & "    UNSO_CD      = @UNSOCO_CD     " & vbNewLine _
                                                    & "   ,UNSO_BR_CD   = @UNSOCO_BR_CD  " & vbNewLine _
                                                    & "   ,SYS_UPD_DATE = @SYS_UPD_DATE  " & vbNewLine _
                                                    & "   ,SYS_UPD_TIME = @SYS_UPD_TIME  " & vbNewLine _
                                                    & "   ,SYS_UPD_PGID = @SYS_UPD_PGID  " & vbNewLine _
                                                    & "   ,SYS_UPD_USER = @SYS_UPD_USER  " & vbNewLine _
                                                    & "   ,PC_KB            = @PC_KB             " & vbNewLine _
                                                    & "   ,TARIFF_BUNRUI_KB = @TARIFF_BUNRUI_KB  " & vbNewLine _
                                                    & "   ,TAX_KB           = @TAX_KB            " & vbNewLine _
                                                    & "   ,SEIQ_TARIFF_CD   = @SEIQ_TARIFF_CD    " & vbNewLine _
                                                    & "   ,UNSO_TEHAI_KB    = @UNSO_TEHAI_KB     " & vbNewLine _
                                                    & "WHERE                             " & vbNewLine _
                                                    & "    NRS_BR_CD    = @NRS_BR_CD     " & vbNewLine _
                                                    & "AND UNSO_NO_L    = @UNSO_NO_L     " & vbNewLine _
                                                    & "AND SYS_UPD_DATE = @HAITA_DATE    " & vbNewLine _
                                                    & "AND SYS_UPD_TIME = @HAITA_TIME    " & vbNewLine

#End Region

#Region "印刷"

    'START YANAI 要望番号741
    'Private Const SQL_UPDATE_PRINT As String = "UPDATE $LM_TRN$..C_OUTKA_L SET                    " & vbNewLine _
    '                                         & " OUTKA_STATE_KB    = CASE    WHEN @PRINT_KB = '08'" & vbNewLine _
    '                                         & "                          OR      @PRINT_KB = '07'" & vbNewLine _
    '                                         & "                             THEN @OUTKA_STATE_KB " & vbNewLine _
    '                                         & "                             ELSE OUTKA_STATE_KB  " & vbNewLine _
    '                                         & "                      END                         " & vbNewLine _
    '                                         & ",ALL_PRINT_FLAG    = CASE    WHEN @PRINT_KB = '08'" & vbNewLine _
    '                                         & "                             THEN '01'            " & vbNewLine _
    '                                         & "                             ELSE ALL_PRINT_FLAG  " & vbNewLine _
    '                                         & "                      END                         " & vbNewLine _
    '                                         & ",NIHUDA_FLAG       = CASE    WHEN @PRINT_KB = '08'" & vbNewLine _
    '                                         & "                          OR      @PRINT_KB = '01'" & vbNewLine _
    '                                         & "                             THEN '01'            " & vbNewLine _
    '                                         & "                             ELSE NIHUDA_FLAG     " & vbNewLine _
    '                                         & "                      END                         " & vbNewLine _
    '                                         & ",NHS_FLAG          = CASE    WHEN @PRINT_KB = '08'" & vbNewLine _
    '                                         & "                          OR      @PRINT_KB = '03'" & vbNewLine _
    '                                         & "                             THEN '01'            " & vbNewLine _
    '                                         & "                             ELSE NHS_FLAG        " & vbNewLine _
    '                                         & "                      END                         " & vbNewLine _
    '                                         & ",DENP_FLAG         = CASE    WHEN @PRINT_KB = '08'" & vbNewLine _
    '                                         & "                          OR      @PRINT_KB = '05'" & vbNewLine _
    '                                         & "                          OR      @PRINT_KB = '06'" & vbNewLine _
    '                                         & "                             THEN '01'            " & vbNewLine _
    '                                         & "                             ELSE DENP_FLAG       " & vbNewLine _
    '                                         & "                      END                         " & vbNewLine _
    '                                         & ",COA_FLAG          = CASE    WHEN @PRINT_KB = '08'" & vbNewLine _
    '                                         & "                          OR      @PRINT_KB = '04'" & vbNewLine _
    '                                         & "                             THEN '01'            " & vbNewLine _
    '                                         & "                             ELSE COA_FLAG        " & vbNewLine _
    '                                         & "                      END                         " & vbNewLine _
    '                                         & ",HOKOKU_FLAG       = CASE    WHEN @PRINT_KB = '07'" & vbNewLine _
    '                                         & "                             THEN '01'            " & vbNewLine _
    '                                         & "                             ELSE HOKOKU_FLAG     " & vbNewLine _
    '                                         & "                      END                         " & vbNewLine _
    '                                         & ",LAST_PRINT_DATE   = @SYS_UPD_DATE                " & vbNewLine _
    '                                         & ",LAST_PRINT_TIME   = SUBSTRING(@SYS_UPD_TIME,1,6) " & vbNewLine _
    '                                         & ",HOU_USER          = CASE    WHEN @PRINT_KB = '07'" & vbNewLine _
    '                                         & "                             THEN @SYS_UPD_USER   " & vbNewLine _
    '                                         & "                             ELSE HOU_USER        " & vbNewLine _
    '                                         & "                      END                         " & vbNewLine _
    '                                         & ",SYS_UPD_DATE      = @SYS_UPD_DATE                " & vbNewLine _
    '                                         & ",SYS_UPD_TIME      = @SYS_UPD_TIME                " & vbNewLine _
    '                                         & ",SYS_UPD_PGID      = @SYS_UPD_PGID                " & vbNewLine _
    '                                         & ",SYS_UPD_USER      = @SYS_UPD_USER                " & vbNewLine _
    '                                         & "WHERE NRS_BR_CD    = @NRS_BR_CD                   " & vbNewLine _
    '                                         & "  AND OUTKA_NO_L   = @OUTKA_NO_L                  " & vbNewLine _
    '                                         & "  AND SYS_UPD_DATE = @GUI_SYS_UPD_DATE            " & vbNewLine _
    '                                         & "  AND SYS_UPD_TIME = @GUI_SYS_UPD_TIME            " & vbNewLine
    'START YANAI 要望番号890
    'Private Const SQL_UPDATE_PRINT As String = "UPDATE $LM_TRN$..C_OUTKA_L SET                    " & vbNewLine _
    '                                         & " OUTKA_STATE_KB    = CASE    WHEN @PRINT_KB = '08'" & vbNewLine _
    '                                         & "                          OR      @PRINT_KB = '07'" & vbNewLine _
    '                                         & "                             THEN @OUTKA_STATE_KB " & vbNewLine _
    '                                         & "                             ELSE OUTKA_STATE_KB  " & vbNewLine _
    '                                         & "                      END                         " & vbNewLine _
    '                                         & ",ALL_PRINT_FLAG    = CASE    WHEN @PRINT_KB = '08'" & vbNewLine _
    '                                         & "                             THEN '01'            " & vbNewLine _
    '                                         & "                             ELSE ALL_PRINT_FLAG  " & vbNewLine _
    '                                         & "                      END                         " & vbNewLine _
    '                                         & ",NIHUDA_FLAG       = CASE    WHEN @PRINT_KB = '08'" & vbNewLine _
    '                                         & "                          OR      @PRINT_KB = '01'" & vbNewLine _
    '                                         & "                             THEN '01'            " & vbNewLine _
    '                                         & "                             ELSE NIHUDA_FLAG     " & vbNewLine _
    '                                         & "                      END                         " & vbNewLine _
    '                                         & ",NHS_FLAG          = CASE    WHEN @PRINT_KB = '08'" & vbNewLine _
    '                                         & "                          OR      @PRINT_KB = '03'" & vbNewLine _
    '                                         & "                             THEN '01'            " & vbNewLine _
    '                                         & "                             ELSE NHS_FLAG        " & vbNewLine _
    '                                         & "                      END                         " & vbNewLine _
    '                                         & ",DENP_FLAG         = CASE    WHEN @PRINT_KB = '08'" & vbNewLine _
    '                                         & "                          OR      @PRINT_KB = '05'" & vbNewLine _
    '                                         & "                          OR      @PRINT_KB = '06'" & vbNewLine _
    '                                         & "                             THEN '01'            " & vbNewLine _
    '                                         & "                             ELSE DENP_FLAG       " & vbNewLine _
    '                                         & "                      END                         " & vbNewLine _
    '                                         & ",COA_FLAG          = CASE    WHEN @PRINT_KB = '04'" & vbNewLine _
    '                                         & "                             THEN '01'            " & vbNewLine _
    '                                         & "                             ELSE COA_FLAG        " & vbNewLine _
    '                                         & "                      END                         " & vbNewLine _
    '                                         & ",HOKOKU_FLAG       = CASE    WHEN @PRINT_KB = '07'" & vbNewLine _
    '                                         & "                             THEN '01'            " & vbNewLine _
    '                                         & "                             ELSE HOKOKU_FLAG     " & vbNewLine _
    '                                         & "                      END                         " & vbNewLine _
    '                                         & ",LAST_PRINT_DATE   = @SYS_UPD_DATE                " & vbNewLine _
    '                                         & ",LAST_PRINT_TIME   = SUBSTRING(@SYS_UPD_TIME,1,6) " & vbNewLine _
    '                                         & ",HOU_USER          = CASE    WHEN @PRINT_KB = '07'" & vbNewLine _
    '                                         & "                             THEN @SYS_UPD_USER   " & vbNewLine _
    '                                         & "                             ELSE HOU_USER        " & vbNewLine _
    '                                         & "                      END                         " & vbNewLine _
    '                                         & ",SYS_UPD_DATE      = @SYS_UPD_DATE                " & vbNewLine _
    '                                         & ",SYS_UPD_TIME      = @SYS_UPD_TIME                " & vbNewLine _
    '                                         & ",SYS_UPD_PGID      = @SYS_UPD_PGID                " & vbNewLine _
    '                                         & ",SYS_UPD_USER      = @SYS_UPD_USER                " & vbNewLine _
    '                                         & "WHERE NRS_BR_CD    = @NRS_BR_CD                   " & vbNewLine _
    '                                         & "  AND OUTKA_NO_L   = @OUTKA_NO_L                  " & vbNewLine _
    '                                         & "  AND SYS_UPD_DATE = @GUI_SYS_UPD_DATE            " & vbNewLine _
    '                                         & "  AND SYS_UPD_TIME = @GUI_SYS_UPD_TIME            " & vbNewLine
    'START YANAI 要望番号800
    'Private Const SQL_UPDATE_PRINT As String = "UPDATE $LM_TRN$..C_OUTKA_L SET                    " & vbNewLine _
    '                                         & " OUTKA_STATE_KB    = CASE    WHEN @PRINT_KB = '08'" & vbNewLine _
    '                                         & "                          OR      @PRINT_KB = '07'" & vbNewLine _
    '                                         & "                             THEN @OUTKA_STATE_KB " & vbNewLine _
    '                                         & "                             ELSE OUTKA_STATE_KB  " & vbNewLine _
    '                                         & "                      END                         " & vbNewLine _
    '                                         & ",ALL_PRINT_FLAG    = CASE    WHEN @PRINT_KB = '08'" & vbNewLine _
    '                                         & "                             THEN '01'            " & vbNewLine _
    '                                         & "                             ELSE ALL_PRINT_FLAG  " & vbNewLine _
    '                                         & "                      END                         " & vbNewLine _
    '                                         & ",NIHUDA_FLAG       = CASE    WHEN @PRINT_KB = '08'" & vbNewLine _
    '                                         & "                          OR      @PRINT_KB = '01'" & vbNewLine _
    '                                         & "                             THEN '01'            " & vbNewLine _
    '                                         & "                             ELSE NIHUDA_FLAG     " & vbNewLine _
    '                                         & "                      END                         " & vbNewLine _
    '                                         & ",NHS_FLAG          = CASE    WHEN @PRINT_KB = '08'" & vbNewLine _
    '                                         & "                          OR      @PRINT_KB = '03'" & vbNewLine _
    '                                         & "                             THEN '01'            " & vbNewLine _
    '                                         & "                             ELSE NHS_FLAG        " & vbNewLine _
    '                                         & "                      END                         " & vbNewLine _
    '                                         & ",DENP_FLAG         = CASE    WHEN @PRINT_KB = '08'" & vbNewLine _
    '                                         & "                          OR      @PRINT_KB = '02'" & vbNewLine _
    '                                         & "                          OR      @PRINT_KB = '06'" & vbNewLine _
    '                                         & "                             THEN '01'            " & vbNewLine _
    '                                         & "                             ELSE DENP_FLAG       " & vbNewLine _
    '                                         & "                      END                         " & vbNewLine _
    '                                         & ",COA_FLAG          = CASE    WHEN @PRINT_KB = '04'" & vbNewLine _
    '                                         & "                             THEN '01'            " & vbNewLine _
    '                                         & "                             ELSE COA_FLAG        " & vbNewLine _
    '                                         & "                      END                         " & vbNewLine _
    '                                         & ",HOKOKU_FLAG       = CASE    WHEN @PRINT_KB = '07'" & vbNewLine _
    '                                         & "                             THEN '01'            " & vbNewLine _
    '                                         & "                             ELSE HOKOKU_FLAG     " & vbNewLine _
    '                                         & "                      END                         " & vbNewLine _
    '                                         & ",LAST_PRINT_DATE   = @SYS_UPD_DATE                " & vbNewLine _
    '                                         & ",LAST_PRINT_TIME   = SUBSTRING(@SYS_UPD_TIME,1,6) " & vbNewLine _
    '                                         & ",HOU_USER          = CASE    WHEN @PRINT_KB = '07'" & vbNewLine _
    '                                         & "                             THEN @SYS_UPD_USER   " & vbNewLine _
    '                                         & "                             ELSE HOU_USER        " & vbNewLine _
    '                                         & "                      END                         " & vbNewLine _
    '                                         & ",SYS_UPD_DATE      = @SYS_UPD_DATE                " & vbNewLine _
    '                                         & ",SYS_UPD_TIME      = @SYS_UPD_TIME                " & vbNewLine _
    '                                         & ",SYS_UPD_PGID      = @SYS_UPD_PGID                " & vbNewLine _
    '                                         & ",SYS_UPD_USER      = @SYS_UPD_USER                " & vbNewLine _
    '                                         & "WHERE NRS_BR_CD    = @NRS_BR_CD                   " & vbNewLine _
    '                                         & "  AND OUTKA_NO_L   = @OUTKA_NO_L                  " & vbNewLine _
    '                                         & "  AND SYS_UPD_DATE = @GUI_SYS_UPD_DATE            " & vbNewLine _
    '                                         & "  AND SYS_UPD_TIME = @GUI_SYS_UPD_TIME            " & vbNewLine
    'START YANAI 要望番号497
    'Private Const SQL_UPDATE_PRINT As String = "UPDATE $LM_TRN$..C_OUTKA_L SET                    " & vbNewLine _
    '                                         & " OUTKA_STATE_KB    = CASE    WHEN @PRINT_KB = '08'" & vbNewLine _
    '                                         & "                          OR      @PRINT_KB = '07'" & vbNewLine _
    '                                         & "                             THEN @OUTKA_STATE_KB " & vbNewLine _
    '                                         & "                             ELSE OUTKA_STATE_KB  " & vbNewLine _
    '                                         & "                      END                         " & vbNewLine _
    '                                         & ",ALL_PRINT_FLAG    = CASE    WHEN @PRINT_KB = '08'" & vbNewLine _
    '                                         & "                             THEN '01'            " & vbNewLine _
    '                                         & "                             ELSE ALL_PRINT_FLAG  " & vbNewLine _
    '                                         & "                      END                         " & vbNewLine _
    '                                         & ",NIHUDA_FLAG       = CASE    WHEN (@PRINT_KB = '08' AND @OUTKA_PKG_NB <> '0')" & vbNewLine _
    '                                         & "                          OR      (@PRINT_KB = '01' AND @OUTKA_PKG_NB <> '0')" & vbNewLine _
    '                                         & "                             THEN '01'            " & vbNewLine _
    '                                         & "                             ELSE NIHUDA_FLAG     " & vbNewLine _
    '                                         & "                      END                         " & vbNewLine _
    '                                         & ",NHS_FLAG          = CASE    WHEN @PRINT_KB = '08'" & vbNewLine _
    '                                         & "                          OR      @PRINT_KB = '03'" & vbNewLine _
    '                                         & "                             THEN '01'            " & vbNewLine _
    '                                         & "                             ELSE NHS_FLAG        " & vbNewLine _
    '                                         & "                      END                         " & vbNewLine _
    '                                         & ",DENP_FLAG         = CASE    WHEN @PRINT_KB = '08'" & vbNewLine _
    '                                         & "                          OR      @PRINT_KB = '02'" & vbNewLine _
    '                                         & "                          OR      @PRINT_KB = '06'" & vbNewLine _
    '                                         & "                             THEN '01'            " & vbNewLine _
    '                                         & "                             ELSE DENP_FLAG       " & vbNewLine _
    '                                         & "                      END                         " & vbNewLine _
    '                                         & ",COA_FLAG          = CASE    WHEN @PRINT_KB = '04'" & vbNewLine _
    '                                         & "                             THEN '01'            " & vbNewLine _
    '                                         & "                             ELSE COA_FLAG        " & vbNewLine _
    '                                         & "                      END                         " & vbNewLine _
    '                                         & ",HOKOKU_FLAG       = CASE    WHEN @PRINT_KB = '07'" & vbNewLine _
    '                                         & "                             THEN '01'            " & vbNewLine _
    '                                         & "                             ELSE HOKOKU_FLAG     " & vbNewLine _
    '                                         & "                      END                         " & vbNewLine _
    '                                         & ",LAST_PRINT_DATE   = @SYS_UPD_DATE                " & vbNewLine _
    '                                         & ",LAST_PRINT_TIME   = SUBSTRING(@SYS_UPD_TIME,1,6) " & vbNewLine _
    '                                         & ",HOU_USER          = CASE    WHEN @PRINT_KB = '07'" & vbNewLine _
    '                                         & "                             THEN @SYS_UPD_USER   " & vbNewLine _
    '                                         & "                             ELSE HOU_USER        " & vbNewLine _
    '                                         & "                      END                         " & vbNewLine _
    '                                         & ",SYS_UPD_DATE      = @SYS_UPD_DATE                " & vbNewLine _
    '                                         & ",SYS_UPD_TIME      = @SYS_UPD_TIME                " & vbNewLine _
    '                                         & ",SYS_UPD_PGID      = @SYS_UPD_PGID                " & vbNewLine _
    '                                         & ",SYS_UPD_USER      = @SYS_UPD_USER                " & vbNewLine _
    '                                         & "WHERE NRS_BR_CD    = @NRS_BR_CD                   " & vbNewLine _
    '                                         & "  AND OUTKA_NO_L   = @OUTKA_NO_L                  " & vbNewLine _
    '                                         & "  AND SYS_UPD_DATE = @GUI_SYS_UPD_DATE            " & vbNewLine _
    '                                         & "  AND SYS_UPD_TIME = @GUI_SYS_UPD_TIME            " & vbNewLine
    Private Const SQL_UPDATE_PRINT As String = "UPDATE $LM_TRN$..C_OUTKA_L SET                    " & vbNewLine _
                                         & " OUTKA_STATE_KB    = CASE    WHEN @PRINT_KB = '08'" & vbNewLine _
                                         & "                             THEN @OUTKA_STATE_KB " & vbNewLine _
                                         & "                             ELSE OUTKA_STATE_KB  " & vbNewLine _
                                         & "                      END                         " & vbNewLine _
                                         & ",ALL_PRINT_FLAG    = CASE    WHEN @PRINT_KB = '08'" & vbNewLine _
                                         & "                             THEN '01'            " & vbNewLine _
                                         & "                             ELSE ALL_PRINT_FLAG  " & vbNewLine _
                                         & "                      END                         " & vbNewLine _
                                         & ",NIHUDA_FLAG       = CASE    WHEN (@PRINT_KB = '08' AND @OUTKA_PKG_NB <> '0')" & vbNewLine _
                                         & "                          OR      (@PRINT_KB = '01' AND @OUTKA_PKG_NB <> '0')" & vbNewLine _
                                         & "                          OR      (@PRINT_KB = '11' AND @OUTKA_PKG_NB <> '0')" & vbNewLine _
                                         & "                             THEN '01'            " & vbNewLine _
                                         & "                             ELSE NIHUDA_FLAG     " & vbNewLine _
                                         & "                      END                         " & vbNewLine _
                                         & ",NHS_FLAG          = CASE    WHEN @PRINT_KB = '08'" & vbNewLine _
                                         & "                          OR      @PRINT_KB = '03'" & vbNewLine _
                                         & "                             THEN '01'            " & vbNewLine _
                                         & "                             ELSE NHS_FLAG        " & vbNewLine _
                                         & "                      END                         " & vbNewLine _
                                         & ",DENP_FLAG         = CASE    WHEN @PRINT_KB = '08'" & vbNewLine _
                                         & "                          OR      @PRINT_KB = '02'" & vbNewLine _
                                         & "                          OR      @PRINT_KB = '06'" & vbNewLine _
                                         & "                          OR      @PRINT_KB = '13'" & vbNewLine _
                                         & "                             THEN '01'            " & vbNewLine _
                                         & "                             ELSE DENP_FLAG       " & vbNewLine _
                                         & "                      END                         " & vbNewLine _
                                         & ",COA_FLAG          = CASE    WHEN @PRINT_KB = '04'" & vbNewLine _
                                         & "                             THEN '01'            " & vbNewLine _
                                         & "                             ELSE COA_FLAG        " & vbNewLine _
                                         & "                      END                         " & vbNewLine _
                                         & ",HOKOKU_FLAG       = CASE    WHEN @PRINT_KB = '07'" & vbNewLine _
                                         & "                             THEN '01'            " & vbNewLine _
                                         & "                             ELSE HOKOKU_FLAG     " & vbNewLine _
                                         & "                      END                         " & vbNewLine _
                                         & "--(2012.09.11)要望番号1428 追加START              " & vbNewLine _
                                         & ",MATOME_PICK_FLAG  = CASE    WHEN @PRINT_KB = '05'" & vbNewLine _
                                         & "                             THEN '01'            " & vbNewLine _
                                         & "                             ELSE MATOME_PICK_FLAG     " & vbNewLine _
                                         & "                      END                         " & vbNewLine _
                                         & ",MATOME_PRINT_DATE = CASE    WHEN @PRINT_KB = '05'" & vbNewLine _
                                         & "                             THEN @SYS_UPD_DATE   " & vbNewLine _
                                         & "                             ELSE MATOME_PRINT_DATE " & vbNewLine _
                                         & "                      END                         " & vbNewLine _
                                         & ",MATOME_PRINT_TIME = CASE    WHEN @PRINT_KB = '05'" & vbNewLine _
                                         & "                             THEN SUBSTRING(@SYS_UPD_TIME,1,6)   " & vbNewLine _
                                         & "                             ELSE MATOME_PRINT_TIME " & vbNewLine _
                                         & "                      END                         " & vbNewLine _
                                         & "--(2012.09.11)要望番号1428 追加END                " & vbNewLine _
                                         & ",LAST_PRINT_DATE   = @SYS_UPD_DATE                " & vbNewLine _
                                         & ",LAST_PRINT_TIME   = SUBSTRING(@SYS_UPD_TIME,1,6) " & vbNewLine _
                                         & ",HOU_USER          = CASE    WHEN @PRINT_KB = '07'" & vbNewLine _
                                         & "                             THEN @SYS_UPD_USER   " & vbNewLine _
                                         & "                             ELSE HOU_USER        " & vbNewLine _
                                         & "                      END                         " & vbNewLine _
                                         & ",SYS_UPD_DATE      = @SYS_UPD_DATE                " & vbNewLine _
                                         & ",SYS_UPD_TIME      = @SYS_UPD_TIME                " & vbNewLine _
                                         & ",SYS_UPD_PGID      = @SYS_UPD_PGID                " & vbNewLine _
                                         & ",SYS_UPD_USER      = @SYS_UPD_USER                " & vbNewLine _
                                         & "WHERE NRS_BR_CD    = @NRS_BR_CD                   " & vbNewLine _
                                         & "  AND OUTKA_NO_L   = @OUTKA_NO_L                  " & vbNewLine _
                                         & "  AND SYS_UPD_DATE = @GUI_SYS_UPD_DATE            " & vbNewLine _
                                         & "  AND SYS_UPD_TIME = @GUI_SYS_UPD_TIME            " & vbNewLine
    'END YANAI 要望番号497
    'END YANAI 要望番号800
    'END YANAI 要望番号890
    'END YANAI 要望番号741


#If True Then

    Private Const SQL_UPDATE_PRINT_MEITETU As String = "UPDATE $LM_TRN$..C_OUTKA_L SET        " & vbNewLine _
                                         & "-- NIHUDA_FLAG       = '01'                         " & vbNewLine _
                                         & " NIHUDA_FLAG       = CASE  WHEN @MEITETU_PRINT_FLG <> '3'  " & vbNewLine _
                                         & "                             THEN '01'                     " & vbNewLine _
                                         & "                             ELSE  NIHUDA_FLAG   END       " & vbNewLine _
                                         & "--,DENP_FLAG         = '01'                         " & vbNewLine _
                                         & ",DENP_FLAG         =  CASE  WHEN @MEITETU_PRINT_FLG <> '4' " & vbNewLine _
                                         & "                             THEN '01'                     " & vbNewLine _
                                         & "                             ELSE  DENP_FLAG     END       " & vbNewLine _
                                         & ",LAST_PRINT_DATE   = @SYS_UPD_DATE                " & vbNewLine _
                                         & ",LAST_PRINT_TIME   = SUBSTRING(@SYS_UPD_TIME,1,6) " & vbNewLine _
                                         & ",SYS_UPD_DATE      = @SYS_UPD_DATE                " & vbNewLine _
                                         & ",SYS_UPD_TIME      = @SYS_UPD_TIME                " & vbNewLine _
                                         & ",SYS_UPD_PGID      = @SYS_UPD_PGID                " & vbNewLine _
                                         & ",SYS_UPD_USER      = @SYS_UPD_USER                " & vbNewLine _
                                         & "WHERE NRS_BR_CD    = @NRS_BR_CD                   " & vbNewLine _
                                         & "  AND OUTKA_NO_L   = @OUTKA_NO_L                  " & vbNewLine _
                                         & "  AND SYS_UPD_DATE = @GUI_SYS_UPD_DATE            " & vbNewLine _
                                         & "  AND SYS_UPD_TIME = @GUI_SYS_UPD_TIME            " & vbNewLine



#End If

    Private Const SQL_UPDATE_PRINT_COA As String = "UPDATE $LM_TRN$..C_OUTKA_L SET                    " & vbNewLine _
                                         & "COA_FLAG          = CASE    WHEN @PRINT_KB = '04'" & vbNewLine _
                                         & "                             THEN '01'            " & vbNewLine _
                                         & "                             ELSE COA_FLAG        " & vbNewLine _
                                         & "                      END                         " & vbNewLine _
                                         & ",SYS_UPD_DATE      = @SYS_UPD_DATE                " & vbNewLine _
                                         & ",SYS_UPD_TIME      = @SYS_UPD_TIME                " & vbNewLine _
                                         & ",SYS_UPD_PGID      = @SYS_UPD_PGID                " & vbNewLine _
                                         & ",SYS_UPD_USER      = @SYS_UPD_USER                " & vbNewLine _
                                         & "WHERE NRS_BR_CD    = @NRS_BR_CD                   " & vbNewLine _
                                         & "  AND OUTKA_NO_L   = @OUTKA_NO_L                  " & vbNewLine

    'START YANAI 20120615 まとめ荷札・送状対応(埼玉浮間対応)
    ''' <summary>
    ''' まとめ印刷対象データ抽出用
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_SELECT_PRINTMATOMEDATA As String = " SELECT                                                                      " & vbNewLine _
                                                       & " UNSOL.NRS_BR_CD                              AS NRS_BR_CD                   " & vbNewLine _
                                                       & ",UNSOL.INOUTKA_NO_L                           AS OUTKA_NO_L                  " & vbNewLine _
                                                       & ",@OUTKA_PKG_NB                                AS OUTKA_PKG_NB                " & vbNewLine _
                                                       & ",@OUTKA_STATE_KB                              AS OUTKA_STATE_KB              " & vbNewLine _
                                                       & ",@PRINT_KB                                    AS PRINT_KB                    " & vbNewLine _
                                                       & ",OUTKAL.SYS_UPD_DATE                          AS SYS_UPD_DATE                " & vbNewLine _
                                                       & ",OUTKAL.SYS_UPD_TIME                          AS SYS_UPD_TIME                " & vbNewLine _
                                                       & ",@ROW_NO                                      AS ROW_NO                      " & vbNewLine _
                                                       & " FROM $LM_TRN$..F_UNSO_L UNSOL                                               " & vbNewLine _
                                                       & " LEFT JOIN $LM_TRN$..C_OUTKA_L OUTKAL                                        " & vbNewLine _
                                                       & " ON                                                                          " & vbNewLine _
                                                       & "       OUTKAL.NRS_BR_CD = UNSOL.NRS_BR_CD                                    " & vbNewLine _
                                                       & "   AND OUTKAL.OUTKA_NO_L = UNSOL.INOUTKA_NO_L                                " & vbNewLine _
                                                       & "   AND OUTKAL.SYS_DEL_FLG = '0'                                              " & vbNewLine _
                                                       & " WHERE UNSOL.NRS_BR_CD = @NRS_BR_CD                                          " & vbNewLine _
                                                       & "   AND UNSOL.CUST_CD_L = @CUST_CD_L                                          " & vbNewLine _
                                                       & "   AND UNSOL.CUST_CD_M = @CUST_CD_M                                          " & vbNewLine _
                                                       & "   AND UNSOL.OUTKA_PLAN_DATE = @OUTKA_PLAN_DATE                              " & vbNewLine _
                                                       & "   AND UNSOL.ARR_PLAN_DATE = @ARR_PLAN_DATE                                  " & vbNewLine _
                                                       & "   AND UNSOL.UNSO_CD   = @UNSO_CD                                            " & vbNewLine _
                                                       & "   AND UNSOL.UNSO_BR_CD = @UNSO_BR_CD                                        " & vbNewLine _
                                                       & "   AND UNSOL.DEST_CD   = @DEST_CD                                            " & vbNewLine _
                                                       & "   AND UNSOL.MOTO_DATA_KB = '20'                                             " & vbNewLine _
                                                       & "   AND UNSOL.SYS_DEL_FLG = '0'                                               " & vbNewLine
    'END YANAI 20120615 まとめ荷札・送状対応(埼玉浮間対応)

#If True Then       'ADD 2018/10/17 依頼番号 : 002601   【LMS】日医工_まとめ送状(選択)_送り状番号更新 ＋ オーダー番号最小の個数のみ送り状表示(千葉BC柴田) 

    ''' <summary>
    ''' 纏め送り状（選択）時印刷対象データ抽出用
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_SELECT_PRINTMATOMEDATA_SELECT As String = " SELECT                                                                      " & vbNewLine _
                                                       & " UNSOL.NRS_BR_CD                              AS NRS_BR_CD                   " & vbNewLine _
                                                       & ",UNSOL.INOUTKA_NO_L                           AS OUTKA_NO_L                  " & vbNewLine _
                                                       & ",@OUTKA_PKG_NB                                AS OUTKA_PKG_NB                " & vbNewLine _
                                                       & ",@OUTKA_STATE_KB                              AS OUTKA_STATE_KB              " & vbNewLine _
                                                       & ",@PRINT_KB                                    AS PRINT_KB                    " & vbNewLine _
                                                       & ",OUTKAL.SYS_UPD_DATE                          AS SYS_UPD_DATE                " & vbNewLine _
                                                       & ",OUTKAL.SYS_UPD_TIME                          AS SYS_UPD_TIME                " & vbNewLine _
                                                       & ",@ROW_NO                                      AS ROW_NO                      " & vbNewLine _
                                                       & " FROM $LM_TRN$..F_UNSO_L UNSOL                                               " & vbNewLine _
                                                       & " LEFT JOIN $LM_TRN$..C_OUTKA_L OUTKAL                                        " & vbNewLine _
                                                       & " ON                                                                          " & vbNewLine _
                                                       & "       OUTKAL.NRS_BR_CD = UNSOL.NRS_BR_CD                                    " & vbNewLine _
                                                       & "   AND OUTKAL.OUTKA_NO_L = UNSOL.INOUTKA_NO_L                                " & vbNewLine _
                                                       & "   AND OUTKAL.SYS_DEL_FLG = '0'                                              " & vbNewLine _
                                                       & " WHERE UNSOL.NRS_BR_CD = @NRS_BR_CD                                          " & vbNewLine _
                                                       & "   AND UNSOL.CUST_CD_L = @CUST_CD_L                                          " & vbNewLine _
                                                       & "   AND UNSOL.CUST_CD_M = @CUST_CD_M                                          " & vbNewLine _
                                                       & "   AND UNSOL.OUTKA_PLAN_DATE = @OUTKA_PLAN_DATE                              " & vbNewLine _
                                                       & "   AND UNSOL.ARR_PLAN_DATE = @ARR_PLAN_DATE                                  " & vbNewLine _
                                                       & "   AND UNSOL.UNSO_CD   = @UNSO_CD                                            " & vbNewLine _
                                                       & "   AND UNSOL.UNSO_BR_CD = @UNSO_BR_CD                                        " & vbNewLine _
                                                       & "   AND UNSOL.DEST_CD   = @DEST_CD                                            " & vbNewLine _
                                                       & "   AND UNSOL.MOTO_DATA_KB = '20'                                             " & vbNewLine _
                                                       & "   AND UNSOL.SYS_DEL_FLG = '0'                                               " & vbNewLine

    Private Const SQL_SELECT_PRINTMATOMEDATA_SELECT2 As String = " --選択のみ設定                                                      " & vbNewLine _
                                                   & "   AND UNSOL.INOUTKA_NO_L IN ('C25001735','C25001736','C25001737')                                " & vbNewLine

#End If

    '要望番号1961 20130322 まとめ送状対応(BPC対応) 修正START
    ''' <summary>
    ''' まとめ印刷対象データ抽出用
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_SELECT_PRINTMATOMEDATA_BP As String = " SELECT                                                                      " & vbNewLine _
                                                       & " UNSOL.NRS_BR_CD                              AS NRS_BR_CD                   " & vbNewLine _
                                                       & ",UNSOL.INOUTKA_NO_L                           AS OUTKA_NO_L                  " & vbNewLine _
                                                       & ",@OUTKA_PKG_NB                                AS OUTKA_PKG_NB                " & vbNewLine _
                                                       & ",@OUTKA_STATE_KB                              AS OUTKA_STATE_KB              " & vbNewLine _
                                                       & ",@PRINT_KB                                    AS PRINT_KB                    " & vbNewLine _
                                                       & ",OUTKAL.SYS_UPD_DATE                          AS SYS_UPD_DATE                " & vbNewLine _
                                                       & ",OUTKAL.SYS_UPD_TIME                          AS SYS_UPD_TIME                " & vbNewLine _
                                                       & ",@ROW_NO                                      AS ROW_NO                      " & vbNewLine _
                                                       & " FROM $LM_TRN$..F_UNSO_L UNSOL                                               " & vbNewLine _
                                                       & " LEFT JOIN $LM_TRN$..C_OUTKA_L OUTKAL                                        " & vbNewLine _
                                                       & " ON                                                                          " & vbNewLine _
                                                       & "       OUTKAL.NRS_BR_CD = UNSOL.NRS_BR_CD                                    " & vbNewLine _
                                                       & "   AND OUTKAL.OUTKA_NO_L = UNSOL.INOUTKA_NO_L                                " & vbNewLine _
                                                       & "   AND OUTKAL.SYS_DEL_FLG = '0'                                              " & vbNewLine _
                                                       & " LEFT JOIN $LM_MST$..M_DEST MDEST                                            " & vbNewLine _
                                                       & " ON                                                                          " & vbNewLine _
                                                       & "       MDEST.NRS_BR_CD = OUTKAL.NRS_BR_CD                                    " & vbNewLine _
                                                       & "   AND MDEST.CUST_CD_L = OUTKAL.CUST_CD_L                                    " & vbNewLine _
                                                       & "   AND MDEST.DEST_CD = OUTKAL.DEST_CD                                        " & vbNewLine _
                                                       & "   AND MDEST.SYS_DEL_FLG = '0'                                               " & vbNewLine _
                                                       & " WHERE UNSOL.NRS_BR_CD = @NRS_BR_CD                                          " & vbNewLine _
                                                       & "   AND UNSOL.CUST_CD_L = @CUST_CD_L                                          " & vbNewLine _
                                                       & "   AND UNSOL.CUST_CD_M = @CUST_CD_M                                          " & vbNewLine _
                                                       & "   AND UNSOL.OUTKA_PLAN_DATE = @OUTKA_PLAN_DATE                              " & vbNewLine _
                                                       & "   AND UNSOL.ARR_PLAN_DATE = @ARR_PLAN_DATE                                  " & vbNewLine _
                                                       & "   AND UNSOL.UNSO_CD   = @UNSO_CD                                            " & vbNewLine _
                                                       & "   AND UNSOL.UNSO_BR_CD = @UNSO_BR_CD                                        " & vbNewLine _
                                                       & "   AND MDEST.CUST_DEST_CD = @CUST_DEST_CD                                    " & vbNewLine _
                                                       & "   AND UNSOL.MOTO_DATA_KB = '20'                                             " & vbNewLine _
                                                       & "   AND UNSOL.SYS_DEL_FLG = '0'                                               " & vbNewLine
    '要望番号1961 20130322 まとめ送状対応(BPC対応) 修正END

    'ADD 2016/08/29　まとめ送状対応　要望番号:2615 Start
    ''' <summary>
    ''' 運送Lより、最小のAUTO_DENP_NO取得
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_SELECT_MATOME_UNSO_AUTO_DENP_NO_DATA As String = " SELECT                                            " & vbNewLine _
                                                       & "  UNSOL.NRS_BR_CD                              AS NRS_BR_CD      " & vbNewLine _
                                                       & " ,MIN(UNSOL.AUTO_DENP_NO)                      AS AUTO_DENP_NO   " & vbNewLine _
                                                       & " FROM $LM_TRN$..F_UNSO_L UNSOL                                   " & vbNewLine _
                                                       & " WHERE UNSOL.NRS_BR_CD = @NRS_BR_CD                              " & vbNewLine _
                                                       & "   AND UNSOL.AUTO_DENP_NO > ''                                   " & vbNewLine

    Private Const SQL_SELECT_MATOME_UNSO_AUTO_DENP_NO_DATA2 As String = " AND INOUTKA_NO_L IN ("

    Private Const SQL_SELECT_MATOME_UNSO_AUTO_DENP_NO_GROUP As String = " GROUP BY  UNSOL.NRS_BR_CD                        " & vbNewLine
    ''' <summary>
    ''' 運送Lに、最小のAUTO_DENP_NO設定
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_UNSOL_UPDATE_MATOME As String = "UPDATE $LM_TRN$..F_UNSO_L SET                             " & vbNewLine _
                                              & "  AUTO_DENP_NO         = @AUTO_DENP_NO     " & vbNewLine _
                                              & " ,SYS_UPD_DATE         = @SYS_UPD_DATE     " & vbNewLine _
                                              & " ,SYS_UPD_TIME         = @SYS_UPD_TIME     " & vbNewLine _
                                              & " ,SYS_UPD_PGID         = @SYS_UPD_PGID     " & vbNewLine _
                                              & " ,SYS_UPD_USER         = @SYS_UPD_USER     " & vbNewLine _
                                              & " WHERE                                     " & vbNewLine _
                                              & "       NRS_BR_CD        = @NRS_BR_CD       " & vbNewLine

    Private Const SQL_UNSOL_UPDATE_MATOM2E As String = "  AND INOUTKA_NO_L IN ("

    'ADD 2016/08/29　まとめ送状対応　要望番号:2615 End

#End Region

#Region "出荷報告Excel作成時の進捗区分更新処理"
    'START YANAI 要望番号773　報告書Excel対応
    Private Const SQL_UPDATE_HOUKOKU_EXCEL As String = "UPDATE $LM_TRN$..C_OUTKA_L SET            " & vbNewLine _
                                             & " OUTKA_STATE_KB    = '90'                         " & vbNewLine _
                                             & ",HOKOKU_FLAG       = '01'                         " & vbNewLine _
                                             & ",SYS_UPD_DATE      = @SYS_UPD_DATE                " & vbNewLine _
                                             & ",SYS_UPD_TIME      = @SYS_UPD_TIME                " & vbNewLine _
                                             & ",SYS_UPD_PGID      = @SYS_UPD_PGID                " & vbNewLine _
                                             & ",SYS_UPD_USER      = @SYS_UPD_USER                " & vbNewLine _
                                             & "WHERE NRS_BR_CD    = @NRS_BR_CD                   " & vbNewLine _
                                             & "  AND OUTKA_NO_L   = @OUTKA_NO_L                  " & vbNewLine
    'END YANAI 要望番号773　報告書Excel対応
#End Region

#Region "送状番号更新処理"
    'ADD 2016/06/21 要望番号:2580
    Private Const SQL_UPDATE_DENP_NO As String = "UPDATE $LM_TRN$..C_OUTKA_L SET            " & vbNewLine _
                                             & " DENP_NO           = @DENP_NO                     " & vbNewLine _
                                             & ",DENP_FLAG         = '01'                         " & vbNewLine _
                                             & "-- ヤマトは更新しない  @OUTKA_PKG_NB = 999 で対応 " & vbNewLine _
                                             & ",OUTKA_PKG_NB      = CASE WHEN @OUTKA_PKG_NB = 999 THEN   OUTKA_PKG_NB       " & vbNewLine _
                                             & "                                                   ELSE   @OUTKA_PKG_NB END  " & vbNewLine _
                                             & ",SYS_UPD_DATE      = @SYS_UPD_DATE                " & vbNewLine _
                                             & ",SYS_UPD_TIME      = @SYS_UPD_TIME                " & vbNewLine _
                                             & ",SYS_UPD_PGID      = @SYS_UPD_PGID                " & vbNewLine _
                                             & ",SYS_UPD_USER      = @SYS_UPD_USER                " & vbNewLine _
                                             & "WHERE NRS_BR_CD    = @NRS_BR_CD                   " & vbNewLine _
                                             & "  AND OUTKA_NO_L   = @OUTKA_NO_L                  " & vbNewLine

#End Region
#Region "特別梱包個数計算 SQL"

    'START YANAI 20120322 特別梱包個数計算
    ''' <summary>
    ''' 特別梱包個数計算データ抽出用 SELECT句
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_SELECT_OUTKAPKGNB As String = " SELECT                                                                    " & vbNewLine _
                                                & " OUTKAL.NRS_BR_CD                                    AS NRS_BR_CD            " & vbNewLine _
                                                & ",OUTKAL.OUTKA_NO_L                                   AS OUTKA_NO_L           " & vbNewLine _
                                                & ",OUTKAM.OUTKA_NO_M                                   AS OUTKA_NO_M	        " & vbNewLine _
                                                & ",OUTKAM.GOODS_CD_NRS                                 AS GOODS_CD_NRS   	    " & vbNewLine _
                                                & ",OUTKAM.OUTKA_TTL_NB                                 AS OUTKA_TTL_NB   	    " & vbNewLine _
                                                & ",OUTKAM.OUTKA_HASU                                   AS OUTKA_HASU     	    " & vbNewLine _
                                                & ",GOODS.PKG_NB                                        AS PKG_NB        	    " & vbNewLine

    ''' <summary>
    ''' 特別梱包個数計算データ抽出用 FROM句
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_SELECT_FROM_OUTKAPKGNB As String = "FROM                                            " & vbNewLine _
                                        & "$LM_TRN$..C_OUTKA_L OUTKAL                                     " & vbNewLine _
                                        & "LEFT JOIN                                                      " & vbNewLine _
                                        & "$LM_TRN$..C_OUTKA_M OUTKAM                                     " & vbNewLine _
                                        & "ON                                                             " & vbNewLine _
                                        & "OUTKAM.NRS_BR_CD = OUTKAL.NRS_BR_CD                            " & vbNewLine _
                                        & "AND                                                            " & vbNewLine _
                                        & "OUTKAM.OUTKA_NO_L = OUTKAL.OUTKA_NO_L                          " & vbNewLine _
                                        & "AND                                                            " & vbNewLine _
                                        & "OUTKAM.SYS_DEL_FLG = '0'                                       " & vbNewLine _
                                        & "LEFT JOIN                                                      " & vbNewLine _
                                        & "$LM_MST$..M_GOODS GOODS                                        " & vbNewLine _
                                        & "ON                                                             " & vbNewLine _
                                        & "OUTKAM.NRS_BR_CD =GOODS.NRS_BR_CD                              " & vbNewLine _
                                        & "AND                                                            " & vbNewLine _
                                        & "OUTKAM.GOODS_CD_NRS = GOODS.GOODS_CD_NRS                       " & vbNewLine

    ''' <summary>
    ''' 特別梱包個数計算データ抽出用 WHERE句
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_SELECT_WHERE_OUTKAPKGNB As String = "WHERE                                          " & vbNewLine _
                                        & "OUTKAL.NRS_BR_CD = @NRS_BR_CD                                  " & vbNewLine _
                                        & "AND                                                            " & vbNewLine _
                                        & "OUTKAL.OUTKA_NO_L = @OUTKA_NO_L                                " & vbNewLine _
                                        & "AND                                                            " & vbNewLine _
                                        & "OUTKAL.SYS_DEL_FLG = '0'                                       " & vbNewLine

    ''' <summary>
    ''' 出荷(大) UPDATE用
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_UPDATE_OUTKAL_OUTKAPKGNB As String = "UPDATE $LM_TRN$..C_OUTKA_L SET                " & vbNewLine _
                                              & "           OUTKA_PKG_NB = @OUTKA_PKG_NB                  " & vbNewLine _
                                              & "          ,SYS_UPD_DATE = @SYS_UPD_DATE                  " & vbNewLine _
                                              & "          ,SYS_UPD_TIME = @SYS_UPD_TIME                  " & vbNewLine _
                                              & "          ,SYS_UPD_PGID = @SYS_UPD_PGID                  " & vbNewLine _
                                              & "          ,SYS_UPD_USER = @SYS_UPD_USER                  " & vbNewLine _
                                              & "           WHERE                                         " & vbNewLine _
                                              & "           NRS_BR_CD = @NRS_BR_CD                        " & vbNewLine _
                                              & "           AND OUTKA_NO_L = @OUTKA_NO_L                  " & vbNewLine _
                                              & "           AND SYS_UPD_DATE = @GUI_UPD_DATE              " & vbNewLine _
                                              & "           AND SYS_UPD_TIME = @GUI_UPD_TIME              " & vbNewLine

    ''' <summary>
    ''' 運送(大) UPDATE用
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_UPDATE_UNSOL_OUTKAPKGNB As String = "UPDATE $LM_TRN$..F_UNSO_L SET                  " & vbNewLine _
                                              & "           UNSO_PKG_NB = @OUTKA_PKG_NB                   " & vbNewLine _
                                              & "          ,SYS_UPD_DATE = @SYS_UPD_DATE                  " & vbNewLine _
                                              & "          ,SYS_UPD_TIME = @SYS_UPD_TIME                  " & vbNewLine _
                                              & "          ,SYS_UPD_PGID = @SYS_UPD_PGID                  " & vbNewLine _
                                              & "          ,SYS_UPD_USER = @SYS_UPD_USER                  " & vbNewLine _
                                              & "           WHERE                                         " & vbNewLine _
                                              & "           NRS_BR_CD = @NRS_BR_CD                        " & vbNewLine _
                                              & "           AND INOUTKA_NO_L = @OUTKA_NO_L                " & vbNewLine _
                                              & "           AND MOTO_DATA_KB = '20'                       " & vbNewLine

    'END YANAI 20120322 特別梱包個数計算


    '要望番号:2408 2015.09.17 修正START
    '要望番号1369:(支払-運送会社変更時、タリフを再取得し、再計算をおこなう⇒運行が紐付いている場合には、運行の運送会社変更時のみ動作) 2012/08/24 本明 Start
    ''' <summary>
    ''' 運送会社コードの支払タリフ、支払割増タリフを取得
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_GetTariffCdFromUnsoCd As String = " SELECT                                                    " & vbNewLine _
                                                & "     UNSOCO.UNCHIN_TARIFF_CD         AS SHIHARAI_TARIFF_CD       " & vbNewLine _
                                                & "    ,UNSOCO.EXTC_TARIFF_CD           AS SHIHARAI_ETARIFF_CD      " & vbNewLine _
                                                & "    ,CASE WHEN UNSOCO.AUTO_DENP_NO_KBN IS NULL THEN ''           " & vbNewLine _
                                                & "       WHEN UNSOCO.AUTO_DENP_NO_FLG = '1' THEN UNSOCO.AUTO_DENP_NO_KBN " & vbNewLine _
                                                & "       ELSE ''                       END AUTO_DENP_KBN           " & vbNewLine _
                                                & " FROM                                                            " & vbNewLine _
                                                & "     $LM_MST$..M_UNSOCO UNSOCO                                   " & vbNewLine _
                                                & " WHERE                                                           " & vbNewLine _
                                                & "     NRS_BR_CD       = @NRS_BR_CD                                " & vbNewLine _
                                                & " AND UNSOCO_CD       = @UNSOCO_CD                                " & vbNewLine _
                                                & " AND UNSOCO_BR_CD    = @UNSOCO_BR_CD                             " & vbNewLine
    '要望番号1369:(支払-運送会社変更時、タリフを再取得し、再計算をおこなう⇒運行が紐付いている場合には、運行の運送会社変更時のみ動作) 2012/08/24 本明 End
    '要望番号:2408 2015.09.17 修正END



#End Region

#Region "UNCHIN"
    'START YANAI 20120322 特別梱包個数計算
    ''' <summary>
    ''' SELECT
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_SELECT_UNCHIN As String = " SELECT                                               " & vbNewLine _
                                              & " UNCHIN.SEIQTO_CD             AS SEIQTO_CD            " & vbNewLine _
                                              & ",UNCHIN.UNTIN_CALCULATION_KB  AS UNTIN_CALCULATION_KB " & vbNewLine _
                                              & ",UNCHIN.SEIQ_TARIFF_BUNRUI_KB AS SEIQ_TARIFF_BUNRUI_KB" & vbNewLine _
                                              & ",UNSOL.TARIFF_BUNRUI_KB AS TARIFF_BUNRUI_KB           " & vbNewLine _
                                              & " FROM $LM_TRN$..F_UNSO_L UNSOL                        " & vbNewLine _
                                              & " LEFT JOIN                                            " & vbNewLine _
                                              & " $LM_TRN$..F_UNCHIN_TRS UNCHIN                        " & vbNewLine _
                                              & " ON                                                   " & vbNewLine _
                                              & " UNCHIN.NRS_BR_CD = UNSOL.NRS_BR_CD AND               " & vbNewLine _
                                              & " UNCHIN.UNSO_NO_L = UNSOL.UNSO_NO_L AND               " & vbNewLine _
                                              & " UNCHIN.SYS_DEL_FLG = '0'                             " & vbNewLine _
                                              & " WHERE                                                " & vbNewLine _
                                              & " UNSOL.NRS_BR_CD = @NRS_BR_CD AND                     " & vbNewLine _
                                              & " UNSOL.INOUTKA_NO_L = @OUTKA_NO_L AND                 " & vbNewLine _
                                              & " UNSOL.SYS_DEL_FLG = '0'                              " & vbNewLine

    'END YANAI 20120322 特別梱包個数計算
#End Region

#Region "Delete"

#Region "UNCHIN"
    'START YANAI 要望番号638

    Private Const SQL_DELETE_UNCHIN As String = "DELETE FROM $LM_TRN$..F_UNCHIN_TRS " & vbNewLine _
                                              & "WHERE   NRS_BR_CD   = @NRS_BR_CD   " & vbNewLine _
                                              & "  AND   UNSO_NO_L   = @UNSO_NO_L   " & vbNewLine
    'END YANAI 要望番号638

    'START YANAI 要望番号1302 支払運賃に伴う修正。バッチ呼び出し、画面項目追加等
    Private Const SQL_DELETE_SHIHARAI As String = "DELETE FROM $LM_TRN$..F_SHIHARAI_TRS " & vbNewLine _
                                                & "WHERE   NRS_BR_CD   = @NRS_BR_CD     " & vbNewLine _
                                                & "  AND   UNSO_NO_L   = @UNSO_NO_L     " & vbNewLine
    'END YANAI 要望番号1302 支払運賃に伴う修正。バッチ呼び出し、画面項目追加等

#End Region

#End Region

    '社内入荷データ作成対応 terakawa 2012.11.19 Start
#Region "社内入荷データ作成"

    ''' <summary>
    ''' 社内EDI入荷データ作成用データの検索 SQL
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_SELECT_INKAMAKE_BASE_START As String = " SELECT                        " & vbNewLine _
                              & "BASE.OUTKA_NO_L            AS OUTKA_NO_L         " & vbNewLine _
                              & ",BASE.TO_NRS_BR_CD           AS TO_NRS_BR_CD      " & vbNewLine _
                              & ",BASE.OUTKA_PLAN_DATE       AS OUTKA_PLAN_DATE    " & vbNewLine _
                              & ",BASE.TO_NRS_WH_CD           AS TO_NRS_WH_CD      " & vbNewLine _
                              & ",BASE.TO_CUST_L              AS TO_CUST_L         " & vbNewLine _
                              & ",BASE.TO_CUST_M              AS TO_CUST_M         " & vbNewLine _
                              & ",BASE.OUTKA_PKG_NB          AS OUTKA_PKG_NB       " & vbNewLine _
                              & ",BASE.BUYER_ORD_NO          AS BUYER_ORD_NO       " & vbNewLine _
                              & ",BASE.CUST_ORD_NO           AS CUST_ORD_NO        " & vbNewLine _
                              & ",BASE.HOKAN_FREE_KIKAN      AS HOKAN_FREE_KIKAN   " & vbNewLine _
                              & ",BASE.REMARK                AS REMARK             " & vbNewLine _
                              & ",BASE.OUTKA_NO_M            AS OUTKA_NO_M         " & vbNewLine _
                              & ",BASE.GOODS_CD_NRS          AS GOODS_CD_NRS       " & vbNewLine _
                              & ",BASE.CUST_ORD_NO_DTL       AS CUST_ORD_NO_DTL    " & vbNewLine _
                              & ",BASE.BUYER_ORD_NO_DTL      AS BUYER_ORD_NO_DTL   " & vbNewLine _
                              & ",BASE.REMARK                AS REMARK_M           " & vbNewLine _
                              & ",BASE.LOT_NO                AS LOT_NO             " & vbNewLine _
                              & ",BASE.PKG_NB               AS PKG_NB              " & vbNewLine _
                              & ",BASE.ALCTD_NB              AS ALCTD_NB           " & vbNewLine _
                              & ",BASE.STD_IRIME_NB         AS STD_IRIME_NB        " & vbNewLine _
                              & ",BASE.BETU_WT               AS BETU_WT            " & vbNewLine _
                              & ",BASE.SERIAL_NO             AS SERIAL_NO          " & vbNewLine _
                              & ",BASE.REMARK_S              AS REMARK_S           " & vbNewLine _
                              & ",BASE.TOU_NO                AS TOU_NO             " & vbNewLine _
                              & ",BASE.SITU_NO                AS SITU_NO           " & vbNewLine _
                              & ",BASE.ZONE_CD                AS ZONE_CD           " & vbNewLine _
                              & ",BASE.LOCA                AS LOCA                 " & vbNewLine _
                              & ",BASE.WH_TAB_YN             AS WH_TAB_YN          " & vbNewLine _
                              & "FROM                                              " & vbNewLine _
                              & "(                                                 " & vbNewLine





    ''' <summary>
    ''' 社内EDI入荷データ作成用データの検索 SQL
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_SELECT_INKAMAKEDATA As String = " SELECT                        " & vbNewLine _
                              & " OUTL.OUTKA_NO_L            AS OUTKA_NO_L            " & vbNewLine _
                              & ",INT.TO_NRS_BR_CD           AS TO_NRS_BR_CD          " & vbNewLine _
                              & ",OUTL.OUTKA_PLAN_DATE       AS OUTKA_PLAN_DATE       " & vbNewLine _
                              & ",INT.TO_NRS_WH_CD           AS TO_NRS_WH_CD          " & vbNewLine _
                              & ",INT.TO_CUST_L              AS TO_CUST_L             " & vbNewLine _
                              & ",INT.TO_CUST_M              AS TO_CUST_M             " & vbNewLine _
                              & ",OUTL.OUTKA_PKG_NB          AS OUTKA_PKG_NB          " & vbNewLine _
                              & ",OUTL.BUYER_ORD_NO          AS BUYER_ORD_NO          " & vbNewLine _
                              & ",OUTL.CUST_ORD_NO           AS CUST_ORD_NO           " & vbNewLine _
                              & ",CUST.HOKAN_FREE_KIKAN      AS HOKAN_FREE_KIKAN      " & vbNewLine _
                              & ",OUTL.REMARK                AS REMARK                " & vbNewLine _
                              & ",OUTM.OUTKA_NO_M            AS OUTKA_NO_M            " & vbNewLine _
                              & ",ISNULL(GOODS_CUST_NM.GOODS_CD_NRS     ,GOODS_CUST_IRIME.GOODS_CD_NRS) AS GOODS_CD_NRS  " & vbNewLine _
                              & ",OUTM.CUST_ORD_NO_DTL       AS CUST_ORD_NO_DTL       " & vbNewLine _
                              & ",OUTM.BUYER_ORD_NO_DTL      AS BUYER_ORD_NO_DTL      " & vbNewLine _
                              & ",OUTM.REMARK                AS REMARK_M              " & vbNewLine _
                              & ",OUTS.LOT_NO                AS LOT_NO                " & vbNewLine _
                              & ",GOODS.PKG_NB               AS PKG_NB                " & vbNewLine _
                              & ",OUTS.ALCTD_NB              AS ALCTD_NB              " & vbNewLine _
                              & ",GOODS.STD_IRIME_NB         AS STD_IRIME_NB          " & vbNewLine _
                              & ",OUTS.BETU_WT               AS BETU_WT               " & vbNewLine _
                              & ",OUTS.SERIAL_NO             AS SERIAL_NO             " & vbNewLine _
                              & ",OUTS.REMARK                AS REMARK_S              " & vbNewLine _
                              & ",CASE WHEN INT.DEF_TOU_NO = '#' THEN OUTS.TOU_NO     " & vbNewLine _
                              & " ELSE INT.DEF_TOU_NO                                 " & vbNewLine _
                              & " END AS TOU_NO                                       " & vbNewLine _
                              & ",CASE WHEN INT.DEF_SITU_NO = '#' THEN OUTS.SITU_NO   " & vbNewLine _
                              & " ELSE INT.DEF_SITU_NO                                " & vbNewLine _
                              & " END AS SITU_NO                                      " & vbNewLine _
                              & ",CASE WHEN INT.DEF_ZONE_CD = '#' THEN OUTS.ZONE_CD   " & vbNewLine _
                              & " ELSE INT.DEF_ZONE_CD                                " & vbNewLine _
                              & " END AS ZONE_CD                                      " & vbNewLine _
                              & ",CASE WHEN INT.DEF_LOC  = '#' THEN OUTS.LOCA         " & vbNewLine _
                              & " ELSE INT.DEF_LOC                                    " & vbNewLine _
                              & " END AS LOCA                                         " & vbNewLine _
                              & ",CASE WHEN KBN1.VALUE1 = 1.000                       " & vbNewLine _
                              & "      THEN '01'                                      " & vbNewLine _
                              & "      ELSE '00'                                      " & vbNewLine _
                              & " END                         AS WH_TAB_YN            " & vbNewLine _
                              & ",ROW_NUMBER() OVER (partition by OUTL.OUTKA_NO_L,OUTM.OUTKA_NO_M,OUTS.OUTKA_NO_S,GOODS.GOODS_CD_CUST ORDER BY   " & vbNewLine _
                              & " CASE WHEN GOODS_CUST_NM.GOODS_CD_NRS IS NOT NULL THEN '0'                                                      " & vbNewLine _
                              & " ELSE '1' END,ISNULL(DZAI.ALLOC_CAN_NB,0) desc ,ISNULL(DZAI_IRIME.ALLOC_CAN_NB,0) desc ) AS YUSEN                     " & vbNewLine



    ''' <summary>
    ''' 社内EDI入荷データ作成用データの検索 SQL FROM句
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_SELECT_FROM_INKAMAKEDATA As String = " FROM                 " & vbNewLine _
                              & " $LM_TRN$..C_OUTKA_L OUTL                           " & vbNewLine _
                              & "--出荷M                                             " & vbNewLine _
                              & "LEFT JOIN                                           " & vbNewLine _
                              & " $LM_TRN$..C_OUTKA_M OUTM                           " & vbNewLine _
                              & "ON                                                  " & vbNewLine _
                              & "     OUTL.NRS_BR_CD   = OUTM.NRS_BR_CD              " & vbNewLine _
                              & "AND  OUTL.OUTKA_NO_L  = OUTM.OUTKA_NO_L             " & vbNewLine _
                              & "AND  OUTM.SYS_DEL_FLG = '0'                         " & vbNewLine _
                              & "--出荷S                                             " & vbNewLine _
                              & "LEFT JOIN                                           " & vbNewLine _
                              & " $LM_TRN$..C_OUTKA_S OUTS                           " & vbNewLine _
                              & "ON                                                  " & vbNewLine _
                              & "     OUTM.NRS_BR_CD   = OUTS.NRS_BR_CD              " & vbNewLine _
                              & "AND  OUTM.OUTKA_NO_L  = OUTS.OUTKA_NO_L             " & vbNewLine _
                              & "AND  OUTM.OUTKA_NO_M  = OUTS.OUTKA_NO_M             " & vbNewLine _
                              & "AND  OUTS.SYS_DEL_FLG = '0'                         " & vbNewLine _
                              & "--社内入荷設定マスタ                                " & vbNewLine _
                              & "LEFT JOIN                                           " & vbNewLine _
                              & " $LM_MST$..M_INT_EDI INT                            " & vbNewLine _
                              & "ON                                                  " & vbNewLine _
                              & "   INT.INT_EDI_CD  = @INT_EDI_CD                    " & vbNewLine _
                              & "--荷主マスタ                                        " & vbNewLine _
                              & "LEFT JOIN                                           " & vbNewLine _
                              & " $LM_MST$..M_CUST CUST                              " & vbNewLine _
                              & "ON                                                  " & vbNewLine _
                              & "    OUTL.NRS_BR_CD  = CUST.NRS_BR_CD                " & vbNewLine _
                              & "AND OUTL.CUST_CD_L  = CUST.CUST_CD_L                " & vbNewLine _
                              & "AND OUTL.CUST_CD_M  = CUST.CUST_CD_M                " & vbNewLine _
                              & "AND CUST.CUST_CD_S  = '00'                          " & vbNewLine _
                              & "AND CUST.CUST_CD_SS = '00'                          " & vbNewLine _
                              & "--商品マスタ                                        " & vbNewLine _
                              & "LEFT JOIN                                           " & vbNewLine _
                              & " $LM_MST$..M_GOODS GOODS                            " & vbNewLine _
                              & "ON                                                  " & vbNewLine _
                              & "    OUTM.NRS_BR_CD     = GOODS.NRS_BR_CD			 " & vbNewLine _
                              & "AND OUTM.GOODS_CD_NRS  = GOODS.GOODS_CD_NRS		 " & vbNewLine _
                              & "--商品マスタ                                        " & vbNewLine _
                              & "LEFT JOIN                                           " & vbNewLine _
                              & " $LM_MST$..M_GOODS GOODS_CUST_NM                          " & vbNewLine _
                              & "ON                                                        " & vbNewLine _
                              & "    GOODS_CUST_NM.NRS_BR_CD      = INT.TO_NRS_BR_CD	   " & vbNewLine _
                              & "AND GOODS_CUST_NM.CUST_CD_L      = INT.TO_CUST_L		   " & vbNewLine _
                              & "AND GOODS_CUST_NM.CUST_CD_M      = INT.TO_CUST_M          " & vbNewLine _
                              & "AND GOODS_CUST_NM.GOODS_CD_CUST  = GOODS.GOODS_CD_CUST    " & vbNewLine _
                              & "AND GOODS_CUST_NM.STD_IRIME_NB   = GOODS.STD_IRIME_NB     " & vbNewLine _
                              & "AND GOODS_CUST_NM.GOODS_NM_3     = GOODS.GOODS_NM_3       " & vbNewLine _
                              & "AND GOODS_CUST_NM.GOODS_NM_1     = GOODS.GOODS_NM_1       " & vbNewLine _
                              & "AND GOODS_CUST_NM.PKG_UT         = GOODS.PKG_UT           " & vbNewLine _
                              & "AND GOODS_CUST_NM.SYS_DEL_FLG = '0'                       " & vbNewLine _
                              & "LEFT JOIN                                                 " & vbNewLine _
                              & " (SELECT                                                  " & vbNewLine _
                              & "    NRS_BR_CD	                                           " & vbNewLine _
                              & "   ,GOODS_CD_NRS	                                       " & vbNewLine _
                              & "   ,SUM(ALLOC_CAN_NB) 	     AS ALLOC_CAN_NB               " & vbNewLine _
                              & " FROM $LM_TRN$..D_ZAI_TRS                                 " & vbNewLine _
                              & " LEFT JOIN                                                " & vbNewLine _
                              & " $LM_MST$..M_INT_EDI SUB_INT                              " & vbNewLine _
                              & " ON    	                                               " & vbNewLine _
                              & "       NRS_BR_CD	= SUB_INT.TO_NRS_BR_CD                 " & vbNewLine _
                              & " AND   CUST_CD_L	= SUB_INT.TO_CUST_L                    " & vbNewLine _
                              & " AND   CUST_CD_M	= SUB_INT.TO_CUST_M                    " & vbNewLine _
                              & " AND   SUB_INT.INT_EDI_CD	= @INT_EDI_CD                  " & vbNewLine _
                              & "    GROUP BY	                                           " & vbNewLine _
                              & "    NRS_BR_CD	                                           " & vbNewLine _
                              & "   ,GOODS_CD_NRS	                                       " & vbNewLine _
                              & " )DZAI                                                    " & vbNewLine _
                              & "ON  GOODS_CUST_NM.NRS_BR_CD      = DZAI.NRS_BR_CD	       " & vbNewLine _
                              & "AND GOODS_CUST_NM.GOODS_CD_NRS   = DZAI.GOODS_CD_NRS	   " & vbNewLine _
                              & "AND DZAI.ALLOC_CAN_NB > 0                         		   " & vbNewLine _
                              & "LEFT JOIN                                                 " & vbNewLine _
                              & " $LM_MST$..M_GOODS GOODS_CUST_IRIME                       " & vbNewLine _
                              & "ON                                                        " & vbNewLine _
                              & "    GOODS_CUST_IRIME.NRS_BR_CD      = INT.TO_NRS_BR_CD	   " & vbNewLine _
                              & "AND GOODS_CUST_IRIME.CUST_CD_L      = INT.TO_CUST_L	   " & vbNewLine _
                              & "AND GOODS_CUST_IRIME.CUST_CD_M      = INT.TO_CUST_M       " & vbNewLine _
                              & "AND GOODS_CUST_IRIME.GOODS_CD_CUST  = GOODS.GOODS_CD_CUST " & vbNewLine _
                              & "AND GOODS_CUST_IRIME.STD_IRIME_NB   = GOODS.STD_IRIME_NB  " & vbNewLine _
                              & "AND GOODS_CUST_IRIME.SYS_DEL_FLG = '0'                    " & vbNewLine _
                              & "LEFT JOIN                                                 " & vbNewLine _
                              & " (SELECT                                                  " & vbNewLine _
                              & "    NRS_BR_CD	                                           " & vbNewLine _
                              & "   ,GOODS_CD_NRS	                                       " & vbNewLine _
                              & "   ,SUM(ALLOC_CAN_NB) 	     AS ALLOC_CAN_NB               " & vbNewLine _
                              & " FROM $LM_TRN$..D_ZAI_TRS                                 " & vbNewLine _
                              & " LEFT JOIN                                                " & vbNewLine _
                              & " $LM_MST$..M_INT_EDI SUB_INT                              " & vbNewLine _
                              & " ON    	                                               " & vbNewLine _
                              & "       NRS_BR_CD	= SUB_INT.TO_NRS_BR_CD                 " & vbNewLine _
                              & " AND   CUST_CD_L	= SUB_INT.TO_CUST_L                    " & vbNewLine _
                              & " AND   CUST_CD_M	= SUB_INT.TO_CUST_M                    " & vbNewLine _
                              & " AND   SUB_INT.INT_EDI_CD	= @INT_EDI_CD                  " & vbNewLine _
                              & "    GROUP BY	                                           " & vbNewLine _
                              & "    NRS_BR_CD	                                           " & vbNewLine _
                              & "   ,GOODS_CD_NRS	                                       " & vbNewLine _
                              & " )DZAI_IRIME                                                      " & vbNewLine _
                              & "ON  GOODS_CUST_IRIME.NRS_BR_CD      = DZAI_IRIME.NRS_BR_CD	       " & vbNewLine _
                              & "AND GOODS_CUST_IRIME.GOODS_CD_NRS   = DZAI_IRIME.GOODS_CD_NRS	   " & vbNewLine _
                              & "AND DZAI_IRIME.ALLOC_CAN_NB > 0                         		   " & vbNewLine _
                              & "LEFT JOIN                                                         " & vbNewLine _
                              & "     $LM_MST$..Z_KBN AS KBN1                                      " & vbNewLine _
                              & " ON KBN1.KBN_GROUP_CD = 'B007'                                    " & vbNewLine _
                              & "AND KBN1.KBN_CD       = OUTL.NRS_BR_CD                            " & vbNewLine


    ''' <summary>
    ''' 社内EDI入荷データ作成用データの検索 SQL WHERE句
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_SELECT_WHERE_INKAMAKEDATA As String = " WHERE               " & vbNewLine _
                              & "    OUTL.NRS_BR_CD     = @NRS_BR_CD              " & vbNewLine _
                              & "AND OUTL.OUTKA_NO_L    = @OUTKA_NO_L             " & vbNewLine _
                              & "AND OUTL.SYS_UPD_DATE  = @SYS_UPD_DATE           " & vbNewLine _
                              & "AND OUTL.SYS_UPD_TIME  = @SYS_UPD_TIME           " & vbNewLine _
                              & "AND OUTL.SYS_DEL_FLG   = '0'                     " & vbNewLine

    ''' <summary>
    ''' 社内EDI入荷データ作成用データの検索 SQL WHERE句
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_SELECT_GROUP_BY_INKAMAKEDATA As String = " GROUP BY               " & vbNewLine _
                              & " OUTL.OUTKA_NO_L                                                                          " & vbNewLine _
                              & ",INT.TO_NRS_BR_CD                                                                         " & vbNewLine _
                              & ",OUTL.OUTKA_PLAN_DATE                                                                     " & vbNewLine _
                              & ",INT.TO_NRS_WH_CD                                                                         " & vbNewLine _
                              & ",INT.TO_CUST_L                                                                            " & vbNewLine _
                              & ",INT.TO_CUST_M                                                                            " & vbNewLine _
                              & ",OUTL.OUTKA_PKG_NB                                                                        " & vbNewLine _
                              & ",OUTL.BUYER_ORD_NO                                                                        " & vbNewLine _
                              & ",OUTL.CUST_ORD_NO                                                                         " & vbNewLine _
                              & ",CUST.HOKAN_FREE_KIKAN                                                                    " & vbNewLine _
                              & ",OUTL.REMARK                                                                              " & vbNewLine _
                              & ",OUTM.OUTKA_NO_M                                                                          " & vbNewLine _
                              & ",OUTS.OUTKA_NO_S                                                                          " & vbNewLine _
                              & ",CASE WHEN GOODS_CUST_NM.NRS_BR_CD IS NOT NULL THEN GOODS_CUST_NM.GOODS_CD_NRS            " & vbNewLine _
                              & " ELSE GOODS_CUST_IRIME.GOODS_CD_NRS END                                                   " & vbNewLine _
                              & ",OUTM.CUST_ORD_NO_DTL                                                                     " & vbNewLine _
                              & ",OUTM.BUYER_ORD_NO_DTL                                                                    " & vbNewLine _
                              & ",OUTM.REMARK                                                                              " & vbNewLine _
                              & ",OUTS.LOT_NO                                                                              " & vbNewLine _
                              & ",GOODS.PKG_NB                                                                             " & vbNewLine _
                              & ",OUTS.ALCTD_NB                                                                            " & vbNewLine _
                              & ",GOODS.STD_IRIME_NB                                                                       " & vbNewLine _
                              & ",OUTS.BETU_WT                                                                             " & vbNewLine _
                              & ",OUTS.SERIAL_NO                                                                           " & vbNewLine _
                              & ",OUTS.REMARK                                                                              " & vbNewLine _
                              & ",CASE WHEN INT.DEF_TOU_NO = '#' THEN OUTS.TOU_NO                                          " & vbNewLine _
                              & " ELSE INT.DEF_TOU_NO END                                                                  " & vbNewLine _
                              & ",CASE WHEN INT.DEF_SITU_NO = '#' THEN OUTS.SITU_NO                                        " & vbNewLine _
                              & " ELSE INT.DEF_SITU_NO END                                                                 " & vbNewLine _
                              & ",CASE WHEN INT.DEF_ZONE_CD = '#' THEN OUTS.ZONE_CD                                        " & vbNewLine _
                              & " ELSE INT.DEF_ZONE_CD END                                                                 " & vbNewLine _
                              & ",CASE WHEN INT.DEF_LOC  = '#' THEN OUTS.LOCA                                              " & vbNewLine _
                              & " ELSE INT.DEF_LOC END                                                                     " & vbNewLine _
                              & ",GOODS_CUST_NM.GOODS_CD_NRS                                                               " & vbNewLine _
                              & ",DZAI.ALLOC_CAN_NB                                                                        " & vbNewLine _
                              & ",GOODS_CUST_IRIME.GOODS_CD_NRS                                                            " & vbNewLine _
                              & ",DZAI_IRIME.ALLOC_CAN_NB                                                                  " & vbNewLine _
                              & ",GOODS.GOODS_CD_CUST                                                                      " & vbNewLine _
                              & ",KBN1.VALUE1                                                                              " & vbNewLine


    ''' <summary>
    ''' 社内EDI入荷データ作成用データの検索 SQL
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_SELECT_INKAMAKE_BASE_END As String = " )BASE                        " & vbNewLine _
                              & "where          " & vbNewLine _
                              & "YUSEN = 1      " & vbNewLine



#Region "入荷データ(大)新規追加 SQL INSERT句"

    ''' <summary>
    ''' 入荷データ(大)新規追加 SQL INSERT句
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_INSERT_INKA_L As String = "INSERT INTO $LM_TRN$..B_INKA_L" & vbNewLine _
                                              & "(                             " & vbNewLine _
                                              & " NRS_BR_CD                    " & vbNewLine _
                                              & ",INKA_NO_L                    " & vbNewLine _
                                              & ",FURI_NO                      " & vbNewLine _
                                              & ",INKA_TP                      " & vbNewLine _
                                              & ",INKA_KB                      " & vbNewLine _
                                              & ",INKA_STATE_KB                " & vbNewLine _
                                              & ",INKA_DATE                    " & vbNewLine _
                                              & ",WH_CD                        " & vbNewLine _
                                              & ",CUST_CD_L                    " & vbNewLine _
                                              & ",CUST_CD_M                    " & vbNewLine _
                                              & ",INKA_PLAN_QT                 " & vbNewLine _
                                              & ",INKA_PLAN_QT_UT              " & vbNewLine _
                                              & ",INKA_TTL_NB                  " & vbNewLine _
                                              & ",BUYER_ORD_NO_L               " & vbNewLine _
                                              & ",OUTKA_FROM_ORD_NO_L          " & vbNewLine _
                                              & ",SEIQTO_CD                    " & vbNewLine _
                                              & ",TOUKI_HOKAN_YN               " & vbNewLine _
                                              & ",HOKAN_YN                     " & vbNewLine _
                                              & ",HOKAN_FREE_KIKAN             " & vbNewLine _
                                              & ",HOKAN_STR_DATE               " & vbNewLine _
                                              & ",NIYAKU_YN                    " & vbNewLine _
                                              & ",TAX_KB                       " & vbNewLine _
                                              & ",REMARK                       " & vbNewLine _
                                              & ",REMARK_OUT                   " & vbNewLine _
                                              & ",CHECKLIST_PRT_DATE           " & vbNewLine _
                                              & ",CHECKLIST_PRT_USER           " & vbNewLine _
                                              & ",UKETSUKELIST_PRT_DATE        " & vbNewLine _
                                              & ",UKETSUKELIST_PRT_USER        " & vbNewLine _
                                              & ",UKETSUKE_DATE                " & vbNewLine _
                                              & ",UKETSUKE_USER                " & vbNewLine _
                                              & ",KEN_DATE                     " & vbNewLine _
                                              & ",KEN_USER                     " & vbNewLine _
                                              & ",INKO_DATE                    " & vbNewLine _
                                              & ",INKO_USER                    " & vbNewLine _
                                              & ",HOUKOKUSYO_PR_DATE           " & vbNewLine _
                                              & ",HOUKOKUSYO_PR_USER           " & vbNewLine _
                                              & ",UNCHIN_TP                    " & vbNewLine _
                                              & ",UNCHIN_KB                    " & vbNewLine _
                                              & ",WH_TAB_STATUS                " & vbNewLine _
                                              & ",WH_TAB_YN                    " & vbNewLine _
                                              & ",WH_TAB_IMP_YN                " & vbNewLine _
                                              & ",SYS_ENT_DATE                 " & vbNewLine _
                                              & ",SYS_ENT_TIME                 " & vbNewLine _
                                              & ",SYS_ENT_PGID                 " & vbNewLine _
                                              & ",SYS_ENT_USER                 " & vbNewLine _
                                              & ",SYS_UPD_DATE                 " & vbNewLine _
                                              & ",SYS_UPD_TIME                 " & vbNewLine _
                                              & ",SYS_UPD_PGID                 " & vbNewLine _
                                              & ",SYS_UPD_USER                 " & vbNewLine _
                                              & ",SYS_DEL_FLG                  " & vbNewLine _
                                              & " )VALUES(                     " & vbNewLine _
                                              & " @NRS_BR_CD                   " & vbNewLine _
                                              & ",@INKA_NO_L                   " & vbNewLine _
                                              & ",@FURI_NO                     " & vbNewLine _
                                              & ",@INKA_TP                     " & vbNewLine _
                                              & ",@INKA_KB                     " & vbNewLine _
                                              & ",@INKA_STATE_KB               " & vbNewLine _
                                              & ",@INKA_DATE                   " & vbNewLine _
                                              & ",@WH_CD                       " & vbNewLine _
                                              & ",@CUST_CD_L                   " & vbNewLine _
                                              & ",@CUST_CD_M                   " & vbNewLine _
                                              & ",@INKA_PLAN_QT                " & vbNewLine _
                                              & ",@INKA_PLAN_QT_UT             " & vbNewLine _
                                              & ",@INKA_TTL_NB                 " & vbNewLine _
                                              & ",@BUYER_ORD_NO_L              " & vbNewLine _
                                              & ",@OUTKA_FROM_ORD_NO_L         " & vbNewLine _
                                              & ",@SEIQTO_CD                   " & vbNewLine _
                                              & ",@TOUKI_HOKAN_YN              " & vbNewLine _
                                              & ",@HOKAN_YN                    " & vbNewLine _
                                              & ",@HOKAN_FREE_KIKAN            " & vbNewLine _
                                              & ",@HOKAN_STR_DATE              " & vbNewLine _
                                              & ",@NIYAKU_YN                   " & vbNewLine _
                                              & ",@TAX_KB                      " & vbNewLine _
                                              & ",@REMARK                      " & vbNewLine _
                                              & ",@REMARK_OUT                  " & vbNewLine _
                                              & ",''                           " & vbNewLine _
                                              & ",''                           " & vbNewLine _
                                              & ",''                           " & vbNewLine _
                                              & ",''                           " & vbNewLine _
                                              & ",''                           " & vbNewLine _
                                              & ",''                           " & vbNewLine _
                                              & ",''                           " & vbNewLine _
                                              & ",''                           " & vbNewLine _
                                              & ",''                           " & vbNewLine _
                                              & ",''                           " & vbNewLine _
                                              & ",''                           " & vbNewLine _
                                              & ",''                           " & vbNewLine _
                                              & ",@UNCHIN_TP                   " & vbNewLine _
                                              & ",@UNCHIN_KB                   " & vbNewLine _
                                              & ",@WH_TAB_STATUS               " & vbNewLine _
                                              & ",@WH_TAB_YN                   " & vbNewLine _
                                              & ",@WH_TAB_IMP_YN               " & vbNewLine _
                                              & ",@SYS_ENT_DATE                " & vbNewLine _
                                              & ",@SYS_ENT_TIME                " & vbNewLine _
                                              & ",@SYS_ENT_PGID                " & vbNewLine _
                                              & ",@SYS_ENT_USER                " & vbNewLine _
                                              & ",@SYS_UPD_DATE                " & vbNewLine _
                                              & ",@SYS_UPD_TIME                " & vbNewLine _
                                              & ",@SYS_UPD_PGID                " & vbNewLine _
                                              & ",@SYS_UPD_USER                " & vbNewLine _
                                              & ",@SYS_DEL_FLG                 " & vbNewLine _
                                              & ")                             " & vbNewLine
#End Region

#Region "入荷データ(中)新規追加 SQL INSERT句"
    ''' <summary>
    ''' 入荷データ(中)新規追加 SQL INSERT句
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_INSERT_INKA_M As String = "INSERT INTO $LM_TRN$..B_INKA_M" & vbNewLine _
                                              & "(                             " & vbNewLine _
                                              & " NRS_BR_CD                    " & vbNewLine _
                                              & ",INKA_NO_L                    " & vbNewLine _
                                              & ",INKA_NO_M                    " & vbNewLine _
                                              & ",GOODS_CD_NRS                 " & vbNewLine _
                                              & ",OUTKA_FROM_ORD_NO_M          " & vbNewLine _
                                              & ",BUYER_ORD_NO_M               " & vbNewLine _
                                              & ",REMARK                       " & vbNewLine _
                                              & ",PRINT_SORT                   " & vbNewLine _
                                              & ",SYS_ENT_DATE                 " & vbNewLine _
                                              & ",SYS_ENT_TIME                 " & vbNewLine _
                                              & ",SYS_ENT_PGID                 " & vbNewLine _
                                              & ",SYS_ENT_USER                 " & vbNewLine _
                                              & ",SYS_UPD_DATE                 " & vbNewLine _
                                              & ",SYS_UPD_TIME                 " & vbNewLine _
                                              & ",SYS_UPD_PGID                 " & vbNewLine _
                                              & ",SYS_UPD_USER                 " & vbNewLine _
                                              & ",SYS_DEL_FLG                  " & vbNewLine _
                                              & " )VALUES(                     " & vbNewLine _
                                              & " @NRS_BR_CD                   " & vbNewLine _
                                              & ",@INKA_NO_L                   " & vbNewLine _
                                              & ",@INKA_NO_M                   " & vbNewLine _
                                              & ",@GOODS_CD_NRS                " & vbNewLine _
                                              & ",@OUTKA_FROM_ORD_NO_M         " & vbNewLine _
                                              & ",@BUYER_ORD_NO_M              " & vbNewLine _
                                              & ",@REMARK                      " & vbNewLine _
                                              & ",99                           " & vbNewLine _
                                              & ",@SYS_ENT_DATE                " & vbNewLine _
                                              & ",@SYS_ENT_TIME                " & vbNewLine _
                                              & ",@SYS_ENT_PGID                " & vbNewLine _
                                              & ",@SYS_ENT_USER                " & vbNewLine _
                                              & ",@SYS_UPD_DATE                " & vbNewLine _
                                              & ",@SYS_UPD_TIME                " & vbNewLine _
                                              & ",@SYS_UPD_PGID                " & vbNewLine _
                                              & ",@SYS_UPD_USER                " & vbNewLine _
                                              & ",@SYS_DEL_FLG                 " & vbNewLine _
                                              & ")                             " & vbNewLine
#End Region

#Region "入荷データ(小)新規追加 SQL INSERT句"
    ''' <summary>
    ''' 入荷データ(小)新規追加 SQL INSERT句
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_INSERT_INKA_S As String = "INSERT INTO $LM_TRN$..B_INKA_S" & vbNewLine _
                                              & "(                             " & vbNewLine _
                                              & " NRS_BR_CD                    " & vbNewLine _
                                              & ",INKA_NO_L                    " & vbNewLine _
                                              & ",INKA_NO_M                    " & vbNewLine _
                                              & ",INKA_NO_S                    " & vbNewLine _
                                              & ",ZAI_REC_NO                   " & vbNewLine _
                                              & ",LOT_NO                       " & vbNewLine _
                                              & ",LOCA                         " & vbNewLine _
                                              & ",TOU_NO                       " & vbNewLine _
                                              & ",SITU_NO                      " & vbNewLine _
                                              & ",ZONE_CD                      " & vbNewLine _
                                              & ",KONSU                        " & vbNewLine _
                                              & ",HASU                         " & vbNewLine _
                                              & ",IRIME                        " & vbNewLine _
                                              & ",BETU_WT                      " & vbNewLine _
                                              & ",SERIAL_NO                    " & vbNewLine _
                                              & ",GOODS_COND_KB_1              " & vbNewLine _
                                              & ",GOODS_COND_KB_2              " & vbNewLine _
                                              & ",GOODS_COND_KB_3              " & vbNewLine _
                                              & ",GOODS_CRT_DATE               " & vbNewLine _
                                              & ",LT_DATE                      " & vbNewLine _
                                              & ",SPD_KB                       " & vbNewLine _
                                              & ",OFB_KB                       " & vbNewLine _
                                              & ",DEST_CD                      " & vbNewLine _
                                              & ",REMARK                       " & vbNewLine _
                                              & ",ALLOC_PRIORITY               " & vbNewLine _
                                              & ",REMARK_OUT                   " & vbNewLine _
                                              & ",SYS_ENT_DATE                 " & vbNewLine _
                                              & ",SYS_ENT_TIME                 " & vbNewLine _
                                              & ",SYS_ENT_PGID                 " & vbNewLine _
                                              & ",SYS_ENT_USER                 " & vbNewLine _
                                              & ",SYS_UPD_DATE                 " & vbNewLine _
                                              & ",SYS_UPD_TIME                 " & vbNewLine _
                                              & ",SYS_UPD_PGID                 " & vbNewLine _
                                              & ",SYS_UPD_USER                 " & vbNewLine _
                                              & ",SYS_DEL_FLG                  " & vbNewLine _
                                              & " )VALUES(                     " & vbNewLine _
                                              & " @NRS_BR_CD                   " & vbNewLine _
                                              & ",@INKA_NO_L                   " & vbNewLine _
                                              & ",@INKA_NO_M                   " & vbNewLine _
                                              & ",@INKA_NO_S                   " & vbNewLine _
                                              & ",''                           " & vbNewLine _
                                              & ",@LOT_NO                      " & vbNewLine _
                                              & ",@LOCA                           " & vbNewLine _
                                              & ",@TOU_NO                      " & vbNewLine _
                                              & ",@SITU_NO                     " & vbNewLine _
                                              & ",@ZONE_CD                     " & vbNewLine _
                                              & ",@KONSU                       " & vbNewLine _
                                              & ",@HASU                        " & vbNewLine _
                                              & ",@IRIME                       " & vbNewLine _
                                              & ",@BETU_WT                     " & vbNewLine _
                                              & ",@SERIAL_NO                   " & vbNewLine _
                                              & ",''                           " & vbNewLine _
                                              & ",''                           " & vbNewLine _
                                              & ",''                           " & vbNewLine _
                                              & ",''                           " & vbNewLine _
                                              & ",''                           " & vbNewLine _
                                              & ",@SPD_KB                      " & vbNewLine _
                                              & ",@OFB_KB                      " & vbNewLine _
                                              & ",''                           " & vbNewLine _
                                              & ",@REMARK                      " & vbNewLine _
                                              & ",@ALLOC_PRIORITY              " & vbNewLine _
                                              & ",@REMARK_OUT                  " & vbNewLine _
                                              & ",@SYS_ENT_DATE                " & vbNewLine _
                                              & ",@SYS_ENT_TIME                " & vbNewLine _
                                              & ",@SYS_ENT_PGID                " & vbNewLine _
                                              & ",@SYS_ENT_USER                " & vbNewLine _
                                              & ",@SYS_UPD_DATE                " & vbNewLine _
                                              & ",@SYS_UPD_TIME                " & vbNewLine _
                                              & ",@SYS_UPD_PGID                " & vbNewLine _
                                              & ",@SYS_UPD_USER                " & vbNewLine _
                                              & ",@SYS_DEL_FLG                 " & vbNewLine _
                                              & ")                             " & vbNewLine

#End Region




#Region "社内EDI入荷データ作成用データの検索(商品キー直接変換)"

    Private Const SQL_SELECT_INKAMAKE_DIRECT_CONV_GOODS_CD_NRS As String _
        = " SELECT                                                              " & vbNewLine _
        & "        CS.NRS_BR_CD                     AS NRS_BR_CD                " & vbNewLine _
        & "      , CS.OUTKA_NO_L                    AS OUTKA_NO_L               " & vbNewLine _
        & "      , CS.OUTKA_NO_M                    AS OUTKA_NO_M               " & vbNewLine _
        & "      , CS.OUTKA_NO_S                    AS OUTKA_NO_S               " & vbNewLine _
        & "      , ZT.ZAI_REC_NO                    AS ZAI_REC_NO               " & vbNewLine _
        & "      , IE.TO_NRS_BR_CD                  AS TO_NRS_BR_CD             " & vbNewLine _
        & "      , CL.OUTKA_PLAN_DATE               AS OUTKA_PLAN_DATE          " & vbNewLine _
        & "      , IE.TO_NRS_WH_CD                  AS TO_NRS_WH_CD             " & vbNewLine _
        & "      , IE.TO_CUST_L                     AS TO_CUST_L                " & vbNewLine _
        & "      , IE.TO_CUST_M                     AS TO_CUST_M                " & vbNewLine _
        & "      , CL.OUTKA_PKG_NB                  AS OUTKA_PKG_NB             " & vbNewLine _
        & "      , CL.BUYER_ORD_NO                  AS BUYER_ORD_NO             " & vbNewLine _
        & "      , CL.CUST_ORD_NO                   AS CUST_ORD_NO              " & vbNewLine _
        & "      , MC.HOKAN_FREE_KIKAN              AS HOKAN_FREE_KIKAN         " & vbNewLine _
        & "      , CS.REMARK                        AS REMARK                   " & vbNewLine _
        & "      , ISNULL(TO_MG.GOODS_CD_NRS, '')   AS GOODS_CD_NRS             " & vbNewLine _
        & "      , CM.CUST_ORD_NO_DTL               AS CUST_ORD_NO_DTL          " & vbNewLine _
        & "      , CM.BUYER_ORD_NO_DTL              AS BUYER_ORD_NO_DTL         " & vbNewLine _
        & "      , CS.REMARK                        AS REMARK_M                 " & vbNewLine _
        & "      , ZT.LOT_NO                        AS LOT_NO                   " & vbNewLine _
        & "      , TO_MG.PKG_NB                     AS PKG_NB                   " & vbNewLine _
        & "      , CS.ALCTD_NB                      AS ALCTD_NB                 " & vbNewLine _
        & "      , ZT.IRIME                         AS IRIME                    " & vbNewLine _
        & "      , TO_MG.STD_IRIME_NB               AS STD_IRIME_NB             " & vbNewLine _
        & "      , CS.BETU_WT                       AS BETU_WT                  " & vbNewLine _
        & "      , CS.SERIAL_NO                     AS SERIAL_NO                " & vbNewLine _
        & "      , CS.REMARK                        AS REMARK_S                 " & vbNewLine _
        & "      , CASE WHEN IE.DEF_TOU_NO = '#'                                " & vbNewLine _
        & "             THEN CS.TOU_NO                                          " & vbNewLine _
        & "             ELSE IE.DEF_TOU_NO                                      " & vbNewLine _
        & "         END                             AS TOU_NO                   " & vbNewLine _
        & "      , CASE WHEN IE.DEF_SITU_NO = '#'                               " & vbNewLine _
        & "             THEN CS.SITU_NO                                         " & vbNewLine _
        & "             ELSE IE.DEF_SITU_NO                                     " & vbNewLine _
        & "         END                             AS SITU_NO                  " & vbNewLine _
        & "      , CASE WHEN IE.DEF_ZONE_CD = '#'                               " & vbNewLine _
        & "             THEN CS.ZONE_CD                                         " & vbNewLine _
        & "             ELSE IE.DEF_ZONE_CD                                     " & vbNewLine _
        & "         END                             AS ZONE_CD                  " & vbNewLine _
        & "      , CASE WHEN IE.DEF_LOC = '#'                                   " & vbNewLine _
        & "             THEN CS.LOCA                                            " & vbNewLine _
        & "             ELSE IE.DEF_LOC                                         " & vbNewLine _
        & "         END                             AS LOCA                     " & vbNewLine _
        & "      , CASE WHEN KBN1.VALUE1 = 1.000                                " & vbNewLine _
        & "             THEN '01'                                               " & vbNewLine _
        & "             ELSE '00'                                               " & vbNewLine _
        & "         END                             AS WH_TAB_YN                " & vbNewLine _
        & "   FROM $LM_TRN$..C_OUTKA_L AS CL                                    " & vbNewLine _
        & "   LEFT JOIN                                                         " & vbNewLine _
        & "        $LM_TRN$..C_OUTKA_M AS CM                                    " & vbNewLine _
        & "     ON CM.NRS_BR_CD   = CL.NRS_BR_CD                                " & vbNewLine _
        & "    AND CM.OUTKA_NO_L  = CL.OUTKA_NO_L                               " & vbNewLine _
        & "    AND CM.SYS_DEL_FLG = '0'                                         " & vbNewLine _
        & "   LEFT JOIN                                                         " & vbNewLine _
        & "        $LM_TRN$..C_OUTKA_S AS CS                                    " & vbNewLine _
        & "     ON CS.NRS_BR_CD = CM.NRS_BR_CD                                  " & vbNewLine _
        & "    AND CS.OUTKA_NO_L = CM.OUTKA_NO_L                                " & vbNewLine _
        & "    AND CS.OUTKA_NO_M = CM.OUTKA_NO_M                                " & vbNewLine _
        & "    AND CS.SYS_DEL_FLG = '0'                                         " & vbNewLine _
        & "   LEFT JOIN                                                         " & vbNewLine _
        & "        $LM_TRN$..D_ZAI_TRS AS ZT                                    " & vbNewLine _
        & "     ON ZT.NRS_BR_CD   = CS.NRS_BR_CD                                " & vbNewLine _
        & "    AND ZT.ZAI_REC_NO  = CS.ZAI_REC_NO                               " & vbNewLine _
        & "    AND ZT.SYS_DEL_FLG = '0'                                         " & vbNewLine _
        & "   LEFT JOIN                                                         " & vbNewLine _
        & "        $LM_MST$..M_INT_EDI AS IE                                    " & vbNewLine _
        & "     ON IE.FROM_NRS_BR_CD = CL.NRS_BR_CD                             " & vbNewLine _
        & "    AND IE.FROM_CUST_L    = CL.CUST_CD_L                             " & vbNewLine _
        & "    AND IE.FROM_CUST_M    = CL.CUST_CD_M                             " & vbNewLine _
        & "    AND IE.INT_EDI_CD     = @INT_EDI_CD                              " & vbNewLine _
        & "   LEFT JOIN                                                         " & vbNewLine _
        & "        $LM_MST$..M_GOODS AS MG                                      " & vbNewLine _
        & "     ON MG.NRS_BR_CD    = CM.NRS_BR_CD                               " & vbNewLine _
        & "    AND MG.GOODS_CD_NRS = CM.GOODS_CD_NRS                            " & vbNewLine _
        & "   LEFT JOIN                                                         " & vbNewLine _
        & "        $LM_MST$..M_GOODS_DETAILS AS MGD                             " & vbNewLine _
        & "     ON MGD.NRS_BR_CD    = MG.NRS_BR_CD                              " & vbNewLine _
        & "    AND MGD.GOODS_CD_NRS = MG.GOODS_CD_NRS                           " & vbNewLine _
        & "    AND MGD.SUB_KB       = '61'                                      " & vbNewLine _
        & "   LEFT JOIN                                                         " & vbNewLine _
        & "        $LM_MST$..M_GOODS AS TO_MG                                   " & vbNewLine _
        & "     ON TO_MG.NRS_BR_CD     = IE.TO_NRS_BR_CD                        " & vbNewLine _
        & "    AND TO_MG.CUST_CD_L     = IE.TO_CUST_L                           " & vbNewLine _
        & "    AND TO_MG.CUST_CD_M     = IE.TO_CUST_M                           " & vbNewLine _
        & "    AND TO_MG.GOODS_CD_NRS  = MGD.SET_NAIYO                          " & vbNewLine _
        & "    AND TO_MG.STD_IRIME_NB  = MG.STD_IRIME_NB                        " & vbNewLine _
        & "    AND TO_MG.GOODS_CD_CUST = MG.GOODS_CD_CUST                       " & vbNewLine _
        & "   LEFT JOIN                                                         " & vbNewLine _
        & "        $LM_MST$..M_CUST  AS MC                                      " & vbNewLine _
        & "     ON MC.NRS_BR_CD  = TO_MG.NRS_BR_CD                              " & vbNewLine _
        & "    AND MC.CUST_CD_L  = TO_MG.CUST_CD_L                              " & vbNewLine _
        & "    AND MC.CUST_CD_M  = TO_MG.CUST_CD_M                              " & vbNewLine _
        & "    AND MC.CUST_CD_S  = TO_MG.CUST_CD_S                              " & vbNewLine _
        & "    AND MC.CUST_CD_SS = TO_MG.CUST_CD_SS                             " & vbNewLine _
        & "   LEFT JOIN                                                         " & vbNewLine _
        & "        $LM_MST$..Z_KBN AS KBN1                                      " & vbNewLine _
        & "     ON KBN1.KBN_GROUP_CD = 'B007'                                   " & vbNewLine _
        & "    AND KBN1.KBN_CD       = CL.NRS_BR_CD                             " & vbNewLine _
        & "  WHERE CL.SYS_DEL_FLG = '0'                                         " & vbNewLine _
        & "    AND IE.FROM_NRS_BR_CD IS NOT NULL                                " & vbNewLine _
        & "    AND CL.NRS_BR_CD      = @NRS_BR_CD                               " & vbNewLine _
        & "    AND CL.OUTKA_NO_L     = @OUTKA_NO_L                              " & vbNewLine _
        & "    AND CL.SYS_UPD_DATE   = @SYS_UPD_DATE                            " & vbNewLine _
        & "    AND CL.SYS_UPD_TIME   = @SYS_UPD_TIME                            " & vbNewLine _
        & "                                                                     " & vbNewLine

#End Region

#End Region
    '社内入荷データ作成対応 terakawa 2012.11.19 End

    '要望番号:1533 terakawa 2012.10.30 Start
#Region "チェック"
    ''' <summary>
    ''' 排他処理
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_HAITA_CHK As String = "SELECT                                       " & vbNewLine _
                                          & " COUNT(*)       AS SELECT_CNT                " & vbNewLine _
                                          & "FROM                                         " & vbNewLine _
                                          & " $LM_TRN$..C_OUTKA_L OUTL                " & vbNewLine _
                                          & "WHERE                                        " & vbNewLine _
                                          & "    OUTL.NRS_BR_CD    = @NRS_BR_CD           " & vbNewLine _
                                          & "AND OUTL.OUTKA_NO_L   = @OUTKA_NO_L          " & vbNewLine _
                                          & "AND OUTL.SYS_UPD_DATE = @SYS_UPD_DATE        " & vbNewLine _
                                          & "AND OUTL.SYS_UPD_TIME = @SYS_UPD_TIME        " & vbNewLine


    '社内入荷データ作成対応 terakawa 2012.11.19 Start
    ''' <summary>
    ''' 存在チェック
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_EXIST_INT_EDI_CHK As String _
        = "SELECT                                               " & vbNewLine _
        & "	      INT_EDI_NM            AS INT_EDI_NM           " & vbNewLine _
        & "	    , INT_EDI_CD            AS INT_EDI_CD           " & vbNewLine _
        & "	    , USE_GOODS_CONV_TABLE  AS USE_GOODS_CONV_TABLE " & vbNewLine _
        & "	    , IS_GROUPING           AS IS_GROUPING          " & vbNewLine _
        & "  FROM                                               " & vbNewLine _
        & "       $LM_MST$..M_INT_EDI INT                       " & vbNewLine _
        & " WHERE                                               " & vbNewLine _
        & "      INT.INT_EDI_CD     = @INT_EDI_CD               " & vbNewLine _
        & "  AND INT.FROM_NRS_BR_CD = @NRS_BR_CD                " & vbNewLine _
        & "  AND INT.FROM_CUST_L    = @CUST_CD_L                " & vbNewLine

    '社内入荷データ作成対応 terakawa 2012.11.19 End

#End Region
    '要望番号:1533 terakawa 2012.10.30 End

#Region "WIT対応"

#Region "纏めピッキング番号採番処理"

    'START Kurihara WIT対応

    ''' <summary>
    ''' 対象の出荷管理番号Lを持つワークデータを検索します。
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_SELECT_MTM_PIC_NO_LIST As String = _
                                              "SELECT                                                             " & vbNewLine _
                                            & "      C_OUTKA_L.OUTKA_PLAN_DATE  AS OUTKA_PLAN_DATE                " & vbNewLine _
                                            & "    , C_OUTKA_S.TOU_NO           AS TOU_NO                         " & vbNewLine _
                                            & "    , C_OUTKA_S.SITU_NO          AS SITU_NO                        " & vbNewLine _
                                            & "    , C_OUTKA_S.ZONE_CD          AS ZONE_CD                        " & vbNewLine _
                                            & "    , C_OUTKA_S.LOCA             AS LOCA                           " & vbNewLine _
                                            & "    , C_OUTKA_L.CUST_CD_L        AS CUST_CD_L                      " & vbNewLine _
                                            & "    , C_TOTAL_PIC_WK.MTM_PICK_NO AS MTM_PICK_NO                    " & vbNewLine _
                                            & "FROM                                                               " & vbNewLine _
                                            & "    $LM_TRN$..C_OUTKA_L C_OUTKA_L                                  " & vbNewLine _
                                            & "    LEFT JOIN                                                      " & vbNewLine _
                                            & "    $LM_TRN$..C_OUTKA_S C_OUTKA_S                                  " & vbNewLine _
                                            & "    ON                                                             " & vbNewLine _
                                            & "            C_OUTKA_L.NRS_BR_CD  = C_OUTKA_S.NRS_BR_CD             " & vbNewLine _
                                            & "        AND C_OUTKA_L.OUTKA_NO_L = C_OUTKA_S.OUTKA_NO_L            " & vbNewLine _
                                            & "    LEFT JOIN                                                      " & vbNewLine _
                                            & "    $LM_TRN$..C_TOTAL_PIC_WK C_TOTAL_PIC_WK                        " & vbNewLine _
                                            & "    ON                                                             " & vbNewLine _
                                            & "            C_TOTAL_PIC_WK.NRS_BR_CD  = C_OUTKA_S.NRS_BR_CD        " & vbNewLine _
                                            & "        AND C_TOTAL_PIC_WK.OUTKA_NO_L = C_OUTKA_S.OUTKA_NO_L       " & vbNewLine _
                                            & "        AND C_TOTAL_PIC_WK.OUTKA_NO_M = C_OUTKA_S.OUTKA_NO_M       " & vbNewLine _
                                            & "        AND C_TOTAL_PIC_WK.OUTKA_NO_S = C_OUTKA_S.OUTKA_NO_S       " & vbNewLine _
                                            & "WHERE                                                              " & vbNewLine _
                                            & "        C_OUTKA_L.NRS_BR_CD = @NRS_BR_CD                           " & vbNewLine _
                                            & "    AND C_OUTKA_L.OUTKA_NO_L IN ({0})                              " & vbNewLine _
                                            & "    AND C_OUTKA_L.SYS_DEL_FLG = '0'                                " & vbNewLine _
                                            & "    AND C_OUTKA_S.SYS_DEL_FLG = '0'                                " & vbNewLine _
                                            & "    AND C_TOTAL_PIC_WK.SYS_DEL_FLG = '0'                           " & vbNewLine

    ''' <summary>
    ''' 纏めピッキングWKへの登録・削除判断を行うためのデータを抽出します。
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_SELECT_ENTRY_JUDGE As String = _
                                              "SELECT                                                " & vbNewLine _
                                            & "      MAIN.NRS_BR_CD    AS NRS_BR_CD                  " & vbNewLine _
                                            & "    , MAIN.OUTKA_NO_L   AS OUTKA_NO_L                 " & vbNewLine _
                                            & "    , MAIN.OUTKA_NO_M   AS OUTKA_NO_M                 " & vbNewLine _
                                            & "    , MAIN.OUTKA_NO_S   AS OUTKA_NO_S                 " & vbNewLine _
                                            & "    , SUM(MAIN.TRN_FLG) AS TRN_FLG                    " & vbNewLine _
                                            & "    , SUM(MAIN.WK_FLG)  AS WK_FLG                     " & vbNewLine _
                                            & "FROM                                                  " & vbNewLine _
                                            & "   (                                                  " & vbNewLine _
                                            & "    SELECT                                            " & vbNewLine _
                                            & "          C_OUTKA_S.NRS_BR_CD   AS NRS_BR_CD          " & vbNewLine _
                                            & "        , C_OUTKA_S.OUTKA_NO_L  AS OUTKA_NO_L         " & vbNewLine _
                                            & "        , C_OUTKA_S.OUTKA_NO_M  AS OUTKA_NO_M         " & vbNewLine _
                                            & "        , C_OUTKA_S.OUTKA_NO_S  AS OUTKA_NO_S         " & vbNewLine _
                                            & "        , 1 AS TRN_FLG                                " & vbNewLine _
                                            & "        , 0 AS WK_FLG                                 " & vbNewLine _
                                            & "    FROM                                              " & vbNewLine _
                                            & "        $LM_TRN$..C_OUTKA_S C_OUTKA_S                 " & vbNewLine _
                                            & "    WHERE                                             " & vbNewLine _
                                            & "            NRS_BR_CD   = @NRS_BR_CD                  " & vbNewLine _
                                            & "        AND OUTKA_NO_L  = @OUTKA_NO_L                 " & vbNewLine _
                                            & "        AND SYS_DEL_FLG = '0'                         " & vbNewLine _
                                            & "                                                      " & vbNewLine _
                                            & "    UNION                                             " & vbNewLine _
                                            & "                                                      " & vbNewLine _
                                            & "    SELECT                                            " & vbNewLine _
                                            & "          C_TOTAL_PIC_WK.NRS_BR_CD   AS NRS_BR_CD     " & vbNewLine _
                                            & "        , C_TOTAL_PIC_WK.OUTKA_NO_L  AS OUTKA_NO_L    " & vbNewLine _
                                            & "        , C_TOTAL_PIC_WK.OUTKA_NO_M  AS OUTKA_NO_M    " & vbNewLine _
                                            & "        , C_TOTAL_PIC_WK.OUTKA_NO_S  AS OUTKA_NO_S    " & vbNewLine _
                                            & "        , 0 AS TRN_FLG                                " & vbNewLine _
                                            & "        , 1 AS WK_FLG                                 " & vbNewLine _
                                            & "    FROM                                              " & vbNewLine _
                                            & "        $LM_TRN$..C_TOTAL_PIC_WK C_TOTAL_PIC_WK       " & vbNewLine _
                                            & "    WHERE                                             " & vbNewLine _
                                            & "            NRS_BR_CD   = @NRS_BR_CD                  " & vbNewLine _
                                            & "        AND OUTKA_NO_L  = @OUTKA_NO_L                 " & vbNewLine _
                                            & "        AND SYS_DEL_FLG = '0'                         " & vbNewLine _
                                            & "   ) MAIN                                             " & vbNewLine _
                                            & "GROUP BY                                              " & vbNewLine _
                                            & "      NRS_BR_CD                                       " & vbNewLine _
                                            & "    , OUTKA_NO_L                                      " & vbNewLine _
                                            & "    , OUTKA_NO_M                                      " & vbNewLine _
                                            & "    , OUTKA_NO_S                                      " & vbNewLine _
                                            & "                                                      " & vbNewLine

    ''' <summary>
    ''' 纏めピッキングWKへの登録を実行します。
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_INSERT_C_TOTAL_PIC_WK As String = _
                                              "INSERT INTO $LM_TRN$..C_TOTAL_PIC_WK                                  " & vbNewLine _
                                            & "(                                                                     " & vbNewLine _
                                            & "      NRS_BR_CD                                                       " & vbNewLine _
                                            & "    , OUTKA_NO_L                                                      " & vbNewLine _
                                            & "    , OUTKA_NO_M                                                      " & vbNewLine _
                                            & "    , OUTKA_NO_S                                                      " & vbNewLine _
                                            & "    , GOODS_KANRI_NO                                                  " & vbNewLine _
                                            & "    , OUTKA_TTL_NB                                                    " & vbNewLine _
                                            & "    , NB_UT                                                           " & vbNewLine _
                                            & "    , GOODS_CD_CUST                                                   " & vbNewLine _
                                            & "    , GOODS_NM                                                        " & vbNewLine _
                                            & "    , LOT_NO                                                          " & vbNewLine _
                                            & "    , IRIME_NB                                                        " & vbNewLine _
                                            & "    , IRIME_UT                                                        " & vbNewLine _
                                            & "    , MTM_PICK_NO                                                     " & vbNewLine _
                                            & "    , CHK_TANI                                                        " & vbNewLine _
                                            & "    , CUST_CD_L                                                       " & vbNewLine _
                                            & "    , CUST_CD_M                                                       " & vbNewLine _
                                            & "    , OUTKA_DATE                                                      " & vbNewLine _
                                            & "    , SYS_ENT_DATE                                                    " & vbNewLine _
                                            & "    , SYS_ENT_TIME                                                    " & vbNewLine _
                                            & "    , SYS_ENT_PGID                                                    " & vbNewLine _
                                            & "    , SYS_ENT_USER                                                    " & vbNewLine _
                                            & "    , SYS_UPD_DATE                                                    " & vbNewLine _
                                            & "    , SYS_UPD_TIME                                                    " & vbNewLine _
                                            & "    , SYS_UPD_PGID                                                    " & vbNewLine _
                                            & "    , SYS_UPD_USER                                                    " & vbNewLine _
                                            & "    , SYS_DEL_FLG                                                     " & vbNewLine _
                                            & ")                                                                     " & vbNewLine _
                                            & "SELECT                                                                " & vbNewLine _
                                            & "      C_OUTKA_S.NRS_BR_CD       AS NRS_BR_CD                          " & vbNewLine _
                                            & "    , C_OUTKA_S.OUTKA_NO_L      AS OUTKA_NO_L                         " & vbNewLine _
                                            & "    , C_OUTKA_S.OUTKA_NO_M      AS OUTKA_NO_M                         " & vbNewLine _
                                            & "    , C_OUTKA_S.OUTKA_NO_S      AS OUTKA_NO_S                         " & vbNewLine _
                                            & "    , D_ZAI_TRS.GOODS_KANRI_NO  AS GOODS_KANRI_NO                     " & vbNewLine _
                                            & "    , C_OUTKA_S.ALCTD_NB        AS ALCTD_NB                           " & vbNewLine _
                                            & "    , M_GOODS.NB_UT             AS NB_UT                              " & vbNewLine _
                                            & "    , M_GOODS.GOODS_CD_CUST     AS GOODS_CD_CUST                      " & vbNewLine _
                                            & "    , M_GOODS.GOODS_NM_1        AS GOODS_NM                           " & vbNewLine _
                                            & "    , C_OUTKA_S.LOT_NO          AS LOT_NO                             " & vbNewLine _
                                            & "    , C_OUTKA_S.IRIME           AS IRIME_NB                           " & vbNewLine _
                                            & "    , C_OUTKA_M.IRIME_UT        AS IRIME_UT                           " & vbNewLine _
                                            & "    , @MTM_PICK_NO              AS MTM_PICK_NO                        " & vbNewLine _
                                            & "    , ISNULL(M_GOODS_DETAILS.SET_NAIYO, '99') AS CHK_TANI             " & vbNewLine _
                                            & "    , C_OUTKA_L.CUST_CD_L       AS CUST_CD_L                          " & vbNewLine _
                                            & "    , C_OUTKA_L.CUST_CD_M       AS CUST_CD_M                          " & vbNewLine _
                                            & "    , @OUTKA_DATE               AS OUTKA_DATE                         " & vbNewLine _
                                            & "    , @SYS_ENT_DATE             AS SYS_ENT_DATE                       " & vbNewLine _
                                            & "    , @SYS_ENT_TIME             AS SYS_ENT_TIME                       " & vbNewLine _
                                            & "    , @SYS_ENT_PGID             AS SYS_ENT_PGID                       " & vbNewLine _
                                            & "    , @SYS_ENT_USER             AS SYS_ENT_USER                       " & vbNewLine _
                                            & "    , @SYS_UPD_DATE             AS SYS_UPD_DATE                       " & vbNewLine _
                                            & "    , @SYS_UPD_TIME             AS SYS_UPD_TIME                       " & vbNewLine _
                                            & "    , @SYS_UPD_PGID             AS SYS_UPD_PGID                       " & vbNewLine _
                                            & "    , @SYS_UPD_USER             AS SYS_UPD_USER                       " & vbNewLine _
                                            & "    , @SYS_DEL_FLG              AS SYS_DEL_FLG                        " & vbNewLine _
                                            & "FROM                                                                  " & vbNewLine _
                                            & "    $LM_TRN$..C_OUTKA_S C_OUTKA_S                                     " & vbNewLine _
                                            & "    LEFT JOIN                                                         " & vbNewLine _
                                            & "    $LM_TRN$..D_ZAI_TRS D_ZAI_TRS                                     " & vbNewLine _
                                            & "    ON                                                                " & vbNewLine _
                                            & "            C_OUTKA_S.NRS_BR_CD     = D_ZAI_TRS.NRS_BR_CD             " & vbNewLine _
                                            & "        AND C_OUTKA_S.ZAI_REC_NO    = D_ZAI_TRS.ZAI_REC_NO            " & vbNewLine _
                                            & "    LEFT JOIN                                                         " & vbNewLine _
                                            & "    $LM_TRN$..C_OUTKA_L C_OUTKA_L                                     " & vbNewLine _
                                            & "    ON                                                                " & vbNewLine _
                                            & "            C_OUTKA_S.NRS_BR_CD     = C_OUTKA_L.NRS_BR_CD             " & vbNewLine _
                                            & "        AND C_OUTKA_S.OUTKA_NO_L    = C_OUTKA_L.OUTKA_NO_L            " & vbNewLine _
                                            & "    LEFT JOIN                                                         " & vbNewLine _
                                            & "    $LM_TRN$..C_OUTKA_M C_OUTKA_M                                     " & vbNewLine _
                                            & "    ON                                                                " & vbNewLine _
                                            & "            C_OUTKA_S.NRS_BR_CD     = C_OUTKA_M.NRS_BR_CD             " & vbNewLine _
                                            & "        AND C_OUTKA_S.OUTKA_NO_L    = C_OUTKA_M.OUTKA_NO_L            " & vbNewLine _
                                            & "        AND C_OUTKA_S.OUTKA_NO_M    = C_OUTKA_M.OUTKA_NO_M            " & vbNewLine _
                                            & "    LEFT JOIN                                                         " & vbNewLine _
                                            & "    $LM_MST$..M_GOODS M_GOODS                                         " & vbNewLine _
                                            & "    ON                                                                " & vbNewLine _
                                            & "            C_OUTKA_M.NRS_BR_CD     = M_GOODS.NRS_BR_CD               " & vbNewLine _
                                            & "        AND C_OUTKA_M.GOODS_CD_NRS  = M_GOODS.GOODS_CD_NRS            " & vbNewLine _
                                            & "    LEFT JOIN                                                         " & vbNewLine _
                                            & "    $LM_TRN$..B_INKA_WK B_INKA_WK                                     " & vbNewLine _
                                            & "    ON                                                                " & vbNewLine _
                                            & "            C_OUTKA_S.NRS_BR_CD     = B_INKA_WK.NRS_BR_CD             " & vbNewLine _
                                            & "        AND C_OUTKA_S.INKA_NO_L     = B_INKA_WK.INKA_NO_L             " & vbNewLine _
                                            & "        AND C_OUTKA_S.INKA_NO_M     = B_INKA_WK.INKA_NO_M             " & vbNewLine _
                                            & "        AND C_OUTKA_S.INKA_NO_S     = B_INKA_WK.INKA_NO_S             " & vbNewLine _
                                            & "        AND B_INKA_WK.SYS_DEL_FLG  = '0'                              " & vbNewLine _
                                            & "    LEFT JOIN                                                         " & vbNewLine _
                                            & "    $LM_MST$..M_GOODS_DETAILS                                         " & vbNewLine _
                                            & "    ON                                                                " & vbNewLine _
                                            & "            C_OUTKA_M.NRS_BR_CD     = M_GOODS_DETAILS.NRS_BR_CD       " & vbNewLine _
                                            & "        AND C_OUTKA_M.GOODS_CD_NRS  = M_GOODS_DETAILS.GOODS_CD_NRS    " & vbNewLine _
                                            & "        AND M_GOODS_DETAILS.SUB_KB  = '41'                            " & vbNewLine _
                                            & "        AND M_GOODS_DETAILS.SYS_DEL_FLG  = '0'                        " & vbNewLine _
                                            & "WHERE                                                                 " & vbNewLine _
                                            & "        C_OUTKA_S.NRS_BR_CD         = @NRS_BR_CD                      " & vbNewLine _
                                            & "    AND C_OUTKA_S.OUTKA_NO_L        = @OUTKA_NO_L                     " & vbNewLine _
                                            & "    AND C_OUTKA_S.OUTKA_NO_M        = @OUTKA_NO_M                     " & vbNewLine _
                                            & "    AND C_OUTKA_S.OUTKA_NO_S        = @OUTKA_NO_S                     " & vbNewLine _
                                            & "    AND C_OUTKA_L.SYS_DEL_FLG  = '0'                                  " & vbNewLine _
                                            & "    AND C_OUTKA_M.SYS_DEL_FLG  = '0'                                  " & vbNewLine _
                                            & "    AND C_OUTKA_S.SYS_DEL_FLG  = '0'                                  " & vbNewLine

    ''' <summary>
    ''' 纏めピッキングWKへの登録を実行します。
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_DELETE_C_TOTAL_PIC_WK As String = _
                                              "DELETE                              " & vbNewLine _
                                            & "    C_TOTAL_PIC_WK                  " & vbNewLine _
                                            & "WHERE                               " & vbNewLine _
                                            & "        NRS_BR_CD  = @NRS_BR_CD     " & vbNewLine _
                                            & "    AND OUTKA_NO_L = @OUTKA_NO_L    " & vbNewLine _
                                            & "    AND OUTKA_NO_M = @OUTKA_NO_M    " & vbNewLine _
                                            & "    AND OUTKA_NO_S = @OUTKA_NO_S    " & vbNewLine



    'END Kurihara WIT対応

#End Region

#Region "ハンディ荷主情報取得"

    'KASAMA 2013.10.29 WIT対応 Start
    Private Const SQL_CUST_HANDY As String = _
              "SELECT                                                                                                                    " & vbNewLine _
            & "    cust.NRS_BR_CD                                                                                                        " & vbNewLine _
            & "    , cust.WH_CD                                                                                                          " & vbNewLine _
            & "    , cust.CUST_CD_L                                                                                                      " & vbNewLine _
            & "    , cust.CUST_NM_SHORT                                                                                                  " & vbNewLine _
            & "    , cust.FLG_01                                                                                                         " & vbNewLine _
            & "    , cust.FLG_02                                                                                                         " & vbNewLine _
            & "    , cust.FLG_03                                                                                                         " & vbNewLine _
            & "    , cust.FLG_04                                                                                                         " & vbNewLine _
            & "    , cust.FLG_05                                                                                                         " & vbNewLine _
            & "    , cust.FLG_06                                                                                                         " & vbNewLine _
            & "    , cust.FLG_07                                                                                                         " & vbNewLine _
            & "    , cust.FLG_08                                                                                                         " & vbNewLine _
            & "    , cust.FLG_09                                                                                                         " & vbNewLine _
            & "    , cust.FLG_10                                                                                                         " & vbNewLine _
            & "    , cust.FLG_11                                                                                                         " & vbNewLine _
            & "    , cust.FLG_12                                                                                                         " & vbNewLine _
            & "    , cust.FLG_13                                                                                                         " & vbNewLine _
            & "    , cust.FLG_14                                                                                                         " & vbNewLine _
            & "    , cust.FLG_15                                                                                                         " & vbNewLine _
            & "    , cust.FLG_16                                                                                                         " & vbNewLine _
            & "    , cust.FLG_17                                                                                                         " & vbNewLine _
            & "    , cust.FLG_18                                                                                                         " & vbNewLine _
            & "    , cust.FLG_19                                                                                                         " & vbNewLine _
            & "    , cust.FLG_20                                                                                                         " & vbNewLine _
            & "    , s101kbn.KBN_NM1 AS S101_KBN_NM1                                                                                     " & vbNewLine _
            & "    , s101kbn.KBN_NM2 AS S101_KBN_NM2                                                                                     " & vbNewLine _
            & "    , s101kbn.KBN_NM3 AS S101_KBN_NM3                                                                                     " & vbNewLine _
            & "    , s101kbn.KBN_NM4 AS S101_KBN_NM4                                                                                     " & vbNewLine _
            & "    , s101kbn.KBN_NM5 AS S101_KBN_NM5                                                                                     " & vbNewLine _
            & "    , s101kbn.KBN_NM6 AS S101_KBN_NM6                                                                                     " & vbNewLine _
            & "    , s101kbn.KBN_NM7 AS S101_KBN_NM7                                                                                     " & vbNewLine _
            & "    , s101kbn.KBN_NM8 AS S101_KBN_NM8                                                                                     " & vbNewLine _
            & "    , s101kbn.KBN_NM9 AS S101_KBN_NM9                                                                                     " & vbNewLine _
            & "    , s101kbn.KBN_NM10 AS S101_KBN_NM10                                                                                   " & vbNewLine _
            & "FROM                                                                                                                      " & vbNewLine _
            & "    $LM_MST$..M_CUST_HANDY cust                                                                                           " & vbNewLine _
            & "LEFT OUTER JOIN                                                                                                           " & vbNewLine _
            & "    $LM_MST$..Z_KBN s101kbn                                                                                               " & vbNewLine _
            & "ON                                                                                                                        " & vbNewLine _
            & "        cust.GOODS_KANRI_NO_FORMAT_TYPE = s101kbn.KBN_CD                                                                    " & vbNewLine _
            & "    AND s101kbn.KBN_GROUP_CD = 'S101'                                                                                     " & vbNewLine _
            & "    AND s101kbn.SYS_DEL_FLG = '0'                                                                                         " & vbNewLine _
            & "WHERE                                                                                                                     " & vbNewLine _
            & "        cust.NRS_BR_CD = @NRS_BR_CD                                                                                       " & vbNewLine _
            & "    AND cust.CUST_CD_L = @CUST_CD_L                                                                                       " & vbNewLine _
            & "    AND cust.WH_CD = (SELECT WH_CD FROM $LM_TRN$..C_OUTKA_L WHERE NRS_BR_CD = @NRS_BR_CD AND OUTKA_NO_L = @OUTKA_NO_L)    " & vbNewLine _
            & "    AND cust.SYS_DEL_FLG = '0'                                                                                            " & vbNewLine

    'KASAMA 2013.10.29 WIT対応 End

#End Region

#Region "商品管理番号採番処理"

    'START kasama WIT対応 商品管理番号採番処理
    Private Const SQL_UPDATE_GOODS_KANRI_NO As String = _
              "UPDATE                                      " & vbNewLine _
            & "    $LM_TRN$..D_ZAI_TRS                     " & vbNewLine _
            & "SET                                         " & vbNewLine _
            & "      GOODS_KANRI_NO = @GOODS_KANRI_NO      " & vbNewLine _
            & "    , SYS_UPD_PGID = @SYS_UPD_PGID          " & vbNewLine _
            & "    , SYS_UPD_USER = @SYS_UPD_USER          " & vbNewLine _
            & "    , SYS_UPD_DATE = @SYS_UPD_DATE          " & vbNewLine _
            & "    , SYS_UPD_TIME = @SYS_UPD_TIME          " & vbNewLine _
            & "WHERE                                       " & vbNewLine _
            & "        NRS_BR_CD = @NRS_BR_CD              " & vbNewLine _
            & "    AND ZAI_REC_NO = @ZAI_REC_NO            " & vbNewLine _
            & "    AND SYS_UPD_DATE = @SYS_UPD_DATE_CUR    " & vbNewLine _
            & "    AND SYS_UPD_TIME = @SYS_UPD_TIME_CUR    " & vbNewLine _
            & "                                            " & vbNewLine

    Private Const SQL_SELECT_GOODS_KANRI_NO_SRC As String = _
              "SELECT                                           " & vbNewLine _
            & "    zai.NRS_BR_CD                                " & vbNewLine _
            & "    , zai.ZAI_REC_NO                             " & vbNewLine _
            & "    , goods.GOODS_CD_CUST                        " & vbNewLine _
            & "    , zai.LOT_NO                                 " & vbNewLine _
            & "    , zai.SERIAL_NO                              " & vbNewLine _
            & "    , zai.IRIME                                  " & vbNewLine _
            & "    , zai.GOODS_CRT_DATE                         " & vbNewLine _
            & "    , goods.JAN_CD                               " & vbNewLine _
            & "FROM                                             " & vbNewLine _
            & "    $LM_TRN$..D_ZAI_TRS zai                      " & vbNewLine _
            & "LEFT OUTER JOIN                                  " & vbNewLine _
            & "    $LM_MST$..M_GOODS goods                      " & vbNewLine _
            & "ON                                               " & vbNewLine _
            & "        zai.NRS_BR_CD = goods.NRS_BR_CD          " & vbNewLine _
            & "    AND zai.GOODS_CD_NRS = goods.GOODS_CD_NRS    " & vbNewLine _
            & "    AND goods.SYS_DEL_FLG = '0'                  " & vbNewLine _
            & "WHERE                                            " & vbNewLine _
            & "        zai.NRS_BR_CD = @NRS_BR_CD               " & vbNewLine _
            & "    AND zai.ZAI_REC_NO = @ZAI_REC_NO             " & vbNewLine _
            & "    AND ISNULL(zai.GOODS_KANRI_NO, '') = ''      " & vbNewLine _
            & "    AND zai.SYS_DEL_FLG = '0'                    " & vbNewLine _
            & "                                                 " & vbNewLine
    'START kasama WIT対応 商品管理番号採番処理

#End Region

#End Region

    '2014.04.21 CALT対応 黎 --ST--
#Region "CALT対応"
#Region "Select"
    ''' <summary>
    ''' 出荷LMSデータ取得
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_SELECT_OUTKA_LMS As String = _
              "SELECT                                                              " & vbNewLine _
            & "     CL.NRS_BR_CD             AS NRS_BR_CD                          " & vbNewLine _
            & "    ,CL.OUTKA_NO_L            AS OUTKA_NO_L                         " & vbNewLine _
            & "    ,CM.OUTKA_NO_M            AS OUTKA_NO_M                         " & vbNewLine _
            & "    ,CS.OUTKA_NO_S            AS OUTKA_NO_S                         " & vbNewLine _
            & "    ,CASE                                                           " & vbNewLine _
            & "      WHEN IsNull(GET_MAX_SEQ.SEND_SEQ,0) = 0                       " & vbNewLine _
            & "          THEN 1                                                    " & vbNewLine _
            & "         ELSE  GET_MAX_SEQ.SEND_SEQ + 2                             " & vbNewLine _
            & "        END                      AS SEND_SEQ                        " & vbNewLine _
            & "    ,CASE                                                           " & vbNewLine _
            & "      WHEN IsNull(GET_MAX_SEQ.NRS_BR_CD,'') = ''                    " & vbNewLine _
            & "       THEN '0'                                                     " & vbNewLine _
            & "      ELSE '1'                                                      " & vbNewLine _
            & "     END                      AS DATA_KBN                           " & vbNewLine _
            & "    ,CL.WH_CD                 AS WH_CD                              " & vbNewLine _
            & "    ,CL.CUST_CD_L             AS CUST_CD_L                          " & vbNewLine _
            & "    ,CL.CUST_CD_M             AS CUST_CD_M                          " & vbNewLine _
            & "    ,MCUS.CUST_NM_L           AS CUST_NM_L                          " & vbNewLine _
            & "    ,CL.OUTKA_PLAN_DATE       AS OUTKA_PLAN_DATE                    " & vbNewLine _
            & "    ,CL.ARR_PLAN_DATE         AS ARR_PLAN_DATE                      " & vbNewLine _
            & "    ,CL.DEST_CD               AS DEST_CD                            " & vbNewLine _
            & "    ,MDST.DEST_NM             AS DEST_NM                            " & vbNewLine _
            & "    ,MDST.AD_1                AS DEST_AD_1                          " & vbNewLine _
            & "    ,MDST.AD_2                AS DEST_AD_2                          " & vbNewLine _
            & "    ,MDST.AD_3                AS DEST_AD_3                          " & vbNewLine _
            & "    ,MDST.TEL                 AS DEST_TEL                           " & vbNewLine _
            & "    ,MDST.ZIP                 AS ZIP                                " & vbNewLine _
            & "    ,CL.CUST_ORD_NO           AS CUST_ORD_NO                        " & vbNewLine _
            & "    ,CL.BUYER_ORD_NO          AS BUYER_ORD_NO                       " & vbNewLine _
            & "    ,CL.REMARK                AS REMARK_L                           " & vbNewLine _
            & "    ,CM.GOODS_CD_NRS          AS GOODS_CD_NRS                       " & vbNewLine _
            & "    ,MGDS.GOODS_CD_CUST       AS GOODS_CD_CUST                      " & vbNewLine _
            & "    ,MGDS.GOODS_NM_1          AS GOODS_NM_1                         " & vbNewLine _
            & "    ,CM.REMARK                AS REMARK_M                           " & vbNewLine _
            & "    ,CS.LOT_NO                AS LOT_NO                             " & vbNewLine _
            & "    ,CS.SERIAL_NO             AS SERIAL_NO                          " & vbNewLine _
            & "    ,CS.ALCTD_NB              AS OUTKA_NB                           " & vbNewLine _
            & "    ,CS.ALCTD_NB * CS.BETU_WT AS OUTKA_QT                           " & vbNewLine _
            & "    ,CS.OUTKA_TTL_NB          AS OUTKA_TTL_NB                       " & vbNewLine _
            & "    ,CS.OUTKA_TTL_QT          AS OUTKA_TTL_QT                       " & vbNewLine _
            & "    ,CS.ALCTD_NB              AS ALCTD_NB                           " & vbNewLine _
            & "    ,CS.ALCTD_QT              AS ALCTD_QT                           " & vbNewLine _
            & "    ,CS.IRIME                 AS IRIME                              " & vbNewLine _
            & "    ,CS.BETU_WT               AS BETU_WT                            " & vbNewLine _
            & "    ,CS.REMARK                AS REMARK_S                           " & vbNewLine _
            & "    ,MGDS.PKG_NB              AS PKG_NB                             " & vbNewLine _
            & "    ,MGDS.PKG_UT              AS PKG_UT                             " & vbNewLine _
            & "    ,DZT.ZAI_REC_NO           AS ZAI_REC_NO                         " & vbNewLine _
            & "    ,DZT.GOODS_COND_KB_1      AS GOODS_COND_KB_1                    " & vbNewLine _
            & "    ,DZT.GOODS_COND_KB_2      AS GOODS_COND_KB_2                    " & vbNewLine _
            & "    ,DZT.GOODS_COND_KB_3      AS GOODS_COND_KB_3                    " & vbNewLine _
            & "    ,DZT.GOODS_CRT_DATE       AS GOODS_CRT_DATE                     " & vbNewLine _
            & "    ,DZT.LT_DATE              AS LT_DATE                            " & vbNewLine _
            & "    ,DZT.SPD_KB               AS SPD_KB                             " & vbNewLine _
            & "    ,DZT.OFB_KB               AS OFB_KB                             " & vbNewLine _
            & "    ,DZT.DEST_CD_P            AS DEST_CD_P                          " & vbNewLine _
            & "    ,'2'                      AS SEND_SHORI_FLG                     " & vbNewLine _
            & "    ,'0'                      AS SYS_DEL_FLG                        " & vbNewLine _
            & "FROM $LM_TRN$..C_OUTKA_L     AS CL                                  " & vbNewLine _
            & "LEFT JOIN					                       				   " & vbNewLine _
            & "     $LM_TRN$..C_OUTKA_M     AS CM                                  " & vbNewLine _
            & "  ON CM.SYS_DEL_FLG           = '0'                                 " & vbNewLine _
            & " AND CL.NRS_BR_CD             = CM.NRS_BR_CD                        " & vbNewLine _
            & " AND CL.OUTKA_NO_L            = CM.OUTKA_NO_L                       " & vbNewLine _
            & "LEFT JOIN					                       				   " & vbNewLine _
            & "     $LM_TRN$..C_OUTKA_S     AS CS                                  " & vbNewLine _
            & "  ON CS.SYS_DEL_FLG           = '0'                                 " & vbNewLine _
            & " AND CL.NRS_BR_CD             = CS.NRS_BR_CD                        " & vbNewLine _
            & " AND CL.OUTKA_NO_L            = CS.OUTKA_NO_L                       " & vbNewLine _
            & " AND CM.OUTKA_NO_M            = CS.OUTKA_NO_M                       " & vbNewLine _
            & " LEFT JOIN                                                          " & vbNewLine _
            & "     (                                                              " & vbNewLine _
            & "       SELECT                                                       " & vbNewLine _
            & "             CODS_IN2.NRS_BR_CD                 AS NRS_BR_CD        " & vbNewLine _
            & "            ,CODS_IN2.OUTKA_NO_L                AS OUTKA_NO_L       " & vbNewLine _
            & "            ,CODS_IN2.OUTKA_NO_M                AS OUTKA_NO_M       " & vbNewLine _
            & "            ,CODS_IN2.OUTKA_NO_S                AS OUTKA_NO_S       " & vbNewLine _
            & "            ,MAX(GET_SEQ.SEND_SEQ)              AS SEND_SEQ         " & vbNewLine _
            & "       FROM $LM_TRN$..C_OUTKA_DIRECT_SEND      AS CODS_IN2          " & vbNewLine _
            & "       LEFT JOIN                                                    " & vbNewLine _
            & "           (                                                        " & vbNewLine _
            & "             SELECT                                                 " & vbNewLine _
            & "                   CODS_IN1.NRS_BR_CD            AS NRS_BR_CD       " & vbNewLine _
            & "                  ,CODS_IN1.OUTKA_NO_L           AS OUTKA_NO_L      " & vbNewLine _
            & "                  ,CODS_IN1.OUTKA_NO_M           AS OUTKA_NO_M      " & vbNewLine _
            & "                  ,CODS_IN1.OUTKA_NO_S           AS OUTKA_NO_S      " & vbNewLine _
            & "                  ,CODS_IN1.SEND_SEQ             AS SEND_SEQ        " & vbNewLine _
            & "             FROM $LM_TRN$..C_OUTKA_DIRECT_SEND AS CODS_IN1         " & vbNewLine _
            & "             WHERE                                                  " & vbNewLine _
            & "                   CODS_IN1.SYS_DEL_FLG           = '0'             " & vbNewLine _
            & "               AND CODS_IN1.NRS_BR_CD             = @NRS_BR_CD  --@ " & vbNewLine _
            & "               AND CODS_IN1.OUTKA_NO_L            = @OUTKA_NO_L --@ " & vbNewLine _
            & "               AND CODS_IN1.DATA_KBN             <> '2'             " & vbNewLine _
            & "             GROUP BY                                               " & vbNewLine _
            & "                   CODS_IN1.NRS_BR_CD                               " & vbNewLine _
            & "                  ,CODS_IN1.OUTKA_NO_L                              " & vbNewLine _
            & "                  ,CODS_IN1.OUTKA_NO_M                              " & vbNewLine _
            & "                  ,CODS_IN1.OUTKA_NO_S                              " & vbNewLine _
            & "                  ,CODS_IN1.SEND_SEQ                                " & vbNewLine _
            & "            ) AS GET_SEQ                                            " & vbNewLine _
            & "          ON CODS_IN2.NRS_BR_CD              = GET_SEQ.NRS_BR_CD    " & vbNewLine _
            & "         AND CODS_IN2.OUTKA_NO_L             = GET_SEQ.OUTKA_NO_L   " & vbNewLine _
            & "         AND CODS_IN2.OUTKA_NO_M             = GET_SEQ.OUTKA_NO_M   " & vbNewLine _
            & "         AND CODS_IN2.OUTKA_NO_S             = GET_SEQ.OUTKA_NO_S   " & vbNewLine _
            & "       WHERE                                                        " & vbNewLine _
            & "             CODS_IN2.SYS_DEL_FLG            = '0'                  " & vbNewLine _
            & "         AND CODS_IN2.NRS_BR_CD              = @NRS_BR_CD   --@     " & vbNewLine _
            & "         AND CODS_IN2.OUTKA_NO_L             = @OUTKA_NO_L  --@     " & vbNewLine _
            & "         AND CODS_IN2.DATA_KBN              <> '2'                  " & vbNewLine _
            & "       GROUP BY                                                     " & vbNewLine _
            & "             CODS_IN2.NRS_BR_CD                                     " & vbNewLine _
            & "            ,CODS_IN2.OUTKA_NO_L                                    " & vbNewLine _
            & "            ,CODS_IN2.OUTKA_NO_M                                    " & vbNewLine _
            & "            ,CODS_IN2.OUTKA_NO_S                                    " & vbNewLine _
            & "     ) AS GET_MAX_SEQ                                               " & vbNewLine _
            & "   ON CL.NRS_BR_CD  = GET_MAX_SEQ.NRS_BR_CD                         " & vbNewLine _
            & "  AND CL.OUTKA_NO_L = GET_MAX_SEQ.OUTKA_NO_L                        " & vbNewLine _
            & "  AND CM.OUTKA_NO_M = GET_MAX_SEQ.OUTKA_NO_M                        " & vbNewLine _
            & "  AND CS.OUTKA_NO_S = GET_MAX_SEQ.OUTKA_NO_S                        " & vbNewLine _
            & "LEFT JOIN                                                           " & vbNewLine _
            & "     $LM_MST$..M_CUST           AS MCUS                             " & vbNewLine _
            & "  ON MCUS.SYS_DEL_FLG          = '0'                                " & vbNewLine _
            & " AND CL.NRS_BR_CD              = MCUS.NRS_BR_CD                     " & vbNewLine _
            & " AND CL.CUST_CD_L              = MCUS.CUST_CD_L                     " & vbNewLine _
            & " AND CL.CUST_CD_M              = MCUS.CUST_CD_M                     " & vbNewLine _
            & " AND MCUS.CUST_CD_S            = '00'                               " & vbNewLine _
            & " AND MCUS.CUST_CD_SS           = '00'                               " & vbNewLine _
            & "LEFT JOIN			                                       		   " & vbNewLine _
            & "     $LM_MST$..M_DEST           AS MDST                             " & vbNewLine _
            & "  ON MDST.SYS_DEL_FLG          = '0'                                " & vbNewLine _
            & " AND CL.NRS_BR_CD              = MDST.NRS_BR_CD                     " & vbNewLine _
            & " AND CL.CUST_CD_L              = MDST.CUST_CD_L                     " & vbNewLine _
            & " AND CL.DEST_CD                = MDST.DEST_CD                       " & vbNewLine _
            & "LEFT JOIN			                                       		   " & vbNewLine _
            & "     $LM_MST$..M_GOODS          AS MGDS                             " & vbNewLine _
            & "  ON MGDS.SYS_DEL_FLG          = '0'                                " & vbNewLine _
            & " AND CL.NRS_BR_CD              = MGDS.NRS_BR_CD                     " & vbNewLine _
            & " AND CM.GOODS_CD_NRS           = MGDS.GOODS_CD_NRS                  " & vbNewLine _
            & "LEFT JOIN					                       				   " & vbNewLine _
            & "     $LM_TRN$..D_ZAI_TRS     AS DZT                                 " & vbNewLine _
            & "  ON DZT.SYS_DEL_FLG           = '0'                                " & vbNewLine _
            & " AND CL.NRS_BR_CD              = DZT.NRS_BR_CD                      " & vbNewLine _
            & " AND CS.ZAI_REC_NO             = DZT.ZAI_REC_NO                     " & vbNewLine _
            & " WHERE						               						   " & vbNewLine _
            & "     CL.SYS_DEL_FLG            = '0'                                " & vbNewLine _
            & " AND CL.OUTKA_STATE_KB         <> '10'                              " & vbNewLine _
            & " AND CL.NRS_BR_CD              = @NRS_BR_CD                         " & vbNewLine _
            & " AND CL.OUTKA_NO_L             = @OUTKA_NO_L        --@             " & vbNewLine _
            & " AND CL.SYS_UPD_DATE           = @GUI_SYS_UPD_DATE  --@             " & vbNewLine _
            & " AND CL.SYS_UPD_TIME           = @GUI_SYS_UPD_TIME  --@             " & vbNewLine

    ''' <summary>
    ''' 出荷LMSキャンセルデータ取得
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_SELECT_OUTKA_LMS_CANCEL As String = _
             "SELECT                                                                 " & vbNewLine _
           & "     CODS.NRS_BR_CD                             AS NRS_BR_CD           " & vbNewLine _
           & "    ,CODS.OUTKA_NO_L                            AS OUTKA_NO_L          " & vbNewLine _
           & "    ,CODS.OUTKA_NO_M                            AS OUTKA_NO_M          " & vbNewLine _
           & "    ,CODS.OUTKA_NO_S                            AS OUTKA_NO_S          " & vbNewLine _
           & "    ,CODS.SEND_SEQ + 1                          AS SEND_SEQ            " & vbNewLine _
           & "    ,'2'                                        AS DATA_KBN            " & vbNewLine _
           & "    ,CODS.WH_CD                                 AS WH_CD               " & vbNewLine _
           & "    ,CODS.CUST_CD_L                             AS CUST_CD_L           " & vbNewLine _
           & "    ,CODS.CUST_CD_M                             AS CUST_CD_M           " & vbNewLine _
           & "    ,CODS.CUST_NM_L                             AS CUST_NM_L           " & vbNewLine _
           & "    ,CODS.OUTKA_PLAN_DATE                       AS OUTKA_PLAN_DATE     " & vbNewLine _
           & "    ,CODS.ARR_PLAN_DATE                         AS ARR_PLAN_DATE       " & vbNewLine _
           & "    ,CODS.DEST_CD                               AS DEST_CD             " & vbNewLine _
           & "    ,CODS.DEST_NM                               AS DEST_NM             " & vbNewLine _
           & "    ,CODS.DEST_AD_1                             AS DEST_AD_1           " & vbNewLine _
           & "    ,CODS.DEST_AD_2                             AS DEST_AD_2           " & vbNewLine _
           & "    ,CODS.DEST_AD_3                             AS DEST_AD_3           " & vbNewLine _
           & "    ,CODS.DEST_TEL                              AS DEST_TEL            " & vbNewLine _
           & "    ,CODS.ZIP                                   AS ZIP                 " & vbNewLine _
           & "    ,CODS.CUST_ORD_NO                           AS CUST_ORD_NO         " & vbNewLine _
           & "    ,CODS.BUYER_ORD_NO                          AS BUYER_ORD_NO        " & vbNewLine _
           & "    ,CODS.REMARK_L                              AS REMARK_L            " & vbNewLine _
           & "    ,CODS.GOODS_CD_NRS                          AS GOODS_CD_NRS        " & vbNewLine _
           & "    ,CODS.GOODS_CD_CUST                         AS GOODS_CD_CUST       " & vbNewLine _
           & "    ,CODS.GOODS_NM_1                            AS GOODS_NM_1          " & vbNewLine _
           & "    ,CODS.REMARK_M                              AS REMARK_M            " & vbNewLine _
           & "    ,CODS.LOT_NO                                AS LOT_NO              " & vbNewLine _
           & "    ,CODS.SERIAL_NO                             AS SERIAL_NO           " & vbNewLine _
           & "    ,CODS.OUTKA_NB                              AS OUTKA_NB            " & vbNewLine _
           & "    ,CODS.OUTKA_QT                              AS OUTKA_QT            " & vbNewLine _
           & "    ,CODS.OUTKA_TTL_NB                          AS OUTKA_TTL_NB        " & vbNewLine _
           & "    ,CODS.OUTKA_TTL_QT                          AS OUTKA_TTL_QT        " & vbNewLine _
           & "    ,CODS.ALCTD_NB                              AS ALCTD_NB            " & vbNewLine _
           & "    ,CODS.ALCTD_QT                              AS ALCTD_QT            " & vbNewLine _
           & "    ,CODS.IRIME                                 AS IRIME               " & vbNewLine _
           & "    ,CODS.BETU_WT                               AS BETU_WT             " & vbNewLine _
           & "    ,CODS.REMARK_S                              AS REMARK_S            " & vbNewLine _
           & "    ,CODS.PKG_NB                                AS PKG_NB              " & vbNewLine _
           & "    ,CODS.PKG_UT                                AS PKG_UT              " & vbNewLine _
           & "    ,CODS.ZAI_REC_NO                            AS ZAI_REC_NO          " & vbNewLine _
           & "    ,CODS.GOODS_COND_KB_1                       AS GOODS_COND_KB_1     " & vbNewLine _
           & "    ,CODS.GOODS_COND_KB_2                       AS GOODS_COND_KB_2     " & vbNewLine _
           & "    ,CODS.GOODS_COND_KB_3                       AS GOODS_COND_KB_3     " & vbNewLine _
           & "    ,CODS.GOODS_CRT_DATE                        AS GOODS_CRT_DATE      " & vbNewLine _
           & "    ,CODS.LT_DATE                               AS LT_DATE             " & vbNewLine _
           & "    ,CODS.SPD_KB                                AS SPD_KB              " & vbNewLine _
           & "    ,CODS.OFB_KB                                AS OFB_KB              " & vbNewLine _
           & "    ,CODS.DEST_CD_P                             AS DEST_CD_P           " & vbNewLine _
           & "    ,'2'                                        AS SEND_SHORI_FLG      " & vbNewLine _
           & "    ,CODS.SEND_USER                             AS SEND_USER           " & vbNewLine _
           & "    ,CODS.SEND_DATE                             AS SEND_DATE           " & vbNewLine _
           & "    ,CODS.SEND_TIME                             AS SEND_TIME           " & vbNewLine _
           & "    ,CODS.SYS_ENT_DATE                          AS SYS_ENT_DATE        " & vbNewLine _
           & "    ,CODS.SYS_ENT_TIME                          AS SYS_ENT_TIME        " & vbNewLine _
           & "    ,CODS.SYS_ENT_PGID                          AS SYS_ENT_PGID        " & vbNewLine _
           & "    ,CODS.SYS_ENT_USER                          AS SYS_ENT_USER        " & vbNewLine _
           & "    ,CODS.SYS_UPD_DATE                          AS SYS_UPD_DATE        " & vbNewLine _
           & "    ,CODS.SYS_UPD_TIME                          AS SYS_UPD_TIME        " & vbNewLine _
           & "    ,CODS.SYS_UPD_PGID                          AS SYS_UPD_PGID        " & vbNewLine _
           & "    ,CODS.SYS_UPD_USER                          AS SYS_UPD_USER        " & vbNewLine _
           & "    ,'1'                                        AS SYS_DEL_FLG         " & vbNewLine _
           & " FROM $LM_TRN$..C_OUTKA_DIRECT_SEND             AS CODS                " & vbNewLine _
           & " LEFT JOIN                                                             " & vbNewLine _
           & "     (                                                                 " & vbNewLine _
           & "       SELECT                                                          " & vbNewLine _
           & "             CODS_IN2.NRS_BR_CD                 AS NRS_BR_CD           " & vbNewLine _
           & "            ,CODS_IN2.OUTKA_NO_L                AS OUTKA_NO_L          " & vbNewLine _
           & "            ,CODS_IN2.OUTKA_NO_M                AS OUTKA_NO_M          " & vbNewLine _
           & "            ,CODS_IN2.OUTKA_NO_S                AS OUTKA_NO_S          " & vbNewLine _
           & "            ,MAX(GET_SEQ.SEND_SEQ)              AS SEND_SEQ            " & vbNewLine _
           & "       FROM $LM_TRN$..C_OUTKA_DIRECT_SEND       AS CODS_IN2            " & vbNewLine _
           & "       LEFT JOIN                                                       " & vbNewLine _
           & "           (                                                           " & vbNewLine _
           & "             SELECT                                                    " & vbNewLine _
           & "                   CODS_IN1.NRS_BR_CD              AS NRS_BR_CD        " & vbNewLine _
           & "                  ,CODS_IN1.OUTKA_NO_L             AS OUTKA_NO_L       " & vbNewLine _
           & "                  ,CODS_IN1.OUTKA_NO_M             AS OUTKA_NO_M       " & vbNewLine _
           & "                  ,CODS_IN1.OUTKA_NO_S             AS OUTKA_NO_S       " & vbNewLine _
           & "                  ,CODS_IN1.SEND_SEQ               AS SEND_SEQ         " & vbNewLine _
           & "             FROM $LM_TRN$..C_OUTKA_DIRECT_SEND    AS CODS_IN1         " & vbNewLine _
           & "             WHERE                                                     " & vbNewLine _
           & "                   CODS_IN1.SYS_DEL_FLG             = '0'              " & vbNewLine _
           & "               AND CODS_IN1.NRS_BR_CD               = @NRS_BR_CD   --@ " & vbNewLine _
           & "               AND CODS_IN1.OUTKA_NO_L              = @OUTKA_NO_L  --@ " & vbNewLine _
           & "               AND CODS_IN1.DATA_KBN               <> '2'              " & vbNewLine _
           & "             GROUP BY                                                  " & vbNewLine _
           & "                   CODS_IN1.NRS_BR_CD                                  " & vbNewLine _
           & "                  ,CODS_IN1.OUTKA_NO_L                                 " & vbNewLine _
           & "                  ,CODS_IN1.OUTKA_NO_M                                 " & vbNewLine _
           & "                  ,CODS_IN1.OUTKA_NO_S                                 " & vbNewLine _
           & "                  ,CODS_IN1.SEND_SEQ                                   " & vbNewLine _
           & "            ) AS GET_SEQ                                               " & vbNewLine _
           & "          ON CODS_IN2.NRS_BR_CD              = GET_SEQ.NRS_BR_CD       " & vbNewLine _
           & "         AND CODS_IN2.OUTKA_NO_L             = GET_SEQ.OUTKA_NO_L      " & vbNewLine _
           & "         AND CODS_IN2.OUTKA_NO_M             = GET_SEQ.OUTKA_NO_M      " & vbNewLine _
           & "         AND CODS_IN2.OUTKA_NO_S             = GET_SEQ.OUTKA_NO_S      " & vbNewLine _
           & "       WHERE                                                           " & vbNewLine _
           & "             CODS_IN2.SYS_DEL_FLG            = '0'                     " & vbNewLine _
           & "         AND CODS_IN2.NRS_BR_CD              = @NRS_BR_CD   --@        " & vbNewLine _
           & "         AND CODS_IN2.OUTKA_NO_L             = @OUTKA_NO_L  --@        " & vbNewLine _
           & "         AND CODS_IN2.DATA_KBN              <> '2'                     " & vbNewLine _
           & "       GROUP BY                                                        " & vbNewLine _
           & "             CODS_IN2.NRS_BR_CD                                        " & vbNewLine _
           & "            ,CODS_IN2.OUTKA_NO_L                                       " & vbNewLine _
           & "            ,CODS_IN2.OUTKA_NO_M                                       " & vbNewLine _
           & "            ,CODS_IN2.OUTKA_NO_S                                       " & vbNewLine _
           & "     ) AS MAX_SEQ                                                      " & vbNewLine _
           & "   ON CODS.NRS_BR_CD    = MAX_SEQ.NRS_BR_CD                            " & vbNewLine _
           & "  AND CODS.OUTKA_NO_L    = MAX_SEQ.OUTKA_NO_L                          " & vbNewLine _
           & "  AND CODS.OUTKA_NO_M    = MAX_SEQ.OUTKA_NO_M                          " & vbNewLine _
           & "  AND CODS.OUTKA_NO_S    = MAX_SEQ.OUTKA_NO_S                          " & vbNewLine _
           & "  AND CODS.SEND_SEQ     = MAX_SEQ.SEND_SEQ                             " & vbNewLine _
           & " LEFT JOIN                                                             " & vbNewLine _
           & "     (                                                                 " & vbNewLine _
           & "       SELECT                                                          " & vbNewLine _
           & "             CODS_IN3.NRS_BR_CD             AS NRS_BR_CD               " & vbNewLine _
           & "            ,CODS_IN3.OUTKA_NO_L            AS OUTKA_NO_L              " & vbNewLine _
           & "            ,CODS_IN3.OUTKA_NO_M            AS OUTKA_NO_M              " & vbNewLine _
           & "            ,CODS_IN3.OUTKA_NO_S            AS OUTKA_NO_S              " & vbNewLine _
           & "            ,CONVERT(INTEGER,MAX(CODS_IN3.SEND_SEQ)) + 1  AS SEND_SEQ  " & vbNewLine _
           & "       FROM $LM_TRN$..C_OUTKA_DIRECT_SEND   AS CODS_IN3                " & vbNewLine _
           & "       WHERE                                                           " & vbNewLine _
           & "             CODS_IN3.NRS_BR_CD              = @NRS_BR_CD  --@         " & vbNewLine _
           & "         AND CODS_IN3.OUTKA_NO_L             = @OUTKA_NO_L --@         " & vbNewLine _
           & "       GROUP BY                                                        " & vbNewLine _
           & "             CODS_IN3.NRS_BR_CD                                        " & vbNewLine _
           & "            ,CODS_IN3.OUTKA_NO_L                                       " & vbNewLine _
           & "            ,CODS_IN3.OUTKA_NO_M                                       " & vbNewLine _
           & "            ,CODS_IN3.OUTKA_NO_S                                       " & vbNewLine _
           & "     )                          AS GET_MAX_SEQ                         " & vbNewLine _
           & "   ON CODS.NRS_BR_CD             = GET_MAX_SEQ.NRS_BR_CD               " & vbNewLine _
           & "  AND CODS.OUTKA_NO_L            = GET_MAX_SEQ.OUTKA_NO_L              " & vbNewLine _
           & "  AND CODS.OUTKA_NO_M            = GET_MAX_SEQ.OUTKA_NO_M              " & vbNewLine _
           & "  AND CODS.OUTKA_NO_S            = GET_MAX_SEQ.OUTKA_NO_S              " & vbNewLine _
           & "  AND (CODS.SEND_SEQ +1)         = GET_MAX_SEQ.SEND_SEQ                " & vbNewLine _
           & " WHERE                                                                 " & vbNewLine _
           & "      CODS.SYS_DEL_FLG           = '0'                                 " & vbNewLine _
           & "  AND CODS.NRS_BR_CD             = @NRS_BR_CD   --@                    " & vbNewLine _
           & "  AND CODS.OUTKA_NO_L            = @OUTKA_NO_L  --@                    " & vbNewLine _
           & "  AND GET_MAX_SEQ.SEND_SEQ      IS NOT NULL                            " & vbNewLine _
           & "  AND MAX_SEQ.OUTKA_NO_L        IS NOT NULL                            " & vbNewLine

    ''' <summary>
    ''' 出荷指示キャンセルデータオーダバイ句
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_OUTKA_LMS_CANCEL_ORDER_BY As String = _
             " ORDER BY                                                              " & vbNewLine _
           & "      CODS.NRS_BR_CD  ASC                                              " & vbNewLine _
           & "     ,CODS.OUTKA_NO_L ASC                                              " & vbNewLine _
           & "     ,CODS.OUTKA_NO_M ASC                                              " & vbNewLine _
           & "     ,CODS.OUTKA_NO_S ASC                                              " & vbNewLine _
           & "     ,CODS.SEND_SEQ   ASC                                              " & vbNewLine
#End Region

#Region "Insert"
    Private Const SQL_INSERT_DIRECT_SEND As String = _
          "INSERT INTO $LM_TRN$..C_OUTKA_DIRECT_SEND  " & vbNewLine _
        & "       (                                   " & vbNewLine _
        & "         NRS_BR_CD                         " & vbNewLine _
        & "        ,OUTKA_NO_L                        " & vbNewLine _
        & "        ,OUTKA_NO_M                        " & vbNewLine _
        & "        ,OUTKA_NO_S                        " & vbNewLine _
        & "        ,SEND_SEQ                          " & vbNewLine _
        & "        ,DATA_KBN                          " & vbNewLine _
        & "        ,WH_CD                             " & vbNewLine _
        & "        ,CUST_CD_L                         " & vbNewLine _
        & "        ,CUST_CD_M                         " & vbNewLine _
        & "        ,CUST_NM_L                         " & vbNewLine _
        & "        ,OUTKA_PLAN_DATE                   " & vbNewLine _
        & "        ,ARR_PLAN_DATE                     " & vbNewLine _
        & "        ,DEST_CD                           " & vbNewLine _
        & "        ,DEST_NM                           " & vbNewLine _
        & "        ,DEST_AD_1                         " & vbNewLine _
        & "        ,DEST_AD_2                         " & vbNewLine _
        & "        ,DEST_AD_3                         " & vbNewLine _
        & "        ,DEST_TEL                          " & vbNewLine _
        & "        ,ZIP                               " & vbNewLine _
        & "        ,CUST_ORD_NO                       " & vbNewLine _
        & "        ,BUYER_ORD_NO                      " & vbNewLine _
        & "        ,REMARK_L                          " & vbNewLine _
        & "        ,GOODS_CD_NRS                      " & vbNewLine _
        & "        ,GOODS_CD_CUST                     " & vbNewLine _
        & "        ,GOODS_NM_1                        " & vbNewLine _
        & "        ,REMARK_M                          " & vbNewLine _
        & "        ,LOT_NO                            " & vbNewLine _
        & "        ,SERIAL_NO                         " & vbNewLine _
        & "        ,OUTKA_NB                          " & vbNewLine _
        & "        ,OUTKA_QT                          " & vbNewLine _
        & "        ,OUTKA_TTL_NB                      " & vbNewLine _
        & "        ,OUTKA_TTL_QT                      " & vbNewLine _
        & "        ,ALCTD_NB                          " & vbNewLine _
        & "        ,ALCTD_QT                          " & vbNewLine _
        & "        ,IRIME                             " & vbNewLine _
        & "        ,BETU_WT                           " & vbNewLine _
        & "        ,REMARK_S                          " & vbNewLine _
        & "        ,PKG_NB                            " & vbNewLine _
        & "        ,PKG_UT                            " & vbNewLine _
        & "        ,ZAI_REC_NO                        " & vbNewLine _
        & "        ,GOODS_COND_KB_1                   " & vbNewLine _
        & "        ,GOODS_COND_KB_2                   " & vbNewLine _
        & "        ,GOODS_COND_KB_3                   " & vbNewLine _
        & "        ,GOODS_CRT_DATE                    " & vbNewLine _
        & "        ,LT_DATE                           " & vbNewLine _
        & "        ,SPD_KB                            " & vbNewLine _
        & "        ,OFB_KB                            " & vbNewLine _
        & "        ,DEST_CD_P                         " & vbNewLine _
        & "        ,SEND_SHORI_FLG                    " & vbNewLine _
        & "        ,SYS_ENT_DATE                      " & vbNewLine _
        & "        ,SYS_ENT_TIME                      " & vbNewLine _
        & "        ,SYS_ENT_PGID                      " & vbNewLine _
        & "        ,SYS_ENT_USER                      " & vbNewLine _
        & "        ,SYS_UPD_DATE                      " & vbNewLine _
        & "        ,SYS_UPD_TIME                      " & vbNewLine _
        & "        ,SYS_UPD_PGID                      " & vbNewLine _
        & "        ,SYS_UPD_USER                      " & vbNewLine _
        & "        ,SYS_DEL_FLG                       " & vbNewLine _
        & "       )                                   " & vbNewLine _
        & " VALUES(                                   " & vbNewLine _
        & "         @NRS_BR_CD                        " & vbNewLine _
        & "        ,@OUTKA_NO_L                       " & vbNewLine _
        & "        ,@OUTKA_NO_M                       " & vbNewLine _
        & "        ,@OUTKA_NO_S                       " & vbNewLine _
        & "        ,@SEND_SEQ                         " & vbNewLine _
        & "        ,@DATA_KBN                         " & vbNewLine _
        & "        ,@WH_CD                            " & vbNewLine _
        & "        ,@CUST_CD_L                        " & vbNewLine _
        & "        ,@CUST_CD_M                        " & vbNewLine _
        & "        ,@CUST_NM_L                        " & vbNewLine _
        & "        ,@OUTKA_PLAN_DATE                  " & vbNewLine _
        & "        ,@ARR_PLAN_DATE                    " & vbNewLine _
        & "        ,@DEST_CD                          " & vbNewLine _
        & "        ,@DEST_NM                          " & vbNewLine _
        & "        ,@DEST_AD_1                        " & vbNewLine _
        & "        ,@DEST_AD_2                        " & vbNewLine _
        & "        ,@DEST_AD_3                        " & vbNewLine _
        & "        ,@DEST_TEL                         " & vbNewLine _
        & "        ,@ZIP                              " & vbNewLine _
        & "        ,@CUST_ORD_NO                      " & vbNewLine _
        & "        ,@BUYER_ORD_NO                     " & vbNewLine _
        & "        ,@REMARK_L                         " & vbNewLine _
        & "        ,@GOODS_CD_NRS                     " & vbNewLine _
        & "        ,@GOODS_CD_CUST                    " & vbNewLine _
        & "        ,@GOODS_NM_1                       " & vbNewLine _
        & "        ,@REMARK_M                         " & vbNewLine _
        & "        ,@LOT_NO                           " & vbNewLine _
        & "        ,@SERIAL_NO                        " & vbNewLine _
        & "        ,@OUTKA_NB                         " & vbNewLine _
        & "        ,@OUTKA_QT                         " & vbNewLine _
        & "        ,@OUTKA_TTL_NB                     " & vbNewLine _
        & "        ,@OUTKA_TTL_QT                     " & vbNewLine _
        & "        ,@ALCTD_NB                         " & vbNewLine _
        & "        ,@ALCTD_QT                         " & vbNewLine _
        & "        ,@IRIME                            " & vbNewLine _
        & "        ,@BETU_WT                          " & vbNewLine _
        & "        ,@REMARK_S                         " & vbNewLine _
        & "        ,@PKG_NB                           " & vbNewLine _
        & "        ,@PKG_UT                           " & vbNewLine _
        & "        ,@ZAI_REC_NO                       " & vbNewLine _
        & "        ,@GOODS_COND_KB_1                  " & vbNewLine _
        & "        ,@GOODS_COND_KB_2                  " & vbNewLine _
        & "        ,@GOODS_COND_KB_3                  " & vbNewLine _
        & "        ,@GOODS_CRT_DATE                   " & vbNewLine _
        & "        ,@LT_DATE                          " & vbNewLine _
        & "        ,@SPD_KB                           " & vbNewLine _
        & "        ,@OFB_KB                           " & vbNewLine _
        & "        ,@DEST_CD_P                        " & vbNewLine _
        & "        ,@SEND_SHORI_FLG                   " & vbNewLine _
        & "        ,@SYS_DATE                         " & vbNewLine _
        & "        ,@SYS_TIME                         " & vbNewLine _
        & "        ,@SYS_PGID                         " & vbNewLine _
        & "        ,@SYS_USER                         " & vbNewLine _
        & "        ,@SYS_DATE                         " & vbNewLine _
        & "        ,@SYS_TIME                         " & vbNewLine _
        & "        ,@SYS_PGID                         " & vbNewLine _
        & "        ,@SYS_USER                         " & vbNewLine _
        & "        ,@SYS_DEL_FLG                      " & vbNewLine _
        & "       )                                   " & vbNewLine
#End Region

#End Region
    '2014.04.21 CALT対応 黎 --ED--

    '2015.06.22 協立化学　作業料対応 START

#Region "出荷データ排他チェック"

    ''' <summary>
    ''' 出荷データ排他チェック
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_SELECT_OUTKA_COUNT As String = _
                                       "SELECT                               " & vbNewLine _
                                    & "COUNT(*)            AS CNT           " & vbNewLine _
                                    & "FROM $LM_TRN$..C_OUTKA_M CM          " & vbNewLine _
                                    & "LEFT JOIN                            " & vbNewLine _
                                    & "$LM_TRN$..C_OUTKA_S CS               " & vbNewLine _
                                    & "ON                                   " & vbNewLine _
                                    & "CM.NRS_BR_CD = CS.NRS_BR_CD          " & vbNewLine _
                                    & "AND                                  " & vbNewLine _
                                    & "CM.OUTKA_NO_L = CS.OUTKA_NO_L        " & vbNewLine _
                                    & "AND                                  " & vbNewLine _
                                    & "CM.OUTKA_NO_M = CS.OUTKA_NO_M        " & vbNewLine _
                                    & "AND                                  " & vbNewLine _
                                    & "CS.SYS_DEL_FLG = '0'                 " & vbNewLine _
                                    & "LEFT JOIN                            " & vbNewLine _
                                    & "$LM_TRN$..C_OUTKA_L CL               " & vbNewLine _
                                    & "ON                                   " & vbNewLine _
                                    & "CM.NRS_BR_CD = CL.NRS_BR_CD          " & vbNewLine _
                                    & "AND                                  " & vbNewLine _
                                    & "CM.OUTKA_NO_L = CL.OUTKA_NO_L        " & vbNewLine _
                                    & "AND                                  " & vbNewLine _
                                    & "CL.SYS_DEL_FLG = '0'                 " & vbNewLine _
                                    & "WHERE                                " & vbNewLine _
                                    & "CM.NRS_BR_CD = @NRS_BR_CD            " & vbNewLine _
                                    & "AND                                  " & vbNewLine _
                                    & "CM.OUTKA_NO_L = @OUTKA_NO_L          " & vbNewLine _
                                    & "AND                                  " & vbNewLine _
                                    & "CL.SYS_UPD_DATE = @GUI_SYS_UPD_DATE  " & vbNewLine _
                                    & "AND                                  " & vbNewLine _
                                    & "CL.SYS_UPD_TIME = @GUI_SYS_UPD_TIME  " & vbNewLine _
                                    & "AND                                  " & vbNewLine _
                                    & "CL.SYS_DEL_FLG = '0'                 " & vbNewLine _
                                    & "AND                                  " & vbNewLine _
                                    & "CM.SYS_DEL_FLG = '0'                 " & vbNewLine _
                                    & "AND                                  " & vbNewLine _
                                    & "CS.SYS_DEL_FLG = '0'                 " & vbNewLine

#End Region

#Region "作業レコード(ラベル)のデータ取得"

    ''' <summary>
    ''' 作業レコード(ラベル)のデータ取得
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_SELECT_OUTKA_SAGYO_LIST_LABEL As String = _
                                "	SELECT                                                                                                                " & vbNewLine _
                              & "       MAIN.SAGYO_COMP         AS SAGYO_COMP                                                                             " & vbNewLine _
                              & "      ,MAIN.SKYU_CHK           AS SKYU_CHK                                                                               " & vbNewLine _
                              & "      ,MAIN.SAGYO_REC_NO       AS SAGYO_REC_NO                                                                           " & vbNewLine _
                              & "      ,MAIN.SAGYO_SIJI_NO      AS SAGYO_SIJI_NO                                                                          " & vbNewLine _
                              & "      ,MAIN.INOUTKA_NO_LM      AS INOUTKA_NO_LM                                                                          " & vbNewLine _
                              & "      ,MAIN.WH_CD              AS WH_CD                                                                                  " & vbNewLine _
                              & "      ,MAIN.IOZS_KB            AS IOZS_KB                                                                                " & vbNewLine _
                              & "      ,MAIN.SAGYO_CD           AS SAGYO_CD                                                                               " & vbNewLine _
                              & "      ,MS.SAGYO_NM             AS SAGYO_NM                                                                               " & vbNewLine _
                              & "      ,MAIN.CUST_CD_L          AS CUST_CD_L                                                                              " & vbNewLine _
                              & "      ,MAIN.CUST_CD_M          AS CUST_CD_M                                                                              " & vbNewLine _
                              & "      ,MAIN.DEST_CD            AS DEST_CD                                                                                " & vbNewLine _
                              & "      ,MAIN.DEST_NM            AS DEST_NM                                                                                " & vbNewLine _
                              & "      ,MAIN.GOODS_CD_NRS       AS GOODS_CD_NRS                                                                           " & vbNewLine _
                              & "      ,MAIN.GOODS_NM_NRS       AS GOODS_NM_NRS                                                                           " & vbNewLine _
                              & "      ,MAIN.LOT_NO             AS LOT_NO                                                                                 " & vbNewLine _
                              & "      ,MS.INV_TANI             AS INV_TANI                                                                               " & vbNewLine _
                              & "      ,CASE WHEN SUM(MAIN.SAGYO_NB) / CONVERT(numeric,MGD_49.SET_NAIYO) < 1                                              " & vbNewLine _
                              & "            THEN SUM(MAIN.SAGYO_NB) % CONVERT(numeric,MGD_49.SET_NAIYO)                                                  " & vbNewLine _
                              & "            ELSE CEILING((SUM(MAIN.SAGYO_NB) / CONVERT(numeric,MGD_49.SET_NAIYO)) / (MG.PLT_PER_PKG_UT / CONVERT(numeric,MGD_49.SET_NAIYO))) * 2  " & vbNewLine _
                              & "                 + (SUM(MAIN.SAGYO_NB) % CONVERT(numeric,MGD_49.SET_NAIYO))                                              " & vbNewLine _
                              & "            END  SAGYO_NB                                                                                                " & vbNewLine _
                              & "      ,MS.SAGYO_UP             AS SAGYO_UP                                                                               " & vbNewLine _
                              & "      ,MAIN.SAGYO_GK           AS SAGYO_GK                                                                               " & vbNewLine _
                              & "      ,MS.ZEI_KBN              AS TAX_KB                                                                                 " & vbNewLine _
                              & "      ,MAIN.SEIQTO_CD          AS SEIQTO_CD                                                                              " & vbNewLine _
                              & "      ,MAIN.REMARK_ZAI         AS REMARK_ZAI                                                                             " & vbNewLine _
                              & "      ,MAIN.REMARK_SKYU        AS REMARK_SKYU                                                                            " & vbNewLine _
                              & "      ,MAIN.SAGYO_COMP_CD      AS SAGYO_COMP_CD                                                                          " & vbNewLine _
                              & "      ,MAIN.SAGYO_COMP_DATE    AS SAGYO_COMP_DATE                                                                        " & vbNewLine _
                              & "      ,MAIN.DEST_SAGYO_FLG     AS DEST_SAGYO_FLG                                                                         " & vbNewLine _
                              & "      ,MAIN.NRS_BR_CD          AS NRS_BR_CD                                                                              " & vbNewLine _
                              & "      ,MAIN.LOT_COUNT          AS LOT_COUNT                                                                              " & vbNewLine _
                              & "	FROM                                                                                                                  " & vbNewLine _
                              & "			(                                                                                                             " & vbNewLine _
                              & "			SELECT                                                                                                        " & vbNewLine _
                              & "				   '00'                    AS SAGYO_COMP                                                                  " & vbNewLine _
                              & "				  ,'00'                    AS SKYU_CHK                                                                    " & vbNewLine _
                              & "				  ,''                      AS SAGYO_REC_NO                                                                " & vbNewLine _
                              & "				  ,''                      AS SAGYO_SIJI_NO                                                               " & vbNewLine _
                              & "				  ,ES.INOUTKA_NO_LM        AS INOUTKA_NO_LM                                                               " & vbNewLine _
                              & "				  ,CL.WH_CD                AS WH_CD                                                                       " & vbNewLine _
                              & "				  ,'20'                    AS IOZS_KB                                                                     " & vbNewLine _
                              & "				  ,MGD_45.SET_NAIYO        AS SAGYO_CD                                                                    " & vbNewLine _
                              & "				  ,''                      AS SAGYO_NM                                                                    " & vbNewLine _
                              & "				  ,CL.CUST_CD_L            AS CUST_CD_L                                                                   " & vbNewLine _
                              & "				  ,CL.CUST_CD_M            AS CUST_CD_M                                                                   " & vbNewLine _
                              & "				  ,CL.DEST_CD              AS DEST_CD                                                                     " & vbNewLine _
                              & "				  ,CL.DEST_NM              AS DEST_NM                                                                     " & vbNewLine _
                              & "				  ,CM.GOODS_CD_NRS         AS GOODS_CD_NRS                                                                " & vbNewLine _
                              & "				  ,''                      AS GOODS_NM_NRS                                                                " & vbNewLine _
                              & "				  ,''                      AS LOT_NO                                                                      " & vbNewLine _
                              & "				  ,''                      AS INV_TANI                                                                    " & vbNewLine _
                              & "				  ,CS.ALCTD_NB             AS SAGYO_NB                                                                    " & vbNewLine _
                              & "				  ,''                      AS SAGYO_UP                                                                    " & vbNewLine _
                              & "				  ,0                       AS SAGYO_GK                                                                    " & vbNewLine _
                              & "				  ,''                      AS TAX_KB                                                                      " & vbNewLine _
                              & "				  ,MC.SAGYO_SEIQTO_CD  AS SEIQTO_CD                                                                       " & vbNewLine _
                              & "				  ,''                      AS REMARK_ZAI                                                                  " & vbNewLine _
                              & "                 ,CL.CUST_ORD_NO          AS REMARK_SKYU                                                                 " & vbNewLine _
                              & "				  ,''                      AS SAGYO_COMP_CD                                                               " & vbNewLine _
                              & "				  ,''                      AS SAGYO_COMP_DATE                                                             " & vbNewLine _
                              & "				  ,'00'                    AS DEST_SAGYO_FLG                                                              " & vbNewLine _
                              & "				  ,CM.NRS_BR_CD            AS NRS_BR_CD                                                                   " & vbNewLine _
                              & "				  ,''                      AS LOT_COUNT                                                                   " & vbNewLine _
                              & "			  FROM $LM_TRN$..C_OUTKA_M CM                                                                                 " & vbNewLine _
                              & "			  LEFT JOIN                                                                                                   " & vbNewLine _
                              & "			  $LM_TRN$..C_OUTKA_S CS                                                                                      " & vbNewLine _
                              & "			  ON                                                                                                          " & vbNewLine _
                              & "			  CM.NRS_BR_CD = CS.NRS_BR_CD                                                                                 " & vbNewLine _
                              & "			  AND                                                                                                         " & vbNewLine _
                              & "			  CM.OUTKA_NO_L = CS.OUTKA_NO_L                                                                               " & vbNewLine _
                              & "			  AND                                                                                                         " & vbNewLine _
                              & "			  CM.OUTKA_NO_M = CS.OUTKA_NO_M                                                                               " & vbNewLine _
                              & "			  AND                                                                                                         " & vbNewLine _
                              & "			  CS.SYS_DEL_FLG = '0'                                                                                        " & vbNewLine _
                              & "			  LEFT JOIN                                                                                                   " & vbNewLine _
                              & "			  $LM_TRN$..C_OUTKA_L CL                                                                                      " & vbNewLine _
                              & "			  ON                                                                                                          " & vbNewLine _
                              & "			  CM.NRS_BR_CD = CL.NRS_BR_CD                                                                                 " & vbNewLine _
                              & "			  AND                                                                                                         " & vbNewLine _
                              & "			  CM.OUTKA_NO_L = CL.OUTKA_NO_L                                                                               " & vbNewLine _
                              & "			  AND                                                                                                         " & vbNewLine _
                              & "			  CL.SYS_DEL_FLG = '0'                                                                                        " & vbNewLine _
                              & "			  LEFT JOIN                                                                                                   " & vbNewLine _
                              & "			  $LM_MST$..M_GOODS_DETAILS MGD_45                                                                            " & vbNewLine _
                              & "			  ON                                                                                                          " & vbNewLine _
                              & "			  CM.NRS_BR_CD = MGD_45.NRS_BR_CD                                                                             " & vbNewLine _
                              & "			  AND                                                                                                         " & vbNewLine _
                              & "			  CM.GOODS_CD_NRS = MGD_45.GOODS_CD_NRS                                                                       " & vbNewLine _
                              & "			  AND                                                                                                         " & vbNewLine _
                              & "			  MGD_45.SUB_KB = '45'                                                                                        " & vbNewLine _
                              & "			  AND                                                                                                         " & vbNewLine _
                              & "			  MGD_45.SYS_DEL_FLG = '0'                                                                                    " & vbNewLine _
                              & "			  LEFT JOIN                                                                                                   " & vbNewLine _
                              & "			  $LM_TRN$..E_SAGYO ES                                                                                        " & vbNewLine _
                              & "			  ON                                                                                                          " & vbNewLine _
                              & "			  CM.NRS_BR_CD = ES.NRS_BR_CD                                                                                 " & vbNewLine _
                              & "			  AND                                                                                                         " & vbNewLine _
                              & "			  CM.OUTKA_NO_L + '000' = ES.INOUTKA_NO_LM                                                                    " & vbNewLine _
                              & "			  AND                                                                                                         " & vbNewLine _
                              & "			  MGD_45.SET_NAIYO = ES.SAGYO_CD                                                                              " & vbNewLine _
                              & "             AND                                                                                                         " & vbNewLine _
                              & "             ES.SYS_DEL_FLG = '0'                                                                                        " & vbNewLine _
                              & "			  AND                                                                                                         " & vbNewLine _
                              & "			  ES.IOZS_KB = '20'                                                                                           " & vbNewLine _
                              & "			  LEFT JOIN                                                                                                   " & vbNewLine _
                              & "			  $LM_MST$..M_CUST MC                                                                                         " & vbNewLine _
                              & "			  ON                                                                                                          " & vbNewLine _
                              & "			  CL.NRS_BR_CD = MC.NRS_BR_CD                                                                                 " & vbNewLine _
                              & "			  AND                                                                                                         " & vbNewLine _
                              & "			  CL.CUST_CD_L = MC.CUST_CD_L                                                                                 " & vbNewLine _
                              & "			  AND                                                                                                         " & vbNewLine _
                              & "			  CL.CUST_CD_M = MC.CUST_CD_M                                                                                 " & vbNewLine _
                              & "			  AND                                                                                                         " & vbNewLine _
                              & "			  MC.CUST_CD_S = '00'                                                                                         " & vbNewLine _
                              & "			  AND                                                                                                         " & vbNewLine _
                              & "			  MC.CUST_CD_SS = '00'                                                                                        " & vbNewLine _
                              & "			  WHERE                                                                                                       " & vbNewLine _
                              & "			  CM.NRS_BR_CD = @NRS_BR_CD                                                                                   " & vbNewLine _
                              & "			  AND                                                                                                         " & vbNewLine _
                              & "			  CM.OUTKA_NO_L = @OUTKA_NO_L                                                                                 " & vbNewLine _
                              & "			  AND                                                                                                       " & vbNewLine _
                              & "			  CL.SYS_UPD_DATE = @GUI_SYS_UPD_DATE                                                                       " & vbNewLine _
                              & "			  AND                                                                                                       " & vbNewLine _
                              & "			  CL.SYS_UPD_TIME = @GUI_SYS_UPD_TIME                                                                       " & vbNewLine _
                              & "			  AND                                                                                                         " & vbNewLine _
                              & "			  CL.SYS_DEL_FLG = '0'                                                                                        " & vbNewLine _
                              & "			  AND                                                                                                         " & vbNewLine _
                              & "			  CM.SYS_DEL_FLG = '0'                                                                                        " & vbNewLine _
                              & "			  AND                                                                                                         " & vbNewLine _
                              & "			  CS.SYS_DEL_FLG = '0'                                                                                        " & vbNewLine _
                              & "			  ) MAIN                                                                                                      " & vbNewLine _
                              & "			  LEFT JOIN                                                                                                   " & vbNewLine _
                              & "			  $LM_MST$..M_SAGYO MS                                                                                        " & vbNewLine _
                              & "			  ON                                                                                                          " & vbNewLine _
                              & "			  MAIN.SAGYO_CD = MS.SAGYO_CD                                                                                 " & vbNewLine _
                              & "			  AND                                                                                                         " & vbNewLine _
                              & "			  MAIN.SAGYO_CD IS NOT NULL                                                                                   " & vbNewLine _
                              & "			  LEFT JOIN                                                                                                   " & vbNewLine _
                              & "			  $LM_MST$..M_GOODS_DETAILS MGD_49                                                                            " & vbNewLine _
                              & "			  ON                                                                                                          " & vbNewLine _
                              & "			  MAIN.NRS_BR_CD = MGD_49.NRS_BR_CD                                                                           " & vbNewLine _
                              & "			  AND                                                                                                         " & vbNewLine _
                              & "			  MAIN.GOODS_CD_NRS = MGD_49.GOODS_CD_NRS                                                                     " & vbNewLine _
                              & "			  AND                                                                                                         " & vbNewLine _
                              & "			  MGD_49.SUB_KB = '49'                                                                                        " & vbNewLine _
                              & "			  AND                                                                                                         " & vbNewLine _
                              & "			  MGD_49.SYS_DEL_FLG = '0'                                                                                    " & vbNewLine _
                              & "			  LEFT JOIN                                                                                                   " & vbNewLine _
                              & "			  $LM_MST$..M_GOODS MG                                                                                        " & vbNewLine _
                              & "			  ON                                                                                                          " & vbNewLine _
                              & "			  MAIN.NRS_BR_CD = MG.NRS_BR_CD                                                                               " & vbNewLine _
                              & "			  AND                                                                                                         " & vbNewLine _
                              & "			  MAIN.GOODS_CD_NRS = MG.GOODS_CD_NRS                                                                         " & vbNewLine _
                              & "			  AND                                                                                                         " & vbNewLine _
                              & "			  MG.SYS_DEL_FLG = '0'                                                                                        " & vbNewLine _
                              & "	GROUP BY                                                                                                              " & vbNewLine _
                              & "		MAIN.SAGYO_COMP                                                                                                   " & vbNewLine _
                              & "		,MAIN.SKYU_CHK                                                                                                    " & vbNewLine _
                              & "		,MAIN.SAGYO_REC_NO                                                                                                " & vbNewLine _
                              & "		,MAIN.SAGYO_SIJI_NO                                                                                               " & vbNewLine _
                              & "		,MAIN.INOUTKA_NO_LM                                                                                               " & vbNewLine _
                              & "		,MAIN.WH_CD                                                                                                       " & vbNewLine _
                              & "		,MAIN.IOZS_KB                                                                                                     " & vbNewLine _
                              & "		,MAIN.SAGYO_CD                                                                                                    " & vbNewLine _
                              & "		,MS.SAGYO_NM                                                                                                      " & vbNewLine _
                              & "		,MAIN.CUST_CD_L                                                                                                   " & vbNewLine _
                              & "		,MAIN.CUST_CD_M                                                                                                   " & vbNewLine _
                              & "		,MAIN.DEST_CD                                                                                                     " & vbNewLine _
                              & "		,MAIN.DEST_NM                                                                                                     " & vbNewLine _
                              & "		,MAIN.GOODS_CD_NRS                                                                                                " & vbNewLine _
                              & "		,MAIN.GOODS_NM_NRS                                                                                                " & vbNewLine _
                              & "		,MAIN.LOT_NO                                                                                                      " & vbNewLine _
                              & "		,MS.INV_TANI                                                                                                      " & vbNewLine _
                              & "		,MS.SAGYO_UP                                                                                                      " & vbNewLine _
                              & "        ,MAIN.SAGYO_GK                                                                                                   " & vbNewLine _
                              & "		,MS.ZEI_KBN                                                                                                       " & vbNewLine _
                              & "		,MAIN.SEIQTO_CD                                                                                                   " & vbNewLine _
                              & "		,MAIN.REMARK_ZAI                                                                                                  " & vbNewLine _
                              & "		,MAIN.REMARK_SKYU                                                                                                 " & vbNewLine _
                              & "		,MAIN.SAGYO_COMP_CD                                                                                               " & vbNewLine _
                              & "		,MAIN.SAGYO_COMP_DATE                                                                                             " & vbNewLine _
                              & "		,MAIN.DEST_SAGYO_FLG                                                                                              " & vbNewLine _
                              & "       ,MAIN.NRS_BR_CD                                                                                                   " & vbNewLine _
                              & "       ,MAIN.LOT_COUNT                                                                                                   " & vbNewLine _
                              & "		,MGD_49.SET_NAIYO                                                                                                 " & vbNewLine _
                              & "		,MG.PLT_PER_PKG_UT                                                                                                " & vbNewLine


    ''' <summary>
    ''' 作業レコード(フタイ)のデータ取得
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_SELECT_OUTKA_SAGYO_LIST_HUTAI As String = _
                                "SELECT                                                                                                                                   " & vbNewLine _
                              & "MAIN.SAGYO_COMP         AS SAGYO_COMP                                                                                                    " & vbNewLine _
                              & ",MAIN.SKYU_CHK           AS SKYU_CHK                                                                                                     " & vbNewLine _
                              & ",MAIN.SAGYO_REC_NO       AS SAGYO_REC_NO                                                                                                 " & vbNewLine _
                              & ",MAIN.SAGYO_SIJI_NO      AS SAGYO_SIJI_NO                                                                                                " & vbNewLine _
                              & ",MAIN.INOUTKA_NO_LM      AS INOUTKA_NO_LM                                                                                                " & vbNewLine _
                              & ",MAIN.WH_CD              AS WH_CD                                                                                                        " & vbNewLine _
                              & ",MAIN.IOZS_KB            AS IOZS_KB                                                                                                      " & vbNewLine _
                              & ",MAIN.SAGYO_CD           AS SAGYO_CD                                                                                                     " & vbNewLine _
                              & ",MS.SAGYO_NM             AS SAGYO_NM                                                                                                     " & vbNewLine _
                              & ",MAIN.CUST_CD_L          AS CUST_CD_L                                                                                                    " & vbNewLine _
                              & ",MAIN.CUST_CD_M          AS CUST_CD_M                                                                                                    " & vbNewLine _
                              & ",MAIN.DEST_CD            AS DEST_CD                                                                                                      " & vbNewLine _
                              & ",MAIN.DEST_NM            AS DEST_NM                                                                                                      " & vbNewLine _
                              & ",MAIN.GOODS_CD_NRS       AS GOODS_CD_NRS                                                                                                 " & vbNewLine _
                              & ",MAIN.GOODS_NM_NRS       AS GOODS_NM_NRS                                                                                                 " & vbNewLine _
                              & ",''                      AS LOT_NO                                                                                                       " & vbNewLine _
                              & ",MS.INV_TANI             AS INV_TANI                                                                                                     " & vbNewLine _
                              & "--,CASE WHEN SUM(MAIN.LOT_COUNT) > 1                                                                                                       " & vbNewLine _
                              & "--THEN CASE WHEN SUM(MAIN.SAGYO_NB) / CONVERT(numeric,MGD_49.SET_NAIYO) <= 1                                                               " & vbNewLine _
                              & "--THEN 1                                                                                                                                   " & vbNewLine _
                              & "--ELSE FLOOR(SUM(MAIN.SAGYO_NB) / CONVERT(numeric,MGD_49.SET_NAIYO)) - 1 END                                                               " & vbNewLine _
                              & "--ELSE FLOOR(SUM(MAIN.SAGYO_NB) / CONVERT(numeric,MGD_49.SET_NAIYO))                                                                       " & vbNewLine _
                              & ",CASE WHEN SUM(MAIN.LOT_COUNT) > 1                                                                                                         " & vbNewLine _
                              & "      THEN CEILING((SUM(MAIN.SAGYO_NB) / CONVERT(numeric,MGD_49.SET_NAIYO)) / (MG.PLT_PER_PKG_UT / CONVERT(numeric,MGD_49.SET_NAIYO))) - 1 " & vbNewLine _
                              & "      ELSE CEILING((SUM(MAIN.SAGYO_NB) / CONVERT(numeric,MGD_49.SET_NAIYO)) / (MG.PLT_PER_PKG_UT / CONVERT(numeric,MGD_49.SET_NAIYO)))     " & vbNewLine _
                              & "      END SAGYO_NB                                                                                                                         " & vbNewLine _
                              & ",MS.SAGYO_UP             AS SAGYO_UP                                                                                                     " & vbNewLine _
                              & ",MAIN.SAGYO_GK           AS SAGYO_GK                                                                                                     " & vbNewLine _
                              & ",MS.ZEI_KBN              AS TAX_KB                                                                                                       " & vbNewLine _
                              & ",MAIN.SEIQTO_CD          AS SEIQTO_CD                                                                                                    " & vbNewLine _
                              & ",MAIN.REMARK_ZAI         AS REMARK_ZAI                                                                                                   " & vbNewLine _
                              & ",MAIN.REMARK_SKYU        AS REMARK_SKYU                                                                                                  " & vbNewLine _
                              & ",MAIN.SAGYO_COMP_CD      AS SAGYO_COMP_CD                                                                                                " & vbNewLine _
                              & ",MAIN.SAGYO_COMP_DATE    AS SAGYO_COMP_DATE                                                                                              " & vbNewLine _
                              & ",MAIN.DEST_SAGYO_FLG     AS DEST_SAGYO_FLG                                                                                               " & vbNewLine _
                              & ",MAIN.NRS_BR_CD          AS NRS_BR_CD                                                                                                    " & vbNewLine _
                              & ",SUM(MAIN.LOT_COUNT)     AS LOT_COUNT                                                                                                    " & vbNewLine _
                              & "FROM                                                                                                                                     " & vbNewLine _
                              & "(                                                                                                                                        " & vbNewLine _
                              & "SELECT                                                                                                                                   " & vbNewLine _
                              & "'00'                    AS SAGYO_COMP                                                                                                    " & vbNewLine _
                              & ",'00'                    AS SKYU_CHK                                                                                                     " & vbNewLine _
                              & ",''                      AS SAGYO_REC_NO                                                                                                 " & vbNewLine _
                              & ",''                      AS SAGYO_SIJI_NO                                                                                                " & vbNewLine _
                              & ",ES.INOUTKA_NO_LM        AS INOUTKA_NO_LM                                                                                                " & vbNewLine _
                              & ",CL.WH_CD                AS WH_CD                                                                                                        " & vbNewLine _
                              & ",'20'                    AS IOZS_KB                                                                                                      " & vbNewLine _
                              & ",MGD_46.SET_NAIYO        AS SAGYO_CD                                                                                                     " & vbNewLine _
                              & ",''                      AS SAGYO_NM                                                                                                     " & vbNewLine _
                              & ",CL.CUST_CD_L            AS CUST_CD_L                                                                                                    " & vbNewLine _
                              & ",CL.CUST_CD_M            AS CUST_CD_M                                                                                                    " & vbNewLine _
                              & ",CL.DEST_CD              AS DEST_CD                                                                                                      " & vbNewLine _
                              & ",CL.DEST_NM              AS DEST_NM                                                                                                      " & vbNewLine _
                              & ",CM.GOODS_CD_NRS         AS GOODS_CD_NRS                                                                                                 " & vbNewLine _
                              & ",''                      AS GOODS_NM_NRS                                                                                                 " & vbNewLine _
                              & ",CS.LOT_NO               AS LOT_NO                                                                                                       " & vbNewLine _
                              & ",''                      AS INV_TANI                                                                                                     " & vbNewLine _
                              & ",CS.ALCTD_NB             AS SAGYO_NB                                                                                                     " & vbNewLine _
                              & ",''                      AS SAGYO_UP                                                                                                     " & vbNewLine _
                              & ",0                       AS SAGYO_GK                                                                                                     " & vbNewLine _
                              & ",''                      AS TAX_KB                                                                                                       " & vbNewLine _
                              & ",MC.SAGYO_SEIQTO_CD  AS SEIQTO_CD                                                                                                        " & vbNewLine _
                              & ",''                      AS REMARK_ZAI                                                                                                   " & vbNewLine _
                              & ",CL.CUST_ORD_NO          AS REMARK_SKYU                                                                                                  " & vbNewLine _
                              & ",''                      AS SAGYO_COMP_CD                                                                                                " & vbNewLine _
                              & ",''                      AS SAGYO_COMP_DATE                                                                                              " & vbNewLine _
                              & ",'00'                    AS DEST_SAGYO_FLG                                                                                               " & vbNewLine _
                              & ",CM.NRS_BR_CD            AS NRS_BR_CD                                                                                                    " & vbNewLine _
                              & ",CS.LOT_COUNT            AS LOT_COUNT                                                                                                    " & vbNewLine _
                              & "FROM $LM_TRN$..C_OUTKA_M CM                                                                                                              " & vbNewLine _
                              & "LEFT JOIN                                                                                                                                " & vbNewLine _
                              & "(                                                                                                                                        " & vbNewLine _
                              & "SELECT                                                                                                                                   " & vbNewLine _
                              & "NRS_BR_CD                                                                                                                                " & vbNewLine _
                              & ",OUTKA_NO_L                                                                                                                              " & vbNewLine _
                              & ",OUTKA_NO_M                                                                                                                              " & vbNewLine _
                              & ",LOT_NO                                                                                                                                  " & vbNewLine _
                              & ",SUM(ALCTD_NB)  AS ALCTD_NB                                                                                                              " & vbNewLine _
                              & ",ROW_NUMBER() OVER(PARTITION BY NRS_BR_CD,OUTKA_NO_L,OUTKA_NO_M,LOT_NO ORDER BY NRS_BR_CD,OUTKA_NO_L,OUTKA_NO_M,LOT_NO)  AS LOT_COUNT    " & vbNewLine _
                              & ",SYS_DEL_FLG    AS SYS_DEL_FLG                                                                                                           " & vbNewLine _
                              & "FROM $LM_TRN$..C_OUTKA_S                                                                                                                 " & vbNewLine _
                              & "WHERE                                                                                                                                    " & vbNewLine _
                              & "NRS_BR_CD = @NRS_BR_CD                                                                                                                   " & vbNewLine _
                              & "AND                                                                                                                                      " & vbNewLine _
                              & "OUTKA_NO_L = @OUTKA_NO_L                                                                                                                 " & vbNewLine _
                              & "AND                                                                                                                                      " & vbNewLine _
                              & "SYS_DEL_FLG = '0'                                                                                                                        " & vbNewLine _
                              & "AND                                                                                                                                      " & vbNewLine _
                              & "ALCTD_NB > 0                                                                                                                             " & vbNewLine _
                              & "GROUP BY                                                                                                                                 " & vbNewLine _
                              & "NRS_BR_CD                                                                                                                                " & vbNewLine _
                              & ",OUTKA_NO_L                                                                                                                              " & vbNewLine _
                              & ",OUTKA_NO_M                                                                                                                              " & vbNewLine _
                              & ",LOT_NO                                                                                                                                  " & vbNewLine _
                              & ",SYS_DEL_FLG                                                                                                                             " & vbNewLine _
                              & ") CS                                                                                                                                     " & vbNewLine _
                              & "ON                                                                                                                                       " & vbNewLine _
                              & "CM.NRS_BR_CD = CS.NRS_BR_CD                                                                                                              " & vbNewLine _
                              & "AND                                                                                                                                      " & vbNewLine _
                              & "CM.OUTKA_NO_L = CS.OUTKA_NO_L                                                                                                            " & vbNewLine _
                              & "AND                                                                                                                                      " & vbNewLine _
                              & "CM.OUTKA_NO_M = CS.OUTKA_NO_M                                                                                                            " & vbNewLine _
                              & "AND                                                                                                                                      " & vbNewLine _
                              & "CM.SYS_DEL_FLG = '0'                                                                                                                     " & vbNewLine _
                              & "LEFT JOIN                                                                                                                                " & vbNewLine _
                              & "$LM_TRN$..C_OUTKA_L CL                                                                                                                   " & vbNewLine _
                              & "ON                                                                                                                                       " & vbNewLine _
                              & "CM.NRS_BR_CD = CL.NRS_BR_CD                                                                                                              " & vbNewLine _
                              & "AND                                                                                                                                      " & vbNewLine _
                              & "CM.OUTKA_NO_L = CL.OUTKA_NO_L                                                                                                            " & vbNewLine _
                              & "AND                                                                                                                                      " & vbNewLine _
                              & "CL.SYS_DEL_FLG = '0'                                                                                                                     " & vbNewLine _
                              & "LEFT JOIN                                                                                                                                " & vbNewLine _
                              & "$LM_MST$..M_GOODS_DETAILS MGD_46                                                                                                         " & vbNewLine _
                              & "ON                                                                                                                                       " & vbNewLine _
                              & "CM.NRS_BR_CD = MGD_46.NRS_BR_CD                                                                                                          " & vbNewLine _
                              & "AND                                                                                                                                      " & vbNewLine _
                              & "CM.GOODS_CD_NRS = MGD_46.GOODS_CD_NRS                                                                                                    " & vbNewLine _
                              & "AND                                                                                                                                      " & vbNewLine _
                              & "MGD_46.SUB_KB = '46'                                                                                                                     " & vbNewLine _
                              & "AND                                                                                                                                      " & vbNewLine _
                              & "MGD_46.SYS_DEL_FLG = '0'                                                                                                                 " & vbNewLine _
                              & "LEFT JOIN                                                                                                                                " & vbNewLine _
                              & "$LM_TRN$..E_SAGYO ES                                                                                                                     " & vbNewLine _
                              & "ON                                                                                                                                       " & vbNewLine _
                              & "CM.NRS_BR_CD = ES.NRS_BR_CD                                                                                                              " & vbNewLine _
                              & "AND                                                                                                                                      " & vbNewLine _
                              & "CM.OUTKA_NO_L + '000' = ES.INOUTKA_NO_LM                                                                                                 " & vbNewLine _
                              & "AND                                                                                                                                      " & vbNewLine _
                              & "MGD_46.SET_NAIYO = ES.SAGYO_CD                                                                                                           " & vbNewLine _
                              & "AND                                                                                                                                      " & vbNewLine _
                              & "ES.SYS_DEL_FLG = '0'                                                                                                                     " & vbNewLine _
                              & "AND                                                                                                                                      " & vbNewLine _
                              & "ES.IOZS_KB = '20'                                                                                                                        " & vbNewLine _
                              & "LEFT JOIN                                                                                                                                " & vbNewLine _
                              & "$LM_MST$..M_CUST MC                                                                                                                      " & vbNewLine _
                              & "ON                                                                                                                                       " & vbNewLine _
                              & "CL.NRS_BR_CD = MC.NRS_BR_CD                                                                                                              " & vbNewLine _
                              & "AND                                                                                                                                      " & vbNewLine _
                              & "CL.CUST_CD_L = MC.CUST_CD_L                                                                                                              " & vbNewLine _
                              & "AND                                                                                                                                      " & vbNewLine _
                              & "CL.CUST_CD_M = MC.CUST_CD_M                                                                                                              " & vbNewLine _
                              & "AND                                                                                                                                      " & vbNewLine _
                              & "MC.CUST_CD_S = '00'                                                                                                                      " & vbNewLine _
                              & "AND                                                                                                                                      " & vbNewLine _
                              & "MC.CUST_CD_SS = '00'                                                                                                                     " & vbNewLine _
                              & "WHERE                                                                                                                                    " & vbNewLine _
                              & "CM.NRS_BR_CD = @NRS_BR_CD                                                                                                                " & vbNewLine _
                              & "AND                                                                                                                                      " & vbNewLine _
                              & "CM.OUTKA_NO_L = @OUTKA_NO_L                                                                                                              " & vbNewLine _
                              & "AND                                                                                                                                      " & vbNewLine _
                              & "CL.SYS_UPD_DATE = @GUI_SYS_UPD_DATE                                                                                                      " & vbNewLine _
                              & "AND                                                                                                                                      " & vbNewLine _
                              & "CL.SYS_UPD_TIME = @GUI_SYS_UPD_TIME                                                                                                      " & vbNewLine _
                              & "AND                                                                                                                                      " & vbNewLine _
                              & "CL.SYS_DEL_FLG = '0'                                                                                                                     " & vbNewLine _
                              & "AND                                                                                                                                      " & vbNewLine _
                              & "CM.SYS_DEL_FLG = '0'                                                                                                                     " & vbNewLine _
                              & "AND                                                                                                                                      " & vbNewLine _
                              & "CS.SYS_DEL_FLG = '0'                                                                                                                     " & vbNewLine _
                              & "GROUP BY                                                                                                                                 " & vbNewLine _
                              & "ES.INOUTKA_NO_LM                                                                                                                         " & vbNewLine _
                              & ",CL.WH_CD                                                                                                                                " & vbNewLine _
                              & ",MGD_46.SET_NAIYO                                                                                                                        " & vbNewLine _
                              & ",CL.CUST_CD_L                                                                                                                            " & vbNewLine _
                              & ",CL.CUST_CD_M                                                                                                                            " & vbNewLine _
                              & ",CL.DEST_CD                                                                                                                              " & vbNewLine _
                              & ",CL.DEST_NM                                                                                                                              " & vbNewLine _
                              & ",CM.GOODS_CD_NRS                                                                                                                         " & vbNewLine _
                              & ",CS.LOT_NO                                                                                                                               " & vbNewLine _
                              & ",CS.ALCTD_NB                                                                                                                             " & vbNewLine _
                              & ",MC.SAGYO_SEIQTO_CD                                                                                                                      " & vbNewLine _
                              & ",CL.CUST_ORD_NO                                                                                                                          " & vbNewLine _
                              & ",CM.NRS_BR_CD                                                                                                                            " & vbNewLine _
                              & ",CS.LOT_COUNT                                                                                                                            " & vbNewLine _
                              & ") MAIN                                                                                                                                   " & vbNewLine _
                              & "LEFT JOIN                                                                                                                                " & vbNewLine _
                              & "$LM_MST$..M_SAGYO MS                                                                                                                     " & vbNewLine _
                              & "ON                                                                                                                                       " & vbNewLine _
                              & "MAIN.SAGYO_CD = MS.SAGYO_CD                                                                                                              " & vbNewLine _
                              & "AND                                                                                                                                      " & vbNewLine _
                              & "MAIN.SAGYO_CD IS NOT NULL                                                                                                                " & vbNewLine _
                              & "LEFT JOIN                                                                                                                                " & vbNewLine _
                              & "$LM_MST$..M_GOODS_DETAILS MGD_49                                                                                                         " & vbNewLine _
                              & "ON                                                                                                                                       " & vbNewLine _
                              & "MAIN.NRS_BR_CD = MGD_49.NRS_BR_CD                                                                                                        " & vbNewLine _
                              & "AND                                                                                                                                      " & vbNewLine _
                              & "MAIN.GOODS_CD_NRS = MGD_49.GOODS_CD_NRS                                                                                                  " & vbNewLine _
                              & "AND                                                                                                                                      " & vbNewLine _
                              & "MGD_49.SUB_KB = '49'                                                                                                                     " & vbNewLine _
                              & "AND                                                                                                                                      " & vbNewLine _
                              & "MGD_49.SYS_DEL_FLG = '0'                                                                                                                 " & vbNewLine _
                              & "LEFT JOIN                                                                                                                                " & vbNewLine _
                              & "$LM_MST$..M_GOODS MG                                                                                                                     " & vbNewLine _
                              & "ON                                                                                                                                       " & vbNewLine _
                              & "MAIN.NRS_BR_CD = MG.NRS_BR_CD                                                                                                            " & vbNewLine _
                              & "AND                                                                                                                                      " & vbNewLine _
                              & "MAIN.GOODS_CD_NRS = MG.GOODS_CD_NRS                                                                                                      " & vbNewLine _
                              & "AND                                                                                                                                      " & vbNewLine _
                              & "MG.SYS_DEL_FLG = '0'                                                                                                                     " & vbNewLine _
                              & "GROUP BY                                                                                                                                 " & vbNewLine _
                              & "MAIN.SAGYO_COMP                                                                                                                          " & vbNewLine _
                              & ",MAIN.SKYU_CHK                                                                                                                           " & vbNewLine _
                              & ",MAIN.SAGYO_REC_NO                                                                                                                       " & vbNewLine _
                              & ",MAIN.SAGYO_SIJI_NO                                                                                                                      " & vbNewLine _
                              & ",MAIN.INOUTKA_NO_LM                                                                                                                      " & vbNewLine _
                              & ",MAIN.WH_CD                                                                                                                              " & vbNewLine _
                              & ",MAIN.IOZS_KB                                                                                                                            " & vbNewLine _
                              & ",MAIN.SAGYO_CD                                                                                                                           " & vbNewLine _
                              & ",MS.SAGYO_NM                                                                                                                             " & vbNewLine _
                              & ",MAIN.CUST_CD_L                                                                                                                          " & vbNewLine _
                              & ",MAIN.CUST_CD_M                                                                                                                          " & vbNewLine _
                              & ",MAIN.DEST_CD                                                                                                                            " & vbNewLine _
                              & ",MAIN.DEST_NM                                                                                                                            " & vbNewLine _
                              & ",MAIN.GOODS_CD_NRS                                                                                                                       " & vbNewLine _
                              & ",MAIN.GOODS_NM_NRS                                                                                                                       " & vbNewLine _
                              & ",MS.INV_TANI                                                                                                                             " & vbNewLine _
                              & ",MS.SAGYO_UP                                                                                                                             " & vbNewLine _
                              & ",MAIN.SAGYO_GK                                                                                                                           " & vbNewLine _
                              & ",MS.ZEI_KBN                                                                                                                              " & vbNewLine _
                              & ",MAIN.SEIQTO_CD                                                                                                                          " & vbNewLine _
                              & ",MAIN.REMARK_ZAI                                                                                                                         " & vbNewLine _
                              & ",MAIN.REMARK_SKYU                                                                                                                        " & vbNewLine _
                              & ",MAIN.SAGYO_COMP_CD                                                                                                                      " & vbNewLine _
                              & ",MAIN.SAGYO_COMP_DATE                                                                                                                    " & vbNewLine _
                              & ",MAIN.DEST_SAGYO_FLG                                                                                                                     " & vbNewLine _
                              & ",MAIN.NRS_BR_CD                                                                                                                          " & vbNewLine _
                              & ",MGD_49.SET_NAIYO                                                                                                                        " & vbNewLine _
                              & ",MG.PLT_PER_PKG_UT                                                                                                                       " & vbNewLine


    ''' <summary>
    ''' 作業レコード(パレタイス)のデータ取得
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_SELECT_OUTKA_SAGYO_LIST_PLT As String = _
                                "SELECT                                                                                                                                   " & vbNewLine _
                              & "MAIN.SAGYO_COMP         AS SAGYO_COMP                                                                                                    " & vbNewLine _
                              & ",MAIN.SKYU_CHK           AS SKYU_CHK                                                                                                     " & vbNewLine _
                              & ",MAIN.SAGYO_REC_NO       AS SAGYO_REC_NO                                                                                                 " & vbNewLine _
                              & ",MAIN.SAGYO_SIJI_NO      AS SAGYO_SIJI_NO                                                                                                " & vbNewLine _
                              & ",MAIN.INOUTKA_NO_LM      AS INOUTKA_NO_LM                                                                                                " & vbNewLine _
                              & ",MAIN.WH_CD              AS WH_CD                                                                                                        " & vbNewLine _
                              & ",MAIN.IOZS_KB            AS IOZS_KB                                                                                                      " & vbNewLine _
                              & ",MAIN.SAGYO_CD           AS SAGYO_CD                                                                                                     " & vbNewLine _
                              & ",MS.SAGYO_NM             AS SAGYO_NM                                                                                                     " & vbNewLine _
                              & ",MAIN.CUST_CD_L          AS CUST_CD_L                                                                                                    " & vbNewLine _
                              & ",MAIN.CUST_CD_M          AS CUST_CD_M                                                                                                    " & vbNewLine _
                              & ",MAIN.DEST_CD            AS DEST_CD                                                                                                      " & vbNewLine _
                              & ",MAIN.DEST_NM            AS DEST_NM                                                                                                      " & vbNewLine _
                              & ",MAIN.GOODS_CD_NRS       AS GOODS_CD_NRS                                                                                                 " & vbNewLine _
                              & ",MAIN.GOODS_NM_NRS       AS GOODS_NM_NRS                                                                                                 " & vbNewLine _
                              & ",''                      AS LOT_NO                                                                                                       " & vbNewLine _
                              & ",MS.INV_TANI             AS INV_TANI                                                                                                     " & vbNewLine _
                              & ",1                       AS SAGYO_NB                                                                                                     " & vbNewLine _
                              & ",MS.SAGYO_UP             AS SAGYO_UP                                                                                                     " & vbNewLine _
                              & ",MAIN.SAGYO_GK           AS SAGYO_GK                                                                                                     " & vbNewLine _
                              & ",MS.ZEI_KBN              AS TAX_KB                                                                                                       " & vbNewLine _
                              & ",MAIN.SEIQTO_CD          AS SEIQTO_CD                                                                                                    " & vbNewLine _
                              & ",MAIN.REMARK_ZAI         AS REMARK_ZAI                                                                                                   " & vbNewLine _
                              & ",MAIN.REMARK_SKYU        AS REMARK_SKYU                                                                                                  " & vbNewLine _
                              & ",MAIN.SAGYO_COMP_CD      AS SAGYO_COMP_CD                                                                                                " & vbNewLine _
                              & ",MAIN.SAGYO_COMP_DATE    AS SAGYO_COMP_DATE                                                                                              " & vbNewLine _
                              & ",MAIN.DEST_SAGYO_FLG     AS DEST_SAGYO_FLG                                                                                               " & vbNewLine _
                              & ",MAIN.NRS_BR_CD          AS NRS_BR_CD                                                                                                    " & vbNewLine _
                              & ",SUM(MAIN.LOT_COUNT)     AS LOT_COUNT                                                                                                    " & vbNewLine _
                              & "FROM                                                                                                                                     " & vbNewLine _
                              & "(                                                                                                                                        " & vbNewLine _
                              & "SELECT                                                                                                                                   " & vbNewLine _
                              & "'00'                    AS SAGYO_COMP                                                                                                    " & vbNewLine _
                              & ",'00'                    AS SKYU_CHK                                                                                                     " & vbNewLine _
                              & ",''                      AS SAGYO_REC_NO                                                                                                 " & vbNewLine _
                              & ",''                      AS SAGYO_SIJI_NO                                                                                                " & vbNewLine _
                              & ",ES.INOUTKA_NO_LM        AS INOUTKA_NO_LM                                                                                                " & vbNewLine _
                              & ",CL.WH_CD                AS WH_CD                                                                                                        " & vbNewLine _
                              & ",'20'                    AS IOZS_KB                                                                                                      " & vbNewLine _
                              & ",MGD_47.SET_NAIYO        AS SAGYO_CD                                                                                                     " & vbNewLine _
                              & ",''                      AS SAGYO_NM                                                                                                     " & vbNewLine _
                              & ",CL.CUST_CD_L            AS CUST_CD_L                                                                                                    " & vbNewLine _
                              & ",CL.CUST_CD_M            AS CUST_CD_M                                                                                                    " & vbNewLine _
                              & ",CL.DEST_CD              AS DEST_CD                                                                                                      " & vbNewLine _
                              & ",CL.DEST_NM              AS DEST_NM                                                                                                      " & vbNewLine _
                              & ",CM.GOODS_CD_NRS         AS GOODS_CD_NRS                                                                                                 " & vbNewLine _
                              & ",''                      AS GOODS_NM_NRS                                                                                                 " & vbNewLine _
                              & ",CS.LOT_NO               AS LOT_NO                                                                                                       " & vbNewLine _
                              & ",''                      AS INV_TANI                                                                                                     " & vbNewLine _
                              & ",CS.ALCTD_NB             AS SAGYO_NB                                                                                                     " & vbNewLine _
                              & ",''                      AS SAGYO_UP                                                                                                     " & vbNewLine _
                              & ",0                       AS SAGYO_GK                                                                                                     " & vbNewLine _
                              & ",''                      AS TAX_KB                                                                                                       " & vbNewLine _
                              & ",MC.SAGYO_SEIQTO_CD  AS SEIQTO_CD                                                                                                        " & vbNewLine _
                              & ",''                      AS REMARK_ZAI                                                                                                   " & vbNewLine _
                              & ",CL.CUST_ORD_NO          AS REMARK_SKYU                                                                                                  " & vbNewLine _
                              & ",''                      AS SAGYO_COMP_CD                                                                                                " & vbNewLine _
                              & ",''                      AS SAGYO_COMP_DATE                                                                                              " & vbNewLine _
                              & ",'00'                    AS DEST_SAGYO_FLG                                                                                               " & vbNewLine _
                              & ",CM.NRS_BR_CD            AS NRS_BR_CD                                                                                                    " & vbNewLine _
                              & ",CS.LOT_COUNT            AS LOT_COUNT                                                                                                    " & vbNewLine _
                              & "FROM $LM_TRN$..C_OUTKA_M CM                                                                                                              " & vbNewLine _
                              & "LEFT JOIN                                                                                                                                " & vbNewLine _
                              & "(                                                                                                                                        " & vbNewLine _
                              & "SELECT                                                                                                                                   " & vbNewLine _
                              & "NRS_BR_CD                                                                                                                                " & vbNewLine _
                              & ",OUTKA_NO_L                                                                                                                              " & vbNewLine _
                              & ",OUTKA_NO_M                                                                                                                              " & vbNewLine _
                              & ",LOT_NO                                                                                                                                  " & vbNewLine _
                              & ",SUM(ALCTD_NB)  AS ALCTD_NB                                                                                                              " & vbNewLine _
                              & ",ROW_NUMBER() OVER(PARTITION BY NRS_BR_CD,OUTKA_NO_L,OUTKA_NO_M,LOT_NO ORDER BY NRS_BR_CD,OUTKA_NO_L,OUTKA_NO_M,LOT_NO)  AS LOT_COUNT    " & vbNewLine _
                              & ",SYS_DEL_FLG    AS SYS_DEL_FLG                                                                                                           " & vbNewLine _
                              & "FROM $LM_TRN$..C_OUTKA_S                                                                                                                 " & vbNewLine _
                              & "WHERE                                                                                                                                    " & vbNewLine _
                              & "NRS_BR_CD = @NRS_BR_CD                                                                                                                   " & vbNewLine _
                              & "AND                                                                                                                                      " & vbNewLine _
                              & "OUTKA_NO_L = @OUTKA_NO_L                                                                                                                 " & vbNewLine _
                              & "AND                                                                                                                                      " & vbNewLine _
                              & "SYS_DEL_FLG = '0'                                                                                                                        " & vbNewLine _
                              & "AND                                                                                                                                      " & vbNewLine _
                              & "ALCTD_NB > 0                                                                                                                             " & vbNewLine _
                              & "GROUP BY                                                                                                                                 " & vbNewLine _
                              & "NRS_BR_CD                                                                                                                                " & vbNewLine _
                              & ",OUTKA_NO_L                                                                                                                              " & vbNewLine _
                              & ",OUTKA_NO_M                                                                                                                              " & vbNewLine _
                              & ",LOT_NO                                                                                                                                  " & vbNewLine _
                              & ",SYS_DEL_FLG                                                                                                                             " & vbNewLine _
                              & ") CS                                                                                                                                     " & vbNewLine _
                              & "ON                                                                                                                                       " & vbNewLine _
                              & "CM.NRS_BR_CD = CS.NRS_BR_CD                                                                                                              " & vbNewLine _
                              & "AND                                                                                                                                      " & vbNewLine _
                              & "CM.OUTKA_NO_L = CS.OUTKA_NO_L                                                                                                            " & vbNewLine _
                              & "AND                                                                                                                                      " & vbNewLine _
                              & "CM.OUTKA_NO_M = CS.OUTKA_NO_M                                                                                                            " & vbNewLine _
                              & "AND                                                                                                                                      " & vbNewLine _
                              & "CM.SYS_DEL_FLG = '0'                                                                                                                     " & vbNewLine _
                              & "LEFT JOIN                                                                                                                                " & vbNewLine _
                              & "$LM_TRN$..C_OUTKA_L CL                                                                                                                   " & vbNewLine _
                              & "ON                                                                                                                                       " & vbNewLine _
                              & "CM.NRS_BR_CD = CL.NRS_BR_CD                                                                                                              " & vbNewLine _
                              & "AND                                                                                                                                      " & vbNewLine _
                              & "CM.OUTKA_NO_L = CL.OUTKA_NO_L                                                                                                            " & vbNewLine _
                              & "AND                                                                                                                                      " & vbNewLine _
                              & "CL.SYS_DEL_FLG = '0'                                                                                                                     " & vbNewLine _
                              & "LEFT JOIN                                                                                                                                " & vbNewLine _
                              & "$LM_MST$..M_GOODS_DETAILS MGD_47                                                                                                         " & vbNewLine _
                              & "ON                                                                                                                                       " & vbNewLine _
                              & "CM.NRS_BR_CD = MGD_47.NRS_BR_CD                                                                                                          " & vbNewLine _
                              & "AND                                                                                                                                      " & vbNewLine _
                              & "CM.GOODS_CD_NRS = MGD_47.GOODS_CD_NRS                                                                                                    " & vbNewLine _
                              & "AND                                                                                                                                      " & vbNewLine _
                              & "MGD_47.SUB_KB = '47'                                                                                                                     " & vbNewLine _
                              & "AND                                                                                                                                      " & vbNewLine _
                              & "MGD_47.SYS_DEL_FLG = '0'                                                                                                                 " & vbNewLine _
                              & "LEFT JOIN                                                                                                                                " & vbNewLine _
                              & "$LM_TRN$..E_SAGYO ES                                                                                                                     " & vbNewLine _
                              & "ON                                                                                                                                       " & vbNewLine _
                              & "CM.NRS_BR_CD = ES.NRS_BR_CD                                                                                                              " & vbNewLine _
                              & "AND                                                                                                                                      " & vbNewLine _
                              & "CM.OUTKA_NO_L + '000' = ES.INOUTKA_NO_LM                                                                                                 " & vbNewLine _
                              & "AND                                                                                                                                      " & vbNewLine _
                              & "MGD_47.SET_NAIYO = ES.SAGYO_CD                                                                                                           " & vbNewLine _
                              & "AND                                                                                                                                      " & vbNewLine _
                              & "ES.SYS_DEL_FLG = '0'                                                                                                                     " & vbNewLine _
                              & "AND                                                                                                                                      " & vbNewLine _
                              & "ES.IOZS_KB = '20'                                                                                                                        " & vbNewLine _
                              & "LEFT JOIN                                                                                                                                " & vbNewLine _
                              & "$LM_MST$..M_CUST MC                                                                                                                      " & vbNewLine _
                              & "ON                                                                                                                                       " & vbNewLine _
                              & "CL.NRS_BR_CD = MC.NRS_BR_CD                                                                                                              " & vbNewLine _
                              & "AND                                                                                                                                      " & vbNewLine _
                              & "CL.CUST_CD_L = MC.CUST_CD_L                                                                                                              " & vbNewLine _
                              & "AND                                                                                                                                      " & vbNewLine _
                              & "CL.CUST_CD_M = MC.CUST_CD_M                                                                                                              " & vbNewLine _
                              & "AND                                                                                                                                      " & vbNewLine _
                              & "MC.CUST_CD_S = '00'                                                                                                                      " & vbNewLine _
                              & "AND                                                                                                                                      " & vbNewLine _
                              & "MC.CUST_CD_SS = '00'                                                                                                                     " & vbNewLine _
                              & "WHERE                                                                                                                                    " & vbNewLine _
                              & "CM.NRS_BR_CD = @NRS_BR_CD                                                                                                                " & vbNewLine _
                              & "AND                                                                                                                                      " & vbNewLine _
                              & "CM.OUTKA_NO_L = @OUTKA_NO_L                                                                                                              " & vbNewLine _
                              & "AND                                                                                                                                      " & vbNewLine _
                              & "CL.SYS_UPD_DATE = @GUI_SYS_UPD_DATE                                                                                                      " & vbNewLine _
                              & "AND                                                                                                                                      " & vbNewLine _
                              & "CL.SYS_UPD_TIME = @GUI_SYS_UPD_TIME                                                                                                      " & vbNewLine _
                              & "AND                                                                                                                                      " & vbNewLine _
                              & "CL.SYS_DEL_FLG = '0'                                                                                                                     " & vbNewLine _
                              & "AND                                                                                                                                      " & vbNewLine _
                              & "CM.SYS_DEL_FLG = '0'                                                                                                                     " & vbNewLine _
                              & "AND                                                                                                                                      " & vbNewLine _
                              & "CS.SYS_DEL_FLG = '0'                                                                                                                     " & vbNewLine _
                              & "GROUP BY                                                                                                                                 " & vbNewLine _
                              & "ES.INOUTKA_NO_LM                                                                                                                         " & vbNewLine _
                              & ",CL.WH_CD                                                                                                                                " & vbNewLine _
                              & ",MGD_47.SET_NAIYO                                                                                                                        " & vbNewLine _
                              & ",CL.CUST_CD_L                                                                                                                            " & vbNewLine _
                              & ",CL.CUST_CD_M                                                                                                                            " & vbNewLine _
                              & ",CL.DEST_CD                                                                                                                              " & vbNewLine _
                              & ",CL.DEST_NM                                                                                                                              " & vbNewLine _
                              & ",CM.GOODS_CD_NRS                                                                                                                         " & vbNewLine _
                              & ",CS.LOT_NO                                                                                                                               " & vbNewLine _
                              & ",CS.ALCTD_NB                                                                                                                             " & vbNewLine _
                              & ",MC.SAGYO_SEIQTO_CD                                                                                                                      " & vbNewLine _
                              & ",CL.CUST_ORD_NO                                                                                                                          " & vbNewLine _
                              & ",CM.NRS_BR_CD                                                                                                                            " & vbNewLine _
                              & ",CS.LOT_COUNT                                                                                                                            " & vbNewLine _
                              & ") MAIN                                                                                                                                   " & vbNewLine _
                              & "LEFT JOIN                                                                                                                                " & vbNewLine _
                              & "$LM_MST$..M_SAGYO MS                                                                                                                     " & vbNewLine _
                              & "ON                                                                                                                                       " & vbNewLine _
                              & "MAIN.SAGYO_CD = MS.SAGYO_CD                                                                                                              " & vbNewLine _
                              & "AND                                                                                                                                      " & vbNewLine _
                              & "MAIN.SAGYO_CD IS NOT NULL                                                                                                                " & vbNewLine _
                              & "LEFT JOIN                                                                                                                                " & vbNewLine _
                              & "$LM_MST$..M_GOODS_DETAILS MGD_49                                                                                                         " & vbNewLine _
                              & "ON                                                                                                                                       " & vbNewLine _
                              & "MAIN.NRS_BR_CD = MGD_49.NRS_BR_CD                                                                                                        " & vbNewLine _
                              & "AND                                                                                                                                      " & vbNewLine _
                              & "MAIN.GOODS_CD_NRS = MGD_49.GOODS_CD_NRS                                                                                                  " & vbNewLine _
                              & "AND                                                                                                                                      " & vbNewLine _
                              & "MGD_49.SUB_KB = '49'                                                                                                                     " & vbNewLine _
                              & "AND                                                                                                                                      " & vbNewLine _
                              & "MGD_49.SYS_DEL_FLG = '0'                                                                                                                 " & vbNewLine _
                              & "GROUP BY                                                                                                                                 " & vbNewLine _
                              & "MAIN.SAGYO_COMP                                                                                                                          " & vbNewLine _
                              & ",MAIN.SKYU_CHK                                                                                                                           " & vbNewLine _
                              & ",MAIN.SAGYO_REC_NO                                                                                                                       " & vbNewLine _
                              & ",MAIN.SAGYO_SIJI_NO                                                                                                                      " & vbNewLine _
                              & ",MAIN.INOUTKA_NO_LM                                                                                                                      " & vbNewLine _
                              & ",MAIN.WH_CD                                                                                                                              " & vbNewLine _
                              & ",MAIN.IOZS_KB                                                                                                                            " & vbNewLine _
                              & ",MAIN.SAGYO_CD                                                                                                                           " & vbNewLine _
                              & ",MS.SAGYO_NM                                                                                                                             " & vbNewLine _
                              & ",MAIN.CUST_CD_L                                                                                                                          " & vbNewLine _
                              & ",MAIN.CUST_CD_M                                                                                                                          " & vbNewLine _
                              & ",MAIN.DEST_CD                                                                                                                            " & vbNewLine _
                              & ",MAIN.DEST_NM                                                                                                                            " & vbNewLine _
                              & ",MAIN.GOODS_CD_NRS                                                                                                                       " & vbNewLine _
                              & ",MAIN.GOODS_NM_NRS                                                                                                                       " & vbNewLine _
                              & ",MS.INV_TANI                                                                                                                             " & vbNewLine _
                              & ",MS.SAGYO_UP                                                                                                                             " & vbNewLine _
                              & ",MAIN.SAGYO_GK                                                                                                                           " & vbNewLine _
                              & ",MS.ZEI_KBN                                                                                                                              " & vbNewLine _
                              & ",MAIN.SEIQTO_CD                                                                                                                          " & vbNewLine _
                              & ",MAIN.REMARK_ZAI                                                                                                                         " & vbNewLine _
                              & ",MAIN.REMARK_SKYU                                                                                                                        " & vbNewLine _
                              & ",MAIN.SAGYO_COMP_CD                                                                                                                      " & vbNewLine _
                              & ",MAIN.SAGYO_COMP_DATE                                                                                                                    " & vbNewLine _
                              & ",MAIN.DEST_SAGYO_FLG                                                                                                                     " & vbNewLine _
                              & ",MAIN.NRS_BR_CD                                                                                                                          " & vbNewLine _
                              & ",MGD_49.SET_NAIYO                                                                                                                        " & vbNewLine

#End Region

#Region "SAGYO"

    ''' <summary>
    ''' INSERT（SAGYO）
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_INSERT_SAGYO As String = "INSERT INTO                                          " & vbNewLine _
                                         & "$LM_TRN$..E_SAGYO                                        " & vbNewLine _
                                         & "(                                                        " & vbNewLine _
                                         & " NRS_BR_CD                                               " & vbNewLine _
                                         & ",SAGYO_REC_NO                                            " & vbNewLine _
                                         & ",SAGYO_COMP                                              " & vbNewLine _
                                         & ",SKYU_CHK                                                " & vbNewLine _
                                         & ",SAGYO_SIJI_NO                                           " & vbNewLine _
                                         & ",INOUTKA_NO_LM                                           " & vbNewLine _
                                         & ",WH_CD                                                   " & vbNewLine _
                                         & ",IOZS_KB                                                 " & vbNewLine _
                                         & ",SAGYO_CD                                                " & vbNewLine _
                                         & ",SAGYO_NM                                                " & vbNewLine _
                                         & ",CUST_CD_L                                               " & vbNewLine _
                                         & ",CUST_CD_M                                               " & vbNewLine _
                                         & ",DEST_CD                                                 " & vbNewLine _
                                         & ",DEST_NM                                                 " & vbNewLine _
                                         & ",GOODS_CD_NRS                                            " & vbNewLine _
                                         & ",GOODS_NM_NRS                                            " & vbNewLine _
                                         & ",LOT_NO                                                  " & vbNewLine _
                                         & ",INV_TANI                                                " & vbNewLine _
                                         & ",SAGYO_NB                                                " & vbNewLine _
                                         & ",SAGYO_UP                                                " & vbNewLine _
                                         & ",SAGYO_GK                                                " & vbNewLine _
                                         & ",TAX_KB                                                  " & vbNewLine _
                                         & ",SEIQTO_CD                                               " & vbNewLine _
                                         & ",REMARK_ZAI                                              " & vbNewLine _
                                         & ",REMARK_SKYU                                             " & vbNewLine _
                                         & ",SAGYO_COMP_CD                                           " & vbNewLine _
                                         & ",SAGYO_COMP_DATE                                         " & vbNewLine _
                                         & ",DEST_SAGYO_FLG                                          " & vbNewLine _
                                         & ",SYS_ENT_DATE                                            " & vbNewLine _
                                         & ",SYS_ENT_TIME                                            " & vbNewLine _
                                         & ",SYS_ENT_PGID                                            " & vbNewLine _
                                         & ",SYS_ENT_USER                                            " & vbNewLine _
                                         & ",SYS_UPD_DATE                                            " & vbNewLine _
                                         & ",SYS_UPD_TIME                                            " & vbNewLine _
                                         & ",SYS_UPD_PGID                                            " & vbNewLine _
                                         & ",SYS_UPD_USER                                            " & vbNewLine _
                                         & ",SYS_DEL_FLG                                             " & vbNewLine _
                                         & ")SELECT                                                  " & vbNewLine _
                                         & " @NRS_BR_CD                                              " & vbNewLine _
                                         & ",@SAGYO_REC_NO                                           " & vbNewLine _
                                         & ",@SAGYO_COMP                                             " & vbNewLine _
                                         & ",@SKYU_CHK                                               " & vbNewLine _
                                         & ",@SAGYO_SIJI_NO                                          " & vbNewLine _
                                         & ",@INOUTKA_NO_LM                                          " & vbNewLine _
                                         & ",@WH_CD                                                  " & vbNewLine _
                                         & ",@IOZS_KB                                                " & vbNewLine _
                                         & ",@SAGYO_CD                                               " & vbNewLine _
                                         & ",M_SAGYO.SAGYO_NM                                        " & vbNewLine _
                                         & ",@CUST_CD_L                                              " & vbNewLine _
                                         & ",@CUST_CD_M                                              " & vbNewLine _
                                         & ",@DEST_CD                                                " & vbNewLine _
                                         & ",@DEST_NM                                                " & vbNewLine _
                                         & ",@GOODS_CD_NRS                                           " & vbNewLine _
                                         & ",@GOODS_NM_NRS                                           " & vbNewLine _
                                         & ",@LOT_NO                                                 " & vbNewLine _
                                         & ",M_SAGYO.INV_TANI                                        " & vbNewLine _
                                         & ",@SAGYO_NB                                               " & vbNewLine _
                                         & ",M_SAGYO.SAGYO_UP                                        " & vbNewLine _
                                         & ",ROUND((@SAGYO_NB * M_SAGYO.SAGYO_UP),4)                 " & vbNewLine _
                                         & ",M_SAGYO.ZEI_KBN                                         " & vbNewLine _
                                         & ",@SEIQTO_CD                                              " & vbNewLine _
                                         & ",M_SAGYO.SAGYO_REMARK                                    " & vbNewLine _
                                         & ",@REMARK_SKYU                                            " & vbNewLine _
                                         & ",@SAGYO_COMP_CD                                          " & vbNewLine _
                                         & ",@SAGYO_COMP_DATE                                        " & vbNewLine _
                                         & ",@DEST_SAGYO_FLG                                         " & vbNewLine _
                                         & ",@SYS_ENT_DATE                                           " & vbNewLine _
                                         & ",@SYS_ENT_TIME                                           " & vbNewLine _
                                         & ",@SYS_ENT_PGID                                           " & vbNewLine _
                                         & ",@SYS_ENT_USER                                           " & vbNewLine _
                                         & ",@SYS_UPD_DATE                                           " & vbNewLine _
                                         & ",@SYS_UPD_TIME                                           " & vbNewLine _
                                         & ",@SYS_UPD_PGID                                           " & vbNewLine _
                                         & ",@SYS_UPD_USER                                           " & vbNewLine _
                                         & ",@SYS_DEL_FLG                                            " & vbNewLine _
                                         & "FROM                                                     " & vbNewLine _
                                         & "$LM_MST$..M_SAGYO   M_SAGYO                              " & vbNewLine _
                                         & "WHERE                                                    " & vbNewLine _
                                         & "M_SAGYO.SAGYO_CD  = @SAGYO_CD                            " & vbNewLine _
                                         & "AND                                                      " & vbNewLine _
                                         & "M_SAGYO.NRS_BR_CD  = @NRS_BR_CD                          " & vbNewLine

#End Region
    '2015.06.22 協立化学　作業料対応 END

#Region "出荷送状番号 C_OUTKA_DENP_NO"

    'ADD 2016/06/21 要望番号:2580
    Private Const SQL_DELETE_DENP_NO As String = "DELETE FROM $LM_TRN$..C_OUTKA_DENP_NO " & vbNewLine _
                                                & "WHERE   NRS_BR_CD   = @NRS_BR_CD     " & vbNewLine _
                                                & "  AND   OUTKA_NO_L  = @OUTKA_NO_L    " & vbNewLine

    Private Const SQL_INSERT__DENP_NO As String = "INSERT INTO                                          " & vbNewLine _
                                                 & "$LM_TRN$..C_OUTKA_DENP_NO                           " & vbNewLine _
                                                 & "(                                                   " & vbNewLine _
                                                 & " NRS_BR_CD                                          " & vbNewLine _
                                                 & ",OUTKA_NO_L                                         " & vbNewLine _
                                                 & ",DENP_NO                                            " & vbNewLine _
                                                 & ",SYS_ENT_DATE                                       " & vbNewLine _
                                                 & ",SYS_ENT_TIME                                       " & vbNewLine _
                                                 & ",SYS_ENT_PGID                                       " & vbNewLine _
                                                 & ",SYS_ENT_USER                                       " & vbNewLine _
                                                 & ",SYS_UPD_DATE                                       " & vbNewLine _
                                                 & ",SYS_UPD_TIME                                       " & vbNewLine _
                                                 & ",SYS_UPD_PGID                                       " & vbNewLine _
                                                 & ",SYS_UPD_USER                                       " & vbNewLine _
                                                 & ",SYS_DEL_FLG                                        " & vbNewLine _
                                                 & " ) VALUES (                                         " & vbNewLine _
                                                 & " @NRS_BR_CD,                                        " & vbNewLine _
                                                 & " @OUTKA_NO_L,                                       " & vbNewLine _
                                                 & " @DENP_NO,                                          " & vbNewLine _
                                                 & " @SYS_ENT_DATE,                                     " & vbNewLine _
                                                 & " @SYS_ENT_TIME,                                     " & vbNewLine _
                                                 & " @SYS_ENT_PGID,                                     " & vbNewLine _
                                                 & " @SYS_ENT_USER,                                     " & vbNewLine _
                                                 & " @SYS_UPD_DATE,                                     " & vbNewLine _
                                                 & " @SYS_UPD_TIME,                                     " & vbNewLine _
                                                 & " @SYS_UPD_PGID,                                     " & vbNewLine _
                                                 & " @SYS_UPD_USER,                                     " & vbNewLine _
                                                 & " @SYS_DEL_FLG                                       " & vbNewLine _
                                                 & " )                                                  " & vbNewLine

    ''' <summary>
    ''' 出荷管理番号ﾁｪｯｸ用SQL
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_OUTKA_L_CHK As String = "SELECT                              " & vbNewLine _
                                                 & "   COUNT(OUTKA_NO_L)  AS REC_CNT     " & vbNewLine _
                                                 & "FROM                                " & vbNewLine _
                                                 & "$LM_TRN$..C_OUTKA_L                 " & vbNewLine _
                                                 & "WHERE                               " & vbNewLine _
                                                 & "    NRS_BR_CD      = @NRS_BR_CD     " & vbNewLine _
                                                 & "AND OUTKA_NO_L     = @OUTKA_NO_L    " & vbNewLine

#End Region

#Region "SBS再保管出荷実績取込"

    Private Const SQL_SELECT_SBS_SAIHOKAN_CHK As String _
        = " SELECT                                  " & vbNewLine _
        & "   COL.CNT_OUTKA_L,                      " & vbNewLine _
        & "   MUS.CNT_UNSOCO                        " & vbNewLine _
        & " FROM                                    " & vbNewLine _
        & "   (                                     " & vbNewLine _
        & "     SELECT                              " & vbNewLine _
        & "       COUNT(*) AS CNT_OUTKA_L           " & vbNewLine _
        & "     FROM                                " & vbNewLine _
        & "       $LM_TRN$..C_OUTKA_L               " & vbNewLine _
        & "     WHERE                               " & vbNewLine _
        & "       NRS_BR_CD = @NRS_BR_CD            " & vbNewLine _
        & "       AND OUTKA_NO_L = @OUTKA_NO_L      " & vbNewLine _
        & "       AND SYS_DEL_FLG = '0'             " & vbNewLine _
        & "   ) AS COL,                             " & vbNewLine _
        & "   (                                     " & vbNewLine _
        & "     SELECT                              " & vbNewLine _
        & "       COUNT(*) AS CNT_UNSOCO            " & vbNewLine _
        & "     FROM                                " & vbNewLine _
        & "       $LM_MST$..M_UNSOCO                " & vbNewLine _
        & "     WHERE                               " & vbNewLine _
        & "       NRS_BR_CD = @NRS_BR_CD            " & vbNewLine _
        & "       AND UNSOCO_CD = @UNSO_CD          " & vbNewLine _
        & "       AND UNSOCO_BR_CD = @UNSO_BR_CD    " & vbNewLine _
        & "       AND SYS_DEL_FLG = '0'             " & vbNewLine _
        & "   ) AS MUS                              " & vbNewLine

    Private Const SQL_UPDATE_SBS_SAIHOKAN_OUTKA_L As String _
        = " UPDATE $LM_TRN$..C_OUTKA_L SET      " & vbNewLine _
        & "   DENP_NO = @DENP_NO,               " & vbNewLine _
        & "   OUTKA_PKG_NB = @OUTKA_PKG_NB,     " & vbNewLine _
        & "   SYS_UPD_DATE = @SYS_UPD_DATE,     " & vbNewLine _
        & "   SYS_UPD_TIME = @SYS_UPD_TIME,     " & vbNewLine _
        & "   SYS_UPD_PGID = @SYS_UPD_PGID,     " & vbNewLine _
        & "   SYS_UPD_USER = @SYS_UPD_USER      " & vbNewLine _
        & " WHERE                               " & vbNewLine _
        & "   NRS_BR_CD = @NRS_BR_CD            " & vbNewLine _
        & "   AND OUTKA_NO_L = @OUTKA_NO_L      " & vbNewLine

    Private Const SQL_UPDATE_SBS_SAIHOKAN_UNSO_L As String _
        = " UPDATE $LM_TRN$..F_UNSO_L SET       " & vbNewLine _
        & "   UNSO_CD = @UNSO_CD,               " & vbNewLine _
        & "   UNSO_BR_CD = @UNSO_BR_CD,         " & vbNewLine _
        & "   SYS_UPD_DATE = @SYS_UPD_DATE,     " & vbNewLine _
        & "   SYS_UPD_TIME = @SYS_UPD_TIME,     " & vbNewLine _
        & "   SYS_UPD_PGID = @SYS_UPD_PGID,     " & vbNewLine _
        & "   SYS_UPD_USER = @SYS_UPD_USER      " & vbNewLine _
        & " WHERE                               " & vbNewLine _
        & "   NRS_BR_CD = @NRS_BR_CD            " & vbNewLine _
        & "   AND INOUTKA_NO_L = @OUTKA_NO_L    " & vbNewLine _
        & "   AND MOTO_DATA_KB = '20'           " & vbNewLine

#End Region

#If True Then  ' FFEM機能改修(納品書未受信状態表示対応) 20170127 added



    Private Const SQL_SELECT_NEEDLESS_NHS As String _
        = " SELECT HL.NRS_BR_CD      AS NRS_BR_CD                  " & vbNewLine _
        & "      , HL.OUTKA_CTL_NO   AS OUTKA_NO_L                 " & vbNewLine _
        & "   FROM $LM_TRN$..C_OUTKA_L AS CL                       " & vbNewLine _
        & "   LEFT JOIN $LM_TRN$..H_OUTKAEDI_L AS HL               " & vbNewLine _
        & "     ON HL.OUTKA_CTL_NO = CL.OUTKA_NO_L                 " & vbNewLine _
        & "    AND HL.NRS_BR_CD = CL.NRS_BR_CD                     " & vbNewLine _
        & "    AND HL.DEL_KB = '0'                                 " & vbNewLine _
        & "    AND HL.SYS_DEL_FLG = '0'                            " & vbNewLine _
        & "    AND (HL.FREE_C18 = 'Z3'                             " & vbNewLine _
        & "      OR HL.FREE_C16 = 'Z03'                            " & vbNewLine _
        & "      OR HL.FREE_C16 = '551'                            " & vbNewLine _
        & "      OR HL.FREE_C16 = '301'                            " & vbNewLine _
        & "      OR HL.FREE_C16 = 'Z02'                            " & vbNewLine _
        & "        )                                               " & vbNewLine _
        & "  WHERE CL.OUTKA_NO_L = @OUTKA_NO_L                     " & vbNewLine _
        & "    AND CL.NRS_BR_CD  = @NRS_BR_CD                      " & vbNewLine _
        & "    AND CL.SYS_DEL_FLG = '0'                            " & vbNewLine _
        & "    AND HL.NRS_BR_CD IS NOT NULL                        " & vbNewLine _
        & "  GROUP BY HL.NRS_BR_CD                                 " & vbNewLine _
        & "      , HL.OUTKA_CTL_NO                                 " & vbNewLine


    Private Const SQL_SELECT_NHS_NO_FFEM As String _
        = " SELECT CL.NRS_BR_CD      AS NRS_BR_CD                  " & vbNewLine _
        & "      , CL.OUTKA_NO_L     AS OUTKA_NO_L                 " & vbNewLine _
        & "   FROM $LM_TRN$..C_OUTKA_L AS CL                       " & vbNewLine _
        & "   LEFT JOIN $LM_TRN$..H_INOUTKAEDI_HED_FJF AS EDI_HED            " & vbNewLine _
        & "     ON EDI_HED.DEL_KB = '0'                                      " & vbNewLine _
        & "    AND EDI_HED.NRS_BR_CD = CL.NRS_BR_CD                          " & vbNewLine _
        & "    AND EDI_HED.INOUT_KB = '0'   -- 入出荷区分…0:出荷            " & vbNewLine _
        & "    AND EDI_HED.OUTKA_CTL_NO = CL.OUTKA_NO_L                      " & vbNewLine _
        & "    AND EDI_HED.SYS_DEL_FLG = '0'                                 " & vbNewLine _
        & "  WHERE CL.OUTKA_NO_L = @OUTKA_NO_L                     " & vbNewLine _
        & "    AND CL.NRS_BR_CD  = @NRS_BR_CD                      " & vbNewLine _
        & "    AND CL.SYS_DEL_FLG = '0'                            " & vbNewLine _
        & "    AND ISNULL(EDI_HED.ZFVYHKKBN,'') <> '5'   -- 引当計上予実区分…5:在庫転送 " & vbNewLine


    Private Const SQL_SELECT_ADD_EXISTS_COA_AND_DLV As String _
        = " , CASE WHEN COA.OUTKA_NO_L IS NULL                   " & vbNewLine _
        & "        THEN '1'                                      " & vbNewLine _
        & "        ELSE '0'                                      " & vbNewLine _
        & "   END               AS EXISTS_COA_FILE               " & vbNewLine _
        & " , CASE WHEN DLV.OUTKA_CTL_NO IS NULL                 " & vbNewLine _
        & "        THEN '1'                                      " & vbNewLine _
        & "        ELSE '0'                                      " & vbNewLine _
        & "   END               AS EXISTS_DLV_FILE               " & vbNewLine

    Private Const SQL_SELECT_ADD_SHIKAKARI_HIN_FLG As String = "" _
        & "-- 仕掛品の場合、H_INOUTKAEDI_DTL_FJF.SHIKAKARI_HIN_FLG は OUTKA_CTL_NO 単位に一意の前提 " & vbNewLine _
        & ",ISNULL(                                                                                 " & vbNewLine _
        & "   (SELECT TOP 1                                                                         " & vbNewLine _
        & "        H_INOUTKAEDI_DTL_FJF.SHIKAKARI_HIN_FLG                                           " & vbNewLine _
        & "    FROM                                                                                 " & vbNewLine _
        & "        $LM_TRN$..H_INOUTKAEDI_DTL_FJF                                                   " & vbNewLine _
        & "    WHERE                                                                                " & vbNewLine _
        & "        H_INOUTKAEDI_DTL_FJF.NRS_BR_CD = C_OUTKA_L.NRS_BR_CD                             " & vbNewLine _
        & "    AND H_INOUTKAEDI_DTL_FJF.INOUT_KB = '0' -- 入出荷区分…0:出荷                        " & vbNewLine _
        & "    AND H_INOUTKAEDI_DTL_FJF.OUTKA_CTL_NO = C_OUTKA_L.OUTKA_NO_L                         " & vbNewLine _
        & "    AND H_INOUTKAEDI_DTL_FJF.SYS_DEL_FLG = '0'                                           " & vbNewLine _
        & "    ORDER BY                                                                             " & vbNewLine _
        & "          H_INOUTKAEDI_DTL_FJF.NRS_BR_CD                                                 " & vbNewLine _
        & "        , H_INOUTKAEDI_DTL_FJF.OUTKA_CTL_NO                                              " & vbNewLine _
        & "        , H_INOUTKAEDI_DTL_FJF.OUTKA_CTL_NO_CHU                                          " & vbNewLine _
        & "    ), '') AS SHIKAKARI_HIN_FLG                                                          " & vbNewLine _
        & ""

    Private Const SQL_SELECT_ADD_CHK_FFEM_MATERIAL_PLANT_TRANSFER As String = "" _
        & ",H_INOUTKAEDI_HED_FJF.ZFVYHKKBN                      AS ZFVYHKKBN            " & vbNewLine _
        & ",ISNULL(                                                                     " & vbNewLine _
        & "   (SELECT TOP 1                                                             " & vbNewLine _
        & "        H_INOUTKAEDI_DTL_FJF.MATNR                                           " & vbNewLine _
        & "    FROM                                                                     " & vbNewLine _
        & "        $LM_TRN$..H_INOUTKAEDI_DTL_FJF                                       " & vbNewLine _
        & "    WHERE                                                                    " & vbNewLine _
        & "        H_INOUTKAEDI_DTL_FJF.CRT_DATE = H_INOUTKAEDI_HED_FJF.CRT_DATE        " & vbNewLine _
        & "    AND H_INOUTKAEDI_DTL_FJF.FILE_NAME = H_INOUTKAEDI_HED_FJF.FILE_NAME      " & vbNewLine _
        & "    AND H_INOUTKAEDI_DTL_FJF.REC_NO = H_INOUTKAEDI_HED_FJF.REC_NO            " & vbNewLine _
        & "    ORDER BY                                                                 " & vbNewLine _
        & "        H_INOUTKAEDI_DTL_FJF.GYO                                             " & vbNewLine _
        & "    ), '')                                           AS MATNR                " & vbNewLine _
        & ",H_INOUTKAEDI_HED_FJF.ZFVYDENTYP                     AS ZFVYDENTYP           " & vbNewLine _
        & ""


    Private Const SQL_FROM_ADD_EXISTS_COA_AND_DLV As String _
        = "   LEFT JOIN                                                                         " & vbNewLine _
        & "     (  -- COAが必要だが登録されていない出荷管理番号を抽出                           " & vbNewLine _
        & "        SELECT CM.NRS_BR_CD                                                          " & vbNewLine _
        & "             , CM.OUTKA_NO_L                                                         " & vbNewLine _
        & "          FROM $LM_TRN$..C_OUTKA_L AS CL                                             " & vbNewLine _
        & "          LEFT JOIN $LM_TRN$..C_OUTKA_M AS CM                                        " & vbNewLine _
        & "            ON CM.OUTKA_NO_L  = CL.OUTKA_NO_L                                        " & vbNewLine _
        & "           AND CM.NRS_BR_CD   = CL.NRS_BR_CD                                         " & vbNewLine _
        & "           AND CM.COA_YN      = '01'                                                 " & vbNewLine _
        & "           AND CM.SYS_DEL_FLG = '0'                                                  " & vbNewLine _
        & "          LEFT JOIN $LM_MST$..M_COA AS COA                                           " & vbNewLine _
        & "            ON COA.GOODS_CD_NRS = CM.GOODS_CD_NRS                                    " & vbNewLine _
        & "           AND COA.LOT_NO       = CM.LOT_NO                                          " & vbNewLine _
        & "           AND COA.DEST_CD      = CL.SHIP_CD_L                                       " & vbNewLine _
        & "           AND COA.NRS_BR_CD    = CM.NRS_BR_CD                                       " & vbNewLine _
        & "           AND COA.SYS_DEL_FLG  = '0'                                                " & vbNewLine _
        & "         WHERE CL.NRS_BR_CD     = @NRS_BR_CD                                         " & vbNewLine _
        & "           AND CL.CUST_CD_L     = @CUST_CD_L_COA_AND_DLV                             " & vbNewLine _
        & "           AND CL.SYS_DEL_FLG   = '0'                                                " & vbNewLine _
        & "           AND CM.NRS_BR_CD IS NOT NULL                                              " & vbNewLine _
        & "           AND COA.NRS_BR_CD IS NULL                                                 " & vbNewLine _
        & "         GROUP BY CM.NRS_BR_CD                                                       " & vbNewLine _
        & "                , CM.OUTKA_NO_L                                                      " & vbNewLine _
        & "      ) AS COA                                                                       " & vbNewLine _
        & "     ON COA.NRS_BR_CD = C_OUTKA_L.NRS_BR_CD                                                 " & vbNewLine _
        & "    AND COA.OUTKA_NO_L = C_OUTKA_L.OUTKA_NO_L                                               " & vbNewLine _
        & "   LEFT JOIN                                                                         " & vbNewLine _
        & "    ( -- 納品書が必要だが登録されていない出荷管理番号を抽出                          " & vbNewLine _
        & "        SELECT HL.NRS_BR_CD                                                          " & vbNewLine _
        & "             , HL.OUTKA_CTL_NO                                                       " & vbNewLine _
        & "          FROM $LM_TRN$..C_OUTKA_L AS CL                                             " & vbNewLine _
        & "          LEFT JOIN $LM_TRN$..H_OUTKAEDI_L AS HL                                     " & vbNewLine _
        & "            ON HL.OUTKA_CTL_NO = CL.OUTKA_NO_L                                       " & vbNewLine _
        & "           AND HL.NRS_BR_CD    = CL.NRS_BR_CD                                        " & vbNewLine _
        & "           AND HL.DEL_KB = '0'                                                       " & vbNewLine _
        & "           AND HL.SYS_DEL_FLG   = '0'                                                " & vbNewLine _
        & "           AND NOT (HL.FREE_C18 = 'Z3'  -- 荷動き無                                  " & vbNewLine _
        & "                 OR HL.FREE_C16 IN ('Z03', '551', '301','Z02')) -- 社内使用,廃棄,詰替" & vbNewLine _
        & "          LEFT JOIN $LM_TRN$..H_RCV_DELIVERY_SLIP_FILE AS DLV                        " & vbNewLine _
        & "            ON DLV.CUST_ORD_NO  = HL.CUST_ORD_NO                                     " & vbNewLine _
        & "           AND DLV.DEST_CD      = CASE WHEN LEFT(HL.DEST_CD, 2) <> 'BB'              " & vbNewLine _
        & "                                       THEN RIGHT('0000000000' + HL.DEST_CD, 10)     " & vbNewLine _
        & "                                       ELSE HL.DEST_CD                               " & vbNewLine _
        & "                                  END                                                " & vbNewLine _
        & "           AND DLV.CUST_CD_L    = HL.CUST_CD_L                                       " & vbNewLine _
        & "           AND DLV.NRS_BR_CD    = HL.NRS_BR_CD                                       " & vbNewLine _
        & "           AND DLV.SYS_DEL_FLG  = '0'                                                " & vbNewLine _
        & "           AND LEN(DLV.DEST_CD) > 0                                                  " & vbNewLine _
        & "          LEFT JOIN LM_TRN..H_INOUTKAEDI_HED_FJF AS EDI_HED                          " & vbNewLine _
        & "            ON EDI_HED.DEL_KB = '0'                                                  " & vbNewLine _
        & "           AND EDI_HED.NRS_BR_CD = CL.NRS_BR_CD                                      " & vbNewLine _
        & "           AND EDI_HED.INOUT_KB = '0'   -- 入出荷区分…0:出荷                        " & vbNewLine _
        & "           AND EDI_HED.EDI_CTL_NO = HL.EDI_CTL_NO                                    " & vbNewLine _
        & "           AND EDI_HED.OUTKA_CTL_NO = CL.OUTKA_NO_L                                  " & vbNewLine _
        & "           AND EDI_HED.ZFVYHKKBN = '5'   -- 引当計上予実区分…5:在庫転送             " & vbNewLine _
        & "           AND EDI_HED.SYS_DEL_FLG = '0'                                             " & vbNewLine _
        & "         WHERE CL.NRS_BR_CD     = @NRS_BR_CD                                         " & vbNewLine _
        & "           AND CL.CUST_CD_L     = @CUST_CD_L_COA_AND_DLV                             " & vbNewLine _
        & "           AND CL.SYS_DEL_FLG   = '0'                                                " & vbNewLine _
        & "           AND HL.NRS_BR_CD IS NOT NULL                                              " & vbNewLine _
        & "           AND DLV.NRS_BR_CD IS NULL                                                 " & vbNewLine _
        & "           AND EDI_HED.NRS_BR_CD IS NULL                                             " & vbNewLine _
        & "         GROUP BY HL.NRS_BR_CD                                                       " & vbNewLine _
        & "                , HL.OUTKA_CTL_NO                                                    " & vbNewLine _
        & "     ) AS DLV                                                                        " & vbNewLine _
        & "     ON DLV.OUTKA_CTL_NO = C_OUTKA_L.OUTKA_NO_L                                      " & vbNewLine _
        & "    AND DLV.NRS_BR_CD = C_OUTKA_L.NRS_BR_CD                                          " & vbNewLine

    Private Const SQL_FROM_ADD_OUTKAEDI_HED_FJF As String = "" _
        & " LEFT JOIN                                                            " & vbNewLine _
        & "     $LM_TRN$..H_INOUTKAEDI_HED_FJF H_INOUTKAEDI_HED_FJF              " & vbNewLine _
        & "         ON  H_INOUTKAEDI_HED_FJF.NRS_BR_CD = C_OUTKA_L.NRS_BR_CD     " & vbNewLine _
        & "         AND H_INOUTKAEDI_HED_FJF.OUTKA_CTL_NO = C_OUTKA_L.OUTKA_NO_L " & vbNewLine _
        & "         AND H_INOUTKAEDI_HED_FJF.INOUT_KB = '0'                      " & vbNewLine _
        & "         AND H_INOUTKAEDI_HED_FJF.DEL_KB IN('0','2')                  " & vbNewLine _
        & ""

    ''' <summary>
    ''' 検索結果行カラーカスタマイズ種別
    ''' </summary>
    ''' <remarks></remarks>
    Private Class CustomizeRowColorType

        ''' <summary>
        ''' FFEM(納品書/COAファイルの添付有無により色設定)
        ''' </summary>
        ''' <remarks></remarks>
        Public Const FFEM As String = "01"

    End Class


    Class TABLE_NM
        Public Const LMC010_INT_EDI As String = "LMC010_INT_EDI"
    End Class


#End If

#Region "名変入荷作成処理"

    ''' <summary>
    ''' SELECT C_OUTKA_L
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_SELECT_OUT_L_MH As String = " SELECT                                                                    " & vbNewLine _
                                            & " OUT_L.NRS_BR_CD                                     AS NRS_BR_CD           " & vbNewLine _
                                            & ",OUT_L.OUTKA_NO_L                                    AS OUTKA_NO_L          " & vbNewLine _
                                            & ",OUT_L.FURI_NO                                       AS FURI_NO             " & vbNewLine _
                                            & ",OUT_L.OUTKA_KB                                      AS OUTKA_KB            " & vbNewLine _
                                            & ",OUT_L.SYUBETU_KB                                    AS SYUBETU_KB          " & vbNewLine _
                                            & ",OUT_L.OUTKA_STATE_KB                                AS OUTKA_STATE_KB      " & vbNewLine _
                                            & ",OUT_L.OUTKAHOKOKU_YN                                AS OUTKAHOKOKU_YN      " & vbNewLine _
                                            & ",OUT_L.PICK_KB                                       AS PICK_KB             " & vbNewLine _
                                            & ",OUT_L.DENP_NO                                       AS DENP_NO             " & vbNewLine _
                                            & ",OUT_L.ARR_KANRYO_INFO                               AS ARR_KANRYO_INFO     " & vbNewLine _
                                            & ",OUT_L.WH_CD                                         AS WH_CD               " & vbNewLine _
                                            & ",OUT_L.OUTKA_PLAN_DATE                               AS OUTKA_PLAN_DATE     " & vbNewLine _
                                            & ",OUT_L.OUTKO_DATE                                    AS OUTKO_DATE          " & vbNewLine _
                                            & ",OUT_L.ARR_PLAN_DATE                                 AS ARR_PLAN_DATE       " & vbNewLine _
                                            & ",OUT_L.ARR_PLAN_TIME                                 AS ARR_PLAN_TIME       " & vbNewLine _
                                            & ",OUT_L.HOKOKU_DATE                                   AS HOKOKU_DATE         " & vbNewLine _
                                            & ",OUT_L.TOUKI_HOKAN_YN                                AS TOUKI_HOKAN_YN      " & vbNewLine _
                                            & ",OUT_L.END_DATE                                      AS END_DATE            " & vbNewLine _
                                            & ",OUT_L.CUST_CD_L                                     AS CUST_CD_L           " & vbNewLine _
                                            & ",OUT_L.CUST_CD_M                                     AS CUST_CD_M           " & vbNewLine _
                                            & ",OUT_L.SHIP_CD_L                                     AS SHIP_CD_L           " & vbNewLine _
                                            & ",OUT_L.SHIP_CD_M                                     AS SHIP_CD_M           " & vbNewLine _
                                            & ",OUT_L.DEST_CD                                       AS DEST_CD             " & vbNewLine _
                                            & ",OUT_L.DEST_AD_3                                     AS DEST_AD_3           " & vbNewLine _
                                            & ",OUT_L.DEST_TEL                                      AS DEST_TEL            " & vbNewLine _
                                            & ",OUT_L.NHS_REMARK                                    AS NHS_REMARK          " & vbNewLine _
                                            & ",OUT_L.SP_NHS_KB                                     AS SP_NHS_KB           " & vbNewLine _
                                            & ",OUT_L.COA_YN                                        AS COA_YN              " & vbNewLine _
                                            & ",OUT_L.CUST_ORD_NO                                   AS CUST_ORD_NO         " & vbNewLine _
                                            & ",OUT_L.BUYER_ORD_NO                                  AS BUYER_ORD_NO        " & vbNewLine _
                                            & ",OUT_L.REMARK                                        AS REMARK              " & vbNewLine _
                                            & ",OUT_L.OUTKA_PKG_NB                                  AS OUTKA_PKG_NB        " & vbNewLine _
                                            & ",OUT_L.DENP_YN                                       AS DENP_YN             " & vbNewLine _
                                            & ",OUT_L.PC_KB                                         AS PC_KB               " & vbNewLine _
                                            & ",OUT_L.NIYAKU_YN                                     AS NIYAKU_YN           " & vbNewLine _
                                            & ",OUT_L.DEST_KB                                       AS DEST_KB             " & vbNewLine _
                                            & ",OUT_L.DEST_NM                                       AS DEST_NM             " & vbNewLine _
                                            & ",OUT_L.DEST_AD_1                                     AS DEST_AD_1           " & vbNewLine _
                                            & ",OUT_L.DEST_AD_2                                     AS DEST_AD_2           " & vbNewLine _
                                            & ",OUT_L.ALL_PRINT_FLAG                                AS ALL_PRINT_FLAG      " & vbNewLine _
                                            & ",OUT_L.NIHUDA_FLAG                                   AS NIHUDA_FLAG         " & vbNewLine _
                                            & ",OUT_L.NHS_FLAG                                      AS NHS_FLAG            " & vbNewLine _
                                            & ",OUT_L.DENP_FLAG                                     AS DENP_FLAG           " & vbNewLine _
                                            & ",OUT_L.COA_FLAG                                      AS COA_FLAG            " & vbNewLine _
                                            & ",OUT_L.HOKOKU_FLAG                                   AS HOKOKU_FLAG         " & vbNewLine _
                                            & ",OUT_L.MATOME_PICK_FLAG                              AS MATOME_PICK_FLAG    " & vbNewLine _
                                            & ",OUT_L.MATOME_PRINT_DATE                             AS MATOME_PRINT_DATE   " & vbNewLine _
                                            & ",OUT_L.MATOME_PRINT_TIME                             AS MATOME_PRINT_TIME   " & vbNewLine _
                                            & ",OUT_L.LAST_PRINT_DATE                               AS LAST_PRINT_DATE     " & vbNewLine _
                                            & ",OUT_L.LAST_PRINT_TIME                               AS LAST_PRINT_TIME     " & vbNewLine _
                                            & ",OUT_L.SASZ_USER                                     AS SASZ_USER           " & vbNewLine _
                                            & ",OUT_L.OUTKO_USER                                    AS OUTKO_USER          " & vbNewLine _
                                            & ",OUT_L.KEN_USER                                      AS KEN_USER            " & vbNewLine _
                                            & ",OUT_L.OUTKA_USER                                    AS OUTKA_USER          " & vbNewLine _
                                            & ",OUT_L.HOU_USER                                      AS HOU_USER            " & vbNewLine _
                                            & ",OUT_L.ORDER_TYPE                                    AS ORDER_TYPE          " & vbNewLine _
                                            & ",OUT_L.WH_KENPIN_WK_STATUS                           AS WH_KENPIN_WK_STATUS " & vbNewLine _
                                            & ",OUT_L.WH_TAB_YN                                     AS WH_TAB_YN           " & vbNewLine _
                                            & ",OUT_L.SYS_ENT_TIME                                  AS SYS_ENT_TIME        " & vbNewLine _
                                            & ",OUT_L.SYS_ENT_PGID                                  AS SYS_ENT_PGID        " & vbNewLine _
                                            & ",OUT_L.SYS_ENT_USER                                  AS SYS_ENT_USER        " & vbNewLine _
                                            & ",OUT_L.SYS_ENT_DATE                                  AS SYS_ENT_DATE        " & vbNewLine _
                                            & ",OUT_L.SYS_UPD_DATE                                  AS SYS_UPD_DATE        " & vbNewLine _
                                            & ",OUT_L.SYS_UPD_TIME                                  AS SYS_UPD_TIME        " & vbNewLine _
                                            & ",OUT_L.SYS_UPD_PGID                                  AS SYS_UPD_PGID        " & vbNewLine _
                                            & ",OUT_L.SYS_UPD_USER                                  AS SYS_UPD_USER        " & vbNewLine _
                                            & ",OUT_L.SYS_DEL_FLG                                   AS SYS_DEL_FLG         " & vbNewLine _
                                            & "FROM                                                                        " & vbNewLine _
                                            & "$LM_TRN$..C_OUTKA_L  OUT_L                                                  " & vbNewLine _
                                            & "WHERE                                                                       " & vbNewLine _
                                            & "    OUT_L.NRS_BR_CD    = @NRS_BR_CD                                         " & vbNewLine _
                                            & "AND OUT_L.OUTKA_NO_L   = @OUTKA_NO_L                                        " & vbNewLine _
                                            & "AND OUT_L.SYS_DEL_FLG  = '0'                                                " & vbNewLine

    ''' <summary>
    ''' SELECT C_OUTKA_M
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_SELECT_OUT_M_MH As String = " SELECT                                                                    " & vbNewLine _
                                            & " OUT_M.NRS_BR_CD                                     AS NRS_BR_CD           " & vbNewLine _
                                            & ",OUT_M.OUTKA_NO_L                                    AS OUTKA_NO_L          " & vbNewLine _
                                            & ",OUT_M.OUTKA_NO_M                                    AS OUTKA_NO_M          " & vbNewLine _
                                            & ",OUT_M.EDI_SET_NO                                    AS EDI_SET_NO          " & vbNewLine _
                                            & ",OUT_M.COA_YN                                        AS COA_YN              " & vbNewLine _
                                            & ",OUT_M.CUST_ORD_NO_DTL                               AS CUST_ORD_NO_DTL     " & vbNewLine _
                                            & ",OUT_M.BUYER_ORD_NO_DTL                              AS BUYER_ORD_NO_DTL    " & vbNewLine _
                                            & ",OUT_M.GOODS_CD_NRS                                  AS GOODS_CD_NRS        " & vbNewLine _
                                            & ",OUT_M.RSV_NO                                        AS RSV_NO              " & vbNewLine _
                                            & ",OUT_M.LOT_NO                                        AS LOT_NO              " & vbNewLine _
                                            & ",OUT_M.SERIAL_NO                                     AS SERIAL_NO           " & vbNewLine _
                                            & ",OUT_M.ALCTD_KB                                      AS ALCTD_KB            " & vbNewLine _
                                            & ",OUT_M.OUTKA_PKG_NB                                  AS OUTKA_PKG_NB        " & vbNewLine _
                                            & ",OUT_M.OUTKA_HASU                                    AS OUTKA_HASU          " & vbNewLine _
                                            & ",OUT_M.OUTKA_QT                                      AS OUTKA_QT            " & vbNewLine _
                                            & ",OUT_M.OUTKA_TTL_NB                                  AS OUTKA_TTL_NB        " & vbNewLine _
                                            & ",OUT_M.OUTKA_TTL_QT                                  AS OUTKA_TTL_QT        " & vbNewLine _
                                            & ",OUT_M.ALCTD_NB                                      AS ALCTD_NB            " & vbNewLine _
                                            & ",OUT_M.ALCTD_QT                                      AS ALCTD_QT            " & vbNewLine _
                                            & ",OUT_M.BACKLOG_NB                                    AS BACKLOG_NB          " & vbNewLine _
                                            & ",OUT_M.BACKLOG_QT                                    AS BACKLOG_QT          " & vbNewLine _
                                            & ",OUT_M.UNSO_ONDO_KB                                  AS UNSO_ONDO_KB        " & vbNewLine _
                                            & ",OUT_M.IRIME                                         AS IRIME               " & vbNewLine _
                                            & ",OUT_M.IRIME_UT                                      AS IRIME_UT            " & vbNewLine _
                                            & ",OUT_M.OUTKA_M_PKG_NB                                AS OUTKA_M_PKG_NB      " & vbNewLine _
                                            & ",OUT_M.REMARK                                        AS REMARK              " & vbNewLine _
                                            & ",OUT_M.SIZE_KB                                       AS SIZE_KB             " & vbNewLine _
                                            & ",OUT_M.ZAIKO_KB                                      AS ZAIKO_KB            " & vbNewLine _
                                            & ",OUT_M.SOURCE_CD                                     AS SOURCE_CD           " & vbNewLine _
                                            & ",OUT_M.YELLOW_CARD                                   AS YELLOW_CARD         " & vbNewLine _
                                            & ",OUT_M.GOODS_CD_NRS_FROM                             AS GOODS_CD_NRS_FROM   " & vbNewLine _
                                            & ",OUT_M.PRINT_SORT                                    AS PRINT_SORT          " & vbNewLine _
                                            & ",OUT_M.SYS_ENT_DATE                                  AS SYS_ENT_DATE        " & vbNewLine _
                                            & ",OUT_M.SYS_ENT_TIME                                  AS SYS_ENT_TIME        " & vbNewLine _
                                            & ",OUT_M.SYS_ENT_PGID                                  AS SYS_ENT_PGID        " & vbNewLine _
                                            & ",OUT_M.SYS_ENT_USER                                  AS SYS_ENT_USER        " & vbNewLine _
                                            & ",OUT_M.SYS_UPD_DATE                                  AS SYS_UPD_DATE        " & vbNewLine _
                                            & ",OUT_M.SYS_UPD_TIME                                  AS SYS_UPD_TIME        " & vbNewLine _
                                            & ",OUT_M.SYS_UPD_PGID                                  AS SYS_UPD_PGID        " & vbNewLine _
                                            & ",OUT_M.SYS_UPD_USER                                  AS SYS_UPD_USER        " & vbNewLine _
                                            & ",OUT_M.SYS_DEL_FLG                                   AS SYS_DEL_FLG         " & vbNewLine _
                                            & ",FURI.CD_NRS_TO                                      AS CD_NRS_TO           " & vbNewLine _
                                            & ",FURI.PKG_NB                                         AS GOODS_PKG_NB        " & vbNewLine _
                                            & ",CUST.HOKAN_NIYAKU_CALCULATION                       AS HOKAN_NIYAKU_CALCULATION " & vbNewLine _
                                            & "-- 2018/11/01 ADD START 要望番号002161                                      " & vbNewLine _
                                            & ",GOODS2.GOODS_CD_CUST                                AS GOODS_CD_CUST       " & vbNewLine _
                                            & ",GOODS2.GOODS_NM_1                                   AS GOODS_NM_1          " & vbNewLine _
                                            & "-- 2018/11/01 ADD END 要望番号002161                                        " & vbNewLine _
                                            & "FROM                                                                        " & vbNewLine _
                                            & "$LM_TRN$..C_OUTKA_M  OUT_M                                                  " & vbNewLine _
                                            & "LEFT OUTER JOIN                                                             " & vbNewLine _
                                            & "       (SELECT  FURI2.*                                                     " & vbNewLine _
                                            & "               ,GOODS.PKG_NB                                                " & vbNewLine _
                                            & "        FROM  $LM_MST$..M_FURI_GOODS AS FURI2                               " & vbNewLine _
                                            & "              INNER JOIN $LM_MST$..M_GOODS AS GOODS                         " & vbNewLine _
                                            & "                ON FURI2.NRS_BR_CD      = GOODS.NRS_BR_CD                   " & vbNewLine _
                                            & "               AND FURI2.CD_NRS_TO      = GOODS.GOODS_CD_NRS                " & vbNewLine _
                                            & "               AND GOODS.CUST_CD_L = @CUST_CD_L                             " & vbNewLine _
                                            & "               AND GOODS.CUST_CD_M = @CUST_CD_M                             " & vbNewLine _
                                            & "               AND GOODS.SYS_DEL_FLG = '0'                                  " & vbNewLine _
                                            & "        WHERE FURI2.SYS_DEL_FLG = '0'                                       " & vbNewLine _
                                            & "        AND FURI2.NRS_BR_CD = @NRS_BR_CD                                    " & vbNewLine _
                                            & "       ) FURI                                                               " & vbNewLine _
                                            & "   ON FURI.NRS_BR_CD      = OUT_M.NRS_BR_CD                                 " & vbNewLine _
                                            & "  AND FURI.CD_NRS         = OUT_M.GOODS_CD_NRS                              " & vbNewLine _
                                            & "  AND FURI.SYS_DEL_FLG = '0'                                                " & vbNewLine _
                                            & "LEFT OUTER JOIN                                                             " & vbNewLine _
                                            & "     $LM_MST$..M_GOODS GOODS                                                " & vbNewLine _
                                            & "   ON GOODS.NRS_BR_CD    = FURI.NRS_BR_CD                                   " & vbNewLine _
                                            & "  AND GOODS.GOODS_CD_NRS = FURI.CD_NRS_TO                                   " & vbNewLine _
                                            & "  AND GOODS.SYS_DEL_FLG = '0'                                               " & vbNewLine _
                                            & "LEFT OUTER JOIN                                                             " & vbNewLine _
                                            & "     $LM_MST$..M_CUST CUST                                                  " & vbNewLine _
                                            & "   ON CUST.NRS_BR_CD = GOODS.NRS_BR_CD                                      " & vbNewLine _
                                            & "  AND CUST.CUST_CD_L = GOODS.CUST_CD_L                                      " & vbNewLine _
                                            & "  AND CUST.CUST_CD_M = GOODS.CUST_CD_M                                      " & vbNewLine _
                                            & "  AND CUST.CUST_CD_S = GOODS.CUST_CD_S                                      " & vbNewLine _
                                            & "  AND CUST.CUST_CD_SS = GOODS.CUST_CD_SS                                    " & vbNewLine _
                                            & "  AND CUST.SYS_DEL_FLG = '0'                                                " & vbNewLine _
                                            & "-- 2018/11/01 ADD START 要望管理002161                                      " & vbNewLine _
                                            & "LEFT OUTER JOIN                                                             " & vbNewLine _
                                            & "     $LM_MST$..M_GOODS GOODS2                                               " & vbNewLine _
                                            & "   ON GOODS2.NRS_BR_CD    = OUT_M.NRS_BR_CD                                 " & vbNewLine _
                                            & "  AND GOODS2.GOODS_CD_NRS = OUT_M.GOODS_CD_NRS                              " & vbNewLine _
                                            & "  AND GOODS2.SYS_DEL_FLG = '0'                                              " & vbNewLine _
                                            & "-- 2018/11/01 ADD END 要望管理002161                                        " & vbNewLine _
                                            & "WHERE                                                                       " & vbNewLine _
                                            & "    OUT_M.NRS_BR_CD    = @NRS_BR_CD                                         " & vbNewLine _
                                            & "AND OUT_M.OUTKA_NO_L   = @OUTKA_NO_L                                        " & vbNewLine _
                                            & "AND OUT_M.SYS_DEL_FLG  = '0'                                                " & vbNewLine _
                                            & "ORDER BY                                                                    " & vbNewLine _
                                            & "OUT_M.OUTKA_NO_M                                                            " & vbNewLine

    ''' <summary>
    ''' SELECT C_OUTKA_S
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_SELECT_OUT_S_MH As String = " SELECT                                                                    " & vbNewLine _
                                            & " OUT_S.NRS_BR_CD                                     AS NRS_BR_CD           " & vbNewLine _
                                            & ",OUT_S.OUTKA_NO_L                                    AS OUTKA_NO_L          " & vbNewLine _
                                            & ",OUT_S.OUTKA_NO_M                                    AS OUTKA_NO_M          " & vbNewLine _
                                            & ",OUT_S.OUTKA_NO_S                                    AS OUTKA_NO_S          " & vbNewLine _
                                            & ",OUT_S.TOU_NO                                        AS TOU_NO              " & vbNewLine _
                                            & ",OUT_S.SITU_NO                                       AS SITU_NO             " & vbNewLine _
                                            & ",OUT_S.ZONE_CD                                       AS ZONE_CD             " & vbNewLine _
                                            & ",OUT_S.LOCA                                          AS LOCA                " & vbNewLine _
                                            & ",OUT_S.LOT_NO                                        AS LOT_NO              " & vbNewLine _
                                            & ",OUT_S.SERIAL_NO                                     AS SERIAL_NO           " & vbNewLine _
                                            & ",OUT_S.OUTKA_TTL_NB                                  AS OUTKA_TTL_NB        " & vbNewLine _
                                            & ",OUT_S.OUTKA_TTL_QT                                  AS OUTKA_TTL_QT        " & vbNewLine _
                                            & ",OUT_S.ZAI_REC_NO                                    AS ZAI_REC_NO          " & vbNewLine _
                                            & ",OUT_S.INKA_NO_L                                     AS INKA_NO_L           " & vbNewLine _
                                            & ",OUT_S.INKA_NO_M                                     AS INKA_NO_M           " & vbNewLine _
                                            & ",OUT_S.INKA_NO_S                                     AS INKA_NO_S           " & vbNewLine _
                                            & ",OUT_S.ZAI_UPD_FLAG                                  AS ZAI_UPD_FLAG        " & vbNewLine _
                                            & ",OUT_S.ALCTD_CAN_NB                                  AS ALCTD_CAN_NB        " & vbNewLine _
                                            & ",OUT_S.ALCTD_NB                                      AS ALCTD_NB            " & vbNewLine _
                                            & ",OUT_S.ALCTD_CAN_QT                                  AS ALCTD_CAN_QT        " & vbNewLine _
                                            & ",OUT_S.ALCTD_QT                                      AS ALCTD_QT            " & vbNewLine _
                                            & ",OUT_S.IRIME                                         AS IRIME               " & vbNewLine _
                                            & ",OUT_S.BETU_WT                                       AS BETU_WT             " & vbNewLine _
                                            & ",OUT_S.COA_FLAG                                      AS COA_FLAG            " & vbNewLine _
                                            & ",OUT_S.REMARK                                        AS REMARK              " & vbNewLine _
                                            & ",OUT_S.SMPL_FLAG                                     AS SMPL_FLAG           " & vbNewLine _
                                            & ",OUT_S.REC_NO                                        AS REC_NO              " & vbNewLine _
                                            & ",OUT_S.SYS_ENT_DATE                                  AS SYS_ENT_DATE        " & vbNewLine _
                                            & ",OUT_S.SYS_ENT_TIME                                  AS SYS_ENT_TIME        " & vbNewLine _
                                            & ",OUT_S.SYS_ENT_PGID                                  AS SYS_ENT_PGID        " & vbNewLine _
                                            & ",OUT_S.SYS_ENT_USER                                  AS SYS_ENT_USER        " & vbNewLine _
                                            & ",OUT_S.SYS_UPD_DATE                                  AS SYS_UPD_DATE        " & vbNewLine _
                                            & ",OUT_S.SYS_UPD_TIME                                  AS SYS_UPD_TIME        " & vbNewLine _
                                            & ",OUT_S.SYS_UPD_PGID                                  AS SYS_UPD_PGID        " & vbNewLine _
                                            & ",OUT_S.SYS_UPD_USER                                  AS SYS_UPD_USER        " & vbNewLine _
                                            & ",OUT_S.SYS_DEL_FLG                                   AS SYS_DEL_FLG         " & vbNewLine _
                                            & ",ZAI.SPD_KB                                          AS SPD_KB              " & vbNewLine _
                                            & ",ZAI.OFB_KB                                          AS OFB_KB              " & vbNewLine _
                                            & "-- 2018/11/01 ADD START 要望番号002824                                      " & vbNewLine _
                                            & ",ZAI.ALLOC_PRIORITY                                  AS ALLOC_PRIORITY      " & vbNewLine _
                                            & ",ZAI.GOODS_COND_KB_1                                 AS GOODS_COND_KB_1     " & vbNewLine _
                                            & ",ZAI.GOODS_COND_KB_2                                 AS GOODS_COND_KB_2     " & vbNewLine _
                                            & ",ZAI.GOODS_COND_KB_3                                 AS GOODS_COND_KB_3     " & vbNewLine _
                                            & ",ZAI.REMARK_OUT                                      AS REMARK_OUT          " & vbNewLine _
                                            & ",ZAI.LT_DATE                                         AS LT_DATE             " & vbNewLine _
                                            & ",ZAI.GOODS_CRT_DATE                                  AS GOODS_CRT_DATE      " & vbNewLine _
                                            & ",ZAI.DEST_CD_P                                       AS DEST_CD_P           " & vbNewLine _
                                            & ",ZAI.REMARK                                          AS ZAI_REMARK          " & vbNewLine _
                                            & "-- 2018/11/01 ADD END 要望番号002824                                        " & vbNewLine _
                                            & "FROM                                                                        " & vbNewLine _
                                            & "$LM_TRN$..C_OUTKA_S  OUT_S                                                  " & vbNewLine _
                                            & "LEFT JOIN $LM_TRN$..D_ZAI_TRS  ZAI                                          " & vbNewLine _
                                            & "  ON ZAI.NRS_BR_CD   = OUT_S.NRS_BR_CD                                      " & vbNewLine _
                                            & " AND ZAI.ZAI_REC_NO  = OUT_S.ZAI_REC_NO                                     " & vbNewLine _
                                            & " AND ZAI.SYS_DEL_FLG = '0'                                                  " & vbNewLine _
                                            & "WHERE                                                                       " & vbNewLine _
                                            & "    OUT_S.NRS_BR_CD    = @NRS_BR_CD                                         " & vbNewLine _
                                            & "AND OUT_S.OUTKA_NO_L   = @OUTKA_NO_L                                        " & vbNewLine _
                                            & "AND OUT_S.SYS_DEL_FLG  = '0'                                                " & vbNewLine _
                                            & "ORDER BY                                                                    " & vbNewLine _
                                            & "OUT_S.OUTKA_NO_M,OUT_S.OUTKA_NO_S                                           " & vbNewLine

    ''' <summary>
    ''' SELECT COUNT B_INKA_L
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_SELECT_COUNT_INKA_L_MH As String = " SELECT                                                          " & vbNewLine _
                                            & " COUNT(*)                                            AS SELECT_CNT          " & vbNewLine _
                                            & "FROM                                                                        " & vbNewLine _
                                            & "$LM_TRN$..B_INKA_L  INKA_L                                                  " & vbNewLine _
                                            & "WHERE                                                                       " & vbNewLine _
                                            & "    INKA_L.NRS_BR_CD   = @NRS_BR_CD                                         " & vbNewLine _
                                            & "AND INKA_L.CUST_CD_L   = @CUST_CD_L                                         " & vbNewLine _
                                            & "AND INKA_L.CUST_CD_M   = @CUST_CD_M                                         " & vbNewLine _
                                            & "AND INKA_L.OUTKA_FROM_ORD_NO_L   = @CUST_ORD_NO                             " & vbNewLine _
                                            & "AND INKA_L.INKA_DATE   = @OUTKO_DATE                                        " & vbNewLine _
                                            & "AND INKA_L.SYS_DEL_FLG  = '0'                                               " & vbNewLine

    ''' <summary>
    ''' INSERT B_INKA_L
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_INSERT_INKA_L_MH As String = "INSERT INTO $LM_TRN$..B_INKA_L" & vbNewLine _
                                              & "(                             " & vbNewLine _
                                              & " NRS_BR_CD                    " & vbNewLine _
                                              & ",INKA_NO_L                    " & vbNewLine _
                                              & ",FURI_NO                      " & vbNewLine _
                                              & ",INKA_TP                      " & vbNewLine _
                                              & ",INKA_KB                      " & vbNewLine _
                                              & ",INKA_STATE_KB                " & vbNewLine _
                                              & ",INKA_DATE                    " & vbNewLine _
                                              & ",STORAGE_DUE_DATE             " & vbNewLine _
                                              & ",WH_CD                        " & vbNewLine _
                                              & ",CUST_CD_L                    " & vbNewLine _
                                              & ",CUST_CD_M                    " & vbNewLine _
                                              & ",INKA_PLAN_QT                 " & vbNewLine _
                                              & ",INKA_PLAN_QT_UT              " & vbNewLine _
                                              & ",INKA_TTL_NB                  " & vbNewLine _
                                              & ",BUYER_ORD_NO_L               " & vbNewLine _
                                              & ",OUTKA_FROM_ORD_NO_L          " & vbNewLine _
                                              & ",SEIQTO_CD                    " & vbNewLine _
                                              & ",TOUKI_HOKAN_YN               " & vbNewLine _
                                              & ",HOKAN_YN                     " & vbNewLine _
                                              & ",HOKAN_FREE_KIKAN             " & vbNewLine _
                                              & ",HOKAN_STR_DATE               " & vbNewLine _
                                              & ",NIYAKU_YN                    " & vbNewLine _
                                              & ",TAX_KB                       " & vbNewLine _
                                              & ",REMARK                       " & vbNewLine _
                                              & ",REMARK_OUT                   " & vbNewLine _
                                              & ",CHECKLIST_PRT_DATE           " & vbNewLine _
                                              & ",CHECKLIST_PRT_USER           " & vbNewLine _
                                              & ",UKETSUKELIST_PRT_DATE        " & vbNewLine _
                                              & ",UKETSUKELIST_PRT_USER        " & vbNewLine _
                                              & ",UKETSUKE_DATE                " & vbNewLine _
                                              & ",UKETSUKE_USER                " & vbNewLine _
                                              & ",KEN_DATE                     " & vbNewLine _
                                              & ",KEN_USER                     " & vbNewLine _
                                              & ",INKO_DATE                    " & vbNewLine _
                                              & ",INKO_USER                    " & vbNewLine _
                                              & ",HOUKOKUSYO_PR_DATE           " & vbNewLine _
                                              & ",HOUKOKUSYO_PR_USER           " & vbNewLine _
                                              & ",UNCHIN_TP                    " & vbNewLine _
                                              & ",UNCHIN_KB                    " & vbNewLine _
                                              & ",WH_KENPIN_WK_STATUS          " & vbNewLine _
                                              & ",WH_TAB_STATUS                " & vbNewLine _
                                              & ",WH_TAB_YN                    " & vbNewLine _
                                              & ",WH_TAB_IMP_YN                " & vbNewLine _
                                              & ",SYS_ENT_DATE                 " & vbNewLine _
                                              & ",SYS_ENT_TIME                 " & vbNewLine _
                                              & ",SYS_ENT_PGID                 " & vbNewLine _
                                              & ",SYS_ENT_USER                 " & vbNewLine _
                                              & ",SYS_UPD_DATE                 " & vbNewLine _
                                              & ",SYS_UPD_TIME                 " & vbNewLine _
                                              & ",SYS_UPD_PGID                 " & vbNewLine _
                                              & ",SYS_UPD_USER                 " & vbNewLine _
                                              & ",SYS_DEL_FLG                  " & vbNewLine _
                                              & " )VALUES(                     " & vbNewLine _
                                              & " @NRS_BR_CD                   " & vbNewLine _
                                              & ",@INKA_NO_L                   " & vbNewLine _
                                              & ",''                           " & vbNewLine _
                                              & ",@INKA_TP                     " & vbNewLine _
                                              & ",@INKA_KB                     " & vbNewLine _
                                              & ",@INKA_STATE_KB               " & vbNewLine _
                                              & ",@INKA_DATE                   " & vbNewLine _
                                              & ",''                           " & vbNewLine _
                                              & ",@WH_CD                       " & vbNewLine _
                                              & ",@CUST_CD_L                   " & vbNewLine _
                                              & ",@CUST_CD_M                   " & vbNewLine _
                                              & ",0                            " & vbNewLine _
                                              & ",''                           " & vbNewLine _
                                              & ",@INKA_TTL_NB                 " & vbNewLine _
                                              & ",@BUYER_ORD_NO_L              " & vbNewLine _
                                              & ",@OUTKA_FROM_ORD_NO_L         " & vbNewLine _
                                              & ",''                           " & vbNewLine _
                                              & ",@TOUKI_HOKAN_YN              " & vbNewLine _
                                              & ",@HOKAN_YN                    " & vbNewLine _
                                              & ",0                            " & vbNewLine _
                                              & ",@HOKAN_STR_DATE              " & vbNewLine _
                                              & ",@NIYAKU_YN                   " & vbNewLine _
                                              & ",@TAX_KB                      " & vbNewLine _
                                              & ",''                           " & vbNewLine _
                                              & ",''                           " & vbNewLine _
                                              & ",''                           " & vbNewLine _
                                              & ",''                           " & vbNewLine _
                                              & ",''                           " & vbNewLine _
                                              & ",''                           " & vbNewLine _
                                              & ",''                           " & vbNewLine _
                                              & ",''                           " & vbNewLine _
                                              & ",''                           " & vbNewLine _
                                              & ",''                           " & vbNewLine _
                                              & ",''                           " & vbNewLine _
                                              & ",''                           " & vbNewLine _
                                              & ",''                           " & vbNewLine _
                                              & ",''                           " & vbNewLine _
                                              & ",@UNCHIN_TP                   " & vbNewLine _
                                              & ",''                           " & vbNewLine _
                                              & ",@WH_KENPIN_WK_STATUS         " & vbNewLine _
                                              & ",@WH_TAB_STATUS               " & vbNewLine _
                                              & ",@WH_TAB_YN                   " & vbNewLine _
                                              & ",@WH_TAB_IMP_YN               " & vbNewLine _
                                              & ",@SYS_ENT_DATE                " & vbNewLine _
                                              & ",@SYS_ENT_TIME                " & vbNewLine _
                                              & ",@SYS_ENT_PGID                " & vbNewLine _
                                              & ",@SYS_ENT_USER                " & vbNewLine _
                                              & ",@SYS_UPD_DATE                " & vbNewLine _
                                              & ",@SYS_UPD_TIME                " & vbNewLine _
                                              & ",@SYS_UPD_PGID                " & vbNewLine _
                                              & ",@SYS_UPD_USER                " & vbNewLine _
                                              & ",@SYS_DEL_FLG                 " & vbNewLine _
                                              & ")                             " & vbNewLine

    ''' <summary>
    ''' INSERT B_INKA_M
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_INSERT_INKA_M_MH As String = "INSERT INTO $LM_TRN$..B_INKA_M" & vbNewLine _
                                              & "(                             " & vbNewLine _
                                              & " NRS_BR_CD                    " & vbNewLine _
                                              & ",INKA_NO_L                    " & vbNewLine _
                                              & ",INKA_NO_M                    " & vbNewLine _
                                              & ",GOODS_CD_NRS                 " & vbNewLine _
                                              & ",OUTKA_FROM_ORD_NO_M          " & vbNewLine _
                                              & ",BUYER_ORD_NO_M               " & vbNewLine _
                                              & ",REMARK                       " & vbNewLine _
                                              & ",PRINT_SORT                   " & vbNewLine _
                                              & ",SYS_ENT_DATE                 " & vbNewLine _
                                              & ",SYS_ENT_TIME                 " & vbNewLine _
                                              & ",SYS_ENT_PGID                 " & vbNewLine _
                                              & ",SYS_ENT_USER                 " & vbNewLine _
                                              & ",SYS_UPD_DATE                 " & vbNewLine _
                                              & ",SYS_UPD_TIME                 " & vbNewLine _
                                              & ",SYS_UPD_PGID                 " & vbNewLine _
                                              & ",SYS_UPD_USER                 " & vbNewLine _
                                              & ",SYS_DEL_FLG                  " & vbNewLine _
                                              & " )VALUES(                     " & vbNewLine _
                                              & " @NRS_BR_CD                   " & vbNewLine _
                                              & ",@INKA_NO_L                   " & vbNewLine _
                                              & ",@INKA_NO_M                   " & vbNewLine _
                                              & ",@GOODS_CD_NRS                " & vbNewLine _
                                              & ",''                           " & vbNewLine _
                                              & ",''                           " & vbNewLine _
                                              & ",''                           " & vbNewLine _
                                              & ",99                           " & vbNewLine _
                                              & ",@SYS_ENT_DATE                " & vbNewLine _
                                              & ",@SYS_ENT_TIME                " & vbNewLine _
                                              & ",@SYS_ENT_PGID                " & vbNewLine _
                                              & ",@SYS_ENT_USER                " & vbNewLine _
                                              & ",@SYS_UPD_DATE                " & vbNewLine _
                                              & ",@SYS_UPD_TIME                " & vbNewLine _
                                              & ",@SYS_UPD_PGID                " & vbNewLine _
                                              & ",@SYS_UPD_USER                " & vbNewLine _
                                              & ",@SYS_DEL_FLG                 " & vbNewLine _
                                              & ")                             " & vbNewLine

    ''' <summary>
    ''' INSERT B_INKA_S
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_INSERT_INKA_S_MH As String = "INSERT INTO $LM_TRN$..B_INKA_S" & vbNewLine _
                                              & "(                             " & vbNewLine _
                                              & " NRS_BR_CD                    " & vbNewLine _
                                              & ",INKA_NO_L                    " & vbNewLine _
                                              & ",INKA_NO_M                    " & vbNewLine _
                                              & ",INKA_NO_S                    " & vbNewLine _
                                              & ",ZAI_REC_NO                   " & vbNewLine _
                                              & ",LOT_NO                       " & vbNewLine _
                                              & ",LOCA                         " & vbNewLine _
                                              & ",TOU_NO                       " & vbNewLine _
                                              & ",SITU_NO                      " & vbNewLine _
                                              & ",ZONE_CD                      " & vbNewLine _
                                              & ",KONSU                        " & vbNewLine _
                                              & ",HASU                         " & vbNewLine _
                                              & ",IRIME                        " & vbNewLine _
                                              & ",BETU_WT                      " & vbNewLine _
                                              & ",SERIAL_NO                    " & vbNewLine _
                                              & ",GOODS_COND_KB_1              " & vbNewLine _
                                              & ",GOODS_COND_KB_2              " & vbNewLine _
                                              & ",GOODS_COND_KB_3              " & vbNewLine _
                                              & ",GOODS_CRT_DATE               " & vbNewLine _
                                              & ",LT_DATE                      " & vbNewLine _
                                              & ",SPD_KB                       " & vbNewLine _
                                              & ",OFB_KB                       " & vbNewLine _
                                              & ",DEST_CD                      " & vbNewLine _
                                              & ",REMARK                       " & vbNewLine _
                                              & ",ALLOC_PRIORITY               " & vbNewLine _
                                              & ",REMARK_OUT                   " & vbNewLine _
                                              & ",SYS_ENT_DATE                 " & vbNewLine _
                                              & ",SYS_ENT_TIME                 " & vbNewLine _
                                              & ",SYS_ENT_PGID                 " & vbNewLine _
                                              & ",SYS_ENT_USER                 " & vbNewLine _
                                              & ",SYS_UPD_DATE                 " & vbNewLine _
                                              & ",SYS_UPD_TIME                 " & vbNewLine _
                                              & ",SYS_UPD_PGID                 " & vbNewLine _
                                              & ",SYS_UPD_USER                 " & vbNewLine _
                                              & ",SYS_DEL_FLG                  " & vbNewLine _
                                              & " )VALUES(                     " & vbNewLine _
                                              & " @NRS_BR_CD                   " & vbNewLine _
                                              & ",@INKA_NO_L                   " & vbNewLine _
                                              & ",@INKA_NO_M                   " & vbNewLine _
                                              & ",@INKA_NO_S                   " & vbNewLine _
                                              & ",@ZAI_REC_NO                  " & vbNewLine _
                                              & ",@LOT_NO                      " & vbNewLine _
                                              & ",@LOCA                        " & vbNewLine _
                                              & ",@TOU_NO                      " & vbNewLine _
                                              & ",@SITU_NO                     " & vbNewLine _
                                              & ",@ZONE_CD                     " & vbNewLine _
                                              & ",@KONSU                       " & vbNewLine _
                                              & ",@HASU                        " & vbNewLine _
                                              & ",@IRIME                       " & vbNewLine _
                                              & ",@BETU_WT                     " & vbNewLine _
                                              & ",@SERIAL_NO                   " & vbNewLine _
                                              & ",''                           " & vbNewLine _
                                              & ",''                           " & vbNewLine _
                                              & ",''                           " & vbNewLine _
                                              & "-- 2018/11/01 MOD START 値をセットするよう変更 要望管理002824 " & vbNewLine _
                                              & ",@GOODS_CRT_DATE              " & vbNewLine _
                                              & ",@LT_DATE                     " & vbNewLine _
                                              & "-- 2018/11/01 MOD END 値をセットするよう変更 要望管理002824 " & vbNewLine _
                                              & ",@SPD_KB                      " & vbNewLine _
                                              & ",@OFB_KB                      " & vbNewLine _
                                              & ",''                           " & vbNewLine _
                                              & "-- 2018/11/01 MOD START 値をセットするよう変更 要望管理002824 " & vbNewLine _
                                              & ",@REMARK                      " & vbNewLine _
                                              & ",@ALLOC_PRIORITY              " & vbNewLine _
                                              & ",@REMARK_OUT                  " & vbNewLine _
                                              & "-- 2018/11/01 MOD END 値をセットするよう変更 要望管理002824 " & vbNewLine _
                                              & ",@SYS_ENT_DATE                " & vbNewLine _
                                              & ",@SYS_ENT_TIME                " & vbNewLine _
                                              & ",@SYS_ENT_PGID                " & vbNewLine _
                                              & ",@SYS_ENT_USER                " & vbNewLine _
                                              & ",@SYS_UPD_DATE                " & vbNewLine _
                                              & ",@SYS_UPD_TIME                " & vbNewLine _
                                              & ",@SYS_UPD_PGID                " & vbNewLine _
                                              & ",@SYS_UPD_USER                " & vbNewLine _
                                              & ",@SYS_DEL_FLG                 " & vbNewLine _
                                              & ")                             " & vbNewLine

    ''' <summary>
    ''' INSERT D_ZAI_TRS
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_INSERT_ZAI_TRS_MH As String = "INSERT INTO $LM_TRN$..D_ZAI_TRS" & vbNewLine _
                                              & "(                              " & vbNewLine _
                                              & " NRS_BR_CD                     " & vbNewLine _
                                              & ",ZAI_REC_NO                    " & vbNewLine _
                                              & ",WH_CD                         " & vbNewLine _
                                              & ",TOU_NO                        " & vbNewLine _
                                              & ",SITU_NO                       " & vbNewLine _
                                              & ",ZONE_CD                       " & vbNewLine _
                                              & ",LOCA                          " & vbNewLine _
                                              & ",LOT_NO                        " & vbNewLine _
                                              & ",CUST_CD_L                     " & vbNewLine _
                                              & ",CUST_CD_M                     " & vbNewLine _
                                              & ",GOODS_CD_NRS                  " & vbNewLine _
                                              & ",GOODS_KANRI_NO                " & vbNewLine _
                                              & ",INKA_NO_L                     " & vbNewLine _
                                              & ",INKA_NO_M                     " & vbNewLine _
                                              & ",INKA_NO_S                     " & vbNewLine _
                                              & ",ALLOC_PRIORITY                " & vbNewLine _
                                              & ",RSV_NO                        " & vbNewLine _
                                              & ",SERIAL_NO                     " & vbNewLine _
                                              & ",HOKAN_YN                      " & vbNewLine _
                                              & ",TAX_KB                        " & vbNewLine _
                                              & ",GOODS_COND_KB_1               " & vbNewLine _
                                              & ",GOODS_COND_KB_2               " & vbNewLine _
                                              & ",GOODS_COND_KB_3               " & vbNewLine _
                                              & ",OFB_KB                        " & vbNewLine _
                                              & ",SPD_KB                        " & vbNewLine _
                                              & ",REMARK_OUT                    " & vbNewLine _
                                              & ",PORA_ZAI_NB                   " & vbNewLine _
                                              & ",ALCTD_NB                      " & vbNewLine _
                                              & ",ALLOC_CAN_NB                  " & vbNewLine _
                                              & ",IRIME                         " & vbNewLine _
                                              & ",PORA_ZAI_QT                   " & vbNewLine _
                                              & ",ALCTD_QT                      " & vbNewLine _
                                              & ",ALLOC_CAN_QT                  " & vbNewLine _
                                              & ",INKO_DATE                     " & vbNewLine _
                                              & ",INKO_PLAN_DATE                " & vbNewLine _
                                              & ",ZERO_FLAG                     " & vbNewLine _
                                              & ",LT_DATE                       " & vbNewLine _
                                              & ",GOODS_CRT_DATE                " & vbNewLine _
                                              & ",DEST_CD_P                     " & vbNewLine _
                                              & ",REMARK                        " & vbNewLine _
                                              & ",SMPL_FLAG                     " & vbNewLine _
                                              & ",SYS_ENT_DATE                  " & vbNewLine _
                                              & ",SYS_ENT_TIME                  " & vbNewLine _
                                              & ",SYS_ENT_PGID                  " & vbNewLine _
                                              & ",SYS_ENT_USER                  " & vbNewLine _
                                              & ",SYS_UPD_DATE                  " & vbNewLine _
                                              & ",SYS_UPD_TIME                  " & vbNewLine _
                                              & ",SYS_UPD_PGID                  " & vbNewLine _
                                              & ",SYS_UPD_USER                  " & vbNewLine _
                                              & ",SYS_DEL_FLG                   " & vbNewLine _
                                              & " )VALUES(                      " & vbNewLine _
                                              & " @NRS_BR_CD                    " & vbNewLine _
                                              & ",@ZAI_REC_NO                   " & vbNewLine _
                                              & ",@WH_CD                        " & vbNewLine _
                                              & ",@TOU_NO                       " & vbNewLine _
                                              & ",@SITU_NO                      " & vbNewLine _
                                              & ",@ZONE_CD                      " & vbNewLine _
                                              & ",@LOCA                         " & vbNewLine _
                                              & ",@LOT_NO                       " & vbNewLine _
                                              & ",@CUST_CD_L                    " & vbNewLine _
                                              & ",@CUST_CD_M                    " & vbNewLine _
                                              & ",@GOODS_CD_NRS                 " & vbNewLine _
                                              & ",@GOODS_KANRI_NO               " & vbNewLine _
                                              & ",@INKA_NO_L                    " & vbNewLine _
                                              & ",@INKA_NO_M                    " & vbNewLine _
                                              & ",@INKA_NO_S                    " & vbNewLine _
                                              & ",@ALLOC_PRIORITY               " & vbNewLine _
                                              & ",@RSV_NO                       " & vbNewLine _
                                              & ",@SERIAL_NO                    " & vbNewLine _
                                              & ",@HOKAN_YN                     " & vbNewLine _
                                              & ",@TAX_KB                       " & vbNewLine _
                                              & ",@GOODS_COND_KB_1              " & vbNewLine _
                                              & ",@GOODS_COND_KB_2              " & vbNewLine _
                                              & ",@GOODS_COND_KB_3              " & vbNewLine _
                                              & ",@OFB_KB                       " & vbNewLine _
                                              & ",@SPD_KB                       " & vbNewLine _
                                              & ",@REMARK_OUT                   " & vbNewLine _
                                              & ",@PORA_ZAI_NB                  " & vbNewLine _
                                              & ",@ALCTD_NB                     " & vbNewLine _
                                              & ",@ALLOC_CAN_NB                 " & vbNewLine _
                                              & ",@IRIME                        " & vbNewLine _
                                              & ",@PORA_ZAI_QT                  " & vbNewLine _
                                              & ",@ALCTD_QT                     " & vbNewLine _
                                              & ",@ALLOC_CAN_QT                 " & vbNewLine _
                                              & ",@INKO_DATE                    " & vbNewLine _
                                              & ",@INKO_PLAN_DATE               " & vbNewLine _
                                              & ",@ZERO_FLAG                    " & vbNewLine _
                                              & ",@LT_DATE                      " & vbNewLine _
                                              & ",@GOODS_CRT_DATE               " & vbNewLine _
                                              & ",@DEST_CD_P                    " & vbNewLine _
                                              & ",@REMARK                       " & vbNewLine _
                                              & ",@SMPL_FLAG                    " & vbNewLine _
                                              & ",@SYS_ENT_DATE                 " & vbNewLine _
                                              & ",@SYS_ENT_TIME                 " & vbNewLine _
                                              & ",@SYS_ENT_PGID                 " & vbNewLine _
                                              & ",@SYS_ENT_USER                 " & vbNewLine _
                                              & ",@SYS_UPD_DATE                 " & vbNewLine _
                                              & ",@SYS_UPD_TIME                 " & vbNewLine _
                                              & ",@SYS_UPD_PGID                 " & vbNewLine _
                                              & ",@SYS_UPD_USER                 " & vbNewLine _
                                              & ",@SYS_DEL_FLG                  " & vbNewLine _
                                              & ")                              " & vbNewLine

#End Region

#Region "タブレット対応"

    Private Const SQL_IS_WH_TAN_NRS_BR_CD As String = _
        "SELECT                                     " & vbNewLine & _
        "    ISNULL(COUNT(*), 0) AS CNT             " & vbNewLine & _
        "FROM $LM_MST$..Z_KBN                       " & vbNewLine & _
        "WHERE KBN_GROUP_CD = 'B007'                " & vbNewLine & _
        "AND VALUE1 = 1                             " & vbNewLine & _
        "AND KBN_CD = @NRS_BR_CD                    " & vbNewLine

#End Region

#End Region

#Region "Field"

    ''' <summary>
    ''' 検索条件設定用
    ''' </summary>
    ''' <remarks></remarks>
    Private _Row As Data.DataRow

    ''' <summary>
    ''' 発行SQL作成用
    ''' </summary>
    ''' <remarks></remarks>
    Private _StrSql As StringBuilder

    ''' <summary>
    ''' ORDER BY句作成
    ''' </summary>
    ''' <remarks></remarks>
    Private _StrSqlOrderBy As StringBuilder

    ''' <summary>
    ''' パラメータ設定用
    ''' </summary>
    ''' <remarks></remarks>
    Private _SqlPrmList As ArrayList

    ''' <summary>
    ''' メッセージ設定判定用フラグ
    ''' </summary>
    ''' <remarks></remarks>
    Private _msgFlg As Boolean = False

#End Region

#Region "Method"

#Region "検索処理"
    Shared SQL_EXIST_INT_EDI As Char

    ''' <summary>
    ''' 出荷データL検索対象データ件数検索
    ''' </summary>
    ''' <param name="ds">DataSet</param>
    ''' <returns>DataSet</returns>
    ''' <remarks>出荷データLテーブル更新対象データ検索件数取得SQLの構築・発行</remarks>
    Private Function SelectData(ByVal ds As DataSet) As DataSet

        '20160615 tsunehira add start
        Dim kbnNm As String = Me.SelectLangSet(ds)
        '20160615 tsunehira add end

        'DataSetのIN情報を取得
        Dim inTbl As DataTable = ds.Tables("LMC010IN")

        'INTableの条件rowの格納
        Me._Row = inTbl.Rows(0)

        'SQL格納変数の初期化
        Me._StrSql = New StringBuilder()

        'START YANAI 要望番号1286 入荷・出荷画面の機能追加（出荷検索にロット、シリアル）
        'SQLパラメータ初期化
        Me._SqlPrmList = New ArrayList()
        'END YANAI 要望番号1286 入荷・出荷画面の機能追加（出荷検索にロット、シリアル）

        'SQL作成
        Me._StrSql.Append(LMC010DAC.SQL_SELECT_COUNT)     'SQL構築(カウント用Select句)
        Me._StrSql.Append(LMC010DAC.SQL_FROM)             'SQL構築(データ抽出用From句)
        'START YANAI 要望番号1286 入荷・出荷画面の機能追加（出荷検索にロット、シリアル）
        Call Me.SetFromOutkaM()                   '条件設定
        Me._StrSql.Append(LMC010DAC.SQL_FROM2)             'SQL構築(データ抽出用From句)
        'END YANAI 要望番号1286 入荷・出荷画面の機能追加（出荷検索にロット、シリアル）
        'START YANAI 要望番号1002 荷札印刷時、データ抽出条件変更
        Call Me.SetSqlFrom()                   '条件設定
        'END YANAI 要望番号1002 荷札印刷時、データ抽出条件変更
        Call Me.SetConditionMasterSQL()                   '条件設定

        'スキーマ名設定
        'Dim sql As String = Me.SetSchemaNm(Me._StrSql.ToString(), Me._Row.Item("NRS_BR_CD").ToString())

        'SQL文のコンパイル
        'Dim cmd As SqlCommand = MyBase.CreateSqlCommand(sql)
        '20160615 tsunehira add
        Dim cmd As SqlCommand = MyBase.CreateSqlCommand(Me.SetKbnNm(Me.SetSchemaNm(Me._StrSql.ToString(), Me._Row.Item("NRS_BR_CD").ToString()), kbnNm))

        'パラメータの反映
        For Each obj As Object In Me._SqlPrmList
            cmd.Parameters.Add(obj)
        Next

        MyBase.Logger.WriteSQLLog("LMC010DAC", "SelectData", cmd)

        'SQLの発行
#If False Then
        'TODO:テストのためログを入れる。
        Dim strdate As Date = Now
        Dim strtime As Long = CLng(strdate.Hour.ToString.PadLeft(2, CChar("0")) & strdate.Minute.ToString.PadLeft(2, CChar("0")) & strdate.Second.ToString.PadLeft(2, CChar("0")) & strdate.Millisecond.ToString.PadLeft(3, CChar("0")))
        MyBase.Logger.WriteLog(0, "LMC010DAC", "SelectData", "☆☆開始時間：" & Format(strdate, "yyyyMMdd") & " " & strtime)
        Dim reader As SqlDataReader = MyBase.GetSelectResult(cmd)
        Dim enddate As Date = Now
        Dim endtime As Long = CLng(enddate.Hour.ToString.PadLeft(2, CChar("0")) & enddate.Minute.ToString.PadLeft(2, CChar("0")) & enddate.Second.ToString.PadLeft(2, CChar("0")) & enddate.Millisecond.ToString.PadLeft(3, CChar("0")))
        MyBase.Logger.WriteLog(0, "LMC010DAC", "SelectData", "☆☆終了時間：" & Format(enddate, "yyyyMMdd") & " " & endtime)
        MyBase.Logger.WriteLog(0, "LMC010DAC", "SelectData", "☆☆経過時間：" & endtime - strtime & "ﾐﾘ秒")
#Else
        Dim reader As SqlDataReader = MyBase.GetSelectResult(cmd)
#End If


        '処理件数の設定
        reader.Read()
        MyBase.SetResultCount(Convert.ToInt32(reader("SELECT_CNT")))
        reader.Close()
        Return ds

    End Function


    ''' <summary>
    ''' 入荷データLテーブル更新対象データ検索
    ''' </summary>
    ''' <param name="ds">DataSet</param>
    ''' <returns>DataSet</returns>
    ''' <remarks>入荷データLテーブル更新対象データ一覧検索結果取得SQLの構築・発行</remarks>
    Private Function SelectListData(ByVal ds As DataSet) As DataSet

        '20160615 tsunehira add start
        Dim kbnNm As String = Me.SelectLangSet(ds)
        '20160615 tsunehira add end

        'DataSetのIN情報を取得
        Dim inTbl As DataTable = ds.Tables("LMC010IN")

        'INTableの条件rowの格納
        Me._Row = inTbl.Rows(0)

        'SQL格納変数の初期化
        Me._StrSql = New StringBuilder()
        Me._StrSqlOrderBy = New StringBuilder()

        'START YANAI 要望番号1286 入荷・出荷画面の機能追加（出荷検索にロット、シリアル）
        'SQLパラメータ初期化
        Me._SqlPrmList = New ArrayList()
        'END YANAI 要望番号1286 入荷・出荷画面の機能追加（出荷検索にロット、シリアル）

        'SQL作成
        Me._StrSql.Append(LMC010DAC.SQL_SELECT_DATA)      'SQL構築(データ抽出用Select句)

#If True Then  ' FFEM機能改修(納品書未受信状態表示対応) 20170127 added
        Dim isSelectExistsCoaAndDlv As Boolean = Me.IsSelectExistsCoaFileAndDlvFile(ds)
        If (isSelectExistsCoaAndDlv) Then
            Me._StrSql.Append(SQL_SELECT_ADD_EXISTS_COA_AND_DLV)
        End If
#End If
        If (isSelectExistsCoaAndDlv) Then
            Me._StrSql.Append(SQL_SELECT_ADD_SHIKAKARI_HIN_FLG)
            Me._StrSql.Append(SQL_SELECT_ADD_CHK_FFEM_MATERIAL_PLANT_TRANSFER)
        End If
        Me._StrSql.Append(LMC010DAC.SQL_FROM)             'SQL構築(データ抽出用From句)

        'START YANAI 要望番号1286 入荷・出荷画面の機能追加（出荷検索にロット、シリアル）
        Call Me.SetFromOutkaM()                   '条件設定
        Me._StrSql.Append(LMC010DAC.SQL_FROM2)             'SQL構築(データ抽出用From句)
        'END YANAI 要望番号1286 入荷・出荷画面の機能追加（出荷検索にロット、シリアル）
        'START YANAI 要望番号1002 荷札印刷時、データ抽出条件変更
        Call Me.SetSqlFrom()                   '条件設定
        'END YANAI 要望番号1002 荷札印刷時、データ抽出条件変更


#If True Then  ' FFEM機能改修(納品書未受信状態表示対応) 20170127 added
        If (isSelectExistsCoaAndDlv) Then
            Me._StrSql.Append(SQL_FROM_ADD_EXISTS_COA_AND_DLV)
            Me._StrSql.Append(SQL_FROM_ADD_OUTKAEDI_HED_FJF)
        End If
#End If

        Call Me.SetConditionMasterSQL()                   '条件設定


#If True Then  ' FFEM機能改修(納品書未受信状態表示対応) 20170127 added
        If (isSelectExistsCoaAndDlv) Then
            Me.SetParamExistsCoaAndDlv()
        End If
#End If

        Call Me.SQLOrderBy()                              'SQL構築(データ抽出用OrderBy句)

        'スキーマ名設定
        'Dim sql As String = Me.SetSchemaNm(Me._StrSql.ToString(), Me._Row.Item("NRS_BR_CD").ToString())

        'SQL文のコンパイル
        'Dim cmd As SqlCommand = MyBase.CreateSqlCommand(sql)
        '20160615 tsunehira add
        Dim cmd As SqlCommand = MyBase.CreateSqlCommand(Me.SetKbnNm(Me.SetSchemaNm(Me._StrSql.ToString(), Me._Row.Item("NRS_BR_CD").ToString()), kbnNm))

        'パラメータの反映
        For Each obj As Object In Me._SqlPrmList
            cmd.Parameters.Add(obj)
        Next

        MyBase.Logger.WriteSQLLog("LMC010DAC", "SelectListData", cmd)

        'SQLの発行
#If False Then
        'TODO:テストのためログを入れる。
        Dim strdate As Date = Now
        Dim strtime As Long = CLng(strdate.Hour.ToString.PadLeft(2, CChar("0")) & strdate.Minute.ToString.PadLeft(2, CChar("0")) & strdate.Second.ToString.PadLeft(2, CChar("0")) & strdate.Millisecond.ToString.PadLeft(3, CChar("0")))
        MyBase.Logger.WriteLog(0, "LMC010DAC", "SelectListData", "☆☆開始時間：" & Format(strdate, "yyyyMMdd") & " " & strtime)
        Dim reader As SqlDataReader = MyBase.GetSelectResult(cmd)
        Dim enddate As Date = Now
        Dim endtime As Long = CLng(enddate.Hour.ToString.PadLeft(2, CChar("0")) & enddate.Minute.ToString.PadLeft(2, CChar("0")) & enddate.Second.ToString.PadLeft(2, CChar("0")) & enddate.Millisecond.ToString.PadLeft(3, CChar("0")))
        MyBase.Logger.WriteLog(0, "LMC010DAC", "SelectListData", "☆☆終了時間：" & Format(enddate, "yyyyMMdd") & " " & endtime)
        MyBase.Logger.WriteLog(0, "LMC010DAC", "SelectListData", "☆☆経過時間：" & endtime - strtime & "ﾐﾘ秒")
#Else
        Dim reader As SqlDataReader = MyBase.GetSelectResult(cmd)
#End If
        'DataReader→DataTableへの転記
        Dim map As Hashtable = New Hashtable()

        '取得データの格納先をマッピング
        map.Add("CUST_ORD_NO", "CUST_ORD_NO")
        map.Add("OUTKA_STATE_KB_NM", "OUTKA_STATE_KB_NM")
        map.Add("OUTKA_PLAN_DATE", "OUTKA_PLAN_DATE")
        map.Add("ARR_PLAN_DATE", "ARR_PLAN_DATE")
        map.Add("CUST_NM", "CUST_NM")
        'START YANAI 要望番号748
        map.Add("CUST_CD_S", "CUST_CD_S")
        'END YANAI 要望番号748
        map.Add("DEST_NM", "DEST_NM")
        map.Add("GOODS_NM", "GOODS_NM")
        map.Add("OUTKA_PKG_NB", "OUTKA_PKG_NB")
        map.Add("OUTKA_TTL_NB", "OUTKA_TTL_NB")
        map.Add("BACKLOG_NB", "BACKLOG_NB")
        map.Add("BACKLOG_QT", "BACKLOG_QT")
        map.Add("DEST_AD", "DEST_AD")
        map.Add("DENP_NO", "DENP_NO")
        map.Add("UNSOCO_NM", "UNSOCO_NM")
        map.Add("M_COUNT", "M_COUNT")
        map.Add("S_COUNT", "S_COUNT")
        '2018/04/20 001547 【LMS】出荷データ検索画面_注文番号項目追加(千葉BC物管２_石井) Annen add start
        map.Add("BUYER_ORD_NO", "BUYER_ORD_NO")
        '2018/04/20 001547 【LMS】出荷データ検索画面_注文番号項目追加(千葉BC物管２_石井) Annen add start
        map.Add("OUTKA_NO_L", "OUTKA_NO_L")
        map.Add("SYUBETU_KB_NM", "SYUBETU_KB_NM")
        map.Add("WH_NM", "WH_NM")
        map.Add("NRS_BR_NM", "NRS_BR_NM")
        map.Add("TANTO_USER", "TANTO_USER")
        map.Add("SYS_ENT_USER", "SYS_ENT_USER")
        map.Add("SYS_UPD_USER", "SYS_UPD_USER")
        map.Add("LAST_PRINT_DATE", "LAST_PRINT_DATE")
        map.Add("LAST_PRINT_TIME", "LAST_PRINT_TIME")
        map.Add("SYS_UPD_DATE", "SYS_UPD_DATE")
        map.Add("SYS_UPD_TIME", "SYS_UPD_TIME")
        map.Add("NRS_BR_CD", "NRS_BR_CD")
        map.Add("WH_CD", "WH_CD")
        map.Add("PICK_KB", "PICK_KB")
        map.Add("OUTKA_SASHIZU_PRT_YN", "OUTKA_SASHIZU_PRT_YN")
        map.Add("OUTOKA_KANRYO_YN", "OUTOKA_KANRYO_YN")
        map.Add("OUTKA_KENPIN_YN", "OUTKA_KENPIN_YN")
        map.Add("CUST_CD_L", "CUST_CD_L")
        map.Add("CUST_CD_M", "CUST_CD_M")
        map.Add("GOODS_CD_NRS", "GOODS_CD_NRS")
        map.Add("DEST_CD", "DEST_CD")
        map.Add("OUTKA_STATE_KB", "OUTKA_STATE_KB")
        map.Add("UNSO_CD", "UNSO_CD")
        map.Add("UNSO_BR_CD", "UNSO_BR_CD")
        map.Add("UNSO_NO_L", "UNSO_NO_L")
        map.Add("UNSO_SYS_UPD_DATE", "UNSO_SYS_UPD_DATE")
        map.Add("UNSO_SYS_UPD_TIME", "UNSO_SYS_UPD_TIME")
        map.Add("LOT_NO", "LOT_NO")
        map.Add("SEIQ_FIXED_FLAG", "SEIQ_FIXED_FLAG")
        map.Add("FURI_NO", "FURI_NO")
        map.Add("NIHUDA_YN", "NIHUDA_YN")
        'START YANAI メモ②No.2
        map.Add("SASZ_USER", "SASZ_USER")
        'END YANAI メモ②No.2
        '(2012.03.08) 納品書 再発行フラグの取得 --- STRAT ---
        map.Add("NHS_FLAG", "NHS_FLAG")
        '(2012.03.08) 納品書 再発行フラグの取得 ---  END  ---
        'START YANAI 要望番号1158 一覧画面　引当前の出荷で納品書の印刷が出来てしまう
        map.Add("MIN_ALCTD_NB", "MIN_ALCTD_NB")
        map.Add("MIN_ALCTD_QT", "MIN_ALCTD_QT")
        'END YANAI 要望番号1158 一覧画面　引当前の出荷で納品書の印刷が出来てしまう
        'START YANAI 要望番号1286 入荷・出荷画面の機能追加（出荷検索にロット、シリアル）
        map.Add("LOT_NO_S", "LOT_NO_S")
        map.Add("SERIAL_NO_S", "SERIAL_NO_S")
        'END YANAI 要望番号1286 入荷・出荷画面の機能追加（出荷検索にロット、シリアル）
        '要望番号1369:(支払-運送会社変更時、タリフを再取得し、再計算をおこなう⇒運行が紐付いている場合には、運行の運送会社変更時のみ動作) 2012/08/24 本明 Start
        map.Add("TRIP_NO", "TRIP_NO")
        map.Add("TRIP_NO_SYUKA", "TRIP_NO_SYUKA")
        map.Add("TRIP_NO_TYUKEI", "TRIP_NO_TYUKEI")
        map.Add("TRIP_NO_HAIKA", "TRIP_NO_HAIKA")
        map.Add("SHIHARAI_FIXED_FLAG", "SHIHARAI_FIXED_FLAG")
        '要望番号1369:(支払-運送会社変更時、タリフを再取得し、再計算をおこなう⇒運行が紐付いている場合には、運行の運送会社変更時のみ動作) 2012/08/24 本明 End  
        map.Add("REMARK_UNSO", "REMARK_UNSO")   '要望番号1856　2013/02/21 本明
        '2013.02.27 / Notes1897：スプレッド項目の追加および画面検索条件の追加開始
        map.Add("BIN_KB", "BIN_KB")
        map.Add("BIN_KB_NM", "BIN_KB_NM")
        '2013.02.27 / Notes1897：スプレッド項目の追加および画面検索条件の追加終了
        '要望番号1961 20130322 まとめ送状対応(BPC対応) 追加START
        map.Add("CUST_DEST_CD", "CUST_DEST_CD")
        '要望番号1961 20130322 まとめ送状対応(BPC対応) 追加END

#If True Then ' 西濃自動送り状番号対応 added inoue
        map.Add("AUTO_DENP_KBN", "AUTO_DENP_KBN")
        map.Add("AUTO_DENP_NO", "AUTO_DENP_NO")
#End If

#If True Then ' 出荷作業ステータス対応 20160824 added inoue
        map.Add("WH_WORK_STATUS_NM", "WH_WORK_STATUS_NM")
#End If

#If True Then  ' FFEM機能改修(納品書未受信状態表示対応) 20170127 added
        If (isSelectExistsCoaAndDlv) Then
            map.Add("EXISTS_COA_FILE", "EXISTS_COA_FILE")
            map.Add("EXISTS_DLV_FILE", "EXISTS_DLV_FILE")
        End If
#End If
        '届出実行追加対応 2017/09/19 Annen START
        map.Add("DEST_KB", "DEST_KB")
        '届出実行追加対応 2017/09/19 Annen END

        map.Add("SYUBETU_KB", "SYUBETU_KB")

        map.Add("WEB_OUTKA_NO_L", "WEB_OUTKA_NO_L")

        'タブレット対応
        map.Add("WH_TAB_STATUS_NM", "WH_TAB_STATUS_NM")
        map.Add("COA_UMU", "COA_UMU")                           'ADD 2019/06/19 004870

        If (isSelectExistsCoaAndDlv) Then
            map.Add("SHIKAKARI_HIN_FLG", "SHIKAKARI_HIN_FLG")
            map.Add("ZFVYHKKBN", "ZFVYHKKBN")
            map.Add("MATNR", "MATNR")
            map.Add("ZFVYDENTYP", "ZFVYDENTYP")
        End If

        ds = MyBase.SetSelectResultToDataSet(map, ds, reader, "LMC010OUT")

        '処理件数の設定
        MyBase.SetResultCount(ds.Tables("LMC010OUT").Rows.Count())
        reader.Close()

        Return ds

    End Function

    '2013.02.18 アグリマート対応 START
    ''' <summary>
    ''' 出荷ピッキングワークデータ対象データ抽出
    ''' </summary>
    ''' <param name="ds">DataSet</param>
    ''' <returns>DataSet</returns>
    ''' <remarks>出荷ピッキングワークデータ取得SQLの構築・発行</remarks>
    Private Function SelectOutkaPickWk(ByVal ds As DataSet) As DataSet

        'DataSetのIN情報を取得
        Dim inTbl As DataTable = ds.Tables("LMC010_OUTKA_M_IN")

        'INTableの条件rowの格納
        Me._Row = inTbl.Rows(0)

        'SQL格納変数の初期化
        Me._StrSql = New StringBuilder()

        'SQL作成
        Me._StrSql.Append(LMC010DAC.SQL_SELECT_C_OUTKA_PICK_WK)
        Call Me.setSQLSelectOutkaM()                   '条件設定

        'スキーマ名設定
        Dim sql As String = Me.SetSchemaNm(Me._StrSql.ToString(), Me._Row.Item("NRS_BR_CD").ToString())

        'SQL文のコンパイル
        Dim cmd As SqlCommand = MyBase.CreateSqlCommand(sql)

        'パラメータの反映
        For Each obj As Object In Me._SqlPrmList
            cmd.Parameters.Add(obj)
        Next

        MyBase.Logger.WriteSQLLog("LMC010DAC", "SelectOutkaPickWk", cmd)

        'SQLの発行
        Dim reader As SqlDataReader = MyBase.GetSelectResult(cmd)

        'DataReader→DataTableへの転記
        Dim map As Hashtable = New Hashtable()

        '取得データの格納先をマッピング
        map.Add("NRS_BR_CD", "NRS_BR_CD")
        map.Add("OUTKA_NO_L", "OUTKA_NO_L")
        map.Add("OUTKA_NO_M", "OUTKA_NO_M")
        map.Add("SERIAL_NO", "SERIAL_NO")
        map.Add("HIKI_STATE_KBN", "HIKI_STATE_KBN")
        map.Add("SYS_UPD_DATE", "SYS_UPD_DATE")
        map.Add("SYS_UPD_TIME", "SYS_UPD_TIME")
        map.Add("SYS_DEL_FLG", "SYS_DEL_FLG")

        ds = MyBase.SetSelectResultToDataSet(map, ds, reader, "LMC010_OUTKA_M_PICK_WK")

        '処理件数の設定
        MyBase.SetResultCount(ds.Tables("LMC010_OUTKA_M_PICK_WK").Rows.Count())
        reader.Close()

        Return ds

    End Function
    '2013.02.18 アグリマート対応 END

    ''' <summary>
    ''' 出荷データM検索対象データ件数検索
    ''' </summary>
    ''' <param name="ds">DataSet</param>
    ''' <returns>DataSet</returns>
    ''' <remarks>出荷データLテーブル更新対象データ検索件数取得SQLの構築・発行</remarks>
    Private Function SelectOutkaM(ByVal ds As DataSet) As DataSet

        'DataSetのIN情報を取得
        Dim inTbl As DataTable = ds.Tables("LMC010_OUTKA_M_IN")

        'INTableの条件rowの格納
        Me._Row = inTbl.Rows(0)

        'SQL格納変数の初期化
        Me._StrSql = New StringBuilder()

        'SQL作成
        Me._StrSql.Append(LMC010DAC.SQL_SELECT_OUTKA_M)
        If Me._Row.Item("IS_FFEM_MATERIAL_PLANT_TRANSFER").ToString() <> LMConst.FLG.ON Then
            Me._StrSql.Append(LMC010DAC.SQL_SELECT_OUTKA_M_2)
        End If
        Me._StrSql.Append(LMC010DAC.SQL_SELECT_OUTKA_M_3)
        Call Me.setSQLSelectOutkaM()                   '条件設定
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@SYS_UPD_DATE", Me._Row("SYS_UPD_DATE"), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@SYS_UPD_TIME", Me._Row("SYS_UPD_TIME"), DBDataType.CHAR))

        'スキーマ名設定
        Dim sql As String = Me.SetSchemaNm(Me._StrSql.ToString(), Me._Row.Item("NRS_BR_CD").ToString())

        'SQL文のコンパイル
        Dim cmd As SqlCommand = MyBase.CreateSqlCommand(sql)

        'パラメータの反映
        For Each obj As Object In Me._SqlPrmList
            cmd.Parameters.Add(obj)
        Next

        MyBase.Logger.WriteSQLLog("LMC010DAC", "SelectOutkaM", cmd)

        'SQLの発行
        Dim reader As SqlDataReader = MyBase.GetSelectResult(cmd)

        'DataReader→DataTableへの転記
        Dim map As Hashtable = New Hashtable()

        '取得データの格納先をマッピング
        map.Add("OUTKA_NO_L", "OUTKA_NO_L")
        map.Add("OUTKA_NO_M", "OUTKA_NO_M")
        map.Add("OUTKA_NO_S", "OUTKA_NO_S")
        map.Add("SERIAL_NO", "SERIAL_NO")
        map.Add("RSV_NO", "RSV_NO")
        map.Add("IRIME", "IRIME")
        'START YANAI 20110914 一括引当対応
        map.Add("ALCTD_NB", "ALCTD_NB")
        'END YANAI 20110914 一括引当対応
        map.Add("ALCTD_KB", "ALCTD_KB")
        map.Add("BACKLOG_NB", "BACKLOG_NB")
        map.Add("ALCTD_QT", "ALCTD_QT")
        map.Add("BACKLOG_QT", "BACKLOG_QT")
        map.Add("OUTKA_HASU", "OUTKA_HASU")
        map.Add("OUTKA_TTL_NB", "OUTKA_TTL_NB")
        map.Add("OUTKA_TTL_QT", "OUTKA_TTL_QT")
        map.Add("OUTKA_PKG_NB", "OUTKA_PKG_NB")
        'START YANAI 20110914 一括引当対応
        map.Add("OUTKA_STATE_KB", "OUTKA_STATE_KB")
        map.Add("PICK_KB", "PICK_KB")
        map.Add("WH_CD", "WH_CD")
        'END YANAI 20110914 一括引当対応
        map.Add("SYS_UPD_DATE", "SYS_UPD_DATE")
        map.Add("SYS_UPD_TIME", "SYS_UPD_TIME")
        map.Add("PKG_NB", "PKG_NB")
        map.Add("GOODS_CD_NRS", "GOODS_CD_NRS")
        map.Add("GOODS_NM", "GOODS_NM")
        map.Add("LOT_NO", "LOT_NO")
        'START YANAI メモ②No.27
        map.Add("GOODS_CD_NRS_FROM", "GOODS_CD_NRS_FROM")
        'END YANAI メモ②No.27
        'START YANAI 要望番号585
        map.Add("TARE_YN", "TARE_YN")
        map.Add("UNSO_NO_L", "UNSO_NO_L")
        map.Add("UNSOL_SYS_UPD_DATE", "UNSOL_SYS_UPD_DATE")
        map.Add("UNSOL_SYS_UPD_TIME", "UNSOL_SYS_UPD_TIME")
        'END YANAI 要望番号585
        'START YANAI 要望番号638
        map.Add("UNSO_NO_M", "UNSO_NO_M")
        map.Add("UNCHIN_SYS_UPD_DATE", "UNCHIN_SYS_UPD_DATE")
        map.Add("UNCHIN_SYS_UPD_TIME", "UNCHIN_SYS_UPD_TIME")
        map.Add("UNSO_TEHAI_KB", "UNSO_TEHAI_KB")
        'END YANAI 要望番号638
        'START YANAI 要望番号1474 一括引当時、引当が出来ない場合のエラーメッセージ変更
        map.Add("GOODS_CD_CUST", "GOODS_CD_CUST")
        'END YANAI 要望番号1474 一括引当時、引当が出来ない場合のエラーメッセージ変更


#If True Then ' 西濃自動送り状番号対応 20160701 added inoue
        map.Add("AUTO_DENP_KBN", "AUTO_DENP_KBN")
        map.Add("AUTO_DENP_NO", "AUTO_DENP_NO")
#End If

        ds = MyBase.SetSelectResultToDataSet(map, ds, reader, "LMC010_OUTKA_M_OUT")

        '処理件数の設定
        MyBase.SetResultCount(ds.Tables("LMC010_OUTKA_M_OUT").Rows.Count())
        reader.Close()

        Return ds

    End Function

    ''' <summary>
    ''' 出荷データM検索対象データ件数検索
    ''' </summary>
    ''' <param name="ds">DataSet</param>
    ''' <returns>DataSet</returns>
    ''' <remarks>出荷データLテーブル更新対象データ検索件数取得SQLの構築・発行</remarks>
    Private Function SelectCountOutkaM(ByVal ds As DataSet) As DataSet

        'DataSetのIN情報を取得
        Dim inTbl As DataTable = ds.Tables("LMC010_OUTKA_M_IN")

        'INTableの条件rowの格納
        Me._Row = inTbl.Rows(0)

        'SQL格納変数の初期化
        Me._StrSql = New StringBuilder()

        'SQL作成
        Me._StrSql.Append(LMC010DAC.SQL_SELECT_COUNT_OUTKA_M)
        Call Me.setSQLSelectOutkaM()                   '条件設定

        'スキーマ名設定
        Dim sql As String = Me.SetSchemaNm(Me._StrSql.ToString(), Me._Row.Item("NRS_BR_CD").ToString())

        'SQL文のコンパイル
        Dim cmd As SqlCommand = MyBase.CreateSqlCommand(sql)

        'パラメータの反映
        For Each obj As Object In Me._SqlPrmList
            cmd.Parameters.Add(obj)
        Next

        MyBase.Logger.WriteSQLLog("LMC010DAC", "SelectOutkaCountM", cmd)

        'SQLの発行
        Dim reader As SqlDataReader = MyBase.GetSelectResult(cmd)

        'DataReader→DataTableへの転記
        Dim map As Hashtable = New Hashtable()

        '取得データの格納先をマッピング
        map.Add("CNT", "CNT")

        ds = MyBase.SetSelectResultToDataSet(map, ds, reader, "LMC010_OUTKA_M_CONUNT_OUT")

        '処理件数の設定
        'MyBase.SetResultCount(ds.Tables("LMC010_OUTKA_M_OUT").Rows.Count())
        reader.Close()

        Return ds

    End Function

    ''' <summary>
    ''' 出荷データM検索対象データ検索(分析票)
    ''' </summary>
    ''' <param name="ds">DataSet</param>
    ''' <returns>DataSet</returns>
    ''' <remarks>出荷データLテーブル更新対象データ検索件数取得SQLの構築・発行</remarks>
    Private Function SelectBunsekiOutkaM(ByVal ds As DataSet) As DataSet

        'DataSetのIN情報を取得
        Dim inTbl As DataTable = ds.Tables("LMC010_OUTKA_M_BUNSEKI_IN")

        'INTableの条件rowの格納
        Me._Row = inTbl.Rows(0)

        'SQL格納変数の初期化
        Me._StrSql = New StringBuilder()

        'SQL作成
        Me._StrSql.Append(LMC010DAC.SQL_SELECT_BUNSEKI_OUTKA_M)
        Call Me.setSQLSelectBunsekiOutkaM()                   '条件設定

        'スキーマ名設定
        Dim sql As String = Me.SetSchemaNm(Me._StrSql.ToString(), Me._Row.Item("NRS_BR_CD").ToString())

        'SQL文のコンパイル
        Dim cmd As SqlCommand = MyBase.CreateSqlCommand(sql)

        'パラメータの反映
        For Each obj As Object In Me._SqlPrmList
            cmd.Parameters.Add(obj)
        Next

        MyBase.Logger.WriteSQLLog("LMC010DAC", "SelectBunsekiOutkaM", cmd)

        'SQLの発行
        Dim reader As SqlDataReader = MyBase.GetSelectResult(cmd)

        'DataReader→DataTableへの転記
        Dim map As Hashtable = New Hashtable()

        '取得データの格納先をマッピング
        map.Add("NRS_BR_CD", "NRS_BR_CD")
        map.Add("GOODS_CD_NRS", "GOODS_CD_NRS")
        map.Add("CUST_CD_L", "CUST_CD_L")
        map.Add("DEST_CD", "DEST_CD")
        map.Add("CUST_NM_L", "CUST_NM_L")
        map.Add("LOT_NO", "LOT_NO")
        map.Add("ROW_NO", "ROW_NO")
        '2014.10.02 高取対応追加START
        map.Add("GOODS_CD_CUST", "GOODS_CD_CUST")
        '2014.10.02 高取対応追加START
        map.Add("INKA_DATE", "INKA_DATE")   'ADD 2018/11/14 要望番号001939

        ds = MyBase.SetSelectResultToDataSet(map, ds, reader, "LMC010_OUTKA_M_BUNSEKI_OUT")

        '処理件数の設定
        MyBase.SetResultCount(ds.Tables("LMC010_OUTKA_M_BUNSEKI_OUT").Rows.Count())
        reader.Close()

        Return ds

    End Function

    ''' <summary>
    ''' 出荷データM検索対象データ検索(イエローカード)
    ''' </summary>
    ''' <param name="ds">DataSet</param>
    ''' <returns>DataSet</returns>
    ''' <remarks>出荷データLテーブル更新対象データ検索件数取得SQLの構築・発行</remarks>
    Private Function SelectYCardOutkaM(ByVal ds As DataSet) As DataSet

        'DataSetのIN情報を取得
        Dim inTbl As DataTable = ds.Tables("LMC010_OUTKA_M_YCARD_IN")

        'INTableの条件rowの格納
        Me._Row = inTbl.Rows(0)

        'SQL格納変数の初期化
        Me._StrSql = New StringBuilder()

        'SQL作成
        Me._StrSql.Append(LMC010DAC.SQL_SELECT_YCARD_OUTKA_M)
        Call Me.setSQLSelectYCardOutkaM()

        'スキーマ名設定
        Dim sql As String = Me.SetSchemaNm(Me._StrSql.ToString(), Me._Row.Item("NRS_BR_CD").ToString())

        'SQL文のコンパイル
        Dim cmd As SqlCommand = MyBase.CreateSqlCommand(sql)

        'パラメータの反映
        For Each obj As Object In Me._SqlPrmList
            cmd.Parameters.Add(obj)
        Next

        MyBase.Logger.WriteSQLLog("LMC010DAC", "SelectYCardOutkaM", cmd)

        'SQLの発行
        Dim reader As SqlDataReader = MyBase.GetSelectResult(cmd)

        'DataReader→DataTableへの転記
        Dim map As Hashtable = New Hashtable()

        '取得データの格納先をマッピング
        map.Add("NRS_BR_CD", "NRS_BR_CD")
        map.Add("CUST_CD_L", "CUST_CD_L")
        map.Add("CUST_NM_L", "CUST_NM_L")
        map.Add("GOODS_CD_NRS", "GOODS_CD_NRS")
        map.Add("LOT_NO", "LOT_NO")
        map.Add("ROW_NO", "ROW_NO")
        map.Add("GOODS_CD_CUST", "GOODS_CD_CUST")
        map.Add("SHOBO_CD", "SHOBO_CD")
        map.Add("YCARD_LINK", "YCARD_LINK")
        map.Add("YCARD_NAME", "YCARD_NAME")

        ds = MyBase.SetSelectResultToDataSet(map, ds, reader, "LMC010_OUTKA_M_YCARD_OUT")

        '処理件数の設定
        MyBase.SetResultCount(ds.Tables("LMC010_OUTKA_M_YCARD_OUT").Rows.Count())
        reader.Close()

        Return ds

    End Function

    'START YANAI 要望番号773
    ''' <summary>
    ''' データ検索処理(出荷報告Excel作成時)
    ''' </summary>
    ''' <param name="ds">DataSet</param>
    ''' <returns>DataSet</returns>
    ''' <remarks>出荷報告Excel出力対象データ検索結果取得SQLの構築・発行</remarks>
    Private Function SelectHoukokuExcel(ByVal ds As DataSet) As DataSet

        'DataSetのIN情報を取得
        Dim inTbl As DataTable = ds.Tables("LMC010IN_HOUKOKU_EXCEL")

        'INTableの条件rowの格納
        Me._Row = inTbl.Rows(0)

        'SQL格納変数の初期化
        Me._StrSql = New StringBuilder()
        Me._StrSqlOrderBy = New StringBuilder()

        If "10".Equals(Me._Row.Item("NRS_BR_CD").ToString()) = True Then
            'SQL作成
            Me._StrSql.Append(LMC010DAC.SQL_SELECT_HOUKOKU_EXCEL_FOR_CHIBA)       'SQL構築(データ抽出用SELECT句)
            Me._StrSql.Append(LMC010DAC.SQL_SELECT_FROM_HOUKOKU_EXCEL_FOR_CHIBA_1)  'SQL構築(データ抽出用FROM句)
            Me._StrSql.Append(Me.SetHoukokuChibaExcelSQL(inTbl))                           '条件設定
            Me._StrSql.Append(LMC010DAC.SQL_SELECT_FROM_HOUKOKU_EXCEL_FOR_CHIBA_2)  'SQL構築(データ抽出用FROM句)
            Call Me.SetHoukokuExcelSQL(inTbl)                           '条件設定
            Me._StrSql.Append(LMC010DAC.SQL_SELECT_GROUP_HOUKOKU_EXCEL_FOR_CHIBA) 'SQL構築(データ抽出用GROUP BY句)
            Me._StrSql.Append(LMC010DAC.SQL_SELECT_ORDER_HOUKOKU_EXCEL_FOR_CHIBA) 'SQL構築(データ抽出用ORDER BY句)
        Else
            'SQL作成
            Me._StrSql.Append(LMC010DAC.SQL_SELECT_HOUKOKU_EXCEL)       'SQL構築(データ抽出用SELECT句)
            Me._StrSql.Append(LMC010DAC.SQL_SELECT_FROM_HOUKOKU_EXCEL)  'SQL構築(データ抽出用FROM句)
            Call Me.SetHoukokuExcelSQL(inTbl)                           '条件設定
            Me._StrSql.Append(LMC010DAC.SQL_SELECT_GROUP_HOUKOKU_EXCEL) 'SQL構築(データ抽出用GROUP BY句)
            Me._StrSql.Append(LMC010DAC.SQL_SELECT_ORDER_HOUKOKU_EXCEL) 'SQL構築(データ抽出用ORDER BY句)
        End If

        'スキーマ名設定
        Dim sql As String = Me.SetSchemaNm(Me._StrSql.ToString(), Me._Row.Item("NRS_BR_CD").ToString())

        'SQL文のコンパイル
        Dim cmd As SqlCommand = MyBase.CreateSqlCommand(sql)

        'パラメータの反映
        For Each obj As Object In Me._SqlPrmList
            cmd.Parameters.Add(obj)
        Next

        MyBase.Logger.WriteSQLLog("LMC010DAC", "SelectHoukokuExcel", cmd)

        'SQLの発行
        Dim reader As SqlDataReader = MyBase.GetSelectResult(cmd)

        'DataReader→DataTableへの転記
        Dim map As Hashtable = New Hashtable()

        '取得データの格納先をマッピング
        map.Add("CUST_ORD_NO", "CUST_ORD_NO")
        map.Add("OUTKA_NO_L", "OUTKA_NO_L")
        map.Add("OUTKA_NO_M", "OUTKA_NO_M")
        map.Add("CUST_ORD_NO_DTL", "CUST_ORD_NO_DTL")
        map.Add("OUTKA_PLAN_DATE", "OUTKA_PLAN_DATE")
        map.Add("DEST_CD", "DEST_CD")
        map.Add("GOODS_CD_CUST", "GOODS_CD_CUST")
        map.Add("GOODS_NM_1", "GOODS_NM_1")
        map.Add("LOT_NO", "LOT_NO")
        map.Add("OUTKA_TTL_QT", "OUTKA_TTL_QT")
        map.Add("DENP_NO", "DENP_NO")
        map.Add("DEST_NM", "DEST_NM")
        map.Add("DEST_AD_1", "DEST_AD_1")
        map.Add("DEST_AD_2", "DEST_AD_2")
        map.Add("DEST_AD_3", "DEST_AD_3")
        map.Add("UNSOCO_NM", "UNSOCO_NM")
        map.Add("UNSOCO_BR_NM", "UNSOCO_BR_NM")

        ds = MyBase.SetSelectResultToDataSet(map, ds, reader, "LMC010OUT_HOUKOKU_EXCEL")

        '処理件数の設定
        MyBase.SetResultCount(ds.Tables("LMC010OUT_HOUKOKU_EXCEL").Rows.Count())
        reader.Close()

        Return ds

    End Function
    'END YANAI 要望番号773

    'START YANAI 要望番号853 まとめ処理対応
    ''' <summary>
    ''' データ検索処理(出荷報告Excel作成時)
    ''' </summary>
    ''' <param name="ds">DataSet</param>
    ''' <returns>DataSet</returns>
    ''' <remarks>出荷報告Excel出力対象データ検索結果取得SQLの構築・発行</remarks>
    Private Function SelectZaiDataMATOME(ByVal ds As DataSet) As DataSet

        'DataSetのIN情報を取得
        Dim inTbl As DataTable = ds.Tables("LMC010_ZAI_MATOME_IN")

        'INTableの条件rowの格納
        Me._Row = inTbl.Rows(0)

        'SQL格納変数の初期化
        Me._StrSql = New StringBuilder()

        'SQLパラメータ初期化
        Me._SqlPrmList = New ArrayList()

        'SQL作成
        Me._StrSql.Append(LMC010DAC.SQL_SELECT_ZAI_MATOME)       'SQL構築(データ抽出用SELECT句)
        Me._StrSql.Append(LMC010DAC.SQL_SELECT_FROM_ZAI_MATOME)  'SQL構築(データ抽出用FROM句)
        Me._StrSql.Append(LMC010DAC.SQL_SELECT_WHERE_ZAI_MATOME) 'SQL構築(データ抽出用WHERE句)
        'START YANAI 要望番号780
        'If String.IsNullOrEmpty(inTbl.Rows(0).Item("INKO_DATE").ToString) = False Then
        '    Me._StrSql.Append(LMC010DAC.SQL_WHERE_INKODATE) 'SQL構築(データ抽出用WHERE句)
        '    Me._StrSql.Append(LMC010DAC.SQL_SELECT_GROUP_ZAI_MATOME) 'SQL構築(データ抽出用GROUP BY句)
        '    Me._StrSql.Append(LMC010DAC.SQL_GROUP_INKODATE) 'SQL構築(データ抽出用GROUP BY句)
        'Else
        '    Me._StrSql.Append(LMC010DAC.SQL_WHERE_INKOPLANDATE) 'SQL構築(データ抽出用WHERE句)
        '    Me._StrSql.Append(LMC010DAC.SQL_SELECT_GROUP_ZAI_MATOME) 'SQL構築(データ抽出用GROUP BY句)
        '    Me._StrSql.Append(LMC010DAC.SQL_GROUP_INKOPLANDATE) 'SQL構築(データ抽出用GROUP BY句)
        'End If
        'upd s.kobayashi NotesNo.1572 "01"-->"1"
        If ("1").Equals(inTbl.Rows(0).Item("INKA_DATE_KANRI_KB").ToString) = True Then
            Me._StrSql.Append(LMC010DAC.SQL_SELECT_GROUP_ZAI_MATOME) 'SQL構築(データ抽出用GROUP BY句)
        ElseIf String.IsNullOrEmpty(inTbl.Rows(0).Item("INKO_DATE").ToString) = False Then
            Me._StrSql.Append(LMC010DAC.SQL_WHERE_INKODATE) 'SQL構築(データ抽出用WHERE句)
            Me._StrSql.Append(LMC010DAC.SQL_SELECT_GROUP_ZAI_MATOME) 'SQL構築(データ抽出用GROUP BY句)
            Me._StrSql.Append(LMC010DAC.SQL_GROUP_INKODATE) 'SQL構築(データ抽出用GROUP BY句)
        Else
            Me._StrSql.Append(LMC010DAC.SQL_WHERE_INKOPLANDATE) 'SQL構築(データ抽出用WHERE句)
            Me._StrSql.Append(LMC010DAC.SQL_SELECT_GROUP_ZAI_MATOME) 'SQL構築(データ抽出用GROUP BY句)
            Me._StrSql.Append(LMC010DAC.SQL_GROUP_INKOPLANDATE) 'SQL構築(データ抽出用GROUP BY句)
        End If
        'END YANAI 要望番号780

        'パラメータ設定
        Call Me.SetSelectParamZaiMATOME(Me._SqlPrmList)

        'START YANAI 要望番号780
        'If String.IsNullOrEmpty(inTbl.Rows(0).Item("INKO_DATE").ToString) = False Then
        '    Me._SqlPrmList.Add(MyBase.GetSqlParameter("@INKO_DATE", inTbl.Rows(0).Item("INKO_DATE").ToString, DBDataType.CHAR))
        'Else
        '    Me._SqlPrmList.Add(MyBase.GetSqlParameter("@INKO_PLAN_DATE", inTbl.Rows(0).Item("INKO_PLAN_DATE").ToString, DBDataType.CHAR))
        'End If
        'upd s.kobayashi NotesNo.1572 "01"-->"1"
        If ("1").Equals(inTbl.Rows(0).Item("INKA_DATE_KANRI_KB").ToString) = True Then
            '何もしない
        ElseIf String.IsNullOrEmpty(inTbl.Rows(0).Item("INKO_DATE").ToString) = False Then
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@INKO_DATE", inTbl.Rows(0).Item("INKO_DATE").ToString, DBDataType.CHAR))
        Else
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@INKO_PLAN_DATE", inTbl.Rows(0).Item("INKO_PLAN_DATE").ToString, DBDataType.CHAR))
        End If
        'END YANAI 要望番号780

        'スキーマ名設定
        Dim sql As String = Me.SetSchemaNm(Me._StrSql.ToString(), Me._Row.Item("NRS_BR_CD").ToString())

        'SQL文のコンパイル
        Dim cmd As SqlCommand = MyBase.CreateSqlCommand(sql)

        'パラメータの反映
        For Each obj As Object In Me._SqlPrmList
            cmd.Parameters.Add(obj)
        Next

        MyBase.Logger.WriteSQLLog("LMC010DAC", "SelectZaiDataMATOME", cmd)

        'SQLの発行
        Dim reader As SqlDataReader = MyBase.GetSelectResult(cmd)

        'DataReader→DataTableへの転記
        Dim map As Hashtable = New Hashtable()

        '取得データの格納先をマッピング
        map.Add("ALLOC_CAN_NB", "ALLOC_CAN_NB")
        map.Add("ALLOC_CAN_QT", "ALLOC_CAN_QT")

        ds = MyBase.SetSelectResultToDataSet(map, ds, reader, "LMC010_ZAI_MATOME_OUT")

        '処理件数の設定
        MyBase.SetResultCount(ds.Tables("LMC010_ZAI_MATOME_OUT").Rows.Count())
        reader.Close()

        Return ds

    End Function
    'END YANAI 要望番号853 まとめ処理対応

    'START YANAI 20120615 まとめ荷札・送状対応(埼玉浮間対応)
    ''' <summary>
    ''' 検索対象データの検索
    ''' </summary>
    ''' <param name="ds">DataSet</param>  
    ''' <returns>DataSet</returns>
    ''' <remarks></remarks>
    Private Function SelectMatomeData(ByVal ds As DataSet) As DataSet

        'DataSetのIN情報を取得
        Dim inTbl As DataTable = ds.Tables("LMC010IN_OUTKA_L")

        'SQL格納変数の初期化
        Me._StrSql = New StringBuilder()

        'SQLパラメータ初期化
        Me._SqlPrmList = New ArrayList()

        'SQL作成
        Select Case inTbl.Rows(0).Item("MATOME_DEST_KBN").ToString()

            Case "00"
                Me._StrSql.Append(LMC010DAC.SQL_SELECT_PRINTMATOMEDATA)       'SQL構築 SELECT句
            Case "01"
                Me._StrSql.Append(LMC010DAC.SQL_SELECT_PRINTMATOMEDATA_BP)       'SQL構築 SELECT句(BP)
                Me._SqlPrmList.Add(MyBase.GetSqlParameter("@CUST_DEST_CD", inTbl.Rows(0).Item("CUST_DEST_CD").ToString(), DBDataType.NVARCHAR))
            Case Else
                Me._StrSql.Append(LMC010DAC.SQL_SELECT_PRINTMATOMEDATA)       'SQL構築 SELECT句
        End Select

        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@NRS_BR_CD", inTbl.Rows(0).Item("NRS_BR_CD").ToString(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@OUTKA_STATE_KB", inTbl.Rows(0).Item("OUTKA_STATE_KB").ToString(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@PRINT_KB", inTbl.Rows(0).Item("PRINT_KB").ToString(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@OUTKA_PKG_NB", inTbl.Rows(0).Item("OUTKA_PKG_NB").ToString(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@CUST_CD_L", inTbl.Rows(0).Item("CUST_CD_L").ToString(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@CUST_CD_M", inTbl.Rows(0).Item("CUST_CD_M").ToString(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@OUTKA_PLAN_DATE", inTbl.Rows(0).Item("OUTKA_PLAN_DATE").ToString(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@ARR_PLAN_DATE", inTbl.Rows(0).Item("ARR_PLAN_DATE").ToString(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@UNSO_CD", inTbl.Rows(0).Item("UNSO_CD").ToString(), DBDataType.NVARCHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@UNSO_BR_CD", inTbl.Rows(0).Item("UNSO_BR_CD").ToString(), DBDataType.NVARCHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@DEST_CD", inTbl.Rows(0).Item("DEST_CD").ToString(), DBDataType.NVARCHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@ROW_NO", inTbl.Rows(0).Item("ROW_NO").ToString(), DBDataType.NVARCHAR))

        'スキーマ名設定
        Dim sql As String = Me.SetSchemaNm(Me._StrSql.ToString(), inTbl.Rows(0).Item("NRS_BR_CD").ToString())

        'SQL文のコンパイル
        Dim cmd As SqlCommand = MyBase.CreateSqlCommand(sql)

        'パラメータの反映
        For Each obj As Object In Me._SqlPrmList
            cmd.Parameters.Add(obj)
        Next

        MyBase.Logger.WriteSQLLog("LMC010DAC", "SelectMatomeData", cmd)

        'SQLの発行
        Dim reader As SqlDataReader = MyBase.GetSelectResult(cmd)

        'DataReader→DataTableへの転記
        Dim map As Hashtable = New Hashtable()

        '取得データの格納先をマッピング
        map.Add("NRS_BR_CD", "NRS_BR_CD")
        map.Add("OUTKA_NO_L", "OUTKA_NO_L")
        map.Add("OUTKA_STATE_KB", "OUTKA_STATE_KB")
        map.Add("OUTKA_PKG_NB", "OUTKA_PKG_NB")
        map.Add("PRINT_KB", "PRINT_KB")
        map.Add("SYS_UPD_DATE", "SYS_UPD_DATE")
        map.Add("SYS_UPD_TIME", "SYS_UPD_TIME")
        map.Add("ROW_NO", "ROW_NO")

        ds = MyBase.SetSelectResultToDataSet(map, ds, reader, "LMC010OUT_MATOME")

        reader.Close()

        Return ds

    End Function
    'END YANAI 20120615 まとめ荷札・送状対応(埼玉浮間対応)

#If True Then   'ADD 2018/10/17 ADD 2018/*10/17 依頼番号 : 002601   【LMS】日医工_まとめ送状(選択)_送り状番号更新 ＋ オーダー番号最小の個数のみ送り状表示(千葉BC柴田) 
    ''' <summary>
    ''' 検索対象データの検索 ※纏め送り状（選択）専用
    ''' </summary>
    ''' <param name="ds">DataSet</param>  
    ''' <returns>DataSet</returns>
    ''' <remarks></remarks>
    Private Function SelectMatomeDataSelect(ByVal ds As DataSet) As DataSet

        'DataSetのIN情報を取得
        Dim inTbl As DataTable = ds.Tables("LMC010IN_OUTKA_L")

        'SQL格納変数の初期化
        Me._StrSql = New StringBuilder()

        'SQLパラメータ初期化
        Me._SqlPrmList = New ArrayList()

        'SQL作成
        '纏め送り状（選択時）
        Me._StrSql.Append(LMC010DAC.SQL_SELECT_PRINTMATOMEDATA_SELECT)       'SQL構築 SELECT句

        '選択出荷管理番号設定(LMC010IN_OUTKA_L_SELECTより設定)
        Dim sOutkaLNo As String = String.Empty

        If ds.Tables("LMC010IN_OUTKA_L_SELECT").Rows.Count > 0 Then

            For i As Integer = 0 To ds.Tables("LMC010IN_OUTKA_L_SELECT").Rows.Count - 1
                If String.Empty.Equals(sOutkaLNo) = True Then

                    sOutkaLNo = String.Concat("'", ds.Tables("LMC010IN_OUTKA_L_SELECT").Rows(i).Item("OUTKA_NO_L").ToString.Trim, "'")
                Else

                    sOutkaLNo = String.Concat(sOutkaLNo, ",'", ds.Tables("LMC010IN_OUTKA_L_SELECT").Rows(i).Item("OUTKA_NO_L").ToString.Trim, "'")
                End If

            Next
        End If

        Me._StrSql.Append(String.Concat("   AND UNSOL.INOUTKA_NO_L IN (", sOutkaLNo, ")"))

        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@NRS_BR_CD", inTbl.Rows(0).Item("NRS_BR_CD").ToString(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@OUTKA_STATE_KB", inTbl.Rows(0).Item("OUTKA_STATE_KB").ToString(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@PRINT_KB", inTbl.Rows(0).Item("PRINT_KB").ToString(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@OUTKA_PKG_NB", inTbl.Rows(0).Item("OUTKA_PKG_NB").ToString(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@CUST_CD_L", inTbl.Rows(0).Item("CUST_CD_L").ToString(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@CUST_CD_M", inTbl.Rows(0).Item("CUST_CD_M").ToString(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@OUTKA_PLAN_DATE", inTbl.Rows(0).Item("OUTKA_PLAN_DATE").ToString(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@ARR_PLAN_DATE", inTbl.Rows(0).Item("ARR_PLAN_DATE").ToString(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@UNSO_CD", inTbl.Rows(0).Item("UNSO_CD").ToString(), DBDataType.NVARCHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@UNSO_BR_CD", inTbl.Rows(0).Item("UNSO_BR_CD").ToString(), DBDataType.NVARCHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@DEST_CD", inTbl.Rows(0).Item("DEST_CD").ToString(), DBDataType.NVARCHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@ROW_NO", inTbl.Rows(0).Item("ROW_NO").ToString(), DBDataType.NVARCHAR))

        'スキーマ名設定
        Dim sql As String = Me.SetSchemaNm(Me._StrSql.ToString(), inTbl.Rows(0).Item("NRS_BR_CD").ToString())

        'SQL文のコンパイル
        Dim cmd As SqlCommand = MyBase.CreateSqlCommand(sql)

        'パラメータの反映
        For Each obj As Object In Me._SqlPrmList
            cmd.Parameters.Add(obj)
        Next

        MyBase.Logger.WriteSQLLog("LMC010DAC", "SelectMatomeDataSelect", cmd)

        'SQLの発行
        Dim reader As SqlDataReader = MyBase.GetSelectResult(cmd)

        'DataReader→DataTableへの転記
        Dim map As Hashtable = New Hashtable()

        '取得データの格納先をマッピング
        map.Add("NRS_BR_CD", "NRS_BR_CD")
        map.Add("OUTKA_NO_L", "OUTKA_NO_L")
        map.Add("OUTKA_STATE_KB", "OUTKA_STATE_KB")
        map.Add("OUTKA_PKG_NB", "OUTKA_PKG_NB")
        map.Add("PRINT_KB", "PRINT_KB")
        map.Add("SYS_UPD_DATE", "SYS_UPD_DATE")
        map.Add("SYS_UPD_TIME", "SYS_UPD_TIME")
        map.Add("ROW_NO", "ROW_NO")

        ds = MyBase.SetSelectResultToDataSet(map, ds, reader, "LMC010OUT_MATOME")


        reader.Close()
        Return ds

    End Function

#End If

    'ADD 2016/08/29　まとめ送状対応　要望番号:2615 Start
    ''' <summary>
    ''' まとめUNSO_Lより最小のAUTO_DENP_NO取得
    ''' </summary>
    ''' <param name="ds">DataSet</param>
    ''' <returns>DataSet</returns>
    ''' <remarks></remarks>
    Private Function SelectMatomeAutoDenpNo(ByVal ds As DataSet) As DataSet

        'DataSetのIN情報を取得
        Dim inTbl As DataTable = ds.Tables("LMC010IN_MATOME_DENP_NO")

        'SQL格納変数の初期化
        Me._StrSql = New StringBuilder()

        'SQLパラメータ初期化
        Me._SqlPrmList = New ArrayList()

        'SQL作成

        Dim sMatome As String = inTbl.Rows(0).Item("MATOME_OUTKA_L").ToString

        Me._StrSql.Append(LMC010DAC.SQL_SELECT_MATOME_UNSO_AUTO_DENP_NO_DATA)       'SQL構築 SELECT句
        Me._StrSql.Append(String.Concat(LMC010DAC.SQL_SELECT_MATOME_UNSO_AUTO_DENP_NO_DATA2, sMatome, ")"))
        Me._StrSql.Append(LMC010DAC.SQL_SELECT_MATOME_UNSO_AUTO_DENP_NO_GROUP)

        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@NRS_BR_CD", inTbl.Rows(0).Item("NRS_BR_CD").ToString(), DBDataType.CHAR))
        'Me._SqlPrmList.Add(MyBase.GetSqlParameter("@MATOME_OUTKA_L", inTbl.Rows(0).Item("MATOME_OUTKA_L").ToString(), DBDataType.CHAR))

        'スキーマ名設定
        Dim sql As String = Me.SetSchemaNm(Me._StrSql.ToString(), inTbl.Rows(0).Item("NRS_BR_CD").ToString())

        'SQL文のコンパイル
        Dim cmd As SqlCommand = MyBase.CreateSqlCommand(sql)

        'パラメータの反映
        For Each obj As Object In Me._SqlPrmList
            cmd.Parameters.Add(obj)
        Next

        MyBase.Logger.WriteSQLLog("LMC010DAC", "SelectMatomeAutoDenpNo", cmd)

        'SQLの発行
        Dim reader As SqlDataReader = MyBase.GetSelectResult(cmd)

        'DataReader→DataTableへの転記
        Dim map As Hashtable = New Hashtable()

        '取得データの格納先をマッピング
        map.Add("NRS_BR_CD", "NRS_BR_CD")
        map.Add("AUTO_DENP_NO", "AUTO_DENP_NO")

        ds = MyBase.SetSelectResultToDataSet(map, ds, reader, "LMC010OUT_MATOME_DENP_NO")

        reader.Close()

        Return ds

    End Function

    '2018/01/15 【EDI】送状･荷札_大阪群馬トール_EDI化対応 Annen add start
    Private Function SelectTargetUnsoPre(ByVal ds As DataSet) As DataSet

        '検索情報の取得
        Dim indr As DataRow = ds.Tables("LMC010_PRE_UNSO").Rows(0)

        'SQL作成
        Me._StrSql = New StringBuilder
        _StrSql.Append(LMC010DAC.SQL_SELECT_UNSO_PRE)

        Dim SqlPrmList As ArrayList = New ArrayList
        SqlPrmList.Add(MyBase.GetSqlParameter("@NRS_BR_CD", indr("NRS_BR_CD"), DBDataType.CHAR))
        SqlPrmList.Add(MyBase.GetSqlParameter("@UNSO_NO_L", indr("UNSO_NO_L"), DBDataType.CHAR))

        'スキーマ名設定
        Dim sql As String = Me.SetSchemaNm(Me._StrSql.ToString, indr.Item("NRS_BR_CD").ToString)

        'SQL文のコンパイル
        Dim cmd As SqlCommand = MyBase.CreateSqlCommand(sql)

        'パラメータの反映
        For Each obj As Object In SqlPrmList
            cmd.Parameters.Add(obj)
        Next

        'ログの発行
        MyBase.Logger.WriteSQLLog("LMC010DAC", "SelectTargetUnsoPre", cmd)

        'SQLの発行
        Dim reader As SqlDataReader = MyBase.GetSelectResult(cmd)

        'DataReader→DataTableへの転記
        Dim map As Hashtable = New Hashtable()

        '取得データの格納先をマッピング
        map.Add("NRS_BR_CD", "NRS_BR_CD")
        map.Add("UNSO_NO_L", "UNSO_NO_L")
        map.Add("SYS_UPD_DATE", "SYS_UPD_DATE")
        map.Add("SYS_UPD_TIME", "SYS_UPD_TIME")
        map.Add("UNSO_CD", "UNSO_CD")
        map.Add("UNSO_BR_CD", "UNSO_BR_CD")

        ds = MyBase.SetSelectResultToDataSet(map, ds, reader, "LMC010_PRE_UNSO")

        '処理件数の設定
        MyBase.SetResultCount(ds.Tables("LMC010_PRE_UNSO").Rows.Count())
        reader.Close()

        Return ds

    End Function
    '2018/01/15 【EDI】送状･荷札_大阪群馬トール_EDI化対応 Annen add start


    ''' <summary>
    ''' 運送データ（大）更新 AUTO_DENP_NO
    ''' </summary>
    ''' <param name="ds">DataSet</param>
    ''' <returns>DataSet</returns>
    ''' <remarks>運送データ（大）纏め送状更新SQLの構築・発行</remarks>
    Private Function UpdateUnsoLMatome(ByVal ds As DataSet) As DataSet

        'DataSetのIN情報を取得
        Me._Row = ds.Tables("LMC010IN_MATOME_DENP_NO").Rows(0)

        'SQL格納変数の初期化
        Me._StrSql = New StringBuilder()

        'パラメータ設定
        Me._SqlPrmList = New ArrayList()
        Call Me.SetParamCommonSystemUp()

        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@NRS_BR_CD", Me._Row("NRS_BR_CD").ToString(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@AUTO_DENP_NO", Me._Row("AUTO_DENP_NO").ToString(), DBDataType.CHAR))
        'Me._SqlPrmList.Add(MyBase.GetSqlParameter("@MATOME_OUTKA_L", Me._Row("MATOME_OUTKA_L").ToString(), DBDataType.CHAR))

        'SQL作成
        Dim sMatome As String = _Row.Item("MATOME_OUTKA_L").ToString

        Me._StrSql.Append(LMC010DAC.SQL_UNSOL_UPDATE_MATOME)       'SQL構築 SELECT句
        Me._StrSql.Append(String.Concat(LMC010DAC.SQL_SELECT_MATOME_UNSO_AUTO_DENP_NO_DATA2, sMatome, ")"))

        'スキーマ名設定
        Dim sql As String = Me.SetSchemaNm(Me._StrSql.ToString(), Me._Row.Item("NRS_BR_CD").ToString())

        'SQL文のコンパイル
        Dim cmd As SqlCommand = MyBase.CreateSqlCommand(sql)

        'パラメータの反映
        For Each obj As Object In Me._SqlPrmList
            cmd.Parameters.Add(obj)
        Next

        MyBase.Logger.WriteSQLLog("LMC010DAC", "UpdateUnsoLMatome", cmd)

        'SQLの発行
        '更新出来なかった場合エラーメッセージをセットして終了
        If MyBase.GetUpdateResult(cmd) < 1 Then
            MyBase.SetMessage("S001")
            MyBase.SetMessageStore("00", "S001", New String() {"運送データ（大）纏め送状AUTO_DENP_NO更新"})
        End If

        Return ds

    End Function
    'END YANAI 要望番号585
    'ADD 2016/08/29　まとめ送状対応　要望番号:2615 End

    '社内入荷データ作成対応 terakawa 2012.11.19 Start

    ''' <summary>
    ''' 社内入荷データ作成先検索
    ''' </summary>
    ''' <param name="ds">DataSet</param>
    ''' <returns>DataSet</returns>
    ''' <remarks>社内入荷データ作成先検索取得SQLの構築・発行</remarks>
    Private Function ComboData(ByVal ds As DataSet) As DataSet

        'DataSetのIN情報を取得
        Dim inTbl As DataTable = ds.Tables("LMC010_INT_EDI_IN")

        'INの条件rowの格納
        Me._Row = inTbl.Rows(0)

        'SQL格納変数の初期化
        Me._StrSql = New StringBuilder()

        'SQL作成
        Me._StrSql.Append(LMC010DAC.SQL_SELECT_INT_EDI)      'SQL構築(都道府県名抽出用Select句)

        'SQL文のコンパイル
        Dim cmd As SqlCommand = MyBase.CreateSqlCommand(Me.SetSchemaNm(Me._StrSql.ToString(), Me._Row.Item("USER_BR_CD").ToString()))

        MyBase.Logger.WriteSQLLog("LMC010DAC", "SelectIntEdiData", cmd)

        'SQLの発行
        Dim reader As SqlDataReader = MyBase.GetSelectResult(cmd)

        'DataReader→DataTableへの転記
        Dim map As Hashtable = New Hashtable()

        '取得データの格納先をマッピング

        map.Add("INT_EDI_NM", "INT_EDI_NM")
        map.Add("INT_EDI_CD", "INT_EDI_CD")

        ds = MyBase.SetSelectResultToDataSet(map, ds, reader, "LMC010_INT_EDI")

        Return ds

    End Function


    ''' <summary>
    ''' 社内入荷データ作成用データの検索
    ''' </summary>
    ''' <param name="ds">DataSet</param>
    ''' <returns>DataSet</returns>
    ''' <remarks></remarks>
    Private Function SelectInkaData(ByVal ds As DataSet) As DataSet

        'DataSetのIN情報を取得
        Dim inTbl As DataTable = ds.Tables("LMC010_INKA_IN")

        'SQL格納変数の初期化
        Me._StrSql = New StringBuilder()

        'SQLパラメータ初期化
        Me._SqlPrmList = New ArrayList()

        Dim useGoodsConvertTable As Boolean = False
        If (ds.Tables.Contains(TABLE_NM.LMC010_INT_EDI) AndAlso _
            ds.Tables(TABLE_NM.LMC010_INT_EDI).Rows.Count > 0) Then

            ' 商品キーを変換テーブルによって取得するか確認
            useGoodsConvertTable _
                = (LMConst.FLG.ON.Equals(ds.Tables(TABLE_NM.LMC010_INT_EDI)(0).Item("USE_GOODS_CONV_TABLE")))

        End If

        If (useGoodsConvertTable) Then
            ' 商品キー直接変換方式
            Me._StrSql.Append(LMC010DAC.SQL_SELECT_INKAMAKE_DIRECT_CONV_GOODS_CD_NRS)       'SQL構築
        Else
            'SQL作成
            Me._StrSql.Append(LMC010DAC.SQL_SELECT_INKAMAKE_BASE_START)       'SQL構築 BASE START
            Me._StrSql.Append(LMC010DAC.SQL_SELECT_INKAMAKEDATA)       'SQL構築 SELECT句
            Me._StrSql.Append(LMC010DAC.SQL_SELECT_FROM_INKAMAKEDATA)  'SQL構築 FROM句
            Me._StrSql.Append(LMC010DAC.SQL_SELECT_WHERE_INKAMAKEDATA) 'SQL構築 WHERE句
            Me._StrSql.Append(LMC010DAC.SQL_SELECT_GROUP_BY_INKAMAKEDATA)       'SQL構築 GROUP BY
            Me._StrSql.Append(LMC010DAC.SQL_SELECT_INKAMAKE_BASE_END)       'SQL構築 BASE END

        End If

        'パラメータ設定
        Call Me.SetInkaDataSelectParameter(ds)

        'スキーマ名設定
        Dim sql As String = Me.SetSchemaNm(Me._StrSql.ToString() _
                                         , inTbl.Rows(0).Item("NRS_BR_CD").ToString())

        'SQL文のコンパイル
        Dim cmd As SqlCommand = MyBase.CreateSqlCommand(sql)

        'パラメータの反映
        For Each obj As Object In Me._SqlPrmList
            cmd.Parameters.Add(obj)
        Next

        MyBase.Logger.WriteSQLLog("LMC010DAC", "SelectInkaData", cmd)

        'SQLの発行
        Dim reader As SqlDataReader = MyBase.GetSelectResult(cmd)

        'DataReader→DataTableへの転記
        Dim map As Hashtable = New Hashtable()

        '取得データの格納先をマッピング
        map.Add("OUTKA_NO_L", "OUTKA_NO_L")
        map.Add("TO_NRS_BR_CD", "TO_NRS_BR_CD")
        map.Add("OUTKA_PLAN_DATE", "OUTKA_PLAN_DATE")
        map.Add("TO_NRS_WH_CD", "TO_NRS_WH_CD")
        map.Add("TO_CUST_L", "TO_CUST_L")
        map.Add("TO_CUST_M", "TO_CUST_M")
        map.Add("OUTKA_PKG_NB", "OUTKA_PKG_NB")
        map.Add("BUYER_ORD_NO", "BUYER_ORD_NO")
        map.Add("CUST_ORD_NO", "CUST_ORD_NO")
        map.Add("HOKAN_FREE_KIKAN", "HOKAN_FREE_KIKAN")
        map.Add("REMARK", "REMARK")
        map.Add("OUTKA_NO_M", "OUTKA_NO_M")
        map.Add("GOODS_CD_NRS", "GOODS_CD_NRS")
        map.Add("CUST_ORD_NO_DTL", "CUST_ORD_NO_DTL")
        map.Add("BUYER_ORD_NO_DTL", "BUYER_ORD_NO_DTL")
        map.Add("REMARK_M", "REMARK_M")
        map.Add("LOT_NO", "LOT_NO")
        map.Add("PKG_NB", "PKG_NB")
        map.Add("ALCTD_NB", "ALCTD_NB")
        If (useGoodsConvertTable) Then
            map.Add("IRIME", "IRIME")
        End If

        map.Add("STD_IRIME_NB", "STD_IRIME_NB")
        map.Add("BETU_WT", "BETU_WT")
        map.Add("SERIAL_NO", "SERIAL_NO")
        '要望番号:1947（出荷からの入荷作成において、備考小社内が対象外) 2013/03/14 追加START
        map.Add("REMARK_S", "REMARK_S")
        '要望番号:1947（出荷からの入荷作成において、備考小社内が対象外) 2013/03/14 追加START
        map.Add("TOU_NO", "TOU_NO")
        map.Add("SITU_NO", "SITU_NO")
        map.Add("ZONE_CD", "ZONE_CD")
        map.Add("LOCA", "LOCA")
        map.Add("WH_TAB_YN", "WH_TAB_YN")
        ds = MyBase.SetSelectResultToDataSet(map, ds, reader, "LMC010_INKA_OUT")

        reader.Close()

        Return ds

    End Function
    '社内入荷データ作成対応 terakawa 2012.11.19 End



#If True Then  ' FFEM機能改修(納品書未受信状態表示対応) 20170127 added


    ''' <summary>
    ''' 納品書の添付が不要なデータを検索する(FFEM用)
    ''' </summary>
    ''' <param name="ds"></param>
    ''' <returns></returns>
    ''' <remarks></remarks>
    Private Function SelectNeedlessNhsData(ByVal ds As DataSet) As DataSet

        'DataSetのIN情報を取得
        Dim inTbl As DataTable = ds.Tables("LMC010_NOUHINSYO_IN")

        'SQL格納変数の初期化
        Me._StrSql = New StringBuilder()

        'SQLパラメータ初期化
        Me._SqlPrmList = New ArrayList()

        'SQL作成
        Me._StrSql.Append(LMC010DAC.SQL_SELECT_NEEDLESS_NHS)


        'パラメータ設定
        Call Me.SetSelectParameterNeedlessNhs(ds)

        'スキーマ名設定
        Dim sql As String = Me.SetSchemaNm(Me._StrSql.ToString(), inTbl.Rows(0).Item("NRS_BR_CD").ToString())

        'SQL文のコンパイル
        Dim cmd As SqlCommand = MyBase.CreateSqlCommand(sql)

        'パラメータの反映
        For Each obj As Object In Me._SqlPrmList
            cmd.Parameters.Add(obj)
        Next

        MyBase.Logger.WriteSQLLog(Me.GetType.Name, MethodBase.GetCurrentMethod.Name, cmd)

        'DataReader→DataTableへの転記
        Dim map As Hashtable = New Hashtable()
        map.Add("NRS_BR_CD", "NRS_BR_CD")
        map.Add("OUTKA_NO_L", "OUTKA_NO_L")

        'SQLの発行
        Using reader As SqlDataReader = MyBase.GetSelectResult(cmd)
            ds = MyBase.SetSelectResultToDataSet(map, ds, reader, "LMC010OUT")
        End Using

        Return ds

    End Function

    ''' <summary>
    ''' データ検索(納品書発行有無FFEM)
    ''' </summary>
    ''' <param name="ds"></param>
    ''' <returns></returns>
    ''' <remarks>2019/12/03 add</remarks>
    Private Function SelectNhsNoFFEM(ByVal ds As DataSet) As DataSet

        'DataSetのIN情報を取得
        Dim inTbl As DataTable = ds.Tables("LMC010_NOUHINSYO_IN")

        'SQL格納変数の初期化
        Me._StrSql = New StringBuilder()

        'SQLパラメータ初期化
        Me._SqlPrmList = New ArrayList()

        'SQL作成
        Me._StrSql.Append(LMC010DAC.SQL_SELECT_NHS_NO_FFEM)

        'パラメータ設定
        Call Me.SetSelectParameterNeedlessNhs(ds)

        'スキーマ名設定
        Dim sql As String = Me.SetSchemaNm(Me._StrSql.ToString(), inTbl.Rows(0).Item("NRS_BR_CD").ToString())

        'SQL文のコンパイル
        Dim cmd As SqlCommand = MyBase.CreateSqlCommand(sql)

        'パラメータの反映
        For Each obj As Object In Me._SqlPrmList
            cmd.Parameters.Add(obj)
        Next

        MyBase.Logger.WriteSQLLog(Me.GetType.Name, MethodBase.GetCurrentMethod.Name, cmd)

        'DataReader→DataTableへの転記
        Dim map As Hashtable = New Hashtable()
        map.Add("NRS_BR_CD", "NRS_BR_CD")
        map.Add("OUTKA_NO_L", "OUTKA_NO_L")

        'SQLの発行
        Using reader As SqlDataReader = MyBase.GetSelectResult(cmd)
            ds = MyBase.SetSelectResultToDataSet(map, ds, reader, "LMC010OUT")
        End Using

        Return ds

    End Function

    ''' <summary>
    ''' FFEM オフライン品 依頼書未出力件数検索
    ''' </summary>
    ''' <param name="ds">DataSet</param>
    ''' <returns>DataSet</returns>
    ''' <remarks></remarks>
    Private Function SelectOutkaediDtlFjfOffMiPrintCount(ByVal ds As DataSet) As DataSet

        ' DataSetのIN情報を取得
        Dim inTbl As DataTable = ds.Tables("LMC010IN")

        ' 処理件数
        Dim cnt As Integer = 0

        ' SQL格納変数の初期化
        Me._StrSql = New StringBuilder()

        ' SQLパラメータ初期化
        Me._SqlPrmList = New ArrayList()

        ' SQL作成
        Me._StrSql.AppendLine("SELECT                               ")
        Me._StrSql.AppendLine("    COUNT(*) AS CNT                  ")
        Me._StrSql.AppendLine("FROM                                 ")
        Me._StrSql.AppendLine("    $LM_TRN$..H_OUTKAEDI_DTL_FJF_OFF ")
        Me._StrSql.AppendLine("WHERE                                ")
        Me._StrSql.AppendLine("    NRS_BR_CD = @NRS_BR_CD           ")
        Me._StrSql.AppendLine("AND SHIZI_KB = '00'                  ")
        Me._StrSql.AppendLine("AND SYS_DEL_FLG = '0'                ")

        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@NRS_BR_CD", inTbl.Rows(0).Item("NRS_BR_CD").ToString(), DBDataType.VARCHAR))

        ' スキーマ名設定
        Dim sql As String = Me.SetSchemaNm(Me._StrSql.ToString(), inTbl.Rows(0).Item("NRS_BR_CD").ToString())

        ' SQL文のコンパイル
        Using cmd As SqlCommand = MyBase.CreateSqlCommand(sql)

            ' パラメータの反映
            For Each obj As Object In Me._SqlPrmList
                cmd.Parameters.Add(obj)
            Next

            MyBase.Logger.WriteSQLLog(MyBase.GetType.Name, System.Reflection.MethodBase.GetCurrentMethod.Name, cmd)

            ' SQLの発行
            Using reader As SqlDataReader = MyBase.GetSelectResult(cmd)

                If reader.Read() Then
                    cnt = Convert.ToInt32(reader("CNT"))
                End If

            End Using

        End Using

        ' 処理件数の設定
        MyBase.SetResultCount(cnt)

        Return ds

    End Function

    ''' <summary>
    ''' 行カラーのカスタマイズ種別を取得する
    ''' </summary>
    ''' <param name="ds"></param>
    ''' <returns></returns>
    ''' <remarks></remarks>
    Private Function GetCustomizeRowColorType(ByVal ds As DataSet) As String

        Const IN_TABLE_NAME As String = "LMC010IN"
        Const CustomizeRowColorTypeCNAME As String = "CUSTOMIZE_ROW_COLOR_TYPE"

        Dim colorType As String = ""
        If (ds.Tables(IN_TABLE_NAME).Rows.Count > 0) Then

            Dim row As DataRow = ds.Tables(IN_TABLE_NAME).Rows(0)

            If (TryCast(row.Item(CustomizeRowColorTypeCNAME), String) IsNot Nothing) Then
                colorType = TryCast(row.Item(CustomizeRowColorTypeCNAME), String)
            End If

        End If

        Return colorType

    End Function


    ''' <summary>
    ''' 分析票と納品書の存在チェック用SQLのパラメータを設定する。
    ''' </summary>
    ''' <remarks></remarks>
    Private Sub SetParamExistsCoaAndDlv()
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@CUST_CD_L_COA_AND_DLV", Me._Row.Item("CUST_CD_L").ToString(), DBDataType.CHAR))
    End Sub

    ''' <summary>
    ''' 分析票と納品書の存在チェックを行うか判定する
    ''' </summary>
    ''' <param name="ds"></param>
    ''' <returns></returns>
    ''' <remarks></remarks>
    Private Function IsSelectExistsCoaFileAndDlvFile(ByVal ds As DataSet) As Boolean


        If (CustomizeRowColorType.FFEM _
                .Equals(Me.GetCustomizeRowColorType(ds))) Then

            ' FFEMの行カラー指定を行う場合、添付ファイル有無を確認する

            Return True
        End If


        Return False

    End Function

#End If

    ''' <summary>
    ''' 検索用OrderBy句作成
    ''' </summary>
    ''' <remarks></remarks>
    Private Sub SQLOrderBy()

        Me._StrSqlOrderBy.Append(" ORDER BY ")
        Me._StrSqlOrderBy.Append(vbNewLine)
        Me._StrSqlOrderBy.Append(" C_OUTKA_L.OUTKA_PLAN_DATE ")

        With Me._Row

            '検品済、出荷済、報告済のいずれかにチェックあり
            If String.IsNullOrEmpty(.Item("OUTKA_STATE_KB4").ToString()) = False Or _
               String.IsNullOrEmpty(.Item("OUTKA_STATE_KB5").ToString()) = False Or _
               String.IsNullOrEmpty(.Item("OUTKA_STATE_KB6").ToString()) = False Then

                Me._StrSqlOrderBy.Append(" DESC ")

            End If

            Me._StrSqlOrderBy.Append(vbNewLine)
            Me._StrSqlOrderBy.Append(" ,C_OUTKA_L.OUTKA_NO_L ")
            Me._StrSqlOrderBy.Append(vbNewLine)
            Me._StrSqlOrderBy.Append(" ,M_CUST.CUST_NM_L + M_CUST.CUST_NM_M ")
            Me._StrSqlOrderBy.Append(vbNewLine)
            Me._StrSqlOrderBy.Append(" ,M_DEST.DEST_NM ")
            Me._StrSqlOrderBy.Append(vbNewLine)

        End With

        'SQL文にOrderBy追加
        Me._StrSql.Append(Me._StrSqlOrderBy.ToString())

    End Sub

    'START YANAI 要望番号1002 荷札印刷時、データ抽出条件変更
    ''' <summary>
    ''' 条件文・パラメータ設定モジュール
    ''' </summary>
    ''' <remarks></remarks>
    Private Sub SetSqlFrom()

        '検索条件部に入力された条件とパラメータ設定
        With Me._Row

            '区分格納変数
            Dim kbn As String

            '可変比較対象項目名格納変数
            Dim colNM As String = String.Empty

            '印刷種別
            kbn = .Item("PRINT_SYUBETU").ToString()

            '印刷種別によって以下分岐
            Select Case kbn

                Case "01"
                    colNM = "NIHUDA_FLAG"
                Case "02"
                    colNM = "DENP_FLAG"
                Case "03"
                    colNM = "NHS_FLAG"
                Case "04"
                    colNM = "COA_FLAG"
                Case "06"
                    colNM = "DENP_FLAG"
                Case "07"
                    colNM = "HOKOKU_FLAG"
                Case "08"
                    colNM = "ALL_PRINT_FLAG"
                Case "10"
                    colNM = "NIHUDA_FLAG"
                Case "12"
                    colNM = "HOKOKU_FLAG" '2012/12/25追加
                    '(2013.02.04)要望番号1883 纏め送状(選択)未印刷条件追加 -- START --
                Case "13"
                    colNM = "DENP_FLAG"
                    '(2013.02.04)要望番号1883 纏め送状(選択)未印刷条件追加 --  END  --
                Case Else
                    colNM = String.Empty

            End Select

            If ("DENP_FLAG").Equals(colNM) = True Then
                '送状の場合
                Me._StrSql.Append(" INNER JOIN                                       ")
                Me._StrSql.Append(vbNewLine)
                Me._StrSql.Append(" (                                                ")
                Me._StrSql.Append(vbNewLine)
                Me._StrSql.Append(" SELECT                                           ")
                Me._StrSql.Append(vbNewLine)
                Me._StrSql.Append(" UNSOCUSTRPT.NRS_BR_CD                            ")
                Me._StrSql.Append(vbNewLine)
                Me._StrSql.Append(" ,UNSOCUSTRPT.UNSOCO_CD                           ")
                Me._StrSql.Append(vbNewLine)
                Me._StrSql.Append(" ,UNSOCUSTRPT.UNSOCO_BR_CD                        ")
                Me._StrSql.Append(vbNewLine)
                Me._StrSql.Append(" ,COUNT(UNSOCUSTRPT.NRS_BR_CD) AS UNSOCUSTRPTCOUNT")
                Me._StrSql.Append(vbNewLine)
                Me._StrSql.Append(" FROM                                             ")
                Me._StrSql.Append(vbNewLine)
                Me._StrSql.Append(" $LM_MST$..M_UNSO_CUST_RPT      UNSOCUSTRPT       ")
                Me._StrSql.Append(vbNewLine)
                Me._StrSql.Append(" WHERE                                            ")
                Me._StrSql.Append(vbNewLine)
                Me._StrSql.Append(" UNSOCUSTRPT.NRS_BR_CD = @NRS_BR_CD               ")
                Me._StrSql.Append(vbNewLine)
                Me._StrSql.Append(" GROUP BY                                         ")
                Me._StrSql.Append(vbNewLine)
                Me._StrSql.Append(" UNSOCUSTRPT.NRS_BR_CD                            ")
                Me._StrSql.Append(vbNewLine)
                Me._StrSql.Append(" ,UNSOCUSTRPT.UNSOCO_CD                           ")
                Me._StrSql.Append(vbNewLine)
                Me._StrSql.Append(" ,UNSOCUSTRPT.UNSOCO_BR_CD                        ")
                Me._StrSql.Append(vbNewLine)
                Me._StrSql.Append(" ) UNSOCUSTRPT                                    ")
                Me._StrSql.Append(vbNewLine)
                Me._StrSql.Append(" ON                                               ")
                Me._StrSql.Append(vbNewLine)
                Me._StrSql.Append(" UNSOCUSTRPT.NRS_BR_CD = F_UNSO_L.NRS_BR_CD       ")
                Me._StrSql.Append(vbNewLine)
                Me._StrSql.Append(" AND                                              ")
                Me._StrSql.Append(vbNewLine)
                Me._StrSql.Append(" UNSOCUSTRPT.UNSOCO_CD = F_UNSO_L.UNSO_CD         ")
                Me._StrSql.Append(vbNewLine)
                Me._StrSql.Append(" AND                                              ")
                Me._StrSql.Append(vbNewLine)
                Me._StrSql.Append(" UNSOCUSTRPT.UNSOCO_BR_CD = F_UNSO_L.UNSO_BR_CD   ")
                Me._StrSql.Append(vbNewLine)
            End If

        End With

    End Sub
    'END YANAI 要望番号1002 荷札印刷時、データ抽出条件変更

    'START YANAI 要望番号1286 入荷・出荷画面の機能追加（出荷検索にロット、シリアル）
    ''' <summary>
    ''' 条件文・パラメータ設定モジュール
    ''' </summary>
    ''' <remarks></remarks>
    Private Sub SetFromOutkaM()

        '検索条件部に入力された条件とパラメータ設定
        Dim whereStr As String = String.Empty
        With Me._Row

            whereStr = .Item("OUTKA_NO_L_DIRECT").ToString()
            If String.IsNullOrEmpty(.Item("OUTKA_NO_L_DIRECT").ToString()) = True Then
                '出荷管理番号（ダイレクト検索）が設定されていない場合のみ

                'ロット№
                whereStr = .Item("LOT_NO").ToString()
                If String.IsNullOrEmpty(whereStr) = False Then
                    Me._StrSql.Append(" AND C_OUTKA_M.LOT_NO LIKE @LOT_NO_S")
                    Me._StrSql.Append(vbNewLine)
                    Me._SqlPrmList.Add(MyBase.GetSqlParameter("@LOT_NO_S", String.Concat(whereStr, "%"), DBDataType.NVARCHAR))
                End If

                'シリアル№
                whereStr = .Item("SERIAL_NO").ToString()
                If String.IsNullOrEmpty(whereStr) = False Then
                    Me._StrSql.Append(" AND C_OUTKA_M.SERIAL_NO LIKE @SERIAL_NO_S")
                    Me._StrSql.Append(vbNewLine)
                    Me._SqlPrmList.Add(MyBase.GetSqlParameter("@SERIAL_NO_S", String.Concat(whereStr, "%"), DBDataType.NVARCHAR))
                End If
            End If

        End With

    End Sub
    'END YANAI 要望番号1286 入荷・出荷画面の機能追加（出荷検索にロット、シリアル）

    ''' <summary>
    ''' 条件文・パラメータ設定モジュール
    ''' </summary>
    ''' <remarks></remarks>
    Private Sub SetConditionMasterSQL()

        'START YANAI 要望番号1286 入荷・出荷画面の機能追加（出荷検索にロット、シリアル）
        ''SQLパラメータ初期化
        'Me._SqlPrmList = New ArrayList()
        'END YANAI 要望番号1286 入荷・出荷画面の機能追加（出荷検索にロット、シリアル）

        '検索条件部に入力された条件とパラメータ設定
        Dim whereStr As String = String.Empty
        With Me._Row

            Me._StrSql.Append("WHERE                                                          ")
            Me._StrSql.Append(vbNewLine)

            '営業所
            whereStr = .Item("NRS_BR_CD").ToString()
            If String.IsNullOrEmpty(whereStr) = False Then
                Me._StrSql.Append(" C_OUTKA_L.NRS_BR_CD = @NRS_BR_CD")
                Me._StrSql.Append(vbNewLine)
                Me._SqlPrmList.Add(MyBase.GetSqlParameter("@NRS_BR_CD", whereStr, DBDataType.CHAR))
            End If

            '出荷管理番号（ダイレクト検索）
            whereStr = .Item("OUTKA_NO_L_DIRECT").ToString()
            If String.IsNullOrEmpty(.Item("OUTKA_NO_L_DIRECT").ToString()) = False Then
                Me._StrSql.Append(" AND C_OUTKA_L.OUTKA_NO_L LIKE @OUTKA_NO_L_DIRECT")
                Me._StrSql.Append(vbNewLine)
                'Me._SqlPrmList.Add(MyBase.GetSqlParameter("@OUTKA_NO_L_DIRECT", String.Concat(whereStr, "%"), DBDataType.NVARCHAR))
                'Me._SqlPrmList.Add(MyBase.GetSqlParameter("@OUTKA_NO_L_DIRECT", String.Concat("%", whereStr), DBDataType.NVARCHAR))  '検証結果_導入時要望 №64対応(2011.09.12)
                '群馬営業所　アベンド対応(2012.09.21) 型をDBの項目にあわせる NVARCHAR⇒CHAR
                Me._SqlPrmList.Add(MyBase.GetSqlParameter("@OUTKA_NO_L_DIRECT", String.Concat("%", whereStr), DBDataType.CHAR))
                Exit Sub
            End If

            '取消のみにチェックあり
            If String.IsNullOrEmpty(.Item("OUTKA_STATE_KB7").ToString()) = False Then
                Me._StrSql.Append(" AND C_OUTKA_L.SYS_DEL_FLG = '1'")
                Me._StrSql.Append(vbNewLine)
            Else
                Me._StrSql.Append(" AND C_OUTKA_L.SYS_DEL_FLG = '0'")
                Me._StrSql.Append(vbNewLine)
            End If

            '====== ヘッダ項目 ======'

            '進捗区分
            Dim arr As ArrayList = New ArrayList()

            '予定入力済にチェックあり
            If String.IsNullOrEmpty(.Item("OUTKA_STATE_KB1").ToString()) = False Then
                arr.Add("'10'")
            End If

            '受付表印刷にチェックあり
            If String.IsNullOrEmpty(.Item("OUTKA_STATE_KB2").ToString()) = False Then
                arr.Add("'30'")
            End If

            '受付済にチェックあり
            If String.IsNullOrEmpty(.Item("OUTKA_STATE_KB3").ToString()) = False Then
                arr.Add("'40'")
            End If

            '検品済にチェックあり
            If String.IsNullOrEmpty(.Item("OUTKA_STATE_KB4").ToString()) = False Then
                arr.Add("'50'")
            End If

            '出荷済にチェックあり
            If String.IsNullOrEmpty(.Item("OUTKA_STATE_KB5").ToString()) = False Then
                arr.Add("'60'")
            End If

            '報告済にチェックあり
            If String.IsNullOrEmpty(.Item("OUTKA_STATE_KB6").ToString()) = False Then
                arr.Add("'90'")
            End If

            Dim max As Integer = arr.Count - 1

            If -1 < max Then

                Me._StrSql.Append(" AND C_OUTKA_L.OUTKA_STATE_KB IN (")

                For i As Integer = 0 To max

                    If i = max Then
                        Me._StrSql.Append(String.Concat(arr(i).ToString(), " ) "))
                    Else
                        Me._StrSql.Append(String.Concat(arr(i).ToString(), " , "))
                    End If

                Next

                Me._StrSql.Append(vbNewLine)

            End If

            '荷主コード
            whereStr = .Item("CUST_CD_L").ToString()
            If String.IsNullOrEmpty(whereStr) = False Then
                Me._StrSql.Append(" AND C_OUTKA_L.CUST_CD_L LIKE @CUST_CD_L")
                Me._StrSql.Append(vbNewLine)
                Me._SqlPrmList.Add(MyBase.GetSqlParameter("@CUST_CD_L", String.Concat(whereStr, "%"), DBDataType.CHAR))
            End If

            '担当者
            whereStr = .Item("TANTO_CD").ToString()
            If String.IsNullOrEmpty(whereStr) = False Then
                Me._StrSql.Append(" AND TANTO_USER.USER_CD LIKE @TANTO_CD")
                Me._StrSql.Append(vbNewLine)
                Me._SqlPrmList.Add(MyBase.GetSqlParameter("@TANTO_CD", String.Concat(whereStr, "%"), DBDataType.NVARCHAR))
            End If

            '倉庫
            whereStr = .Item("WH_CD").ToString()
            If String.IsNullOrEmpty(whereStr) = False Then
                Me._StrSql.Append(" AND C_OUTKA_L.WH_CD = @WH_CD")
                Me._StrSql.Append(vbNewLine)
                Me._SqlPrmList.Add(MyBase.GetSqlParameter("@WH_CD", whereStr, DBDataType.CHAR))
            End If

            '区分格納変数
            Dim kbn As String

            '可変比較対象項目名格納変数
            Dim colNM As String = String.Empty

            '印刷種別
            kbn = .Item("PRINT_SYUBETU").ToString()

            '印刷種別によって以下分岐
            Select Case kbn

                Case "01"
                    colNM = "NIHUDA_FLAG"
                Case "02"
                    colNM = "DENP_FLAG"
                Case "03"
                    colNM = "NHS_FLAG"
#If True Then   'ADD 2018/07/13 依頼番号 : 001990  
                    'If ("10").Equals(.Item("NRS_BR_CD").ToString) _
                    '  AndAlso ("00010").Equals(.Item("CUST_CD_L").ToString) Then
                    '    '千葉の日立FNのとき、纏めピック済みは対象外にする
                    '    whereStr = " AND C_OUTKA_L.MATOME_PICK_FLAG = '00' "
                    '    Me._StrSql.Append(whereStr)
                    '    Me._StrSql.Append(vbNewLine)
                    'End If

                    'UPD Start 2018/10/19 依頼番号 : 002621   【LMS】日立FN_納品書未印刷表示時、まとめﾋﾟｯｷﾝｸﾞ非表示(千葉BC松本) 
                    'whereStr = " AND ((MCD.SET_NAIYO = '1'  AND C_OUTKA_L.MATOME_PICK_FLAG = '00') "
                    '                                           ピッキングリスト区分='02'(まとめﾋﾟｯｷﾝｸﾞﾘｽﾄ)  
                    whereStr = " AND ((MCD.SET_NAIYO = '1'  AND C_OUTKA_L.PICK_KB <> '02') "
                    'UPD End   2018/10/19 依頼番号 : 002621   【LMS】日立FN_納品書未印刷表示時、まとめﾋﾟｯｷﾝｸﾞ非表示(千葉BC松本) 

                    Me._StrSql.Append(whereStr)
                    Me._StrSql.Append(vbNewLine)

                    whereStr = "      OR (MCD.CUST_CD IS NULL )) "
                    Me._StrSql.Append(whereStr)
                    Me._StrSql.Append(vbNewLine)

#End If
                Case "04"
                    colNM = "COA_FLAG"
                    '(2012.09.21)要望番号1456 纏めピック 未印刷条件追加 --- START ---
                Case "05"
                    colNM = "MATOME_PICK_FLAG"
                    '(2012.09.21)要望番号1456 纏めピック 未印刷条件追加 ---  END  ---
                Case "06"
                    colNM = "DENP_FLAG"
                Case "07"
                    colNM = "HOKOKU_FLAG"
                Case "08"
                    colNM = "ALL_PRINT_FLAG"
                    'START YANAI 要望番号1002 荷札印刷時、データ抽出条件変更
                Case "10"
                    colNM = "NIHUDA_FLAG"
                    'END YANAI 要望番号1002 荷札印刷時、データ抽出条件変更
                Case "12"
                    colNM = "HOKOKU_FLAG" '2012/12/25追加
                    '(2013.02.04)要望番号1883 纏め送状(選択)未印刷条件追加 -- START --
                Case "13"
                    colNM = "DENP_FLAG"
                    '(2013.12.24)要望番号2140 まとめピックリスト種別 -- Start --
                Case "15", "16", "17", "18", "19"
                    colNM = "MATOME_PICK_FLAG"
                    '(2013.12.24)要望番号2140 まとめピックリスト種別 --  END  --
                Case Else
                    colNM = String.Empty

            End Select

            '印刷状況
            If String.IsNullOrEmpty(colNM) = False Then

                whereStr = .Item("PRINT_KBN").ToString()
                If String.IsNullOrEmpty(whereStr) = False Then
                    Me._StrSql.Append(" AND C_OUTKA_L.")
                    Me._StrSql.Append(colNM)
                    Me._StrSql.Append(" = @PRINT_KBN")
                    Me._StrSql.Append(vbNewLine)
                    Me._SqlPrmList.Add(MyBase.GetSqlParameter("@PRINT_KBN", whereStr, DBDataType.CHAR))
                End If

            End If

            '(2013.12.24)要望番号2140 まとめピックリスト種別 --Start--
            '運送会社のまとめピックグループ
            whereStr = String.Empty
            Select Case kbn
                Case "15"
                    whereStr = " AND M_UNSOCO.PICKLIST_GRP_KBN = '15' "
                Case "16"
                    whereStr = " AND M_UNSOCO.PICKLIST_GRP_KBN = '16' "
                Case "17"
                    whereStr = " AND M_UNSOCO.PICKLIST_GRP_KBN = '17' "
                Case "18"
                    whereStr = " AND M_UNSOCO.PICKLIST_GRP_KBN = '18' "
                Case "19"
                    whereStr = " AND NOT M_UNSOCO.PICKLIST_GRP_KBN IN ('15','16','17','18') "
            End Select

            If String.IsNullOrEmpty(whereStr) = False Then
                Me._StrSql.Append(whereStr)
                Me._StrSql.Append(vbNewLine)
            End If
            '(2013.12.24)要望番号2140 まとめピックリスト種別 --  END  --

            'SHINODA
            'ピック種別
            whereStr = .Item("PICK_SYUBETU").ToString()
            If String.IsNullOrEmpty(whereStr) = False Then
                Me._StrSql.Append(" AND M_UNSOCO.PICKLIST_GRP_KBN = '" & whereStr & "' ")
                Me._StrSql.Append(vbNewLine)
            End If
            'SHINODA

            '印刷検索日（FROM)
            whereStr = .Item("PRINT_DATE_FROM").ToString()
            If String.IsNullOrEmpty(whereStr) = False Then
                Me._StrSql.Append(" AND @PRINT_DATE_FROM <= C_OUTKA_L.LAST_PRINT_DATE")
                Me._StrSql.Append(vbNewLine)
                Me._SqlPrmList.Add(MyBase.GetSqlParameter("@PRINT_DATE_FROM", whereStr, DBDataType.CHAR))
            End If

            '印刷検索日（TO)
            whereStr = .Item("PRINT_DATE_TO").ToString()
            If String.IsNullOrEmpty(whereStr) = False Then
                Me._StrSql.Append(" AND C_OUTKA_L.LAST_PRINT_DATE <= @PRINT_DATE_TO")
                Me._StrSql.Append(vbNewLine)
                Me._SqlPrmList.Add(MyBase.GetSqlParameter("@PRINT_DATE_TO", whereStr, DBDataType.CHAR))
            End If

            'START YANAI 要望番号1002 荷札印刷時、データ抽出条件変更
            If ("NIHUDA_FLAG").Equals(colNM) = True Then
                '荷札の場合
                Me._StrSql.Append(" AND M_UNSOCO.NIHUDA_YN = '01'")
                Me._StrSql.Append(vbNewLine)
            End If
            'END YANAI 要望番号1002 荷札印刷時、データ抽出条件変更


            '要望番号:1456(まとめピックの未印刷検索が効いていない) 2013/01/28 本明 Start
            If ("MATOME_PICK_FLAG").Equals(colNM) = True Then

                '(2013.03.08)要望番号:1939 予定入力済は出力対象外 -- START --
                Me._StrSql.Append(" AND C_OUTKA_L.OUTKA_STATE_KB <> '10'")
                Me._StrSql.Append(vbNewLine)
                '(2013.03.08)要望番号:1939 予定入力済は出力対象外 --  END  --

                '纏めピックの場合
                If .Item("NRS_BR_CD").ToString <> "30" Then
                    '群馬営業所以外
                    Me._StrSql.Append(" AND C_OUTKA_L.PICK_KB = '02'")  'まとめピック
                    Me._StrSql.Append(vbNewLine)
                End If
            End If
            '要望番号:1456(まとめピックの未印刷検索が効いていない) 2013/01/28 本明 Start

            '要望番号:1833(納品書の検索時にまとめピックの出荷は表示しない) 2013/02/05 Start
            If ("NHS_FLAG").Equals(colNM) = True AndAlso .Item("NOT_NHS_FLAG").ToString().Equals("1") = True Then
                '納品書が未出力の出力時に、まとめピック印刷対象データは納品書を印刷しない
                Me._StrSql.Append(" AND C_OUTKA_L.PICK_KB <> '02'")  'まとめピック
                Me._StrSql.Append(vbNewLine)
            End If
            '要望番号:1833(納品書の検索時にまとめピックの出荷は表示しない) 2013/02/05 End

            '出荷検索日区分
            kbn = .Item("SEARCH_DATE_KBN").ToString()

            '出荷検索日区分によって以下分岐
            Select Case kbn

                Case "01"
                    colNM = "OUTKO_DATE"
                Case "02"
                    colNM = "OUTKA_PLAN_DATE"
                Case "03"
                    colNM = "ARR_PLAN_DATE"
                Case Else
                    colNM = String.Empty

            End Select

            If String.IsNullOrEmpty(colNM) = False Then

                '出荷検索日（FROM）
                whereStr = .Item("SEARCH_DATE_FROM").ToString()
                If String.IsNullOrEmpty(whereStr) = False Then
                    Me._StrSql.Append(" AND @SEARCH_DATE_FROM <= C_OUTKA_L.")
                    Me._StrSql.Append(colNM)
                    Me._StrSql.Append(vbNewLine)
                    Me._SqlPrmList.Add(MyBase.GetSqlParameter("@SEARCH_DATE_FROM", whereStr, DBDataType.CHAR))
                End If

                '出荷検索日（TO）
                whereStr = .Item("SEARCH_DATE_TO").ToString()
                If String.IsNullOrEmpty(whereStr) = False Then
                    Me._StrSql.Append(" AND C_OUTKA_L.")
                    Me._StrSql.Append(colNM)
                    Me._StrSql.Append(" <= @SEARCH_DATE_TO")
                    Me._StrSql.Append(vbNewLine)
                    Me._SqlPrmList.Add(MyBase.GetSqlParameter("@SEARCH_DATE_TO", whereStr, DBDataType.CHAR))
                End If

            End If

            '(2013.03.04)要望番号1883 纏め送状(選択)未印刷条件追加 -- START --
            If .Item("PRINT_SYUBETU").ToString.Equals("13") = True Then
                '纏め送状(選択)の場合
                Me._StrSql.Append(" AND C_OUTKA_L.DENP_FLAG = '00' ")
                Me._StrSql.Append(vbNewLine)
            End If
            '(2013.03.04)要望番号1883 纏め送状(選択)未印刷条件追加 --  END  --

            '====== スプレッド項目 ======'

            'オーダー番号
            whereStr = .Item("CUST_ORD_NO").ToString()
            If String.IsNullOrEmpty(whereStr) = False Then
                Me._StrSql.Append(" AND C_OUTKA_L.CUST_ORD_NO LIKE @CUST_ORD_NO")
                Me._StrSql.Append(vbNewLine)
#If False Then  'UPD 2019/01/23 依頼番号 : 003868   【LMS】オーダー番号の検索方法「前方一致⇒部分一致」
                Me._SqlPrmList.Add(MyBase.GetSqlParameter("@CUST_ORD_NO", String.Concat(whereStr, "%"), DBDataType.NVARCHAR))
#Else
                Me._SqlPrmList.Add(MyBase.GetSqlParameter("@CUST_ORD_NO", String.Concat("%", whereStr, "%"), DBDataType.NVARCHAR))
#End If
            End If

            '荷主名
            whereStr = .Item("CUST_NM").ToString()
            If String.IsNullOrEmpty(whereStr) = False Then
                Me._StrSql.Append(" AND (M_CUST.CUST_NM_L + '　' + M_CUST.CUST_NM_M) LIKE @CUST_NM")
                Me._StrSql.Append(vbNewLine)
                Me._SqlPrmList.Add(MyBase.GetSqlParameter("@CUST_NM", String.Concat("%", whereStr, "%"), DBDataType.NVARCHAR))
            End If

            'START YANAI 要望番号748
            '荷主コード小
            whereStr = .Item("CUST_CD_S").ToString()
            If String.IsNullOrEmpty(whereStr) = False Then
                Me._StrSql.Append(" AND M_GOODS.CUST_CD_S = @CUST_CD_S")
                Me._StrSql.Append(vbNewLine)
                Me._SqlPrmList.Add(MyBase.GetSqlParameter("@CUST_CD_S", MaeCoverData(whereStr, "0", 2), DBDataType.NVARCHAR))
            End If
            'END YANAI 要望番号748

            '届先名
            whereStr = .Item("DEST_NM").ToString()
            If String.IsNullOrEmpty(whereStr) = False Then
                Me._StrSql.Append(" AND (M_DEST.DEST_NM LIKE @DEST_NM")
                Me._StrSql.Append(" OR   C_OUTKA_L.DEST_NM LIKE @DEST_NM)")
                Me._StrSql.Append(vbNewLine)
                Me._SqlPrmList.Add(MyBase.GetSqlParameter("@DEST_NM", String.Concat("%", whereStr, "%"), DBDataType.NVARCHAR))
            End If

            '商品名（中1）
            whereStr = .Item("GOODS_NM").ToString()
            If String.IsNullOrEmpty(whereStr) = False Then
                Me._StrSql.Append(" AND M_GOODS.GOODS_NM_1 LIKE @GOODS_NM")
                Me._StrSql.Append(vbNewLine)
                Me._SqlPrmList.Add(MyBase.GetSqlParameter("@GOODS_NM", String.Concat("%", whereStr, "%"), DBDataType.NVARCHAR))
            End If

            '届先住所
            whereStr = .Item("DEST_AD").ToString()
            If String.IsNullOrEmpty(whereStr) = False Then
                Me._StrSql.Append(" AND (M_DEST.AD_1 LIKE @DEST_AD")
                Me._StrSql.Append(" OR   C_OUTKA_L.DEST_AD_1 LIKE @DEST_AD)")
                Me._StrSql.Append(vbNewLine)
                Me._SqlPrmList.Add(MyBase.GetSqlParameter("@DEST_AD", String.Concat("%", whereStr, "%"), DBDataType.NVARCHAR))
            End If

            '送り状番号
            whereStr = .Item("DENP_NO").ToString()
            If String.IsNullOrEmpty(whereStr) = False Then
                '2018/03/06 001203 20180222【LMS】自動送状番号_検索機能追加(千葉坂巻)対応 Annen upd start
                Me._StrSql.Append(" AND(C_OUTKA_L.DENP_NO LIKE @DENP_NO OR F_UNSO_L.AUTO_DENP_NO LIKE @DENP_NO)")
                'Me._StrSql.Append(" AND C_OUTKA_L.DENP_NO LIKE @DENP_NO")
                '2018/03/06 001203 20180222【LMS】自動送状番号_検索機能追加(千葉坂巻)対応 Annen upd end
                Me._StrSql.Append(vbNewLine)
                Me._SqlPrmList.Add(MyBase.GetSqlParameter("@DENP_NO", String.Concat(whereStr, "%"), DBDataType.NVARCHAR))
            End If

            '運送会社名
            whereStr = .Item("UNSOCO_NM").ToString()
            If String.IsNullOrEmpty(whereStr) = False Then
                Me._StrSql.Append(" AND M_UNSOCO.UNSOCO_NM + '　' + M_UNSOCO.UNSOCO_BR_NM LIKE @UNSOCO_NM")
                Me._StrSql.Append(vbNewLine)
                Me._SqlPrmList.Add(MyBase.GetSqlParameter("@UNSOCO_NM", String.Concat("%", whereStr, "%"), DBDataType.NVARCHAR))
            End If

            '2013.02.27 / Notes1897開始
            '便区分
            whereStr = .Item("BIN_KB").ToString()
            If String.IsNullOrEmpty(whereStr) = False Then
                Me._StrSql.Append(" AND BIN_Z.KBN_CD = @BIN_KB")
                Me._StrSql.Append(vbNewLine)
                Me._SqlPrmList.Add(MyBase.GetSqlParameter("@BIN_KB", whereStr, DBDataType.CHAR))
            End If
            '2013.02.27 / Notes1897終了

            '2018/04/20 001547 【LMS】出荷データ検索画面_注文番号項目追加(千葉BC物管２_石井) Annen add start
            '注文番号
            whereStr = .Item("BUYER_ORD_NO").ToString()
            If String.IsNullOrEmpty(whereStr) = False Then
                Me._StrSql.Append(" AND C_OUTKA_L.BUYER_ORD_NO LIKE @BUYER_ORD_NO")
                Me._StrSql.Append(vbNewLine)
                Me._SqlPrmList.Add(MyBase.GetSqlParameter("@BUYER_ORD_NO", String.Concat(whereStr, "%"), DBDataType.NVARCHAR))
            End If
            '2018/04/20 001547 【LMS】出荷データ検索画面_注文番号項目追加(千葉BC物管２_石井) Annen add end

            '顧客出荷管理番号
            whereStr = .Item("WEB_OUTKA_NO_L").ToString()
            If String.IsNullOrEmpty(whereStr) = False Then
                Me._StrSql.Append(" AND WEB_OUTKA_L.WEB_OUTKA_NO_L LIKE @WEB_OUTKA_NO_L")
                Me._StrSql.Append(vbNewLine)
                Me._SqlPrmList.Add(MyBase.GetSqlParameter("@WEB_OUTKA_NO_L", String.Concat(whereStr, "%"), DBDataType.CHAR))
            End If

            '出荷管理番号(大)
            whereStr = .Item("OUTKA_NO_L").ToString()
            If String.IsNullOrEmpty(whereStr) = False Then
                Me._StrSql.Append(" AND C_OUTKA_L.OUTKA_NO_L LIKE @OUTKA_NO_L")
                Me._StrSql.Append(vbNewLine)
                Me._SqlPrmList.Add(MyBase.GetSqlParameter("@OUTKA_NO_L", String.Concat(whereStr, "%"), DBDataType.CHAR))
            End If

            '出荷種別
            whereStr = .Item("SYUBETU_KB").ToString()
            If String.IsNullOrEmpty(whereStr) = False Then
                Me._StrSql.Append(" AND C_OUTKA_L.SYUBETU_KB = @SYUBETU_KB")
                Me._StrSql.Append(vbNewLine)
                Me._SqlPrmList.Add(MyBase.GetSqlParameter("@SYUBETU_KB", whereStr, DBDataType.CHAR))
            End If

            '運送会社名 20130221 要望番号1856
            whereStr = .Item("REMARK_UNSO").ToString()
            If String.IsNullOrEmpty(whereStr) = False Then
                Me._StrSql.Append(" AND F_UNSO_L.REMARK LIKE @REMARK_UNSO")
                Me._StrSql.Append(vbNewLine)
                Me._SqlPrmList.Add(MyBase.GetSqlParameter("@REMARK_UNSO", String.Concat("%", whereStr, "%"), DBDataType.NVARCHAR))
            End If

            '作成者
            whereStr = .Item("SYS_ENT_USER").ToString()
            If String.IsNullOrEmpty(whereStr) = False Then
                Me._StrSql.Append(" AND ENT_USER.USER_NM LIKE @SYS_ENT_USER")
                Me._StrSql.Append(vbNewLine)
                Me._SqlPrmList.Add(MyBase.GetSqlParameter("@SYS_ENT_USER", String.Concat("%", whereStr, "%"), DBDataType.NVARCHAR))
            End If

            '最終更新者
            whereStr = .Item("SYS_UPD_USER").ToString()
            If String.IsNullOrEmpty(whereStr) = False Then
                Me._StrSql.Append(" AND UPD_USER.USER_NM LIKE @SYS_UPD_USER")
                Me._StrSql.Append(vbNewLine)
                Me._SqlPrmList.Add(MyBase.GetSqlParameter("@SYS_UPD_USER", String.Concat("%", whereStr, "%"), DBDataType.NVARCHAR))
            End If

            '20160615 tsunehira add start
            '選択言語フラグ
            Me._SqlPrmList.Add(GetSqlParameter("@LANG", Me._Row.Item("LANG_FLG").ToString()))
            '20160615 tsunehira add end


#If True Then    ' 出荷作業ステータス対応 20160824 added inoue

            ' 出荷作業ステータス
            whereStr = .Item("SEARCH_WH_WORK_STATUS").ToString()
            If String.IsNullOrEmpty(whereStr) = False Then
                Me._StrSql.AppendLine(" AND (C_OUTKA_L.WH_KENPIN_WK_STATUS = @SEARCH_WH_WORK_STATUS ")
                Me._StrSql.AppendLine("      OR ")
                Me._StrSql.AppendLine("      ( KENPIN_WK.WH_KENPIN_WK_STATUS IS NOT NULL ")
                Me._StrSql.AppendLine("    AND KENPIN_WK.WH_KENPIN_WK_STATUS = @SEARCH_WH_WORK_STATUS ))")
                Me._SqlPrmList.Add(MyBase.GetSqlParameter("@SEARCH_WH_WORK_STATUS", whereStr, DBDataType.CHAR))
            End If

#End If
            '私の担当分
            If LMConst.FLG.ON.Equals(.Item("TANTO_USER_FLG").ToString()) Then
                whereStr = .Item("USER_ID").ToString()
                If String.IsNullOrEmpty(whereStr) = False Then
                    Me._StrSql.Append(" AND C_OUTKA_L.SYS_ENT_USER = @SYS_ENT_USER")
                    Me._StrSql.Append(vbNewLine)
                    Me._SqlPrmList.Add(MyBase.GetSqlParameter("@SYS_ENT_USER", whereStr, DBDataType.NVARCHAR))
                End If
            End If

            ' 現場作業指示ステータス
            whereStr = .Item("SEARCH_WH_TAB_STATUS").ToString()
            If String.IsNullOrEmpty(whereStr) = False Then
                Me._StrSql.AppendLine(" AND C_OUTKA_L.WH_TAB_STATUS = @SEARCH_WH_TAB_STATUS ")
                Me._SqlPrmList.Add(MyBase.GetSqlParameter("@SEARCH_WH_TAB_STATUS", whereStr, DBDataType.CHAR))
            End If

            ' COA有無区分 ADD 2019/06/19 004870
            whereStr = .Item("COA_UMU").ToString()
            If String.IsNullOrEmpty(whereStr) = False Then
                Me._StrSql.AppendLine(" AND KBN_COAUMU.KBN_CD = @COA_UMU ")
                Me._SqlPrmList.Add(MyBase.GetSqlParameter("@COA_UMU", whereStr, DBDataType.CHAR))
            End If

        End With

    End Sub

    'START YANAI 要望番号773　報告書Excel対応
    ''' <summary>
    ''' 条件文・パラメータ設定モジュール
    ''' </summary>
    ''' <remarks></remarks>
    Private Sub SetHoukokuExcelSQL(ByVal inTbl As DataTable)

        'SQLパラメータ初期化
        Me._SqlPrmList = New ArrayList()

        '検索条件部に入力された条件とパラメータ設定
        Dim whereStr As String = String.Empty
        Dim whereSql As String = String.Empty
        Dim max As Integer = inTbl.Rows.Count - 1
        With inTbl.Rows(0)

            Me._StrSql.Append("WHERE                                                          ")
            Me._StrSql.Append(vbNewLine)

            '営業所
            whereStr = .Item("NRS_BR_CD").ToString()
            If String.IsNullOrEmpty(whereStr) = False Then
                Me._StrSql.Append(" OUTKAL.NRS_BR_CD = @NRS_BR_CD")
                Me._StrSql.Append(vbNewLine)
                Me._SqlPrmList.Add(MyBase.GetSqlParameter("@NRS_BR_CD", whereStr, DBDataType.CHAR))
            End If

            '出荷管理番号
            For i As Integer = 0 To max
                whereStr = inTbl.Rows(i).Item("OUTKA_NO_L").ToString()
                If String.IsNullOrEmpty(inTbl.Rows(i).Item("OUTKA_NO_L").ToString()) = False Then
                    If String.IsNullOrEmpty(whereSql) = True Then
                        whereSql = String.Concat("AND OUTKAL.OUTKA_NO_L IN ('", whereStr, "'")
                    Else
                        whereSql = String.Concat(whereSql, ",'", whereStr, "'")
                    End If
                End If
            Next
            whereSql = String.Concat(whereSql, ")")
            Me._StrSql.Append(whereSql)
            Me._StrSql.Append(vbNewLine)

            If "10".Equals(Me._Row.Item("NRS_BR_CD").ToString()) = True Then
                Me._StrSql.Append(" AND EDIL.NRS_BR_CD IS NOT NULL")
                Me._StrSql.Append(vbNewLine)
            End If

        End With

    End Sub
    'END YANAI 要望番号773　報告書Excel対応

    ''' <summary>
    ''' 条件文・パラメータ設定モジュール
    ''' </summary>
    ''' <remarks></remarks>
    Private Function SetHoukokuChibaExcelSQL(ByVal inTbl As DataTable) As String

        Dim whereStr As String = String.Empty
        Dim whereSql As String = String.Empty
        Dim max As Integer = inTbl.Rows.Count - 1

        With inTbl.Rows(0)

            '出荷管理番号
            For i As Integer = 0 To max
                whereStr = inTbl.Rows(i).Item("OUTKA_NO_L").ToString()
                If String.IsNullOrEmpty(inTbl.Rows(i).Item("OUTKA_NO_L").ToString()) = False Then
                    If String.IsNullOrEmpty(whereSql) = True Then
                        whereSql = String.Concat("AND EDIOUTL.OUTKA_CTL_NO IN ('", whereStr, "'")
                    Else
                        whereSql = String.Concat(whereSql, ",'", whereStr, "'")
                    End If
                End If
            Next
            whereSql = String.Concat(whereSql, ")")

        End With

        Return whereSql

    End Function

    'START YANAI 要望番号853 まとめ処理対応
    ''' <summary>
    ''' パラメータ設定モジュール(マスタ存在チェック)
    ''' </summary>
    ''' <param name="prmList">パラメータ</param>
    ''' <remarks></remarks>
    Private Sub SetSelectParamZaiMATOME(ByVal prmList As ArrayList)

        With Me._Row

            'パラメータ設定
            prmList.Add(MyBase.GetSqlParameter("@NRS_BR_CD", .Item("NRS_BR_CD").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@GOODS_CD_NRS", .Item("GOODS_CD_NRS").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@LOT_NO", .Item("LOT_NO").ToString(), DBDataType.NVARCHAR))
            prmList.Add(MyBase.GetSqlParameter("@IRIME", Me.FormatNumValue(.Item("IRIME").ToString()), DBDataType.NUMERIC))
            prmList.Add(MyBase.GetSqlParameter("@TOU_NO", .Item("TOU_NO").ToString(), DBDataType.NVARCHAR))
            prmList.Add(MyBase.GetSqlParameter("@SITU_NO", .Item("SITU_NO").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@ZONE_CD", .Item("ZONE_CD").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@LOCA", .Item("LOCA").ToString(), DBDataType.NVARCHAR))
            prmList.Add(MyBase.GetSqlParameter("@GOODS_COND_KB_1", .Item("GOODS_COND_KB_1").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@GOODS_COND_KB_2", .Item("GOODS_COND_KB_2").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@REMARK_OUT", .Item("REMARK_OUT").ToString(), DBDataType.NVARCHAR))
            prmList.Add(MyBase.GetSqlParameter("@REMARK", .Item("REMARK").ToString(), DBDataType.NVARCHAR))
            prmList.Add(MyBase.GetSqlParameter("@LT_DATE", .Item("LT_DATE").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@OFB_KB", .Item("OFB_KB").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@SPD_KB", .Item("SPD_KB").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@RSV_NO", .Item("RSV_NO").ToString(), DBDataType.NVARCHAR))
            prmList.Add(MyBase.GetSqlParameter("@SERIAL_NO", .Item("SERIAL_NO").ToString(), DBDataType.NVARCHAR))
            prmList.Add(MyBase.GetSqlParameter("@GOODS_CRT_DATE", .Item("GOODS_CRT_DATE").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@ALLOC_PRIORITY", .Item("ALLOC_PRIORITY").ToString(), DBDataType.CHAR))

        End With

    End Sub
    'END YANAI 要望番号853 まとめ処理対応

    '社内入荷データ作成対応 terakawa 2012.11.19 Start
    ''' <summary>
    ''' 出荷データ作成用データの検索パラメータ設定
    ''' </summary>
    ''' <param name="ds">DataSet</param>
    ''' <remarks></remarks>
    Private Sub SetInkaDataSelectParameter(ByVal ds As DataSet)

        With ds

            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@NRS_BR_CD", .Tables("LMC010_INKA_IN").Rows(0).Item("NRS_BR_CD").ToString(), DBDataType.CHAR))
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@OUTKA_NO_L", .Tables("LMC010_INKA_IN").Rows(0).Item("OUTKA_NO_L").ToString(), DBDataType.CHAR))
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@INT_EDI_CD", .Tables("LMC010_INKA_IN").Rows(0).Item("INT_EDI_CD").ToString(), DBDataType.CHAR))
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@SYS_UPD_DATE", .Tables("LMC010_INKA_IN").Rows(0).Item("SYS_UPD_DATE").ToString(), DBDataType.CHAR))
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@SYS_UPD_TIME", .Tables("LMC010_INKA_IN").Rows(0).Item("SYS_UPD_TIME").ToString(), DBDataType.CHAR))

        End With

    End Sub
    '社内入荷データ作成対応 terakawa 2012.11.19 End

#If True Then  ' FFEM機能改修(納品書未受信状態表示対応) 20170127 added

    ''' <summary>
    ''' 納品書不要データ検索用パラメータ設定
    ''' </summary>
    ''' <param name="ds"></param>
    ''' <remarks></remarks>
    Private Sub SetSelectParameterNeedlessNhs(ByVal ds As DataSet)

        With ds

            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@NRS_BR_CD", .Tables("LMC010_NOUHINSYO_IN").Rows(0).Item("NRS_BR_CD").ToString(), DBDataType.CHAR))
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@OUTKA_NO_L", .Tables("LMC010_NOUHINSYO_IN").Rows(0).Item("OUTKA_NO_L").ToString(), DBDataType.CHAR))

        End With

    End Sub

#End If

#Region "タブレット関連項目の設定値取得"

    ''' <summary>
    ''' タブレット関連項目の設定値取得
    ''' </summary>
    ''' <param name="ds">DataSet</param>
    ''' <returns>DataSet</returns>
    ''' <remarks></remarks>
    Private Function SelectOutkaLWHData(ByVal ds As DataSet) As DataSet

        'DataSetのIN情報を取得
        Dim inTbl As DataTable = ds.Tables("LMC010_OUTKA_M_IN")

        'SQL格納変数の初期化
        Me._StrSql = New StringBuilder()

        'SQLパラメータ初期化
        Me._SqlPrmList = New ArrayList()

        'SQL作成
        Me._StrSql.AppendLine("SELECT                                         ")
        Me._StrSql.AppendLine("	 OUTL.NRS_BR_CD      AS NRS_BR_CD             ")
        Me._StrSql.AppendLine("	,OUTL.OUTKA_NO_L     AS OUTKA_NO_L            ")
        Me._StrSql.AppendLine("	,CASE                                         ")
        Me._StrSql.AppendLine("	  WHEN OUTL.WH_TAB_STATUS = '00' THEN '00'    ")
        Me._StrSql.AppendLine("	  WHEN OUTL.WH_TAB_STATUS = '01' THEN '02'    ")
        Me._StrSql.AppendLine("	  WHEN OUTL.WH_TAB_STATUS = '02' THEN '02'    ")
        Me._StrSql.AppendLine("	  ELSE '00'                                   ")
        Me._StrSql.AppendLine("	 END                 AS WH_TAB_STATUS         ")
        Me._StrSql.AppendLine("	,OUTL.WH_TAB_YN      AS WH_TAB_YN             ")
        Me._StrSql.AppendLine("	,'00'                AS URGENT_YN             ")
        Me._StrSql.AppendLine("	,OUTL.WH_CD          AS WH_CD                 ")
        Me._StrSql.AppendLine("	,SOKO.LOC_MANAGER_YN AS LOC_MANAGER_YN        ")
        Me._StrSql.AppendLine("FROM $LM_TRN$..C_OUTKA_L OUTL                  ")
        Me._StrSql.AppendLine("LEFT JOIN $LM_MST$..Z_KBN KBN                  ")
        Me._StrSql.AppendLine("ON  KBN.KBN_GROUP_CD = 'B007'                  ")
        Me._StrSql.AppendLine("AND KBN.KBN_CD = OUTL.NRS_BR_CD                ")
        Me._StrSql.AppendLine("LEFT JOIN $LM_MST$..M_SOKO SOKO                ")
        Me._StrSql.AppendLine("ON  SOKO.NRS_BR_CD = OUTL.NRS_BR_CD            ")
        Me._StrSql.AppendLine("AND SOKO.WH_CD     = OUTL.WH_CD                ")
        Me._StrSql.AppendLine("WHERE                                          ")
        Me._StrSql.AppendLine("    OUTL.NRS_BR_CD  = @NRS_BR_CD               ")
        Me._StrSql.AppendLine("AND OUTL.OUTKA_NO_L = @OUTKA_NO_L              ")

        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@NRS_BR_CD", inTbl.Rows(0).Item("NRS_BR_CD").ToString(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@OUTKA_NO_L", inTbl.Rows(0).Item("OUTKA_NO_L").ToString(), DBDataType.CHAR))

        'スキーマ名設定
        Dim sql As String = Me.SetSchemaNm(Me._StrSql.ToString(), inTbl.Rows(0).Item("NRS_BR_CD").ToString())

        'SQL文のコンパイル
        Dim cmd As SqlCommand = MyBase.CreateSqlCommand(sql)

        'パラメータの反映
        For Each obj As Object In Me._SqlPrmList
            cmd.Parameters.Add(obj)
        Next

        MyBase.Logger.WriteSQLLog("LMC010DAC", "SelectOutkaLWHData", cmd)

        'SQLの発行
        Dim reader As SqlDataReader = MyBase.GetSelectResult(cmd)

        'DataReader→DataTableへの転記
        Dim map As Hashtable = New Hashtable()

        '取得データの格納先をマッピング
        map.Add("NRS_BR_CD", "NRS_BR_CD")
        map.Add("OUTKA_NO_L", "OUTKA_NO_L")
        map.Add("WH_TAB_STATUS", "WH_TAB_STATUS")
        map.Add("WH_TAB_YN", "WH_TAB_YN")
        map.Add("URGENT_YN", "URGENT_YN")
        map.Add("WH_CD", "WH_CD")
        map.Add("LOC_MANAGER_YN", "LOC_MANAGER_YN")
        ds = MyBase.SetSelectResultToDataSet(map, ds, reader, "LMC010_TABLET_IN")

        reader.Close()

        Return ds

    End Function

    ''' <summary>
    ''' 棟室情報取得
    ''' </summary>
    ''' <param name="ds">DataSet</param>
    ''' <returns>DataSet</returns>
    ''' <remarks></remarks>
    Private Function SelectTouSituData(ByVal ds As DataSet) As DataSet

        'DataSetのIN情報を取得
        Dim inTbl As DataTable = ds.Tables("LMC010_OUTKA_M_IN")

        'SQL格納変数の初期化
        Me._StrSql = New StringBuilder()

        'SQLパラメータ初期化
        Me._SqlPrmList = New ArrayList()

        'SQL作成
        Me._StrSql.AppendLine("SELECT                                  ")
        Me._StrSql.AppendLine(" NRS_BR_CD     AS NRS_BR_CD             ")
        Me._StrSql.AppendLine(",WH_CD         AS WH_CD                 ")
        Me._StrSql.AppendLine(",TOU_NO        AS TOU_NO                ")
        Me._StrSql.AppendLine(",SITU_NO       AS SITU_NO               ")
        Me._StrSql.AppendLine(",JISYATASYA_KB AS JISYATASYA_KB         ")
        Me._StrSql.AppendLine("FROM $LM_MST$..M_TOU_SITU               ")
        Me._StrSql.AppendLine("WHERE NRS_BR_CD = @NRS_BR_CD            ")

        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@NRS_BR_CD", inTbl.Rows(0).Item("NRS_BR_CD").ToString(), DBDataType.CHAR))

        'スキーマ名設定
        Dim sql As String = Me.SetSchemaNm(Me._StrSql.ToString(), inTbl.Rows(0).Item("NRS_BR_CD").ToString())

        'SQL文のコンパイル
        Dim cmd As SqlCommand = MyBase.CreateSqlCommand(sql)

        'パラメータの反映
        For Each obj As Object In Me._SqlPrmList
            cmd.Parameters.Add(obj)
        Next

        MyBase.Logger.WriteSQLLog("LMC010DAC", "SelectTouSituData", cmd)

        'SQLの発行
        Dim reader As SqlDataReader = MyBase.GetSelectResult(cmd)

        'DataReader→DataTableへの転記
        Dim map As Hashtable = New Hashtable()

        '取得データの格納先をマッピング
        map.Add("NRS_BR_CD", "NRS_BR_CD")
        map.Add("WH_CD", "WH_CD")
        map.Add("TOU_NO", "TOU_NO")
        map.Add("SITU_NO", "SITU_NO")
        map.Add("JISYATASYA_KB", "JISYATASYA_KB")

        ds = MyBase.SetSelectResultToDataSet(map, ds, reader, "LMC010OUT_TOUSITU")

        reader.Close()

        Return ds

    End Function

#End Region


#End Region

#Region "変更処理"

    ''' <summary>
    ''' 運送会社マスタ存在チェック
    ''' </summary>
    ''' <param name="ds"></param>
    ''' <returns></returns>
    ''' <remarks></remarks>
    Private Function SQLSelectExit(ByVal ds As DataSet) As DataSet

        'DataSetのIN情報を取得
        Dim dt As DataTable = ds.Tables("LMC010IN_UPDATE")

        'INTableの条件rowの格納
        Me._Row = dt.Rows(0)

        'SQL格納変数の初期化
        Me._StrSql = New StringBuilder()

        'SQL作成
        Me._StrSql.Append(LMC010DAC.SQL_UNSOCO_MST_CHECK)      'SQL構築(Select句)
        Call setSQLSelectExists()    'パラメータ設定

        'スキーマ名設定
        Dim sql As String = Me.SetSchemaNm(Me._StrSql.ToString(), Me._Row.Item("NRS_BR_CD").ToString())

        'SQL文のコンパイル
        Dim cmd As SqlCommand = MyBase.CreateSqlCommand(sql)

        'パラメータの反映
        For Each obj As Object In Me._SqlPrmList
            cmd.Parameters.Add(obj)
        Next

        'SQLの発行
        Dim reader As SqlDataReader = MyBase.GetSelectResult(cmd)

        '処理件数の設定
        reader.Read()
        MyBase.SetResultCount(Convert.ToInt32(reader("REC_CNT")))
        reader.Close()
        Return ds

    End Function

    ''' <summary>
    ''' 運送Lテーブル更新（運送会社変更時）
    ''' </summary>
    ''' <param name="ds"></param>
    ''' <returns></returns>
    ''' <remarks></remarks>
    Private Function HenkoData(ByVal ds As DataSet) As DataSet

        Dim rtnDs As DataSet = Nothing

        'メッセージ設定フラグの初期化
        Me._msgFlg = False

        'DataSetのIN情報を取得
        Dim inTbl As DataTable = ds.Tables("LMC010IN_UPDATE")

        'INTableの条件rowの格納
        Me._Row = inTbl.Rows(0)

        '運送Lテーブルの更新
        rtnDs = Me.UpdateData_F_UNSO_L(ds)

        If Me._msgFlg = False Then

            '出荷Lテーブルの更新
            rtnDs = Me.UpdateData_C_OUTKA_L(ds)

        End If

        'エラー有無を設定
        Dim dt As DataTable = ds.Tables("LMC010OUT_CHKHAITA")
        Dim dr As DataRow = dt.NewRow()
        If Me._msgFlg = True Then
            dr.Item("CHK_FLG") = LMConst.FLG.ON  'エラー有り
        Else
            dr.Item("CHK_FLG") = LMConst.FLG.OFF 'エラーなし
        End If
        dt.Rows.Add(dr)

        Return ds

    End Function

    ''' <summary>
    ''' 運送Lテーブル更新（運送会社変更時）
    ''' </summary>
    ''' <param name="ds"></param>
    ''' <returns></returns>
    ''' <remarks></remarks>
    Private Function UpdateData_F_UNSO_L(ByVal ds As DataSet) As DataSet

        'SQL格納変数の初期化
        Me._StrSql = New StringBuilder()

        'SQL構築
        If Me._Row.Item("UPD_KB").ToString() = "1" Then
            Me._StrSql.Append(LMC010DAC.SQL_UPDATE_IKKATU_UNSOL2) '更新用SQL(運送会社が未設定だったの場合)
        Else
            Me._StrSql.Append(LMC010DAC.SQL_UPDATE_IKKATU_UNSOL)  '更新用SQL
        End If

        'SQL文のコンパイル
        Dim cmd As SqlCommand = MyBase.CreateSqlCommand(Me.SetSchemaNm(Me._StrSql.ToString(), Me._Row.Item("NRS_BR_CD").ToString()))

        'SQLパラメータ初期化/設定
        Call Me.SetParamUpdateIkkatuUnsoL()

        'パラメータの反映
        For Each obj As Object In Me._SqlPrmList
            cmd.Parameters.Add(obj)
        Next

        MyBase.Logger.WriteSQLLog("LMC010DAC", "UpdateData_F_UNSO_L", cmd)

        'SQLの発行
        If MyBase.GetUpdateResult(cmd) < 1 Then
            MyBase.SetMessageStore("00" _
                                   , "E011" _
                                   , _
                                   , Me._Row.Item("RECORD_NO").ToString() _
                                   , "出荷管理番号" _
                                   , Me._Row.Item("OUTKA_NO_L").ToString())

            'メッセージ設定判定用フラグ設定
            Me._msgFlg = True

        End If

        cmd.Parameters.Clear()

        Return ds

    End Function

    ''' <summary>
    ''' 出荷Lテーブル更新（運送会社変更時）
    ''' </summary>
    ''' <param name="ds"></param>
    ''' <returns></returns>
    ''' <remarks></remarks>
    Private Function UpdateData_C_OUTKA_L(ByVal ds As DataSet) As DataSet

        'SQL格納変数の初期化
        Me._StrSql = New StringBuilder()

        'SQL構築
        Me._StrSql.Append(LMC010DAC.SQL_UPDATE_IKKATU_OUTKAL)  '更新用SQL

        'SQL文のコンパイル
        Dim cmd As SqlCommand = MyBase.CreateSqlCommand(Me.SetSchemaNm(Me._StrSql.ToString(), Me._Row.Item("NRS_BR_CD").ToString()))

        'SQLパラメータ初期化/設定
        Call Me.SetParamUpdateIkkatuOutkaL()

        'パラメータの反映
        For Each obj As Object In Me._SqlPrmList
            cmd.Parameters.Add(obj)
        Next

        MyBase.Logger.WriteSQLLog("LMC010DAC", "UpdateData_C_OUTKA_L", cmd)

        'SQLの発行
        If MyBase.GetUpdateResult(cmd) < 1 Then
            MyBase.SetMessageStore("00" _
                                   , "E011" _
                                   , _
                                   , Me._Row.Item("RECORD_NO").ToString() _
                                   , "出荷管理番号" _
                                   , Me._Row.Item("OUTKA_NO_L").ToString())

            'メッセージ設定判定用フラグ設定
            Me._msgFlg = True

        End If

        cmd.Parameters.Clear()

        Return ds

    End Function

    ''' <summary>
    ''' 出荷Lテーブル更新（印刷時）
    ''' </summary>
    ''' <param name="ds"></param>
    ''' <returns></returns>
    ''' <remarks></remarks>
    Private Function UpdateDataPrint(ByVal ds As DataSet) As DataSet

        'DataSetのIN情報を取得
        Me._Row = ds.Tables("LMC010IN_OUTKA_L").Rows(0)

        'パラメータ設定
        Me._SqlPrmList = New ArrayList()
        Call Me.SetParamCommonSystemUp()
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@NRS_BR_CD", Me._Row("NRS_BR_CD").ToString(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@OUTKA_NO_L", Me._Row("OUTKA_NO_L").ToString(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@OUTKA_STATE_KB", Me._Row("OUTKA_STATE_KB").ToString(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@PRINT_KB", Me._Row("PRINT_KB").ToString(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@GUI_SYS_UPD_DATE", Me._Row("SYS_UPD_DATE").ToString(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@GUI_SYS_UPD_TIME", Me._Row("SYS_UPD_TIME").ToString(), DBDataType.CHAR))
        'START YANAI 要望番号800
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@OUTKA_PKG_NB", Me._Row("OUTKA_PKG_NB").ToString(), DBDataType.CHAR))
        'END YANAI 要望番号800

        'スキーマ名設定
        Dim sql As String = Me.SetSchemaNm(LMC010DAC.SQL_UPDATE_PRINT, Me._Row.Item("NRS_BR_CD").ToString())

        'SQL文のコンパイル
        Dim cmd As SqlCommand = MyBase.CreateSqlCommand(sql)

        'パラメータの反映
        For Each obj As Object In Me._SqlPrmList
            cmd.Parameters.Add(obj)
        Next

        MyBase.Logger.WriteSQLLog("LMC010DAC", "UpdateDataPrint", cmd)

        MyBase.Logger.WriteLog(0, "LMC010DAC", "UpdateDataPrint", "出荷Lテーブル更新（印刷時）START")
        'SQLの発行
        Me.UpdateResultChk(cmd, True)
        MyBase.Logger.WriteLog(0, "LMC010DAC", "UpdateDataPrint", "出荷Lテーブル更新（印刷時）END")

        Return ds

    End Function

    ''' <summary>
    ''' 出荷Lテーブル更新（印刷時）
    ''' </summary>
    ''' <param name="ds"></param>
    ''' <returns></returns>
    ''' <remarks></remarks>
    Private Function UpdateDataCOAPrint(ByVal ds As DataSet) As DataSet

        'DataSetのIN情報を取得
        Me._Row = ds.Tables("LMC010IN_OUTKA_L").Rows(0)

        'パラメータ設定
        Me._SqlPrmList = New ArrayList()
        Call Me.SetParamCommonSystemUp()
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@NRS_BR_CD", Me._Row("NRS_BR_CD").ToString(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@OUTKA_NO_L", Me._Row("OUTKA_NO_L").ToString(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@OUTKA_STATE_KB", Me._Row("OUTKA_STATE_KB").ToString(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@PRINT_KB", Me._Row("PRINT_KB").ToString(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@GUI_SYS_UPD_DATE", Me._Row("SYS_UPD_DATE").ToString(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@GUI_SYS_UPD_TIME", Me._Row("SYS_UPD_TIME").ToString(), DBDataType.CHAR))
        'START YANAI 要望番号800
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@OUTKA_PKG_NB", Me._Row("OUTKA_PKG_NB").ToString(), DBDataType.CHAR))
        'END YANAI 要望番号800

        'スキーマ名設定()
        Dim sql As String = Me.SetSchemaNm(LMC010DAC.SQL_UPDATE_PRINT_COA, Me._Row.Item("NRS_BR_CD").ToString())

        'SQL文のコンパイル
        Dim cmd As SqlCommand = MyBase.CreateSqlCommand(sql)

        'パラメータの反映
        For Each obj As Object In Me._SqlPrmList
            cmd.Parameters.Add(obj)
        Next

        MyBase.Logger.WriteSQLLog("LMC010DAC", "UpdateDataPrint", cmd)


        'SQLの発行
        Me.UpdateResultChk(cmd, True)


        Return ds

    End Function


    'START YANAI 20120615 まとめ荷札・送状対応(埼玉浮間対応)
    ''' <summary>
    ''' 出荷Lテーブル更新（まとめ荷札・送状の印刷時）
    ''' </summary>
    ''' <param name="ds"></param>
    ''' <returns></returns>
    ''' <remarks></remarks>
    Private Function UpdateDataPrintMatome(ByVal ds As DataSet) As DataSet

        Dim max As Integer = ds.Tables("LMC010OUT_MATOME").Rows.Count - 1
        If max = -1 Then
            Return ds
        End If

        Dim outkaNoL As String = ds.Tables("LMC010IN_OUTKA_L").Rows(0).Item("OUTKA_NO_L").ToString

        'DataSetのIN情報を取得
        Me._Row = ds.Tables("LMC010OUT_MATOME").Rows(0)

        'スキーマ名設定
        Dim sql As String = Me.SetSchemaNm(LMC010DAC.SQL_UPDATE_PRINT, Me._Row.Item("NRS_BR_CD").ToString())
        Dim cmd As SqlCommand = Nothing

        For i As Integer = 0 To max
            'DataSetのIN情報を取得
            Me._Row = ds.Tables("LMC010OUT_MATOME").Rows(i)

            If (outkaNoL).Equals(Me._Row("OUTKA_NO_L").ToString) = True Then
                Me._Row("SYS_UPD_DATE") = ds.Tables("LMC010IN_OUTKA_L").Rows(0).Item("SYS_UPD_DATE").ToString
                Me._Row("SYS_UPD_TIME") = ds.Tables("LMC010IN_OUTKA_L").Rows(0).Item("SYS_UPD_TIME").ToString
            End If

            'パラメータ設定
            Me._SqlPrmList = New ArrayList()
            Call Me.SetParamCommonSystemUp()
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@NRS_BR_CD", Me._Row("NRS_BR_CD").ToString(), DBDataType.CHAR))
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@OUTKA_NO_L", Me._Row("OUTKA_NO_L").ToString(), DBDataType.CHAR))
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@OUTKA_STATE_KB", Me._Row("OUTKA_STATE_KB").ToString(), DBDataType.CHAR))
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@PRINT_KB", Me._Row("PRINT_KB").ToString(), DBDataType.CHAR))
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@GUI_SYS_UPD_DATE", Me._Row("SYS_UPD_DATE").ToString(), DBDataType.CHAR))
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@GUI_SYS_UPD_TIME", Me._Row("SYS_UPD_TIME").ToString(), DBDataType.CHAR))
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@OUTKA_PKG_NB", Me._Row("OUTKA_PKG_NB").ToString(), DBDataType.CHAR))

            'SQL文のコンパイル
            cmd = MyBase.CreateSqlCommand(sql)

            'パラメータの反映
            For Each obj As Object In Me._SqlPrmList
                cmd.Parameters.Add(obj)
            Next

            MyBase.Logger.WriteSQLLog("LMC010DAC", "UpdateDataPrintMatome", cmd)

            MyBase.Logger.WriteLog(0, "LMC010DAC", "UpdateDataPrintMatome", "出荷Lテーブル更新（まとめ荷札・送状の印刷時）START")
            'SQLの発行
            Me.UpdateResultChk(cmd, True)
            MyBase.Logger.WriteLog(0, "LMC010DAC", "UpdateDataPrintMatome", "出荷Lテーブル更新（まとめ荷札・送状の印刷時）END")
        Next

        Return ds

    End Function
    'END YANAI 20120615 まとめ荷札・送状対応(埼玉浮間対応)


#If True Then ' 名鉄対応(2499)

    ''' <summary>
    ''' 出荷Lテーブル更新（名鉄帳票の印刷時(ToDo:UpdatePrintDataへ統合を検討)
    ''' </summary>
    ''' <param name="ds"></param>
    ''' <returns></returns>
    ''' <remarks></remarks>
    Private Function UpdateDataPrintMeitetu(ByVal ds As DataSet) As DataSet

        'DataSetのIN情報を取得
        'Me._Row = ds.Tables("LMC010IN_UPDATE").Rows(0)
        Me._Row = ds.Tables("LMC010IN_OUTKA_L").Rows(0)

        'パラメータ設定
        Me._SqlPrmList = New ArrayList()
        Call Me.SetParamCommonSystemUp()
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@NRS_BR_CD", Me._Row("NRS_BR_CD").ToString(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@OUTKA_NO_L", Me._Row("OUTKA_NO_L").ToString(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@GUI_SYS_UPD_DATE", Me._Row("SYS_UPD_DATE").ToString(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@GUI_SYS_UPD_TIME", Me._Row("SYS_UPD_TIME").ToString(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@MEITETU_PRINT_FLG", Me._Row("MEITETU_PRINT_FLG").ToString(), DBDataType.CHAR))  'add 2017/07/18

        'スキーマ名設定()
        Dim sql As String = Me.SetSchemaNm(LMC010DAC.SQL_UPDATE_PRINT_MEITETU, Me._Row.Item("NRS_BR_CD").ToString())

        'SQL文のコンパイル
        Dim cmd As SqlCommand = MyBase.CreateSqlCommand(sql)

        'パラメータの反映
        For Each obj As Object In Me._SqlPrmList
            cmd.Parameters.Add(obj)
        Next

        MyBase.Logger.WriteSQLLog("LMC010DAC", "UpdateDataPrintMeitetu", cmd)

#If fasle Then
        'SQLの発行
        If (MyBase.GetUpdateResult(cmd) < 1) Then
            MyBase.SetMessageStore("00", "E011")

            Return ds
        End If
#Else
        Me.UpdateResultChk(cmd, True)
#End If

        Return ds

    End Function



#End If
    'START YANAI 要望番号773　報告書Excel対応
    ''' <summary>
    ''' 出荷Lテーブル更新（印刷時）
    ''' </summary>
    ''' <param name="ds"></param>
    ''' <returns></returns>
    ''' <remarks></remarks>
    Private Function UpdateHoukokuExcel(ByVal ds As DataSet) As DataSet

        'DataSetのIN情報を取得
        Me._Row = ds.Tables("LMC010IN_HOUKOKU_EXCEL").Rows(0)

        'パラメータ設定
        Me._SqlPrmList = New ArrayList()

        'スキーマ名設定
        Dim sql As String = Me.SetSchemaNm(LMC010DAC.SQL_UPDATE_HOUKOKU_EXCEL, Me._Row.Item("NRS_BR_CD").ToString())

        Call Me.SetParamCommonSystemUp()
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@NRS_BR_CD", Me._Row("NRS_BR_CD").ToString(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@OUTKA_NO_L", Me._Row("OUTKA_NO_L").ToString(), DBDataType.CHAR))


        'SQL文のコンパイル
        Dim cmd As SqlCommand = MyBase.CreateSqlCommand(sql)

        'パラメータの反映
        For Each obj As Object In Me._SqlPrmList
            cmd.Parameters.Add(obj)
        Next

        MyBase.Logger.WriteSQLLog("LMC010DAC", "UpdateHoukokuExcel", cmd)

        MyBase.Logger.WriteLog(0, "LMC010DAC", "UpdateHoukokuExcel", "出荷Lテーブル更新（印刷時）報告書EXCEL対応START")
        'SQLの発行
        Me.UpdateResultChk(cmd, True)
        MyBase.Logger.WriteLog(0, "LMC010DAC", "UpdateHoukokuExcel", "出荷Lテーブル更新（印刷時）報告書EXCEL対応END")

        Return ds

    End Function

#Region "出荷送状番号 C_OUTKA_DENP_NO"

    'ADD 2016/06/21 要望番号:258
    ''' <summary>
    ''' 出荷Lテーブル更新（送状番号更新時）
    ''' </summary>
    ''' <param name="ds"></param>
    ''' <returns></returns>
    ''' <remarks></remarks>
    Private Function UpdateDenp_No(ByVal ds As DataSet) As DataSet

        'DataSetのIN情報を取得
        Me._Row = ds.Tables("LMC010IN_OUTKA_DENP_NO").Rows(0)

        'パラメータ設定
        Me._SqlPrmList = New ArrayList()

        'スキーマ名設定
        Dim sql As String = Me.SetSchemaNm(LMC010DAC.SQL_UPDATE_DENP_NO, Me._Row.Item("NRS_BR_CD").ToString())

        Call Me.SetParamCommonSystemUp()
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@NRS_BR_CD", Me._Row("NRS_BR_CD").ToString(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@OUTKA_NO_L", Me._Row("OUTKA_NO_L").ToString(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@DENP_NO", Me._Row("DENP_NO").ToString(), DBDataType.CHAR))

        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@OUTKA_PKG_NB", Me._Row("OUTKA_PKG_NB").ToString(), DBDataType.NUMERIC))     'ADD 2016/07/14

        'SQL文のコンパイル
        Dim cmd As SqlCommand = MyBase.CreateSqlCommand(sql)

        'パラメータの反映
        For Each obj As Object In Me._SqlPrmList
            cmd.Parameters.Add(obj)
        Next

        MyBase.Logger.WriteSQLLog("LMC010DAC", "UpdateSagawaDenp_No", cmd)

        MyBase.Logger.WriteLog(0, "LMC010DAC", "UpdateDenp_No", "出荷Lテーブル更新（送状番号更新対応START")
        'SQLの発行
        'Me.UpdateResultChk(cmd, True)
        Dim rtn As Integer = Me.GetUpdateResult(cmd)

        MyBase.Logger.WriteLog(0, "LMC010DAC", "UpdateDenp_No", "出荷Lテーブル更新（送状番号更新対応END")

        Return ds

    End Function

    'ADD 2016/06/21 要望番号:2580
    ''' <summary>
    ''' 出荷送り状番号テーブルの物理削除処理
    ''' </summary>
    ''' <param name="ds">DataSet</param>
    ''' <returns>DataSet</returns>
    ''' <remarks>支払運賃テーブル更新SQLの構築・発行</remarks>
    Private Function DeleteOutkaDenp_No(ByVal ds As DataSet) As DataSet

        'DataSetのIN情報を取得
        Dim dr As DataRow = ds.Tables("LMC010IN_OUTKA_DENP_NO").Rows(0)

        'DataSetのIN情報を取得
        Dim inTbl As DataTable = ds.Tables("LMC010IN_OUTKA_DENP_NO")

        '更新情報の取得
        Dim drs As DataRow() = inTbl.Select(String.Concat("OUTKA_NO_L = '", dr.Item("OUTKA_NO_L").ToString(), "' "))

        'SQL文のコンパイル
        Dim cmd As SqlCommand = MyBase.CreateSqlCommand(Me.SetSchemaNm _
                                                        (LMC010DAC.SQL_DELETE_DENP_NO, Me._Row.Item("NRS_BR_CD").ToString()))

        'SQLパラメータ初期化
        Me._SqlPrmList = New ArrayList()

        'パラメータ設定
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@NRS_BR_CD", Me._Row.Item("NRS_BR_CD").ToString(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@OUTKA_NO_L", drs(0).Item("OUTKA_NO_L").ToString(), DBDataType.CHAR))

        'パラメータの反映
        For Each obj As Object In Me._SqlPrmList
            cmd.Parameters.Add(obj)
        Next

        MyBase.Logger.WriteSQLLog("LMC010DAC", "DeleteOutkaDenp_No", cmd)

        'SQLの発行
        MyBase.GetUpdateResult(cmd)

        Return ds

    End Function

    ''ADD 2016/06/21 要望番号:2580
    ''' <summary>
    ''' 出荷送り状番号テーブルの登録を行います。
    ''' </summary>
    ''' <param name="ds">検索条件DataSet</param>
    ''' <returns>結果DataSet</returns>
    ''' <remarks></remarks>
    Private Function InsertOutkaDenp_No(ByVal ds As DataSet) As DataSet

        'DataSetのIN情報を取得
        Dim inTbl As DataTable = ds.Tables("LMC010IN_OUTKA_DENP_NO")
        Dim inRow As DataRow = inTbl.Rows(0)

        'SQL文のコンパイル
        Dim cmd As SqlCommand = MyBase.CreateSqlCommand(Me.SetSchemaNm(LMC010DAC.SQL_INSERT__DENP_NO _
                                                                       , inRow("NRS_BR_CD").ToString.ToString()))


        'SQLパラメータ初期化
        Me._SqlPrmList = New ArrayList()

        'パラメータ設定
        Call SetParamCommonSystemIns()
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@NRS_BR_CD", inRow("NRS_BR_CD").ToString(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@OUTKA_NO_L", inRow("OUTKA_NO_L").ToString(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@DENP_NO", inRow("DENP_NO").ToString(), DBDataType.CHAR))

        'パラメータの反映
        For Each obj As Object In Me._SqlPrmList
            cmd.Parameters.Add(obj)
        Next

        MyBase.Logger.WriteSQLLog("LMC010DAC", "InsertOutkaDenp_No", cmd)

        'SQLの発行
        MyBase.GetInsertResult(cmd)

        Return ds

    End Function

    ''ADD 2016/06/21 要望番号:2580
    ''' <summary>
    ''' 出荷管理番号L存在チェック
    ''' </summary>
    ''' <param name="ds"></param>
    ''' <returns></returns>
    ''' <remarks></remarks>
    Private Function SQLSelectOutkaL(ByVal ds As DataSet) As DataSet

        'DataSetのIN情報を取得
        Dim dr As DataRow = ds.Tables("LMC010IN_OUTKA_DENP_NO").Rows(0)

        'SQL格納変数の初期化
        Me._StrSql = New StringBuilder()

        'SQL作成
        Dim sql As String = Me.SetSchemaNm(LMC010DAC.SQL_OUTKA_L_CHK, dr.Item("NRS_BR_CD").ToString)
        Dim cmd As SqlCommand = Me.CreateSqlCommand(sql.ToString())

        'SQLパラメータ初期化
        Me._SqlPrmList = New ArrayList()

        'パラメータ設定
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@NRS_BR_CD", dr.Item("NRS_BR_CD").ToString(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@OUTKA_NO_L", dr.Item("OUTKA_NO_L").ToString(), DBDataType.CHAR))

        'パラメータの反映
        For Each obj As Object In Me._SqlPrmList
            cmd.Parameters.Add(obj)
        Next

        MyBase.Logger.WriteSQLLog(Me.GetType.Name, MethodBase.GetCurrentMethod.Name, cmd)

        'SQLの発行
        Dim reader As SqlDataReader = MyBase.GetSelectResult(cmd)

        '処理件数の設定
        reader.Read()
        MyBase.SetResultCount(Convert.ToInt32(reader("REC_CNT")))
        reader.Close()
        Return ds

    End Function
#End Region

    'END YANAI 要望番号773　報告書Excel対応

    ''' <summary>
    ''' パラメータ設定モジュール(出荷Lテーブル更新(運送会社変更時))
    ''' </summary>
    ''' <remarks></remarks>
    Private Sub SetParamUpdateIkkatuOutkaL()

        'SQLパラメータ初期化
        Me._SqlPrmList = New ArrayList()

        With Me._Row

            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@NRS_BR_CD", .Item("NRS_BR_CD"), DBDataType.NVARCHAR))
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@OUTKA_NO_L", .Item("OUTKA_NO_L"), DBDataType.CHAR))
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@HAITA_DATE", .Item("SYS_UPD_DATE").ToString(), DBDataType.CHAR))
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@HAITA_TIME", .Item("SYS_UPD_TIME").ToString(), DBDataType.CHAR))

        End With

        '更新時共通項目
        Call Me.SetParamCommonSystemUp()

    End Sub

    ''' <summary>
    ''' パラメータ設定モジュール(運送Lテーブル更新(運送会社変更時))
    ''' </summary>
    ''' <remarks></remarks>
    Private Sub SetParamUpdateIkkatuUnsoL()

        'SQLパラメータ初期化
        Me._SqlPrmList = New ArrayList()

        With Me._Row

            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@UNSOCO_CD", .Item("UNSOCO_CD"), DBDataType.CHAR))
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@UNSOCO_BR_CD", .Item("UNSOCO_BR_CD"), DBDataType.CHAR))
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@NRS_BR_CD", .Item("NRS_BR_CD"), DBDataType.NVARCHAR))
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@HAITA_DATE", .Item("UNSO_SYS_UPD_DATE").ToString(), DBDataType.CHAR))
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@HAITA_TIME", .Item("UNSO_SYS_UPD_TIME").ToString(), DBDataType.CHAR))
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@UNSO_NO_L", .Item("UNSO_NO_L"), DBDataType.CHAR))
            If Me._Row.Item("UPD_KB").ToString() = "1" Then
                '運送会社が未設定だった場合
                Me._SqlPrmList.Add(MyBase.GetSqlParameter("@PC_KB", .Item("PC_KB"), DBDataType.CHAR))
                Me._SqlPrmList.Add(MyBase.GetSqlParameter("@TARIFF_BUNRUI_KB", .Item("TARIFF_BUNRUI_KB"), DBDataType.CHAR))
                Me._SqlPrmList.Add(MyBase.GetSqlParameter("@TAX_KB", .Item("TAX_KB"), DBDataType.CHAR))
                Me._SqlPrmList.Add(MyBase.GetSqlParameter("@SEIQ_TARIFF_CD", .Item("SEIQ_TARIFF_CD"), DBDataType.NVARCHAR))
                Me._SqlPrmList.Add(MyBase.GetSqlParameter("@UNSO_TEHAI_KB", .Item("UNSO_TEHAI_KB"), DBDataType.CHAR))
            Else
                '要望番号1369:(支払-運送会社変更時、タリフを再取得し、再計算をおこなう⇒運行が紐付いている場合には、運行の運送会社変更時のみ動作) 2012/08/24 本明 Start
                Me._SqlPrmList.Add(MyBase.GetSqlParameter("@SHIHARAI_TARIFF_CD", .Item("SHIHARAI_TARIFF_CD"), DBDataType.CHAR))
                Me._SqlPrmList.Add(MyBase.GetSqlParameter("@SHIHARAI_ETARIFF_CD", .Item("SHIHARAI_ETARIFF_CD"), DBDataType.CHAR))
                '要望番号1369:(支払-運送会社変更時、タリフを再取得し、再計算をおこなう⇒運行が紐付いている場合には、運行の運送会社変更時のみ動作) 2012/08/24 本明 End  

                '要望番号:2408 2015.09.17 追加START
                Me._SqlPrmList.Add(MyBase.GetSqlParameter("@AUTO_DENP_KBN", .Item("AUTO_DENP_KBN").ToString(), DBDataType.NVARCHAR))
                Me._SqlPrmList.Add(MyBase.GetSqlParameter("@AUTO_DENP_NO", .Item("AUTO_DENP_NO").ToString(), DBDataType.NVARCHAR))
                '要望番号:2408 2015.09.17 追加END
            End If

        End With

        '更新時共通項目
        Call Me.SetParamCommonSystemUp()

    End Sub

#End Region

#Region "SBS再保管出荷実績取込"

    ''' <summary>
    ''' データ存在チェック
    ''' </summary>
    ''' <param name="ds"></param>
    ''' <returns></returns>
    Private Function SBSSaihokanOutkaImportChk(ByVal ds As DataSet) As DataSet

        'DataSetのIN情報を取得
        Dim dr As DataRow = ds.Tables("LMC010_SBS_SAIHOKAN_ROW").Rows(0)

        'SQL格納変数の初期化
        Me._StrSql = New StringBuilder()

        'SQL作成
        Dim sql As String = Me.SetSchemaNm(LMC010DAC.SQL_SELECT_SBS_SAIHOKAN_CHK, dr.Item("NRS_BR_CD").ToString)
        Dim cmd As SqlCommand = Me.CreateSqlCommand(sql.ToString())

        'SQLパラメータ初期化
        Me._SqlPrmList = New ArrayList()

        'パラメータ設定
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@NRS_BR_CD", dr.Item("NRS_BR_CD").ToString(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@OUTKA_NO_L", dr.Item("OUTKA_NO_L").ToString(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@UNSO_CD", dr.Item("UNSO_CD").ToString(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@UNSO_BR_CD", dr.Item("UNSO_BR_CD").ToString(), DBDataType.CHAR))

        'パラメータの反映
        For Each obj As Object In Me._SqlPrmList
            cmd.Parameters.Add(obj)
        Next

        MyBase.Logger.WriteSQLLog(Me.GetType.Name, MethodBase.GetCurrentMethod.Name, cmd)

        'SQLの発行
        Dim reader As SqlDataReader = MyBase.GetSelectResult(cmd)

        ds.Tables("LMC010_SBS_SAIHOKAN_ROW").Rows.Clear()

        'DataReader→DataTableへの転記
        Dim map As Hashtable = New Hashtable()

        '取得データの格納先をマッピング
        map.Add("CNT_OUTKA_L", "CNT_OUTKA_L")
        map.Add("CNT_UNSOCO", "CNT_UNSOCO")

        ds = MyBase.SetSelectResultToDataSet(map, ds, reader, "LMC010_SBS_SAIHOKAN_ROW")

        '処理件数の設定
        MyBase.SetResultCount(ds.Tables("LMC010_SBS_SAIHOKAN_ROW").Rows.Count())
        reader.Close()

        Return ds

    End Function

    ''' <summary>
    ''' 出荷L更新
    ''' </summary>
    ''' <param name="ds"></param>
    ''' <returns></returns>
    Private Function UpdateSBSSaihokanOutkaL(ByVal ds As DataSet) As DataSet

        'DataSetのIN情報を取得
        Me._Row = ds.Tables("LMC010_SBS_SAIHOKAN_ROW").Rows(0)

        'パラメータ設定
        Me._SqlPrmList = New ArrayList()

        'スキーマ名設定
        Dim sql As String = Me.SetSchemaNm(LMC010DAC.SQL_UPDATE_SBS_SAIHOKAN_OUTKA_L, Me._Row.Item("NRS_BR_CD").ToString())

        Call Me.SetParamCommonSystemUp()
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@NRS_BR_CD", Me._Row("NRS_BR_CD").ToString(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@OUTKA_NO_L", Me._Row("OUTKA_NO_L").ToString(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@DENP_NO", Me._Row("DENP_NO").ToString(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@OUTKA_PKG_NB", Me._Row("OUTKA_PKG_NB").ToString(), DBDataType.NUMERIC))

        'SQL文のコンパイル
        Dim cmd As SqlCommand = MyBase.CreateSqlCommand(sql)

        'パラメータの反映
        For Each obj As Object In Me._SqlPrmList
            cmd.Parameters.Add(obj)
        Next

        MyBase.Logger.WriteSQLLog("LMC010DAC", "UpdateSBSSaihokanOutkaL", cmd)

        'SQLの発行
        Dim rtn As Integer = Me.GetUpdateResult(cmd)

        Return ds

    End Function

    ''' <summary>
    ''' 運送L更新
    ''' </summary>
    ''' <param name="ds"></param>
    ''' <returns></returns>
    Private Function UpdateSBSSaihokanUnsoL(ByVal ds As DataSet) As DataSet

        'DataSetのIN情報を取得
        Me._Row = ds.Tables("LMC010_SBS_SAIHOKAN_ROW").Rows(0)

        'パラメータ設定
        Me._SqlPrmList = New ArrayList()

        'スキーマ名設定
        Dim sql As String = Me.SetSchemaNm(LMC010DAC.SQL_UPDATE_SBS_SAIHOKAN_UNSO_L, Me._Row.Item("NRS_BR_CD").ToString())

        Call Me.SetParamCommonSystemUp()
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@NRS_BR_CD", Me._Row("NRS_BR_CD").ToString(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@OUTKA_NO_L", Me._Row("OUTKA_NO_L").ToString(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@UNSO_CD", Me._Row("UNSO_CD").ToString(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@UNSO_BR_CD", Me._Row("UNSO_BR_CD").ToString(), DBDataType.CHAR))

        'SQL文のコンパイル
        Dim cmd As SqlCommand = MyBase.CreateSqlCommand(sql)

        'パラメータの反映
        For Each obj As Object In Me._SqlPrmList
            cmd.Parameters.Add(obj)
        Next

        MyBase.Logger.WriteSQLLog("LMC010DAC", "UpdateSBSSaihokanUnsoL", cmd)

        'SQLの発行
        Dim rtn As Integer = Me.GetUpdateResult(cmd)

        Return ds

    End Function

#End Region

#Region "一括引当処理"

#Region "出荷データ登録"

    ''' <summary>
    ''' 出荷データ（大）更新
    ''' </summary>
    ''' <param name="ds">DataSet</param>
    ''' <returns>DataSet</returns>
    ''' <remarks>出荷データ（大）新規登録SQLの構築・発行</remarks>
    Private Function UpdateOutKaL(ByVal ds As DataSet) As DataSet

        'DataSetのIN情報を取得
        Dim inTbl As DataTable = ds.Tables("LMC010_OUTKA_M_IN")
        'START YANAI 20110914 一括引当対応
        Dim outLdt As DataTable = ds.Tables("LMC010_OUTKA_L_IN")
        'END YANAI 20110914 一括引当対応
        'タブレット項目用データテーブル
        Dim tabTbl As DataTable = ds.Tables("LMC010_TABLET_IN")

        'INTableの条件rowの格納
        Me._Row = inTbl.Rows(0)

        'SQL文のコンパイル
        Dim cmd As SqlCommand = MyBase.CreateSqlCommand(Me.SetSchemaNm _
                                                        (LMC010DAC.SQL_OUTKAL_UPDATE, Me._Row.Item("NRS_BR_CD").ToString()))
        '新規登録処理件数設定用
        Dim insCnt As Integer = 0

        'SQLパラメータ初期化
        Me._SqlPrmList = New ArrayList()

        'SQLパラメータ（システム項目）設定
        Call Me.SetParamCommonSystemUp()
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@NRS_BR_CD", Me._Row.Item("NRS_BR_CD").ToString(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@OUTKA_NO_L", Me._Row.Item("OUTKA_NO_L").ToString(), DBDataType.NVARCHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@GUI_UPD_DATE", Me._Row.Item("SYS_UPD_DATE").ToString(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@GUI_UPD_TIME", Me._Row.Item("SYS_UPD_TIME").ToString(), DBDataType.CHAR))
        'START YANAI 20110914 一括引当対応
        Dim outLdr() As DataRow = outLdt.Select(String.Concat("OUTKA_NO_L = '", Me._Row.Item("OUTKA_NO_L").ToString(), "'"))
        If 0 < outLdr.Length Then
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@OUTKA_STATE_KB", outLdr(0).Item("OUTKA_STATE_KB").ToString(), DBDataType.CHAR))
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@OUTKA_PKG_NB", outLdr(0).Item("OUTKA_PKG_NB").ToString(), DBDataType.NUMERIC))
        End If
        'END YANAI 20110914 一括引当対応
        'タブレット項目
        Dim tabdr() As DataRow = tabTbl.Select(String.Concat("OUTKA_NO_L = '", Me._Row.Item("OUTKA_NO_L").ToString(), "'"))
        If 0 < tabdr.Length Then
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@WH_TAB_STATUS", tabdr(0).Item("WH_TAB_STATUS").ToString(), DBDataType.CHAR))
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@WH_TAB_YN", tabdr(0).Item("WH_TAB_YN").ToString(), DBDataType.CHAR))
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@URGENT_YN", tabdr(0).Item("URGENT_YN").ToString(), DBDataType.CHAR))
        End If


        'パラメータの反映
        For Each obj As Object In Me._SqlPrmList
            cmd.Parameters.Add(obj)
        Next

        MyBase.Logger.WriteSQLLog("LMC010DAC", "UpdateOutKaL", cmd)

        MyBase.Logger.WriteLog(0, "LMC010DAC", "UpdateOutKaL", "一括引当 出荷データ（大）更新START")
        'START YANAI 要望番号1474 一括引当時、引当が出来ない場合のエラーメッセージ変更
        ''SQLの発行
        'Me.UpdateResultChk(cmd, True)
        'SQLの発行
        Me.UpdateResultChk(cmd, True, ds, "01")
        'END YANAI 要望番号1474 一括引当時、引当が出来ない場合のエラーメッセージ変更
        MyBase.Logger.WriteLog(0, "LMC010DAC", "UpdateOutKaL", "一括引当 出荷データ（大）更新END")

        Return ds

    End Function

    '2017.09.19 届先追加対応 Annen add start
    ''' <summary>
    ''' 届先実行処理字の出荷データ（大）更新
    ''' </summary>
    ''' <param name="ds">INのデータセット</param>
    ''' <returns></returns>
    ''' <remarks></remarks>
    Private Function UpdateOutkaDestKbn(ByVal ds As DataSet) As DataSet
        Dim dt As DataTable = ds.Tables("LMC010_OUTKA_M_IN")
        Dim dr As DataRow = dt.Rows(0)
        Dim sysUpdDate As String = String.Empty
        Dim sysUpdTime As String = String.Empty

        Me._SqlPrmList = New ArrayList()

        'SQL文のコンパイル
        Dim cmd As SqlCommand = MyBase.CreateSqlCommand(Me.SetSchemaNm _
                                                        (LMC010DAC.SQL_DEST_OUTKAL_UPDATE, dr.Item("NRS_BR_CD").ToString()))

        Call SetParamCommonSystemUp()

        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@NRS_BR_CD", dr.Item("NRS_BR_CD").ToString(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@OUTKA_NO_L", dr.Item("OUTKA_NO_L").ToString(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@GUI_UPD_DATE", dr.Item("SYS_UPD_DATE").ToString(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@GUI_UPD_TIME", dr.Item("SYS_UPD_TIME").ToString(), DBDataType.CHAR))

        'パラメータの反映
        For Each obj As Object In Me._SqlPrmList
            cmd.Parameters.Add(obj)
        Next

        MyBase.Logger.WriteSQLLog("LMC010DAC", "UpdateOutkaDestKbn", cmd)

        MyBase.Logger.WriteLog(0, "LMC010DAC", "UpdateOutkaDestKbn", "届先 出荷データ（大）更新START")

        'SQLの発行(Me.UpdateResultChkを呼ぶとメッセージと蓄積用メッセージの両方が使用できないので
        'ここでは自前のロジックで使用する。蓄積用メッセージはEXCELに出力し、メッセージはCommitの判定用に使用する。)
        If MyBase.GetUpdateResult(cmd) < 1 Then
            MyBase.SetMessage("E011")
            MyBase.SetMessageStore("00", "E011", , dr.Item("ROW_NO").ToString())
        End If

        MyBase.Logger.WriteLog(0, "LMC010DAC", "UpdateOutkaDestKbn", "届先 出荷データ（大）更新END")

        Return ds

    End Function

    ''' <summary>
    ''' 出荷データ（中）更新
    ''' </summary>
    ''' <param name="ds">DataSet</param>
    ''' <returns>DataSet</returns>
    ''' <remarks>出荷データ（中）新規登録SQLの構築・発行</remarks>
    Private Function UpdateOutKaM(ByVal ds As DataSet) As DataSet

        Dim dr As DataRow = ds.Tables("LMC010_OUTKA_M_IN").Rows(0)

        'DataSetのIN情報を取得
        Dim inTbl As DataTable = ds.Tables("LMC010OUT_OUTKA_M")

        'SQL文のコンパイル
        Dim cmd As SqlCommand = MyBase.CreateSqlCommand(Me.SetSchemaNm _
                                                        (LMC010DAC.SQL_OUTKAM_UPDATE, dr.Item("NRS_BR_CD").ToString()))

        '更新情報の取得
        Dim drs As DataRow() = inTbl.Select(String.Concat("OUTKA_NO_L = '", dr.Item("OUTKA_NO_L").ToString(), "' "))
        Dim max As Integer = drs.Length - 1
        For i As Integer = 0 To max

            'INTableの条件rowの格納
            Me._Row = drs(i)

            'パラメータの初期化
            cmd.Parameters.Clear()

            'SQLパラメータ（共通項目）設定
            Call Me.SetOutkaMComParameter()

            'SQLパラメータ（システム項目）設定
            Call Me.SetParamCommonSystemUp()

            'パラメータの反映
            For Each obj As Object In Me._SqlPrmList
                cmd.Parameters.Add(obj)
            Next

            MyBase.Logger.WriteSQLLog("LMC010DAC", "UpdateOutKaM", cmd)

            '更新出来なかった場合エラーメッセージをセットして終了
            If MyBase.GetUpdateResult(cmd) < 1 Then
                MyBase.SetMessage("S001")
            End If

        Next

        Return ds

    End Function

    ''' <summary>
    ''' 出荷データ（小）新規登録
    ''' </summary>
    ''' <param name="ds">DataSet</param>
    ''' <returns>DataSet</returns>
    ''' <remarks>出荷データ（小）新規登録SQLの構築・発行</remarks>
    Private Function InsertOutKaS(ByVal ds As DataSet) As DataSet

        Dim dr As DataRow = ds.Tables("LMC010_OUTKA_M_IN").Rows(0)

        'DataSetのIN情報を取得
        Dim inTbl As DataTable = ds.Tables("LMC010OUT_OUTKA_S")

        '更新情報の取得
        Dim drs As DataRow() = inTbl.Select(String.Concat("OUTKA_NO_L = '", dr.Item("OUTKA_NO_L").ToString(), "' "))

        'SQL文のコンパイル
        Dim cmd As SqlCommand = MyBase.CreateSqlCommand(Me.SetSchemaNm _
                                                        (LMC010DAC.SQL_OUTLA_S_INSERT, dr.Item("NRS_BR_CD").ToString()))

        Dim max As Integer = drs.Length - 1
        For i As Integer = 0 To max

            'パラメータの初期化
            cmd.Parameters.Clear()

            'INTableの条件rowの格納
            Me._Row = drs(i)

            'SQLパラメータ（共通項目）設定
            Call Me.SetOutkaSComParameter()

            'SQLパラメータ（システム項目）設定
            Call Me.SetParamCommonSystemIns()

            'パラメータの反映
            For Each obj As Object In Me._SqlPrmList
                cmd.Parameters.Add(obj)
            Next

            MyBase.Logger.WriteSQLLog("LMC010DAC", "InsertOutKaS", cmd)

            MyBase.SetResultCount(MyBase.GetInsertResult(cmd))

        Next

        Return ds

    End Function

    ''' <summary>
    ''' 在庫データ更新
    ''' </summary>
    ''' <param name="ds">DataSet</param>
    ''' <returns>DataSet</returns>
    ''' <remarks>在庫データ（振替元）更新SQLの構築・発行</remarks>
    Private Function UpdateZaiTrs(ByVal ds As DataSet) As DataSet

        Dim dr As DataRow = ds.Tables("LMC010_OUTKA_M_IN").Rows(0)

        'DataSetのIN情報を取得
        Dim inTbl As DataTable = ds.Tables("LMC010OUT_ZAI")

        'SQL文のコンパイル
        Dim cmd As SqlCommand = MyBase.CreateSqlCommand(Me.SetSchemaNm _
                                                        (LMC010DAC.SQL_ZAITRS_UPDATE, dr.Item("NRS_BR_CD").ToString()))
        Dim outDr As DataRow() = Nothing
        Dim outDrMax As Integer = 0
        Dim sysUpdDate As String = String.Empty
        Dim sysUpdTime As String = String.Empty

        Dim max As Integer = inTbl.Rows.Count - 1
        For i As Integer = 0 To max

            Me._Row = inTbl.Rows(i)

            'パラメータの初期化
            cmd.Parameters.Clear()

            'SQLパラメータ（共通項目）設定
            Call Me.SetZaiTrsComUpdateParameter()

            'SQLパラメータ（システム項目）設定
            'Call Me.SetParamCommonSystemUp()
            sysUpdDate = MyBase.GetSystemDate()
            sysUpdTime = MyBase.GetSystemTime()
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@SYS_UPD_PGID", MyBase.GetPGID(), DBDataType.CHAR))
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@SYS_UPD_USER", MyBase.GetUserID(), DBDataType.NVARCHAR))
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@SYS_UPD_DATE", sysUpdDate, DBDataType.CHAR))
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@SYS_UPD_TIME", sysUpdTime, DBDataType.CHAR))
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@GUI_UPD_DATE", Me._Row.Item("SYS_UPD_DATE").ToString(), DBDataType.CHAR))
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@GUI_UPD_TIME", Me._Row.Item("SYS_UPD_TIME").ToString(), DBDataType.CHAR))

            'パラメータの反映
            For Each obj As Object In Me._SqlPrmList
                cmd.Parameters.Add(obj)
            Next

            MyBase.Logger.WriteSQLLog("LMC010DAC", "UpdateZaiTrs", cmd)

            'SQLの発行
            MyBase.Logger.WriteLog(0, "LMC010DAC", "UpdateZaiTrs", "一括引当 在庫データ更新START")
            'START YANAI 要望番号1474 一括引当時、引当が出来ない場合のエラーメッセージ変更
            'If Me.UpdateResultChk(cmd, True) = False Then
            '    MyBase.Logger.WriteLog(0, "LMC010DAC", "UpdateZaiTrs", "一括引当 在庫データ更新END")
            '    Return ds
            'End If
            If Me.UpdateResultChk(cmd, True, ds, "01") = False Then
                MyBase.Logger.WriteLog(0, "LMC010DAC", "UpdateZaiTrs", "一括引当 在庫データ更新END")
                Return ds
            End If
            'END YANAI 要望番号1474 一括引当時、引当が出来ない場合のエラーメッセージ変更


            '一括引当の中に同じ在庫レコードを更新するデータがある場合、排他エラーになってしまうので、
            'このタイミングで、更新日付、時間を置き換え、排他エラーにならないようにする。
            outDr = ds.Tables("LMC010OUT_ZAI").Select(String.Concat("ZAI_REC_NO = '", Me._Row.Item("ZAI_REC_NO").ToString(), "'"))
            outDrMax = outDr.Length - 1
            For j As Integer = 0 To outDrMax
                outDr(j).Item("SYS_UPD_DATE") = sysUpdDate
                outDr(j).Item("SYS_UPD_TIME") = sysUpdTime
            Next
        Next

        Return ds

    End Function

    'START YANAI 要望番号585
    ''' <summary>
    ''' 運送データ（大）更新
    ''' </summary>
    ''' <param name="ds">DataSet</param>
    ''' <returns>DataSet</returns>
    ''' <remarks>運送データ（大）新規登録SQLの構築・発行</remarks>
    Private Function UpdateUnsoL(ByVal ds As DataSet) As DataSet

        Dim BpUnsoWt As Decimal = 0

        'DataSetのIN情報を取得
        Dim dr As DataRow = ds.Tables("LMC010_OUTKA_M_IN").Rows(0)

        'DataSetのIN情報を取得
        Dim inTbl As DataTable = ds.Tables("LMC010OUT_UNSO_L")

        '更新情報の取得
        Dim drs As DataRow() = inTbl.Select(String.Concat("OUTKA_NO_L = '", dr.Item("OUTKA_NO_L").ToString(), "' "))

        'SQL文のコンパイル
        Dim cmd As SqlCommand = MyBase.CreateSqlCommand(Me.SetSchemaNm _
                                                        (LMC010DAC.SQL_UNSOL_UPDATE, Me._Row.Item("NRS_BR_CD").ToString()))
        'SQLパラメータ初期化
        Me._SqlPrmList = New ArrayList()

        '2013.07.04 追加START
        BpUnsoWt = Me.SetBpUnsoWt(ds)
        If BpUnsoWt = 0 Then
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@UNSO_WT", drs(0).Item("UNSO_WT").ToString(), DBDataType.NVARCHAR))
        Else
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@UNSO_WT", BpUnsoWt, DBDataType.NVARCHAR))
        End If
        '2013.07.04 追加END

#If True Then ' 西濃自動送り状番号対応 20160701 added inoue
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@AUTO_DENP_KBN", drs(0).Item("AUTO_DENP_KBN").ToString(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@AUTO_DENP_NO", drs(0).Item("AUTO_DENP_NO").ToString(), DBDataType.CHAR))
#End If

        'SQLパラメータ（システム項目）設定
        Call Me.SetParamCommonSystemUp()
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@NRS_BR_CD", Me._Row.Item("NRS_BR_CD").ToString(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@UNSO_NO_L", drs(0).Item("UNSO_NO_L").ToString(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@UNSO_UPD_DATE", drs(0).Item("SYS_UPD_DATE").ToString(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@UNSO_UPD_TIME", drs(0).Item("SYS_UPD_TIME").ToString(), DBDataType.CHAR))
        'START YANAI 要望番号638
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@UNSO_PKG_NB", Me.FormatNumValue(drs(0).Item("OUTKA_PKG_NB").ToString()), DBDataType.NUMERIC))
        'END YANAI 要望番号638

        'パラメータの反映
        For Each obj As Object In Me._SqlPrmList
            cmd.Parameters.Add(obj)
        Next

        MyBase.Logger.WriteSQLLog("LMC010DAC", "UpdateUnsoL", cmd)

        'SQLの発行
        MyBase.Logger.WriteLog(0, "LMC010DAC", "UpdateUnsoL", "一括引当 運送データ（大）更新START")
        'START YANAI 要望番号1474 一括引当時、引当が出来ない場合のエラーメッセージ変更
        ''SQLの発行
        'Me.UpdateResultChk(cmd, True)
        'SQLの発行
        Me.UpdateResultChk(cmd, True, ds, "01")
        'END YANAI 要望番号1474 一括引当時、引当が出来ない場合のエラーメッセージ変更
        MyBase.Logger.WriteLog(0, "LMC010DAC", "UpdateUnsoL", "一括引当 運送データ（大）更新END")

        Return ds

    End Function
    'END YANAI 要望番号585

    '2013.07.04 追加START
    ''' <summary>
    ''' BP運送重量再計算
    ''' </summary>
    ''' <param name="ds">DataSet</param>
    ''' <returns>DataSet</returns>
    ''' <remarks>BP受信TBL(DTL)SQLの構築・発行</remarks>
    Private Function SetBpUnsoWt(ByVal ds As DataSet) As Decimal

        '2013.07.04 追加START
        Dim BpUnsoWt As Decimal = 0
        '2013.07.04 追加END

        'DataSetのIN情報を取得
        Dim dr As DataRow = ds.Tables("LMC010_OUTKA_M_IN").Rows(0)

        'DataSetのIN情報を取得
        Dim inTbl As DataTable = ds.Tables("LMC010OUT_UNSO_L")

        '更新情報の取得
        Dim drs As DataRow() = inTbl.Select(String.Concat("OUTKA_NO_L = '", dr.Item("OUTKA_NO_L").ToString(), "' "))

        'SQL文のコンパイル
        Dim cmd As SqlCommand = MyBase.CreateSqlCommand(Me.SetSchemaNm _
                                                        (LMC010DAC.SQL_GET_BP_EDI_OUT, Me._Row.Item("NRS_BR_CD").ToString()))
        'SQLパラメータ初期化
        Me._SqlPrmList = New ArrayList()

        'SQLパラメータ（システム項目）設定
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@NRS_BR_CD", Me._Row.Item("NRS_BR_CD").ToString(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@UNSO_NO_L", drs(0).Item("UNSO_NO_L").ToString(), DBDataType.CHAR))

        'パラメータの反映
        For Each obj As Object In Me._SqlPrmList
            cmd.Parameters.Add(obj)
        Next

        MyBase.Logger.WriteSQLLog("LMC010DAC", "SetBpUnsoWt", cmd)

        'SQLの発行
        Dim reader As SqlDataReader = MyBase.GetSelectResult(cmd)

        If reader.Read() = True Then
            BpUnsoWt = Convert.ToDecimal(reader("BP_UNSO_WT"))
            reader.Close()
            'SQLパラメータ初期化
            Me._SqlPrmList = New ArrayList()
            Return BpUnsoWt
        End If

        reader.Close()
        'SQLパラメータ初期化
        Me._SqlPrmList = New ArrayList()

        Return 0

    End Function
    '2013.07.04 追加END

    'START YANAI 要望番号638
    ''' <summary>
    ''' 運賃テーブルの物理削除処理
    ''' </summary>
    ''' <param name="ds">DataSet</param>
    ''' <returns>DataSet</returns>
    ''' <remarks>運賃テーブル更新SQLの構築・発行</remarks>
    Private Function DeleteUnchinData(ByVal ds As DataSet) As DataSet

        'DataSetのIN情報を取得
        Dim dr As DataRow = ds.Tables("LMC010_OUTKA_M_IN").Rows(0)

        'DataSetのIN情報を取得
        Dim inTbl As DataTable = ds.Tables("LMC010OUT_UNCHIN")

        '更新情報の取得
        Dim drs As DataRow() = inTbl.Select(String.Concat("OUTKA_NO_L = '", dr.Item("OUTKA_NO_L").ToString(), "' "))

        'SQL文のコンパイル
        Dim cmd As SqlCommand = MyBase.CreateSqlCommand(Me.SetSchemaNm _
                                                        (LMC010DAC.SQL_DELETE_UNCHIN, Me._Row.Item("NRS_BR_CD").ToString()))

        'SQLパラメータ初期化
        Me._SqlPrmList = New ArrayList()

        'パラメータ設定
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@NRS_BR_CD", Me._Row.Item("NRS_BR_CD").ToString(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@UNSO_NO_L", drs(0).Item("UNSO_NO_L").ToString(), DBDataType.CHAR))

        'パラメータの反映
        For Each obj As Object In Me._SqlPrmList
            cmd.Parameters.Add(obj)
        Next

        MyBase.Logger.WriteSQLLog("LMC010DAC", "DeleteUnchinData", cmd)

        'SQLの発行
        MyBase.GetUpdateResult(cmd)

        Return ds

    End Function

    ''' <summary>
    ''' 運賃データ作成
    ''' </summary>
    ''' <param name="ds">DataSet</param>
    ''' <returns>DataSet</returns>
    ''' <remarks>運賃データ新規登録SQLの構築・発行</remarks>
    Private Function InsertUnchinData(ByVal ds As DataSet) As DataSet

        If ds.Tables("F_UNCHIN_TRS").Rows.Count = 0 Then
            'F_UNCHIN_TRSが0件ということは本来無いが、一応念のために0件の時はINSERT処理が行われないようにする
            Return ds
        End If

        'DataSetのIN情報を取得
        Dim inTbl As DataTable = ds.Tables("F_UNCHIN_TRS")

        'SQL文のコンパイル
        Dim cmd As SqlCommand = MyBase.CreateSqlCommand(Me.SetSchemaNm(LMC010DAC.SQL_UNCHIN_INSERT _
                                                                       , ds.Tables("F_UNCHIN_TRS").Rows(0).Item("NRS_BR_CD").ToString()))

        Dim max As Integer = inTbl.Rows.Count - 1
        For i As Integer = 0 To max

            'SQLパラメータ初期化
            Me._SqlPrmList = New ArrayList()

            'INTableの条件rowの格納
            Me._Row = inTbl.Rows(i)

            'パラメータ設定
            Call SetParamCommonSystemIns()
            Call Me.SetUnchinComParameter(Me._Row, Me._SqlPrmList)

            'パラメータの反映
            For Each obj As Object In Me._SqlPrmList
                cmd.Parameters.Add(obj)
            Next

            MyBase.Logger.WriteSQLLog("LMC010DAC", "InsertUnchinData", cmd)

            'SQLの発行
            MyBase.GetInsertResult(cmd)

            'パラメータの初期化
            cmd.Parameters.Clear()

        Next

        Return ds

    End Function
    'END YANAI 要望番号638

    'START YANAI 要望番号1302 支払運賃に伴う修正。バッチ呼び出し、画面項目追加等
    ''' <summary>
    ''' 支払運賃テーブルの物理削除処理
    ''' </summary>
    ''' <param name="ds">DataSet</param>
    ''' <returns>DataSet</returns>
    ''' <remarks>支払運賃テーブル更新SQLの構築・発行</remarks>
    Private Function DeleteShiharaiData(ByVal ds As DataSet) As DataSet

        'DataSetのIN情報を取得
        Dim dr As DataRow = ds.Tables("LMC010_OUTKA_M_IN").Rows(0)

        'DataSetのIN情報を取得
        Dim inTbl As DataTable = ds.Tables("LMC010OUT_SHIHARAI")

        '更新情報の取得
        Dim drs As DataRow() = inTbl.Select(String.Concat("OUTKA_NO_L = '", dr.Item("OUTKA_NO_L").ToString(), "' "))

        'SQL文のコンパイル
        Dim cmd As SqlCommand = MyBase.CreateSqlCommand(Me.SetSchemaNm _
                                                        (LMC010DAC.SQL_DELETE_SHIHARAI, Me._Row.Item("NRS_BR_CD").ToString()))

        'SQLパラメータ初期化
        Me._SqlPrmList = New ArrayList()

        'パラメータ設定
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@NRS_BR_CD", Me._Row.Item("NRS_BR_CD").ToString(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@UNSO_NO_L", drs(0).Item("UNSO_NO_L").ToString(), DBDataType.CHAR))

        'パラメータの反映
        For Each obj As Object In Me._SqlPrmList
            cmd.Parameters.Add(obj)
        Next

        MyBase.Logger.WriteSQLLog("LMC010DAC", "DeleteShiharaiData", cmd)

        'SQLの発行
        MyBase.GetUpdateResult(cmd)

        Return ds

    End Function

    ''' <summary>
    ''' 支払運賃データ作成
    ''' </summary>
    ''' <param name="ds">DataSet</param>
    ''' <returns>DataSet</returns>
    ''' <remarks>支払運賃データ新規登録SQLの構築・発行</remarks>
    Private Function InsertShiharaiData(ByVal ds As DataSet) As DataSet

        If ds.Tables("F_SHIHARAI_TRS").Rows.Count = 0 Then
            'F_SHIHARAI_TRSが0件ということは本来無いが、一応念のために0件の時はINSERT処理が行われないようにする
            Return ds
        End If

        'DataSetのIN情報を取得
        Dim inTbl As DataTable = ds.Tables("F_SHIHARAI_TRS")

        'SQL文のコンパイル
        Dim cmd As SqlCommand = MyBase.CreateSqlCommand(Me.SetSchemaNm(LMC010DAC.SQL_SHIHARAI_INSERT _
                                                                       , ds.Tables("F_SHIHARAI_TRS").Rows(0).Item("NRS_BR_CD").ToString()))

        Dim max As Integer = inTbl.Rows.Count - 1
        For i As Integer = 0 To max

            'SQLパラメータ初期化
            Me._SqlPrmList = New ArrayList()

            'INTableの条件rowの格納
            Me._Row = inTbl.Rows(i)

            'パラメータ設定
            Call SetParamCommonSystemIns()
            Call Me.SetShiharaiComParameter(Me._Row, Me._SqlPrmList)

            'パラメータの反映
            For Each obj As Object In Me._SqlPrmList
                cmd.Parameters.Add(obj)
            Next

            MyBase.Logger.WriteSQLLog("LMC010DAC", "InsertShiharaiData", cmd)

            'SQLの発行
            MyBase.GetInsertResult(cmd)

            'パラメータの初期化
            cmd.Parameters.Clear()

        Next

        Return ds

    End Function
    'END YANAI 要望番号1302 支払運賃に伴う修正。バッチ呼び出し、画面項目追加等

    '要望番号1369:(支払-運送会社変更時、タリフを再取得し、再計算をおこなう⇒運行が紐付いている場合には、運行の運送会社変更時のみ動作) 2012/08/24 本明 Start
    ''' <summary>
    ''' 支払運賃テーブルの物理削除処理
    ''' </summary>
    ''' <param name="ds">DataSet</param>
    ''' <returns>DataSet</returns>
    ''' <remarks>支払運賃テーブル更新SQLの構築・発行</remarks>
    Private Function DeleteShiharaiData2(ByVal ds As DataSet) As DataSet

        'DataSetのIN情報を取得
        Dim dr As DataRow = ds.Tables("LMC010IN_UPDATE").Rows(0)

        'DataSetのIN情報を取得
        Dim inTbl As DataTable = ds.Tables("LMC010OUT_SHIHARAI")

        '更新情報の取得
        'Dim drs As DataRow() = inTbl.Select(String.Concat("OUTKA_NO_L = '", dr.Item("OUTKA_NO_L").ToString(), "' "))

        'SQL文のコンパイル
        Dim cmd As SqlCommand = MyBase.CreateSqlCommand(Me.SetSchemaNm _
                                                        (LMC010DAC.SQL_DELETE_SHIHARAI, dr.Item("NRS_BR_CD").ToString()))

        'SQLパラメータ初期化
        Me._SqlPrmList = New ArrayList()

        'パラメータ設定
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@NRS_BR_CD", dr.Item("NRS_BR_CD").ToString(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@UNSO_NO_L", dr.Item("UNSO_NO_L").ToString(), DBDataType.CHAR))

        'パラメータの反映
        For Each obj As Object In Me._SqlPrmList
            cmd.Parameters.Add(obj)
        Next

        MyBase.Logger.WriteSQLLog("LMC010DAC", "DeleteShiharaiData2", cmd)

        'SQLの発行
        MyBase.GetUpdateResult(cmd)

        Return ds

    End Function
    '要望番号1369:(支払-運送会社変更時、タリフを再取得し、再計算をおこなう⇒運行が紐付いている場合には、運行の運送会社変更時のみ動作) 2012/08/24 本明 End  

#End Region

#End Region

#Region "特別梱包個数計算"

    'START YANAI 20120322 特別梱包個数計算
    ''' <summary>
    ''' 特別梱包個数計算の対象データ取得
    ''' </summary>
    ''' <param name="ds">DataSet</param>
    ''' <returns>DataSet</returns>
    ''' <remarks>特別梱包個数計算の対象データ取得</remarks>
    Private Function SelectOutkaPkgNb(ByVal ds As DataSet) As DataSet

        'DataSetのIN情報を取得
        Dim inTbl As DataTable = ds.Tables("LMC010_OUTKA_M_IN")

        'INTableの条件rowの格納
        Me._Row = inTbl.Rows(0)

        'SQL格納変数の初期化
        Me._StrSql = New StringBuilder()

        'SQLパラメータ初期化
        Me._SqlPrmList = New ArrayList()

        'SQL作成
        Me._StrSql.Append(LMC010DAC.SQL_SELECT_OUTKAPKGNB)       'SQL構築(データ抽出用Select句)
        Me._StrSql.Append(LMC010DAC.SQL_SELECT_FROM_OUTKAPKGNB)  'SQL構築(データ抽出用From句)
        Me._StrSql.Append(LMC010DAC.SQL_SELECT_WHERE_OUTKAPKGNB) 'SQL構築(データ抽出用From句)

        'パラメータ設定
        Call Me.SetSelectOutkaPkgNb()

        'スキーマ名設定
        Dim sql As String = Me.SetSchemaNm(Me._StrSql.ToString(), Me._Row.Item("NRS_BR_CD").ToString())

        'SQL文のコンパイル
        Dim cmd As SqlCommand = MyBase.CreateSqlCommand(sql)

        'パラメータの反映
        For Each obj As Object In Me._SqlPrmList
            cmd.Parameters.Add(obj)
        Next

        MyBase.Logger.WriteSQLLog("LMC010DAC", "SelectOutkaPkgNb", cmd)

        'SQLの発行
        Dim reader As SqlDataReader = MyBase.GetSelectResult(cmd)

        'DataReader→DataTableへの転記
        Dim map As Hashtable = New Hashtable()

        '取得データの格納先をマッピング
        map.Add("NRS_BR_CD", "NRS_BR_CD")
        map.Add("OUTKA_NO_L", "OUTKA_NO_L")
        map.Add("OUTKA_NO_M", "OUTKA_NO_M")
        map.Add("GOODS_CD_NRS", "GOODS_CD_NRS")
        map.Add("OUTKA_TTL_NB", "OUTKA_TTL_NB")
        map.Add("OUTKA_HASU", "OUTKA_HASU")
        map.Add("PKG_NB", "PKG_NB")

        ds = MyBase.SetSelectResultToDataSet(map, ds, reader, "LMC010OUT")

        '処理件数の設定
        MyBase.SetResultCount(ds.Tables("LMC010OUT").Rows.Count())
        reader.Close()

        Return ds

    End Function

    ''' <summary>
    ''' 出荷データ（大）更新
    ''' </summary>
    ''' <param name="ds">DataSet</param>
    ''' <returns>DataSet</returns>
    ''' <remarks>出荷データ（大）更新SQLの構築・発行</remarks>
    Private Function UpdateOutkaPkgNbOUTKAL(ByVal ds As DataSet) As DataSet

        'DataSetのIN情報を取得
        Dim inTbl As DataTable = ds.Tables("LMC010_OUTKA_M_IN")

        'INTableの条件rowの格納
        Me._Row = inTbl.Rows(0)

        'SQL文のコンパイル
        Dim cmd As SqlCommand = MyBase.CreateSqlCommand(Me.SetSchemaNm _
                                                        (LMC010DAC.SQL_UPDATE_OUTKAL_OUTKAPKGNB, Me._Row.Item("NRS_BR_CD").ToString()))
        '新規登録処理件数設定用
        Dim insCnt As Integer = 0

        'SQLパラメータ初期化
        Me._SqlPrmList = New ArrayList()

        'SQLパラメータ（システム項目）設定
        Call Me.SetUpdateOutkaPkgNb()
        Call Me.SetParamCommonSystemUp()

        'パラメータの反映
        For Each obj As Object In Me._SqlPrmList
            cmd.Parameters.Add(obj)
        Next

        MyBase.Logger.WriteSQLLog("LMC010DAC", "UpdateOutkaPkgNbOUTKAL", cmd)

        'SQLの発行
        MyBase.Logger.WriteLog(0, "LMC010DAC", "UpdateOutkaPkgNbOUTKAL", "特別梱包個数計算 出荷データ（大）更新START")
        Me.UpdateResultChk(cmd, True)
        MyBase.Logger.WriteLog(0, "LMC010DAC", "UpdateOutkaPkgNbOUTKAL", "特別梱包個数計算 出荷データ（大）更新END")
        Return ds

    End Function

    ''' <summary>
    ''' 運送データ（大）更新
    ''' </summary>
    ''' <param name="ds">DataSet</param>
    ''' <returns>DataSet</returns>
    ''' <remarks>運送データ（大）更新SQLの構築・発行</remarks>
    Private Function UpdateOutkaPkgNbUNSOL(ByVal ds As DataSet) As DataSet

        'DataSetのIN情報を取得
        Dim inTbl As DataTable = ds.Tables("LMC010_OUTKA_M_IN")

        'INTableの条件rowの格納
        Me._Row = inTbl.Rows(0)

        'SQL文のコンパイル
        Dim cmd As SqlCommand = MyBase.CreateSqlCommand(Me.SetSchemaNm _
                                                        (LMC010DAC.SQL_UPDATE_UNSOL_OUTKAPKGNB, Me._Row.Item("NRS_BR_CD").ToString()))
        '新規登録処理件数設定用
        Dim insCnt As Integer = 0

        'SQLパラメータ初期化
        Me._SqlPrmList = New ArrayList()

        'SQLパラメータ（システム項目）設定
        Call Me.SetUpdateOutkaPkgNb()
        Call Me.SetParamCommonSystemUp()

        'パラメータの反映
        For Each obj As Object In Me._SqlPrmList
            cmd.Parameters.Add(obj)
        Next

        MyBase.Logger.WriteSQLLog("LMC010DAC", "UpdateOutkaPkgNbUNSOL", cmd)

        'SQLの発行
        MyBase.Logger.WriteLog(0, "LMC010DAC", "UpdateOutkaPkgNbOUTKAL", "特別梱包個数計算 運送データ（大）更新START")
        Me.UpdateResultChk(cmd, True)
        MyBase.Logger.WriteLog(0, "LMC010DAC", "UpdateOutkaPkgNbOUTKAL", "特別梱包個数計算 運送データ（大）更新END")

        Return ds

    End Function

    ''' <summary>
    ''' 運賃のデータ取得
    ''' </summary>
    ''' <param name="ds">DataSet</param>
    ''' <returns>DataSet</returns>
    ''' <remarks>初期表示時の運賃のデータ取得SQLの構築・発行</remarks>
    Private Function SelectUnchinData(ByVal ds As DataSet) As DataSet

        'DataSetのIN情報を取得
        Dim inTbl As DataTable = ds.Tables("LMC010_OUTKA_M_IN")

        'INTableの条件rowの格納
        Me._Row = inTbl.Rows(0)

        'SQL格納変数の初期化
        Me._StrSql = New StringBuilder()

        'SQLパラメータ初期化
        Me._SqlPrmList = New ArrayList()

        'パラメータ設定
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@NRS_BR_CD", Me._Row.Item("NRS_BR_CD").ToString(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@OUTKA_NO_L", Me._Row.Item("OUTKA_NO_L").ToString(), DBDataType.CHAR))

        'SQL文のコンパイル
        Dim cmd As SqlCommand = MyBase.CreateSqlCommand(Me.SetSchemaNm(LMC010DAC.SQL_SELECT_UNCHIN, Me._Row.Item("NRS_BR_CD").ToString()))

        'パラメータの反映
        For Each obj As Object In Me._SqlPrmList
            cmd.Parameters.Add(obj)
        Next

        MyBase.Logger.WriteSQLLog("LMC010DAC", "SelectUnchinData", cmd)

        'SQLの発行
        Dim reader As SqlDataReader = MyBase.GetSelectResult(cmd)

        'DataReader→DataTableへの転記
        Dim map As Hashtable = New Hashtable()

        '取得データの格納先をマッピング
        map.Add("SEIQTO_CD", "SEIQTO_CD")
        map.Add("UNTIN_CALCULATION_KB", "UNTIN_CALCULATION_KB")
        map.Add("SEIQ_TARIFF_BUNRUI_KB", "SEIQ_TARIFF_BUNRUI_KB")
        map.Add("TARIFF_BUNRUI_KB", "TARIFF_BUNRUI_KB")

        Return MyBase.SetSelectResultToDataSet(map, ds, reader, "F_UNCHIN_TRS")

    End Function

    ''' <summary>
    ''' 請求ヘッダ取得
    ''' </summary>
    ''' <param name="ds">DataSet</param>
    ''' <returns>DataSet</returns>
    ''' <remarks>請求ヘッダ取得SQLの構築・発行</remarks>
    Private Function SelectGheaderData(ByVal ds As DataSet) As DataSet

        'DataSetのIN情報を取得
        Dim inTbl As DataTable = ds.Tables("F_UNCHIN_TRS")

        'INTableの条件rowの格納
        Me._Row = inTbl.Rows(0)

        'SQL格納変数の初期化
        Me._StrSql = New StringBuilder()

        'SQLパラメータ初期化
        Me._SqlPrmList = New ArrayList()

        'パラメータ設定
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@SEIQTO_CD", Me._Row.Item("SEIQTO_CD").ToString(), DBDataType.NVARCHAR)) '要望番号1664:(SEIQTO_CD DACの型) 2012/12/05 本明 VARCHAR,CHAR→NVARCHARに変更
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@TARIFF_BUNRUI_KB", Me._Row.Item("SEIQ_TARIFF_BUNRUI_KB").ToString(), DBDataType.CHAR))
        Dim brCd As String = ds.Tables("LMC010_OUTKA_M_IN").Rows(0).Item("NRS_BR_CD").ToString()
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@NRS_BR_CD", brCd, DBDataType.CHAR))

        'SQL文のコンパイル
        Dim cmd As SqlCommand = MyBase.CreateSqlCommand(Me.SetSchemaNm(LMG000DAC.SQL_SELECT_KEIRI_CHK_DATE, brCd))

        'パラメータの反映
        For Each obj As Object In Me._SqlPrmList
            cmd.Parameters.Add(obj)
        Next

        MyBase.Logger.WriteSQLLog("LMC010DAC", "SelectGheaderData", cmd)

        'SQLの発行
        Dim reader As SqlDataReader = MyBase.GetSelectResult(cmd)

        'DataReader→DataTableへの転記
        Dim map As Hashtable = New Hashtable()

        '取得データの格納先をマッピング
        map.Add("SKYU_DATE", "SKYU_DATE")

        Return (MyBase.SetSelectResultToDataSet(map, ds, reader, "LMC010_UNCHIN_SKYU_DATE"))

    End Function
    'END YANAI 20120322 特別梱包個数計算



    '要望番号1369:(支払-運送会社変更時、タリフを再取得し、再計算をおこなう⇒運行が紐付いている場合には、運行の運送会社変更時のみ動作) 2012/08/24 本明 Start
    ''' <summary>
    ''' 運送会社コードの支払タリフ、支払割増タリフを取得し、LMC010IN_UPDATEの支払タリフ、支払割増タリフにセットする
    ''' </summary>
    ''' <param name="ds">DataSet</param>
    ''' <returns>DataSet（プロキシ）</returns>
    ''' <remarks></remarks>
    Private Function GetTariffCdFromUnsoCd(ByVal ds As DataSet) As DataSet

        'DataSetのIN情報を取得
        Dim inTbl As DataTable = ds.Tables("LMC010IN_UPDATE")

        'INTableの条件rowの格納
        Me._Row = inTbl.Rows(0)

        'SQL格納変数の初期化
        Me._StrSql = New StringBuilder()

        'SQLパラメータ初期化
        Me._SqlPrmList = New ArrayList()

        'パラメータ設定
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@NRS_BR_CD", Me._Row.Item("NRS_BR_CD").ToString(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@UNSOCO_CD", Me._Row.Item("UNSOCO_CD").ToString(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@UNSOCO_BR_CD", Me._Row.Item("UNSOCO_BR_CD").ToString(), DBDataType.CHAR))

        'SQL文のコンパイル
        Dim cmd As SqlCommand = MyBase.CreateSqlCommand(Me.SetSchemaNm(LMC010DAC.SQL_GetTariffCdFromUnsoCd, Me._Row.Item("NRS_BR_CD").ToString()))

        'パラメータの反映
        For Each obj As Object In Me._SqlPrmList
            cmd.Parameters.Add(obj)
        Next

        MyBase.Logger.WriteSQLLog("LMC010DAC", "GetTariffCdFromUnsoCd", cmd)

        'SQLの発行
        Dim reader As SqlDataReader = MyBase.GetSelectResult(cmd)


        'DataReader→DataTableへの転記
        Dim map As Hashtable = New Hashtable()

        '取得データの格納先をマッピング
        map.Add("SHIHARAI_TARIFF_CD", "SHIHARAI_TARIFF_CD")
        map.Add("SHIHARAI_ETARIFF_CD", "SHIHARAI_ETARIFF_CD")
        '要望番号:2408 2015.09.17 追加START
        map.Add("AUTO_DENP_KBN", "AUTO_DENP_KBN")
        '要望番号:2408 2015.09.17 追加END

        Return MyBase.SetSelectResultToDataSet(map, ds, reader, "LMC010IN_UPDATE")



        ''値設定
        'reader.Read()
        'If String.IsNullOrEmpty(reader("SHIHARAI_TARIFF_CD").ToString) Then
        '    Me._Row.Item("SHIHARAI_TARIFF_CD") = String.Empty
        'Else
        '    Me._Row.Item("SHIHARAI_TARIFF_CD") = reader("SHIHARAI_TARIFF_CD").ToString
        'End If

        'If String.IsNullOrEmpty(reader("SHIHARAI_ETARIFF_CD").ToString) Then
        '    Me._Row.Item("SHIHARAI_ETARIFF_CD") = String.Empty
        'Else
        '    Me._Row.Item("SHIHARAI_ETARIFF_CD") = reader("SHIHARAI_ETARIFF_CD").ToString
        'End If

        'reader.Close()

        'Return ds

    End Function
    '要望番号1369:(支払-運送会社変更時、タリフを再取得し、再計算をおこなう⇒運行が紐付いている場合には、運行の運送会社変更時のみ動作) 2012/08/24 本明 End


#End Region

    '社内入荷データ作成対応 terakawa 2012.11.19 Start
#Region "社内入荷データ作成処理"
#Region "B_INKA_L"

    ''' <summary>
    ''' B_INKA_L新規登録
    ''' </summary>
    ''' <param name="ds">DataSet</param>
    ''' <returns>DataSet</returns>
    ''' <remarks>B_INKA_L新規登録SQLの構築・発行</remarks>
    Private Function InsertInkaL(ByVal ds As DataSet) As DataSet

        'DataSetのIN情報を取得
        Dim inTbl As DataTable = ds.Tables("LMC010_B_INKA_L")
        'INTableの条件rowの格納
        Me._Row = inTbl.Rows(0)
        'SQLパラメータ初期化
        Me._SqlPrmList = New ArrayList()

        'Insert先の営業所コードをセット
        Dim nrsBrCdTo As String = inTbl.Rows(0).Item("NRS_BR_CD").ToString()

        'SQL文のコンパイル
        Dim cmd As SqlCommand = MyBase.CreateSqlCommand(Me.SetSchemaNm(LMC010DAC.SQL_INSERT_INKA_L, nrsBrCdTo))

        Dim max As Integer = ds.Tables("LMC010_B_INKA_L").Rows.Count - 1

        For i As Integer = 0 To max
            'パラメータの初期化
            cmd.Parameters.Clear()

            'SQLパラメータ初期化
            Me._SqlPrmList = New ArrayList()

            'パラメータ設定
            Call Me.SetParamCommonSystemIns()
            Call Me.SetInkaLInsertParameter(ds.Tables("LMC010_B_INKA_L").Rows(i))

            'パラメータの反映
            For Each obj As Object In Me._SqlPrmList
                cmd.Parameters.Add(obj)
            Next

            MyBase.Logger.WriteSQLLog("LMC010DAC", "InsertInkaL", cmd)

            'SQLの発行
            MyBase.GetInsertResult(cmd)
        Next

        Return ds

    End Function

#End Region

#Region "B_INKA_M"

    ''' <summary>
    ''' B_INKA_M新規登録
    ''' </summary>
    ''' <param name="ds">DataSet</param>
    ''' <returns>DataSet</returns>
    ''' <remarks>B_INKA_S新規登録SQLの構築・発行</remarks>
    Private Function InsertInkaM(ByVal ds As DataSet) As DataSet

        'DataSetのIN情報を取得
        Dim inTbl As DataTable = ds.Tables("LMC010_B_INKA_M")
        'INTableの条件rowの格納
        Me._Row = inTbl.Rows(0)
        'SQLパラメータ初期化
        Me._SqlPrmList = New ArrayList()

        'Insert先の営業所コードをセット
        Dim nrsBrCdTo As String = ds.Tables("LMC010_B_INKA_M").Rows(0).Item("NRS_BR_CD").ToString()

        'SQL文のコンパイル
        Dim cmd As SqlCommand = MyBase.CreateSqlCommand(Me.SetSchemaNm(LMC010DAC.SQL_INSERT_INKA_M, nrsBrCdTo))

        Dim max As Integer = ds.Tables("LMC010_B_INKA_M").Rows.Count - 1

        For i As Integer = 0 To max
            'パラメータの初期化
            cmd.Parameters.Clear()

            'SQLパラメータ初期化
            Me._SqlPrmList = New ArrayList()

            'パラメータ設定
            Call Me.SetParamCommonSystemIns()
            Call Me.SetInkaMInsertParameter(ds.Tables("LMC010_B_INKA_M").Rows(i))

            'パラメータの反映
            For Each obj As Object In Me._SqlPrmList
                cmd.Parameters.Add(obj)
            Next

            MyBase.Logger.WriteSQLLog("LMC010DAC", "InsertInkaM", cmd)

            'SQLの発行
            MyBase.GetInsertResult(cmd)
        Next

        Return ds

    End Function

#End Region

#Region "B_INKA_S"

    ''' <summary>
    ''' B_INKA_S新規登録
    ''' </summary>
    ''' <param name="ds">DataSet</param>
    ''' <returns>DataSet</returns>
    ''' <remarks>B_INKA_S新規登録SQLの構築・発行</remarks>
    Private Function InsertInkaS(ByVal ds As DataSet) As DataSet

        'DataSetのIN情報を取得
        Dim inTbl As DataTable = ds.Tables("LMC010_B_INKA_S")
        'INTableの条件rowの格納
        Me._Row = inTbl.Rows(0)
        'SQLパラメータ初期化
        Me._SqlPrmList = New ArrayList()

        'Insert先の営業所コードをセット
        Dim nrsBrCdTo As String = ds.Tables("LMC010_B_INKA_S").Rows(0).Item("NRS_BR_CD").ToString()

        'SQL文のコンパイル
        Dim cmd As SqlCommand = MyBase.CreateSqlCommand(Me.SetSchemaNm(LMC010DAC.SQL_INSERT_INKA_S, nrsBrCdTo))

        Dim max As Integer = ds.Tables("LMC010_B_INKA_S").Rows.Count - 1

        For i As Integer = 0 To max
            'パラメータの初期化
            cmd.Parameters.Clear()

            'SQLパラメータ初期化
            Me._SqlPrmList = New ArrayList()

            'パラメータ設定
            Call Me.SetParamCommonSystemIns()
            Call Me.SetInkaSInsertParameter(ds.Tables("LMC010_B_INKA_S").Rows(i))

            'パラメータの反映
            For Each obj As Object In Me._SqlPrmList
                cmd.Parameters.Add(obj)
            Next

            MyBase.Logger.WriteSQLLog("LMC010DAC", "InsertInkaS", cmd)

            'SQLの発行
            MyBase.GetInsertResult(cmd)
        Next

        Return ds

    End Function

#End Region


#End Region
    '社内入荷データ作成対応 terakawa 2012.11.19 End

    '要望番号:1533 terakawa 2012.10.30 Start
#Region "チェック"
    ''' <summary>
    ''' 排他チェック
    ''' </summary>
    ''' <param name="ds">DataSet</param>
    ''' <returns>DataSet</returns>
    ''' <remarks>検索結果取得SQLの構築・発行</remarks>
    Private Function OutkaLExistChk(ByVal ds As DataSet) As DataSet

        'DataSetのIN情報を取得
        Dim inTbl As DataTable = ds.Tables("LMC010_HAITA")

        'INTableの条件rowの格納
        Me._Row = inTbl.Rows(0)

        'SQL格納変数の初期化
        Me._StrSql = New StringBuilder()

        'SQLパラメータ初期化
        Me._SqlPrmList = New ArrayList()

        'SQL作成
        Me._StrSql.Append(LMC010DAC.SQL_HAITA_CHK)

        'スキーマ名設定
        Dim sql As String = Me.SetSchemaNm(Me._StrSql.ToString(), inTbl.Rows(0).Item("NRS_BR_CD").ToString())

        'SQL文のコンパイル
        Dim cmd As SqlCommand = MyBase.CreateSqlCommand(sql)

        'SQLパラメータ設定
        Call Me.SetParamHaitaChk()

        'パラメータの反映
        For Each obj As Object In Me._SqlPrmList
            cmd.Parameters.Add(obj)
        Next

        MyBase.Logger.WriteSQLLog("LMC010DAC", "OutkaLExistChk", cmd)

        'SQLの発行
        Dim reader As SqlDataReader = MyBase.GetSelectResult(cmd)

        cmd.Parameters.Clear()

        '処理件数の設定
        reader.Read()
        MyBase.SetResultCount(Convert.ToInt32(reader("SELECT_CNT")))
        reader.Close()
        'エラーメッセージの設定
        'If count < 1 Then
        '    Dim strMsg As String = String.Empty
        '    strMsg = String.Concat("[出荷管理番号：", ds.Tables("LMC010_HAITA").Rows(0).Item("OUTKA_NO_L").ToString, "]")
        '    MyBase.SetMessageStore("00", "E519", New String() {strMsg}, Me._Row.Item("ROW_NO").ToString())
        'End If


        Return ds

    End Function

    ''' <summary>
    ''' 存在チェック
    ''' </summary>
    ''' <param name="ds">DataSet</param>
    ''' <returns>DataSet</returns>
    ''' <remarks>検索結果取得SQLの構築・発行</remarks>
    Private Function SelectIntEdiExist(ByVal ds As DataSet) As DataSet

        'DataSetのIN情報を取得
        Dim inTbl As DataTable = ds.Tables("LMC010_INKA_IN")

        'INTableの条件rowの格納
        Me._Row = inTbl.Rows(0)

        'SQL格納変数の初期化
        Me._StrSql = New StringBuilder()

        'SQLパラメータ初期化
        Me._SqlPrmList = New ArrayList()

        'SQL作成
        Me._StrSql.Append(LMC010DAC.SQL_EXIST_INT_EDI_CHK)

        'スキーマ名設定
        Dim sql As String = Me.SetSchemaNm(Me._StrSql.ToString(), inTbl.Rows(0).Item("NRS_BR_CD").ToString())

        'SQL文のコンパイル
        Using cmd As SqlCommand = MyBase.CreateSqlCommand(sql)

            'SQLパラメータ設定
            Me.SetParamExistIntEdiChk()

            'パラメータの反映
            For Each obj As Object In Me._SqlPrmList
                cmd.Parameters.Add(obj)
            Next

            MyBase.Logger.WriteSQLLog(MyBase.GetType.Name _
                                   , Reflection.MethodBase.GetCurrentMethod().Name _
                                   , cmd)

            Dim tableName As String = TABLE_NM.LMC010_INT_EDI

            'SQLの発行
            Using reader As SqlDataReader = MyBase.GetSelectResult(cmd)
                cmd.Parameters.Clear()

                '処理件数の設定            
                Dim map As Hashtable = New Hashtable()
                For Each item As String In Enumerable.Range(0, reader.FieldCount) _
                                                     .Select(Function(i) reader.GetName(i))

                    If (ds.Tables(tableName).Columns.Contains(item)) Then
                        map.Add(item, item)
                    End If
                Next

                'DataReader→DataTableへの転記
                ds = MyBase.SetSelectResultToDataSet(map _
                                                   , ds _
                                                   , reader _
                                                   , tableName)

                MyBase.SetResultCount(ds.Tables(tableName).Rows.Count)

            End Using
        End Using


        Return ds

    End Function

#End Region
    '要望番号:1533 terakawa 2012.10.30 End

#Region "WIT対応"

#Region "纏めピッキング番号採番処理　主処理"

    'START Kurihara WIT対応

    ''' <summary>
    ''' 対象の出荷管理番号Lを持つワークデータを検索します。
    ''' </summary>
    ''' <param name="ds">検索条件DataSet</param>
    ''' <returns>検索結果DataSet</returns>
    ''' <remarks></remarks>
    Private Function SelectMtmPickList(ByVal ds As DataSet) As DataSet

        'DataSetのIN情報を取得
        Dim inTbl As DataTable = ds.Tables("LMC010IN_OUTKA_L")
        Dim inRow As DataRow = inTbl.Rows(0)
        Dim outka_l_list As List(Of String) = New List(Of String)
        For Each outka_l_row As DataRow In inTbl.Rows
            Dim outka_no_l As String = String.Concat("'", outka_l_row("OUTKA_NO_L").ToString, "'")
            If Not outka_l_list.Contains(outka_no_l) Then
                outka_l_list.Add(outka_no_l)
            End If
        Next
        'SelectCommand作成
        Dim sql As String = Me.SetSchemaNm(LMC010DAC.SQL_SELECT_MTM_PIC_NO_LIST, inRow("NRS_BR_CD").ToString())
        Dim cmd As SqlCommand = Me.CreateSqlCommand(String.Format(sql.ToString(), String.Join(",", outka_l_list.ToArray)))

        'SQLパラメータ設定
        Dim sqlParamList As List(Of SqlParameter) = _
            Me.CreateSelectMtmPickListParameterList(inRow)
        cmd.Parameters.AddRange(sqlParamList.ToArray)

        MyBase.Logger.WriteSQLLog(Me.GetType.Name, MethodBase.GetCurrentMethod.Name, cmd)

        'SQLの発行
        Dim reader As SqlDataReader = MyBase.GetSelectResult(cmd)

        'DataReader→DataTableへの転記
        Dim map As Hashtable = New Hashtable()
        With map
            '取得データの格納先をマッピング
            .Add("OUTKA_PLAN_DATE", "OUTKA_PLAN_DATE")
            .Add("TOU_NO", "TOU_NO")
            .Add("SITU_NO", "SITU_NO")
            .Add("ZONE_CD", "ZONE_CD")
            .Add("LOCA", "LOCA")
            .Add("CUST_CD_L", "CUST_CD_L")
            .Add("MTM_PICK_NO", "MTM_PICK_NO")
        End With

        ds = MyBase.SetSelectResultToDataSet(map, ds, reader, "LMC010OUT_NUMBERING")

        reader.Close()

        Return ds

    End Function

    ''' <summary>
    ''' 纏めピッキングWKへの登録・削除判断を行うためのデータを抽出します。
    ''' </summary>
    ''' <param name="ds">検索条件DataSet</param>
    ''' <returns>検索結果DataSet</returns>
    ''' <remarks></remarks>
    Private Function SelectEntryJudge(ByVal ds As DataSet) As DataSet

        'DataSetのIN情報を取得
        Dim inTbl As DataTable = ds.Tables("LMC010IN_OUTKA_L")
        Dim inRow As DataRow = inTbl.Rows(0)

        'SelectCommand作成
        Dim sql As String = Me.SetSchemaNm(LMC010DAC.SQL_SELECT_ENTRY_JUDGE, inRow("NRS_BR_CD").ToString())
        Dim cmd As SqlCommand = Me.CreateSqlCommand(sql.ToString())

        'SQLパラメータ設定
        Dim sqlParamList As List(Of SqlParameter) = _
            Me.CreateSelectEntryJudgeParameterList(inRow)
        cmd.Parameters.AddRange(sqlParamList.ToArray)

        MyBase.Logger.WriteSQLLog(Me.GetType.Name, MethodBase.GetCurrentMethod.Name, cmd)

        'SQLの発行
        Dim reader As SqlDataReader = MyBase.GetSelectResult(cmd)

        'DataReader→DataTableへの転記
        Dim map As Hashtable = New Hashtable()
        With map
            '取得データの格納先をマッピング
            .Add("NRS_BR_CD", "NRS_BR_CD")
            .Add("OUTKA_NO_L", "OUTKA_NO_L")
            .Add("OUTKA_NO_M", "OUTKA_NO_M")
            .Add("OUTKA_NO_S", "OUTKA_NO_S")
            .Add("TRN_FLG", "TRN_FLG")
            .Add("WK_FLG", "WK_FLG")
        End With

        ds = MyBase.SetSelectResultToDataSet(map, ds, reader, "LMC010OUT_ENTRY_JUDGE")

        reader.Close()

        Return ds

    End Function

    ''' <summary>
    ''' 纏めピッキングWKへの登録を行います。
    ''' </summary>
    ''' <param name="ds">検索条件DataSet</param>
    ''' <returns>結果DataSet</returns>
    ''' <remarks></remarks>
    Private Function InsertCTotalPicWk(ByVal ds As DataSet) As DataSet

        'DataSetのIN情報を取得
        Dim inTbl As DataTable = ds.Tables("LMC010_C_TOTAL_PIC_WK")
        Dim inRow As DataRow = inTbl.Rows(0)

        'SelectCommand作成
        Dim sql As String = Me.SetSchemaNm(LMC010DAC.SQL_INSERT_C_TOTAL_PIC_WK, inRow("NRS_BR_CD").ToString)
        Dim cmd As SqlCommand = Me.CreateSqlCommand(sql.ToString())

        'SQLパラメータ設定
        Dim sqlParamList As ArrayList = Me.CreateInsertCTotalPicWkParameterList(inRow)
        cmd.Parameters.AddRange(sqlParamList.ToArray)

        MyBase.Logger.WriteSQLLog(Me.GetType.Name, MethodBase.GetCurrentMethod.Name, cmd)

        'SQLの発行
        Dim resultCount As Integer = MyBase.GetInsertResult(cmd)
        MyBase.SetResultCount(resultCount)

        Return ds

    End Function

    ''' <summary>
    ''' 纏めピッキングWKへの削除を行います。
    ''' </summary>
    ''' <param name="ds">検索条件DataSet</param>
    ''' <returns>結果DataSet</returns>
    ''' <remarks></remarks>
    Private Function DeleteCTotalPicWk(ByVal ds As DataSet) As DataSet

        'DataSetのIN情報を取得
        Dim inTbl As DataTable = ds.Tables("LMC010_C_TOTAL_PIC_WK")
        Dim inRow As DataRow = inTbl.Rows(0)

        'SelectCommand作成
        Dim sql As StringBuilder = New StringBuilder(Me.SetSchemaNm(LMC010DAC.SQL_DELETE_C_TOTAL_PIC_WK, inRow("NRS_BR_CD").ToString()))
        Dim cmd As SqlCommand = Me.CreateSqlCommand(sql.ToString())

        'SQLパラメータ設定
        Dim sqlParamList As List(Of SqlParameter) = Me.CreateDeleteCTotalPicWkParameterList(inRow)
        cmd.Parameters.AddRange(sqlParamList.ToArray)

        MyBase.Logger.WriteSQLLog(Me.GetType.Name, MethodBase.GetCurrentMethod.Name, cmd)

        'SQLの発行
        Dim resultCount As Integer = MyBase.GetDeleteResult(cmd)
        MyBase.SetResultCount(resultCount)

        Return ds

    End Function
    'END Kurihara WIT対応

#End Region

#Region "纏めピッキング番号採番処理 副処理"

    'START Kurihara WIT対応

    ''' <summary>
    ''' SQL_SELECT_MTM_PIC_NO_LIST用のパラメータリストオブジェクトを生成します。
    ''' </summary>
    ''' <param name="inRow">値を含んだDataRow</param>
    ''' <returns>パラメータリストオブジェクト</returns>
    ''' <remarks></remarks>
    Private Function CreateSelectMtmPickListParameterList(ByVal inRow As DataRow) As List(Of SqlParameter)
        Dim parameters As New List(Of SqlParameter)
        With parameters
            .Add(MyBase.GetSqlParameter("@NRS_BR_CD", inRow("NRS_BR_CD").ToString(), DBDataType.CHAR))
            .Add(MyBase.GetSqlParameter("@OUTKA_NO_L", inRow("OUTKA_NO_L").ToString(), DBDataType.CHAR))
        End With
        Return parameters
    End Function

    ''' <summary>
    ''' SQL_SELECT_ENTRY_JUDGE用のパラメータリストオブジェクトを生成します。
    ''' </summary>
    ''' <param name="inRow">値を含んだDataRow</param>
    ''' <returns>パラメータリストオブジェクト</returns>
    ''' <remarks></remarks>
    Private Function CreateSelectEntryJudgeParameterList(ByVal inRow As DataRow) As List(Of SqlParameter)
        Dim parameters As New List(Of SqlParameter)
        With parameters
            .Add(MyBase.GetSqlParameter("@NRS_BR_CD", inRow("NRS_BR_CD").ToString(), DBDataType.CHAR))
            .Add(MyBase.GetSqlParameter("@OUTKA_NO_L", inRow("OUTKA_NO_L").ToString(), DBDataType.CHAR))
        End With
        Return parameters
    End Function

    ''' <summary>
    ''' SQL_INSERT_C_TOTAL_PIC_WK用のパラメータリストオブジェクトを生成します。
    ''' </summary>
    ''' <param name="inRow">値を含んだDataRow</param>
    ''' <returns>パラメータリストオブジェクト</returns>
    ''' <remarks></remarks>
    Private Function CreateInsertCTotalPicWkParameterList(ByVal inRow As DataRow) As ArrayList
        Dim parameters As New List(Of SqlParameter)
        With parameters
            .Add(MyBase.GetSqlParameter("@NRS_BR_CD", inRow("NRS_BR_CD").ToString(), DBDataType.CHAR))
            .Add(MyBase.GetSqlParameter("@OUTKA_NO_L", inRow("OUTKA_NO_L").ToString(), DBDataType.CHAR))
            .Add(MyBase.GetSqlParameter("@OUTKA_NO_M", inRow("OUTKA_NO_M").ToString(), DBDataType.CHAR))
            .Add(MyBase.GetSqlParameter("@OUTKA_NO_S", inRow("OUTKA_NO_S").ToString(), DBDataType.CHAR))
            .Add(MyBase.GetSqlParameter("@MTM_PICK_NO", inRow("MTM_PICK_NO").ToString(), DBDataType.CHAR))
            .Add(MyBase.GetSqlParameter("@OUTKA_DATE", MyBase.GetSystemDate(), DBDataType.CHAR))
        End With
        Me._SqlPrmList = New ArrayList(parameters.ToArray)
        Me.SetParamCommonSystemIns()
        Return Me._SqlPrmList
    End Function

    ''' <summary>
    ''' SQL_DELETE_C_TOTAL_PIC_WK用のパラメータリストオブジェクトを生成します。
    ''' </summary>
    ''' <param name="inRow">値を含んだDataRow</param>
    ''' <returns>パラメータリストオブジェクト</returns>
    ''' <remarks></remarks>
    Private Function CreateDeleteCTotalPicWkParameterList(ByVal inRow As DataRow) As List(Of SqlParameter)
        Dim parameters As New List(Of SqlParameter)
        With parameters
            .Add(MyBase.GetSqlParameter("@NRS_BR_CD", inRow("NRS_BR_CD").ToString(), DBDataType.CHAR))
            .Add(MyBase.GetSqlParameter("@OUTKA_NO_L", inRow("OUTKA_NO_L").ToString(), DBDataType.CHAR))
            .Add(MyBase.GetSqlParameter("@OUTKA_NO_M", inRow("OUTKA_NO_M").ToString(), DBDataType.CHAR))
            .Add(MyBase.GetSqlParameter("@OUTKA_NO_S", inRow("OUTKA_NO_S").ToString(), DBDataType.CHAR))
        End With
        Return parameters
    End Function

    'END Kurihara WIT対応

#End Region

#Region "商品管理番号採番処理"

    ''' <summary>
    ''' 商品管理番号作成元データ取得処理
    ''' </summary>
    ''' <param name="ds">DataSet</param>
    ''' <returns>DataSet</returns>
    ''' <remarks></remarks>
    Private Function SelectGoodsKanriNoSrc(ByVal ds As DataSet) As DataSet

        'DataSetのIN情報を取得
        Dim inTbl As DataTable = ds.Tables("LMC010OUT_ZAI")

        'INTableの条件rowの格納
        Me._Row = inTbl.Rows(0)

        'SQL格納変数の初期化
        Me._StrSql = New StringBuilder()

        'SQLパラメータ初期化
        Me._SqlPrmList = New ArrayList()

        'SQL作成
        Me._StrSql.Append(LMC010DAC.SQL_SELECT_GOODS_KANRI_NO_SRC)

        'スキーマ名設定
        Dim sql As String = Me.SetSchemaNm(Me._StrSql.ToString(), Me._Row.Item("NRS_BR_CD").ToString())

        'SQL文のコンパイル
        Dim cmd As SqlCommand = MyBase.CreateSqlCommand(sql)

        'パラメータ設定
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@NRS_BR_CD", Me._Row.Item("NRS_BR_CD").ToString(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@ZAI_REC_NO", Me._Row.Item("ZAI_REC_NO").ToString(), DBDataType.CHAR))

        'パラメータの反映
        For Each obj As Object In Me._SqlPrmList
            cmd.Parameters.Add(obj)
        Next

        MyBase.Logger.WriteSQLLog("LMC010DAC", "SelectGoodsKanriNoSrc", cmd)

        'SQLの発行
        Dim reader As SqlDataReader = MyBase.GetSelectResult(cmd)

        'DataReader→DataTableへの転記
        Dim map As Hashtable = New Hashtable()

        '取得データの格納先をマッピング
        map.Add("NRS_BR_CD", "NRS_BR_CD")
        map.Add("ZAI_REC_NO", "ZAI_REC_NO")
        map.Add("GOODS_CD_CUST", "GOODS_CD_CUST")
        map.Add("LOT_NO", "LOT_NO")
        map.Add("SERIAL_NO", "SERIAL_NO")
#If True Then ' JT物流入荷検品対応 20160727 added inoue
        map.Add("IRIME", "IRIME")
        map.Add("GOODS_CRT_DATE", "GOODS_CRT_DATE")
#End If

#If True Then ' 日興産業出荷検品対応 20170207 added inoue
        map.Add("JAN_CD", "JAN_CD")
#End If

        ds = MyBase.SetSelectResultToDataSet(map, ds, reader, "LMC010OUT_GOODS_KANRI_NO_SRC")

        '処理件数の設定
        MyBase.SetResultCount(ds.Tables("LMC010OUT_GOODS_KANRI_NO_SRC").Rows.Count())
        reader.Close()

        Return ds

    End Function

    ''' <summary>
    ''' 在庫データ更新(商品管理番号)
    ''' </summary>
    ''' <param name="ds">DataSet</param>
    ''' <returns>DataSet</returns>
    ''' <remarks>在庫データ（振替元）更新SQLの構築・発行</remarks>
    Private Function UpdateGoodsKanriNo(ByVal ds As DataSet) As DataSet

        'DataSetのIN情報を取得
        Dim inTbl As DataTable = ds.Tables("LMC010IN_UPDATE_GOODS_KANRI_NO")
        Dim inRow As DataRow = inTbl.Rows(0)

        'SQL文のコンパイル
        Dim cmd As SqlCommand = MyBase.CreateSqlCommand(Me.SetSchemaNm _
                                                        (LMC010DAC.SQL_UPDATE_GOODS_KANRI_NO, inRow.Item("NRS_BR_CD").ToString()))

        Dim sysUpdDate As String = String.Empty
        Dim sysUpdTime As String = String.Empty

        Me._Row = inRow

        'パラメータの初期化
        cmd.Parameters.Clear()
        Me._SqlPrmList.Clear()

        'SQLパラメータ（システム項目）設定
        sysUpdDate = MyBase.GetSystemDate()
        sysUpdTime = MyBase.GetSystemTime()
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@NRS_BR_CD", Me._Row.Item("NRS_BR_CD").ToString(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@ZAI_REC_NO", Me._Row.Item("ZAI_REC_NO").ToString(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@GOODS_KANRI_NO", Me._Row.Item("GOODS_KANRI_NO").ToString(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@SYS_UPD_PGID", MyBase.GetPGID(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@SYS_UPD_USER", MyBase.GetUserID(), DBDataType.NVARCHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@SYS_UPD_DATE", sysUpdDate, DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@SYS_UPD_TIME", sysUpdTime, DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@SYS_UPD_DATE_CUR", Me._Row.Item("SYS_UPD_DATE").ToString(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@SYS_UPD_TIME_CUR", Me._Row.Item("SYS_UPD_TIME").ToString(), DBDataType.CHAR))

        'パラメータの反映
        For Each obj As Object In Me._SqlPrmList
            cmd.Parameters.Add(obj)
        Next

        MyBase.Logger.WriteSQLLog("LMC010DAC", "UpdateGoodsKanriNo", cmd)

        'SQLの発行
        Dim result As Integer = MyBase.GetUpdateResult(cmd)

        '一括引当の中に同じ在庫レコードを更新するデータがある場合、排他エラーになってしまうので、
        'このタイミングで、更新日付、時間を置き換え、排他エラーにならないようにする。
        inRow("SYS_UPD_DATE") = sysUpdDate
        inRow("SYS_UPD_TIME") = sysUpdTime

        Return ds

    End Function

    ''' <summary>
    ''' ハンディ対象荷主情報取得
    ''' </summary>
    ''' <param name="ds">DataSet</param>
    ''' <returns>DataSet</returns>
    ''' <remarks></remarks>
    Private Function SelectCustHandy(ByVal ds As DataSet) As DataSet

        'DataSetのIN情報を取得
        Dim inTbl As DataTable = ds.Tables("LMC010IN_CUST_HANDY")

        'INTableの条件rowの格納
        Me._Row = inTbl.Rows(0)

        'SQL格納変数の初期化
        Me._StrSql = New StringBuilder()

        'SQLパラメータ初期化
        Me._SqlPrmList = New ArrayList()

        'SQL作成
        Me._StrSql.Append(LMC010DAC.SQL_CUST_HANDY)

        'SQL文のコンパイル
        Dim cmd As SqlCommand = MyBase.CreateSqlCommand(Me.SetSchemaNm(Me._StrSql.ToString(), Me._Row.Item("NRS_BR_CD").ToString()))

        'パラメータ設定
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@NRS_BR_CD", Me._Row.Item("NRS_BR_CD").ToString(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@OUTKA_NO_L", Me._Row.Item("OUTKA_NO_L").ToString(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@CUST_CD_L", Me._Row.Item("CUST_CD_L").ToString(), DBDataType.CHAR))

        'パラメータの反映
        For Each obj As Object In Me._SqlPrmList
            cmd.Parameters.Add(obj)
        Next

        MyBase.Logger.WriteSQLLog("LMC010DAC", "SelectCustHandy", cmd)

        'SQLの発行
        Dim reader As SqlDataReader = MyBase.GetSelectResult(cmd)

        'DataReader→DataTableへの転記
        Dim map As Hashtable = New Hashtable()

        '取得データの格納先をマッピング
        map.Add("NRS_BR_CD", "NRS_BR_CD")
        map.Add("WH_CD", "WH_CD")
        map.Add("CUST_CD_L", "CUST_CD_L")
        map.Add("CUST_NM_SHORT", "CUST_NM_SHORT")
        map.Add("FLG_01", "FLG_01")
        map.Add("FLG_02", "FLG_02")
        map.Add("FLG_03", "FLG_03")
        map.Add("FLG_04", "FLG_04")
        map.Add("FLG_05", "FLG_05")
        map.Add("FLG_06", "FLG_06")
        map.Add("FLG_07", "FLG_07")
        map.Add("FLG_08", "FLG_08")
        map.Add("FLG_09", "FLG_09")
        map.Add("FLG_10", "FLG_10")
        map.Add("FLG_11", "FLG_11")
        map.Add("FLG_12", "FLG_12")
        map.Add("FLG_13", "FLG_13")
        map.Add("FLG_14", "FLG_14")
        map.Add("FLG_15", "FLG_15")
        map.Add("FLG_16", "FLG_16")
        map.Add("FLG_17", "FLG_17")
        map.Add("FLG_18", "FLG_18")
        map.Add("FLG_19", "FLG_19")
        map.Add("FLG_20", "FLG_20")
        map.Add("S101_KBN_NM1", "S101_KBN_NM1")
        map.Add("S101_KBN_NM2", "S101_KBN_NM2")
        map.Add("S101_KBN_NM3", "S101_KBN_NM3")
        map.Add("S101_KBN_NM4", "S101_KBN_NM4")
        map.Add("S101_KBN_NM5", "S101_KBN_NM5")
        map.Add("S101_KBN_NM6", "S101_KBN_NM6")
        map.Add("S101_KBN_NM7", "S101_KBN_NM7")
        map.Add("S101_KBN_NM8", "S101_KBN_NM8")
        map.Add("S101_KBN_NM9", "S101_KBN_NM9")
        map.Add("S101_KBN_NM10", "S101_KBN_NM10")

        ds = MyBase.SetSelectResultToDataSet(map, ds, reader, "LMC010OUT_CUST_HANDY")

        '処理件数の設定
        MyBase.SetResultCount(ds.Tables("LMC010OUT_CUST_HANDY").Rows.Count())
        reader.Close()

        Return ds

    End Function

#End Region

#End Region

#Region "ハネウェル対応"

    ''' <summary>
    ''' 出荷データM検索対象データ件数検索(ハネウェルCSV引当)
    ''' </summary>
    ''' <param name="ds">DataSet</param>
    ''' <returns>DataSet</returns>
    ''' <remarks>出荷データLテーブル更新対象データ検索件数取得SQLの構築・発行</remarks>
    Private Function SelectOutkaMForHW(ByVal ds As DataSet) As DataSet

        'DataSetのIN情報を取得
        Dim inTbl As DataTable = ds.Tables("LMC010_OUTKA_M_IN")

        'INTableの条件rowの格納
        Me._Row = inTbl.Rows(0)

        'SQL格納変数の初期化
        Me._StrSql = New StringBuilder()

        'SQL作成
        Me._StrSql.Append(LMC010DAC.SQL_SELECT_OUTKA_M_FOR_HW)

        'SQLパラメータ初期化
        Me._SqlPrmList = New ArrayList()

        'パラメータ設定
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@NRS_BR_CD", Me._Row("NRS_BR_CD"), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@OUTKA_NO_L", Me._Row("OUTKA_NO_L"), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@OUTKA_NO_M", Me._Row("OUTKA_NO_M"), DBDataType.CHAR))

        'スキーマ名設定
        Dim sql As String = Me.SetSchemaNm(Me._StrSql.ToString(), Me._Row.Item("NRS_BR_CD").ToString())

        'SQL文のコンパイル
        Dim cmd As SqlCommand = MyBase.CreateSqlCommand(sql)

        'パラメータの反映
        For Each obj As Object In Me._SqlPrmList
            cmd.Parameters.Add(obj)
        Next

        MyBase.Logger.WriteSQLLog("LMC010DAC", "SelectOutkaMForHW", cmd)

        'SQLの発行
        Dim reader As SqlDataReader = MyBase.GetSelectResult(cmd)

        'DataReader→DataTableへの転記
        Dim map As Hashtable = New Hashtable()

        '取得データの格納先をマッピング
        map.Add("OUTKA_NO_L", "OUTKA_NO_L")
        map.Add("OUTKA_NO_M", "OUTKA_NO_M")
        map.Add("OUTKA_NO_S", "OUTKA_NO_S")
        map.Add("SERIAL_NO", "SERIAL_NO")
        map.Add("RSV_NO", "RSV_NO")
        map.Add("IRIME", "IRIME")
        map.Add("ALCTD_NB", "ALCTD_NB")
        map.Add("ALCTD_KB", "ALCTD_KB")
        map.Add("BACKLOG_NB", "BACKLOG_NB")
        map.Add("ALCTD_QT", "ALCTD_QT")
        map.Add("BACKLOG_QT", "BACKLOG_QT")
        map.Add("OUTKA_HASU", "OUTKA_HASU")
        map.Add("OUTKA_TTL_NB", "OUTKA_TTL_NB")
        map.Add("OUTKA_TTL_QT", "OUTKA_TTL_QT")
        map.Add("OUTKA_PKG_NB", "OUTKA_PKG_NB")
        map.Add("OUTKA_STATE_KB", "OUTKA_STATE_KB")
        map.Add("PICK_KB", "PICK_KB")
        map.Add("WH_CD", "WH_CD")
        map.Add("SYS_UPD_DATE", "SYS_UPD_DATE")
        map.Add("SYS_UPD_TIME", "SYS_UPD_TIME")
        map.Add("PKG_NB", "PKG_NB")
        map.Add("GOODS_CD_NRS", "GOODS_CD_NRS")
        map.Add("GOODS_NM", "GOODS_NM")
        map.Add("LOT_NO", "LOT_NO")
        map.Add("GOODS_CD_NRS_FROM", "GOODS_CD_NRS_FROM")
        map.Add("TARE_YN", "TARE_YN")
        map.Add("UNSO_NO_L", "UNSO_NO_L")
        map.Add("UNSOL_SYS_UPD_DATE", "UNSOL_SYS_UPD_DATE")
        map.Add("UNSOL_SYS_UPD_TIME", "UNSOL_SYS_UPD_TIME")
        map.Add("UNSO_NO_M", "UNSO_NO_M")
        map.Add("UNCHIN_SYS_UPD_DATE", "UNCHIN_SYS_UPD_DATE")
        map.Add("UNCHIN_SYS_UPD_TIME", "UNCHIN_SYS_UPD_TIME")
        map.Add("UNSO_TEHAI_KB", "UNSO_TEHAI_KB")
        map.Add("NRS_BR_CD", "NRS_BR_CD")
        map.Add("CUST_CD_L", "CUST_CD_L")
        map.Add("CUST_CD_M", "CUST_CD_M")
        map.Add("CUST_NM_L", "CUST_NM_L")
        map.Add("CUST_NM_M", "CUST_NM_M")
        map.Add("OUTKA_PLAN_DATE", "OUTKA_PLAN_DATE")
        map.Add("SASZ_USER", "SASZ_USER")
        map.Add("NHS_FLAG", "NHS_FLAG")

        ds = MyBase.SetSelectResultToDataSet(map, ds, reader, "LMC010_OUTKA_M_OUT")

        '処理件数の設定
        MyBase.SetResultCount(ds.Tables("LMC010_OUTKA_M_OUT").Rows.Count())
        reader.Close()

        Return ds

    End Function


#End Region

    '2014.04.21 CALT対応 黎 --ST--
#Region "CALT対応"
    ''' <summary>
    ''' 出荷(L/M/S)取得
    ''' </summary>
    ''' <param name="ds"></param>
    ''' <returns></returns>
    ''' <remarks></remarks>
    Private Function SelectOutkaLMS(ByVal ds As DataSet) As DataSet

        'SQL格納変数の初期化
        Me._StrSql = New StringBuilder()

        'DataSetのIN情報を取得
        Me._Row = ds.Tables("LMC010IN_OUTKA_DIRECT_SEND").Rows(0)

        'SQL構築
        Me._StrSql.Append(LMC010DAC.SQL_SELECT_OUTKA_LMS)

        'DBスキーマ設定
        Dim sql As String = Me.SetSchemaNm(Me._StrSql.ToString, Me._Row.Item("NRS_BR_CD").ToString())

        'SQL文のコンパイル
        Dim cmd As SqlCommand = MyBase.CreateSqlCommand(sql)

        'パラメータ設定
        Me._SqlPrmList = New ArrayList()
        Call Me.SetParameterOnCalt(Me._Row, Me._SqlPrmList)

        'パラメータの反映
        For Each obj As Object In Me._SqlPrmList
            cmd.Parameters.Add(obj)
        Next

        MyBase.Logger.WriteSQLLog("LMC010DAC", "SelectOutkaLMS", cmd)

        'SQLの発行
        Dim reader As SqlDataReader = MyBase.GetSelectResult(cmd)

        'DataReader→DataTableへの転記
        Dim map As Hashtable = New Hashtable()

        '取得データの格納先をマッピング
        map.Add("NRS_BR_CD", "NRS_BR_CD")
        map.Add("OUTKA_NO_L", "OUTKA_NO_L")
        map.Add("OUTKA_NO_M", "OUTKA_NO_M")
        map.Add("OUTKA_NO_S", "OUTKA_NO_S")
        map.Add("SEND_SEQ", "SEND_SEQ")
        map.Add("DATA_KBN", "DATA_KBN")
        map.Add("WH_CD", "WH_CD")
        map.Add("CUST_CD_L", "CUST_CD_L")
        map.Add("CUST_CD_M", "CUST_CD_M")
        map.Add("CUST_NM_L", "CUST_NM_L")
        map.Add("OUTKA_PLAN_DATE", "OUTKA_PLAN_DATE")
        map.Add("ARR_PLAN_DATE", "ARR_PLAN_DATE")
        map.Add("DEST_CD", "DEST_CD")
        map.Add("DEST_NM", "DEST_NM")
        map.Add("DEST_AD_1", "DEST_AD_1")
        map.Add("DEST_AD_2", "DEST_AD_2")
        map.Add("DEST_AD_3", "DEST_AD_3")
        map.Add("DEST_TEL", "DEST_TEL")
        map.Add("ZIP", "ZIP")
        map.Add("CUST_ORD_NO", "CUST_ORD_NO")
        map.Add("BUYER_ORD_NO", "BUYER_ORD_NO")
        map.Add("REMARK_L", "REMARK_L")
        map.Add("GOODS_CD_NRS", "GOODS_CD_NRS")
        map.Add("GOODS_CD_CUST", "GOODS_CD_CUST")
        map.Add("GOODS_NM_1", "GOODS_NM_1")
        map.Add("REMARK_M", "REMARK_M")
        map.Add("LOT_NO", "LOT_NO")
        map.Add("SERIAL_NO", "SERIAL_NO")
        map.Add("OUTKA_NB", "OUTKA_NB")
        map.Add("OUTKA_QT", "OUTKA_QT")
        map.Add("OUTKA_TTL_NB", "OUTKA_TTL_NB")
        map.Add("OUTKA_TTL_QT", "OUTKA_TTL_QT")
        map.Add("ALCTD_NB", "ALCTD_NB")
        map.Add("ALCTD_QT", "ALCTD_QT")
        map.Add("IRIME", "IRIME")
        map.Add("BETU_WT", "BETU_WT")
        map.Add("REMARK_S", "REMARK_S")
        map.Add("PKG_NB", "PKG_NB")
        map.Add("PKG_UT", "PKG_UT")
        map.Add("ZAI_REC_NO", "ZAI_REC_NO")
        map.Add("GOODS_COND_KB_1", "GOODS_COND_KB_1")
        map.Add("GOODS_COND_KB_2", "GOODS_COND_KB_2")
        map.Add("GOODS_COND_KB_3", "GOODS_COND_KB_3")
        map.Add("GOODS_CRT_DATE", "GOODS_CRT_DATE")
        map.Add("LT_DATE", "LT_DATE")
        map.Add("SPD_KB", "SPD_KB")
        map.Add("OFB_KB", "OFB_KB")
        map.Add("DEST_CD_P", "DEST_CD_P")
        map.Add("SEND_SHORI_FLG", "SEND_SHORI_FLG")
        map.Add("SYS_DEL_FLG", "SYS_DEL_FLG")

        ds = MyBase.SetSelectResultToDataSet(map, ds, reader, "LMC010OUT_OUTKA_DIRECT_SEND")

        MyBase.SetResultCount(ds.Tables("LMC010OUT_OUTKA_DIRECT_SEND").Rows.Count)
        reader.Close()

        Return ds

    End Function

    ''' <summary>
    ''' キャンセルデータ抜出
    ''' </summary>
    ''' <param name="ds"></param>
    ''' <returns></returns>
    ''' <remarks></remarks>
    Private Function SelectSendCancel(ByVal ds As DataSet) As DataSet

        'SQL格納変数の初期化
        Me._StrSql = New StringBuilder()

        'DataSetのIN情報を取得
        Me._Row = ds.Tables("LMC010IN_OUTKA_DIRECT_SEND").Rows(0)

        'SQL構築
        Me._StrSql.AppendLine(LMC010DAC.SQL_SELECT_OUTKA_LMS_CANCEL)
        Me._StrSql.AppendLine(LMC010DAC.SQL_OUTKA_LMS_CANCEL_ORDER_BY)

        'DBスキーマ設定
        Dim sql As String = Me.SetSchemaNm(Me._StrSql.ToString, Me._Row.Item("NRS_BR_CD").ToString())

        'SQL文のコンパイル
        Dim cmd As SqlCommand = MyBase.CreateSqlCommand(sql)

        'パラメータ設定
        Me._SqlPrmList = New ArrayList()
        Call Me.SetParameterOnCalt(Me._Row, Me._SqlPrmList)

        'パラメータの反映
        For Each obj As Object In Me._SqlPrmList
            cmd.Parameters.Add(obj)
        Next

        MyBase.Logger.WriteSQLLog("LMC010DAC", "SelectSendCancel", cmd)

        'SQLの発行
        Dim reader As SqlDataReader = MyBase.GetSelectResult(cmd)

        'DataReader→DataTableへの転記
        Dim map As Hashtable = New Hashtable()

        '取得データの格納先をマッピング
        map.Add("NRS_BR_CD", "NRS_BR_CD")
        map.Add("OUTKA_NO_L", "OUTKA_NO_L")
        map.Add("OUTKA_NO_M", "OUTKA_NO_M")
        map.Add("OUTKA_NO_S", "OUTKA_NO_S")
        map.Add("SEND_SEQ", "SEND_SEQ")
        map.Add("DATA_KBN", "DATA_KBN")
        map.Add("WH_CD", "WH_CD")
        map.Add("CUST_CD_L", "CUST_CD_L")
        map.Add("CUST_CD_M", "CUST_CD_M")
        map.Add("CUST_NM_L", "CUST_NM_L")
        map.Add("OUTKA_PLAN_DATE", "OUTKA_PLAN_DATE")
        map.Add("ARR_PLAN_DATE", "ARR_PLAN_DATE")
        map.Add("DEST_CD", "DEST_CD")
        map.Add("DEST_NM", "DEST_NM")
        map.Add("DEST_AD_1", "DEST_AD_1")
        map.Add("DEST_AD_2", "DEST_AD_2")
        map.Add("DEST_AD_3", "DEST_AD_3")
        map.Add("DEST_TEL", "DEST_TEL")
        map.Add("ZIP", "ZIP")
        map.Add("CUST_ORD_NO", "CUST_ORD_NO")
        map.Add("BUYER_ORD_NO", "BUYER_ORD_NO")
        map.Add("REMARK_L", "REMARK_L")
        map.Add("GOODS_CD_NRS", "GOODS_CD_NRS")
        map.Add("GOODS_CD_CUST", "GOODS_CD_CUST")
        map.Add("GOODS_NM_1", "GOODS_NM_1")
        map.Add("REMARK_M", "REMARK_M")
        map.Add("LOT_NO", "LOT_NO")
        map.Add("SERIAL_NO", "SERIAL_NO")
        map.Add("OUTKA_NB", "OUTKA_NB")
        map.Add("OUTKA_QT", "OUTKA_QT")
        map.Add("OUTKA_TTL_NB", "OUTKA_TTL_NB")
        map.Add("OUTKA_TTL_QT", "OUTKA_TTL_QT")
        map.Add("ALCTD_NB", "ALCTD_NB")
        map.Add("ALCTD_QT", "ALCTD_QT")
        map.Add("IRIME", "IRIME")
        map.Add("BETU_WT", "BETU_WT")
        map.Add("REMARK_S", "REMARK_S")
        map.Add("PKG_NB", "PKG_NB")
        map.Add("PKG_UT", "PKG_UT")
        map.Add("ZAI_REC_NO", "ZAI_REC_NO")
        map.Add("GOODS_COND_KB_1", "GOODS_COND_KB_1")
        map.Add("GOODS_COND_KB_2", "GOODS_COND_KB_2")
        map.Add("GOODS_COND_KB_3", "GOODS_COND_KB_3")
        map.Add("GOODS_CRT_DATE", "GOODS_CRT_DATE")
        map.Add("LT_DATE", "LT_DATE")
        map.Add("SPD_KB", "SPD_KB")
        map.Add("OFB_KB", "OFB_KB")
        map.Add("DEST_CD_P", "DEST_CD_P")
        map.Add("SEND_SHORI_FLG", "SEND_SHORI_FLG")
        map.Add("SYS_DEL_FLG", "SYS_DEL_FLG")

        ds = MyBase.SetSelectResultToDataSet(map, ds, reader, "LMC010OUT_OUTKA_DIRECT_SEND")

        MyBase.SetResultCount(ds.Tables("LMC010OUT_OUTKA_DIRECT_SEND").Rows.Count)
        reader.Close()

        Return ds

    End Function

    ''' <summary>
    ''' 出荷報告データ作成
    ''' </summary>
    ''' <param name="ds"></param>
    ''' <returns></returns>
    ''' <remarks></remarks>
    Private Function InsertDirectSend(ByVal ds As DataSet) As DataSet

        'SQL格納変数の初期化
        Me._StrSql = New StringBuilder()

        'DataSetのIN情報を取得
        Me._Row = ds.Tables("LMC010OUT_OUTKA_DIRECT_SEND").Rows(0)

        'SQL構築
        Me._StrSql.Append(LMC010DAC.SQL_INSERT_DIRECT_SEND)

        'DBスキーマ設定
        Dim sql As String = Me.SetSchemaNm(Me._StrSql.ToString, Me._Row.Item("NRS_BR_CD").ToString())

        'SQL文のコンパイル
        Dim cmd As SqlCommand = MyBase.CreateSqlCommand(sql)

        'パラメータ設定
        Me._SqlPrmList = New ArrayList()
        Call Me.SetInsertParameterOnCalt(Me._Row, Me._SqlPrmList)
        Call Me.SetParamCommonSystems()

        'パラメータの反映
        For Each obj As Object In Me._SqlPrmList
            cmd.Parameters.Add(obj)
        Next

        MyBase.Logger.WriteSQLLog("LMC010DAC", "InsertDirectSend", cmd)

        'SQLの発行
        MyBase.GetInsertResult(cmd)

        Return ds

    End Function

    ''' <summary>
    ''' CALT出荷パラメータ
    ''' </summary>
    ''' <param name="conditionRow">DataRow</param>
    ''' <param name="prmList">パラメータ</param>
    ''' <remarks></remarks>
    Private Sub SetParameterOnCalt(ByVal conditionRow As DataRow, ByVal prmList As ArrayList)

        With conditionRow

            prmList.Add(MyBase.GetSqlParameter("@NRS_BR_CD", .Item("NRS_BR_CD").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@OUTKA_NO_L", .Item("OUTKA_NO_L").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@GUI_SYS_UPD_DATE", .Item("SYS_UPD_DATE").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@GUI_SYS_UPD_TIME", .Item("SYS_UPD_TIME").ToString(), DBDataType.CHAR))

        End With

    End Sub

    ''' <summary>
    ''' 出荷指示データ作成
    ''' </summary>
    ''' <param name="conditionRow">DataRow</param>
    ''' <param name="prmList">パラメータ</param>
    ''' <remarks></remarks>
    Private Sub SetInsertParameterOnCalt(ByVal conditionRow As DataRow, ByVal prmList As ArrayList)

        With conditionRow

            prmList.Add(MyBase.GetSqlParameter("@NRS_BR_CD", .Item("NRS_BR_CD").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@OUTKA_NO_L", .Item("OUTKA_NO_L").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@OUTKA_NO_M", .Item("OUTKA_NO_M").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@OUTKA_NO_S", .Item("OUTKA_NO_S").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@SEND_SEQ", .Item("SEND_SEQ").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@DATA_KBN", .Item("DATA_KBN").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@WH_CD", .Item("WH_CD").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@CUST_CD_L", .Item("CUST_CD_L").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@CUST_CD_M", .Item("CUST_CD_M").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@CUST_NM_L", .Item("CUST_NM_L").ToString(), DBDataType.NVARCHAR))
            prmList.Add(MyBase.GetSqlParameter("@OUTKA_PLAN_DATE", .Item("OUTKA_PLAN_DATE").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@ARR_PLAN_DATE", .Item("ARR_PLAN_DATE").ToString(), DBDataType.NVARCHAR))
            prmList.Add(MyBase.GetSqlParameter("@DEST_CD", .Item("DEST_CD").ToString(), DBDataType.NVARCHAR))
            prmList.Add(MyBase.GetSqlParameter("@DEST_NM", .Item("DEST_NM").ToString(), DBDataType.NVARCHAR))
            prmList.Add(MyBase.GetSqlParameter("@DEST_AD_1", .Item("DEST_AD_1").ToString(), DBDataType.NVARCHAR))
            prmList.Add(MyBase.GetSqlParameter("@DEST_AD_2", .Item("DEST_AD_2").ToString(), DBDataType.NVARCHAR))
            prmList.Add(MyBase.GetSqlParameter("@DEST_AD_3", .Item("DEST_AD_3").ToString(), DBDataType.NVARCHAR))
            prmList.Add(MyBase.GetSqlParameter("@DEST_TEL", .Item("DEST_TEL").ToString(), DBDataType.NVARCHAR))
            prmList.Add(MyBase.GetSqlParameter("@ZIP", .Item("ZIP").ToString(), DBDataType.NVARCHAR))
            prmList.Add(MyBase.GetSqlParameter("@CUST_ORD_NO", .Item("CUST_ORD_NO").ToString(), DBDataType.NVARCHAR))
            prmList.Add(MyBase.GetSqlParameter("@BUYER_ORD_NO", .Item("BUYER_ORD_NO").ToString(), DBDataType.NVARCHAR))
            prmList.Add(MyBase.GetSqlParameter("@REMARK_L", .Item("REMARK_L").ToString(), DBDataType.NVARCHAR))
            prmList.Add(MyBase.GetSqlParameter("@GOODS_CD_NRS", .Item("GOODS_CD_NRS").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@GOODS_CD_CUST", .Item("GOODS_CD_CUST").ToString(), DBDataType.NVARCHAR))
            prmList.Add(MyBase.GetSqlParameter("@GOODS_NM_1", .Item("GOODS_NM_1").ToString(), DBDataType.NVARCHAR))
            prmList.Add(MyBase.GetSqlParameter("@REMARK_M", .Item("REMARK_M").ToString(), DBDataType.NVARCHAR))
            prmList.Add(MyBase.GetSqlParameter("@LOT_NO", .Item("LOT_NO").ToString(), DBDataType.NVARCHAR))
            prmList.Add(MyBase.GetSqlParameter("@SERIAL_NO", .Item("SERIAL_NO").ToString(), DBDataType.NVARCHAR))
            prmList.Add(MyBase.GetSqlParameter("@OUTKA_NB", .Item("OUTKA_NB").ToString(), DBDataType.NUMERIC))
            prmList.Add(MyBase.GetSqlParameter("@OUTKA_QT", .Item("OUTKA_QT").ToString(), DBDataType.NUMERIC))
            prmList.Add(MyBase.GetSqlParameter("@OUTKA_TTL_NB", .Item("OUTKA_TTL_NB").ToString(), DBDataType.NUMERIC))
            prmList.Add(MyBase.GetSqlParameter("@OUTKA_TTL_QT", .Item("OUTKA_TTL_QT").ToString(), DBDataType.NUMERIC))
            prmList.Add(MyBase.GetSqlParameter("@ALCTD_NB", .Item("ALCTD_NB").ToString(), DBDataType.NUMERIC))
            prmList.Add(MyBase.GetSqlParameter("@ALCTD_QT", .Item("ALCTD_QT").ToString(), DBDataType.NUMERIC))
            prmList.Add(MyBase.GetSqlParameter("@IRIME", .Item("IRIME").ToString(), DBDataType.NUMERIC))
            prmList.Add(MyBase.GetSqlParameter("@BETU_WT", .Item("BETU_WT").ToString(), DBDataType.NUMERIC))
            prmList.Add(MyBase.GetSqlParameter("@REMARK_S", .Item("REMARK_S").ToString(), DBDataType.NVARCHAR))
            prmList.Add(MyBase.GetSqlParameter("@PKG_NB", .Item("PKG_NB").ToString(), DBDataType.NUMERIC))
            prmList.Add(MyBase.GetSqlParameter("@PKG_UT", .Item("PKG_UT").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@ZAI_REC_NO", .Item("ZAI_REC_NO").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@GOODS_COND_KB_1", .Item("GOODS_COND_KB_1").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@GOODS_COND_KB_2", .Item("GOODS_COND_KB_2").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@GOODS_COND_KB_3", .Item("GOODS_COND_KB_3").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@GOODS_CRT_DATE", .Item("GOODS_CRT_DATE").ToString(), DBDataType.NVARCHAR))
            prmList.Add(MyBase.GetSqlParameter("@LT_DATE", .Item("LT_DATE").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@SPD_KB", .Item("SPD_KB").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@OFB_KB", .Item("OFB_KB").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@DEST_CD_P", .Item("DEST_CD_P").ToString(), DBDataType.NVARCHAR))
            prmList.Add(MyBase.GetSqlParameter("@SEND_SHORI_FLG", .Item("SEND_SHORI_FLG").ToString(), DBDataType.NVARCHAR))
            prmList.Add(MyBase.GetSqlParameter("@SYS_DEL_FLG", .Item("SYS_DEL_FLG").ToString(), DBDataType.CHAR))

        End With

    End Sub

    ''' <summary>
    ''' パラメータ設定モジュール(システム共通項目(更新時))
    ''' </summary>
    ''' <remarks></remarks>
    Private Sub SetParamCommonSystems()

        'パラメータ設定
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@SYS_PGID", MyBase.GetPGID(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@SYS_USER", MyBase.GetUserID(), DBDataType.NVARCHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@SYS_DATE", MyBase.GetSystemDate(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@SYS_TIME", MyBase.GetSystemTime(), DBDataType.CHAR))

    End Sub

#End Region
    '2014.04.21 CALT対応 黎 --ED--

    '2015.06.22 協立化学　作業料対応 START
#Region "作業料明細特殊対応"

    ''' <summary>
    ''' 出荷データ排他チェック
    ''' </summary>
    ''' <param name="ds"></param>
    ''' <returns></returns>
    ''' <remarks></remarks>
    Private Function OutkaListCount(ByVal ds As DataSet) As DataSet

        'SQL格納変数の初期化
        Me._StrSql = New StringBuilder()

        'DataSetのIN情報を取得
        Me._Row = ds.Tables("LMC010_OUTKA_M_IN").Rows(0)

        'SQL構築
        Me._StrSql.Append(LMC010DAC.SQL_SELECT_OUTKA_COUNT)

        'DBスキーマ設定
        Dim sql As String = Me.SetSchemaNm(Me._StrSql.ToString, Me._Row.Item("NRS_BR_CD").ToString())

        'SQL文のコンパイル
        Dim cmd As SqlCommand = MyBase.CreateSqlCommand(sql)

        'パラメータ設定
        Me._SqlPrmList = New ArrayList()
        Call Me.SetOutkaParameter(Me._Row, Me._SqlPrmList)

        'パラメータの反映
        For Each obj As Object In Me._SqlPrmList
            cmd.Parameters.Add(obj)
        Next

        MyBase.Logger.WriteSQLLog("LMC010DAC", "OutkaListCount", cmd)

        'SQLの発行
        Dim reader As SqlDataReader = MyBase.GetSelectResult(cmd)

        '処理件数の設定
        reader.Read()

        If reader.HasRows() = True Then
            MyBase.SetResultCount(Convert.ToInt32(reader("CNT")))
        Else
            MyBase.SetResultCount(0)
        End If

        reader.Close()

        Return ds

    End Function

    ''' <summary>
    ''' 作業レコード作成用データ取得(ラベル)
    ''' </summary>
    ''' <param name="ds"></param>
    ''' <returns></returns>
    ''' <remarks></remarks>
    Private Function OutkaSagyoListLabel(ByVal ds As DataSet) As DataSet

        'SQL格納変数の初期化
        Me._StrSql = New StringBuilder()

        'DataSetのIN情報を取得
        Me._Row = ds.Tables("LMC010_OUTKA_M_IN").Rows(0)

        'SQL構築
        Me._StrSql.Append(LMC010DAC.SQL_SELECT_OUTKA_SAGYO_LIST_LABEL)

        'DBスキーマ設定
        Dim sql As String = Me.SetSchemaNm(Me._StrSql.ToString, Me._Row.Item("NRS_BR_CD").ToString())

        'SQL文のコンパイル
        Dim cmd As SqlCommand = MyBase.CreateSqlCommand(sql)

        'パラメータ設定
        Me._SqlPrmList = New ArrayList()
        Call Me.SetOutkaParameter(Me._Row, Me._SqlPrmList)

        'パラメータの反映
        For Each obj As Object In Me._SqlPrmList
            cmd.Parameters.Add(obj)
        Next

        MyBase.Logger.WriteSQLLog("LMC010DAC", "OutkaSagyoList", cmd)

        'SQLの発行
        Dim reader As SqlDataReader = MyBase.GetSelectResult(cmd)

        'DataReader→DataTableへの転記
        Dim map As Hashtable = New Hashtable()

        '取得データの格納先をマッピング
        map.Add("SAGYO_COMP", "SAGYO_COMP")
        map.Add("SKYU_CHK", "SKYU_CHK")
        map.Add("SAGYO_REC_NO", "SAGYO_REC_NO")
        map.Add("SAGYO_SIJI_NO", "SAGYO_SIJI_NO")
        map.Add("INOUTKA_NO_LM", "INOUTKA_NO_LM")
        map.Add("NRS_BR_CD", "NRS_BR_CD")
        map.Add("WH_CD", "WH_CD")
        map.Add("IOZS_KB", "IOZS_KB")
        map.Add("SAGYO_CD", "SAGYO_CD")
        map.Add("SAGYO_NM", "SAGYO_NM")
        map.Add("CUST_CD_L", "CUST_CD_L")
        map.Add("CUST_CD_M", "CUST_CD_M")
        map.Add("DEST_CD", "DEST_CD")
        map.Add("DEST_NM", "DEST_NM")
        map.Add("GOODS_CD_NRS", "GOODS_CD_NRS")
        map.Add("GOODS_NM_NRS", "GOODS_NM_NRS")
        map.Add("LOT_NO", "LOT_NO")
        map.Add("INV_TANI", "INV_TANI")
        map.Add("SAGYO_NB", "SAGYO_NB")
        map.Add("SAGYO_UP", "SAGYO_UP")
        map.Add("SAGYO_GK", "SAGYO_GK")
        map.Add("TAX_KB", "TAX_KB")
        map.Add("SEIQTO_CD", "SEIQTO_CD")
        map.Add("REMARK_ZAI", "REMARK_ZAI")
        map.Add("REMARK_SKYU", "REMARK_SKYU")
        map.Add("SAGYO_COMP_CD", "SAGYO_COMP_CD")
        map.Add("SAGYO_COMP_DATE", "SAGYO_COMP_DATE")
        map.Add("DEST_SAGYO_FLG", "DEST_SAGYO_FLG")
        map.Add("LOT_COUNT", "LOT_COUNT")

        ds = MyBase.SetSelectResultToDataSet(map, ds, reader, "LMC010OUT_E_SAGYO_MEISAI_LABEL")

        MyBase.SetResultCount(ds.Tables("LMC010OUT_E_SAGYO_MEISAI_LABEL").Rows.Count)
        reader.Close()

        Return ds

    End Function

    ''' <summary>
    ''' 作業レコード作成用データ取得(フタイ)
    ''' </summary>
    ''' <param name="ds"></param>
    ''' <returns></returns>
    ''' <remarks></remarks>
    Private Function OutkaSagyoListHutai(ByVal ds As DataSet) As DataSet

        'SQL格納変数の初期化
        Me._StrSql = New StringBuilder()

        'DataSetのIN情報を取得
        Me._Row = ds.Tables("LMC010_OUTKA_M_IN").Rows(0)

        'SQL構築
        Me._StrSql.Append(LMC010DAC.SQL_SELECT_OUTKA_SAGYO_LIST_HUTAI)

        'DBスキーマ設定
        Dim sql As String = Me.SetSchemaNm(Me._StrSql.ToString, Me._Row.Item("NRS_BR_CD").ToString())

        'SQL文のコンパイル
        Dim cmd As SqlCommand = MyBase.CreateSqlCommand(sql)

        'パラメータ設定
        Me._SqlPrmList = New ArrayList()
        Call Me.SetOutkaParameter(Me._Row, Me._SqlPrmList)

        'パラメータの反映
        For Each obj As Object In Me._SqlPrmList
            cmd.Parameters.Add(obj)
        Next

        MyBase.Logger.WriteSQLLog("LMC010DAC", "OutkaSagyoListHutai", cmd)

        'SQLの発行
        Dim reader As SqlDataReader = MyBase.GetSelectResult(cmd)

        'DataReader→DataTableへの転記
        Dim map As Hashtable = New Hashtable()

        '取得データの格納先をマッピング
        map.Add("SAGYO_COMP", "SAGYO_COMP")
        map.Add("SKYU_CHK", "SKYU_CHK")
        map.Add("SAGYO_REC_NO", "SAGYO_REC_NO")
        map.Add("SAGYO_SIJI_NO", "SAGYO_SIJI_NO")
        map.Add("INOUTKA_NO_LM", "INOUTKA_NO_LM")
        map.Add("NRS_BR_CD", "NRS_BR_CD")
        map.Add("WH_CD", "WH_CD")
        map.Add("IOZS_KB", "IOZS_KB")
        map.Add("SAGYO_CD", "SAGYO_CD")
        map.Add("SAGYO_NM", "SAGYO_NM")
        map.Add("CUST_CD_L", "CUST_CD_L")
        map.Add("CUST_CD_M", "CUST_CD_M")
        map.Add("DEST_CD", "DEST_CD")
        map.Add("DEST_NM", "DEST_NM")
        map.Add("GOODS_CD_NRS", "GOODS_CD_NRS")
        map.Add("GOODS_NM_NRS", "GOODS_NM_NRS")
        map.Add("LOT_NO", "LOT_NO")
        map.Add("INV_TANI", "INV_TANI")
        map.Add("SAGYO_NB", "SAGYO_NB")
        map.Add("SAGYO_UP", "SAGYO_UP")
        map.Add("SAGYO_GK", "SAGYO_GK")
        map.Add("TAX_KB", "TAX_KB")
        map.Add("SEIQTO_CD", "SEIQTO_CD")
        map.Add("REMARK_ZAI", "REMARK_ZAI")
        map.Add("REMARK_SKYU", "REMARK_SKYU")
        map.Add("SAGYO_COMP_CD", "SAGYO_COMP_CD")
        map.Add("SAGYO_COMP_DATE", "SAGYO_COMP_DATE")
        map.Add("DEST_SAGYO_FLG", "DEST_SAGYO_FLG")
        map.Add("LOT_COUNT", "LOT_COUNT")

        ds = MyBase.SetSelectResultToDataSet(map, ds, reader, "LMC010OUT_E_SAGYO_MEISAI_HUTAI")

        MyBase.SetResultCount(ds.Tables("LMC010OUT_E_SAGYO_MEISAI_HUTAI").Rows.Count)
        reader.Close()

        Return ds

    End Function

    ''' <summary>
    ''' 作業レコード作成用データ取得(パレタイス)
    ''' </summary>
    ''' <param name="ds"></param>
    ''' <returns></returns>
    ''' <remarks></remarks>
    Private Function OutkaSagyoListPlt(ByVal ds As DataSet) As DataSet

        'SQL格納変数の初期化
        Me._StrSql = New StringBuilder()

        'DataSetのIN情報を取得
        Me._Row = ds.Tables("LMC010_OUTKA_M_IN").Rows(0)

        'SQL構築
        Me._StrSql.Append(LMC010DAC.SQL_SELECT_OUTKA_SAGYO_LIST_PLT)

        'DBスキーマ設定
        Dim sql As String = Me.SetSchemaNm(Me._StrSql.ToString, Me._Row.Item("NRS_BR_CD").ToString())

        'SQL文のコンパイル
        Dim cmd As SqlCommand = MyBase.CreateSqlCommand(sql)

        'パラメータ設定
        Me._SqlPrmList = New ArrayList()
        Call Me.SetOutkaParameter(Me._Row, Me._SqlPrmList)

        'パラメータの反映
        For Each obj As Object In Me._SqlPrmList
            cmd.Parameters.Add(obj)
        Next

        MyBase.Logger.WriteSQLLog("LMC010DAC", "OutkaSagyoListPlt", cmd)

        'SQLの発行
        Dim reader As SqlDataReader = MyBase.GetSelectResult(cmd)

        'DataReader→DataTableへの転記
        Dim map As Hashtable = New Hashtable()

        '取得データの格納先をマッピング
        map.Add("SAGYO_COMP", "SAGYO_COMP")
        map.Add("SKYU_CHK", "SKYU_CHK")
        map.Add("SAGYO_REC_NO", "SAGYO_REC_NO")
        map.Add("SAGYO_SIJI_NO", "SAGYO_SIJI_NO")
        map.Add("INOUTKA_NO_LM", "INOUTKA_NO_LM")
        map.Add("NRS_BR_CD", "NRS_BR_CD")
        map.Add("WH_CD", "WH_CD")
        map.Add("IOZS_KB", "IOZS_KB")
        map.Add("SAGYO_CD", "SAGYO_CD")
        map.Add("SAGYO_NM", "SAGYO_NM")
        map.Add("CUST_CD_L", "CUST_CD_L")
        map.Add("CUST_CD_M", "CUST_CD_M")
        map.Add("DEST_CD", "DEST_CD")
        map.Add("DEST_NM", "DEST_NM")
        map.Add("GOODS_CD_NRS", "GOODS_CD_NRS")
        map.Add("GOODS_NM_NRS", "GOODS_NM_NRS")
        map.Add("LOT_NO", "LOT_NO")
        map.Add("INV_TANI", "INV_TANI")
        map.Add("SAGYO_NB", "SAGYO_NB")
        map.Add("SAGYO_UP", "SAGYO_UP")
        map.Add("SAGYO_GK", "SAGYO_GK")
        map.Add("TAX_KB", "TAX_KB")
        map.Add("SEIQTO_CD", "SEIQTO_CD")
        map.Add("REMARK_ZAI", "REMARK_ZAI")
        map.Add("REMARK_SKYU", "REMARK_SKYU")
        map.Add("SAGYO_COMP_CD", "SAGYO_COMP_CD")
        map.Add("SAGYO_COMP_DATE", "SAGYO_COMP_DATE")
        map.Add("DEST_SAGYO_FLG", "DEST_SAGYO_FLG")
        map.Add("LOT_COUNT", "LOT_COUNT")

        ds = MyBase.SetSelectResultToDataSet(map, ds, reader, "LMC010OUT_E_SAGYO_MEISAI_PLT")

        MyBase.SetResultCount(ds.Tables("LMC010OUT_E_SAGYO_MEISAI_PLT").Rows.Count)
        reader.Close()

        Return ds

    End Function

    ''' <summary>
    ''' 作業テーブル新規登録
    ''' </summary>
    ''' <param name="ds">DataSet</param>
    ''' <returns>DataSet</returns>
    ''' <remarks>作業テーブル新規登録SQLの構築・発行</remarks>
    Private Function InsertSagyoRec(ByVal ds As DataSet) As DataSet

        'DataSetのIN情報を取得
        Dim outkaLDr As DataRow = ds.Tables("LMC010OUT_E_SAGYO_MEISAI").Rows(0)

        'SQL文のコンパイル
        Dim cmd As SqlCommand = MyBase.CreateSqlCommand(Me.SetSchemaNm(LMC010DAC.SQL_INSERT_SAGYO _
                                                                       , outkaLDr.Item("NRS_BR_CD").ToString()))

        'SQLパラメータ初期化
        Me._SqlPrmList = New ArrayList()

        '条件rowの格納
        Me._Row = outkaLDr

        'パラメータ設定
        Call Me.SetParamCommonSystemIns()
        Call Me.SetSagyoParameter(Me._Row, Me._SqlPrmList)

        'パラメータの反映
        For Each obj As Object In Me._SqlPrmList
            cmd.Parameters.Add(obj)
        Next

        MyBase.Logger.WriteSQLLog("LMC010DAC", "InsertSagyoRec", cmd)

        'SQLの発行
        MyBase.GetInsertResult(cmd)

        'パラメータの初期化
        cmd.Parameters.Clear()

        Return ds

    End Function

    ''' <summary>
    ''' 出荷管理番号(大)パラメータ
    ''' </summary>
    ''' <param name="conditionRow">DataRow</param>
    ''' <param name="prmList">パラメータ</param>
    ''' <remarks></remarks>
    Private Sub SetOutkaParameter(ByVal conditionRow As DataRow, ByVal prmList As ArrayList)

        With conditionRow

            prmList.Add(MyBase.GetSqlParameter("@NRS_BR_CD", .Item("NRS_BR_CD").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@OUTKA_NO_L", .Item("OUTKA_NO_L").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@GUI_SYS_UPD_DATE", .Item("SYS_UPD_DATE").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@GUI_SYS_UPD_TIME", .Item("SYS_UPD_TIME").ToString(), DBDataType.CHAR))

        End With

    End Sub

    ''' <summary>
    ''' 作業の更新パラメータ
    ''' </summary>
    ''' <param name="conditionRow">DataRow</param>
    ''' <param name="prmList">パラメータ</param>
    ''' <remarks></remarks>
    Private Sub SetSagyoParameter(ByVal conditionRow As DataRow, ByVal prmList As ArrayList)

        With conditionRow

            prmList.Add(MyBase.GetSqlParameter("@NRS_BR_CD", .Item("NRS_BR_CD").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@SAGYO_REC_NO", .Item("SAGYO_REC_NO").ToString(), DBDataType.NVARCHAR))
            prmList.Add(MyBase.GetSqlParameter("@SAGYO_COMP", .Item("SAGYO_COMP").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@SKYU_CHK", .Item("SKYU_CHK").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@SAGYO_SIJI_NO", .Item("SAGYO_SIJI_NO").ToString(), DBDataType.NVARCHAR))
            prmList.Add(MyBase.GetSqlParameter("@INOUTKA_NO_LM", .Item("INOUTKA_NO_LM").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@WH_CD", .Item("WH_CD").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@IOZS_KB", .Item("IOZS_KB").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@SAGYO_CD", .Item("SAGYO_CD").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@SAGYO_NM", .Item("SAGYO_NM").ToString(), DBDataType.NVARCHAR))
            prmList.Add(MyBase.GetSqlParameter("@CUST_CD_L", .Item("CUST_CD_L").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@CUST_CD_M", .Item("CUST_CD_M").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@DEST_CD", .Item("DEST_CD").ToString(), DBDataType.NVARCHAR))
            prmList.Add(MyBase.GetSqlParameter("@DEST_NM", .Item("DEST_NM").ToString(), DBDataType.NVARCHAR))
            prmList.Add(MyBase.GetSqlParameter("@GOODS_CD_NRS", .Item("GOODS_CD_NRS").ToString(), DBDataType.NVARCHAR))
            prmList.Add(MyBase.GetSqlParameter("@GOODS_NM_NRS", .Item("GOODS_NM_NRS").ToString(), DBDataType.NVARCHAR))
            prmList.Add(MyBase.GetSqlParameter("@LOT_NO", .Item("LOT_NO").ToString(), DBDataType.NVARCHAR))
            prmList.Add(MyBase.GetSqlParameter("@INV_TANI", .Item("INV_TANI").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@SAGYO_NB", .Item("SAGYO_NB").ToString(), DBDataType.NUMERIC))
            prmList.Add(MyBase.GetSqlParameter("@SAGYO_UP", .Item("SAGYO_UP").ToString(), DBDataType.NUMERIC))
            prmList.Add(MyBase.GetSqlParameter("@SAGYO_GK", .Item("SAGYO_GK").ToString(), DBDataType.NUMERIC))
            prmList.Add(MyBase.GetSqlParameter("@TAX_KB", .Item("TAX_KB").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@SEIQTO_CD", .Item("SEIQTO_CD").ToString(), DBDataType.NVARCHAR))
            prmList.Add(MyBase.GetSqlParameter("@REMARK_ZAI", .Item("REMARK_ZAI").ToString(), DBDataType.NVARCHAR))
            prmList.Add(MyBase.GetSqlParameter("@REMARK_SKYU", .Item("REMARK_SKYU").ToString(), DBDataType.NVARCHAR))
            prmList.Add(MyBase.GetSqlParameter("@SAGYO_COMP_CD", .Item("SAGYO_COMP_CD").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@SAGYO_COMP_DATE", .Item("SAGYO_COMP_DATE").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@DEST_SAGYO_FLG", .Item("DEST_SAGYO_FLG").ToString(), DBDataType.CHAR))

        End With

    End Sub

#End Region
    '2015.06.22 協立化学　作業料対応 END

#Region "名変入荷作成処理"
    ''' <summary>
    ''' C_OUTKA_L検索
    ''' </summary>
    ''' <param name="ds">DataSet</param>
    ''' <returns>DataSet</returns>
    ''' <remarks>C_OUTKA_L検索SQLの構築・発行</remarks>
    Private Function SelectOutkaLDataMH(ByVal ds As DataSet) As DataSet

        'DataSetのIN情報を取得
        Dim inTbl As DataTable = ds.Tables("LMC010_MEIHEN_INKA_IN")

        'INTableの条件rowの格納
        Me._Row = inTbl.Rows(0)

        'SQL格納変数の初期化
        Me._StrSql = New StringBuilder()

        'SQL作成
        Me._StrSql.Append(LMC010DAC.SQL_SELECT_OUT_L_MH)      'SQL構築

        'スキーマ名設定
        Dim sql As String = Me.SetSchemaNm(Me._StrSql.ToString(), Me._Row.Item("NRS_BR_CD").ToString())

        'パラメータ設定
        Me._SqlPrmList = New ArrayList()
        Call Me.SetOutkaLParameterMH(Me._Row, Me._SqlPrmList)

        'SQL文のコンパイル
        Dim cmd As SqlCommand = MyBase.CreateSqlCommand(sql)

        'パラメータの反映
        For Each obj As Object In Me._SqlPrmList
            cmd.Parameters.Add(obj)
        Next

        MyBase.Logger.WriteSQLLog("LMC010DAC", "SelectOutkaLDataMH", cmd)

        'SQLの発行
        Dim reader As SqlDataReader = MyBase.GetSelectResult(cmd)

        'DataReader→DataTableへの転記
        Dim map As Hashtable = New Hashtable()

        '取得データの格納先をマッピング
        map.Add("NRS_BR_CD", "NRS_BR_CD")
        map.Add("OUTKA_NO_L", "OUTKA_NO_L")
        map.Add("FURI_NO", "FURI_NO")
        map.Add("OUTKA_KB", "OUTKA_KB")
        map.Add("SYUBETU_KB", "SYUBETU_KB")
        map.Add("OUTKA_STATE_KB", "OUTKA_STATE_KB")
        map.Add("OUTKAHOKOKU_YN", "OUTKAHOKOKU_YN")
        map.Add("PICK_KB", "PICK_KB")
        map.Add("DENP_NO", "DENP_NO")
        map.Add("ARR_KANRYO_INFO", "ARR_KANRYO_INFO")
        map.Add("WH_CD", "WH_CD")
        map.Add("OUTKA_PLAN_DATE", "OUTKA_PLAN_DATE")
        map.Add("OUTKO_DATE", "OUTKO_DATE")
        map.Add("ARR_PLAN_DATE", "ARR_PLAN_DATE")
        map.Add("ARR_PLAN_TIME", "ARR_PLAN_TIME")
        map.Add("HOKOKU_DATE", "HOKOKU_DATE")
        map.Add("TOUKI_HOKAN_YN", "TOUKI_HOKAN_YN")
        map.Add("END_DATE", "END_DATE")
        map.Add("CUST_CD_L", "CUST_CD_L")
        map.Add("CUST_CD_M", "CUST_CD_M")
        map.Add("SHIP_CD_L", "SHIP_CD_L")
        map.Add("SHIP_CD_M", "SHIP_CD_M")
        map.Add("DEST_CD", "DEST_CD")
        map.Add("DEST_AD_3", "DEST_AD_3")
        map.Add("DEST_TEL", "DEST_TEL")
        map.Add("NHS_REMARK", "NHS_REMARK")
        map.Add("SP_NHS_KB", "SP_NHS_KB")
        map.Add("COA_YN", "COA_YN")
        map.Add("CUST_ORD_NO", "CUST_ORD_NO")
        map.Add("BUYER_ORD_NO", "BUYER_ORD_NO")
        map.Add("REMARK", "REMARK")
        map.Add("OUTKA_PKG_NB", "OUTKA_PKG_NB")
        map.Add("DENP_YN", "DENP_YN")
        map.Add("PC_KB", "PC_KB")
        map.Add("NIYAKU_YN", "NIYAKU_YN")
        map.Add("DEST_KB", "DEST_KB")
        map.Add("DEST_NM", "DEST_NM")
        map.Add("DEST_AD_1", "DEST_AD_1")
        map.Add("DEST_AD_2", "DEST_AD_2")
        map.Add("ALL_PRINT_FLAG", "ALL_PRINT_FLAG")
        map.Add("NIHUDA_FLAG", "NIHUDA_FLAG")
        map.Add("NHS_FLAG", "NHS_FLAG")
        map.Add("DENP_FLAG", "DENP_FLAG")
        map.Add("COA_FLAG", "COA_FLAG")
        map.Add("HOKOKU_FLAG", "HOKOKU_FLAG")
        map.Add("MATOME_PICK_FLAG", "MATOME_PICK_FLAG")
        map.Add("MATOME_PRINT_DATE", "MATOME_PRINT_DATE")
        map.Add("MATOME_PRINT_TIME", "MATOME_PRINT_TIME")
        map.Add("LAST_PRINT_DATE", "LAST_PRINT_DATE")
        map.Add("LAST_PRINT_TIME", "LAST_PRINT_TIME")
        map.Add("SASZ_USER", "SASZ_USER")
        map.Add("OUTKO_USER", "OUTKO_USER")
        map.Add("KEN_USER", "KEN_USER")
        map.Add("OUTKA_USER", "OUTKA_USER")
        map.Add("HOU_USER", "HOU_USER")
        map.Add("ORDER_TYPE", "ORDER_TYPE")
        map.Add("WH_KENPIN_WK_STATUS", "WH_KENPIN_WK_STATUS")
        map.Add("WH_TAB_YN", "WH_TAB_YN")
        map.Add("SYS_ENT_TIME", "SYS_ENT_TIME")
        map.Add("SYS_ENT_PGID", "SYS_ENT_PGID")
        map.Add("SYS_ENT_USER", "SYS_ENT_USER")
        map.Add("SYS_ENT_DATE", "SYS_ENT_DATE")
        map.Add("SYS_UPD_DATE", "SYS_UPD_DATE")
        map.Add("SYS_UPD_TIME", "SYS_UPD_TIME")
        map.Add("SYS_UPD_PGID", "SYS_UPD_PGID")
        map.Add("SYS_UPD_USER", "SYS_UPD_USER")
        map.Add("SYS_DEL_FLG", "SYS_DEL_FLG")
        ds = MyBase.SetSelectResultToDataSet(map, ds, reader, "LMC010_MEIHEN_OUTKA_L")

        '処理件数の設定
        MyBase.SetResultCount(ds.Tables("LMC010_MEIHEN_OUTKA_L").Rows.Count())
        reader.Close()

        Return ds

    End Function

    ''' <summary>
    ''' C_OUTKA_M検索
    ''' </summary>
    ''' <param name="ds">DataSet</param>
    ''' <returns>DataSet</returns>
    ''' <remarks>C_OUTKA_M検索SQLの構築・発行</remarks>
    Private Function SelectOutkaMDataMH(ByVal ds As DataSet) As DataSet

        'DataSetのIN情報を取得
        Dim inTbl As DataTable = ds.Tables("LMC010_MEIHEN_INKA_IN")

        'INTableの条件rowの格納
        Me._Row = inTbl.Rows(0)

        'SQL格納変数の初期化
        Me._StrSql = New StringBuilder()

        'SQL作成
        Me._StrSql.Append(LMC010DAC.SQL_SELECT_OUT_M_MH)      'SQL構築

        'スキーマ名設定
        Dim sql As String = Me.SetSchemaNm(Me._StrSql.ToString(), Me._Row.Item("NRS_BR_CD").ToString())

        'パラメータ設定
        Me._SqlPrmList = New ArrayList()
        Call Me.SetOutkaMParameterMH(Me._Row, Me._SqlPrmList)


        'SQL文のコンパイル
        Dim cmd As SqlCommand = MyBase.CreateSqlCommand(sql)

        'パラメータの反映
        For Each obj As Object In Me._SqlPrmList
            cmd.Parameters.Add(obj)
        Next

        MyBase.Logger.WriteSQLLog("LMC010DAC", "SelectOutkaMDataMH", cmd)

        'SQLの発行
        Dim reader As SqlDataReader = MyBase.GetSelectResult(cmd)

        'DataReader→DataTableへの転記
        Dim map As Hashtable = New Hashtable()

        '取得データの格納先をマッピング
        map.Add("NRS_BR_CD", "NRS_BR_CD")
        map.Add("OUTKA_NO_L", "OUTKA_NO_L")
        map.Add("OUTKA_NO_M", "OUTKA_NO_M")
        map.Add("EDI_SET_NO", "EDI_SET_NO")
        map.Add("COA_YN", "COA_YN")
        map.Add("CUST_ORD_NO_DTL", "CUST_ORD_NO_DTL")
        map.Add("BUYER_ORD_NO_DTL", "BUYER_ORD_NO_DTL")
        map.Add("GOODS_CD_NRS", "GOODS_CD_NRS")
        map.Add("RSV_NO", "RSV_NO")
        map.Add("LOT_NO", "LOT_NO")
        map.Add("SERIAL_NO", "SERIAL_NO")
        map.Add("ALCTD_KB", "ALCTD_KB")
        map.Add("OUTKA_PKG_NB", "OUTKA_PKG_NB")
        map.Add("OUTKA_HASU", "OUTKA_HASU")
        map.Add("OUTKA_QT", "OUTKA_QT")
        map.Add("OUTKA_TTL_NB", "OUTKA_TTL_NB")
        map.Add("OUTKA_TTL_QT", "OUTKA_TTL_QT")
        map.Add("ALCTD_NB", "ALCTD_NB")
        map.Add("ALCTD_QT", "ALCTD_QT")
        map.Add("BACKLOG_NB", "BACKLOG_NB")
        map.Add("BACKLOG_QT", "BACKLOG_QT")
        map.Add("UNSO_ONDO_KB", "UNSO_ONDO_KB")
        map.Add("IRIME", "IRIME")
        map.Add("IRIME_UT", "IRIME_UT")
        map.Add("OUTKA_M_PKG_NB", "OUTKA_M_PKG_NB")
        map.Add("REMARK", "REMARK")
        map.Add("SIZE_KB", "SIZE_KB")
        map.Add("ZAIKO_KB", "ZAIKO_KB")
        map.Add("SOURCE_CD", "SOURCE_CD")
        map.Add("YELLOW_CARD", "YELLOW_CARD")
        map.Add("GOODS_CD_NRS_FROM", "GOODS_CD_NRS_FROM")
        map.Add("PRINT_SORT", "PRINT_SORT")
        map.Add("SYS_ENT_DATE", "SYS_ENT_DATE")
        map.Add("SYS_ENT_TIME", "SYS_ENT_TIME")
        map.Add("SYS_ENT_PGID", "SYS_ENT_PGID")
        map.Add("SYS_ENT_USER", "SYS_ENT_USER")
        map.Add("SYS_UPD_DATE", "SYS_UPD_DATE")
        map.Add("SYS_UPD_TIME", "SYS_UPD_TIME")
        map.Add("SYS_UPD_PGID", "SYS_UPD_PGID")
        map.Add("SYS_UPD_USER", "SYS_UPD_USER")
        map.Add("SYS_DEL_FLG", "SYS_DEL_FLG")
        map.Add("CD_NRS_TO", "CD_NRS_TO")
        map.Add("GOODS_PKG_NB", "GOODS_PKG_NB")
        map.Add("HOKAN_NIYAKU_CALCULATION", "HOKAN_NIYAKU_CALCULATION")
        '2018/11/01 ADD START 要望番号002161
        map.Add("GOODS_CD_CUST", "GOODS_CD_CUST")
        map.Add("GOODS_NM_1", "GOODS_NM_1")
        '2018/11/01 ADD END 要望番号002161
        ds = MyBase.SetSelectResultToDataSet(map, ds, reader, "LMC010_MEIHEN_OUTKA_M")

        '処理件数の設定
        MyBase.SetResultCount(ds.Tables("LMC010_MEIHEN_OUTKA_M").Rows.Count())
        reader.Close()

        Return ds

    End Function

    ''' <summary>
    ''' C_OUTKA_S検索
    ''' </summary>
    ''' <param name="ds">DataSet</param>
    ''' <returns>DataSet</returns>
    ''' <remarks>C_OUTKA_S検索SQLの構築・発行</remarks>
    Private Function SelectOutkaSDataMH(ByVal ds As DataSet) As DataSet

        'DataSetのIN情報を取得
        Dim inTbl As DataTable = ds.Tables("LMC010_MEIHEN_INKA_IN")

        'INTableの条件rowの格納
        Me._Row = inTbl.Rows(0)

        'SQL格納変数の初期化
        Me._StrSql = New StringBuilder()

        'SQL作成
        Me._StrSql.Append(LMC010DAC.SQL_SELECT_OUT_S_MH)      'SQL構築

        'スキーマ名設定
        Dim sql As String = Me.SetSchemaNm(Me._StrSql.ToString(), Me._Row.Item("NRS_BR_CD").ToString())

        'パラメータ設定
        Me._SqlPrmList = New ArrayList()
        Call Me.SetOutkaSParameterMH(Me._Row, Me._SqlPrmList)


        'SQL文のコンパイル
        Dim cmd As SqlCommand = MyBase.CreateSqlCommand(sql)

        'パラメータの反映
        For Each obj As Object In Me._SqlPrmList
            cmd.Parameters.Add(obj)
        Next

        MyBase.Logger.WriteSQLLog("LMC010DAC", "SelectOutkaSDataMH", cmd)

        'SQLの発行
        Dim reader As SqlDataReader = MyBase.GetSelectResult(cmd)

        'DataReader→DataTableへの転記
        Dim map As Hashtable = New Hashtable()

        '取得データの格納先をマッピング
        map.Add("NRS_BR_CD", "NRS_BR_CD")
        map.Add("OUTKA_NO_L", "OUTKA_NO_L")
        map.Add("OUTKA_NO_M", "OUTKA_NO_M")
        map.Add("OUTKA_NO_S", "OUTKA_NO_S")
        map.Add("TOU_NO", "TOU_NO")
        map.Add("SITU_NO", "SITU_NO")
        map.Add("ZONE_CD", "ZONE_CD")
        map.Add("LOCA", "LOCA")
        map.Add("LOT_NO", "LOT_NO")
        map.Add("SERIAL_NO", "SERIAL_NO")
        map.Add("OUTKA_TTL_NB", "OUTKA_TTL_NB")
        map.Add("OUTKA_TTL_QT", "OUTKA_TTL_QT")
        map.Add("ZAI_REC_NO", "ZAI_REC_NO")
        map.Add("INKA_NO_L", "INKA_NO_L")
        map.Add("INKA_NO_M", "INKA_NO_M")
        map.Add("INKA_NO_S", "INKA_NO_S")
        map.Add("ZAI_UPD_FLAG", "ZAI_UPD_FLAG")
        map.Add("ALCTD_CAN_NB", "ALCTD_CAN_NB")
        map.Add("ALCTD_NB", "ALCTD_NB")
        map.Add("ALCTD_CAN_QT", "ALCTD_CAN_QT")
        map.Add("ALCTD_QT", "ALCTD_QT")
        map.Add("IRIME", "IRIME")
        map.Add("BETU_WT", "BETU_WT")
        map.Add("COA_FLAG", "COA_FLAG")
        map.Add("REMARK", "REMARK")
        map.Add("SMPL_FLAG", "SMPL_FLAG")
        map.Add("REC_NO", "REC_NO")
        map.Add("SYS_ENT_DATE", "SYS_ENT_DATE")
        map.Add("SYS_ENT_TIME", "SYS_ENT_TIME")
        map.Add("SYS_ENT_PGID", "SYS_ENT_PGID")
        map.Add("SYS_ENT_USER", "SYS_ENT_USER")
        map.Add("SYS_UPD_DATE", "SYS_UPD_DATE")
        map.Add("SYS_UPD_TIME", "SYS_UPD_TIME")
        map.Add("SYS_UPD_PGID", "SYS_UPD_PGID")
        map.Add("SYS_UPD_USER", "SYS_UPD_USER")
        map.Add("SYS_DEL_FLG", "SYS_DEL_FLG")
        map.Add("SPD_KB", "SPD_KB")
        map.Add("OFB_KB", "OFB_KB")
        '2018/11/01 ADD START 要望番号002824
        map.Add("ALLOC_PRIORITY", "ALLOC_PRIORITY")
        map.Add("GOODS_COND_KB_1", "GOODS_COND_KB_1")
        map.Add("GOODS_COND_KB_2", "GOODS_COND_KB_2")
        map.Add("GOODS_COND_KB_3", "GOODS_COND_KB_3")
        map.Add("REMARK_OUT", "REMARK_OUT")
        map.Add("LT_DATE", "LT_DATE")
        map.Add("GOODS_CRT_DATE", "GOODS_CRT_DATE")
        map.Add("DEST_CD_P", "DEST_CD_P")
        map.Add("ZAI_REMARK", "ZAI_REMARK")
        '2018/11/01 ADD END 要望番号002824

        ds = MyBase.SetSelectResultToDataSet(map, ds, reader, "LMC010_MEIHEN_OUTKA_S")

        '処理件数の設定
        MyBase.SetResultCount(ds.Tables("LMC010_MEIHEN_OUTKA_S").Rows.Count())
        reader.Close()

        Return ds

    End Function

    ''' <summary>
    ''' C_OUTKA_L検索(既に登録されているか件数取得)
    ''' </summary>
    ''' <param name="ds">DataSet</param>
    ''' <returns>DataSet</returns>
    ''' <remarks>C_OUTKA_L検索SQLの構築・発行</remarks>
    Private Function SelectInkaLCountMH(ByVal ds As DataSet) As DataSet

        'DataSetのIN情報を取得
        Dim inTbl As DataTable = ds.Tables("LMC010_MEIHEN_INKA_IN")
        Dim outkaLDr As DataRow = ds.Tables("LMC010_MEIHEN_OUTKA_L").Rows(0)

        'INTableの条件rowの格納
        Me._Row = inTbl.Rows(0)

        'SQL格納変数の初期化
        Me._StrSql = New StringBuilder()

        'SQL作成
        Me._StrSql.Append(LMC010DAC.SQL_SELECT_COUNT_INKA_L_MH)      'SQL構築

        'スキーマ名設定
        Dim sql As String = Me.SetSchemaNm(Me._StrSql.ToString(), Me._Row.Item("NRS_BR_CD").ToString())

        'パラメータ設定
        Me._SqlPrmList = New ArrayList()
        Call Me.SetInkaLCountParameterMH(Me._Row, outkaLDr, Me._SqlPrmList)

        'SQL文のコンパイル
        Dim cmd As SqlCommand = MyBase.CreateSqlCommand(sql)

        'パラメータの反映
        For Each obj As Object In Me._SqlPrmList
            cmd.Parameters.Add(obj)
        Next

        MyBase.Logger.WriteSQLLog("LMC010DAC", "SelectInkaLCountMH", cmd)

        'SQLの発行
        Dim reader As SqlDataReader = MyBase.GetSelectResult(cmd)

        '処理件数の設定
        reader.Read()
        MyBase.SetResultCount(Convert.ToInt32(reader("SELECT_CNT")))

        reader.Close()

        Return ds

    End Function

    ''' <summary>
    ''' B_INKA_L新規登録
    ''' </summary>
    ''' <param name="ds">DataSet</param>
    ''' <returns>DataSet</returns>
    ''' <remarks>B_INKA_L新規登録SQLの構築・発行</remarks>
    Private Function InsertInkaLDataMH(ByVal ds As DataSet) As DataSet

        'DataSetのIN情報を取得
        Dim inTbl As DataTable = ds.Tables("LMC010_MEIHEN_INKA_IN")
        'INTableの条件rowの格納
        Me._Row = inTbl.Rows(0)
        'SQLパラメータ初期化
        Me._SqlPrmList = New ArrayList()

        'Insert先の営業所コードをセット
        Dim nrsBrCdTo As String = inTbl.Rows(0).Item("NRS_BR_CD").ToString()

        'SQL文のコンパイル
        Dim cmd As SqlCommand = MyBase.CreateSqlCommand(Me.SetSchemaNm(LMC010DAC.SQL_INSERT_INKA_L_MH, nrsBrCdTo))

        'パラメータの初期化
        cmd.Parameters.Clear()

        'SQLパラメータ初期化
        Me._SqlPrmList = New ArrayList()

        'パラメータ設定
        Call Me.SetParamCommonSystemIns()
        Call Me.SetInkaLInsertParameterMH(ds.Tables("LMC010_MEIHEN_INKA_L").Rows(0))

        'パラメータの反映
        For Each obj As Object In Me._SqlPrmList
            cmd.Parameters.Add(obj)
        Next

        MyBase.Logger.WriteSQLLog("LMC010DAC", "InsertInkaLDataMH", cmd)

        'SQLの発行
        MyBase.GetInsertResult(cmd)

        Return ds

    End Function

    ''' <summary>
    ''' B_INKA_M新規登録
    ''' </summary>
    ''' <param name="ds">DataSet</param>
    ''' <returns>DataSet</returns>
    ''' <remarks>B_INKA_S新規登録SQLの構築・発行</remarks>
    Private Function InsertInkaMDataMH(ByVal ds As DataSet) As DataSet

        'DataSetのIN情報を取得
        Dim inTbl As DataTable = ds.Tables("LMC010_MEIHEN_INKA_IN")
        'INTableの条件rowの格納
        Me._Row = inTbl.Rows(0)
        'SQLパラメータ初期化
        Me._SqlPrmList = New ArrayList()

        'Insert先の営業所コードをセット
        Dim nrsBrCdTo As String = inTbl.Rows(0).Item("NRS_BR_CD").ToString()

        'SQL文のコンパイル
        Dim cmd As SqlCommand = MyBase.CreateSqlCommand(Me.SetSchemaNm(LMC010DAC.SQL_INSERT_INKA_M_MH, nrsBrCdTo))

        Dim max As Integer = ds.Tables("LMC010_MEIHEN_INKA_M").Rows.Count - 1

        For i As Integer = 0 To max
            'パラメータの初期化
            cmd.Parameters.Clear()

            'SQLパラメータ初期化
            Me._SqlPrmList = New ArrayList()

            'パラメータ設定
            Call Me.SetParamCommonSystemIns()
            Call Me.SetInkaMInsertParameterMH(ds.Tables("LMC010_MEIHEN_INKA_M").Rows(i))

            'パラメータの反映
            For Each obj As Object In Me._SqlPrmList
                cmd.Parameters.Add(obj)
            Next

            MyBase.Logger.WriteSQLLog("LMC010DAC", "InsertInkaMDataMH", cmd)

            'SQLの発行
            MyBase.GetInsertResult(cmd)
        Next

        Return ds

    End Function

    ''' <summary>
    ''' B_INKA_S新規登録
    ''' </summary>
    ''' <param name="ds">DataSet</param>
    ''' <returns>DataSet</returns>
    ''' <remarks>B_INKA_S新規登録SQLの構築・発行</remarks>
    Private Function InsertInkaSDataMH(ByVal ds As DataSet) As DataSet

        'DataSetのIN情報を取得
        Dim inTbl As DataTable = ds.Tables("LMC010_MEIHEN_INKA_IN")
        'INTableの条件rowの格納
        Me._Row = inTbl.Rows(0)
        'SQLパラメータ初期化
        Me._SqlPrmList = New ArrayList()

        'Insert先の営業所コードをセット
        Dim nrsBrCdTo As String = inTbl.Rows(0).Item("NRS_BR_CD").ToString()

        'SQL文のコンパイル
        Dim cmd As SqlCommand = MyBase.CreateSqlCommand(Me.SetSchemaNm(LMC010DAC.SQL_INSERT_INKA_S_MH, nrsBrCdTo))

        Dim max As Integer = ds.Tables("LMC010_MEIHEN_INKA_S").Rows.Count - 1

        For i As Integer = 0 To max
            'パラメータの初期化
            cmd.Parameters.Clear()

            'SQLパラメータ初期化
            Me._SqlPrmList = New ArrayList()

            'パラメータ設定
            Call Me.SetParamCommonSystemIns()
            Call Me.SetInkaSInsertParameterMH(ds.Tables("LMC010_MEIHEN_INKA_S").Rows(i))

            'パラメータの反映
            For Each obj As Object In Me._SqlPrmList
                cmd.Parameters.Add(obj)
            Next

            MyBase.Logger.WriteSQLLog("LMC010DAC", "InsertInkaSDataMH", cmd)

            'SQLの発行
            MyBase.GetInsertResult(cmd)
        Next

        Return ds

    End Function

    ''' <summary>
    ''' D_ZAI_TRS新規登録
    ''' </summary>
    ''' <param name="ds">DataSet</param>
    ''' <returns>DataSet</returns>
    ''' <remarks>D_ZAI_TRS新規登録SQLの構築・発行</remarks>
    Private Function InsertZaiTrsMH(ByVal ds As DataSet) As DataSet

        'DataSetのIN情報を取得
        Dim inTbl As DataTable = ds.Tables("LMC010_MEIHEN_INKA_IN")
        'INTableの条件rowの格納
        Me._Row = inTbl.Rows(0)
        'SQLパラメータ初期化
        Me._SqlPrmList = New ArrayList()

        'Insert先の営業所コードをセット
        Dim nrsBrCdTo As String = inTbl.Rows(0).Item("NRS_BR_CD").ToString()

        'SQL文のコンパイル
        Dim cmd As SqlCommand = MyBase.CreateSqlCommand(Me.SetSchemaNm(LMC010DAC.SQL_INSERT_ZAI_TRS_MH, nrsBrCdTo))

        Dim max As Integer = ds.Tables("LMC010_MEIHEN_ZAI_TRS").Rows.Count - 1

        For i As Integer = 0 To max
            'パラメータの初期化
            cmd.Parameters.Clear()

            'SQLパラメータ初期化
            Me._SqlPrmList = New ArrayList()

            'パラメータ設定
            Call Me.SetParamCommonSystemIns()
            Call Me.SetZaiTrsInsertParameterMH(ds.Tables("LMC010_MEIHEN_ZAI_TRS").Rows(i))

            'パラメータの反映
            For Each obj As Object In Me._SqlPrmList
                cmd.Parameters.Add(obj)
            Next

            MyBase.Logger.WriteSQLLog("LMC010DAC", "InsertZaiTrsMH", cmd)

            'SQLの発行
            MyBase.GetInsertResult(cmd)
        Next

        Return ds

    End Function

    ''' <summary>
    ''' 出荷(大)パラメータ
    ''' </summary>
    ''' <param name="conditionRow">DataRow</param>
    ''' <param name="prmList">パラメータ</param>
    ''' <remarks></remarks>
    Private Sub SetOutkaLParameterMH(ByVal conditionRow As DataRow, ByVal prmList As ArrayList)

        With conditionRow

            prmList.Add(MyBase.GetSqlParameter("@NRS_BR_CD", .Item("NRS_BR_CD").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@OUTKA_NO_L", .Item("OUTKA_NO_L").ToString(), DBDataType.CHAR))

        End With

    End Sub

    ''' <summary>
    ''' 出荷(中)パラメータ
    ''' </summary>
    ''' <param name="conditionRow">DataRow</param>
    ''' <param name="prmList">パラメータ</param>
    ''' <remarks></remarks>
    Private Sub SetOutkaMParameterMH(ByVal conditionRow As DataRow, ByVal prmList As ArrayList)

        With conditionRow

            prmList.Add(MyBase.GetSqlParameter("@NRS_BR_CD", .Item("NRS_BR_CD").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@OUTKA_NO_L", .Item("OUTKA_NO_L").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@CUST_CD_L", .Item("CUST_CD_L").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@CUST_CD_M", .Item("CUST_CD_M").ToString(), DBDataType.CHAR))

        End With

    End Sub

    ''' <summary>
    ''' 出荷(小)パラメータ
    ''' </summary>
    ''' <param name="conditionRow">DataRow</param>
    ''' <param name="prmList">パラメータ</param>
    ''' <remarks></remarks>
    Private Sub SetOutkaSParameterMH(ByVal conditionRow As DataRow, ByVal prmList As ArrayList)

        With conditionRow

            prmList.Add(MyBase.GetSqlParameter("@NRS_BR_CD", .Item("NRS_BR_CD").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@OUTKA_NO_L", .Item("OUTKA_NO_L").ToString(), DBDataType.CHAR))

        End With

    End Sub

    ''' <summary>
    ''' INKA_L COUNTパラメータ
    ''' </summary>
    ''' <param name="conditionRow">DataRow</param>
    ''' <param name="prmList">パラメータ</param>
    ''' <remarks></remarks>
    Private Sub SetInkaLCountParameterMH(ByVal conditionRow As DataRow, ByVal outkaLDr As DataRow, ByVal prmList As ArrayList)

        prmList.Add(MyBase.GetSqlParameter("@NRS_BR_CD", conditionRow.Item("NRS_BR_CD").ToString(), DBDataType.CHAR))
        prmList.Add(MyBase.GetSqlParameter("@CUST_CD_L", conditionRow.Item("CUST_CD_L").ToString(), DBDataType.CHAR))
        prmList.Add(MyBase.GetSqlParameter("@CUST_CD_M", conditionRow.Item("CUST_CD_M").ToString(), DBDataType.CHAR))
        prmList.Add(MyBase.GetSqlParameter("@CUST_ORD_NO", outkaLDr.Item("CUST_ORD_NO").ToString(), DBDataType.CHAR))
        prmList.Add(MyBase.GetSqlParameter("@OUTKO_DATE", outkaLDr.Item("OUTKO_DATE").ToString(), DBDataType.CHAR))

    End Sub

    ''' <summary>
    ''' INKA_Lの登録パラメータ設定
    ''' </summary>
    ''' <remarks></remarks>
    Private Sub SetInkaLInsertParameterMH(ByVal row As DataRow)

        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@NRS_BR_CD", Me.NullConvertString(row.Item("NRS_BR_CD")), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@INKA_NO_L", Me.NullConvertString(row.Item("INKA_NO_L")), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@INKA_TP", Me.NullConvertString(row.Item("INKA_TP")), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@INKA_KB", Me.NullConvertString(row.Item("INKA_KB")), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@INKA_STATE_KB", Me.NullConvertString(row.Item("INKA_STATE_KB")), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@INKA_DATE", Me.NullConvertString(row.Item("INKA_DATE")), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@WH_CD", Me.NullConvertString(row.Item("WH_CD")), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@CUST_CD_L", Me.NullConvertString(row.Item("CUST_CD_L")), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@CUST_CD_M", Me.NullConvertString(row.Item("CUST_CD_M")), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@INKA_TTL_NB", Me.NullConvertZero(row.Item("INKA_TTL_NB")), DBDataType.NUMERIC))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@BUYER_ORD_NO_L", Me.NullConvertString(row.Item("BUYER_ORD_NO_L")), DBDataType.NVARCHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@OUTKA_FROM_ORD_NO_L", Me.NullConvertString(row.Item("OUTKA_FROM_ORD_NO_L")), DBDataType.NVARCHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@TOUKI_HOKAN_YN", Me.NullConvertString(row.Item("TOUKI_HOKAN_YN")), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@HOKAN_YN", Me.NullConvertString(row.Item("HOKAN_YN")), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@HOKAN_STR_DATE", Me.NullConvertString(row.Item("HOKAN_STR_DATE")), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@NIYAKU_YN", Me.NullConvertString(row.Item("NIYAKU_YN")), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@TAX_KB", Me.NullConvertString(row.Item("TAX_KB")), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@UNCHIN_TP", Me.NullConvertString(row.Item("UNCHIN_TP")), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@WH_KENPIN_WK_STATUS", Me.NullConvertString(row.Item("WH_KENPIN_WK_STATUS")), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@WH_TAB_STATUS", Me.NullConvertString(row.Item("WH_TAB_STATUS")), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@WH_TAB_YN", Me.NullConvertString(row.Item("WH_TAB_YN")), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@WH_TAB_IMP_YN", Me.NullConvertString(row.Item("WH_TAB_IMP_YN")), DBDataType.CHAR))

    End Sub

    ''' <summary>
    ''' INKA_Mの登録パラメータ設定
    ''' </summary>
    ''' <remarks></remarks>
    Private Sub SetInkaMInsertParameterMH(ByVal row As DataRow)

        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@NRS_BR_CD", Me.NullConvertString(row.Item("NRS_BR_CD")), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@INKA_NO_L", Me.NullConvertString(row.Item("INKA_NO_L")), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@INKA_NO_M", Me.NullConvertString(row.Item("INKA_NO_M")), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@GOODS_CD_NRS", Me.NullConvertString(row.Item("GOODS_CD_NRS")), DBDataType.CHAR))

    End Sub

    ''' <summary>
    ''' INKA_Sの登録パラメータ設定
    ''' </summary>
    ''' <remarks></remarks>
    Private Sub SetInkaSInsertParameterMH(ByVal row As DataRow)

        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@NRS_BR_CD", Me.NullConvertString(row.Item("NRS_BR_CD")), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@INKA_NO_L", Me.NullConvertString(row.Item("INKA_NO_L")), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@INKA_NO_M", Me.NullConvertString(row.Item("INKA_NO_M")), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@INKA_NO_S", Me.NullConvertString(row.Item("INKA_NO_S")), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@ZAI_REC_NO", Me.NullConvertString(row.Item("ZAI_REC_NO")), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@LOT_NO", Me.NullConvertString(row.Item("LOT_NO")), DBDataType.NVARCHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@LOCA", Me.NullConvertString(row.Item("LOCA")), DBDataType.NVARCHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@TOU_NO", Me.NullConvertString(row.Item("TOU_NO")), DBDataType.NVARCHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@SITU_NO", Me.NullConvertString(row.Item("SITU_NO")), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@ZONE_CD", Me.NullConvertString(row.Item("ZONE_CD")), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@KONSU", Me.NullConvertZero(row.Item("KONSU")), DBDataType.NUMERIC))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@HASU", Me.NullConvertZero(row.Item("HASU")), DBDataType.NUMERIC))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@IRIME", Me.NullConvertZero(row.Item("IRIME")), DBDataType.NUMERIC))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@BETU_WT", Me.NullConvertZero(row.Item("BETU_WT")), DBDataType.NUMERIC))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@SERIAL_NO", Me.NullConvertString(row.Item("SERIAL_NO")), DBDataType.NVARCHAR))
        '2018/11/01 ADD START 要望管理002824
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@GOODS_CRT_DATE", Me.NullConvertString(row.Item("GOODS_CRT_DATE")), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@LT_DATE", Me.NullConvertString(row.Item("LT_DATE")), DBDataType.CHAR))
        '2018/11/01 ADD END 要望管理002824
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@SPD_KB", Me.NullConvertString(row.Item("SPD_KB")), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@OFB_KB", Me.NullConvertString(row.Item("OFB_KB")), DBDataType.CHAR))
        '2018/11/01 ADD START 要望管理002824
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@REMARK", Me.NullConvertString(row.Item("REMARK")), DBDataType.NVARCHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@ALLOC_PRIORITY", Me.NullConvertString(row.Item("ALLOC_PRIORITY")), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@REMARK_OUT", Me.NullConvertString(row.Item("REMARK_OUT")), DBDataType.NVARCHAR))
        '2018/11/01 ADD END 要望管理002824

    End Sub

    ''' <summary>
    ''' ZAI_TRSの登録パラメータ設定
    ''' </summary>
    ''' <remarks></remarks>
    Private Sub SetZaiTrsInsertParameterMH(ByVal row As DataRow)

        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@NRS_BR_CD", Me.NullConvertString(row.Item("NRS_BR_CD")), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@ZAI_REC_NO", Me.NullConvertString(row.Item("ZAI_REC_NO")), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@WH_CD", Me.NullConvertString(row.Item("WH_CD")), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@TOU_NO", Me.NullConvertString(row.Item("TOU_NO")), DBDataType.NVARCHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@SITU_NO", Me.NullConvertString(row.Item("SITU_NO")), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@ZONE_CD", Me.NullConvertString(row.Item("ZONE_CD")), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@LOCA", Me.NullConvertString(row.Item("LOCA")), DBDataType.NVARCHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@LOT_NO", Me.NullConvertString(row.Item("LOT_NO")), DBDataType.NVARCHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@CUST_CD_L", Me.NullConvertString(row.Item("CUST_CD_L")), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@CUST_CD_M", Me.NullConvertString(row.Item("CUST_CD_M")), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@GOODS_CD_NRS", Me.NullConvertString(row.Item("GOODS_CD_NRS")), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@GOODS_KANRI_NO", Me.NullConvertString(row.Item("GOODS_KANRI_NO")), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@INKA_NO_L", Me.NullConvertString(row.Item("INKA_NO_L")), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@INKA_NO_M", Me.NullConvertString(row.Item("INKA_NO_M")), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@INKA_NO_S", Me.NullConvertString(row.Item("INKA_NO_S")), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@ALLOC_PRIORITY", Me.NullConvertString(row.Item("ALLOC_PRIORITY")), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@RSV_NO", Me.NullConvertString(row.Item("RSV_NO")), DBDataType.NVARCHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@SERIAL_NO", Me.NullConvertString(row.Item("SERIAL_NO")), DBDataType.NVARCHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@HOKAN_YN", Me.NullConvertString(row.Item("HOKAN_YN")), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@TAX_KB", Me.NullConvertString(row.Item("TAX_KB")), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@GOODS_COND_KB_1", Me.NullConvertString(row.Item("GOODS_COND_KB_1")), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@GOODS_COND_KB_2", Me.NullConvertString(row.Item("GOODS_COND_KB_2")), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@GOODS_COND_KB_3", Me.NullConvertString(row.Item("GOODS_COND_KB_3")), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@OFB_KB", Me.NullConvertString(row.Item("OFB_KB")), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@SPD_KB", Me.NullConvertString(row.Item("SPD_KB")), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@REMARK_OUT", Me.NullConvertString(row.Item("REMARK_OUT")), DBDataType.NVARCHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@PORA_ZAI_NB", Me.NullConvertZero(row.Item("PORA_ZAI_NB")), DBDataType.NUMERIC))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@ALCTD_NB", Me.NullConvertZero(row.Item("ALCTD_NB")), DBDataType.NUMERIC))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@ALLOC_CAN_NB", Me.NullConvertZero(row.Item("ALLOC_CAN_NB")), DBDataType.NUMERIC))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@IRIME", Me.NullConvertZero(row.Item("IRIME")), DBDataType.NUMERIC))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@PORA_ZAI_QT", Me.NullConvertZero(row.Item("PORA_ZAI_QT")), DBDataType.NUMERIC))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@ALCTD_QT", Me.NullConvertZero(row.Item("ALCTD_QT")), DBDataType.NUMERIC))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@ALLOC_CAN_QT", Me.NullConvertZero(row.Item("ALLOC_CAN_QT")), DBDataType.NUMERIC))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@INKO_DATE", Me.NullConvertString(row.Item("INKO_DATE")), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@INKO_PLAN_DATE", Me.NullConvertString(row.Item("INKO_PLAN_DATE")), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@ZERO_FLAG", Me.NullConvertString(row.Item("ZERO_FLAG")), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@LT_DATE", Me.NullConvertString(row.Item("LT_DATE")), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@GOODS_CRT_DATE", Me.NullConvertString(row.Item("GOODS_CRT_DATE")), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@DEST_CD_P", Me.NullConvertString(row.Item("DEST_CD_P")), DBDataType.NVARCHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@REMARK", Me.NullConvertString(row.Item("REMARK")), DBDataType.NVARCHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@SMPL_FLAG", Me.NullConvertString(row.Item("SMPL_FLAG")), DBDataType.CHAR))

    End Sub

#End Region

#Region "言語取得"
    '20160614 tsunehira add start
    ''' <summary>
    ''' 言語の取得(区分マスタの区分項目)
    ''' </summary>
    ''' <param name="ds">DataSet</param>
    ''' <returns></returns>
    ''' <remarks></remarks>
    Private Function SelectLangSet(ByVal ds As DataSet) As String

        'DataSetのIN情報を取得
        Dim inTbl As DataTable
        inTbl = ds.Tables("LMC010IN")

        'INTableの条件rowの格納
        Me._Row = inTbl.Rows(0)

        'SQL格納変数の初期化
        Me._StrSql = New StringBuilder()
        'SQLパラメータ初期化
        Me._SqlPrmList = New ArrayList()
        'SQL作成

        'SQL構築
        Me._StrSql.AppendLine("SELECT                                    ")
        Me._StrSql.AppendLine(" CASE WHEN KBN_NM1 = ''    THEN 'KBN_NM1' ")
        Me._StrSql.AppendLine("      WHEN KBN_NM1 IS NULL THEN 'KBN_NM1' ")
        Me._StrSql.AppendLine("      ELSE KBN_NM1 END      AS KBN_NM     ")
        Me._StrSql.AppendLine("FROM $LM_MST$..Z_KBN                      ")
        Me._StrSql.AppendLine("WHERE KBN_GROUP_CD = 'K025'               ")
        Me._StrSql.AppendLine("  AND RIGHT(KBN_CD,1 ) = @LANG            ")
        Me._StrSql.AppendLine("  AND SYS_DEL_FLG  = '0'                  ")

        'SQL文のコンパイル
        Dim cmd As SqlCommand = MyBase.CreateSqlCommand(Me.SetSchemaNm(Me._StrSql.ToString(), Me._Row.Item("NRS_BR_CD").ToString()))

        Me._SqlPrmList.Add(GetSqlParameter("@LANG", Me._Row.Item("LANG_FLG").ToString()))

        'パラメータの反映
        For Each obj As Object In Me._SqlPrmList
            cmd.Parameters.Add(obj)
        Next

        MyBase.Logger.WriteSQLLog("LMC010DAC", "SelectLangset", cmd)

        'SQLの発行
        Dim reader As SqlDataReader = MyBase.GetSelectResult(cmd)

        Dim str As String = "KBN_NM1"

        If reader.Read() = True Then
            str = Convert.ToString(reader("KBN_NM"))
        End If
        reader.Close()

        Return str

    End Function
    '20160614 tsunehira add End
#End Region

#Region "タブレット対応"

    ''' <summary>
    ''' 営業所がタブレット対応かどうかを判定
    ''' </summary>
    ''' <param name="ds">DataSet</param>
    ''' <returns>DataSet</returns>
    ''' <remarks>営業所がタブレット対応かどうかを判定SQLの構築・発行</remarks>
    Private Function IsWhTabNrsBrCd(ByVal ds As DataSet) As DataSet

        'DataSetのIN情報を取得
        Dim inTbl As DataTable = ds.Tables("LMC010_TABLET_IN")

        'INTableの条件rowの格納
        Me._Row = inTbl.Rows(0)

        'SQL格納変数の初期化
        Me._StrSql = New StringBuilder()

        'SQL作成
        Me._StrSql.Append(LMC010DAC.SQL_IS_WH_TAN_NRS_BR_CD)      'SQL構築

        'スキーマ名設定
        Dim sql As String = Me.SetSchemaNm(Me._StrSql.ToString(), Me._Row.Item("NRS_BR_CD").ToString())

        'パラメータ設定
        Me._SqlPrmList = New ArrayList()
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@NRS_BR_CD", Me._Row.Item("NRS_BR_CD").ToString(), DBDataType.CHAR))

        'SQL文のコンパイル
        Dim cmd As SqlCommand = MyBase.CreateSqlCommand(sql)

        'パラメータの反映
        For Each obj As Object In Me._SqlPrmList
            cmd.Parameters.Add(obj)
        Next

        MyBase.Logger.WriteSQLLog("LMC010DAC", "IsWhTabNrsBrCd", cmd)

        'SQLの発行
        Dim reader As SqlDataReader = MyBase.GetSelectResult(cmd)

        reader.Read()

        '処理件数の設定
        MyBase.SetResultCount(Convert.ToInt32(reader("CNT").ToString()))

        reader.Close()

        Return ds

    End Function

#End Region

#Region "SQL"

    ''' <summary>
    ''' スキーマ名称設定
    ''' </summary>
    ''' <remarks></remarks>
    Private Function SetSchemaNm(ByVal sql As String, ByVal brCd As String) As String

        'トラン系スキーマ名設定
        sql = sql.Replace("$LM_TRN$", MyBase.GetDatabaseName(brCd, DBKbn.TRN))

        'マスタ系スキーマ名設定
        sql = sql.Replace("$LM_MST$", MyBase.GetDatabaseName(brCd, DBKbn.MST))

        Return sql

    End Function

    '20160615 tsunehira add start
    ''' <summary>
    ''' 区分項目設定
    ''' </summary>
    ''' <remarks></remarks>
    Private Function SetKbnNm(ByVal sql As String, ByVal kbnNm As String) As String

        '区分項目変換設定
        sql = sql.Replace("#KBN#", kbnNm)

        Return sql

    End Function
    '20160615 tsunehira add end


    ''' <summary>
    '''  パラメータ設定モジュール（運送会社マスタ・存在チェック）
    ''' </summary>
    ''' <remarks>初期出荷マスタ検索用SQLの構築</remarks>
    Private Sub setSQLSelectExists()

        'SQLパラメータ初期化
        Me._SqlPrmList = New ArrayList()

        'パラメータ設定
        'Me._SqlPrmList.Add(MyBase.GetSqlParameter("@NRS_BR_CD", Me._Row("NRS_BR_CD"), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@NRS_BR_CD", Base.LMUserInfoManager.GetNrsBrCd(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@UNSOCO_CD", Me._Row("UNSOCO_CD"), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@UNSOCO_BR_CD", Me._Row("UNSOCO_BR_CD"), DBDataType.CHAR))

    End Sub

    ''' <summary>
    '''  パラメータ設定モジュール（出荷Mテーブル検索）
    ''' </summary>
    ''' <remarks>初期出荷マスタ検索用SQLの構築</remarks>
    Private Sub setSQLSelectOutkaM()

        'SQLパラメータ初期化
        Me._SqlPrmList = New ArrayList()

        'パラメータ設定
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@NRS_BR_CD", Me._Row("NRS_BR_CD"), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@OUTKA_NO_L", Me._Row("OUTKA_NO_L"), DBDataType.CHAR))

    End Sub

    ''' <summary>
    '''  パラメータ設定モジュール（出荷Mテーブル検索）
    ''' </summary>
    ''' <remarks>初期出荷マスタ検索用SQLの構築</remarks>
    Private Sub setSQLSelectBunsekiOutkaM()

        'SQLパラメータ初期化
        Me._SqlPrmList = New ArrayList()

        'パラメータ設定
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@NRS_BR_CD", Me._Row("NRS_BR_CD"), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@OUTKA_NO_L", Me._Row("OUTKA_NO_L"), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@ROW_NO", Me._Row("ROW_NO"), DBDataType.CHAR))

    End Sub

    ''' <summary>
    '''  パラメータ設定モジュール（出荷Mテーブル検索）
    ''' </summary>
    ''' <remarks>初期出荷マスタ検索用SQLの構築</remarks>
    Private Sub setSQLSelectYCardOutkaM()

        'SQLパラメータ初期化
        Me._SqlPrmList = New ArrayList()

        'パラメータ設定
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@NRS_BR_CD", Me._Row("NRS_BR_CD"), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@OUTKA_NO_L", Me._Row("OUTKA_NO_L"), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@ROW_NO", Me._Row("ROW_NO"), DBDataType.CHAR))

    End Sub

    ''' <summary>
    ''' OUTKA_Mの登録パラメータ設定
    ''' </summary>
    ''' <remarks></remarks>
    Private Sub SetOutkaMComParameter()

        'SQLパラメータ初期化
        Me._SqlPrmList = New ArrayList()

        With Me._Row

            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@NRS_BR_CD", .Item("NRS_BR_CD").ToString(), DBDataType.CHAR))
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@OUTKA_NO_L", .Item("OUTKA_NO_L").ToString(), DBDataType.CHAR))
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@OUTKA_NO_M", .Item("OUTKA_NO_M").ToString(), DBDataType.CHAR))
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@ALCTD_NB", Me.FormatNumValue(.Item("ALCTD_NB").ToString()), DBDataType.NUMERIC))
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@ALCTD_QT", Me.FormatNumValue(.Item("ALCTD_QT").ToString()), DBDataType.NUMERIC))
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@BACKLOG_NB", Me.FormatNumValue(.Item("BACKLOG_NB").ToString()), DBDataType.NUMERIC))
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@BACKLOG_QT", Me.FormatNumValue(.Item("BACKLOG_QT").ToString()), DBDataType.NUMERIC))
            'START YANAI 20110914 一括引当対応
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@OUTKA_M_PKG_NB", Me.FormatNumValue(.Item("OUTKA_M_PKG_NB").ToString()), DBDataType.NUMERIC))
            'END YANAI 20110914 一括引当対応

        End With

    End Sub

    ''' <summary>
    ''' OUTKA_Sの登録パラメータ設定
    ''' </summary>
    ''' <remarks></remarks>
    Private Sub SetOutkaSComParameter()

        'SQLパラメータ初期化
        Me._SqlPrmList = New ArrayList()

        With Me._Row

            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@NRS_BR_CD", .Item("NRS_BR_CD").ToString(), DBDataType.CHAR))
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@OUTKA_NO_L", .Item("OUTKA_NO_L").ToString(), DBDataType.CHAR))
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@OUTKA_NO_M", .Item("OUTKA_NO_M").ToString(), DBDataType.CHAR))
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@OUTKA_NO_S", .Item("OUTKA_NO_S").ToString(), DBDataType.CHAR))
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@TOU_NO", .Item("TOU_NO").ToString(), DBDataType.NVARCHAR))
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@SITU_NO", .Item("SITU_NO").ToString(), DBDataType.CHAR))
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@ZONE_CD", .Item("ZONE_CD").ToString(), DBDataType.CHAR))
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@LOCA", .Item("LOCA").ToString(), DBDataType.NVARCHAR))
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@LOT_NO", .Item("LOT_NO").ToString(), DBDataType.NVARCHAR))
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@SERIAL_NO", .Item("SERIAL_NO").ToString(), DBDataType.NVARCHAR))
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@OUTKA_TTL_NB", .Item("OUTKA_TTL_NB").ToString(), DBDataType.NUMERIC))
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@OUTKA_TTL_QT", .Item("OUTKA_TTL_QT").ToString(), DBDataType.NUMERIC))
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@ZAI_REC_NO", .Item("ZAI_REC_NO").ToString(), DBDataType.CHAR))
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@INKA_NO_L", .Item("INKA_NO_L").ToString(), DBDataType.CHAR))
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@INKA_NO_M", .Item("INKA_NO_M").ToString(), DBDataType.CHAR))
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@INKA_NO_S", .Item("INKA_NO_S").ToString(), DBDataType.CHAR))
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@ZAI_UPD_FLAG", .Item("ZAI_UPD_FLAG").ToString(), DBDataType.CHAR))
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@ALCTD_CAN_NB", Me.FormatNumValue(.Item("ALCTD_CAN_NB").ToString()), DBDataType.NUMERIC))
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@ALCTD_NB", Me.FormatNumValue(.Item("ALCTD_NB").ToString()), DBDataType.NUMERIC))
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@ALCTD_CAN_QT", Me.FormatNumValue(.Item("ALCTD_CAN_QT").ToString()), DBDataType.NUMERIC))
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@ALCTD_QT", Me.FormatNumValue(.Item("ALCTD_QT").ToString()), DBDataType.NUMERIC))
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@IRIME", Me.FormatNumValue(.Item("IRIME").ToString()), DBDataType.NUMERIC))
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@BETU_WT", Me.FormatNumValue(.Item("BETU_WT").ToString()), DBDataType.NUMERIC))
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@COA_FLAG", .Item("COA_FLAG").ToString(), DBDataType.CHAR))
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@REMARK", .Item("REMARK").ToString(), DBDataType.NVARCHAR))
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@SMPL_FLAG", .Item("SMPL_FLAG").ToString(), DBDataType.CHAR))

        End With

    End Sub

    ''' <summary>
    ''' ZAI_TRSの更新パラメータ設定
    ''' </summary>
    ''' <remarks></remarks>
    Private Sub SetZaiTrsComUpdateParameter()

        'SQLパラメータ初期化
        Me._SqlPrmList = New ArrayList()

        With Me._Row

            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@NRS_BR_CD", .Item("NRS_BR_CD").ToString(), DBDataType.CHAR))
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@ZAI_REC_NO", .Item("ZAI_REC_NO").ToString(), DBDataType.CHAR))
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@ALCTD_NB", Me.FormatNumValue(.Item("ALCTD_NB").ToString()), DBDataType.NUMERIC))
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@ALLOC_CAN_NB", Me.FormatNumValue(.Item("ALLOC_CAN_NB").ToString()), DBDataType.NUMERIC))
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@ALCTD_QT", Me.FormatNumValue(.Item("ALCTD_QT").ToString()), DBDataType.NUMERIC))
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@ALLOC_CAN_QT", Me.FormatNumValue(.Item("ALLOC_CAN_QT").ToString()), DBDataType.NUMERIC))
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@ALCTD_KB", .Item("ALCTD_KB").ToString(), DBDataType.CHAR))

        End With

    End Sub

    ''' <summary>
    ''' パラメータ設定モジュール(システム共通項目(登録時))
    ''' </summary>
    ''' <remarks></remarks>
    Private Sub SetParamCommonSystemIns()

        'パラメータ設定
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@SYS_ENT_DATE", MyBase.GetSystemDate(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@SYS_ENT_TIME", MyBase.GetSystemTime(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@SYS_ENT_PGID", MyBase.GetPGID(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@SYS_ENT_USER", MyBase.GetUserID(), DBDataType.NVARCHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@SYS_UPD_DATE", MyBase.GetSystemDate(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@SYS_UPD_TIME", MyBase.GetSystemTime(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@SYS_UPD_PGID", MyBase.GetPGID(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@SYS_UPD_USER", MyBase.GetUserID(), DBDataType.NVARCHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@SYS_DEL_FLG", LMConst.FLG.OFF, DBDataType.CHAR))

    End Sub

    ''' <summary>
    ''' パラメータ設定モジュール(システム共通項目(更新時))
    ''' </summary>
    ''' <remarks></remarks>
    Private Sub SetParamCommonSystemUp()

        'パラメータ設定
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@SYS_UPD_PGID", MyBase.GetPGID(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@SYS_UPD_USER", MyBase.GetUserID(), DBDataType.NVARCHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@SYS_UPD_DATE", MyBase.GetSystemDate(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@SYS_UPD_TIME", MyBase.GetSystemTime(), DBDataType.CHAR))

    End Sub

    ''' <summary>
    ''' NULLの場合、ゼロを設定
    ''' </summary>
    ''' <param name="value">値</param>
    ''' <remarks></remarks>
    Friend Function FormatNumValue(ByVal value As String) As String

        If String.IsNullOrEmpty(value) = True Then
            value = 0.ToString()
        End If

        Return value

    End Function

    'START YANAI 要望番号638
    ''' <summary>
    ''' 運賃の更新パラメータ
    ''' </summary>
    ''' <param name="conditionRow">DataRow</param>
    ''' <param name="prmList">パラメータ</param>
    ''' <remarks></remarks>
    Private Sub SetUnchinComParameter(ByVal conditionRow As DataRow, ByVal prmList As ArrayList)

        With conditionRow

            prmList.Add(MyBase.GetSqlParameter("@YUSO_BR_CD", .Item("YUSO_BR_CD").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@NRS_BR_CD", .Item("NRS_BR_CD").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@UNSO_NO_L", .Item("UNSO_NO_L").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@UNSO_NO_M", .Item("UNSO_NO_M").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@CUST_CD_L", .Item("CUST_CD_L").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@CUST_CD_M", .Item("CUST_CD_M").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@CUST_CD_S", .Item("CUST_CD_S").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@CUST_CD_SS", .Item("CUST_CD_SS").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@SEIQ_GROUP_NO", .Item("SEIQ_GROUP_NO").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@SEIQ_GROUP_NO_M", .Item("SEIQ_GROUP_NO_M").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@SEIQTO_CD", .Item("SEIQTO_CD").ToString(), DBDataType.NVARCHAR))   '要望番号1664:(SEIQTO_CD DACの型) 2012/12/05 本明 VARCHAR,CHAR→NVARCHARに変更
            prmList.Add(MyBase.GetSqlParameter("@UNTIN_CALCULATION_KB", .Item("UNTIN_CALCULATION_KB").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@SEIQ_SYARYO_KB", .Item("SEIQ_SYARYO_KB").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@SEIQ_PKG_UT", .Item("SEIQ_PKG_UT").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@SEIQ_NG_NB", Me.FormatNumValue(.Item("SEIQ_NG_NB").ToString()), DBDataType.NUMERIC))
            prmList.Add(MyBase.GetSqlParameter("@SEIQ_DANGER_KB", .Item("SEIQ_DANGER_KB").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@SEIQ_TARIFF_BUNRUI_KB", .Item("SEIQ_TARIFF_BUNRUI_KB").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@SEIQ_TARIFF_CD", .Item("SEIQ_TARIFF_CD").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@SEIQ_ETARIFF_CD", .Item("SEIQ_ETARIFF_CD").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@SEIQ_KYORI", Me.FormatNumValue(.Item("SEIQ_KYORI").ToString()), DBDataType.NUMERIC))
            prmList.Add(MyBase.GetSqlParameter("@SEIQ_WT", Me.FormatNumValue(.Item("SEIQ_WT").ToString()), DBDataType.NUMERIC))
            prmList.Add(MyBase.GetSqlParameter("@SEIQ_UNCHIN", Me.FormatNumValue(.Item("SEIQ_UNCHIN").ToString()), DBDataType.NUMERIC))
            prmList.Add(MyBase.GetSqlParameter("@SEIQ_CITY_EXTC", Me.FormatNumValue(.Item("SEIQ_CITY_EXTC").ToString()), DBDataType.NUMERIC))
            prmList.Add(MyBase.GetSqlParameter("@SEIQ_WINT_EXTC", Me.FormatNumValue(.Item("SEIQ_WINT_EXTC").ToString()), DBDataType.NUMERIC))
            prmList.Add(MyBase.GetSqlParameter("@SEIQ_RELY_EXTC", Me.FormatNumValue(.Item("SEIQ_RELY_EXTC").ToString()), DBDataType.NUMERIC))
            prmList.Add(MyBase.GetSqlParameter("@SEIQ_TOLL", Me.FormatNumValue(.Item("SEIQ_TOLL").ToString()), DBDataType.NUMERIC))
            prmList.Add(MyBase.GetSqlParameter("@SEIQ_INSU", Me.FormatNumValue(.Item("SEIQ_INSU").ToString()), DBDataType.NUMERIC))
            prmList.Add(MyBase.GetSqlParameter("@SEIQ_FIXED_FLAG", .Item("SEIQ_FIXED_FLAG").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@DECI_NG_NB", Me.FormatNumValue(.Item("DECI_NG_NB").ToString()), DBDataType.NUMERIC))
            prmList.Add(MyBase.GetSqlParameter("@DECI_KYORI", Me.FormatNumValue(.Item("DECI_KYORI").ToString()), DBDataType.NUMERIC))
            prmList.Add(MyBase.GetSqlParameter("@DECI_WT", Me.FormatNumValue(.Item("DECI_WT").ToString()), DBDataType.NUMERIC))
            prmList.Add(MyBase.GetSqlParameter("@DECI_UNCHIN", Me.FormatNumValue(.Item("DECI_UNCHIN").ToString()), DBDataType.NUMERIC))
            prmList.Add(MyBase.GetSqlParameter("@DECI_CITY_EXTC", Me.FormatNumValue(.Item("DECI_CITY_EXTC").ToString()), DBDataType.NUMERIC))
            prmList.Add(MyBase.GetSqlParameter("@DECI_WINT_EXTC", Me.FormatNumValue(.Item("DECI_WINT_EXTC").ToString()), DBDataType.NUMERIC))
            prmList.Add(MyBase.GetSqlParameter("@DECI_RELY_EXTC", Me.FormatNumValue(.Item("DECI_RELY_EXTC").ToString()), DBDataType.NUMERIC))
            prmList.Add(MyBase.GetSqlParameter("@DECI_TOLL", Me.FormatNumValue(.Item("DECI_TOLL").ToString()), DBDataType.NUMERIC))
            prmList.Add(MyBase.GetSqlParameter("@DECI_INSU", Me.FormatNumValue(.Item("DECI_INSU").ToString()), DBDataType.NUMERIC))
            prmList.Add(MyBase.GetSqlParameter("@KANRI_UNCHIN", Me.FormatNumValue(.Item("KANRI_UNCHIN").ToString()), DBDataType.NUMERIC))
            prmList.Add(MyBase.GetSqlParameter("@KANRI_CITY_EXTC", Me.FormatNumValue(.Item("KANRI_CITY_EXTC").ToString()), DBDataType.NUMERIC))
            prmList.Add(MyBase.GetSqlParameter("@KANRI_WINT_EXTC", Me.FormatNumValue(.Item("KANRI_WINT_EXTC").ToString()), DBDataType.NUMERIC))
            prmList.Add(MyBase.GetSqlParameter("@KANRI_RELY_EXTC", Me.FormatNumValue(.Item("KANRI_RELY_EXTC").ToString()), DBDataType.NUMERIC))
            prmList.Add(MyBase.GetSqlParameter("@KANRI_TOLL", Me.FormatNumValue(.Item("KANRI_TOLL").ToString()), DBDataType.NUMERIC))
            prmList.Add(MyBase.GetSqlParameter("@KANRI_INSU", Me.FormatNumValue(.Item("KANRI_INSU").ToString()), DBDataType.NUMERIC))
            prmList.Add(MyBase.GetSqlParameter("@REMARK", .Item("REMARK").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@SIZE_KB", .Item("SIZE_KB").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@TAX_KB", .Item("TAX_KB").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@SAGYO_KANRI", .Item("SAGYO_KANRI").ToString(), DBDataType.CHAR))

        End With

    End Sub
    'END YANAI 要望番号638

    'START YANAI 要望番号1302 支払運賃に伴う修正。バッチ呼び出し、画面項目追加等
    ''' <summary>
    ''' 支払運賃の更新パラメータ
    ''' </summary>
    ''' <param name="conditionRow">DataRow</param>
    ''' <param name="prmList">パラメータ</param>
    ''' <remarks></remarks>
    Private Sub SetShiharaiComParameter(ByVal conditionRow As DataRow, ByVal prmList As ArrayList)

        With conditionRow

            prmList.Add(MyBase.GetSqlParameter("@YUSO_BR_CD", .Item("YUSO_BR_CD").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@NRS_BR_CD", .Item("NRS_BR_CD").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@UNSO_NO_L", .Item("UNSO_NO_L").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@UNSO_NO_M", .Item("UNSO_NO_M").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@CUST_CD_L", .Item("CUST_CD_L").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@CUST_CD_M", .Item("CUST_CD_M").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@CUST_CD_S", .Item("CUST_CD_S").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@CUST_CD_SS", .Item("CUST_CD_SS").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@SHIHARAI_GROUP_NO", .Item("SHIHARAI_GROUP_NO").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@SHIHARAI_GROUP_NO_M", .Item("SHIHARAI_GROUP_NO_M").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@SHIHARAITO_CD", .Item("SHIHARAITO_CD").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@UNTIN_CALCULATION_KB", .Item("UNTIN_CALCULATION_KB").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@SHIHARAI_SYARYO_KB", .Item("SHIHARAI_SYARYO_KB").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@SHIHARAI_PKG_UT", .Item("SHIHARAI_PKG_UT").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@SHIHARAI_NG_NB", Me.FormatNumValue(.Item("SHIHARAI_NG_NB").ToString()), DBDataType.NUMERIC))
            prmList.Add(MyBase.GetSqlParameter("@SHIHARAI_DANGER_KB", .Item("SHIHARAI_DANGER_KB").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@SHIHARAI_TARIFF_BUNRUI_KB", .Item("SHIHARAI_TARIFF_BUNRUI_KB").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@SHIHARAI_TARIFF_CD", .Item("SHIHARAI_TARIFF_CD").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@SHIHARAI_ETARIFF_CD", .Item("SHIHARAI_ETARIFF_CD").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@SHIHARAI_KYORI", Me.FormatNumValue(.Item("SHIHARAI_KYORI").ToString()), DBDataType.NUMERIC))
            prmList.Add(MyBase.GetSqlParameter("@SHIHARAI_WT", Me.FormatNumValue(.Item("SHIHARAI_WT").ToString()), DBDataType.NUMERIC))
            prmList.Add(MyBase.GetSqlParameter("@SHIHARAI_UNCHIN", Me.FormatNumValue(.Item("SHIHARAI_UNCHIN").ToString()), DBDataType.NUMERIC))
            prmList.Add(MyBase.GetSqlParameter("@SHIHARAI_CITY_EXTC", Me.FormatNumValue(.Item("SHIHARAI_CITY_EXTC").ToString()), DBDataType.NUMERIC))
            prmList.Add(MyBase.GetSqlParameter("@SHIHARAI_WINT_EXTC", Me.FormatNumValue(.Item("SHIHARAI_WINT_EXTC").ToString()), DBDataType.NUMERIC))
            prmList.Add(MyBase.GetSqlParameter("@SHIHARAI_RELY_EXTC", Me.FormatNumValue(.Item("SHIHARAI_RELY_EXTC").ToString()), DBDataType.NUMERIC))
            prmList.Add(MyBase.GetSqlParameter("@SHIHARAI_TOLL", Me.FormatNumValue(.Item("SHIHARAI_TOLL").ToString()), DBDataType.NUMERIC))
            prmList.Add(MyBase.GetSqlParameter("@SHIHARAI_INSU", Me.FormatNumValue(.Item("SHIHARAI_INSU").ToString()), DBDataType.NUMERIC))
            prmList.Add(MyBase.GetSqlParameter("@SHIHARAI_FIXED_FLAG", .Item("SHIHARAI_FIXED_FLAG").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@DECI_NG_NB", Me.FormatNumValue(.Item("DECI_NG_NB").ToString()), DBDataType.NUMERIC))
            prmList.Add(MyBase.GetSqlParameter("@DECI_KYORI", Me.FormatNumValue(.Item("DECI_KYORI").ToString()), DBDataType.NUMERIC))
            prmList.Add(MyBase.GetSqlParameter("@DECI_WT", Me.FormatNumValue(.Item("DECI_WT").ToString()), DBDataType.NUMERIC))
            prmList.Add(MyBase.GetSqlParameter("@DECI_UNCHIN", Me.FormatNumValue(.Item("DECI_UNCHIN").ToString()), DBDataType.NUMERIC))
            prmList.Add(MyBase.GetSqlParameter("@DECI_CITY_EXTC", Me.FormatNumValue(.Item("DECI_CITY_EXTC").ToString()), DBDataType.NUMERIC))
            prmList.Add(MyBase.GetSqlParameter("@DECI_WINT_EXTC", Me.FormatNumValue(.Item("DECI_WINT_EXTC").ToString()), DBDataType.NUMERIC))
            prmList.Add(MyBase.GetSqlParameter("@DECI_RELY_EXTC", Me.FormatNumValue(.Item("DECI_RELY_EXTC").ToString()), DBDataType.NUMERIC))
            prmList.Add(MyBase.GetSqlParameter("@DECI_TOLL", Me.FormatNumValue(.Item("DECI_TOLL").ToString()), DBDataType.NUMERIC))
            prmList.Add(MyBase.GetSqlParameter("@DECI_INSU", Me.FormatNumValue(.Item("DECI_INSU").ToString()), DBDataType.NUMERIC))
            prmList.Add(MyBase.GetSqlParameter("@KANRI_UNCHIN", Me.FormatNumValue(.Item("KANRI_UNCHIN").ToString()), DBDataType.NUMERIC))
            prmList.Add(MyBase.GetSqlParameter("@KANRI_CITY_EXTC", Me.FormatNumValue(.Item("KANRI_CITY_EXTC").ToString()), DBDataType.NUMERIC))
            prmList.Add(MyBase.GetSqlParameter("@KANRI_WINT_EXTC", Me.FormatNumValue(.Item("KANRI_WINT_EXTC").ToString()), DBDataType.NUMERIC))
            prmList.Add(MyBase.GetSqlParameter("@KANRI_RELY_EXTC", Me.FormatNumValue(.Item("KANRI_RELY_EXTC").ToString()), DBDataType.NUMERIC))
            prmList.Add(MyBase.GetSqlParameter("@KANRI_TOLL", Me.FormatNumValue(.Item("KANRI_TOLL").ToString()), DBDataType.NUMERIC))
            prmList.Add(MyBase.GetSqlParameter("@KANRI_INSU", Me.FormatNumValue(.Item("KANRI_INSU").ToString()), DBDataType.NUMERIC))
            prmList.Add(MyBase.GetSqlParameter("@REMARK", .Item("REMARK").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@SIZE_KB", .Item("SIZE_KB").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@TAX_KB", .Item("TAX_KB").ToString(), DBDataType.CHAR))
            prmList.Add(MyBase.GetSqlParameter("@SAGYO_KANRI", .Item("SAGYO_KANRI").ToString(), DBDataType.CHAR))

        End With

    End Sub
    'END YANAI 要望番号1302 支払運賃に伴う修正。バッチ呼び出し、画面項目追加等

    'START YANAI 20120322 特別梱包個数計算
    ''' <summary>
    ''' 特別梱包個数計算のデータ取得パラメータ設定
    ''' </summary>
    ''' <remarks></remarks>
    Private Sub SetSelectOutkaPkgNb()

        With Me._Row

            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@NRS_BR_CD", .Item("NRS_BR_CD").ToString(), DBDataType.CHAR))
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@OUTKA_NO_L", .Item("OUTKA_NO_L").ToString(), DBDataType.CHAR))

        End With

    End Sub

    ''' <summary>
    ''' 特別梱包個数計算の出荷(大)更新パラメータ設定
    ''' </summary>
    ''' <remarks></remarks>
    Private Sub SetUpdateOutkaPkgNb()

        With Me._Row

            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@NRS_BR_CD", Me._Row.Item("NRS_BR_CD").ToString(), DBDataType.CHAR))
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@OUTKA_NO_L", Me._Row.Item("OUTKA_NO_L").ToString(), DBDataType.NVARCHAR))
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@GUI_UPD_DATE", Me._Row.Item("SYS_UPD_DATE").ToString(), DBDataType.CHAR))
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@GUI_UPD_TIME", Me._Row.Item("SYS_UPD_TIME").ToString(), DBDataType.CHAR))
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@OUTKA_PKG_NB", Me._Row.Item("OUTKA_PKG_NB").ToString(), DBDataType.NUMERIC))

        End With

    End Sub
    'END YANAI 20120322 特別梱包個数計算
    '要望番号:1533 terakawa 2012.10.30 Start
    ''' <summary>
    ''' パラメータ設定モジュール(排他チェック用)
    ''' </summary>
    ''' <remarks></remarks>
    Private Sub SetParamHaitaChk()

        With Me._Row

            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@NRS_BR_CD", .Item("NRS_BR_CD").ToString(), DBDataType.CHAR))
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@OUTKA_NO_L", .Item("OUTKA_NO_L").ToString(), DBDataType.CHAR))
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@SYS_UPD_DATE", .Item("SYS_UPD_DATE").ToString(), DBDataType.CHAR))
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@SYS_UPD_TIME", .Item("SYS_UPD_TIME").ToString(), DBDataType.CHAR))

        End With

    End Sub
    '要望番号:1533 terakawa 2012.10.30 End

    '社内入荷データ作成対応 terakawa 2012.11.19 Start

    ''' <summary>
    ''' パラメータ設定モジュール(存在チェック用)
    ''' </summary>
    ''' <remarks></remarks>
    Private Sub SetParamExistIntEdiChk()

        With Me._Row

            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@INT_EDI_CD", .Item("INT_EDI_CD").ToString(), DBDataType.CHAR))
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@NRS_BR_CD", .Item("NRS_BR_CD").ToString(), DBDataType.CHAR))
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@CUST_CD_L", .Item("CUST_CD_L").ToString(), DBDataType.CHAR))

        End With

    End Sub

    ''' <summary>
    ''' INKA_Lの更新パラメータ設定
    ''' </summary>
    ''' <remarks></remarks>
    Private Sub SetInkaLInsertParameter(ByVal row As DataRow)

        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@NRS_BR_CD", Me.NullConvertString(row.Item("NRS_BR_CD")), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@INKA_NO_L", Me.NullConvertString(row.Item("INKA_NO_L")), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@FURI_NO", Me.NullConvertString(row.Item("FURI_NO")), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@INKA_TP", Me.NullConvertString(row.Item("INKA_TP")), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@INKA_KB", Me.NullConvertString(row.Item("INKA_KB")), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@INKA_STATE_KB", Me.NullConvertString(row.Item("INKA_STATE_KB")), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@INKA_DATE", Me.NullConvertString(row.Item("INKA_DATE")), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@WH_CD", Me.NullConvertString(row.Item("NRS_WH_CD")), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@CUST_CD_L", Me.NullConvertString(row.Item("CUST_CD_L")), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@CUST_CD_M", Me.NullConvertString(row.Item("CUST_CD_M")), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@INKA_PLAN_QT", Me.NullConvertZero(row.Item("INKA_PLAN_QT")), DBDataType.NUMERIC))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@INKA_PLAN_QT_UT", Me.NullConvertString(row.Item("INKA_PLAN_QT_UT")), DBDataType.NVARCHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@INKA_TTL_NB", Me.NullConvertZero(row.Item("INKA_TTL_NB")), DBDataType.NUMERIC))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@BUYER_ORD_NO_L", Me.NullConvertString(row.Item("BUYER_ORD_NO_L")), DBDataType.NVARCHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@OUTKA_FROM_ORD_NO_L", Me.NullConvertString(row.Item("OUTKA_FROM_ORD_NO_L")), DBDataType.NVARCHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@SEIQTO_CD", Me.NullConvertString(row.Item("SEIQTO_CD")), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@TOUKI_HOKAN_YN", Me.NullConvertString(row.Item("TOUKI_HOKAN_YN")), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@HOKAN_YN", Me.NullConvertString(row.Item("HOKAN_YN")), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@HOKAN_FREE_KIKAN", Me.NullConvertZero(row.Item("HOKAN_FREE_KIKAN")), DBDataType.NUMERIC))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@HOKAN_STR_DATE", Me.NullConvertString(row.Item("HOKAN_STR_DATE")), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@NIYAKU_YN", Me.NullConvertString(row.Item("NIYAKU_YN")), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@TAX_KB", Me.NullConvertString(row.Item("TAX_KB")), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@REMARK", Me.NullConvertString(row.Item("REMARK")), DBDataType.NVARCHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@REMARK_OUT", Me.NullConvertString(row.Item("REMARK_OUT")), DBDataType.NVARCHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@UNCHIN_TP", Me.NullConvertString(row.Item("UNCHIN_TP")), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@UNCHIN_KB", Me.NullConvertString(row.Item("UNCHIN_KB")), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@WH_TAB_STATUS", Me.NullConvertString(row.Item("WH_TAB_STATUS")), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@WH_TAB_YN", Me.NullConvertString(row.Item("WH_TAB_YN")), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@WH_TAB_IMP_YN", Me.NullConvertString(row.Item("WH_TAB_IMP_YN")), DBDataType.CHAR))


    End Sub

    ''' <summary>
    ''' 更新パラメータ設定(INKA_M)
    ''' </summary>
    ''' <remarks></remarks>
    Private Sub SetInkaMInsertParameter(ByVal row As DataRow)

        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@NRS_BR_CD", row.Item("NRS_BR_CD").ToString(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@INKA_NO_L", row.Item("INKA_NO_L").ToString(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@INKA_NO_M", row.Item("INKA_NO_M").ToString(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@GOODS_CD_NRS", row.Item("GOODS_CD_NRS").ToString(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@OUTKA_FROM_ORD_NO_M", row.Item("OUTKA_FROM_ORD_NO_M").ToString(), DBDataType.NVARCHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@BUYER_ORD_NO_M", row.Item("BUYER_ORD_NO_M").ToString(), DBDataType.NVARCHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@REMARK", row.Item("REMARK").ToString(), DBDataType.NVARCHAR))

    End Sub


    ''' <summary>
    ''' INKA_Sの更新パラメータ設定
    ''' </summary>
    ''' <remarks></remarks>
    Private Sub SetInkaSInsertParameter(ByVal row As DataRow)

        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@NRS_BR_CD", row.Item("NRS_BR_CD"), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@INKA_NO_L", row.Item("INKA_NO_L").ToString(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@INKA_NO_M", row.Item("INKA_NO_M").ToString(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@INKA_NO_S", row.Item("INKA_NO_S").ToString(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@ZAI_REC_NO", row.Item("ZAI_REC_NO").ToString(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@LOT_NO", row.Item("LOT_NO").ToString(), DBDataType.NVARCHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@LOCA", row.Item("LOCA").ToString(), DBDataType.NVARCHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@TOU_NO", row.Item("TOU_NO").ToString(), DBDataType.NVARCHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@SITU_NO", row.Item("SITU_NO").ToString(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@ZONE_CD", row.Item("ZONE_CD").ToString(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@KONSU", Me.FormatNumValue(row.Item("KONSU").ToString()), DBDataType.NUMERIC))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@HASU", Me.FormatNumValue(row.Item("HASU").ToString()), DBDataType.NUMERIC))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@IRIME", Me.FormatNumValue(row.Item("IRIME").ToString()), DBDataType.NUMERIC))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@BETU_WT", Me.FormatNumValue(row.Item("BETU_WT").ToString()), DBDataType.NUMERIC))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@SERIAL_NO", row.Item("SERIAL_NO").ToString(), DBDataType.NVARCHAR))
        '要望番号:1947（出荷からの入荷作成において、備考小社内が対象外) 2013/03/14 START
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@REMARK", row.Item("REMARK").ToString(), DBDataType.NVARCHAR))
        '要望番号:1947（出荷からの入荷作成において、備考小社内が対象外) 2013/03/14 END
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@SPD_KB", row.Item("SPD_KB").ToString(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@OFB_KB", row.Item("OFB_KB").ToString(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@ALLOC_PRIORITY", row.Item("ALLOC_PRIORITY").ToString(), DBDataType.CHAR))
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@REMARK_OUT", row.Item("REMARK_OUT").ToString(), DBDataType.NVARCHAR))

    End Sub

    '社内入荷データ作成対応 terakawa 2012.11.19 End



#Region "前埋め設定"

    ''' <summary>
    ''' 前埋め設定
    ''' </summary>
    ''' <param name="value">値</param>
    ''' <param name="value2">前埋めする文字</param>
    ''' <param name="keta">桁数</param>
    ''' <returns>前埋めした値</returns>
    ''' <remarks></remarks>
    Friend Function MaeCoverData(ByVal value As String, _
                                 ByVal value2 As String, _
                                 ByVal keta As Integer) As String

        For i As Integer = value.Length To keta - 1
            value = String.Concat(value2, value)
        Next

        Return value

    End Function

#End Region

    '社内入荷データ作成対応 terakawa 2012.11.19 Start
#Region "変換"
    ''' <summary>
    ''' Null変換（文字列）
    ''' </summary>
    ''' <param name="value"></param>
    ''' <returns></returns>
    ''' <remarks></remarks>
    Private Function NullConvertString(ByVal value As Object) As Object

        If IsDBNull(value) = True Then
            value = String.Empty
        End If

        Return value

    End Function

    ''' <summary>
    ''' Null変換（数値）
    ''' </summary>
    ''' <param name="value"></param>
    ''' <returns></returns>
    ''' <remarks></remarks>
    Private Function NullConvertZero(ByVal value As Object) As Object

        If IsDBNull(value) = True Then
            value = 0
        End If

        If String.IsNullOrEmpty(value.ToString()) = True Then
            value = 0
        End If

        Return value

    End Function

#End Region
    '社内入荷データ作成対応 terakawa 2012.11.19 End
#End Region

#Region "ユーティリティ"

    'START YANAI 要望番号1474 一括引当時、引当が出来ない場合のエラーメッセージ変更
    '''' <summary>
    '''' Update文の発行
    '''' </summary>
    '''' <param name="cmd">SQLコマンド</param>
    '''' <param name="setFlg">セットフラグ　False:通常のメッセージセット　True:一括更新のメッセージセット</param>
    '''' <returns>True:エラーなし,OK False:排他エラー(E011)</returns>
    '''' <remarks></remarks>
    'Private Function UpdateResultChk(ByVal cmd As SqlCommand, Optional ByVal setFlg As Boolean = False) As Boolean

    '    Return Me.UpdateResultChk(MyBase.GetUpdateResult(cmd), setFlg)

    'End Function
    ''' <summary>
    ''' Update文の発行
    ''' </summary>
    ''' <param name="cmd">SQLコマンド</param>
    ''' <param name="setFlg">セットフラグ　False:通常のメッセージセット　True:一括更新のメッセージセット</param>
    ''' <returns>True:エラーなし,OK False:排他エラー(E011)</returns>
    ''' <remarks></remarks>
    Private Function UpdateResultChk(ByVal cmd As SqlCommand, Optional ByVal setFlg As Boolean = False, _
                                     Optional ByVal ds As DataSet = Nothing, _
                                     Optional ByVal hikiateFlg As String = "") As Boolean

        Return Me.UpdateResultChk(MyBase.GetUpdateResult(cmd), setFlg, ds, hikiateFlg)

    End Function
    'END YANAI 要望番号1474 一括引当時、引当が出来ない場合のエラーメッセージ変更

    'START YANAI 要望番号1474 一括引当時、引当が出来ない場合のエラーメッセージ変更
    '''' <summary>
    '''' 排他チェック
    '''' </summary>
    '''' <param name="setFlg">セットフラグ　False:通常のメッセージセット　True:一括更新のメッセージセット</param>
    '''' <param name="cnt">カウント</param>
    '''' <returns>True:エラーなし,OK False:排他エラー(E011)</returns>
    '''' <remarks></remarks>
    'Private Function UpdateResultChk(ByVal cnt As Integer, Optional ByVal setFlg As Boolean = False) As Boolean
    ''' <summary>
    ''' 排他チェック
    ''' </summary>
    ''' <param name="setFlg">セットフラグ　False:通常のメッセージセット　True:一括更新のメッセージセット</param>
    ''' <param name="cnt">カウント</param>
    ''' <returns>True:エラーなし,OK False:排他エラー(E011)</returns>
    ''' <remarks></remarks>
    Private Function UpdateResultChk(ByVal cnt As Integer, Optional ByVal setFlg As Boolean = False, _
                                     Optional ByVal ds As DataSet = Nothing, _
                                     Optional ByVal hikiateFlg As String = "") As Boolean

        Dim strMsg As String = String.Empty
        'END YANAI 要望番号1474 一括引当時、引当が出来ない場合のエラーメッセージ変更

        '判定
        If cnt < 1 Then
            If setFlg = False Then
                MyBase.SetMessage("E011")
            Else
                MyBase.Logger.WriteLog(0, "LMC010DAC", "???", "排他エラー発生")
                'START YANAI 要望番号1474 一括引当時、引当が出来ない場合のエラーメッセージ変更
                'MyBase.SetMessageStore("00", "E011", , Me._Row.Item("ROW_NO").ToString())
                If ("01").Equals(hikiateFlg) = True Then
                    '引当時の更新エラーの場合
                    '英語化対応
                    '20151021 tsunehira add
                    strMsg = String.Concat(ds.Tables("LMC010_OUTKA_M_IN").Rows(0).Item("OUTKA_NO_L").ToString)
                    MyBase.SetMessageStore("00", "E678", New String() {strMsg}, Me._Row.Item("ROW_NO").ToString())

                    'strMsg = String.Concat("[出荷管理番号：", ds.Tables("LMC010_OUTKA_M_IN").Rows(0).Item("OUTKA_NO_L").ToString, "]")
                    'MyBase.SetMessageStore("00", "E519", New String() {strMsg}, Me._Row.Item("ROW_NO").ToString())


                Else
                    MyBase.SetMessageStore("00", "E011", , Me._Row.Item("ROW_NO").ToString())
                End If
                'END YANAI 要望番号1474 一括引当時、引当が出来ない場合のエラーメッセージ変更
            End If
            Return False
        End If

        Return True

    End Function

#End Region

#End Region

End Class
