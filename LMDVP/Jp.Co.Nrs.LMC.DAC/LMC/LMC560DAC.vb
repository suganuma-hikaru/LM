' ==========================================================================
'  システム名       :  LM
'  サブシステム名   :  LMC       : 出荷管理
'  プログラムID     :  LMC560    : 送り状
'  作  成  者       :  [shinohara]
' ==========================================================================
'  更　新  者       :  [ohnuki] ： 大阪物流センター対応 2012.01.17
' ==========================================================================
' ==========================================================================
'  更　新  者       :  [shinohara] ：埼玉物流センター対応 2012.05.25
' ==========================================================================
' ==========================================================================
'  更　新  者       :  [shinohara] ：埼玉物流センター(ｵｶｹﾝ)対応 2012.05.29
' ==========================================================================
' ==========================================================================
'  更　新  者       :  [shinohara] ：埼玉・日本ファイン対応 2012.06.01
' ==========================================================================
' ==========================================================================
'  更　新  者       :  [ohnuki]    ：纏め送り状対応 2012.06.06
' ==========================================================================
Imports System.Text
Imports System.Data.SqlClient
Imports Jp.Co.Nrs.Com.Const
Imports Jp.Co.Nrs.LM.Const

''' <summary>
''' LMC560DACクラス
''' </summary>
''' <remarks></remarks>
Public Class LMC560DAC
    Inherits Jp.Co.Nrs.LM.Base.DAC.LMBaseDAC

#Region "Const"

#Region "検索処理 SQL"

#Region "運送"

    ''' <summary>
    ''' 帳票種別取得用(運送テーブル参照)
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_SELECT_MPRT_UNSO As String = "SELECT DISTINCT                                                                                 " & vbNewLine _
                                                 & "       F02_01.NRS_BR_CD                                       AS NRS_BR_CD                      " & vbNewLine _
                                                 & "      ,'11'                                                   AS PTN_ID                         " & vbNewLine _
                                                 & "      ,CASE WHEN M22_02.PTN_CD IS NOT NULL THEN M22_02.PTN_CD                                   " & vbNewLine _
                                                 & "            WHEN M22_01.PTN_CD IS NOT NULL THEN M22_01.PTN_CD                                   " & vbNewLine _
                                                 & "            ELSE '' END                                       AS PTN_CD                         " & vbNewLine _
                                                 & "      ,CASE WHEN M22_02.PTN_CD IS NOT NULL THEN M22_02.RPT_ID                                   " & vbNewLine _
                                                 & "            WHEN M22_01.PTN_CD IS NOT NULL THEN M22_01.RPT_ID                                   " & vbNewLine _
                                                 & "            ELSE '' END                                       AS RPT_ID                         " & vbNewLine _
                                                 & "  FROM      $LM_TRN$..F_UNSO_L   F02_01                                                         " & vbNewLine _
                                                 & "  LEFT JOIN $LM_MST$..M_CUST      M07_01                                                        " & vbNewLine _
                                                 & "         ON F02_01.NRS_BR_CD    = M07_01.NRS_BR_CD                                              " & vbNewLine _
                                                 & "        AND F02_01.CUST_CD_L    = M07_01.CUST_CD_L                                              " & vbNewLine _
                                                 & "        AND F02_01.CUST_CD_M    = M07_01.CUST_CD_M                                              " & vbNewLine _
                                                 & "        AND M07_01.CUST_CD_S    = '00'                                                          " & vbNewLine _
                                                 & "        AND M07_01.CUST_CD_SS   = '00'                                                          " & vbNewLine _
                                                 & "        AND M07_01.SYS_DEL_FLG  = '0'                                                           " & vbNewLine



    ''' <summary>
    ''' 運送データ取得
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_SELECT_UNSO_DATA As String = "SELECT                                                                                          " & vbNewLine _
                                                 & "       CASE WHEN M22_02.PTN_CD IS NOT NULL THEN M22_02.RPT_ID                                   " & vbNewLine _
                                                 & "            WHEN M22_01.PTN_CD IS NOT NULL THEN M22_01.RPT_ID                                   " & vbNewLine _
                                                 & "            ELSE '' END                                       AS RPT_ID                         " & vbNewLine _
                                                 & "           ,F02_01.NRS_BR_CD                                  AS NRS_BR_CD                      " & vbNewLine _
                                                 & "           ,F02_01.OUTKA_PLAN_DATE                            AS OUTKA_PLAN_DATE                " & vbNewLine _
                                                 & "           ,F02_01.UNSO_NO_L                                  AS OUTKA_NO_L                     " & vbNewLine _
                                                 & "           ,''                                                AS SHITEN_TEL_560_1               " & vbNewLine _
                                                 & "           ,''                                                AS SHITEN_NM_560_1                " & vbNewLine _
                                                 & "           ,F02_01.ARR_PLAN_DATE                              AS ARR_PLAN_DATE                  " & vbNewLine _
                                                 & "           ,F02_01.ARR_PLAN_TIME                              AS ARR_PLAN_TIME                  " & vbNewLine _
                                                 & "           ,DEST2.TEL                                         AS DEST_TEL                       " & vbNewLine _
                                                 & "           ,''                                                AS CUST_TEL                       " & vbNewLine _
                                                 & "           ,''                                                AS CUST_AD_1                      " & vbNewLine _
                                                 & "           ,''                                                AS CUST_AD_2                      " & vbNewLine _
                                                 & "           ,DEST2.AD_1                                        AS DEST_AD_1                      " & vbNewLine _
                                                 & "           ,''                                                AS CUST_AD_3                      " & vbNewLine _
                                                 & "           ,DEST2.AD_2                                        AS DEST_AD_2                      " & vbNewLine _
                                                 & "           ,F02_01.AD_3                                       AS DEST_AD_3                      " & vbNewLine _
                                                 & "           ,''                                                AS BETU_WT                        " & vbNewLine _
                                                 & "           ,DEST2.DEST_NM                                     AS DEST_NM_1                      " & vbNewLine _
                                                 & "           ,M07_01.CUST_NM_L                                  AS CUST_NM_L                      " & vbNewLine _
                                                 & "           ,DEST2.ZIP                                         AS DEST_ZIP                       " & vbNewLine _
                                                 & "--(2012.12.10)要望番号1682 --- START ---                                                        " & vbNewLine _
                                                 & "           --,(F03_01.BETU_WT * F03_01.UNSO_TTL_NB)           AS UNSO_WT                        " & vbNewLine _
                                                 & "           ,SUM((F03_01.BETU_WT * F03_01.UNSO_TTL_NB))        AS UNSO_WT                        " & vbNewLine _
                                                 & "--(2012.12.10)要望番号1682 ---  END  ---                                                        " & vbNewLine _
                                                 & "           ,F02_01.UNSO_PKG_NB                                AS UNSO_PKG_NB                    " & vbNewLine _
                                                 & "           ,''                                                AS CUST_NM_M                      " & vbNewLine _
                                                 & "           ,SOKO.WH_NM                                        AS NRS_BR_NM                      " & vbNewLine _
                                                 & "           ,''                                                AS DEST_HOSOKU                    " & vbNewLine _
                                                 & "           ,SOKO.AD_1                                         AS NRS_AD_1                       " & vbNewLine _
                                                 & "           ,SOKO.AD_2                                         AS NRS_AD_2                       " & vbNewLine _
                                                 & "           ,SOKO.TEL                                          AS NRS_TEL                        " & vbNewLine _
                                                 & "           ,F02_01.CUST_CD_L                                  AS CUST_CD_L                      " & vbNewLine _
                                                 & "           ,F02_01.REMARK                                     AS UNSO_L_REMARK                  " & vbNewLine _
                                                 & "           ,''                                                AS OUTKA_L_REMARK                 " & vbNewLine _
                                                 & "           ,MAX(ISNULL(F03_01.GOODS_NM,''))                   AS GOODS_NM_1                     " & vbNewLine _
                                                 & "           ,''                                                AS OUTKA_ATT                      " & vbNewLine _
                                                 & "           ,F02_01.BUY_CHU_NO                                 AS BUYER_ORD_NO                   " & vbNewLine _
                                                 & "           ,''                                                AS YELLOW_NO                      " & vbNewLine _
                                                 & "           ,''                                                AS SHIHARAI_SHITEN_NM_563_1       " & vbNewLine _
                                                 & "           ,''                                                AS SHIHARAI_SHITEN_TEL_563_1      " & vbNewLine _
                                                 & "           ,''                                                AS SHITEN_TEL_1_564_1             " & vbNewLine _
                                                 & "           ,''                                                AS SHITEN_NM_564_1                " & vbNewLine _
                                                 & "           ,''                                                AS SHITEN_TEL_2_564_1             " & vbNewLine _
                                                 & "           ,SOKO.AD_1                                         AS NRS_BR_AD_1                    " & vbNewLine _
                                                 & "           ,SOKO.AD_2                                         AS NRS_BR_AD_2                    " & vbNewLine _
                                                 & "           ,SOKO.WH_NM                                        AS NRS_BR_NM_1                    " & vbNewLine _
                                                 & "           ,DEST2.DEST_NM                                     AS DEST_NM                        " & vbNewLine _
                                                 & "           ,DEST2.AD_1                                        AS AD_1                           " & vbNewLine _
                                                 & "           ,DEST2.AD_2                                        AS AD_2                           " & vbNewLine _
                                                 & "           ,F02_01.AD_3                                       AS AD_3                           " & vbNewLine _
                                                 & "           ,DEST2.TEL                                         AS TEL                            " & vbNewLine _
                                                 & "           ,DEST2.DEST_CD                                     AS DEST_CD                        " & vbNewLine _
                                                 & "           ,''                                                AS SHIP_CD_L                      " & vbNewLine _
                                                 & "           ,''                                                AS SHIHARAI_CD_565_1              " & vbNewLine _
                                                 & "           ,''                                                AS SHIHARAI_CD_565_2              " & vbNewLine _
                                                 & "           ,SOKO.FAX                                        AS NRS_FAX                        " & vbNewLine _
                                                 & "           ,''                                                AS NRS_AD_3                       " & vbNewLine _
                                                 & "           ,''                                                AS CUST_ORD_NO                    " & vbNewLine _
                                                 & "--(2013.12.11)要望番号2138 修正START                                                            " & vbNewLine _
                                                 & "           ,MAX(M08_01.SHOBO_CD)                              AS SHOBO_CD                       " & vbNewLine _
                                                 & "--           ,''                                                AS SHOBO_CD                     " & vbNewLine _
                                                 & "--(2013.12.11)要望番号2138 修正END                                                              " & vbNewLine _
                                                 & "           ,''                                                AS CUST_CD_L_568_1                " & vbNewLine _
                                                 & "           ,''                                                AS CUST_CD_L_568_2                " & vbNewLine _
                                                 & "           ,''                                                AS NRS_BR_ZIP                     " & vbNewLine _
                                                 & "           ,''                                                AS NRS_BR_TEL                     " & vbNewLine _
                                                 & "           ,''                                                AS KOTEI_1                        " & vbNewLine _
                                                 & "           ,''                                                AS KOTEI_2                        " & vbNewLine _
                                                 & "           ,''                                                AS KOTEI_3                        " & vbNewLine _
                                                 & "           ,''                                                AS NB_UT                          " & vbNewLine _
                                                 & "           ,''                                                AS DENPYO_NM                      " & vbNewLine _
                                                 & "           ,''                                                AS SHITEN_NM_570_1                " & vbNewLine _
                                                 & "           ,''                                                AS SHITEN_TEL_570_1               " & vbNewLine _
                                                 & "           ,''                                                AS OUTKA_PKG_NB                   " & vbNewLine _
                                                 & "           ,''                                                AS IRIME                          " & vbNewLine _
                                                 & "           ,''                                                AS IRIME_UT                       " & vbNewLine _
                                                 & "           ,''                                                AS ALCTD_NB                       " & vbNewLine _
                                                 & "           ,''                                                AS LOT_NO                         " & vbNewLine _
                                                 & "           ,''                                                AS SHITEN_NM_570_2                " & vbNewLine _
                                                 & "           ,''                                                AS SHITEN_TEL_570_2               " & vbNewLine _
                                                 & "           ,''                                                AS SHIHARAI_SHITEN_CD_563_1       " & vbNewLine _
                                                 & "           ,SHIPDEST.DEST_NM                                  AS SHIP_NM_L                      " & vbNewLine _
                                                 & "           ,''                                                AS UNSO_CUST_CD                   " & vbNewLine _
                                                 & "           ,KB0801.KBN_NM3                                    AS SHIHARAI_CD_575_1              " & vbNewLine _
                                                 & "           ,KB0802.KBN_NM3                                    AS SHIHARAI_CD_575_2              " & vbNewLine _
                                                 & "           ,CASE WHEN SHIPDEST.DEST_NM <> ''                                                    " & vbNewLine _
                                                 & "                      AND SHIPDEST.DEST_NM IS NOT NULL THEN SHIPDEST.DEST_NM                    " & vbNewLine _
                                                 & "                 WHEN M07_01.DENPYO_NM   <> ''                                                  " & vbNewLine _
                                                 & "                      AND M07_01.DENPYO_NM IS NOT NULL   THEN M07_01.DENPYO_NM                  " & vbNewLine _
                                                 & "                 ELSE M07_01.CUST_NM_L                                                          " & vbNewLine _
                                                 & "            END                                               AS ATSUKAISYA_NM                  " & vbNewLine _
                                                 & "--(2012.12.10)要望番号1682 --- START ---                                                        " & vbNewLine _
                                                 & "           --,M08_01.GOODS_CD_CUST                            AS GOODS_CD_CUST   --2012.05.25   " & vbNewLine _
                                                 & "           ,MIN(M08_01.GOODS_CD_CUST)                         AS GOODS_CD_CUST   --2012.05.25   " & vbNewLine _
                                                 & "--(2012.12.10)要望番号1682 --- START ---                                                        " & vbNewLine _
                                                 & "         ,LEFT(JIS.JIS_CD , 2 )                             AS PREF_CD           --2012.05.25   " & vbNewLine _
                                                 & ",CASE WHEN LEFT(JIS.JIS_CD,2) ='16' OR                                                          " & vbNewLine _
                                                 & "          LEFT(JIS.JIS_CD,2) = '17' OR                                                          " & vbNewLine _
                                                 & "          LEFT(JIS.JIS_CD,2) = '18' OR                                                          " & vbNewLine _
                                                 & "          LEFT(JIS.JIS_CD,2) = '21' OR                                                          " & vbNewLine _
                                                 & "          LEFT(JIS.JIS_CD,2) = '25'                  --ここまで飛騨運輸のエリア                 " & vbNewLine _
                                                 & "          THEN '飛騨運輸'                                                                       " & vbNewLine _
                                                 & "    WHEN  LEFT(JIS.JIS_CD,2) = '24' OR                                                          " & vbNewLine _
                                                 & "          LEFT(JIS.JIS_CD,2) = '29' OR                                                          " & vbNewLine _
                                                 & "          LEFT(JIS.JIS_CD,2) = '30' OR                                                          " & vbNewLine _
                                                 & "          LEFT(JIS.JIS_CD,2) = '47'                 --ここまで近鉄運輸のエリア                  " & vbNewLine _
                                                 & "          THEN '近鉄運輸'                                                                       " & vbNewLine _
                                                 & "    WHEN  LEFT(JIS.JIS_CD,2) = '26' OR                                                          " & vbNewLine _
                                                 & "          LEFT(JIS.JIS_CD,2) = '28' OR                                                          " & vbNewLine _
                                                 & "          LEFT(JIS.JIS_CD,2) = '31' OR                                                          " & vbNewLine _
                                                 & "          LEFT(JIS.JIS_CD,2) = '32' OR                                                          " & vbNewLine _
                                                 & "          LEFT(JIS.JIS_CD,2) = '33' OR                                                          " & vbNewLine _
                                                 & "          LEFT(JIS.JIS_CD,2) = '34' OR                                                          " & vbNewLine _
                                                 & "          LEFT(JIS.JIS_CD,2) = '35' OR                                                          " & vbNewLine _
                                                 & "          LEFT(JIS.JIS_CD,2) = '36' OR                                                          " & vbNewLine _
                                                 & "          LEFT(JIS.JIS_CD,2) = '37' OR                                                          " & vbNewLine _
                                                 & "          LEFT(JIS.JIS_CD,2) = '38' OR                                                          " & vbNewLine _
                                                 & "          LEFT(JIS.JIS_CD,2) = '39'                                                             " & vbNewLine _
                                                 & "          THEN '岡山県貨物'                                                                     " & vbNewLine _
                                                 & "          ELSE    '' END            AS TORI_UNSOCO_NM                                           " & vbNewLine _
                                                 & "         --,MUC.UNSOCO_NM                                     AS TORI_UNSOCO_NM  --2012.05.25   " & vbNewLine _
                                                 & "           ,MCD_SAI.SET_NAIYO                                   AS SAI_SHIHARAI_CD --2012.05.25 " & vbNewLine _
                                                 & "           ,MCD_SAI.SET_NAIYO_3        AS SET_NM_L               --2012.05.29                   " & vbNewLine _
                                                 & "           ,MCD_NFC.SET_NAIYO          AS NAIYO1                 --2012.06.01                   " & vbNewLine _
                                                 & "           ,MCD_NFC.SET_NAIYO_2        AS NAIYO2                 --2012.06.01                   " & vbNewLine _
                                                 & "           ,MCD_NFC.SET_NAIYO_3        AS NAIYO3                 --2012.06.01                   " & vbNewLine _
                                                 & "           ,MCD_SAI.SET_NAIYO_2        AS NAIYO_CUST_NM          --2012.06.04                   " & vbNewLine _
                                                 & "           ,''                         AS CUST_ORD_NO_DTL        --2012.06.11                   " & vbNewLine _
                                                 & "           ,''                         AS KBN_CUST_ZIP           --2012.06.18                   " & vbNewLine _
                                                 & "           ,''                         AS KBN_CUST_AD            --2012.06.18                   " & vbNewLine _
                                                 & "           ,''                         AS KBN_CUST_TEL           --2012.06.18                   " & vbNewLine _
                                                 & "           ,''                         AS KBN_CUST_NM            --2012.06.18                   " & vbNewLine _
                                                 & "           ,''                         AS OUTKO_DATE             --2012.06.18                   " & vbNewLine _
                                                 & "           ,''                         AS ALCTD_WT               --2012.06.18                   " & vbNewLine _
                                                 & "           ,''                         AS BUKA_CD                --2012.06.18                   " & vbNewLine _
                                                 & "           ,DEST2.REMARK               AS REMARK_DEST            --2012.07.24 丸和運輸　荷受人氏名下の注意書き(REMARK)開始    " & vbNewLine _
                                                 & "           --要望番号1383 [LMC664] --- START ---                                                " & vbNewLine _
                                                 & "           ,ISNULL(MCD_CUST.CUST_NAIYO_1,'') AS CUST_FLG                                        " & vbNewLine _
                                                 & "           --要望番号1383 [LMC664] --- END ---                                                  " & vbNewLine _
                                                 & "           --送状番号自動採番用 2016.07.23--- STD ---                                           " & vbNewLine _
                                                 & "           ,F02_01.AUTO_DENP_KBN           AS AUTO_DENP_KBN                                     " & vbNewLine _
                                                 & "           ,F02_01.AUTO_DENP_NO            AS AUTO_DENP_NO                                      " & vbNewLine _
                                                 & "           --送状番号自動採番用 2016.07.23--- END ---                                           " & vbNewLine _
                                                & "  FROM      $LM_TRN$..F_UNSO_L    F02_01                                                        " & vbNewLine _
                                                 & "  LEFT JOIN $LM_MST$..M_NRS_BR    M01_01                                                        " & vbNewLine _
                                                 & "         ON F02_01.NRS_BR_CD    = M01_01.NRS_BR_CD                                              " & vbNewLine _
                                                 & "        AND M01_01.SYS_DEL_FLG  = '0'                                                           " & vbNewLine _
                                                 & "  LEFT JOIN $LM_MST$..M_CUST      M07_01                                                        " & vbNewLine _
                                                 & "         ON F02_01.NRS_BR_CD    = M07_01.NRS_BR_CD                                              " & vbNewLine _
                                                 & "        AND F02_01.CUST_CD_L    = M07_01.CUST_CD_L                                              " & vbNewLine _
                                                 & "        AND F02_01.CUST_CD_M    = M07_01.CUST_CD_M                                              " & vbNewLine _
                                                 & "        AND M07_01.CUST_CD_S    = '00'                                                          " & vbNewLine _
                                                 & "        AND M07_01.CUST_CD_SS   = '00'                                                          " & vbNewLine _
                                                 & "        AND M07_01.SYS_DEL_FLG  = '0'                                                           " & vbNewLine _
                                                 & "  LEFT JOIN $LM_MST$..M_DEST      M10_01                                                        " & vbNewLine _
                                                 & "         ON F02_01.NRS_BR_CD    = M10_01.NRS_BR_CD                                              " & vbNewLine _
                                                 & "        AND F02_01.CUST_CD_L    = M10_01.CUST_CD_L                                              " & vbNewLine _
                                                 & "        AND F02_01.DEST_CD      = M10_01.DEST_CD                                                " & vbNewLine _
                                                 & "        AND M10_01.SYS_DEL_FLG  = '0'                                                           " & vbNewLine _
                                                 & "  LEFT JOIN  $LM_MST$..M_DEST   SHIPDEST                                                        " & vbNewLine _
                                                 & "         ON  F02_01.NRS_BR_CD   = SHIPDEST.NRS_BR_CD                                            " & vbNewLine _
                                                 & "        AND  F02_01.CUST_CD_L   = SHIPDEST.CUST_CD_L                                            " & vbNewLine _
                                                 & "        AND  F02_01.SHIP_CD     = SHIPDEST.DEST_CD                                              " & vbNewLine _
                                                 & "        AND  SHIPDEST.SYS_DEL_FLG = '0'                                                         " & vbNewLine _
                                                 & "--区分マスタ(LMC575支払コード(NM3)KB0801)                                                       " & vbNewLine _
                                                 & "        LEFT JOIN $LM_MST$..Z_KBN KB0801                                                        " & vbNewLine _
                                                 & "        ON  KB0801.KBN_GROUP_CD = 'O007'                                                        " & vbNewLine _
                                                 & "        AND KB0801.KBN_CD       = '16'                                                          " & vbNewLine _
                                                 & "        AND KB0801.SYS_DEL_FLG  = '0'                                                           " & vbNewLine _
                                                 & "--区分マスタ(LMC575支払コード(NM3)KB0802)                                                       " & vbNewLine _
                                                 & "        LEFT JOIN $LM_MST$..Z_KBN KB0802                                                        " & vbNewLine _
                                                 & "        ON  KB0802.KBN_GROUP_CD = 'O007'                                                        " & vbNewLine _
                                                 & "        AND KB0802.KBN_CD       = '17'                                                          " & vbNewLine _
                                                 & "        AND KB0802.SYS_DEL_FLG  = '0'                                                           " & vbNewLine _
                                                 & "--区分マスタ(LMC670 KB0803)                                                                     " & vbNewLine _
                                                 & "        LEFT JOIN $LM_MST$..Z_KBN KB0803                                                        " & vbNewLine _
                                                 & "        ON  KB0803.KBN_GROUP_CD = 'O007'                                                        " & vbNewLine _
                                                 & "        AND KB0803.KBN_CD       = '18'                                                          " & vbNewLine _
                                                 & "        AND KB0803.SYS_DEL_FLG  = '0'                                                           " & vbNewLine _
                                                 & "--要望番号803                                                                                   " & vbNewLine _
                                                 & "  LEFT JOIN $LM_MST$..M_DEST      DEST2                                                         " & vbNewLine _
                                                 & "         ON F02_01.NRS_BR_CD    = DEST2.NRS_BR_CD                                               " & vbNewLine _
                                                 & "        AND F02_01.CUST_CD_L    = DEST2.CUST_CD_L                                               " & vbNewLine _
                                                 & "        --要望番号834対応　F_UNSO_LとのJOINをORIG_CDからDEST_CDに変更 -- START --               " & vbNewLine _
                                                 & "        --AND F02_01.ORIG_CD    = DEST2.DEST_CD                                                 " & vbNewLine _
                                                 & "        AND F02_01.DEST_CD      = DEST2.DEST_CD                                                 " & vbNewLine _
                                                 & "        --要望番号834対応　F_UNSO_LとのJOINをORIG_CDからDEST_CDに変更 --  END  --               " & vbNewLine _
                                                 & "        AND M10_01.SYS_DEL_FLG  = '0'                                                           " & vbNewLine _
                                                 & "--JISマスタ(LMC661にてJIS_CD2桁：都道府県コード取得)2012.05.25                                  " & vbNewLine _
                                                 & "  LEFT JOIN  $LM_MST$..M_JIS   JIS                                                              " & vbNewLine _
                                                 & "         ON  JIS.JIS_CD       = M10_01.JIS                                                      " & vbNewLine _
                                                 & "        AND  JIS.SYS_DEL_FLG  = '0'                                                             " & vbNewLine _
                                                 & "--運送会社マスタ(LMC589にてUNSOCO_NM：取次先運送会社名取得)2012.05.25                           " & vbNewLine _
                                                 & "--  LEFT JOIN  $LM_MST$..M_UNSOCO   MUC                                                         " & vbNewLine _
                                                 & "--         ON  MUC.NRS_BR_CD    = F02_01.NRS_BR_CD                                              " & vbNewLine _
                                                 & "--        AND  MUC.UNSOCO_CD    = F02_01.UNSO_CD                                                " & vbNewLine _
                                                 & "--        AND  MUC.UNSOCO_BR_CD = F02_01.UNSO_BR_CD                                             " & vbNewLine _
                                                 & "--        AND  MUC.SYS_DEL_FLG  = '0'                                                           " & vbNewLine _
                                                 & "--荷主明細マスタ(LMC660にてSET_NAIYO：支払コード取得)2012.05.25                                 " & vbNewLine _
                                                 & "  LEFT JOIN $LM_MST$..M_CUST_DETAILS MCD_SAI                                                    " & vbNewLine _
                                                 & "         ON MCD_SAI.NRS_BR_CD   = F02_01.NRS_BR_CD                                              " & vbNewLine _
                                                 & "        AND MCD_SAI.CUST_CD      = F02_01.CUST_CD_L                                             " & vbNewLine _
                                                 & "--        AND MCD_SAI.CUST_CD_EDA  = F02_01.CUST_CD_M                                             " & vbNewLine _
                                                 & "        AND MCD_SAI.SUB_KB       = '27'                                                         " & vbNewLine _
                                                 & "        AND MCD_SAI.SYS_DEL_FLG  = '0'                                                          " & vbNewLine _
                                                 & "--荷主明細マスタ(LMC669にてSET_NAIYO：荷送人名称取得)2012.06.01                                 " & vbNewLine _
                                                 & "  LEFT JOIN $LM_MST$..M_CUST_DETAILS MCD_NFC                                                    " & vbNewLine _
                                                 & "         ON MCD_NFC.NRS_BR_CD   = F02_01.NRS_BR_CD                                              " & vbNewLine _
                                                 & "        AND MCD_NFC.CUST_CD      = F02_01.CUST_CD_L                                             " & vbNewLine _
                                                 & "--        AND MCD_NFC.CUST_CD_EDA  = F02_01.CUST_CD_M--notes 1118                               " & vbNewLine _
                                                 & "        AND MCD_NFC.SUB_KB       = '29'                                                         " & vbNewLine _
                                                 & "        AND MCD_NFC.SYS_DEL_FLG  = '0'                                                          " & vbNewLine _
                                                 & " --要望番号1383 [LMC664] --- START ---                                                          " & vbNewLine _
                                                 & "         LEFT JOIN (SELECT NRS_BR_CD   AS NRS_BR_CD                                             " & vbNewLine _
                                                 & "                         , CUST_CD     AS CUST_CD                                               " & vbNewLine _
                                                 & "                         , CUST_CLASS  AS CUST_CLASS                                            " & vbNewLine _
                                                 & "                         , SET_NAIYO   AS CUST_NAIYO_1                                          " & vbNewLine _
                                                 & "                         , SET_NAIYO_2 AS CUST_NAIYO_2                                          " & vbNewLine _
                                                 & "                         , SET_NAIYO_3 AS CUST_NAIYO_3                                          " & vbNewLine _
                                                 & "                      FROM $LM_MST$..M_CUST_DETAILS                                             " & vbNewLine _
                                                 & "                     WHERE SUB_KB ='42'                                                         " & vbNewLine _
                                                 & "                       AND SET_NAIYO_2 = @RPT_ID                                                " & vbNewLine _
                                                 & "                       AND SYS_DEL_FLG = '0'                                                    " & vbNewLine _
                                                 & "                    ) MCD_CUST                                                                  " & vbNewLine _
                                                 & "                ON M07_01.NRS_BR_CD = MCD_CUST.NRS_BR_CD                                        " & vbNewLine _
                                                 & "               AND (CASE WHEN MCD_CUST.CUST_CLASS='00' THEN  M07_01.CUST_CD_L                                                            " & vbNewLine _
                                                 & "                         WHEN MCD_CUST.CUST_CLASS='01' THEN (M07_01.CUST_CD_L + M07_01.CUST_CD_M)                                        " & vbNewLine _
                                                 & "                         WHEN MCD_CUST.CUST_CLASS='02' THEN (M07_01.CUST_CD_L + M07_01.CUST_CD_M + M07_01.CUST_CD_S)                     " & vbNewLine _
                                                 & "                         WHEN MCD_CUST.CUST_CLASS='03' THEN (M07_01.CUST_CD_L + M07_01.CUST_CD_M + M07_01.CUST_CD_S + M07_01.CUST_CD_SS) " & vbNewLine _
                                                 & "                    END                                                                         " & vbNewLine _
                                                 & "                   ) = MCD_CUST.CUST_CD                                                         " & vbNewLine _
                                                 & " --要望番号1383 [LMC664] --- END ---                                                            " & vbNewLine
    '& "           --送状番号自動採番用 2016.07.23--- STD ---                                           " & vbNewLine _
    '& "           ,FL.AUTO_DENP_KBN           AS AUTO_DENP_KBN                                         " & vbNewLine _
    '& "           ,FL.AUTO_DENP_NO            AS AUTO_DENP_NO                                          " & vbNewLine _
    '& "           --送状番号自動採番用 2016.07.23--- END ---                                           " & vbNewLine



#If True Then   'ADD 2020/01/16 009792【LMS】RD帳票作成_アンファー:送り状・納品書亜種
    ''' <summary>
    ''' 運送データ取得アンファ
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_SELECT_UNSO_DATA_ANF As String = "SELECT                                                                                          " & vbNewLine _
                                                 & "       CASE WHEN M22_02.PTN_CD IS NOT NULL THEN M22_02.RPT_ID                                   " & vbNewLine _
                                                 & "            WHEN M22_01.PTN_CD IS NOT NULL THEN M22_01.RPT_ID                                   " & vbNewLine _
                                                 & "            ELSE '' END                                       AS RPT_ID                         " & vbNewLine _
                                                 & "           ,F02_01.NRS_BR_CD                                  AS NRS_BR_CD                      " & vbNewLine _
                                                 & "           ,F02_01.OUTKA_PLAN_DATE                            AS OUTKA_PLAN_DATE                " & vbNewLine _
                                                 & "           ,F02_01.UNSO_NO_L                                  AS OUTKA_NO_L                     " & vbNewLine _
                                                 & "           ,''                                                AS SHITEN_TEL_560_1               " & vbNewLine _
                                                 & "           ,''                                                AS SHITEN_NM_560_1                " & vbNewLine _
                                                 & "           ,F02_01.ARR_PLAN_DATE                              AS ARR_PLAN_DATE                  " & vbNewLine _
                                                 & "           ,F02_01.ARR_PLAN_TIME                              AS ARR_PLAN_TIME                  " & vbNewLine _
                                                 & "           ,DEST2.TEL                                         AS DEST_TEL                       " & vbNewLine _
                                                 & "           ,''                                                AS CUST_TEL                       " & vbNewLine _
                                                 & "           ,''                                                AS CUST_AD_1                      " & vbNewLine _
                                                 & "           ,''                                                AS CUST_AD_2                      " & vbNewLine _
                                                 & "           ,DEST2.AD_1                                        AS DEST_AD_1                      " & vbNewLine _
                                                 & "           ,''                                                AS CUST_AD_3                      " & vbNewLine _
                                                 & "           ,DEST2.AD_2                                        AS DEST_AD_2                      " & vbNewLine _
                                                 & "           ,F02_01.AD_3                                       AS DEST_AD_3                      " & vbNewLine _
                                                 & "           ,''                                                AS BETU_WT                        " & vbNewLine _
                                                 & "           ,DEST2.DEST_NM                                     AS DEST_NM_1                      " & vbNewLine _
                                                 & "--           ,M07_01.CUST_NM_L                                  AS CUST_NM_L                      " & vbNewLine _
                                                 & "           ,CASE WHEN MGD2.SET_NAIYO IS NULL                                                    " & vbNewLine _
                                                 & "                   THEN M07_01.CUST_NM_L                                                        " & vbNewLine _
                                                 & "  	               ELSE MGD2.SET_NAIYO                                                          " & vbNewLine _
                                                 & "            END                                               AS CUST_NM_L                      " & vbNewLine _
                                                 & "           ,DEST2.ZIP                                         AS DEST_ZIP                       " & vbNewLine _
                                                 & "           --,(F03_01.BETU_WT * F03_01.UNSO_TTL_NB)           AS UNSO_WT                        " & vbNewLine _
                                                 & "           ,SUM((F03_01.BETU_WT * F03_01.UNSO_TTL_NB))        AS UNSO_WT                        " & vbNewLine _
                                                 & "           ,F02_01.UNSO_PKG_NB                                AS UNSO_PKG_NB                    " & vbNewLine _
                                                 & "           ,''                                                AS CUST_NM_M                      " & vbNewLine _
                                                 & "           ,SOKO.WH_NM                                        AS NRS_BR_NM                      " & vbNewLine _
                                                 & "           ,''                                                AS DEST_HOSOKU                    " & vbNewLine _
                                                 & "           ,SOKO.AD_1                                         AS NRS_AD_1                       " & vbNewLine _
                                                 & "           ,SOKO.AD_2                                         AS NRS_AD_2                       " & vbNewLine _
                                                 & "           ,SOKO.TEL                                          AS NRS_TEL                        " & vbNewLine _
                                                 & "           ,F02_01.CUST_CD_L                                  AS CUST_CD_L                      " & vbNewLine _
                                                 & "           ,F02_01.REMARK                                     AS UNSO_L_REMARK                  " & vbNewLine _
                                                 & "           ,''                                                AS OUTKA_L_REMARK                 " & vbNewLine _
                                                 & "           ,MAX(ISNULL(F03_01.GOODS_NM,''))                   AS GOODS_NM_1                     " & vbNewLine _
                                                 & "           ,''                                                AS OUTKA_ATT                      " & vbNewLine _
                                                 & "           ,F02_01.BUY_CHU_NO                                 AS BUYER_ORD_NO                   " & vbNewLine _
                                                 & "           ,''                                                AS YELLOW_NO                      " & vbNewLine _
                                                 & "           ,''                                                AS SHIHARAI_SHITEN_NM_563_1       " & vbNewLine _
                                                 & "           ,''                                                AS SHIHARAI_SHITEN_TEL_563_1      " & vbNewLine _
                                                 & "           ,''                                                AS SHITEN_TEL_1_564_1             " & vbNewLine _
                                                 & "           ,''                                                AS SHITEN_NM_564_1                " & vbNewLine _
                                                 & "           ,''                                                AS SHITEN_TEL_2_564_1             " & vbNewLine _
                                                 & "           ,SOKO.AD_1                                         AS NRS_BR_AD_1                    " & vbNewLine _
                                                 & "           ,SOKO.AD_2                                         AS NRS_BR_AD_2                    " & vbNewLine _
                                                 & "           ,SOKO.WH_NM                                        AS NRS_BR_NM_1                    " & vbNewLine _
                                                 & "           ,DEST2.DEST_NM                                     AS DEST_NM                        " & vbNewLine _
                                                 & "           ,DEST2.AD_1                                        AS AD_1                           " & vbNewLine _
                                                 & "           ,DEST2.AD_2                                        AS AD_2                           " & vbNewLine _
                                                 & "           ,F02_01.AD_3                                       AS AD_3                           " & vbNewLine _
                                                 & "           ,DEST2.TEL                                         AS TEL                            " & vbNewLine _
                                                 & "           ,DEST2.DEST_CD                                     AS DEST_CD                        " & vbNewLine _
                                                 & "           ,''                                                AS SHIP_CD_L                      " & vbNewLine _
                                                 & "           ,''                                                AS SHIHARAI_CD_565_1              " & vbNewLine _
                                                 & "           ,''                                                AS SHIHARAI_CD_565_2              " & vbNewLine _
                                                 & "           ,SOKO.FAX                                        AS NRS_FAX                        " & vbNewLine _
                                                 & "           ,''                                                AS NRS_AD_3                       " & vbNewLine _
                                                 & "           ,''                                                AS CUST_ORD_NO                    " & vbNewLine _
                                                 & "           ,MAX(M08_01.SHOBO_CD)                              AS SHOBO_CD                       " & vbNewLine _
                                                 & "           ,''                                                AS CUST_CD_L_568_1                " & vbNewLine _
                                                 & "           ,''                                                AS CUST_CD_L_568_2                " & vbNewLine _
                                                 & "           ,''                                                AS NRS_BR_ZIP                     " & vbNewLine _
                                                 & "           ,''                                                AS NRS_BR_TEL                     " & vbNewLine _
                                                 & "           ,''                                                AS KOTEI_1                        " & vbNewLine _
                                                 & "           ,''                                                AS KOTEI_2                        " & vbNewLine _
                                                 & "           ,''                                                AS KOTEI_3                        " & vbNewLine _
                                                 & "           ,''                                                AS NB_UT                          " & vbNewLine _
                                                 & "           ,''                                                AS DENPYO_NM                      " & vbNewLine _
                                                 & "           ,''                                                AS SHITEN_NM_570_1                " & vbNewLine _
                                                 & "           ,''                                                AS SHITEN_TEL_570_1               " & vbNewLine _
                                                 & "           ,''                                                AS OUTKA_PKG_NB                   " & vbNewLine _
                                                 & "           ,''                                                AS IRIME                          " & vbNewLine _
                                                 & "           ,''                                                AS IRIME_UT                       " & vbNewLine _
                                                 & "           ,''                                                AS ALCTD_NB                       " & vbNewLine _
                                                 & "           ,''                                                AS LOT_NO                         " & vbNewLine _
                                                 & "           ,''                                                AS SHITEN_NM_570_2                " & vbNewLine _
                                                 & "           ,''                                                AS SHITEN_TEL_570_2               " & vbNewLine _
                                                 & "           ,''                                                AS SHIHARAI_SHITEN_CD_563_1       " & vbNewLine _
                                                 & "           ,SHIPDEST.DEST_NM                                  AS SHIP_NM_L                      " & vbNewLine _
                                                 & "           ,''                                                AS UNSO_CUST_CD                   " & vbNewLine _
                                                 & "           ,KB0801.KBN_NM3                                    AS SHIHARAI_CD_575_1              " & vbNewLine _
                                                 & "           ,KB0802.KBN_NM3                                    AS SHIHARAI_CD_575_2              " & vbNewLine _
                                                 & "           ,CASE WHEN SHIPDEST.DEST_NM <> ''                                                    " & vbNewLine _
                                                 & "                      AND SHIPDEST.DEST_NM IS NOT NULL THEN SHIPDEST.DEST_NM                    " & vbNewLine _
                                                 & "                 WHEN M07_01.DENPYO_NM   <> ''                                                  " & vbNewLine _
                                                 & "                      AND M07_01.DENPYO_NM IS NOT NULL   THEN M07_01.DENPYO_NM                  " & vbNewLine _
                                                 & "                 WHEN MGD2.SET_NAIYO <> ''                                                      " & vbNewLine _
                                                 & "                      AND MGD2.SET_NAIYO IS NOT NULL     THEN MGD2.SET_NAIYO                    " & vbNewLine _
                                                 & "                 ELSE M07_01.CUST_NM_L                                                          " & vbNewLine _
                                                 & "            END                                               AS ATSUKAISYA_NM                  " & vbNewLine _
                                                 & "           ,MIN(M08_01.GOODS_CD_CUST)                         AS GOODS_CD_CUST                  " & vbNewLine _
                                                 & "           ,LEFT(JIS.JIS_CD , 2 )                             AS PREF_CD                        " & vbNewLine _
                                                 & ",CASE WHEN LEFT(JIS.JIS_CD,2) ='16' OR                                                          " & vbNewLine _
                                                 & "          LEFT(JIS.JIS_CD,2) = '17' OR                                                          " & vbNewLine _
                                                 & "          LEFT(JIS.JIS_CD,2) = '18' OR                                                          " & vbNewLine _
                                                 & "          LEFT(JIS.JIS_CD,2) = '21' OR                                                          " & vbNewLine _
                                                 & "          LEFT(JIS.JIS_CD,2) = '25'                  --ここまで飛騨運輸のエリア                 " & vbNewLine _
                                                 & "          THEN '飛騨運輸'                                                                       " & vbNewLine _
                                                 & "    WHEN  LEFT(JIS.JIS_CD,2) = '24' OR                                                          " & vbNewLine _
                                                 & "          LEFT(JIS.JIS_CD,2) = '29' OR                                                          " & vbNewLine _
                                                 & "          LEFT(JIS.JIS_CD,2) = '30' OR                                                          " & vbNewLine _
                                                 & "          LEFT(JIS.JIS_CD,2) = '47'                 --ここまで近鉄運輸のエリア                  " & vbNewLine _
                                                 & "          THEN '近鉄運輸'                                                                       " & vbNewLine _
                                                 & "    WHEN  LEFT(JIS.JIS_CD,2) = '26' OR                                                          " & vbNewLine _
                                                 & "          LEFT(JIS.JIS_CD,2) = '28' OR                                                          " & vbNewLine _
                                                 & "          LEFT(JIS.JIS_CD,2) = '31' OR                                                          " & vbNewLine _
                                                 & "          LEFT(JIS.JIS_CD,2) = '32' OR                                                          " & vbNewLine _
                                                 & "          LEFT(JIS.JIS_CD,2) = '33' OR                                                          " & vbNewLine _
                                                 & "          LEFT(JIS.JIS_CD,2) = '34' OR                                                          " & vbNewLine _
                                                 & "          LEFT(JIS.JIS_CD,2) = '35' OR                                                          " & vbNewLine _
                                                 & "          LEFT(JIS.JIS_CD,2) = '36' OR                                                          " & vbNewLine _
                                                 & "          LEFT(JIS.JIS_CD,2) = '37' OR                                                          " & vbNewLine _
                                                 & "          LEFT(JIS.JIS_CD,2) = '38' OR                                                          " & vbNewLine _
                                                 & "          LEFT(JIS.JIS_CD,2) = '39'                                                             " & vbNewLine _
                                                 & "          THEN '岡山県貨物'                                                                     " & vbNewLine _
                                                 & "          ELSE    '' END            AS TORI_UNSOCO_NM                                           " & vbNewLine _
                                                 & "         --,MUC.UNSOCO_NM                                     AS TORI_UNSOCO_NM  --2012.05.25   " & vbNewLine _
                                                 & "           ,MCD_SAI.SET_NAIYO                                   AS SAI_SHIHARAI_CD --2012.05.25 " & vbNewLine _
                                                 & "           ,MCD_SAI.SET_NAIYO_3        AS SET_NM_L               --2012.05.29                   " & vbNewLine _
                                                 & "           ,MCD_NFC.SET_NAIYO          AS NAIYO1                 --2012.06.01                   " & vbNewLine _
                                                 & "           ,MCD_NFC.SET_NAIYO_2        AS NAIYO2                 --2012.06.01                   " & vbNewLine _
                                                 & "           ,MCD_NFC.SET_NAIYO_3        AS NAIYO3                 --2012.06.01                   " & vbNewLine _
                                                 & "           ,MCD_SAI.SET_NAIYO_2        AS NAIYO_CUST_NM          --2012.06.04                   " & vbNewLine _
                                                 & "           ,''                         AS CUST_ORD_NO_DTL        --2012.06.11                   " & vbNewLine _
                                                 & "           ,''                         AS KBN_CUST_ZIP           --2012.06.18                   " & vbNewLine _
                                                 & "           ,''                         AS KBN_CUST_AD            --2012.06.18                   " & vbNewLine _
                                                 & "           ,''                         AS KBN_CUST_TEL           --2012.06.18                   " & vbNewLine _
                                                 & "           ,''                         AS KBN_CUST_NM            --2012.06.18                   " & vbNewLine _
                                                 & "           ,''                         AS OUTKO_DATE             --2012.06.18                   " & vbNewLine _
                                                 & "           ,''                         AS ALCTD_WT               --2012.06.18                   " & vbNewLine _
                                                 & "           ,''                         AS BUKA_CD                --2012.06.18                   " & vbNewLine _
                                                 & "           ,DEST2.REMARK               AS REMARK_DEST            --2012.07.24 丸和運輸　荷受人氏名下の注意書き(REMARK)開始    " & vbNewLine _
                                                 & "           --要望番号1383 [LMC664] --- START ---                                                " & vbNewLine _
                                                 & "           ,ISNULL(MCD_CUST.CUST_NAIYO_1,'') AS CUST_FLG                                        " & vbNewLine _
                                                 & "           --要望番号1383 [LMC664] --- END ---                                                  " & vbNewLine _
                                                 & "           --送状番号自動採番用 2016.07.23--- STD ---                                           " & vbNewLine _
                                                 & "           ,F02_01.AUTO_DENP_KBN           AS AUTO_DENP_KBN                                     " & vbNewLine _
                                                 & "           ,F02_01.AUTO_DENP_NO            AS AUTO_DENP_NO                                      " & vbNewLine _
                                                 & "           --送状番号自動採番用 2016.07.23--- END ---                                           " & vbNewLine _
                                                & "  FROM      $LM_TRN$..F_UNSO_L    F02_01                                                        " & vbNewLine _
                                                 & "  LEFT JOIN $LM_MST$..M_NRS_BR    M01_01                                                        " & vbNewLine _
                                                 & "         ON F02_01.NRS_BR_CD    = M01_01.NRS_BR_CD                                              " & vbNewLine _
                                                 & "        AND M01_01.SYS_DEL_FLG  = '0'                                                           " & vbNewLine _
                                                 & "  LEFT JOIN $LM_MST$..M_CUST      M07_01                                                        " & vbNewLine _
                                                 & "         ON F02_01.NRS_BR_CD    = M07_01.NRS_BR_CD                                              " & vbNewLine _
                                                 & "        AND F02_01.CUST_CD_L    = M07_01.CUST_CD_L                                              " & vbNewLine _
                                                 & "        AND F02_01.CUST_CD_M    = M07_01.CUST_CD_M                                              " & vbNewLine _
                                                 & "        AND M07_01.CUST_CD_S    = '00'                                                          " & vbNewLine _
                                                 & "        AND M07_01.CUST_CD_SS   = '00'                                                          " & vbNewLine _
                                                 & "        AND M07_01.SYS_DEL_FLG  = '0'                                                           " & vbNewLine _
                                                 & "  LEFT JOIN $LM_MST$..M_DEST      M10_01                                                        " & vbNewLine _
                                                 & "         ON F02_01.NRS_BR_CD    = M10_01.NRS_BR_CD                                              " & vbNewLine _
                                                 & "        AND F02_01.CUST_CD_L    = M10_01.CUST_CD_L                                              " & vbNewLine _
                                                 & "        AND F02_01.DEST_CD      = M10_01.DEST_CD                                                " & vbNewLine _
                                                 & "        AND M10_01.SYS_DEL_FLG  = '0'                                                           " & vbNewLine _
                                                 & "  LEFT JOIN  $LM_MST$..M_DEST   SHIPDEST                                                        " & vbNewLine _
                                                 & "         ON  F02_01.NRS_BR_CD   = SHIPDEST.NRS_BR_CD                                            " & vbNewLine _
                                                 & "        AND  F02_01.CUST_CD_L   = SHIPDEST.CUST_CD_L                                            " & vbNewLine _
                                                 & "        AND  F02_01.SHIP_CD     = SHIPDEST.DEST_CD                                              " & vbNewLine _
                                                 & "        AND  SHIPDEST.SYS_DEL_FLG = '0'                                                         " & vbNewLine _
                                                 & "--区分マスタ(LMC575支払コード(NM3)KB0801)                                                       " & vbNewLine _
                                                 & "        LEFT JOIN $LM_MST$..Z_KBN KB0801                                                        " & vbNewLine _
                                                 & "        ON  KB0801.KBN_GROUP_CD = 'O007'                                                        " & vbNewLine _
                                                 & "        AND KB0801.KBN_CD       = '16'                                                          " & vbNewLine _
                                                 & "        AND KB0801.SYS_DEL_FLG  = '0'                                                           " & vbNewLine _
                                                 & "--区分マスタ(LMC575支払コード(NM3)KB0802)                                                       " & vbNewLine _
                                                 & "        LEFT JOIN $LM_MST$..Z_KBN KB0802                                                        " & vbNewLine _
                                                 & "        ON  KB0802.KBN_GROUP_CD = 'O007'                                                        " & vbNewLine _
                                                 & "        AND KB0802.KBN_CD       = '17'                                                          " & vbNewLine _
                                                 & "        AND KB0802.SYS_DEL_FLG  = '0'                                                           " & vbNewLine _
                                                 & "--区分マスタ(LMC670 KB0803)                                                                     " & vbNewLine _
                                                 & "        LEFT JOIN $LM_MST$..Z_KBN KB0803                                                        " & vbNewLine _
                                                 & "        ON  KB0803.KBN_GROUP_CD = 'O007'                                                        " & vbNewLine _
                                                 & "        AND KB0803.KBN_CD       = '18'                                                          " & vbNewLine _
                                                 & "        AND KB0803.SYS_DEL_FLG  = '0'                                                           " & vbNewLine _
                                                 & "--要望番号803                                                                                   " & vbNewLine _
                                                 & "  LEFT JOIN $LM_MST$..M_DEST      DEST2                                                         " & vbNewLine _
                                                 & "         ON F02_01.NRS_BR_CD    = DEST2.NRS_BR_CD                                               " & vbNewLine _
                                                 & "        AND F02_01.CUST_CD_L    = DEST2.CUST_CD_L                                               " & vbNewLine _
                                                 & "        --要望番号834対応　F_UNSO_LとのJOINをORIG_CDからDEST_CDに変更 -- START --               " & vbNewLine _
                                                 & "        --AND F02_01.ORIG_CD    = DEST2.DEST_CD                                                 " & vbNewLine _
                                                 & "        AND F02_01.DEST_CD      = DEST2.DEST_CD                                                 " & vbNewLine _
                                                 & "        --要望番号834対応　F_UNSO_LとのJOINをORIG_CDからDEST_CDに変更 --  END  --               " & vbNewLine _
                                                 & "        AND M10_01.SYS_DEL_FLG  = '0'                                                           " & vbNewLine _
                                                 & "--JISマスタ(LMC661にてJIS_CD2桁：都道府県コード取得)2012.05.25                                  " & vbNewLine _
                                                 & "  LEFT JOIN  $LM_MST$..M_JIS   JIS                                                              " & vbNewLine _
                                                 & "         ON  JIS.JIS_CD       = M10_01.JIS                                                      " & vbNewLine _
                                                 & "        AND  JIS.SYS_DEL_FLG  = '0'                                                             " & vbNewLine _
                                                 & "--運送会社マスタ(LMC589にてUNSOCO_NM：取次先運送会社名取得)2012.05.25                           " & vbNewLine _
                                                 & "--  LEFT JOIN  $LM_MST$..M_UNSOCO   MUC                                                         " & vbNewLine _
                                                 & "--         ON  MUC.NRS_BR_CD    = F02_01.NRS_BR_CD                                              " & vbNewLine _
                                                 & "--        AND  MUC.UNSOCO_CD    = F02_01.UNSO_CD                                                " & vbNewLine _
                                                 & "--        AND  MUC.UNSOCO_BR_CD = F02_01.UNSO_BR_CD                                             " & vbNewLine _
                                                 & "--        AND  MUC.SYS_DEL_FLG  = '0'                                                           " & vbNewLine _
                                                 & "--荷主明細マスタ(LMC660にてSET_NAIYO：支払コード取得)2012.05.25                                 " & vbNewLine _
                                                 & "  LEFT JOIN $LM_MST$..M_CUST_DETAILS MCD_SAI                                                    " & vbNewLine _
                                                 & "         ON MCD_SAI.NRS_BR_CD   = F02_01.NRS_BR_CD                                              " & vbNewLine _
                                                 & "        AND MCD_SAI.CUST_CD      = F02_01.CUST_CD_L                                             " & vbNewLine _
                                                 & "--        AND MCD_SAI.CUST_CD_EDA  = F02_01.CUST_CD_M                                             " & vbNewLine _
                                                 & "        AND MCD_SAI.SUB_KB       = '27'                                                         " & vbNewLine _
                                                 & "        AND MCD_SAI.SYS_DEL_FLG  = '0'                                                          " & vbNewLine _
                                                 & "--荷主明細マスタ(LMC669にてSET_NAIYO：荷送人名称取得)2012.06.01                                 " & vbNewLine _
                                                 & "  LEFT JOIN $LM_MST$..M_CUST_DETAILS MCD_NFC                                                    " & vbNewLine _
                                                 & "         ON MCD_NFC.NRS_BR_CD   = F02_01.NRS_BR_CD                                              " & vbNewLine _
                                                 & "        AND MCD_NFC.CUST_CD      = F02_01.CUST_CD_L                                             " & vbNewLine _
                                                 & "--        AND MCD_NFC.CUST_CD_EDA  = F02_01.CUST_CD_M--notes 1118                               " & vbNewLine _
                                                 & "        AND MCD_NFC.SUB_KB       = '29'                                                         " & vbNewLine _
                                                 & "        AND MCD_NFC.SYS_DEL_FLG  = '0'                                                          " & vbNewLine _
                                                 & " --要望番号1383 [LMC664] --- START ---                                                          " & vbNewLine _
                                                 & "         LEFT JOIN (SELECT NRS_BR_CD   AS NRS_BR_CD                                             " & vbNewLine _
                                                 & "                         , CUST_CD     AS CUST_CD                                               " & vbNewLine _
                                                 & "                         , CUST_CLASS  AS CUST_CLASS                                            " & vbNewLine _
                                                 & "                         , SET_NAIYO   AS CUST_NAIYO_1                                          " & vbNewLine _
                                                 & "                         , SET_NAIYO_2 AS CUST_NAIYO_2                                          " & vbNewLine _
                                                 & "                         , SET_NAIYO_3 AS CUST_NAIYO_3                                          " & vbNewLine _
                                                 & "                      FROM $LM_MST$..M_CUST_DETAILS                                             " & vbNewLine _
                                                 & "                     WHERE SUB_KB ='42'                                                         " & vbNewLine _
                                                 & "                       AND SET_NAIYO_2 = @RPT_ID                                                " & vbNewLine _
                                                 & "                       AND SYS_DEL_FLG = '0'                                                    " & vbNewLine _
                                                 & "                    ) MCD_CUST                                                                  " & vbNewLine _
                                                 & "                ON M07_01.NRS_BR_CD = MCD_CUST.NRS_BR_CD                                        " & vbNewLine _
                                                 & "               AND (CASE WHEN MCD_CUST.CUST_CLASS='00' THEN  M07_01.CUST_CD_L                                                            " & vbNewLine _
                                                 & "                         WHEN MCD_CUST.CUST_CLASS='01' THEN (M07_01.CUST_CD_L + M07_01.CUST_CD_M)                                        " & vbNewLine _
                                                 & "                         WHEN MCD_CUST.CUST_CLASS='02' THEN (M07_01.CUST_CD_L + M07_01.CUST_CD_M + M07_01.CUST_CD_S)                     " & vbNewLine _
                                                 & "                         WHEN MCD_CUST.CUST_CLASS='03' THEN (M07_01.CUST_CD_L + M07_01.CUST_CD_M + M07_01.CUST_CD_S + M07_01.CUST_CD_SS) " & vbNewLine _
                                                 & "                    END                                                                         " & vbNewLine _
                                                 & "                   ) = MCD_CUST.CUST_CD                                                         " & vbNewLine _
                                                 & " --要望番号1383 [LMC664] --- END ---                                                            " & vbNewLine

#End If

#If True Then       'SQL_SELECT_UNSO_DATAコピー ADD 2018/11/07 依頼番号 : 002535   【LMS】トール_運送画面から送状印刷できるように変更
    ''' <summary>
    ''' 運送データ取得
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_SELECT_UNSO_DATA_683 As String = "SELECT                                                                                          " & vbNewLine _
                                                 & "       CASE WHEN M22_02.PTN_CD IS NOT NULL THEN M22_02.RPT_ID                                   " & vbNewLine _
                                                 & "            WHEN M22_01.PTN_CD IS NOT NULL THEN M22_01.RPT_ID                                   " & vbNewLine _
                                                 & "            ELSE '' END                                       AS RPT_ID                         " & vbNewLine _
                                                 & "           ,F02_01.NRS_BR_CD                                  AS NRS_BR_CD                      " & vbNewLine _
                                                 & "           ,F02_01.OUTKA_PLAN_DATE                            AS OUTKA_PLAN_DATE                " & vbNewLine _
                                                 & "           ,F02_01.UNSO_NO_L                                  AS OUTKA_NO_L                     " & vbNewLine _
                                                 & "           ,''                                                AS SHITEN_TEL_560_1               " & vbNewLine _
                                                 & "           ,''                                                AS SHITEN_NM_560_1                " & vbNewLine _
                                                 & "           ,F02_01.ARR_PLAN_DATE                              AS ARR_PLAN_DATE                  " & vbNewLine _
                                                 & "           ,F02_01.ARR_PLAN_TIME                              AS ARR_PLAN_TIME                  " & vbNewLine _
                                                 & "           ,DEST2.TEL                                         AS DEST_TEL                       " & vbNewLine _
                                                 & "           ,''                                                AS CUST_TEL                       " & vbNewLine _
                                                 & "           ,''                                                AS CUST_AD_1                      " & vbNewLine _
                                                 & "           ,''                                                AS CUST_AD_2                      " & vbNewLine _
                                                 & "           ,DEST2.AD_1                                        AS DEST_AD_1                      " & vbNewLine _
                                                 & "           ,''                                                AS CUST_AD_3                      " & vbNewLine _
                                                 & "           ,DEST2.AD_2                                        AS DEST_AD_2                      " & vbNewLine _
                                                 & "           ,F02_01.AD_3                                       AS DEST_AD_3                      " & vbNewLine _
                                                 & "           ,max(F02_01.UNSO_WT)                               AS BETU_WT                        " & vbNewLine _
                                                 & "           ,DEST2.DEST_NM                                     AS DEST_NM_1                      " & vbNewLine _
                                                 & "           ,M07_01.CUST_NM_L                                  AS CUST_NM_L                      " & vbNewLine _
                                                 & "           ,DEST2.ZIP                                         AS DEST_ZIP                       " & vbNewLine _
                                                 & "           --,(F03_01.BETU_WT * F03_01.UNSO_TTL_NB)           AS UNSO_WT                        " & vbNewLine _
                                                 & "           ,SUM((F03_01.BETU_WT * F03_01.UNSO_TTL_NB))        AS UNSO_WT                        " & vbNewLine _
                                                 & "           ,F02_01.UNSO_PKG_NB                                AS UNSO_PKG_NB                    " & vbNewLine _
                                                 & "           ,''                                                AS CUST_NM_M                      " & vbNewLine _
                                                 & "           ,M01_01.NRS_BR_NM                                  AS NRS_BR_NM                      " & vbNewLine _
                                                 & "           ,''                                                AS DEST_HOSOKU                    " & vbNewLine _
                                                 & "           ,M01_01.AD_1                                       AS NRS_AD_1                       " & vbNewLine _
                                                 & "           ,M01_01.AD_2                                       AS NRS_AD_2                       " & vbNewLine _
                                                 & "           ,M01_01.TEL                                        AS NRS_TEL                        " & vbNewLine _
                                                 & "           ,F02_01.CUST_CD_L                                  AS CUST_CD_L                      " & vbNewLine _
                                                 & "           ,F02_01.REMARK                                     AS UNSO_L_REMARK                  " & vbNewLine _
                                                 & "           ,''                                                AS OUTKA_L_REMARK                 " & vbNewLine _
                                                 & "           ,MAX(ISNULL(F03_01.GOODS_NM,''))                   AS GOODS_NM_1                     " & vbNewLine _
                                                 & "           ,''                                                AS OUTKA_ATT                      " & vbNewLine _
                                                 & "           ,F02_01.BUY_CHU_NO                                 AS BUYER_ORD_NO                   " & vbNewLine _
                                                 & "           ,''                                                AS YELLOW_NO                      " & vbNewLine _
                                                 & "           ,''                                                AS SHIHARAI_SHITEN_NM_563_1       " & vbNewLine _
                                                 & "           ,''                                                AS SHIHARAI_SHITEN_TEL_563_1      " & vbNewLine _
                                                 & "           ,''                                                AS SHITEN_TEL_1_564_1             " & vbNewLine _
                                                 & "           ,''                                                AS SHITEN_NM_564_1                " & vbNewLine _
                                                 & "           ,''                                                AS SHITEN_TEL_2_564_1             " & vbNewLine _
                                                 & "           ,''                                                AS NRS_BR_AD_1                    " & vbNewLine _
                                                 & "           ,''                                                AS NRS_BR_AD_2                    " & vbNewLine _
                                                 & "           ,''                                                AS NRS_BR_NM_1                    " & vbNewLine _
                                                 & "           ,DEST2.DEST_NM                                     AS DEST_NM                        " & vbNewLine _
                                                 & "           ,DEST2.AD_1                                        AS AD_1                           " & vbNewLine _
                                                 & "           ,DEST2.AD_2                                        AS AD_2                           " & vbNewLine _
                                                 & "           ,F02_01.AD_3                                       AS AD_3                           " & vbNewLine _
                                                 & "           ,DEST2.TEL                                         AS TEL                            " & vbNewLine _
                                                 & "           ,DEST2.DEST_CD                                     AS DEST_CD                        " & vbNewLine _
                                                 & "           ,''                                                AS SHIP_CD_L                      " & vbNewLine _
                                                 & "           ,''                                                AS SHIHARAI_CD_565_1              " & vbNewLine _
                                                 & "           ,''                                                AS SHIHARAI_CD_565_2              " & vbNewLine _
                                                 & "           ,M01_01.FAX                                        AS NRS_FAX                        " & vbNewLine _
                                                 & "           ,''                                                AS NRS_AD_3                       " & vbNewLine _
                                                 & "           ,''                                                AS CUST_ORD_NO                    " & vbNewLine _
                                                 & "           ,MAX(M08_01.SHOBO_CD)                              AS SHOBO_CD                       " & vbNewLine _
                                                 & "           ,''                                                AS CUST_CD_L_568_1                " & vbNewLine _
                                                 & "           ,''                                                AS CUST_CD_L_568_2                " & vbNewLine _
                                                 & "           ,''                                                AS NRS_BR_ZIP                     " & vbNewLine _
                                                 & "           ,''                                                AS NRS_BR_TEL                     " & vbNewLine _
                                                 & "           ,''                                                AS KOTEI_1                        " & vbNewLine _
                                                 & "           ,''                                                AS KOTEI_2                        " & vbNewLine _
                                                 & "           ,''                                                AS KOTEI_3                        " & vbNewLine _
                                                 & "           ,''                                                AS NB_UT                          " & vbNewLine _
                                                 & "           ,''                                                AS DENPYO_NM                      " & vbNewLine _
                                                 & "           ,''                                                AS SHITEN_NM_570_1                " & vbNewLine _
                                                 & "           ,''                                                AS SHITEN_TEL_570_1               " & vbNewLine _
                                                 & "           ,F02_01.UNSO_PKG_NB                                AS OUTKA_PKG_NB                   " & vbNewLine _
                                                 & "           ,''                                                AS IRIME                          " & vbNewLine _
                                                 & "           ,''                                                AS IRIME_UT                       " & vbNewLine _
                                                 & "           ,''                                                AS ALCTD_NB                       " & vbNewLine _
                                                 & "           ,''                                                AS LOT_NO                         " & vbNewLine _
                                                 & "           ,''                                                AS SHITEN_NM_570_2                " & vbNewLine _
                                                 & "           ,''                                                AS SHITEN_TEL_570_2               " & vbNewLine _
                                                 & "           ,''                                                AS SHIHARAI_SHITEN_CD_563_1       " & vbNewLine _
                                                 & "           ,SHIPDEST.DEST_NM                                  AS SHIP_NM_L                      " & vbNewLine _
                                                 & "           ,''                                                AS UNSO_CUST_CD                   " & vbNewLine _
                                                 & "           ,KB0801.KBN_NM3                                    AS SHIHARAI_CD_575_1              " & vbNewLine _
                                                 & "           ,KB0802.KBN_NM3                                    AS SHIHARAI_CD_575_2              " & vbNewLine _
                                                 & "           ,CASE WHEN SHIPDEST.DEST_NM <> ''                                                    " & vbNewLine _
                                                 & "                      AND SHIPDEST.DEST_NM IS NOT NULL THEN SHIPDEST.DEST_NM                    " & vbNewLine _
                                                 & "                 WHEN M07_01.DENPYO_NM   <> ''                                                  " & vbNewLine _
                                                 & "                      AND M07_01.DENPYO_NM IS NOT NULL   THEN M07_01.DENPYO_NM                  " & vbNewLine _
                                                 & "                 ELSE M07_01.CUST_NM_L                                                          " & vbNewLine _
                                                 & "            END                                               AS ATSUKAISYA_NM                  " & vbNewLine _
                                                 & "           ,MIN(M08_01.GOODS_CD_CUST)                         AS GOODS_CD_CUST   --2012.05.25   " & vbNewLine _
                                                 & "         ,LEFT(JIS.JIS_CD , 2 )                             AS PREF_CD           --2012.05.25   " & vbNewLine _
                                                 & ",CASE WHEN LEFT(JIS.JIS_CD,2) ='16' OR                                                          " & vbNewLine _
                                                 & "          LEFT(JIS.JIS_CD,2) = '17' OR                                                          " & vbNewLine _
                                                 & "          LEFT(JIS.JIS_CD,2) = '18' OR                                                          " & vbNewLine _
                                                 & "          LEFT(JIS.JIS_CD,2) = '21' OR                                                          " & vbNewLine _
                                                 & "          LEFT(JIS.JIS_CD,2) = '25'                  --ここまで飛騨運輸のエリア                 " & vbNewLine _
                                                 & "          THEN '飛騨運輸'                                                                       " & vbNewLine _
                                                 & "    WHEN  LEFT(JIS.JIS_CD,2) = '24' OR                                                          " & vbNewLine _
                                                 & "          LEFT(JIS.JIS_CD,2) = '29' OR                                                          " & vbNewLine _
                                                 & "          LEFT(JIS.JIS_CD,2) = '30' OR                                                          " & vbNewLine _
                                                 & "          LEFT(JIS.JIS_CD,2) = '47'                 --ここまで近鉄運輸のエリア                  " & vbNewLine _
                                                 & "          THEN '近鉄運輸'                                                                       " & vbNewLine _
                                                 & "    WHEN  LEFT(JIS.JIS_CD,2) = '26' OR                                                          " & vbNewLine _
                                                 & "          LEFT(JIS.JIS_CD,2) = '28' OR                                                          " & vbNewLine _
                                                 & "          LEFT(JIS.JIS_CD,2) = '31' OR                                                          " & vbNewLine _
                                                 & "          LEFT(JIS.JIS_CD,2) = '32' OR                                                          " & vbNewLine _
                                                 & "          LEFT(JIS.JIS_CD,2) = '33' OR                                                          " & vbNewLine _
                                                 & "          LEFT(JIS.JIS_CD,2) = '34' OR                                                          " & vbNewLine _
                                                 & "          LEFT(JIS.JIS_CD,2) = '35' OR                                                          " & vbNewLine _
                                                 & "          LEFT(JIS.JIS_CD,2) = '36' OR                                                          " & vbNewLine _
                                                 & "          LEFT(JIS.JIS_CD,2) = '37' OR                                                          " & vbNewLine _
                                                 & "          LEFT(JIS.JIS_CD,2) = '38' OR                                                          " & vbNewLine _
                                                 & "          LEFT(JIS.JIS_CD,2) = '39'                                                             " & vbNewLine _
                                                 & "          THEN '岡山県貨物'                                                                     " & vbNewLine _
                                                 & "          ELSE    '' END            AS TORI_UNSOCO_NM                                           " & vbNewLine _
                                                 & "         --,MUC.UNSOCO_NM                                     AS TORI_UNSOCO_NM  --2012.05.25   " & vbNewLine _
                                                 & "           ,MCD_SAI.SET_NAIYO                                   AS SAI_SHIHARAI_CD --2012.05.25 " & vbNewLine _
                                                 & "           ,MCD_SAI.SET_NAIYO_3        AS SET_NM_L               --2012.05.29                   " & vbNewLine _
                                                 & "           ,MCD_NFC.SET_NAIYO          AS NAIYO1                 --2012.06.01                   " & vbNewLine _
                                                 & "           ,MCD_NFC.SET_NAIYO_2        AS NAIYO2                 --2012.06.01                   " & vbNewLine _
                                                 & "           ,MCD_NFC.SET_NAIYO_3        AS NAIYO3                 --2012.06.01                   " & vbNewLine _
                                                 & "           ,MCD_SAI.SET_NAIYO_2        AS NAIYO_CUST_NM          --2012.06.04                   " & vbNewLine _
                                                 & "           ,''                         AS CUST_ORD_NO_DTL        --2012.06.11                   " & vbNewLine _
                                                 & "           ,''                         AS KBN_CUST_ZIP           --2012.06.18                   " & vbNewLine _
                                                 & "           ,''                         AS KBN_CUST_AD            --2012.06.18                   " & vbNewLine _
                                                 & "           ,''                         AS KBN_CUST_TEL           --2012.06.18                   " & vbNewLine _
                                                 & "           ,''                         AS KBN_CUST_NM            --2012.06.18                   " & vbNewLine _
                                                 & "           ,''                         AS OUTKO_DATE             --2012.06.18                   " & vbNewLine _
                                                 & "           ,''                         AS ALCTD_WT               --2012.06.18                   " & vbNewLine _
                                                 & "           ,''                         AS BUKA_CD                --2012.06.18                   " & vbNewLine _
                                                 & "           ,DEST2.REMARK               AS REMARK_DEST            --2012.07.24 丸和運輸　荷受人氏名下の注意書き(REMARK)開始    " & vbNewLine _
                                                 & "           ,ISNULL(MCD_CUST.CUST_NAIYO_1,'') AS CUST_FLG                                        " & vbNewLine _
                                                 & "           ,F02_01.AUTO_DENP_KBN           AS AUTO_DENP_KBN                                     " & vbNewLine _
                                                 & "           ,F02_01.AUTO_DENP_NO            AS AUTO_DENP_NO                                      " & vbNewLine _
                                                & "  FROM      $LM_TRN$..F_UNSO_L    F02_01                                                        " & vbNewLine _
                                                 & "  LEFT JOIN $LM_MST$..M_NRS_BR    M01_01                                                        " & vbNewLine _
                                                 & "         ON F02_01.NRS_BR_CD    = M01_01.NRS_BR_CD                                              " & vbNewLine _
                                                 & "        AND M01_01.SYS_DEL_FLG  = '0'                                                           " & vbNewLine _
                                                 & "  LEFT JOIN $LM_MST$..M_CUST      M07_01                                                        " & vbNewLine _
                                                 & "         ON F02_01.NRS_BR_CD    = M07_01.NRS_BR_CD                                              " & vbNewLine _
                                                 & "        AND F02_01.CUST_CD_L    = M07_01.CUST_CD_L                                              " & vbNewLine _
                                                 & "        AND F02_01.CUST_CD_M    = M07_01.CUST_CD_M                                              " & vbNewLine _
                                                 & "        AND M07_01.CUST_CD_S    = '00'                                                          " & vbNewLine _
                                                 & "        AND M07_01.CUST_CD_SS   = '00'                                                          " & vbNewLine _
                                                 & "        AND M07_01.SYS_DEL_FLG  = '0'                                                           " & vbNewLine _
                                                 & "  LEFT JOIN $LM_MST$..M_DEST      M10_01                                                        " & vbNewLine _
                                                 & "         ON F02_01.NRS_BR_CD    = M10_01.NRS_BR_CD                                              " & vbNewLine _
                                                 & "        AND F02_01.CUST_CD_L    = M10_01.CUST_CD_L                                              " & vbNewLine _
                                                 & "        AND F02_01.DEST_CD      = M10_01.DEST_CD                                                " & vbNewLine _
                                                 & "        AND M10_01.SYS_DEL_FLG  = '0'                                                           " & vbNewLine _
                                                 & "  LEFT JOIN  $LM_MST$..M_DEST   SHIPDEST                                                        " & vbNewLine _
                                                 & "         ON  F02_01.NRS_BR_CD   = SHIPDEST.NRS_BR_CD                                            " & vbNewLine _
                                                 & "        AND  F02_01.CUST_CD_L   = SHIPDEST.CUST_CD_L                                            " & vbNewLine _
                                                 & "        AND  F02_01.SHIP_CD     = SHIPDEST.DEST_CD                                              " & vbNewLine _
                                                 & "        AND  SHIPDEST.SYS_DEL_FLG = '0'                                                         " & vbNewLine _
                                                 & "--区分マスタ(LMC575支払コード(NM3)KB0801)                                                       " & vbNewLine _
                                                 & "        LEFT JOIN $LM_MST$..Z_KBN KB0801                                                        " & vbNewLine _
                                                 & "        ON  KB0801.KBN_GROUP_CD = 'O007'                                                        " & vbNewLine _
                                                 & "        AND KB0801.KBN_CD       = '16'                                                          " & vbNewLine _
                                                 & "        AND KB0801.SYS_DEL_FLG  = '0'                                                           " & vbNewLine _
                                                 & "--区分マスタ(LMC575支払コード(NM3)KB0802)                                                       " & vbNewLine _
                                                 & "        LEFT JOIN $LM_MST$..Z_KBN KB0802                                                        " & vbNewLine _
                                                 & "        ON  KB0802.KBN_GROUP_CD = 'O007'                                                        " & vbNewLine _
                                                 & "        AND KB0802.KBN_CD       = '17'                                                          " & vbNewLine _
                                                 & "        AND KB0802.SYS_DEL_FLG  = '0'                                                           " & vbNewLine _
                                                 & "--区分マスタ(LMC670 KB0803)                                                                     " & vbNewLine _
                                                 & "        LEFT JOIN $LM_MST$..Z_KBN KB0803                                                        " & vbNewLine _
                                                 & "        ON  KB0803.KBN_GROUP_CD = 'O007'                                                        " & vbNewLine _
                                                 & "        AND KB0803.KBN_CD       = '18'                                                          " & vbNewLine _
                                                 & "        AND KB0803.SYS_DEL_FLG  = '0'                                                           " & vbNewLine _
                                                 & "  LEFT JOIN $LM_MST$..M_DEST      DEST2                                                         " & vbNewLine _
                                                 & "         ON F02_01.NRS_BR_CD    = DEST2.NRS_BR_CD                                               " & vbNewLine _
                                                 & "        AND F02_01.CUST_CD_L    = DEST2.CUST_CD_L                                               " & vbNewLine _
                                                 & "        --要望番号834対応　F_UNSO_LとのJOINをORIG_CDからDEST_CDに変更 -- START --               " & vbNewLine _
                                                 & "        --AND F02_01.ORIG_CD    = DEST2.DEST_CD                                                 " & vbNewLine _
                                                 & "        AND F02_01.DEST_CD      = DEST2.DEST_CD                                                 " & vbNewLine _
                                                 & "        --要望番号834対応　F_UNSO_LとのJOINをORIG_CDからDEST_CDに変更 --  END  --               " & vbNewLine _
                                                 & "        AND M10_01.SYS_DEL_FLG  = '0'                                                           " & vbNewLine _
                                                 & "--JISマスタ(LMC661にてJIS_CD2桁：都道府県コード取得)2012.05.25                                  " & vbNewLine _
                                                 & "  LEFT JOIN  $LM_MST$..M_JIS   JIS                                                              " & vbNewLine _
                                                 & "         ON  JIS.JIS_CD       = M10_01.JIS                                                      " & vbNewLine _
                                                 & "        AND  JIS.SYS_DEL_FLG  = '0'                                                             " & vbNewLine _
                                                 & "--運送会社マスタ(LMC589にてUNSOCO_NM：取次先運送会社名取得)2012.05.25                           " & vbNewLine _
                                                 & "--  LEFT JOIN  $LM_MST$..M_UNSOCO   MUC                                                         " & vbNewLine _
                                                 & "--         ON  MUC.NRS_BR_CD    = F02_01.NRS_BR_CD                                              " & vbNewLine _
                                                 & "--        AND  MUC.UNSOCO_CD    = F02_01.UNSO_CD                                                " & vbNewLine _
                                                 & "--        AND  MUC.UNSOCO_BR_CD = F02_01.UNSO_BR_CD                                             " & vbNewLine _
                                                 & "--        AND  MUC.SYS_DEL_FLG  = '0'                                                           " & vbNewLine _
                                                 & "--荷主明細マスタ(LMC660にてSET_NAIYO：支払コード取得)2012.05.25                                 " & vbNewLine _
                                                 & "  LEFT JOIN $LM_MST$..M_CUST_DETAILS MCD_SAI                                                    " & vbNewLine _
                                                 & "         ON MCD_SAI.NRS_BR_CD   = F02_01.NRS_BR_CD                                              " & vbNewLine _
                                                 & "        AND MCD_SAI.CUST_CD      = F02_01.CUST_CD_L                                             " & vbNewLine _
                                                 & "--        AND MCD_SAI.CUST_CD_EDA  = F02_01.CUST_CD_M                                             " & vbNewLine _
                                                 & "        AND MCD_SAI.SUB_KB       = '27'                                                         " & vbNewLine _
                                                 & "        AND MCD_SAI.SYS_DEL_FLG  = '0'                                                          " & vbNewLine _
                                                 & "--荷主明細マスタ(LMC669にてSET_NAIYO：荷送人名称取得)2012.06.01                                 " & vbNewLine _
                                                 & "  LEFT JOIN $LM_MST$..M_CUST_DETAILS MCD_NFC                                                    " & vbNewLine _
                                                 & "         ON MCD_NFC.NRS_BR_CD   = F02_01.NRS_BR_CD                                              " & vbNewLine _
                                                 & "        AND MCD_NFC.CUST_CD      = F02_01.CUST_CD_L                                             " & vbNewLine _
                                                 & "--        AND MCD_NFC.CUST_CD_EDA  = F02_01.CUST_CD_M--notes 1118                               " & vbNewLine _
                                                 & "        AND MCD_NFC.SUB_KB       = '29'                                                         " & vbNewLine _
                                                 & "        AND MCD_NFC.SYS_DEL_FLG  = '0'                                                          " & vbNewLine _
                                                 & " --要望番号1383 [LMC664] --- START ---                                                          " & vbNewLine _
                                                 & "         LEFT JOIN (SELECT NRS_BR_CD   AS NRS_BR_CD                                             " & vbNewLine _
                                                 & "                         , CUST_CD     AS CUST_CD                                               " & vbNewLine _
                                                 & "                         , CUST_CLASS  AS CUST_CLASS                                            " & vbNewLine _
                                                 & "                         , SET_NAIYO   AS CUST_NAIYO_1                                          " & vbNewLine _
                                                 & "                         , SET_NAIYO_2 AS CUST_NAIYO_2                                          " & vbNewLine _
                                                 & "                         , SET_NAIYO_3 AS CUST_NAIYO_3                                          " & vbNewLine _
                                                 & "                      FROM $LM_MST$..M_CUST_DETAILS                                             " & vbNewLine _
                                                 & "                     WHERE SUB_KB ='42'                                                         " & vbNewLine _
                                                 & "                       AND SET_NAIYO_2 = @RPT_ID                                                " & vbNewLine _
                                                 & "                       AND SYS_DEL_FLG = '0'                                                    " & vbNewLine _
                                                 & "                    ) MCD_CUST                                                                  " & vbNewLine _
                                                 & "                ON M07_01.NRS_BR_CD = MCD_CUST.NRS_BR_CD                                        " & vbNewLine _
                                                 & "               AND (CASE WHEN MCD_CUST.CUST_CLASS='00' THEN  M07_01.CUST_CD_L                                                            " & vbNewLine _
                                                 & "                         WHEN MCD_CUST.CUST_CLASS='01' THEN (M07_01.CUST_CD_L + M07_01.CUST_CD_M)                                        " & vbNewLine _
                                                 & "                         WHEN MCD_CUST.CUST_CLASS='02' THEN (M07_01.CUST_CD_L + M07_01.CUST_CD_M + M07_01.CUST_CD_S)                     " & vbNewLine _
                                                 & "                         WHEN MCD_CUST.CUST_CLASS='03' THEN (M07_01.CUST_CD_L + M07_01.CUST_CD_M + M07_01.CUST_CD_S + M07_01.CUST_CD_SS) " & vbNewLine _
                                                 & "                    END                                                                         " & vbNewLine _
                                                 & "                   ) = MCD_CUST.CUST_CD                                                         " & vbNewLine _
                                                 & " --要望番号1383 [LMC664] --- END ---                                                            " & vbNewLine
    '& "           --送状番号自動採番用 2016.07.23--- STD ---                                           " & vbNewLine _
    '& "           ,FL.AUTO_DENP_KBN           AS AUTO_DENP_KBN                                         " & vbNewLine _
    '& "           ,FL.AUTO_DENP_NO            AS AUTO_DENP_NO                                          " & vbNewLine _
    '& "           --送状番号自動採番用 2016.07.23--- END ---                                           " & vbNewLine
#End If
    ''' <summary>
    ''' 帳票PTN
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_FROM_UNSO_PRT As String = "  LEFT JOIN $LM_TRN$..F_UNSO_M   F03_01                                                            " & vbNewLine _
                                              & "         ON F02_01.NRS_BR_CD   = F03_01.NRS_BR_CD                                                  " & vbNewLine _
                                              & "        AND F02_01.UNSO_NO_L   = F03_01.UNSO_NO_L                                                  " & vbNewLine _
                                              & "        AND F03_01.SYS_DEL_FLG = '0'                                                               " & vbNewLine _
                                              & "  LEFT JOIN $LM_MST$..M_GOODS    M08_01                                                            " & vbNewLine _
                                              & "    ON F02_01.NRS_BR_CD        = M08_01.NRS_BR_CD                                                  " & vbNewLine _
                                              & "   AND F03_01.GOODS_CD_NRS     = M08_01.GOODS_CD_NRS                                               " & vbNewLine _
                                              & "   AND M08_01.SYS_DEL_FLG      = '0'                                                               " & vbNewLine _
                                              & "  LEFT JOIN $LM_MST$..M_UNSO_CUST_RPT M68_01                                                       " & vbNewLine _
                                              & "    ON F02_01.NRS_BR_CD        = M68_01.NRS_BR_CD                                                  " & vbNewLine _
                                              & "   AND F02_01.UNSO_CD          = M68_01.UNSOCO_CD                                                  " & vbNewLine _
                                              & "   AND F02_01.UNSO_BR_CD       = M68_01.UNSOCO_BR_CD                                               " & vbNewLine _
                                              & "   AND M68_01.PTN_ID           = '11'                                                              " & vbNewLine _
                                              & "   AND F02_01.PC_KB            = M68_01.MOTO_TYAKU_KB                                              " & vbNewLine _
                                              & "   AND M68_01.CUST_CD_L        = ''                                                                " & vbNewLine _
                                              & "   AND M68_01.CUST_CD_M        = ''                                                                " & vbNewLine _
                                              & "   AND M68_01.SYS_DEL_FLG      = '0'                                                               " & vbNewLine _
                                              & "  LEFT JOIN $LM_MST$..M_RPT      M22_01                                                            " & vbNewLine _
                                              & "    ON M68_01.NRS_BR_CD        = M22_01.NRS_BR_CD                                                  " & vbNewLine _
                                              & "   AND M68_01.PTN_ID           = M22_01.PTN_ID                                                     " & vbNewLine _
                                              & "   AND M68_01.PTN_CD           = M22_01.PTN_CD                                                     " & vbNewLine _
                                              & "   AND M22_01.SYS_DEL_FLG = '0'                                                                    " & vbNewLine _
                                              & "  LEFT JOIN $LM_MST$..M_UNSO_CUST_RPT M68_02                                                       " & vbNewLine _
                                              & "    ON F02_01.NRS_BR_CD        = M68_02.NRS_BR_CD                                                  " & vbNewLine _
                                              & "   AND F02_01.UNSO_CD          = M68_02.UNSOCO_CD                                                  " & vbNewLine _
                                              & "   AND F02_01.UNSO_BR_CD       = M68_02.UNSOCO_BR_CD                                               " & vbNewLine _
                                              & "   AND M68_02.PTN_ID           = '11'                                                              " & vbNewLine _
                                              & "   AND F02_01.PC_KB            = M68_02.MOTO_TYAKU_KB                                              " & vbNewLine _
                                              & "   AND F02_01.CUST_CD_L        = M68_02.CUST_CD_L                                                  " & vbNewLine _
                                              & "   AND F02_01.CUST_CD_M        = M68_02.CUST_CD_M                                                  " & vbNewLine _
                                              & "   AND M68_02.SYS_DEL_FLG      = '0'                                                               " & vbNewLine _
                                              & "  LEFT JOIN $LM_MST$..M_RPT      M22_02                                                            " & vbNewLine _
                                              & "    ON M68_02.NRS_BR_CD        = M22_02.NRS_BR_CD                                                  " & vbNewLine _
                                              & "   AND M68_02.PTN_ID           = M22_02.PTN_ID                                                     " & vbNewLine _
                                              & "   AND M22_02.SYS_DEL_FLG = '0'                                                                    " & vbNewLine _
                                              & "   AND M68_02.PTN_CD           = M22_02.PTN_CD                                                     " & vbNewLine _
                                              & "     --倉庫マスタ                                                                                  " & vbNewLine _
                                              & "  LEFT JOIN LM_MST..M_SOKO SOKO                                                                    " & vbNewLine _
                                              & "   ON  SOKO.NRS_BR_CD  = M07_01.NRS_BR_CD                                                          " & vbNewLine _
                                              & "  AND  SOKO.WH_CD      = M07_01.DEFAULT_SOKO_CD                                                    " & vbNewLine


#If True Then   'ADD 2020/01/16 009792【LMS】RD帳票作成_アンファー:送り状・納品書亜種
    ''' <summary>
    ''' 帳票PTN 825
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_FROM_UNSO_ANF As String = "  LEFT JOIN $LM_TRN$..F_UNSO_M   F03_01                                                            " & vbNewLine _
                                              & "         ON F02_01.NRS_BR_CD   = F03_01.NRS_BR_CD                                                  " & vbNewLine _
                                              & "        AND F02_01.UNSO_NO_L   = F03_01.UNSO_NO_L                                                  " & vbNewLine _
                                              & "        AND F03_01.SYS_DEL_FLG = '0'                                                               " & vbNewLine _
                                              & "  LEFT JOIN $LM_MST$..M_GOODS    M08_01                                                            " & vbNewLine _
                                              & "    ON F02_01.NRS_BR_CD        = M08_01.NRS_BR_CD                                                  " & vbNewLine _
                                              & "   AND F03_01.GOODS_CD_NRS     = M08_01.GOODS_CD_NRS                                               " & vbNewLine _
                                              & "   AND M08_01.SYS_DEL_FLG      = '0'                                                               " & vbNewLine _
                                              & "  LEFT JOIN $LM_MST$..M_UNSO_CUST_RPT M68_01                                                       " & vbNewLine _
                                              & "    ON F02_01.NRS_BR_CD        = M68_01.NRS_BR_CD                                                  " & vbNewLine _
                                              & "   AND F02_01.UNSO_CD          = M68_01.UNSOCO_CD                                                  " & vbNewLine _
                                              & "   AND F02_01.UNSO_BR_CD       = M68_01.UNSOCO_BR_CD                                               " & vbNewLine _
                                              & "   AND M68_01.PTN_ID           = '11'                                                              " & vbNewLine _
                                              & "   AND F02_01.PC_KB            = M68_01.MOTO_TYAKU_KB                                              " & vbNewLine _
                                              & "   AND M68_01.CUST_CD_L        = ''                                                                " & vbNewLine _
                                              & "   AND M68_01.CUST_CD_M        = ''                                                                " & vbNewLine _
                                              & "   AND M68_01.SYS_DEL_FLG      = '0'                                                               " & vbNewLine _
                                              & "  LEFT JOIN $LM_MST$..M_RPT      M22_01                                                            " & vbNewLine _
                                              & "    ON M68_01.NRS_BR_CD        = M22_01.NRS_BR_CD                                                  " & vbNewLine _
                                              & "   AND M68_01.PTN_ID           = M22_01.PTN_ID                                                     " & vbNewLine _
                                              & "   AND M68_01.PTN_CD           = M22_01.PTN_CD                                                     " & vbNewLine _
                                              & "   AND M22_01.SYS_DEL_FLG = '0'                                                                    " & vbNewLine _
                                              & "  LEFT JOIN $LM_MST$..M_UNSO_CUST_RPT M68_02                                                       " & vbNewLine _
                                              & "    ON F02_01.NRS_BR_CD        = M68_02.NRS_BR_CD                                                  " & vbNewLine _
                                              & "   AND F02_01.UNSO_CD          = M68_02.UNSOCO_CD                                                  " & vbNewLine _
                                              & "   AND F02_01.UNSO_BR_CD       = M68_02.UNSOCO_BR_CD                                               " & vbNewLine _
                                              & "   AND M68_02.PTN_ID           = '11'                                                              " & vbNewLine _
                                              & "   AND F02_01.PC_KB            = M68_02.MOTO_TYAKU_KB                                              " & vbNewLine _
                                              & "   AND F02_01.CUST_CD_L        = M68_02.CUST_CD_L                                                  " & vbNewLine _
                                              & "   AND F02_01.CUST_CD_M        = M68_02.CUST_CD_M                                                  " & vbNewLine _
                                              & "   AND M68_02.SYS_DEL_FLG      = '0'                                                               " & vbNewLine _
                                              & "  LEFT JOIN $LM_MST$..M_RPT      M22_02                                                            " & vbNewLine _
                                              & "    ON M68_02.NRS_BR_CD        = M22_02.NRS_BR_CD                                                  " & vbNewLine _
                                              & "   AND M68_02.PTN_ID           = M22_02.PTN_ID                                                     " & vbNewLine _
                                              & "   AND M22_02.SYS_DEL_FLG = '0'                                                                    " & vbNewLine _
                                              & "   AND M68_02.PTN_CD           = M22_02.PTN_CD                                                     " & vbNewLine _
                                              & "     --倉庫マスタ                                                                                  " & vbNewLine _
                                              & "  LEFT JOIN LM_MST..M_SOKO SOKO                                                                    " & vbNewLine _
                                              & "   ON  SOKO.NRS_BR_CD  = M07_01.NRS_BR_CD                                                          " & vbNewLine _
                                              & "  AND  SOKO.WH_CD      = M07_01.DEFAULT_SOKO_CD                                                    " & vbNewLine _
                                              & " --運送M(中MIN)                                                                                    " & vbNewLine _
                                              & " LEFT OUTER JOIN                                                                                   " & vbNewLine _
                                              & "        (SELECT                                                                                    " & vbNewLine _
                                              & "            NRS_BR_CD                                                                              " & vbNewLine _
                                              & "            ,UNSO_NO_L                                                                             " & vbNewLine _
                                              & "            ,MIN(UNSO_NO_M) AS  UNSO_NO_M                                                          " & vbNewLine _
                                              & "        FROM $LM_TRN$..F_UNSO_M WHERE SYS_DEL_FLG ='0'                                             " & vbNewLine _
                                              & "         AND NRS_BR_CD = @NRS_BR_CD                                                                " & vbNewLine _
                                              & "         AND UNSO_NO_L = @OUTKA_NO_L                                                               " & vbNewLine _
                                              & "        GROUP BY NRS_BR_CD,UNSO_NO_L) UNSOM_MIN                                                    " & vbNewLine _
                                              & "         ON UNSOM_MIN.NRS_BR_CD      = F02_01.NRS_BR_CD                                            " & vbNewLine _
                                              & "        AND UNSOM_MIN.UNSO_NO_L      = F02_01.UNSO_NO_L                                            " & vbNewLine _
                                              & " --運送M(中MIN)                                                                                    " & vbNewLine _
                                              & " LEFT JOIN $LM_TRN$..F_UNSO_M UNSOM2                                                              " & vbNewLine _
                                              & "   ON  UNSOM2.NRS_BR_CD = F02_01.NRS_BR_CD                                                         " & vbNewLine _
                                              & "  AND UNSOM2.UNSO_NO_L  = F02_01.UNSO_NO_L                                                         " & vbNewLine _
                                              & "  AND UNSOM2.UNSO_NO_M  = UNSOM_MIN.UNSO_NO_M                                                      " & vbNewLine _
                                              & " AND UNSOM2.SYS_DEL_FLG = '0'                                                                      " & vbNewLine _
                                              & " --商品詳細                                                                                        " & vbNewLine _
                                              & " LEFT JOIN  $LM_MST$..M_GOODS_DETAILS  MGD2                                                        " & vbNewLine _
                                              & "   ON MGD2.SUB_KB       = '73'                                                                     " & vbNewLine _
                                              & "  AND MGD2.SYS_DEL_FLG  = '0'                                                                      " & vbNewLine _
                                              & "  AND MGD2.NRS_BR_CD    = UNSOM2.NRS_BR_CD                                                         " & vbNewLine _
                                              & "  AND MGD2.GOODS_CD_NRS = UNSOM2.GOODS_CD_NRS                                                      " & vbNewLine

#End If

    ''' <summary>
    ''' 運送グループ条件
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_GROUP_UNSO_DATA As String = " GROUP BY                           " & vbNewLine _
                                                & "          M22_02.PTN_CD             " & vbNewLine _
                                                & "        , M22_02.RPT_ID             " & vbNewLine _
                                                & "        , M22_01.PTN_CD             " & vbNewLine _
                                                & "        , M22_01.RPT_ID             " & vbNewLine _
                                                & "        , M07_01.DENPYO_NM          " & vbNewLine _
                                                & "        , M07_01.CUST_NM_L          " & vbNewLine _
                                                & "--      , M08_01.GOODS_CD_CUST      " & vbNewLine _
                                                & "        , JIS.JIS_CD                " & vbNewLine _
                                                & "        , F02_01.NRS_BR_CD          " & vbNewLine _
                                                & "        , F02_01.OUTKA_PLAN_DATE    " & vbNewLine _
                                                & "        , F02_01.UNSO_NO_L          " & vbNewLine _
                                                & "        , F02_01.ARR_PLAN_DATE      " & vbNewLine _
                                                & "        , F02_01.ARR_PLAN_TIME      " & vbNewLine _
                                                & "        , DEST2.TEL                 " & vbNewLine _
                                                & "        , DEST2.AD_1                " & vbNewLine _
                                                & "        , DEST2.AD_2                " & vbNewLine _
                                                & "        , F02_01.AD_3               " & vbNewLine _
                                                & "        , DEST2.DEST_NM             " & vbNewLine _
                                                & "        , M07_01.CUST_NM_L          " & vbNewLine _
                                                & "        , DEST2.ZIP                 " & vbNewLine _
                                                & "        , F02_01.UNSO_PKG_NB        " & vbNewLine _
                                                & "        , M01_01.NRS_BR_NM          " & vbNewLine _
                                                & "        , M01_01.AD_1               " & vbNewLine _
                                                & "        , M01_01.AD_2               " & vbNewLine _
                                                & "        , M01_01.TEL                " & vbNewLine _
                                                & "        , F02_01.CUST_CD_L          " & vbNewLine _
                                                & "        , F02_01.REMARK             " & vbNewLine _
                                                & "        , F02_01.BUY_CHU_NO         " & vbNewLine _
                                                & "        , DEST2.DEST_NM             " & vbNewLine _
                                                & "        , DEST2.AD_1                " & vbNewLine _
                                                & "        , DEST2.AD_2                " & vbNewLine _
                                                & "        , DEST2.AD_3                " & vbNewLine _
                                                & "        , DEST2.TEL                 " & vbNewLine _
                                                & "        , DEST2.DEST_CD             " & vbNewLine _
                                                & "        , M01_01.FAX                " & vbNewLine _
                                                & "        , SHIPDEST.DEST_NM          " & vbNewLine _
                                                & "        , KB0801.KBN_NM3            " & vbNewLine _
                                                & "        , KB0802.KBN_NM3            " & vbNewLine _
                                                & "        , MCD_SAI.SET_NAIYO         " & vbNewLine _
                                                & "        , MCD_SAI.SET_NAIYO_3       " & vbNewLine _
                                                & "        , MCD_NFC.SET_NAIYO         " & vbNewLine _
                                                & "        , MCD_NFC.SET_NAIYO_2       " & vbNewLine _
                                                & "        , MCD_NFC.SET_NAIYO_3       " & vbNewLine _
                                                & "        , MCD_SAI.SET_NAIYO_2       " & vbNewLine _
                                                & "        , DEST2.REMARK              " & vbNewLine _
                                                & "        , MCD_CUST.CUST_NAIYO_1     " & vbNewLine _
                                                & "        , F02_01.AUTO_DENP_KBN      " & vbNewLine _
                                                & "        , F02_01.AUTO_DENP_NO       " & vbNewLine _
                                                & "        , SOKO.AD_1                 " & vbNewLine _
                                                & "        , SOKO.AD_2                 " & vbNewLine _
                                                & "        , SOKO.WH_NM                " & vbNewLine _
                                                & "        , SOKO.TEL                  " & vbNewLine _
                                                & "        , SOKO.FAX                  " & vbNewLine

#If True Then   'ADD 2018/11/07 依頼番号 : 002535   【LMS】トール_運送画面から送状印刷できるように変更
    ''' <summary>
    ''' 運送グループ条件追加アンファ
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_GROUP_UNSO_ANF As String = "         ,MGD2.SET_NAIYO             " & vbNewLine
#End If

    ''' <summary>
    ''' 運送抽出条件
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_WHERE_UNSO_DATA As String = "      WHERE  F02_01.UNSO_NO_L   = @OUTKA_NO_L                                                    " & vbNewLine _
                                                & "        AND  F02_01.SYS_DEL_FLG = '0'                                                            " & vbNewLine

#Region "埼玉BP"

    ''' <summary>
    ''' 運送データ取得
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_SELECT_UNSO_DATA_BPC As String = "SELECT                                                                                      " & vbNewLine _
                                                 & "       CASE WHEN M22_02.PTN_CD IS NOT NULL THEN M22_02.RPT_ID                                   " & vbNewLine _
                                                 & "            WHEN M22_01.PTN_CD IS NOT NULL THEN M22_01.RPT_ID                                   " & vbNewLine _
                                                 & "            ELSE '' END                                       AS RPT_ID                         " & vbNewLine _
                                                 & "           ,F02_01.NRS_BR_CD                                  AS NRS_BR_CD                      " & vbNewLine _
                                                 & "           ,F02_01.OUTKA_PLAN_DATE                            AS OUTKA_PLAN_DATE                " & vbNewLine _
                                                 & "           ,F02_01.UNSO_NO_L                                  AS OUTKA_NO_L                     " & vbNewLine _
                                                 & "           ,''                                                AS SHITEN_TEL_560_1               " & vbNewLine _
                                                 & "           ,''                                                AS SHITEN_NM_560_1                " & vbNewLine _
                                                 & "           ,F02_01.ARR_PLAN_DATE                              AS ARR_PLAN_DATE                  " & vbNewLine _
                                                 & "           ,F02_01.ARR_PLAN_TIME                              AS ARR_PLAN_TIME                  " & vbNewLine _
                                                 & "           ,DEST2.TEL                                         AS DEST_TEL                       " & vbNewLine _
                                                 & "           ,''                                                AS CUST_TEL                       " & vbNewLine _
                                                 & "           ,''                                                AS CUST_AD_1                      " & vbNewLine _
                                                 & "           ,''                                                AS CUST_AD_2                      " & vbNewLine _
                                                 & "           ,DEST2.AD_1                                        AS DEST_AD_1                      " & vbNewLine _
                                                 & "           ,''                                                AS CUST_AD_3                      " & vbNewLine _
                                                 & "           ,DEST2.AD_2                                        AS DEST_AD_2                      " & vbNewLine _
                                                 & "           ,F02_01.AD_3                                        AS DEST_AD_3                      " & vbNewLine _
                                                 & "           ,''                                                AS BETU_WT                        " & vbNewLine _
                                                 & "           ,DEST2.DEST_NM                                     AS DEST_NM_1                      " & vbNewLine _
                                                 & "           ,M07_01.CUST_NM_L                                  AS CUST_NM_L                      " & vbNewLine _
                                                 & "           ,DEST2.ZIP                                         AS DEST_ZIP                       " & vbNewLine _
                                                 & "--(2013.07.09)要望番号2076 --- START ---運送Lの運送重量を使用                                   " & vbNewLine _
                                                 & "--(2012.12.10)要望番号1682 --- START ---                                                        " & vbNewLine _
                                                 & "           --,(F03_01.BETU_WT * F03_01.UNSO_TTL_NB)           AS UNSO_WT                        " & vbNewLine _
                                                 & "           --,SUM((F03_01.BETU_WT * F03_01.UNSO_TTL_NB))        AS UNSO_WT                        " & vbNewLine _
                                                 & "--(2012.12.10)要望番号1682 ---  END  ---                                                        " & vbNewLine _
                                                 & "           ,F02_01.UNSO_WT                                    AS UNSO_WT                        " & vbNewLine _
                                                 & "--(2013.07.09)要望番号2076 --- END ---運送Lの運送重量を使用                                   " & vbNewLine _
                                                 & "           ,F02_01.UNSO_PKG_NB                                AS UNSO_PKG_NB                    " & vbNewLine _
                                                 & "           ,''                                                AS CUST_NM_M                      " & vbNewLine _
                                                 & "           ,M01_01.NRS_BR_NM                                  AS NRS_BR_NM                      " & vbNewLine _
                                                 & "           ,''                                                AS DEST_HOSOKU                    " & vbNewLine _
                                                 & "           ,M01_01.AD_1                                       AS NRS_AD_1                       " & vbNewLine _
                                                 & "           ,M01_01.AD_2                                       AS NRS_AD_2                       " & vbNewLine _
                                                 & "           ,M01_01.TEL                                        AS NRS_TEL                        " & vbNewLine _
                                                 & "           ,F02_01.CUST_CD_L                                  AS CUST_CD_L                      " & vbNewLine _
                                                 & "           ,F02_01.REMARK                                     AS UNSO_L_REMARK                  " & vbNewLine _
                                                 & "           ,''                                                AS OUTKA_L_REMARK                 " & vbNewLine _
                                                 & "		   ,ISNULL((SELECT BASE.GOODS_NM AS GOODS_NM_1                                          " & vbNewLine _
                                                 & "			 FROM                                                                               " & vbNewLine _
                                                 & "			(SELECT UNSO_M.GOODS_NM AS GOODS_NM                                                 " & vbNewLine _
                                                 & "			      ,UNSO_M.UNSO_NO_M AS UNSO_NO_M			                                    " & vbNewLine _
                                                 & "			      ,ROW_NUMBER() OVER (ORDER BY UNSO_NO_M DESC) AS PRT_NO                        " & vbNewLine _
                                                 & "						FROM $LM_TRN$..F_UNSO_M UNSO_M                                          " & vbNewLine _
                                                 & "						WHERE  UNSO_M.UNSO_NO_L   = @OUTKA_NO_L                                 " & vbNewLine _
                                                 & "						 AND   UNSO_M.SYS_DEL_FLG = '0'                                         " & vbNewLine _
                                                 & "					GROUP BY GOODS_NM, UNSO_NO_M                                                " & vbNewLine _
                                                 & "				 ) AS BASE                                                                      " & vbNewLine _
                                                 & "			WHERE BASE.PRT_NO = 1 ),'')AS GOODS_NM_1                                            " & vbNewLine _
                                                 & "           ,''                                                AS OUTKA_ATT                      " & vbNewLine _
                                                 & "           ,F02_01.BUY_CHU_NO                                 AS BUYER_ORD_NO                   " & vbNewLine _
                                                 & "           ,''                                                AS YELLOW_NO                      " & vbNewLine _
                                                 & "           ,''                                                AS SHIHARAI_SHITEN_NM_563_1       " & vbNewLine _
                                                 & "           ,''                                                AS SHIHARAI_SHITEN_TEL_563_1      " & vbNewLine _
                                                 & "           ,''                                                AS SHITEN_TEL_1_564_1             " & vbNewLine _
                                                 & "           ,''                                                AS SHITEN_NM_564_1                " & vbNewLine _
                                                 & "           ,''                                                AS SHITEN_TEL_2_564_1             " & vbNewLine _
                                                 & "           ,''                                                AS NRS_BR_AD_1                    " & vbNewLine _
                                                 & "           ,''                                                AS NRS_BR_AD_2                    " & vbNewLine _
                                                 & "           ,''                                                AS NRS_BR_NM_1                    " & vbNewLine _
                                                 & "           ,DEST2.DEST_NM                                     AS DEST_NM                        " & vbNewLine _
                                                 & "           ,DEST2.AD_1                                        AS AD_1                           " & vbNewLine _
                                                 & "           ,DEST2.AD_2                                        AS AD_2                           " & vbNewLine _
                                                 & "           ,F02_01.AD_3                                       AS AD_3                           " & vbNewLine _
                                                 & "           ,DEST2.TEL                                         AS TEL                            " & vbNewLine _
                                                 & "           ,DEST2.DEST_CD                                     AS DEST_CD                        " & vbNewLine _
                                                 & "           ,''                                                AS SHIP_CD_L                      " & vbNewLine _
                                                 & "           ,''                                                AS SHIHARAI_CD_565_1              " & vbNewLine _
                                                 & "           ,''                                                AS SHIHARAI_CD_565_2              " & vbNewLine _
                                                 & "           ,M01_01.FAX                                        AS NRS_FAX                        " & vbNewLine _
                                                 & "           ,''                                                AS NRS_AD_3                       " & vbNewLine _
                                                 & "           ,''                                                AS CUST_ORD_NO                    " & vbNewLine _
                                                 & "           ,''                                                AS SHOBO_CD                       " & vbNewLine _
                                                 & "           ,''                                                AS CUST_CD_L_568_1                " & vbNewLine _
                                                 & "           ,''                                                AS CUST_CD_L_568_2                " & vbNewLine _
                                                 & "           ,''                                                AS NRS_BR_ZIP                     " & vbNewLine _
                                                 & "           ,''                                                AS NRS_BR_TEL                     " & vbNewLine _
                                                 & "           ,''                                                AS KOTEI_1                        " & vbNewLine _
                                                 & "           ,''                                                AS KOTEI_2                        " & vbNewLine _
                                                 & "           ,''                                                AS KOTEI_3                        " & vbNewLine _
                                                 & "           ,''                                                AS NB_UT                          " & vbNewLine _
                                                 & "           ,''                                                AS DENPYO_NM                      " & vbNewLine _
                                                 & "           ,''                                                AS SHITEN_NM_570_1                " & vbNewLine _
                                                 & "           ,''                                                AS SHITEN_TEL_570_1               " & vbNewLine _
                                                 & "           ,F02_01.UNSO_PKG_NB                                AS OUTKA_PKG_NB                   " & vbNewLine _
                                                 & "           ,''                                                AS IRIME                          " & vbNewLine _
                                                 & "           ,''                                                AS IRIME_UT                       " & vbNewLine _
                                                 & "           ,''                                                AS ALCTD_NB                       " & vbNewLine _
                                                 & "           ,''                                                AS LOT_NO                         " & vbNewLine _
                                                 & "           ,''                                                AS SHITEN_NM_570_2                " & vbNewLine _
                                                 & "           ,''                                                AS SHITEN_TEL_570_2               " & vbNewLine _
                                                 & "           ,''                                                AS SHIHARAI_SHITEN_CD_563_1       " & vbNewLine _
                                                 & "           ,SHIPDEST.DEST_NM                                  AS SHIP_NM_L                      " & vbNewLine _
                                                 & "           ,''                                                AS UNSO_CUST_CD                   " & vbNewLine _
                                                 & "           ,KB0801.KBN_NM3                                    AS SHIHARAI_CD_575_1              " & vbNewLine _
                                                 & "           ,KB0802.KBN_NM3                                    AS SHIHARAI_CD_575_2              " & vbNewLine _
                                                 & "           ,CASE WHEN SHIPDEST.DEST_NM <> ''                                                    " & vbNewLine _
                                                 & "                      AND SHIPDEST.DEST_NM IS NOT NULL THEN SHIPDEST.DEST_NM                    " & vbNewLine _
                                                 & "                 WHEN M07_01.DENPYO_NM   <> ''                                                  " & vbNewLine _
                                                 & "                      AND M07_01.DENPYO_NM IS NOT NULL   THEN M07_01.DENPYO_NM                  " & vbNewLine _
                                                 & "                 ELSE M07_01.CUST_NM_L                                                          " & vbNewLine _
                                                 & "            END                                               AS ATSUKAISYA_NM                  " & vbNewLine _
                                                 & "--(2012.12.10)要望番号1682 --- START ---                                                        " & vbNewLine _
                                                 & "           --,M08_01.GOODS_CD_CUST                            AS GOODS_CD_CUST   --2012.05.25   " & vbNewLine _
                                                 & "           ,MIN(M08_01.GOODS_CD_CUST)                         AS GOODS_CD_CUST   --2012.05.25   " & vbNewLine _
                                                 & "--(2012.12.10)要望番号1682 --- START ---                                                        " & vbNewLine _
                                                 & "         ,LEFT(JIS.JIS_CD , 2 )                             AS PREF_CD           --2012.05.25   " & vbNewLine _
                                                 & ",CASE WHEN LEFT(JIS.JIS_CD,2) ='16' OR                                                          " & vbNewLine _
                                                 & "          LEFT(JIS.JIS_CD,2) = '17' OR                                                          " & vbNewLine _
                                                 & "          LEFT(JIS.JIS_CD,2) = '18' OR                                                          " & vbNewLine _
                                                 & "          LEFT(JIS.JIS_CD,2) = '21' OR                                                          " & vbNewLine _
                                                 & "          LEFT(JIS.JIS_CD,2) = '25'                  --ここまで飛騨運輸のエリア                 " & vbNewLine _
                                                 & "          THEN '飛騨運輸'                                                                       " & vbNewLine _
                                                 & "    WHEN  LEFT(JIS.JIS_CD,2) = '24' OR                                                          " & vbNewLine _
                                                 & "          LEFT(JIS.JIS_CD,2) = '29' OR                                                          " & vbNewLine _
                                                 & "          LEFT(JIS.JIS_CD,2) = '30' OR                                                          " & vbNewLine _
                                                 & "          LEFT(JIS.JIS_CD,2) = '47'                 --ここまで近鉄運輸のエリア                  " & vbNewLine _
                                                 & "          THEN '近鉄運輸'                                                                       " & vbNewLine _
                                                 & "    WHEN  LEFT(JIS.JIS_CD,2) = '26' OR                                                          " & vbNewLine _
                                                 & "          LEFT(JIS.JIS_CD,2) = '28' OR                                                          " & vbNewLine _
                                                 & "          LEFT(JIS.JIS_CD,2) = '31' OR                                                          " & vbNewLine _
                                                 & "          LEFT(JIS.JIS_CD,2) = '32' OR                                                          " & vbNewLine _
                                                 & "          LEFT(JIS.JIS_CD,2) = '33' OR                                                          " & vbNewLine _
                                                 & "          LEFT(JIS.JIS_CD,2) = '34' OR                                                          " & vbNewLine _
                                                 & "          LEFT(JIS.JIS_CD,2) = '35' OR                                                          " & vbNewLine _
                                                 & "          LEFT(JIS.JIS_CD,2) = '36' OR                                                          " & vbNewLine _
                                                 & "          LEFT(JIS.JIS_CD,2) = '37' OR                                                          " & vbNewLine _
                                                 & "          LEFT(JIS.JIS_CD,2) = '38' OR                                                          " & vbNewLine _
                                                 & "          LEFT(JIS.JIS_CD,2) = '39'                                                             " & vbNewLine _
                                                 & "          THEN '岡山県貨物'                                                                     " & vbNewLine _
                                                 & "          ELSE    '' END            AS TORI_UNSOCO_NM                                           " & vbNewLine _
                                                 & "         --,MUC.UNSOCO_NM                                     AS TORI_UNSOCO_NM  --2012.05.25   " & vbNewLine _
                                                 & "           ,MCD_SAI.SET_NAIYO                                   AS SAI_SHIHARAI_CD --2012.05.25 " & vbNewLine _
                                                 & "           ,MCD_SAI.SET_NAIYO_3        AS SET_NM_L               --2012.05.29                   " & vbNewLine _
                                                 & "           ,MCD_NFC.SET_NAIYO          AS NAIYO1                 --2012.06.01                   " & vbNewLine _
                                                 & "           ,MCD_NFC.SET_NAIYO_2        AS NAIYO2                 --2012.06.01                   " & vbNewLine _
                                                 & "           ,MCD_NFC.SET_NAIYO_3        AS NAIYO3                 --2012.06.01                   " & vbNewLine _
                                                 & "           ,MCD_SAI.SET_NAIYO_2        AS NAIYO_CUST_NM          --2012.06.04                   " & vbNewLine _
                                                 & "           ,''                         AS CUST_ORD_NO_DTL        --2012.06.11                   " & vbNewLine _
                                                 & "           ,''                         AS KBN_CUST_ZIP           --2012.06.18                   " & vbNewLine _
                                                 & "           ,''                         AS KBN_CUST_AD            --2012.06.18                   " & vbNewLine _
                                                 & "           ,''                         AS KBN_CUST_TEL           --2012.06.18                   " & vbNewLine _
                                                 & "           ,''                         AS KBN_CUST_NM            --2012.06.18                   " & vbNewLine _
                                                 & "           ,''                         AS OUTKO_DATE             --2012.06.18                   " & vbNewLine _
                                                 & "           ,''                         AS ALCTD_WT               --2012.06.18                   " & vbNewLine _
                                                 & "           ,''                         AS BUKA_CD                --2012.06.18                   " & vbNewLine _
                                                 & "           ,DEST2.REMARK               AS REMARK_DEST            --2012.07.24 丸和運輸　荷受人氏名下の注意書き(REMARK)開始    " & vbNewLine _
                                                 & "           --要望番号1383 [LMC664] --- START ---                                                " & vbNewLine _
                                                 & "           ,ISNULL(MCD_CUST.CUST_NAIYO_1,'') AS CUST_FLG                                        " & vbNewLine _
                                                 & "           --要望番号1383 [LMC664] --- END ---                                                  " & vbNewLine _
                                                 & "           --送状番号自動採番用 2016.07.23--- STD ---                                           " & vbNewLine _
                                                 & "           ,F02_01.AUTO_DENP_KBN           AS AUTO_DENP_KBN                                     " & vbNewLine _
                                                 & "           ,F02_01.AUTO_DENP_NO            AS AUTO_DENP_NO                                      " & vbNewLine _
                                                 & "           --送状番号自動採番用 2016.07.23--- END ---                                           " & vbNewLine _
                                                & "  FROM      $LM_TRN$..F_UNSO_L    F02_01                                                        " & vbNewLine _
                                                 & "  LEFT JOIN $LM_MST$..M_NRS_BR    M01_01                                                        " & vbNewLine _
                                                 & "         ON F02_01.NRS_BR_CD    = M01_01.NRS_BR_CD                                              " & vbNewLine _
                                                 & "        AND M01_01.SYS_DEL_FLG  = '0'                                                           " & vbNewLine _
                                                 & "  LEFT JOIN $LM_MST$..M_CUST      M07_01                                                        " & vbNewLine _
                                                 & "         ON F02_01.NRS_BR_CD    = M07_01.NRS_BR_CD                                              " & vbNewLine _
                                                 & "        AND F02_01.CUST_CD_L    = M07_01.CUST_CD_L                                              " & vbNewLine _
                                                 & "        AND F02_01.CUST_CD_M    = M07_01.CUST_CD_M                                              " & vbNewLine _
                                                 & "        AND M07_01.CUST_CD_S    = '00'                                                          " & vbNewLine _
                                                 & "        AND M07_01.CUST_CD_SS   = '00'                                                          " & vbNewLine _
                                                 & "        AND M07_01.SYS_DEL_FLG  = '0'                                                           " & vbNewLine _
                                                 & "  LEFT JOIN $LM_MST$..M_DEST      M10_01                                                        " & vbNewLine _
                                                 & "         ON F02_01.NRS_BR_CD    = M10_01.NRS_BR_CD                                              " & vbNewLine _
                                                 & "        AND F02_01.CUST_CD_L    = M10_01.CUST_CD_L                                              " & vbNewLine _
                                                 & "        AND F02_01.DEST_CD      = M10_01.DEST_CD                                                " & vbNewLine _
                                                 & "        AND M10_01.SYS_DEL_FLG  = '0'                                                           " & vbNewLine _
                                                 & "  LEFT JOIN  $LM_MST$..M_DEST   SHIPDEST                                                        " & vbNewLine _
                                                 & "         ON  F02_01.NRS_BR_CD   = SHIPDEST.NRS_BR_CD                                            " & vbNewLine _
                                                 & "        AND  F02_01.CUST_CD_L   = SHIPDEST.CUST_CD_L                                            " & vbNewLine _
                                                 & "        AND  F02_01.SHIP_CD     = SHIPDEST.DEST_CD                                              " & vbNewLine _
                                                 & "        AND  SHIPDEST.SYS_DEL_FLG = '0'                                                         " & vbNewLine _
                                                 & "--区分マスタ(LMC575支払コード(NM3)KB0801)                                                       " & vbNewLine _
                                                 & "        LEFT JOIN $LM_MST$..Z_KBN KB0801                                                        " & vbNewLine _
                                                 & "        ON  KB0801.KBN_GROUP_CD = 'O007'                                                        " & vbNewLine _
                                                 & "        AND KB0801.KBN_CD       = '16'                                                          " & vbNewLine _
                                                 & "        AND KB0801.SYS_DEL_FLG  = '0'                                                           " & vbNewLine _
                                                 & "--区分マスタ(LMC575支払コード(NM3)KB0802)                                                       " & vbNewLine _
                                                 & "        LEFT JOIN $LM_MST$..Z_KBN KB0802                                                        " & vbNewLine _
                                                 & "        ON  KB0802.KBN_GROUP_CD = 'O007'                                                        " & vbNewLine _
                                                 & "        AND KB0802.KBN_CD       = '17'                                                          " & vbNewLine _
                                                 & "        AND KB0802.SYS_DEL_FLG  = '0'                                                           " & vbNewLine _
                                                 & "--区分マスタ(LMC670 KB0803)                                                                     " & vbNewLine _
                                                 & "        LEFT JOIN $LM_MST$..Z_KBN KB0803                                                        " & vbNewLine _
                                                 & "        ON  KB0803.KBN_GROUP_CD = 'O007'                                                        " & vbNewLine _
                                                 & "        AND KB0803.KBN_CD       = '18'                                                          " & vbNewLine _
                                                 & "        AND KB0803.SYS_DEL_FLG  = '0'                                                           " & vbNewLine _
                                                 & "--要望番号803                                                                                   " & vbNewLine _
                                                 & "  LEFT JOIN $LM_MST$..M_DEST      DEST2                                                         " & vbNewLine _
                                                 & "         ON F02_01.NRS_BR_CD    = DEST2.NRS_BR_CD                                               " & vbNewLine _
                                                 & "        AND F02_01.CUST_CD_L    = DEST2.CUST_CD_L                                               " & vbNewLine _
                                                 & "        --要望番号834対応　F_UNSO_LとのJOINをORIG_CDからDEST_CDに変更 -- START --               " & vbNewLine _
                                                 & "        --AND F02_01.ORIG_CD    = DEST2.DEST_CD                                                 " & vbNewLine _
                                                 & "        AND F02_01.DEST_CD      = DEST2.DEST_CD                                                 " & vbNewLine _
                                                 & "        --要望番号834対応　F_UNSO_LとのJOINをORIG_CDからDEST_CDに変更 --  END  --               " & vbNewLine _
                                                 & "        AND M10_01.SYS_DEL_FLG  = '0'                                                           " & vbNewLine _
                                                 & "--JISマスタ(LMC661にてJIS_CD2桁：都道府県コード取得)2012.05.25                                  " & vbNewLine _
                                                 & "  LEFT JOIN  $LM_MST$..M_JIS   JIS                                                              " & vbNewLine _
                                                 & "         ON  JIS.JIS_CD       = M10_01.JIS                                                      " & vbNewLine _
                                                 & "        AND  JIS.SYS_DEL_FLG  = '0'                                                             " & vbNewLine _
                                                 & "--運送会社マスタ(LMC589にてUNSOCO_NM：取次先運送会社名取得)2012.05.25                           " & vbNewLine _
                                                 & "--  LEFT JOIN  $LM_MST$..M_UNSOCO   MUC                                                         " & vbNewLine _
                                                 & "--         ON  MUC.NRS_BR_CD    = F02_01.NRS_BR_CD                                              " & vbNewLine _
                                                 & "--        AND  MUC.UNSOCO_CD    = F02_01.UNSO_CD                                                " & vbNewLine _
                                                 & "--        AND  MUC.UNSOCO_BR_CD = F02_01.UNSO_BR_CD                                             " & vbNewLine _
                                                 & "--        AND  MUC.SYS_DEL_FLG  = '0'                                                           " & vbNewLine _
                                                 & "--荷主明細マスタ(LMC660にてSET_NAIYO：支払コード取得)2012.05.25                                 " & vbNewLine _
                                                 & "  LEFT JOIN $LM_MST$..M_CUST_DETAILS MCD_SAI                                                    " & vbNewLine _
                                                 & "         ON MCD_SAI.NRS_BR_CD   = F02_01.NRS_BR_CD                                              " & vbNewLine _
                                                 & "        AND MCD_SAI.CUST_CD      = F02_01.CUST_CD_L                                             " & vbNewLine _
                                                 & "--        AND MCD_SAI.CUST_CD_EDA  = F02_01.CUST_CD_M                                             " & vbNewLine _
                                                 & "        AND MCD_SAI.SUB_KB       = '27'                                                         " & vbNewLine _
                                                 & "        AND MCD_SAI.SYS_DEL_FLG  = '0'                                                          " & vbNewLine _
                                                 & "--荷主明細マスタ(LMC669にてSET_NAIYO：荷送人名称取得)2012.06.01                                 " & vbNewLine _
                                                 & "  LEFT JOIN $LM_MST$..M_CUST_DETAILS MCD_NFC                                                    " & vbNewLine _
                                                 & "         ON MCD_NFC.NRS_BR_CD   = F02_01.NRS_BR_CD                                              " & vbNewLine _
                                                 & "        AND MCD_NFC.CUST_CD      = F02_01.CUST_CD_L                                             " & vbNewLine _
                                                 & "--        AND MCD_NFC.CUST_CD_EDA  = F02_01.CUST_CD_M--notes 1118                               " & vbNewLine _
                                                 & "        AND MCD_NFC.SUB_KB       = '29'                                                         " & vbNewLine _
                                                 & "        AND MCD_NFC.SYS_DEL_FLG  = '0'                                                          " & vbNewLine _
                                                 & " --要望番号1383 [LMC664] --- START ---                                                          " & vbNewLine _
                                                 & "         LEFT JOIN (SELECT NRS_BR_CD   AS NRS_BR_CD                                             " & vbNewLine _
                                                 & "                         , CUST_CD     AS CUST_CD                                               " & vbNewLine _
                                                 & "                         , CUST_CLASS  AS CUST_CLASS                                            " & vbNewLine _
                                                 & "                         , SET_NAIYO   AS CUST_NAIYO_1                                          " & vbNewLine _
                                                 & "                         , SET_NAIYO_2 AS CUST_NAIYO_2                                          " & vbNewLine _
                                                 & "                         , SET_NAIYO_3 AS CUST_NAIYO_3                                          " & vbNewLine _
                                                 & "                      FROM $LM_MST$..M_CUST_DETAILS                                             " & vbNewLine _
                                                 & "                     WHERE SUB_KB ='42'                                                         " & vbNewLine _
                                                 & "                       AND SET_NAIYO_2 = @RPT_ID                                                " & vbNewLine _
                                                 & "                       AND SYS_DEL_FLG = '0'                                                    " & vbNewLine _
                                                 & "                    ) MCD_CUST                                                                  " & vbNewLine _
                                                 & "                ON M07_01.NRS_BR_CD = MCD_CUST.NRS_BR_CD                                        " & vbNewLine _
                                                 & "               AND (CASE WHEN MCD_CUST.CUST_CLASS='00' THEN  M07_01.CUST_CD_L                                                            " & vbNewLine _
                                                 & "                         WHEN MCD_CUST.CUST_CLASS='01' THEN (M07_01.CUST_CD_L + M07_01.CUST_CD_M)                                        " & vbNewLine _
                                                 & "                         WHEN MCD_CUST.CUST_CLASS='02' THEN (M07_01.CUST_CD_L + M07_01.CUST_CD_M + M07_01.CUST_CD_S)                     " & vbNewLine _
                                                 & "                         WHEN MCD_CUST.CUST_CLASS='03' THEN (M07_01.CUST_CD_L + M07_01.CUST_CD_M + M07_01.CUST_CD_S + M07_01.CUST_CD_SS) " & vbNewLine _
                                                 & "                    END                                                                         " & vbNewLine _
                                                 & "                   ) = MCD_CUST.CUST_CD                                                         " & vbNewLine _
                                                 & " --要望番号1383 [LMC664] --- END ---                                                            " & vbNewLine _
                                                 '& "           --送状番号自動採番用 2016.07.23--- STD ---                                           " & vbNewLine _
    '& "           ,FL.AUTO_DENP_KBN           AS AUTO_DENP_KBN                                         " & vbNewLine _
    '& "           ,FL.AUTO_DENP_NO            AS AUTO_DENP_NO                                          " & vbNewLine _
    '& "           --送状番号自動採番用 2016.07.23--- END ---                                           " & vbNewLine

    ''' <summary>
    ''' 帳票PTN
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_FROM_UNSO_PRT_BPC As String = "  LEFT JOIN $LM_TRN$..F_UNSO_M   F03_01                                                            " & vbNewLine _
                                              & "         ON F02_01.NRS_BR_CD   = F03_01.NRS_BR_CD                                                  " & vbNewLine _
                                              & "        AND F02_01.UNSO_NO_L   = F03_01.UNSO_NO_L                                                  " & vbNewLine _
                                              & "        AND F03_01.SYS_DEL_FLG = '0'                                                               " & vbNewLine _
                                              & "  LEFT JOIN $LM_MST$..M_GOODS    M08_01                                                            " & vbNewLine _
                                              & "    ON F02_01.NRS_BR_CD        = M08_01.NRS_BR_CD                                                  " & vbNewLine _
                                              & "   AND F03_01.GOODS_CD_NRS     = M08_01.GOODS_CD_NRS                                               " & vbNewLine _
                                              & "   AND M08_01.SYS_DEL_FLG      = '0'                                                               " & vbNewLine _
                                              & "  LEFT JOIN $LM_MST$..M_UNSO_CUST_RPT M68_01                                                       " & vbNewLine _
                                              & "    ON F02_01.NRS_BR_CD        = M68_01.NRS_BR_CD                                                  " & vbNewLine _
                                              & "   AND F02_01.UNSO_CD          = M68_01.UNSOCO_CD                                                  " & vbNewLine _
                                              & "   AND F02_01.UNSO_BR_CD       = M68_01.UNSOCO_BR_CD                                               " & vbNewLine _
                                              & "   AND M68_01.PTN_ID           = '11'                                                              " & vbNewLine _
                                              & "   AND F02_01.PC_KB            = M68_01.MOTO_TYAKU_KB                                              " & vbNewLine _
                                              & "   AND M68_01.CUST_CD_L        = ''                                                                " & vbNewLine _
                                              & "   AND M68_01.CUST_CD_M        = ''                                                                " & vbNewLine _
                                              & "   AND M68_01.SYS_DEL_FLG      = '0'                                                               " & vbNewLine _
                                              & "  LEFT JOIN $LM_MST$..M_RPT      M22_01                                                            " & vbNewLine _
                                              & "    ON M68_01.NRS_BR_CD        = M22_01.NRS_BR_CD                                                  " & vbNewLine _
                                              & "   AND M68_01.PTN_ID           = M22_01.PTN_ID                                                     " & vbNewLine _
                                              & "   AND M68_01.PTN_CD           = M22_01.PTN_CD                                                     " & vbNewLine _
                                              & "   AND M22_01.SYS_DEL_FLG = '0'                                                                    " & vbNewLine _
                                              & "  LEFT JOIN $LM_MST$..M_UNSO_CUST_RPT M68_02                                                       " & vbNewLine _
                                              & "    ON F02_01.NRS_BR_CD        = M68_02.NRS_BR_CD                                                  " & vbNewLine _
                                              & "   AND F02_01.UNSO_CD          = M68_02.UNSOCO_CD                                                  " & vbNewLine _
                                              & "   AND F02_01.UNSO_BR_CD       = M68_02.UNSOCO_BR_CD                                               " & vbNewLine _
                                              & "   AND M68_02.PTN_ID           = '11'                                                              " & vbNewLine _
                                              & "   AND F02_01.PC_KB            = M68_02.MOTO_TYAKU_KB                                              " & vbNewLine _
                                              & "   AND F02_01.CUST_CD_L        = M68_02.CUST_CD_L                                                  " & vbNewLine _
                                              & "   AND F02_01.CUST_CD_M        = M68_02.CUST_CD_M                                                  " & vbNewLine _
                                              & "   AND M68_02.SYS_DEL_FLG      = '0'                                                               " & vbNewLine _
                                              & "  LEFT JOIN $LM_MST$..M_RPT      M22_02                                                            " & vbNewLine _
                                              & "    ON M68_02.NRS_BR_CD        = M22_02.NRS_BR_CD                                                  " & vbNewLine _
                                              & "   AND M68_02.PTN_ID           = M22_02.PTN_ID                                                     " & vbNewLine _
                                              & "   AND M22_02.SYS_DEL_FLG = '0'                                                                    " & vbNewLine _
                                              & "   AND M68_02.PTN_CD           = M22_02.PTN_CD                                                     " & vbNewLine

    ''' <summary>
    ''' 運送抽出条件
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_WHERE_UNSO_DATA_BPC As String = "      WHERE  F02_01.UNSO_NO_L   = @OUTKA_NO_L                                                    " & vbNewLine _
                                                    & "        AND  F02_01.SYS_DEL_FLG = '0'                                                            " & vbNewLine

    ''' <summary>
    ''' 運送グループ条件
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_GROUP_UNSO_DATA_BPC As String = " GROUP BY                           " & vbNewLine _
                                                & "          M22_02.PTN_CD             " & vbNewLine _
                                                & "        , M22_02.RPT_ID             " & vbNewLine _
                                                & "        , M22_01.PTN_CD             " & vbNewLine _
                                                & "        , M22_01.RPT_ID             " & vbNewLine _
                                                & "        , M07_01.DENPYO_NM          " & vbNewLine _
                                                & "        , M07_01.CUST_NM_L          " & vbNewLine _
                                                & "--      , M08_01.GOODS_CD_CUST      " & vbNewLine _
                                                & "        , JIS.JIS_CD                " & vbNewLine _
                                                & "        , F02_01.NRS_BR_CD          " & vbNewLine _
                                                & "        , F02_01.OUTKA_PLAN_DATE    " & vbNewLine _
                                                & "        , F02_01.UNSO_NO_L          " & vbNewLine _
                                                & "        , F02_01.ARR_PLAN_DATE      " & vbNewLine _
                                                & "        , F02_01.ARR_PLAN_TIME      " & vbNewLine _
                                                & "        , DEST2.TEL                 " & vbNewLine _
                                                & "        , DEST2.AD_1                " & vbNewLine _
                                                & "        , DEST2.AD_2                " & vbNewLine _
                                                & "        , F02_01.AD_3               " & vbNewLine _
                                                & "        , DEST2.DEST_NM             " & vbNewLine _
                                                & "        , M07_01.CUST_NM_L          " & vbNewLine _
                                                & "        , DEST2.ZIP                 " & vbNewLine _
                                                & "--(2013.07.09)要望番号2076--- START " & vbNewLine _
                                                & "        ,F02_01.UNSO_WT             " & vbNewLine _
                                                & "--(2013.07.09)要望番号2076--- END   " & vbNewLine _
                                                & "        , F02_01.UNSO_PKG_NB        " & vbNewLine _
                                                & "        , M01_01.NRS_BR_NM          " & vbNewLine _
                                                & "        , M01_01.AD_1               " & vbNewLine _
                                                & "        , M01_01.AD_2               " & vbNewLine _
                                                & "        , M01_01.TEL                " & vbNewLine _
                                                & "        , F02_01.CUST_CD_L          " & vbNewLine _
                                                & "        , F02_01.REMARK             " & vbNewLine _
                                                & "--        , M08_01.GOODS_NM_1        " & vbNewLine _
                                                & "        , F02_01.BUY_CHU_NO         " & vbNewLine _
                                                & "        , DEST2.DEST_NM             " & vbNewLine _
                                                & "        , DEST2.AD_1                " & vbNewLine _
                                                & "        , DEST2.AD_2                " & vbNewLine _
                                                & "        , DEST2.AD_3                " & vbNewLine _
                                                & "        , DEST2.TEL                 " & vbNewLine _
                                                & "        , DEST2.DEST_CD             " & vbNewLine _
                                                & "        , M01_01.FAX                " & vbNewLine _
                                                & "        , SHIPDEST.DEST_NM          " & vbNewLine _
                                                & "        , KB0801.KBN_NM3            " & vbNewLine _
                                                & "        , KB0802.KBN_NM3            " & vbNewLine _
                                                & "        , MCD_SAI.SET_NAIYO         " & vbNewLine _
                                                & "        , MCD_SAI.SET_NAIYO_3       " & vbNewLine _
                                                & "        , MCD_NFC.SET_NAIYO         " & vbNewLine _
                                                & "        , MCD_NFC.SET_NAIYO_2       " & vbNewLine _
                                                & "        , MCD_NFC.SET_NAIYO_3       " & vbNewLine _
                                                & "        , MCD_SAI.SET_NAIYO_2       " & vbNewLine _
                                                & "        , DEST2.REMARK              " & vbNewLine _
                                                & "        , MCD_CUST.CUST_NAIYO_1     " & vbNewLine _
                                                & "        , F02_01.CUST_CD_L          " & vbNewLine _
                                                & "        , F02_01.AUTO_DENP_KBN      " & vbNewLine _
                                                & "        , F02_01.AUTO_DENP_NO       " & vbNewLine




    ''' <summary>
    ''' BP_CTL_NO
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_SELECT_DATA_CTL_NO_7 As String = ",ISNULL((SELECT BASE.CUST_ORD_NO                                                                 " & vbNewLine _
                                                & " FROM                                                                                                " & vbNewLine _
                                                & "     (SELECT                                                                                         " & vbNewLine _
                                                & "     CUST_ORD_NO AS CUST_ORD_NO                                                                      " & vbNewLine _
                                                & "	,OUTKA_NO_L AS OUTKA_NO_L                                                                           " & vbNewLine _
                                                & "	,ROW_NUMBER() OVER                                                                                  " & vbNewLine _
                                                & "         (ORDER BY OUTKA_NO_L)                                                                       " & vbNewLine _
                                                & "      AS   NUM                                                                                       " & vbNewLine _
                                                & "      FROM $LM_TRN$..C_OUTKA_L L                                                                     " & vbNewLine _
                                                & "      WHERE L.NRS_BR_CD       = @NRS_BR_CD --MAT.NRS_BR_CD                                    -- '50'" & vbNewLine _
                                                & "	    AND	L.CUST_CD_L       = @CUST_CD_L    --MAT.CUST_CD_L                                  --'00023'" & vbNewLine _
                                                & "		AND	L.CUST_CD_M       = @CUST_CD_M    --MAT.CUST_CD_M                                  --'00'AND" & vbNewLine _
                                                & "        AND L.OUTKA_PLAN_DATE = @OUTKA_PLAN_DATE  --MAT.OUTKA_PLAN_DATE                  --'20121211'" & vbNewLine _
                                                & "		AND	L.ARR_PLAN_DATE   = @ARR_PLAN_DATE --MAT.ARR_PLAN_DATE                          --'20121212'" & vbNewLine _
                                                & "		AND L.DEST_CD         = @DEST_CD  --MAT.DEST_CD                                    --'62022570' " & vbNewLine _
                                                & "        AND L.SYS_DEL_FLG = '0'                                                                      " & vbNewLine _
                                                & "     ) AS BASE                                                                                       " & vbNewLine _
                                                & " WHERE BASE.NUM = 1),'') AS CUST_ORD_NO_1                                                            " & vbNewLine _
                                                & "                                                                                                     " & vbNewLine _
                                                & "                                                                                                     " & vbNewLine _
                                                & ",ISNULL((SELECT BASE.CUST_ORD_NO                                                                     " & vbNewLine _
                                                & " FROM                                                                                                " & vbNewLine _
                                                & "     (SELECT                                                                                         " & vbNewLine _
                                                & "     CUST_ORD_NO AS CUST_ORD_NO                                                                      " & vbNewLine _
                                                & "	,OUTKA_NO_L AS OUTKA_NO_L                                                                           " & vbNewLine _
                                                & "	,ROW_NUMBER() OVER                                                                                  " & vbNewLine _
                                                & "         (ORDER BY OUTKA_NO_L)                                                                       " & vbNewLine _
                                                & "      AS   NUM                                                                                       " & vbNewLine _
                                                & "      FROM $LM_TRN$..C_OUTKA_L L                                                                     " & vbNewLine _
                                                & "      WHERE L.NRS_BR_CD       = @NRS_BR_CD  --MAT.NRS_BR_CD                                          " & vbNewLine _
                                                & "	    AND	L.CUST_CD_L       =    @CUST_CD_L  --MAT.CUST_CD_L                                          " & vbNewLine _
                                                & "		AND	L.CUST_CD_M       =    @CUST_CD_M  --MAT.CUST_CD_M                                          " & vbNewLine _
                                                & "        AND L.OUTKA_PLAN_DATE = @OUTKA_PLAN_DATE  --MAT.OUTKA_PLAN_DATE                              " & vbNewLine _
                                                & "		AND	L.ARR_PLAN_DATE   =    @ARR_PLAN_DATE --MAT.ARR_PLAN_DATE                                   " & vbNewLine _
                                                & "		AND L.DEST_CD         =    @DEST_CD  --MAT.DEST_CD                                              " & vbNewLine _
                                                & "        AND L.SYS_DEL_FLG = '0'                                                                      " & vbNewLine _
                                                & "     ) AS BASE                                                                                       " & vbNewLine _
                                                & " WHERE BASE.NUM = 2),'') AS CUST_ORD_NO_2                                                            " & vbNewLine _
                                                & "                                                                                                     " & vbNewLine _
                                                & ",ISNULL((SELECT BASE.CUST_ORD_NO                                                                     " & vbNewLine _
                                                & " FROM                                                                                                " & vbNewLine _
                                                & "     (SELECT                                                                                         " & vbNewLine _
                                                & "     CUST_ORD_NO AS CUST_ORD_NO                                                                      " & vbNewLine _
                                                & "	,OUTKA_NO_L AS OUTKA_NO_L                                                                           " & vbNewLine _
                                                & "	,ROW_NUMBER() OVER                                                                                  " & vbNewLine _
                                                & "         (ORDER BY OUTKA_NO_L)                                                                       " & vbNewLine _
                                                & "      AS   NUM                                                                                       " & vbNewLine _
                                                & "      FROM $LM_TRN$..C_OUTKA_L L                                                                     " & vbNewLine _
                                                & "      WHERE L.NRS_BR_CD       = @NRS_BR_CD  --MAT.NRS_BR_CD                                          " & vbNewLine _
                                                & "	    AND	L.CUST_CD_L       =    @CUST_CD_L  --MAT.CUST_CD_L                                          " & vbNewLine _
                                                & "		AND	L.CUST_CD_M       =    @CUST_CD_M  --MAT.CUST_CD_M                                          " & vbNewLine _
                                                & "        AND L.OUTKA_PLAN_DATE = @OUTKA_PLAN_DATE  --MAT.OUTKA_PLAN_DATE                              " & vbNewLine _
                                                & "		AND	L.ARR_PLAN_DATE   = @ARR_PLAN_DATE --MAT.ARR_PLAN_DATE                                      " & vbNewLine _
                                                & "		AND L.DEST_CD         = @DEST_CD  --MAT.DEST_CD                                                 " & vbNewLine _
                                                & "        AND L.SYS_DEL_FLG = '0'                                                                      " & vbNewLine _
                                                & "     ) AS BASE                                                                                       " & vbNewLine _
                                                & " WHERE BASE.NUM = 3),'') AS CUST_ORD_NO_3                                                            " & vbNewLine _
                                                & "                                                                                                     " & vbNewLine _
                                                & ",ISNULL((SELECT BASE.CUST_ORD_NO                                                                     " & vbNewLine _
                                                & " FROM                                                                                                " & vbNewLine _
                                                & "     (SELECT                                                                                         " & vbNewLine _
                                                & "     CUST_ORD_NO AS CUST_ORD_NO                                                                      " & vbNewLine _
                                                & "	,OUTKA_NO_L AS OUTKA_NO_L                                                                           " & vbNewLine _
                                                & "	,ROW_NUMBER() OVER                                                                                  " & vbNewLine _
                                                & "         (ORDER BY OUTKA_NO_L)                                                                       " & vbNewLine _
                                                & "      AS   NUM                                                                                       " & vbNewLine _
                                                & "      FROM $LM_TRN$..C_OUTKA_L L                                                                     " & vbNewLine _
                                                & "      WHERE L.NRS_BR_CD       = @NRS_BR_CD  --MAT.NRS_BR_CD                                          " & vbNewLine _
                                                & "	    AND	L.CUST_CD_L       = @CUST_CD_L  --MAT.CUST_CD_L                                             " & vbNewLine _
                                                & "		AND	L.CUST_CD_M       = @CUST_CD_M  --MAT.CUST_CD_M                                             " & vbNewLine _
                                                & "        AND L.OUTKA_PLAN_DATE = @OUTKA_PLAN_DATE  --MAT.OUTKA_PLAN_DATE                              " & vbNewLine _
                                                & "		AND	L.ARR_PLAN_DATE   =  @ARR_PLAN_DATE --MAT.ARR_PLAN_DATE                                     " & vbNewLine _
                                                & "		AND L.DEST_CD         = @DEST_CD  --MAT.DEST_CD                                                 " & vbNewLine _
                                                & "        AND L.SYS_DEL_FLG = '0'                                                                      " & vbNewLine _
                                                & "     ) AS BASE                                                                                       " & vbNewLine _
                                                & " WHERE BASE.NUM = 4),'') AS CUST_ORD_NO_4                                                            " & vbNewLine _
                                                & "                                                                                                     " & vbNewLine _
                                                & ",ISNULL((SELECT BASE.CUST_ORD_NO                                                                     " & vbNewLine _
                                                & " FROM                                                                                                " & vbNewLine _
                                                & "     (SELECT                                                                                         " & vbNewLine _
                                                & "     CUST_ORD_NO AS CUST_ORD_NO                                                                      " & vbNewLine _
                                                & "	,OUTKA_NO_L AS OUTKA_NO_L                                                                           " & vbNewLine _
                                                & "	,ROW_NUMBER() OVER                                                                                  " & vbNewLine _
                                                & "         (ORDER BY OUTKA_NO_L)                                                                       " & vbNewLine _
                                                & "      AS   NUM                                                                                       " & vbNewLine _
                                                & "      FROM $LM_TRN$..C_OUTKA_L L                                                                     " & vbNewLine _
                                                & "      WHERE L.NRS_BR_CD       = @NRS_BR_CD  --MAT.NRS_BR_CD                                          " & vbNewLine _
                                                & "	    AND	L.CUST_CD_L       = @CUST_CD_L  --MAT.CUST_CD_L                                             " & vbNewLine _
                                                & "		AND	L.CUST_CD_M       = @CUST_CD_M  --MAT.CUST_CD_M                                             " & vbNewLine _
                                                & "        AND L.OUTKA_PLAN_DATE = @OUTKA_PLAN_DATE  --MAT.OUTKA_PLAN_DATE                              " & vbNewLine _
                                                & "		AND	L.ARR_PLAN_DATE   = @ARR_PLAN_DATE --MAT.ARR_PLAN_DATE                                      " & vbNewLine _
                                                & "		AND L.DEST_CD         =  @DEST_CD  --MAT.DEST_CD                                                " & vbNewLine _
                                                & "        AND L.SYS_DEL_FLG = '0'                                                                      " & vbNewLine _
                                                & "     ) AS BASE                                                                                       " & vbNewLine _
                                                & " WHERE BASE.NUM = 5),'') AS CUST_ORD_NO_5                                                            " & vbNewLine _
                                                & "                                                                                                     " & vbNewLine _
                                                & ",ISNULL((SELECT BASE.CUST_ORD_NO                                                                     " & vbNewLine _
                                                & " FROM                                                                                                " & vbNewLine _
                                                & "     (SELECT                                                                                         " & vbNewLine _
                                                & "     CUST_ORD_NO AS CUST_ORD_NO                                                                      " & vbNewLine _
                                                & "	,OUTKA_NO_L AS OUTKA_NO_L                                                                           " & vbNewLine _
                                                & "	,ROW_NUMBER() OVER                                                                                  " & vbNewLine _
                                                & "         (ORDER BY OUTKA_NO_L)                                                                       " & vbNewLine _
                                                & "      AS   NUM                                                                                       " & vbNewLine _
                                                & "      FROM $LM_TRN$..C_OUTKA_L L                                                                     " & vbNewLine _
                                                & "      WHERE L.NRS_BR_CD       = @NRS_BR_CD  --MAT.NRS_BR_CD                                          " & vbNewLine _
                                                & "	    AND	L.CUST_CD_L       = @CUST_CD_L  --MAT.CUST_CD_L                                             " & vbNewLine _
                                                & "		AND	L.CUST_CD_M       = @CUST_CD_M  --MAT.CUST_CD_M                                             " & vbNewLine _
                                                & "        AND L.OUTKA_PLAN_DATE = @OUTKA_PLAN_DATE  --MAT.OUTKA_PLAN_DATE                              " & vbNewLine _
                                                & "		AND	L.ARR_PLAN_DATE   = @ARR_PLAN_DATE --MAT.ARR_PLAN_DATE                                      " & vbNewLine _
                                                & "		AND L.DEST_CD         = @DEST_CD  --MAT.DEST_CD                                                 " & vbNewLine _
                                                & "        AND L.SYS_DEL_FLG = '0'                                                                      " & vbNewLine _
                                                & "     ) AS BASE                                                                                       " & vbNewLine _
                                                & " WHERE BASE.NUM = 6),'') AS CUST_ORD_NO_6                                                            " & vbNewLine _
                                                & "                                                                                                     " & vbNewLine _
                                                & ",ISNULL((SELECT BASE.CUST_ORD_NO                                                                     " & vbNewLine _
                                                & " FROM                                                                                                " & vbNewLine _
                                                & "     (SELECT                                                                                         " & vbNewLine _
                                                & "     CUST_ORD_NO AS CUST_ORD_NO                                                                      " & vbNewLine _
                                                & "	,OUTKA_NO_L AS OUTKA_NO_L                                                                           " & vbNewLine _
                                                & "	,ROW_NUMBER() OVER                                                                                  " & vbNewLine _
                                                & "         (ORDER BY OUTKA_NO_L)                                                                       " & vbNewLine _
                                                & "      AS   NUM                                                                                       " & vbNewLine _
                                                & "      FROM $LM_TRN$..C_OUTKA_L L                                                                     " & vbNewLine _
                                                & "      WHERE L.NRS_BR_CD       = @NRS_BR_CD  --MAT.NRS_BR_CD                                                        " & vbNewLine _
                                                & "	    AND	L.CUST_CD_L       = @CUST_CD_L  --MAT.CUST_CD_L                                                           " & vbNewLine _
                                                & "		AND	L.CUST_CD_M       = @CUST_CD_M  --MAT.CUST_CD_M                                                           " & vbNewLine _
                                                & "        AND L.OUTKA_PLAN_DATE = @OUTKA_PLAN_DATE  --MAT.OUTKA_PLAN_DATE                                                  " & vbNewLine _
                                                & "		AND	L.ARR_PLAN_DATE   = @ARR_PLAN_DATE --MAT.ARR_PLAN_DATE                                                       " & vbNewLine _
                                                & "		AND L.DEST_CD         = @DEST_CD  --MAT.DEST_CD                                                             " & vbNewLine _
                                                & "        AND L.SYS_DEL_FLG = '0'                                                                      " & vbNewLine _
                                                & "     ) AS BASE                                                                                       " & vbNewLine _
                                                & " WHERE BASE.NUM = 7),'') AS CUST_ORD_NO_7                                                            " & vbNewLine

#End Region


    '2012.12.26  大阪用　━━━━━━━━START━━━━━━━━ 
#Region "大阪用"

    ''' <summary>
    ''' 運送データ取得
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_SELECT_UNSO_DATA_707 As String = "SELECT                                                                                          " & vbNewLine _
                                                 & "       CASE WHEN M22_02.PTN_CD IS NOT NULL THEN M22_02.RPT_ID                                   " & vbNewLine _
                                                 & "            WHEN M22_01.PTN_CD IS NOT NULL THEN M22_01.RPT_ID                                   " & vbNewLine _
                                                 & "            ELSE '' END                                       AS RPT_ID                         " & vbNewLine _
                                                 & "           ,F02_01.NRS_BR_CD                                  AS NRS_BR_CD                      " & vbNewLine _
                                                 & "           ,F02_01.OUTKA_PLAN_DATE                            AS OUTKA_PLAN_DATE                " & vbNewLine _
                                                 & "           ,F02_01.UNSO_NO_L                                  AS OUTKA_NO_L                     " & vbNewLine _
                                                 & "           ,''                                                AS SHITEN_TEL_560_1               " & vbNewLine _
                                                 & "           ,''                                                AS SHITEN_NM_560_1                " & vbNewLine _
                                                 & "           ,F02_01.ARR_PLAN_DATE                              AS ARR_PLAN_DATE                  " & vbNewLine _
                                                 & "           ,F02_01.ARR_PLAN_TIME                              AS ARR_PLAN_TIME                  " & vbNewLine _
                                                 & "           ,DEST2.TEL                                         AS DEST_TEL                       " & vbNewLine _
                                                 & "           ,''                                                AS CUST_TEL                       " & vbNewLine _
                                                 & "           ,''                                                AS CUST_AD_1                      " & vbNewLine _
                                                 & "           ,''                                                AS CUST_AD_2                      " & vbNewLine _
                                                 & "           ,DEST2.AD_1                                        AS DEST_AD_1                      " & vbNewLine _
                                                 & "           ,''                                                AS CUST_AD_3                      " & vbNewLine _
                                                 & "           ,DEST2.AD_2                                        AS DEST_AD_2                      " & vbNewLine _
                                                 & "           ,F02_01.AD_3                                       AS DEST_AD_3                      " & vbNewLine _
                                                 & "           ,''                                                AS BETU_WT                        " & vbNewLine _
                                                 & "           ,DEST2.DEST_NM                                     AS DEST_NM_1                      " & vbNewLine _
                                                 & "           ,M07_01.CUST_NM_L                                  AS CUST_NM_L                      " & vbNewLine _
                                                 & "           ,DEST2.ZIP                                         AS DEST_ZIP                       " & vbNewLine _
                                                 & "--(2012.12.10)要望番号1682 --- START ---                                                        " & vbNewLine _
                                                 & "           --,(F03_01.BETU_WT * F03_01.UNSO_TTL_NB)           AS UNSO_WT                        " & vbNewLine _
                                                 & "           ,SUM((F03_01.BETU_WT * F03_01.UNSO_TTL_NB))        AS UNSO_WT                        " & vbNewLine _
                                                 & "--(2012.12.10)要望番号1682 ---  END  ---                                                        " & vbNewLine _
                                                 & "           ,F02_01.UNSO_PKG_NB                                AS UNSO_PKG_NB                    " & vbNewLine _
                                                 & "           ,''                                                AS CUST_NM_M                      " & vbNewLine _
                                                 & "           ,M01_01.NRS_BR_NM                                  AS NRS_BR_NM                      " & vbNewLine _
                                                 & "           ,''                                                AS DEST_HOSOKU                    " & vbNewLine _
                                                 & "           ,M01_01.AD_1                                       AS NRS_AD_1                       " & vbNewLine _
                                                 & "           ,M01_01.AD_2                                       AS NRS_AD_2                       " & vbNewLine _
                                                 & "           ,M01_01.TEL                                        AS NRS_TEL                        " & vbNewLine _
                                                 & "           ,F02_01.CUST_CD_L                                  AS CUST_CD_L                      " & vbNewLine _
                                                 & "           ,F02_01.REMARK                                     AS UNSO_L_REMARK                  " & vbNewLine _
                                                 & "           ,''                                                AS OUTKA_L_REMARK                 " & vbNewLine _
                                                 & "           ,EDIM.GOODS_NM                                     AS GOODS_NM_1                     " & vbNewLine _
                                                 & "           ,''                                                AS OUTKA_ATT                      " & vbNewLine _
                                                 & "           ,F02_01.BUY_CHU_NO                                 AS BUYER_ORD_NO                   " & vbNewLine _
                                                 & "           ,''                                                AS YELLOW_NO                      " & vbNewLine _
                                                 & "           ,''                                                AS SHIHARAI_SHITEN_NM_563_1       " & vbNewLine _
                                                 & "           ,''                                                AS SHIHARAI_SHITEN_TEL_563_1      " & vbNewLine _
                                                 & "           ,''                                                AS SHITEN_TEL_1_564_1             " & vbNewLine _
                                                 & "           ,''                                                AS SHITEN_NM_564_1                " & vbNewLine _
                                                 & "           ,''                                                AS SHITEN_TEL_2_564_1             " & vbNewLine _
                                                 & "           ,M01_01.AD_1                                       AS NRS_BR_AD_1                    " & vbNewLine _
                                                 & "           ,M01_01.AD_2                                       AS NRS_BR_AD_2                    " & vbNewLine _
                                                 & "           ,M01_01.NRS_BR_NM                                  AS NRS_BR_NM_1                    " & vbNewLine _
                                                 & "           ,DEST2.DEST_NM                                     AS DEST_NM                        " & vbNewLine _
                                                 & "           ,DEST2.AD_1                                        AS AD_1                           " & vbNewLine _
                                                 & "           ,DEST2.AD_2                                        AS AD_2                           " & vbNewLine _
                                                 & "           ,F02_01.AD_3                                       AS AD_3                           " & vbNewLine _
                                                 & "           ,DEST2.TEL                                         AS TEL                            " & vbNewLine _
                                                 & "           ,DEST2.DEST_CD                                     AS DEST_CD                        " & vbNewLine _
                                                 & "           ,''                                                AS SHIP_CD_L                      " & vbNewLine _
                                                 & "           ,''                                                AS SHIHARAI_CD_565_1              " & vbNewLine _
                                                 & "           ,''                                                AS SHIHARAI_CD_565_2              " & vbNewLine _
                                                 & "           ,M01_01.FAX                                        AS NRS_FAX                        " & vbNewLine _
                                                 & "           ,''                                                AS NRS_AD_3                       " & vbNewLine _
                                                 & "           ,''                                                AS CUST_ORD_NO                    " & vbNewLine _
                                                 & "           ,''                                                AS SHOBO_CD                       " & vbNewLine _
                                                 & "           ,''                                                AS CUST_CD_L_568_1                " & vbNewLine _
                                                 & "           ,''                                                AS CUST_CD_L_568_2                " & vbNewLine _
                                                 & "           ,M01_01.ZIP                                                AS NRS_BR_ZIP                     " & vbNewLine _
                                                 & "           ,M01_01.TEL                                                AS NRS_BR_TEL                     " & vbNewLine _
                                                 & "           ,''                                                AS KOTEI_1                        " & vbNewLine _
                                                 & "           ,''                                                AS KOTEI_2                        " & vbNewLine _
                                                 & "           ,''                                                AS KOTEI_3                        " & vbNewLine _
                                                 & "           ,''                                                AS NB_UT                          " & vbNewLine _
                                                 & "           ,''                                                AS DENPYO_NM                      " & vbNewLine _
                                                 & "           ,''                                                AS SHITEN_NM_570_1                " & vbNewLine _
                                                 & "           ,''                                                AS SHITEN_TEL_570_1               " & vbNewLine _
                                                 & "           ,''                                                AS OUTKA_PKG_NB                   " & vbNewLine _
                                                 & "           ,''                                                AS IRIME                          " & vbNewLine _
                                                 & "           ,''                                                AS IRIME_UT                       " & vbNewLine _
                                                 & "           ,OUTM.ALCTD_NB                                     AS ALCTD_NB                       " & vbNewLine _
                                                 & "           ,''                                                AS LOT_NO                         " & vbNewLine _
                                                 & "           ,''                                                AS SHITEN_NM_570_2                " & vbNewLine _
                                                 & "           ,''                                                AS SHITEN_TEL_570_2               " & vbNewLine _
                                                 & "           ,''                                                AS SHIHARAI_SHITEN_CD_563_1       " & vbNewLine _
                                                 & "           ,SHIPDEST.DEST_NM                                  AS SHIP_NM_L                      " & vbNewLine _
                                                 & "           ,''                                                AS UNSO_CUST_CD                   " & vbNewLine _
                                                 & "           ,KB0801.KBN_NM3                                    AS SHIHARAI_CD_575_1              " & vbNewLine _
                                                 & "           ,KB0802.KBN_NM3                                    AS SHIHARAI_CD_575_2              " & vbNewLine _
                                                 & "           ,CASE WHEN SHIPDEST.DEST_NM <> ''                                                    " & vbNewLine _
                                                 & "                      AND SHIPDEST.DEST_NM IS NOT NULL THEN SHIPDEST.DEST_NM                    " & vbNewLine _
                                                 & "                 WHEN M07_01.DENPYO_NM   <> ''                                                  " & vbNewLine _
                                                 & "                      AND M07_01.DENPYO_NM IS NOT NULL   THEN M07_01.DENPYO_NM                  " & vbNewLine _
                                                 & "                 ELSE M07_01.CUST_NM_L                                                          " & vbNewLine _
                                                 & "            END                                               AS ATSUKAISYA_NM                  " & vbNewLine _
                                                 & "--(2012.12.10)要望番号1682 --- START ---                                                        " & vbNewLine _
                                                 & "--           ,M08_01.GOODS_CD_CUST                            AS GOODS_CD_CUST   --2012.05.25   " & vbNewLine _
                                                 & "           ,EDIM.FREE_C01 + '  ' + EDIM.FREE_C02              AS GOODS_CD_CUST   --2012.05.25   " & vbNewLine _
                                                 & "           --,MIN(M08_01.GOODS_CD_CUST)                         AS GOODS_CD_CUST   --2012.05.25   " & vbNewLine _
                                                 & "--(2012.12.10)要望番号1682 --- START ---                                                        " & vbNewLine _
                                                 & "         ,LEFT(JIS.JIS_CD , 2 )                             AS PREF_CD           --2012.05.25   " & vbNewLine _
                                                 & ",CASE WHEN LEFT(JIS.JIS_CD,2) ='16' OR                                                          " & vbNewLine _
                                                 & "          LEFT(JIS.JIS_CD,2) = '17' OR                                                          " & vbNewLine _
                                                 & "          LEFT(JIS.JIS_CD,2) = '18' OR                                                          " & vbNewLine _
                                                 & "          LEFT(JIS.JIS_CD,2) = '21' OR                                                          " & vbNewLine _
                                                 & "          LEFT(JIS.JIS_CD,2) = '25'                  --ここまで飛騨運輸のエリア                 " & vbNewLine _
                                                 & "          THEN '飛騨運輸'                                                                       " & vbNewLine _
                                                 & "    WHEN  LEFT(JIS.JIS_CD,2) = '24' OR                                                          " & vbNewLine _
                                                 & "          LEFT(JIS.JIS_CD,2) = '29' OR                                                          " & vbNewLine _
                                                 & "          LEFT(JIS.JIS_CD,2) = '30' OR                                                          " & vbNewLine _
                                                 & "          LEFT(JIS.JIS_CD,2) = '47'                 --ここまで近鉄運輸のエリア                  " & vbNewLine _
                                                 & "          THEN '近鉄運輸'                                                                       " & vbNewLine _
                                                 & "    WHEN  LEFT(JIS.JIS_CD,2) = '26' OR                                                          " & vbNewLine _
                                                 & "          LEFT(JIS.JIS_CD,2) = '28' OR                                                          " & vbNewLine _
                                                 & "          LEFT(JIS.JIS_CD,2) = '31' OR                                                          " & vbNewLine _
                                                 & "          LEFT(JIS.JIS_CD,2) = '32' OR                                                          " & vbNewLine _
                                                 & "          LEFT(JIS.JIS_CD,2) = '33' OR                                                          " & vbNewLine _
                                                 & "          LEFT(JIS.JIS_CD,2) = '34' OR                                                          " & vbNewLine _
                                                 & "          LEFT(JIS.JIS_CD,2) = '35' OR                                                          " & vbNewLine _
                                                 & "          LEFT(JIS.JIS_CD,2) = '36' OR                                                          " & vbNewLine _
                                                 & "          LEFT(JIS.JIS_CD,2) = '37' OR                                                          " & vbNewLine _
                                                 & "          LEFT(JIS.JIS_CD,2) = '38' OR                                                          " & vbNewLine _
                                                 & "          LEFT(JIS.JIS_CD,2) = '39'                                                             " & vbNewLine _
                                                 & "          THEN '岡山県貨物'                                                                     " & vbNewLine _
                                                 & "          ELSE    '' END            AS TORI_UNSOCO_NM                                           " & vbNewLine _
                                                 & "         --,MUC.UNSOCO_NM                                     AS TORI_UNSOCO_NM  --2012.05.25   " & vbNewLine _
                                                 & "           ,MCD_SAI.SET_NAIYO                                   AS SAI_SHIHARAI_CD --2012.05.25 " & vbNewLine _
                                                 & "           ,MCD_SAI.SET_NAIYO_3        AS SET_NM_L               --2012.05.29                   " & vbNewLine _
                                                 & "           ,MCD_NFC.SET_NAIYO          AS NAIYO1                 --2012.06.01                   " & vbNewLine _
                                                 & "           ,MCD_NFC.SET_NAIYO_2        AS NAIYO2                 --2012.06.01                   " & vbNewLine _
                                                 & "           ,MCD_NFC.SET_NAIYO_3        AS NAIYO3                 --2012.06.01                   " & vbNewLine _
                                                 & "           ,MCD_SAI.SET_NAIYO_2        AS NAIYO_CUST_NM          --2012.06.04                   " & vbNewLine _
                                                 & "           ,''                         AS CUST_ORD_NO_DTL        --2012.06.11                   " & vbNewLine _
                                                 & "           ,''                         AS KBN_CUST_ZIP           --2012.06.18                   " & vbNewLine _
                                                 & "           ,''                         AS KBN_CUST_AD            --2012.06.18                   " & vbNewLine _
                                                 & "           ,''                         AS KBN_CUST_TEL           --2012.06.18                   " & vbNewLine _
                                                 & "           ,''                         AS KBN_CUST_NM            --2012.06.18                   " & vbNewLine _
                                                 & "           ,''                         AS OUTKO_DATE             --2012.06.18                   " & vbNewLine _
                                                 & "           ,''                         AS ALCTD_WT               --2012.06.18                   " & vbNewLine _
                                                 & "           ,''                         AS BUKA_CD                --2012.06.18                   " & vbNewLine _
                                                 & "           ,DEST2.REMARK               AS REMARK_DEST            --2012.07.24 丸和運輸　荷受人氏名下の注意書き(REMARK)開始    " & vbNewLine _
                                                 & "           --要望番号1383 [LMC664] --- START ---                                                " & vbNewLine _
                                                 & "           ,ISNULL(MCD_CUST.CUST_NAIYO_1,'') AS CUST_FLG                                        " & vbNewLine _
                                                 & "		   ,ROW_NUMBER() OVER (PARTITION BY F02_01.NRS_BR_CD                                    " & vbNewLine _
                                                 & "			ORDER BY F02_01.OUTKA_PLAN_DATE) AS REC_NO                                          " & vbNewLine _
                                                 & "           --要望番号1383 [LMC664] --- END ---                                                  " & vbNewLine _
                                                 & "           --送状番号自動採番用 2016.07.23--- STD ---                                           " & vbNewLine _
                                                 & "           ,F02_01.AUTO_DENP_KBN           AS AUTO_DENP_KBN                                         " & vbNewLine _
                                                 & "           ,F02_01.AUTO_DENP_NO            AS AUTO_DENP_NO                                          " & vbNewLine _
                                                 & "           --送状番号自動採番用 2016.07.23--- END ---                                           " & vbNewLine _
                                                 & "  FROM      $LM_TRN$..F_UNSO_L    F02_01                                                        " & vbNewLine _
                                                 & " LEFT JOIN (                                                                                    " & vbNewLine _
                                                 & "            SELECT                                                                              " & vbNewLine _
                                                 & "                   NRS_BR_CD                                                                    " & vbNewLine _
                                                 & "                 , EDI_CTL_NO                                                                   " & vbNewLine _
                                                 & "                 , OUTKA_CTL_NO                                                                 " & vbNewLine _
                                                 & "             FROM (                                                                             " & vbNewLine _
                                                 & "                    SELECT                                                                      " & vbNewLine _
                                                 & "                           EDIOUTL.NRS_BR_CD                                                    " & vbNewLine _
                                                 & "                         , EDIOUTL.EDI_CTL_NO                                                   " & vbNewLine _
                                                 & "                         , EDIOUTL.OUTKA_CTL_NO                                                 " & vbNewLine _
                                                 & "                         , CASE WHEN EDIOUTL.OUTKA_CTL_NO = '' THEN 1                           " & vbNewLine _
                                                 & "                           ELSE ROW_NUMBER() OVER (PARTITION BY EDIOUTL.NRS_BR_CD               " & vbNewLine _
                                                 & "                                                              , EDIOUTL.OUTKA_CTL_NO            " & vbNewLine _
                                                 & "                                                       ORDER BY EDIOUTL.NRS_BR_CD               " & vbNewLine _
                                                 & "                                                              , EDIOUTL.EDI_CTL_NO              " & vbNewLine _
                                                 & "                                                  )                                             " & vbNewLine _
                                                 & "                           END AS IDX                                                           " & vbNewLine _
                                                 & "                      FROM $LM_TRN$..H_OUTKAEDI_L EDIOUTL                                       " & vbNewLine _
                                                 & "                     WHERE EDIOUTL.SYS_DEL_FLG  = '0'                                           " & vbNewLine _
                                                 & "                       AND EDIOUTL.NRS_BR_CD    = @NRS_BR_CD                                    " & vbNewLine _
                                                 & "                       AND EDIOUTL.OUTKA_CTL_NO = @OUTKA_NO_L                                   " & vbNewLine _
                                                 & "                  ) EBASE                                                                       " & vbNewLine _
                                                 & "            --WHERE EBASE.IDX = 1                                                               " & vbNewLine _
                                                 & "            ) TOPEDI                                                                            " & vbNewLine _
                                                 & "        ON TOPEDI.NRS_BR_CD    = F02_01.NRS_BR_CD                                               " & vbNewLine _
                                                 & "       AND TOPEDI.OUTKA_CTL_NO = F02_01.INOUTKA_NO_L                                            " & vbNewLine _
                                                 & " LEFT JOIN $LM_TRN$..H_OUTKAEDI_L EDIL                                                          " & vbNewLine _
                                                 & "        ON EDIL.NRS_BR_CD  = TOPEDI.NRS_BR_CD                                                   " & vbNewLine _
                                                 & "       AND EDIL.EDI_CTL_NO = TOPEDI.EDI_CTL_NO                                                  " & vbNewLine _
                                                 & " LEFT JOIN $LM_TRN$..H_OUTKAEDI_M EDIM                                                          " & vbNewLine _
                                                 & "         ON EDIM.NRS_BR_CD  = EDIL.NRS_BR_CD                                                    " & vbNewLine _
                                                 & "        AND EDIM.EDI_CTL_NO = EDIL.EDI_CTL_NO                                                   " & vbNewLine _
                                                 & "--707 出荷M  START                                                                              " & vbNewLine _
                                                 & "--出荷M                                                                                         " & vbNewLine _
                                                 & "LEFT JOIN                                                                                       " & vbNewLine _
                                                 & "(SELECT                                                                                         " & vbNewLine _
                                                 & "*                                                                                               " & vbNewLine _
                                                 & "FROM                                                                                            " & vbNewLine _
                                                 & "(SELECT                                                                                         " & vbNewLine _
                                                 & "   M.NRS_BR_CD                                                                                  " & vbNewLine _
                                                 & "  ,M.GOODS_CD_NRS                                                                               " & vbNewLine _
                                                 & "  ,M.IRIME                                                                                      " & vbNewLine _
                                                 & "  ,M.IRIME_UT                                                                                   " & vbNewLine _
                                                 & "  ,M.ALCTD_NB                                                                                   " & vbNewLine _
                                                 & "  ,M.LOT_NO                                                                                     " & vbNewLine _
                                                 & "  ,M.CUST_ORD_NO_DTL   --2012/06/11浮間対応                                                     " & vbNewLine _
                                                 & "  ,M.SYS_DEL_FLG                                                                                " & vbNewLine _
                                                 & "  ,ROW_NUMBER() OVER (PARTITION BY M.NRS_BR_CD ORDER BY M.OUTKA_NO_L,M.OUTKA_NO_M) AS NUM       " & vbNewLine _
                                                 & "  ,M.OUTKA_NO_L                                                                                 " & vbNewLine _
                                                 & "  ,M.OUTKA_NO_M                                                                                 " & vbNewLine _
                                                 & "  FROM                                                                                          " & vbNewLine _
                                                 & "--(2012.06.18)要望番号1160対応 ---  END  ----                                                   " & vbNewLine _
                                                 & "   $LM_TRN$..C_OUTKA_M M                                                                        " & vbNewLine _
                                                 & "--(2012.06.18)要望番号1160対応 --- START ----                                                   " & vbNewLine _
                                                 & "   LEFT JOIN $LM_TRN$..C_OUTKA_L OUTL                                                           " & vbNewLine _
                                                 & "         ON  OUTL.NRS_BR_CD  = M.NRS_BR_CD                                                      " & vbNewLine _
                                                 & "         AND OUTL.OUTKA_NO_L = M.OUTKA_NO_L                                                     " & vbNewLine _
                                                 & "         AND OUTL.SYS_DEL_FLG  = '0'                                                            " & vbNewLine _
                                                 & "   LEFT JOIN $LM_TRN$..F_UNSO_L FL                                                              " & vbNewLine _
                                                 & "          ON FL.NRS_BR_CD    = M.NRS_BR_CD                                                      " & vbNewLine _
                                                 & "         AND FL.INOUTKA_NO_L = M.OUTKA_NO_L                                                     " & vbNewLine _
                                                 & "         AND FL.MOTO_DATA_KB = '20'                                                             " & vbNewLine _
                                                 & "         AND FL.SYS_DEL_FLG  = '0'                                                              " & vbNewLine _
                                                 & "--(2012.06.18)要望番号1160対応 ---  END  ----                                                   " & vbNewLine _
                                                 & "----まとめから　開始                                                                            " & vbNewLine _
                                                 & ",( SELECT                                                                                       " & vbNewLine _
                                                 & "        OUTL.NRS_BR_CD       AS NRS_BR_CD                                                       " & vbNewLine _
                                                 & "      , OUTL.CUST_CD_L       AS CUST_CD_L                                                       " & vbNewLine _
                                                 & "      , OUTL.CUST_CD_M       AS CUST_CD_M                                                       " & vbNewLine _
                                                 & "      , OUTL.OUTKA_PLAN_DATE AS OUTKA_PLAN_DATE                                                 " & vbNewLine _
                                                 & "      , OUTL.ARR_PLAN_DATE   AS ARR_PLAN_DATE                                                   " & vbNewLine _
                                                 & "      , UNSOL.UNSO_CD        AS UNSO_CD                                                         " & vbNewLine _
                                                 & "      , UNSOL.UNSO_BR_CD     AS UNSO_BR_CD                                                      " & vbNewLine _
                                                 & "      , OUTL.DEST_CD         AS DEST_CD                                                         " & vbNewLine _
                                                 & "      , OUTL.OUTKA_NO_L      AS OUTKA_NO_L                                                      " & vbNewLine _
                                                 & "	FROM $LM_TRN$..F_UNSO_L UNSOL                                                               " & vbNewLine _
                                                 & "       LEFT JOIN $LM_TRN$..C_OUTKA_L OUTL                                                       " & vbNewLine _
                                                 & "              ON UNSOL.NRS_BR_CD  = OUTL.NRS_BR_CD                                              " & vbNewLine _
                                                 & "             AND UNSOL.INOUTKA_NO_L = OUTL.OUTKA_NO_L                                           " & vbNewLine _
                                                 & " WHERE OUTL.SYS_DEL_FLG = '0'                                                                   " & vbNewLine _
                                                 & "   AND UNSOL.UNSO_NO_L  = @OUTKA_NO_L )MAT                                                      " & vbNewLine _
                                                 & "                                                                                                " & vbNewLine _
                                                 & "----まとめから　終了                                                                            " & vbNewLine _
                                                 & "                                                                                                " & vbNewLine _
                                                 & "  WHERE                                                                                         " & vbNewLine _
                                                 & "      M.NRS_BR_CD = @NRS_BR_CD                                                                  " & vbNewLine _
                                                 & "--(2012.06.18)要望番号1160対応 --- START ----                                                   " & vbNewLine _
                                                 & "    AND OUTL.CUST_CD_L       = MAT.NRS_BR_CD --@CUST_CD_L                                       " & vbNewLine _
                                                 & "    AND OUTL.CUST_CD_M       = MAT.CUST_CD_M  --@CUST_CD_M                                      " & vbNewLine _
                                                 & "    AND OUTL.OUTKA_PLAN_DATE = MAT.OUTKA_PLAN_DATE   --@OUTKA_PLAN_DATE                         " & vbNewLine _
                                                 & "    AND OUTL.ARR_PLAN_DATE   = MAT.ARR_PLAN_DATE  --@ARR_PLAN_DATE                              " & vbNewLine _
                                                 & "    AND FL.UNSO_CD           = MAT.UNSO_CD  --@UNSO_CD                                          " & vbNewLine _
                                                 & "    AND FL.UNSO_BR_CD        = MAT.UNSO_BR_CD  --@UNSO_BR_CD                                    " & vbNewLine _
                                                 & "    AND OUTL.DEST_CD         = MAT.DEST_CD  --@DEST_CD                                          " & vbNewLine _
                                                 & "    AND M.SYS_DEL_FLG = '0'                                                                     " & vbNewLine _
                                                 & "--(2012.06.18)要望番号1160対応 ---  END  ----                                                   " & vbNewLine _
                                                 & " ) AS BASE                                                                                      " & vbNewLine _
                                                 & "-- WHERE                                                                                        " & vbNewLine _
                                                 & "-- BASE.NUM = 1                                                                                 " & vbNewLine _
                                                 & ") OUTM                                                                                          " & vbNewLine _
                                                 & "--ON                                                                                            " & vbNewLine _
                                                 & "--1 = 1                                                                                         " & vbNewLine _
                                                 & "--(2012.06.18)要望番号1160対応 --- START ----                                                   " & vbNewLine _
                                                 & " ON F02_01.NRS_BR_CD  = OUTM.NRS_BR_CD                                                          " & vbNewLine _
                                                 & "AND F02_01.INOUTKA_NO_L = OUTM.OUTKA_NO_L                                                       " & vbNewLine _
                                                 & "--(2012.06.18)要望番号1160対応 ---  END  ----                                                   " & vbNewLine _
                                                 & "--707 出荷M  END                                                                                " & vbNewLine _
                                                 & "---LMC707 E N D--                                                                               " & vbNewLine _
                                                 & "  LEFT JOIN $LM_MST$..M_NRS_BR    M01_01                                                        " & vbNewLine _
                                                 & "         ON F02_01.NRS_BR_CD    = M01_01.NRS_BR_CD                                              " & vbNewLine _
                                                 & "        AND M01_01.SYS_DEL_FLG  = '0'                                                           " & vbNewLine _
                                                 & "  LEFT JOIN $LM_MST$..M_CUST      M07_01                                                        " & vbNewLine _
                                                 & "         ON F02_01.NRS_BR_CD    = M07_01.NRS_BR_CD                                              " & vbNewLine _
                                                 & "        AND F02_01.CUST_CD_L    = M07_01.CUST_CD_L                                              " & vbNewLine _
                                                 & "        AND F02_01.CUST_CD_M    = M07_01.CUST_CD_M                                              " & vbNewLine _
                                                 & "        AND M07_01.CUST_CD_S    = '00'                                                          " & vbNewLine _
                                                 & "        AND M07_01.CUST_CD_SS   = '00'                                                          " & vbNewLine _
                                                 & "        AND M07_01.SYS_DEL_FLG  = '0'                                                           " & vbNewLine _
                                                 & "  LEFT JOIN $LM_MST$..M_DEST      M10_01                                                        " & vbNewLine _
                                                 & "         ON F02_01.NRS_BR_CD    = M10_01.NRS_BR_CD                                              " & vbNewLine _
                                                 & "        AND F02_01.CUST_CD_L    = M10_01.CUST_CD_L                                              " & vbNewLine _
                                                 & "        AND F02_01.DEST_CD      = M10_01.DEST_CD                                                " & vbNewLine _
                                                 & "        AND M10_01.SYS_DEL_FLG  = '0'                                                           " & vbNewLine _
                                                 & "  LEFT JOIN  $LM_MST$..M_DEST   SHIPDEST                                                        " & vbNewLine _
                                                 & "         ON  F02_01.NRS_BR_CD   = SHIPDEST.NRS_BR_CD                                            " & vbNewLine _
                                                 & "        AND  F02_01.CUST_CD_L   = SHIPDEST.CUST_CD_L                                            " & vbNewLine _
                                                 & "        AND  F02_01.SHIP_CD     = SHIPDEST.DEST_CD                                              " & vbNewLine _
                                                 & "        AND  SHIPDEST.SYS_DEL_FLG = '0'                                                         " & vbNewLine _
                                                 & "--区分マスタ(LMC575支払コード(NM3)KB0801)                                                       " & vbNewLine _
                                                 & "        LEFT JOIN $LM_MST$..Z_KBN KB0801                                                        " & vbNewLine _
                                                 & "        ON  KB0801.KBN_GROUP_CD = 'O007'                                                        " & vbNewLine _
                                                 & "        AND KB0801.KBN_CD       = '16'                                                          " & vbNewLine _
                                                 & "        AND KB0801.SYS_DEL_FLG  = '0'                                                           " & vbNewLine _
                                                 & "--区分マスタ(LMC575支払コード(NM3)KB0802)                                                       " & vbNewLine _
                                                 & "        LEFT JOIN $LM_MST$..Z_KBN KB0802                                                        " & vbNewLine _
                                                 & "        ON  KB0802.KBN_GROUP_CD = 'O007'                                                        " & vbNewLine _
                                                 & "        AND KB0802.KBN_CD       = '17'                                                          " & vbNewLine _
                                                 & "        AND KB0802.SYS_DEL_FLG  = '0'                                                           " & vbNewLine _
                                                 & "--区分マスタ(LMC670 KB0803)                                                                     " & vbNewLine _
                                                 & "        LEFT JOIN $LM_MST$..Z_KBN KB0803                                                        " & vbNewLine _
                                                 & "        ON  KB0803.KBN_GROUP_CD = 'O007'                                                        " & vbNewLine _
                                                 & "        AND KB0803.KBN_CD       = '18'                                                          " & vbNewLine _
                                                 & "        AND KB0803.SYS_DEL_FLG  = '0'                                                           " & vbNewLine _
                                                 & "--要望番号803                                                                                   " & vbNewLine _
                                                 & "  LEFT JOIN $LM_MST$..M_DEST      DEST2                                                         " & vbNewLine _
                                                 & "         ON F02_01.NRS_BR_CD    = DEST2.NRS_BR_CD                                               " & vbNewLine _
                                                 & "        AND F02_01.CUST_CD_L    = DEST2.CUST_CD_L                                               " & vbNewLine _
                                                 & "        --要望番号834対応　F_UNSO_LとのJOINをORIG_CDからDEST_CDに変更 -- START --               " & vbNewLine _
                                                 & "        --AND F02_01.ORIG_CD    = DEST2.DEST_CD                                                 " & vbNewLine _
                                                 & "        AND F02_01.DEST_CD      = DEST2.DEST_CD                                                 " & vbNewLine _
                                                 & "        --要望番号834対応　F_UNSO_LとのJOINをORIG_CDからDEST_CDに変更 --  END  --               " & vbNewLine _
                                                 & "        AND M10_01.SYS_DEL_FLG  = '0'                                                           " & vbNewLine _
                                                 & "--JISマスタ(LMC661にてJIS_CD2桁：都道府県コード取得)2012.05.25                                  " & vbNewLine _
                                                 & "  LEFT JOIN  $LM_MST$..M_JIS   JIS                                                              " & vbNewLine _
                                                 & "         ON  JIS.JIS_CD       = M10_01.JIS                                                      " & vbNewLine _
                                                 & "        AND  JIS.SYS_DEL_FLG  = '0'                                                             " & vbNewLine _
                                                 & "--運送会社マスタ(LMC589にてUNSOCO_NM：取次先運送会社名取得)2012.05.25                           " & vbNewLine _
                                                 & "--  LEFT JOIN  $LM_MST$..M_UNSOCO   MUC                                                         " & vbNewLine _
                                                 & "--         ON  MUC.NRS_BR_CD    = F02_01.NRS_BR_CD                                              " & vbNewLine _
                                                 & "--        AND  MUC.UNSOCO_CD    = F02_01.UNSO_CD                                                " & vbNewLine _
                                                 & "--        AND  MUC.UNSOCO_BR_CD = F02_01.UNSO_BR_CD                                             " & vbNewLine _
                                                 & "--        AND  MUC.SYS_DEL_FLG  = '0'                                                           " & vbNewLine _
                                                 & "--荷主明細マスタ(LMC660にてSET_NAIYO：支払コード取得)2012.05.25                                 " & vbNewLine _
                                                 & "  LEFT JOIN $LM_MST$..M_CUST_DETAILS MCD_SAI                                                    " & vbNewLine _
                                                 & "         ON MCD_SAI.NRS_BR_CD   = F02_01.NRS_BR_CD                                              " & vbNewLine _
                                                 & "        AND MCD_SAI.CUST_CD      = F02_01.CUST_CD_L                                             " & vbNewLine _
                                                 & "--        AND MCD_SAI.CUST_CD_EDA  = F02_01.CUST_CD_M                                             " & vbNewLine _
                                                 & "        AND MCD_SAI.SUB_KB       = '27'                                                         " & vbNewLine _
                                                 & "        AND MCD_SAI.SYS_DEL_FLG  = '0'                                                          " & vbNewLine _
                                                 & "--荷主明細マスタ(LMC669にてSET_NAIYO：荷送人名称取得)2012.06.01                                 " & vbNewLine _
                                                 & "  LEFT JOIN $LM_MST$..M_CUST_DETAILS MCD_NFC                                                    " & vbNewLine _
                                                 & "         ON MCD_NFC.NRS_BR_CD   = F02_01.NRS_BR_CD                                              " & vbNewLine _
                                                 & "        AND MCD_NFC.CUST_CD      = F02_01.CUST_CD_L                                             " & vbNewLine _
                                                 & "--        AND MCD_NFC.CUST_CD_EDA  = F02_01.CUST_CD_M--notes 1118                               " & vbNewLine _
                                                 & "        AND MCD_NFC.SUB_KB       = '29'                                                         " & vbNewLine _
                                                 & "        AND MCD_NFC.SYS_DEL_FLG  = '0'                                                          " & vbNewLine _
                                                 & " --要望番号1383 [LMC664] --- START ---                                                          " & vbNewLine _
                                                 & "         LEFT JOIN (SELECT NRS_BR_CD   AS NRS_BR_CD                                             " & vbNewLine _
                                                 & "                         , CUST_CD     AS CUST_CD                                               " & vbNewLine _
                                                 & "                         , CUST_CLASS  AS CUST_CLASS                                            " & vbNewLine _
                                                 & "                         , SET_NAIYO   AS CUST_NAIYO_1                                          " & vbNewLine _
                                                 & "                         , SET_NAIYO_2 AS CUST_NAIYO_2                                          " & vbNewLine _
                                                 & "                         , SET_NAIYO_3 AS CUST_NAIYO_3                                          " & vbNewLine _
                                                 & "                      FROM $LM_MST$..M_CUST_DETAILS                                             " & vbNewLine _
                                                 & "                     WHERE SUB_KB ='42'                                                         " & vbNewLine _
                                                 & "                       AND SET_NAIYO_2 = @RPT_ID                                                " & vbNewLine _
                                                 & "                       AND SYS_DEL_FLG = '0'                                                    " & vbNewLine _
                                                 & "                    ) MCD_CUST                                                                  " & vbNewLine _
                                                 & "                ON M07_01.NRS_BR_CD = MCD_CUST.NRS_BR_CD                                        " & vbNewLine _
                                                 & "               AND (CASE WHEN MCD_CUST.CUST_CLASS='00' THEN  M07_01.CUST_CD_L                                                            " & vbNewLine _
                                                 & "                         WHEN MCD_CUST.CUST_CLASS='01' THEN (M07_01.CUST_CD_L + M07_01.CUST_CD_M)                                        " & vbNewLine _
                                                 & "                         WHEN MCD_CUST.CUST_CLASS='02' THEN (M07_01.CUST_CD_L + M07_01.CUST_CD_M + M07_01.CUST_CD_S)                     " & vbNewLine _
                                                 & "                         WHEN MCD_CUST.CUST_CLASS='03' THEN (M07_01.CUST_CD_L + M07_01.CUST_CD_M + M07_01.CUST_CD_S + M07_01.CUST_CD_SS) " & vbNewLine _
                                                 & "                    END                                                                         " & vbNewLine _
                                                 & "                   ) = MCD_CUST.CUST_CD                                                         " & vbNewLine _
                                                 & " --要望番号1383 [LMC664] --- END ---                                                            " & vbNewLine

    ''' <summary>
    ''' 帳票PTN
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_FROM_UNSO_PRT_707 As String = "  LEFT JOIN $LM_TRN$..F_UNSO_M   F03_01                                                            " & vbNewLine _
                                              & "         ON F02_01.NRS_BR_CD   = F03_01.NRS_BR_CD                                                  " & vbNewLine _
                                              & "        AND F02_01.UNSO_NO_L   = F03_01.UNSO_NO_L                                                  " & vbNewLine _
                                              & "        AND F03_01.SYS_DEL_FLG = '0'                                                               " & vbNewLine _
                                              & "  LEFT JOIN $LM_MST$..M_GOODS    M08_01                                                            " & vbNewLine _
                                              & "    ON F02_01.NRS_BR_CD        = M08_01.NRS_BR_CD                                                  " & vbNewLine _
                                              & "   AND F03_01.GOODS_CD_NRS     = M08_01.GOODS_CD_NRS                                               " & vbNewLine _
                                              & "   AND M08_01.SYS_DEL_FLG      = '0'                                                               " & vbNewLine _
                                              & "  LEFT JOIN $LM_MST$..M_UNSO_CUST_RPT M68_01                                                       " & vbNewLine _
                                              & "    ON F02_01.NRS_BR_CD        = M68_01.NRS_BR_CD                                                  " & vbNewLine _
                                              & "   AND F02_01.UNSO_CD          = M68_01.UNSOCO_CD                                                  " & vbNewLine _
                                              & "   AND F02_01.UNSO_BR_CD       = M68_01.UNSOCO_BR_CD                                               " & vbNewLine _
                                              & "   AND M68_01.PTN_ID           = '11'                                                              " & vbNewLine _
                                              & "   AND F02_01.PC_KB            = M68_01.MOTO_TYAKU_KB                                              " & vbNewLine _
                                              & "   AND M68_01.CUST_CD_L        = ''                                                                " & vbNewLine _
                                              & "   AND M68_01.CUST_CD_M        = ''                                                                " & vbNewLine _
                                              & "   AND M68_01.SYS_DEL_FLG      = '0'                                                               " & vbNewLine _
                                              & "  LEFT JOIN $LM_MST$..M_RPT      M22_01                                                            " & vbNewLine _
                                              & "    ON M68_01.NRS_BR_CD        = M22_01.NRS_BR_CD                                                  " & vbNewLine _
                                              & "   AND M68_01.PTN_ID           = M22_01.PTN_ID                                                     " & vbNewLine _
                                              & "   AND M68_01.PTN_CD           = M22_01.PTN_CD                                                     " & vbNewLine _
                                              & "   AND M22_01.SYS_DEL_FLG = '0'                                                                    " & vbNewLine _
                                              & "  LEFT JOIN $LM_MST$..M_UNSO_CUST_RPT M68_02                                                       " & vbNewLine _
                                              & "    ON F02_01.NRS_BR_CD        = M68_02.NRS_BR_CD                                                  " & vbNewLine _
                                              & "   AND F02_01.UNSO_CD          = M68_02.UNSOCO_CD                                                  " & vbNewLine _
                                              & "   AND F02_01.UNSO_BR_CD       = M68_02.UNSOCO_BR_CD                                               " & vbNewLine _
                                              & "   AND M68_02.PTN_ID           = '11'                                                              " & vbNewLine _
                                              & "   AND F02_01.PC_KB            = M68_02.MOTO_TYAKU_KB                                              " & vbNewLine _
                                              & "   AND F02_01.CUST_CD_L        = M68_02.CUST_CD_L                                                  " & vbNewLine _
                                              & "   AND F02_01.CUST_CD_M        = M68_02.CUST_CD_M                                                  " & vbNewLine _
                                              & "   AND M68_02.SYS_DEL_FLG      = '0'                                                               " & vbNewLine _
                                              & "  LEFT JOIN $LM_MST$..M_RPT      M22_02                                                            " & vbNewLine _
                                              & "    ON M68_02.NRS_BR_CD        = M22_02.NRS_BR_CD                                                  " & vbNewLine _
                                              & "   AND M68_02.PTN_ID           = M22_02.PTN_ID                                                     " & vbNewLine _
                                              & "   AND M22_02.SYS_DEL_FLG = '0'                                                                    " & vbNewLine _
                                              & "   AND M68_02.PTN_CD           = M22_02.PTN_CD                                                     " & vbNewLine


    ''' <summary>
    ''' 運送グループ条件
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_GROUP_UNSO_DATA_707 As String = " GROUP BY                           " & vbNewLine _
                                                & "          M22_02.PTN_CD             " & vbNewLine _
                                                & "        , M22_02.RPT_ID             " & vbNewLine _
                                                & "        , M22_01.PTN_CD             " & vbNewLine _
                                                & "        , M22_01.RPT_ID             " & vbNewLine _
                                                & "        , M07_01.DENPYO_NM          " & vbNewLine _
                                                & "        , M07_01.CUST_NM_L          " & vbNewLine _
                                                & "--      , M08_01.GOODS_CD_CUST      " & vbNewLine _
                                                & "        , JIS.JIS_CD                " & vbNewLine _
                                                & "        , F02_01.NRS_BR_CD          " & vbNewLine _
                                                & "        , F02_01.OUTKA_PLAN_DATE    " & vbNewLine _
                                                & "        , F02_01.UNSO_NO_L          " & vbNewLine _
                                                & "        , F02_01.ARR_PLAN_DATE      " & vbNewLine _
                                                & "        , F02_01.ARR_PLAN_TIME      " & vbNewLine _
                                                & "        , DEST2.TEL                 " & vbNewLine _
                                                & "        , DEST2.AD_1                " & vbNewLine _
                                                & "        , DEST2.AD_2                " & vbNewLine _
                                                & "        , F02_01.AD_3                " & vbNewLine _
                                                & "        , DEST2.DEST_NM             " & vbNewLine _
                                                & "        , M07_01.CUST_NM_L          " & vbNewLine _
                                                & "        , DEST2.ZIP                 " & vbNewLine _
                                                & "        , F02_01.UNSO_PKG_NB        " & vbNewLine _
                                                & "        , M01_01.NRS_BR_NM          " & vbNewLine _
                                                & "        , M01_01.AD_1               " & vbNewLine _
                                                & "        , M01_01.AD_2               " & vbNewLine _
                                                & "        , M01_01.TEL                " & vbNewLine _
                                                & "        , F02_01.CUST_CD_L          " & vbNewLine _
                                                & "        , F02_01.REMARK             " & vbNewLine _
                                                & "        , F02_01.BUY_CHU_NO         " & vbNewLine _
                                                & "        , DEST2.DEST_NM             " & vbNewLine _
                                                & "        , DEST2.AD_1                " & vbNewLine _
                                                & "        , DEST2.AD_2                " & vbNewLine _
                                                & "        , DEST2.AD_3                " & vbNewLine _
                                                & "        , DEST2.TEL                 " & vbNewLine _
                                                & "        , DEST2.DEST_CD             " & vbNewLine _
                                                & "        , M01_01.FAX                " & vbNewLine _
                                                & "        , SHIPDEST.DEST_NM          " & vbNewLine _
                                                & "        , KB0801.KBN_NM3            " & vbNewLine _
                                                & "        , KB0802.KBN_NM3            " & vbNewLine _
                                                & "        , MCD_SAI.SET_NAIYO         " & vbNewLine _
                                                & "        , MCD_SAI.SET_NAIYO_3       " & vbNewLine _
                                                & "        , MCD_NFC.SET_NAIYO         " & vbNewLine _
                                                & "        , MCD_NFC.SET_NAIYO_2       " & vbNewLine _
                                                & "        , MCD_NFC.SET_NAIYO_3       " & vbNewLine _
                                                & "        , MCD_SAI.SET_NAIYO_2       " & vbNewLine _
                                                & "        , DEST2.REMARK              " & vbNewLine _
                                                & "        , MCD_CUST.CUST_NAIYO_1     " & vbNewLine _
                                                & "        , EDIM.GOODS_NM             " & vbNewLine _
                                                & "        , OUTM.ALCTD_NB             " & vbNewLine _
                                                & "--      , M08_01.GOODS_CD_CUST      " & vbNewLine _
                                                & "        , EDIM.FREE_C01 + '  ' + EDIM.FREE_C02" & vbNewLine _
                                                & "        , M01_01.ZIP                " & vbNewLine _
                                                & "        , F02_01.AUTO_DENP_KBN      " & vbNewLine _
                                                & "        , F02_01.AUTO_DENP_NO       " & vbNewLine
    ''' <summary>
    ''' 運送抽出条件
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_WHERE_UNSO_DATA_707 As String = "      WHERE  F02_01.UNSO_NO_L   = @OUTKA_NO_L                                                    " & vbNewLine _
                                                & "        AND  F02_01.SYS_DEL_FLG = '0'                                                            " & vbNewLine

#End Region
    '2012.12.26  大阪用　━━━━━━━━ END ━━━━━━━━ 
#Region "MARUWA_UNSO"
    ''' <summary>
    ''' 運送データ取得(九州・丸和バイオ)
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_SELECT_UNSO_DATA_MARUWA As String = "--UNSO_OKURIJO_SQL                                                                              " & vbNewLine _
                                            & "SELECT                                                                                          " & vbNewLine _
                                            & "       CASE WHEN M22_02.PTN_CD IS NOT NULL THEN M22_02.RPT_ID                                   " & vbNewLine _
                                            & "            WHEN M22_01.PTN_CD IS NOT NULL THEN M22_01.RPT_ID                                   " & vbNewLine _
                                            & "            ELSE '' END                                       AS RPT_ID                         " & vbNewLine _
                                            & "           ,F02_01.NRS_BR_CD                                  AS NRS_BR_CD                      " & vbNewLine _
                                            & "           ,F02_01.OUTKA_PLAN_DATE                            AS OUTKA_PLAN_DATE                " & vbNewLine _
                                            & "           ,F02_01.UNSO_NO_L                                  AS OUTKA_NO_L                     " & vbNewLine _
                                            & "           ,''                                                AS SHITEN_TEL_560_1               " & vbNewLine _
                                            & "           ,''                                                AS SHITEN_NM_560_1                " & vbNewLine _
                                            & "           ,F02_01.ARR_PLAN_DATE                              AS ARR_PLAN_DATE                  " & vbNewLine _
                                            & "           ,F02_01.ARR_PLAN_TIME                              AS ARR_PLAN_TIME                  " & vbNewLine _
                                            & "           ,DEST2.TEL                                         AS DEST_TEL                       " & vbNewLine _
                                            & "           ,''                                                AS CUST_TEL                       " & vbNewLine _
                                            & "           ,''                                                AS CUST_AD_1                      " & vbNewLine _
                                            & "           ,''                                                AS CUST_AD_2                      " & vbNewLine _
                                            & "           ,DEST2.AD_1                                        AS DEST_AD_1                      " & vbNewLine _
                                            & "           ,''                                                AS CUST_AD_3                      " & vbNewLine _
                                            & "           ,DEST2.AD_2                                        AS DEST_AD_2                      " & vbNewLine _
                                            & "           ,F02_01.AD_3                                       AS DEST_AD_3                      " & vbNewLine _
                                            & "           ,''                                                AS BETU_WT                        " & vbNewLine _
                                            & "           ,DEST2.DEST_NM                                     AS DEST_NM_1                      " & vbNewLine _
                                            & "           ,M07_01.CUST_NM_L                                  AS CUST_NM_L                      " & vbNewLine _
                                            & "           ,DEST2.ZIP                                         AS DEST_ZIP                       " & vbNewLine _
                                            & "--(2012.12.10)要望番号1682 --- START ---                                                        " & vbNewLine _
                                            & "           --,(F03_01.BETU_WT * F03_01.UNSO_TTL_NB)           AS UNSO_WT                        " & vbNewLine _
                                            & "           --,SUM((F03_01.BETU_WT * F03_01.UNSO_TTL_NB))        AS UNSO_WT                        " & vbNewLine _
                                            & "           ,F02_01.UNSO_WT     AS UNSO_WT                        " & vbNewLine _
                                            & "--(2012.12.10)要望番号1682 ---  END  ---                                                        " & vbNewLine _
                                            & "           ,F02_01.UNSO_PKG_NB                                AS UNSO_PKG_NB                    " & vbNewLine _
                                            & "           ,''                                                AS CUST_NM_M                      " & vbNewLine _
                                            & "           ,M01_01.NRS_BR_NM                                  AS NRS_BR_NM                      " & vbNewLine _
                                            & "           ,''                                                AS DEST_HOSOKU                    " & vbNewLine _
                                            & "           ,M01_01.AD_1                                       AS NRS_AD_1                       " & vbNewLine _
                                            & "           ,M01_01.AD_2                                       AS NRS_AD_2                       " & vbNewLine _
                                            & "           ,M01_01.TEL                                        AS NRS_TEL                        " & vbNewLine _
                                            & "           ,F02_01.CUST_CD_L                                  AS CUST_CD_L                      " & vbNewLine _
                                            & "           ,F02_01.REMARK                                     AS UNSO_L_REMARK                  " & vbNewLine _
                                            & "           ,''                                                AS OUTKA_L_REMARK                 " & vbNewLine _
                                            & "           ,MAX(ISNULL(F03_01.GOODS_NM,''))                   AS GOODS_NM_1                     " & vbNewLine _
                                            & "           ,''                                                AS OUTKA_ATT                      " & vbNewLine _
                                            & "           ,F02_01.BUY_CHU_NO                                 AS BUYER_ORD_NO                   " & vbNewLine _
                                            & "           ,''                                                AS YELLOW_NO                      " & vbNewLine _
                                            & "           ,''                                                AS SHIHARAI_SHITEN_NM_563_1       " & vbNewLine _
                                            & "           ,''                                                AS SHIHARAI_SHITEN_TEL_563_1      " & vbNewLine _
                                            & "           ,''                                                AS SHITEN_TEL_1_564_1             " & vbNewLine _
                                            & "           ,''                                                AS SHITEN_NM_564_1                " & vbNewLine _
                                            & "           ,''                                                AS SHITEN_TEL_2_564_1             " & vbNewLine _
                                            & "           ,''                                                AS NRS_BR_AD_1                    " & vbNewLine _
                                            & "           ,''                                                AS NRS_BR_AD_2                    " & vbNewLine _
                                            & "           ,''                                                AS NRS_BR_NM_1                    " & vbNewLine _
                                            & "           ,DEST2.DEST_NM                                     AS DEST_NM                        " & vbNewLine _
                                            & "           ,DEST2.AD_1                                        AS AD_1                           " & vbNewLine _
                                            & "           ,DEST2.AD_2                                        AS AD_2                           " & vbNewLine _
                                            & "           ,F02_01.AD_3                                       AS AD_3                           " & vbNewLine _
                                            & "           ,DEST2.TEL                                         AS TEL                            " & vbNewLine _
                                            & "           ,DEST2.DEST_CD                                     AS DEST_CD                        " & vbNewLine _
                                            & "           ,''                                                AS SHIP_CD_L                      " & vbNewLine _
                                            & "           ,''                                                AS SHIHARAI_CD_565_1              " & vbNewLine _
                                            & "           ,''                                                AS SHIHARAI_CD_565_2              " & vbNewLine _
                                            & "           ,M01_01.FAX                                        AS NRS_FAX                        " & vbNewLine _
                                            & "           ,''                                                AS NRS_AD_3                       " & vbNewLine _
                                            & "           ,''                                                AS CUST_ORD_NO                    " & vbNewLine _
                                            & "--(2013.12.11)要望番号2138 修正START                                                            " & vbNewLine _
                                            & "           ,MAX(M08_01.SHOBO_CD)                              AS SHOBO_CD                       " & vbNewLine _
                                            & "--           ,''                                                AS SHOBO_CD                     " & vbNewLine _
                                            & "--(2013.12.11)要望番号2138 修正END                                                              " & vbNewLine _
                                            & "           ,''                                                AS CUST_CD_L_568_1                " & vbNewLine _
                                            & "           ,''                                                AS CUST_CD_L_568_2                " & vbNewLine _
                                            & "           ,''                                                AS NRS_BR_ZIP                     " & vbNewLine _
                                            & "           ,''                                                AS NRS_BR_TEL                     " & vbNewLine _
                                            & "           ,''                                                AS KOTEI_1                        " & vbNewLine _
                                            & "           ,''                                                AS KOTEI_2                        " & vbNewLine _
                                            & "           ,''                                                AS KOTEI_3                        " & vbNewLine _
                                            & "           ,''                                                AS NB_UT                          " & vbNewLine _
                                            & "           ,''                                                AS DENPYO_NM                      " & vbNewLine _
                                            & "           ,''                                                AS SHITEN_NM_570_1                " & vbNewLine _
                                            & "           ,''                                                AS SHITEN_TEL_570_1               " & vbNewLine _
                                            & "           ,F02_01.UNSO_PKG_NB                                AS OUTKA_PKG_NB                   " & vbNewLine _
                                            & "           ,''                                                AS IRIME                          " & vbNewLine _
                                            & "           ,''                                                AS IRIME_UT                       " & vbNewLine _
                                            & "           ,''                                                AS ALCTD_NB                       " & vbNewLine _
                                            & "           ,''                                                AS LOT_NO                         " & vbNewLine _
                                            & "           ,''                                                AS SHITEN_NM_570_2                " & vbNewLine _
                                            & "           ,''                                                AS SHITEN_TEL_570_2               " & vbNewLine _
                                            & "           ,''                                                AS SHIHARAI_SHITEN_CD_563_1       " & vbNewLine _
                                            & "           ,SHIPDEST.DEST_NM                                  AS SHIP_NM_L                      " & vbNewLine _
                                            & "           ,''                                                AS UNSO_CUST_CD                   " & vbNewLine _
                                            & "           ,KB0801.KBN_NM3                                    AS SHIHARAI_CD_575_1              " & vbNewLine _
                                            & "           ,KB0802.KBN_NM3                                    AS SHIHARAI_CD_575_2              " & vbNewLine _
                                            & "           ,CASE WHEN SHIPDEST.DEST_NM <> ''                                                    " & vbNewLine _
                                            & "                      AND SHIPDEST.DEST_NM IS NOT NULL THEN SHIPDEST.DEST_NM                    " & vbNewLine _
                                            & "                 WHEN M07_01.DENPYO_NM   <> ''                                                  " & vbNewLine _
                                            & "                      AND M07_01.DENPYO_NM IS NOT NULL   THEN M07_01.DENPYO_NM                  " & vbNewLine _
                                            & "                 ELSE M07_01.CUST_NM_L                                                          " & vbNewLine _
                                            & "            END                                               AS ATSUKAISYA_NM                  " & vbNewLine _
                                            & "--(2012.12.10)要望番号1682 --- START ---                                                        " & vbNewLine _
                                            & "           --,M08_01.GOODS_CD_CUST                            AS GOODS_CD_CUST   --2012.05.25   " & vbNewLine _
                                            & "           ,MIN(M08_01.GOODS_CD_CUST)                         AS GOODS_CD_CUST   --2012.05.25   " & vbNewLine _
                                            & "--(2012.12.10)要望番号1682 --- START ---                                                        " & vbNewLine _
                                            & "         ,LEFT(JIS.JIS_CD , 2 )                             AS PREF_CD           --2012.05.25   " & vbNewLine _
                                            & ",CASE WHEN LEFT(JIS.JIS_CD,2) ='16' OR                                                          " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '17' OR                                                          " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '18' OR                                                          " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '21' OR                                                          " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '25'                  --ここまで飛騨運輸のエリア                 " & vbNewLine _
                                            & "          THEN '飛騨運輸'                                                                       " & vbNewLine _
                                            & "    WHEN  LEFT(JIS.JIS_CD,2) = '24' OR                                                          " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '29' OR                                                          " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '30' OR                                                          " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '47'                 --ここまで近鉄運輸のエリア                  " & vbNewLine _
                                            & "          THEN '近鉄運輸'                                                                       " & vbNewLine _
                                            & "    WHEN  LEFT(JIS.JIS_CD,2) = '26' OR                                                          " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '28' OR                                                          " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '31' OR                                                          " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '32' OR                                                          " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '33' OR                                                          " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '34' OR                                                          " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '35' OR                                                          " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '36' OR                                                          " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '37' OR                                                          " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '38' OR                                                          " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '39'                                                             " & vbNewLine _
                                            & "          THEN '岡山県貨物'                                                                     " & vbNewLine _
                                            & "          ELSE    '' END            AS TORI_UNSOCO_NM                                           " & vbNewLine _
                                            & "         --,MUC.UNSOCO_NM                                     AS TORI_UNSOCO_NM  --2012.05.25   " & vbNewLine _
                                            & "           ,MCD_SAI.SET_NAIYO                                   AS SAI_SHIHARAI_CD --2012.05.25 " & vbNewLine _
                                            & "           ,MCD_SAI.SET_NAIYO_3        AS SET_NM_L               --2012.05.29                   " & vbNewLine _
                                            & "           ,MCD_NFC.SET_NAIYO          AS NAIYO1                 --2012.06.01                   " & vbNewLine _
                                            & "           ,MCD_NFC.SET_NAIYO_2        AS NAIYO2                 --2012.06.01                   " & vbNewLine _
                                            & "           ,MCD_NFC.SET_NAIYO_3        AS NAIYO3                 --2012.06.01                   " & vbNewLine _
                                            & "           ,MCD_SAI.SET_NAIYO_2        AS NAIYO_CUST_NM          --2012.06.04                   " & vbNewLine _
                                            & "           ,''                         AS CUST_ORD_NO_DTL        --2012.06.11                   " & vbNewLine _
                                            & "           ,''                         AS KBN_CUST_ZIP           --2012.06.18                   " & vbNewLine _
                                            & "           ,''                         AS KBN_CUST_AD            --2012.06.18                   " & vbNewLine _
                                            & "           ,''                         AS KBN_CUST_TEL           --2012.06.18                   " & vbNewLine _
                                            & "           ,''                         AS KBN_CUST_NM            --2012.06.18                   " & vbNewLine _
                                            & "           ,''                         AS OUTKO_DATE             --2012.06.18                   " & vbNewLine _
                                            & "           ,''                         AS ALCTD_WT               --2012.06.18                   " & vbNewLine _
                                            & "           ,''                         AS BUKA_CD                --2012.06.18                   " & vbNewLine _
                                            & "           ,DEST2.REMARK               AS REMARK_DEST            --2012.07.24 丸和運輸　荷受人氏名下の注意書き(REMARK)開始    " & vbNewLine _
                                            & "           --要望番号1383 [LMC664] --- START ---                                                " & vbNewLine _
                                            & "           ,ISNULL(MCD_CUST.CUST_NAIYO_1,'') AS CUST_FLG                                        " & vbNewLine _
                                            & "           --要望番号1383 [LMC664] --- END ---                                                  " & vbNewLine _
                                            & "           --20150730                                                                           " & vbNewLine _
                                            & "           ,M08_01.GOODS_NM_2  AS GOODS_NM_2                                                    " & vbNewLine _
                                            & "           ,''              AS QT_UT_NM                                                         " & vbNewLine _
                                            & "           ,EDIL.FREE_C26              AS OKURIJO_IRAI                                          " & vbNewLine _
                                            & "           ,F03_01.UNSO_TTL_NB * MGD_C.SET_NAIYO + F03_01.HASU  AS  OUTKA_TTL_NB_M                                                    " & vbNewLine _
                                            & "           ,MGD_C.SET_NAIYO AS CASE_IRISU                                                              " & vbNewLine _
                                            & "           ,F03_01.UNSO_NO_M AS  OUTKA_NO_M                                                    " & vbNewLine _
                                            & "           --20150730                                                                           " & vbNewLine
    ''' <summary>
    ''' 帳票PTN(九州・丸和バイオ)
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_FROM_UNSO_PRT_MARUWA As String = "  FROM      $LM_TRN$..F_UNSO_L    F02_01                                                            " & vbNewLine _
                                            & "     --20150731                                                                                                    " & vbNewLine _
                                            & "    LEFT JOIN                                                                                                      " & vbNewLine _
                                            & "          (                                                                                                        " & vbNewLine _
                                            & "            SELECT TOP 4                                                                                           " & vbNewLine _
                                            & "            NRS_BR_CD                                                                                              " & vbNewLine _
                                            & "           ,GOODS_CD_NRS                                                                                           " & vbNewLine _
                                            & "           ,IRIME                                                                                                  " & vbNewLine _
                                            & "           ,IRIME_UT                                                                                               " & vbNewLine _
                                            & "          -- ,ALCTD_NB                                                                                             " & vbNewLine _
                                            & "          -- ,ALCTD_QT                                                                                             " & vbNewLine _
                                            & "           ,PKG_NB                                                                                                 " & vbNewLine _
                                            & "           ,LOT_NO                                                                                                 " & vbNewLine _
                                            & "           ,SYS_DEL_FLG                                                                                            " & vbNewLine _
                                            & "        -- ,CUST_ORD_NO_DTL                                                                                        " & vbNewLine _
                                            & "           ,UNSO_NO_L                                                                                              " & vbNewLine _
                                            & "           ,UNSO_NO_M                                                                                              " & vbNewLine _
                                            & "           ,GOODS_NM                                                                                               " & vbNewLine _
                                            & "           ,BETU_WT                                                                                                " & vbNewLine _
                                            & "           ,UNSO_TTL_NB                                                                                            " & vbNewLine _
                                            & "           ,HASU                                                                                            " & vbNewLine _
                                            & "           FROM                                                                                                    " & vbNewLine _
                                            & "           $LM_TRN$..F_UNSO_M UM                                                                                   " & vbNewLine _
                                            & "           WHERE                                                                                                   " & vbNewLine _
                                            & "              UM.NRS_BR_CD = @NRS_BR_CD                                                                            " & vbNewLine _
                                            & "           AND UM.UNSO_NO_L = @OUTKA_NO_L                                                                          " & vbNewLine _
                                            & "           AND UM.SYS_DEL_FLG = '0'                                                                                " & vbNewLine _
                                            & "           order by UM.UNSO_NO_M                                                                                   " & vbNewLine _
                                            & "           ) F03_01                                                                                                " & vbNewLine _
                                            & "           ON F02_01.NRS_BR_CD   = F03_01.NRS_BR_CD                                                                " & vbNewLine _
                                            & "          AND F02_01.UNSO_NO_L   = F03_01.UNSO_NO_L                                                                " & vbNewLine _
                                            & "          AND F03_01.SYS_DEL_FLG = '0'                                                                             " & vbNewLine _
                                            & "  --20150731                                                                                                       " & vbNewLine _
                                            & "    LEFT JOIN $LM_MST$..M_NRS_BR    M01_01                                                                         " & vbNewLine _
                                            & "           ON F02_01.NRS_BR_CD    = M01_01.NRS_BR_CD                                                               " & vbNewLine _
                                            & "          AND M01_01.SYS_DEL_FLG  = '0'                                                                            " & vbNewLine _
                                            & "    LEFT JOIN $LM_MST$..M_CUST      M07_01                                                                         " & vbNewLine _
                                            & "           ON F02_01.NRS_BR_CD    = M07_01.NRS_BR_CD                                                               " & vbNewLine _
                                            & "          AND F02_01.CUST_CD_L    = M07_01.CUST_CD_L                                                               " & vbNewLine _
                                            & "          AND F02_01.CUST_CD_M    = M07_01.CUST_CD_M                                                               " & vbNewLine _
                                            & "          AND M07_01.CUST_CD_S    = '00'                                                                           " & vbNewLine _
                                            & "          AND M07_01.CUST_CD_SS   = '00'                                                                           " & vbNewLine _
                                            & "          AND M07_01.SYS_DEL_FLG  = '0'                                                                            " & vbNewLine _
                                            & "    LEFT JOIN $LM_MST$..M_DEST      M10_01                                                                         " & vbNewLine _
                                            & "           ON F02_01.NRS_BR_CD    = M10_01.NRS_BR_CD                                                               " & vbNewLine _
                                            & "          AND F02_01.CUST_CD_L    = M10_01.CUST_CD_L                                                               " & vbNewLine _
                                            & "          AND F02_01.DEST_CD      = M10_01.DEST_CD                                                                 " & vbNewLine _
                                            & "          AND M10_01.SYS_DEL_FLG  = '0'                                                                            " & vbNewLine _
                                            & "    LEFT JOIN  $LM_MST$..M_DEST   SHIPDEST                                                                         " & vbNewLine _
                                            & "           ON  F02_01.NRS_BR_CD   = SHIPDEST.NRS_BR_CD                                                             " & vbNewLine _
                                            & "          AND  F02_01.CUST_CD_L   = SHIPDEST.CUST_CD_L                                                             " & vbNewLine _
                                            & "          AND  F02_01.SHIP_CD     = SHIPDEST.DEST_CD                                                               " & vbNewLine _
                                            & "          AND  SHIPDEST.SYS_DEL_FLG = '0'                                                                          " & vbNewLine _
                                            & "  --区分マスタ(LMC575支払コード(NM3)KB0801)                                                                        " & vbNewLine _
                                            & "          LEFT JOIN $LM_MST$..Z_KBN KB0801                                                                         " & vbNewLine _
                                            & "          ON  KB0801.KBN_GROUP_CD = 'O007'                                                                         " & vbNewLine _
                                            & "          AND KB0801.KBN_CD       = '16'                                                                           " & vbNewLine _
                                            & "          AND KB0801.SYS_DEL_FLG  = '0'                                                                            " & vbNewLine _
                                            & "  --区分マスタ(LMC575支払コード(NM3)KB0802)                                                                        " & vbNewLine _
                                            & "          LEFT JOIN $LM_MST$..Z_KBN KB0802                                                                         " & vbNewLine _
                                            & "          ON  KB0802.KBN_GROUP_CD = 'O007'                                                                         " & vbNewLine _
                                            & "          AND KB0802.KBN_CD       = '17'                                                                           " & vbNewLine _
                                            & "          AND KB0802.SYS_DEL_FLG  = '0'                                                                            " & vbNewLine _
                                            & "  --区分マスタ(LMC670 KB0803)                                                                                      " & vbNewLine _
                                            & "          LEFT JOIN $LM_MST$..Z_KBN KB0803                                                                         " & vbNewLine _
                                            & "          ON  KB0803.KBN_GROUP_CD = 'O007'                                                                         " & vbNewLine _
                                            & "          AND KB0803.KBN_CD       = '18'                                                                           " & vbNewLine _
                                            & "          AND KB0803.SYS_DEL_FLG  = '0'                                                                            " & vbNewLine _
                                            & "  --要望番号803                                                                                                    " & vbNewLine _
                                            & "    LEFT JOIN $LM_MST$..M_DEST      DEST2                                                                          " & vbNewLine _
                                            & "           ON F02_01.NRS_BR_CD    = DEST2.NRS_BR_CD                                                                " & vbNewLine _
                                            & "          AND F02_01.CUST_CD_L    = DEST2.CUST_CD_L                                                                " & vbNewLine _
                                            & "          --要望番号834対応　F_UNSO_LとのJOINをORIG_CDからDEST_CDに変更 -- START --                                " & vbNewLine _
                                            & "          --AND F02_01.ORIG_CD    = DEST2.DEST_CD                                                                  " & vbNewLine _
                                            & "          AND F02_01.DEST_CD      = DEST2.DEST_CD                                                                  " & vbNewLine _
                                            & "          --要望番号834対応　F_UNSO_LとのJOINをORIG_CDからDEST_CDに変更 --  END  --                                " & vbNewLine _
                                            & "          AND M10_01.SYS_DEL_FLG  = '0'                                                                            " & vbNewLine _
                                            & "  --JISマスタ(LMC661にてJIS_CD2桁：都道府県コード取得)2012.05.25                                                   " & vbNewLine _
                                            & "    LEFT JOIN  $LM_MST$..M_JIS   JIS                                                                               " & vbNewLine _
                                            & "           ON  JIS.JIS_CD       = M10_01.JIS                                                                       " & vbNewLine _
                                            & "          AND  JIS.SYS_DEL_FLG  = '0'                                                                              " & vbNewLine _
                                            & "  --運送会社マスタ(LMC589にてUNSOCO_NM：取次先運送会社名取得)2012.05.25                                            " & vbNewLine _
                                            & "  --  LEFT JOIN  $LM_MST$..M_UNSOCO   MUC                                                                          " & vbNewLine _
                                            & "  --         ON  MUC.NRS_BR_CD    = F02_01.NRS_BR_CD                                                               " & vbNewLine _
                                            & "  --        AND  MUC.UNSOCO_CD    = F02_01.UNSO_CD                                                                 " & vbNewLine _
                                            & "  --        AND  MUC.UNSOCO_BR_CD = F02_01.UNSO_BR_CD                                                              " & vbNewLine _
                                            & "  --        AND  MUC.SYS_DEL_FLG  = '0'                                                                            " & vbNewLine _
                                            & "  --荷主明細マスタ(LMC660にてSET_NAIYO：支払コード取得)2012.05.25                                                  " & vbNewLine _
                                            & "    LEFT JOIN $LM_MST$..M_CUST_DETAILS MCD_SAI                                                                     " & vbNewLine _
                                            & "           ON MCD_SAI.NRS_BR_CD   = F02_01.NRS_BR_CD                                                               " & vbNewLine _
                                            & "          AND MCD_SAI.CUST_CD      = F02_01.CUST_CD_L                                                              " & vbNewLine _
                                            & "  --        AND MCD_SAI.CUST_CD_EDA  = F02_01.CUST_CD_M                                                              " & vbNewLine _
                                            & "          AND MCD_SAI.SUB_KB       = '27'                                                                          " & vbNewLine _
                                            & "          AND MCD_SAI.SYS_DEL_FLG  = '0'                                                                           " & vbNewLine _
                                            & "  --荷主明細マスタ(LMC669にてSET_NAIYO：荷送人名称取得)2012.06.01                                                  " & vbNewLine _
                                            & "    LEFT JOIN $LM_MST$..M_CUST_DETAILS MCD_NFC                                                                     " & vbNewLine _
                                            & "           ON MCD_NFC.NRS_BR_CD   = F02_01.NRS_BR_CD                                                               " & vbNewLine _
                                            & "          AND MCD_NFC.CUST_CD      = F02_01.CUST_CD_L                                                              " & vbNewLine _
                                            & "  --        AND MCD_NFC.CUST_CD_EDA  = F02_01.CUST_CD_M--notes 1118                                                " & vbNewLine _
                                            & "          AND MCD_NFC.SUB_KB       = '29'                                                                          " & vbNewLine _
                                            & "          AND MCD_NFC.SYS_DEL_FLG  = '0'                                                                           " & vbNewLine _
                                            & "   --要望番号1383 [LMC664] --- START ---                                                                           " & vbNewLine _
                                            & "           LEFT JOIN (SELECT NRS_BR_CD   AS NRS_BR_CD                                                              " & vbNewLine _
                                            & "                           , CUST_CD     AS CUST_CD                                                                " & vbNewLine _
                                            & "                           , CUST_CLASS  AS CUST_CLASS                                                             " & vbNewLine _
                                            & "                           , SET_NAIYO   AS CUST_NAIYO_1                                                           " & vbNewLine _
                                            & "                           , SET_NAIYO_2 AS CUST_NAIYO_2                                                           " & vbNewLine _
                                            & "                           , SET_NAIYO_3 AS CUST_NAIYO_3                                                           " & vbNewLine _
                                            & "                        FROM $LM_MST$..M_CUST_DETAILS                                                              " & vbNewLine _
                                            & "                       WHERE SUB_KB ='42'                                                                          " & vbNewLine _
                                            & "                         AND SET_NAIYO_2 = 'LMC806'                                                                 " & vbNewLine _
                                            & "                         AND SYS_DEL_FLG = '0'                                                                     " & vbNewLine _
                                            & "                      ) MCD_CUST                                                                                   " & vbNewLine _
                                            & "                  ON M07_01.NRS_BR_CD = MCD_CUST.NRS_BR_CD                                                         " & vbNewLine _
                                            & "                 AND (CASE WHEN MCD_CUST.CUST_CLASS='00' THEN  M07_01.CUST_CD_L                                                                             " & vbNewLine _
                                            & "                           WHEN MCD_CUST.CUST_CLASS='01' THEN (M07_01.CUST_CD_L + M07_01.CUST_CD_M)                                                         " & vbNewLine _
                                            & "                           WHEN MCD_CUST.CUST_CLASS='02' THEN (M07_01.CUST_CD_L + M07_01.CUST_CD_M + M07_01.CUST_CD_S)                                      " & vbNewLine _
                                            & "                           WHEN MCD_CUST.CUST_CLASS='03' THEN (M07_01.CUST_CD_L + M07_01.CUST_CD_M + M07_01.CUST_CD_S + M07_01.CUST_CD_SS)                  " & vbNewLine _
                                            & "                      END                                                                                          " & vbNewLine _
                                            & "                     ) = MCD_CUST.CUST_CD                                                                          " & vbNewLine _
                                            & "   --要望番号1383 [LMC664] --- END ---                                                                             " & vbNewLine _
                                            & "    LEFT JOIN $LM_MST$..M_GOODS    M08_01                                                                             " & vbNewLine _
                                            & "      ON F02_01.NRS_BR_CD        = M08_01.NRS_BR_CD                                                                   " & vbNewLine _
                                            & "     AND F03_01.GOODS_CD_NRS     = M08_01.GOODS_CD_NRS                                                                " & vbNewLine _
                                            & "     AND M08_01.SYS_DEL_FLG      = '0'                                                                                " & vbNewLine _
                                            & "    LEFT JOIN $LM_MST$..M_UNSO_CUST_RPT M68_01                                                                        " & vbNewLine _
                                            & "      ON F02_01.NRS_BR_CD        = M68_01.NRS_BR_CD                                                                   " & vbNewLine _
                                            & "     AND F02_01.UNSO_CD          = M68_01.UNSOCO_CD                                                                   " & vbNewLine _
                                            & "     AND F02_01.UNSO_BR_CD       = M68_01.UNSOCO_BR_CD                                                                " & vbNewLine _
                                            & "     AND M68_01.PTN_ID           = '11'                                                                               " & vbNewLine _
                                            & "     AND F02_01.PC_KB            = M68_01.MOTO_TYAKU_KB                                                               " & vbNewLine _
                                            & "     AND M68_01.CUST_CD_L        = ''                                                                                 " & vbNewLine _
                                            & "     AND M68_01.CUST_CD_M        = ''                                                                                 " & vbNewLine _
                                            & "     AND M68_01.SYS_DEL_FLG      = '0'                                                                                " & vbNewLine _
                                            & "    LEFT JOIN $LM_MST$..M_RPT      M22_01                                                                             " & vbNewLine _
                                            & "      ON M68_01.NRS_BR_CD        = M22_01.NRS_BR_CD                                                                   " & vbNewLine _
                                            & "     AND M68_01.PTN_ID           = M22_01.PTN_ID                                                                      " & vbNewLine _
                                            & "     AND M68_01.PTN_CD           = M22_01.PTN_CD                                                                      " & vbNewLine _
                                            & "     AND M22_01.SYS_DEL_FLG = '0'                                                                                     " & vbNewLine _
                                            & "    LEFT JOIN $LM_MST$..M_UNSO_CUST_RPT M68_02                                                                        " & vbNewLine _
                                            & "      ON F02_01.NRS_BR_CD        = M68_02.NRS_BR_CD                                                                   " & vbNewLine _
                                            & "     AND F02_01.UNSO_CD          = M68_02.UNSOCO_CD                                                                   " & vbNewLine _
                                            & "     AND F02_01.UNSO_BR_CD       = M68_02.UNSOCO_BR_CD                                                                " & vbNewLine _
                                            & "     AND M68_02.PTN_ID           = '11'                                                                               " & vbNewLine _
                                            & "     AND F02_01.PC_KB            = M68_02.MOTO_TYAKU_KB                                                               " & vbNewLine _
                                            & "     AND F02_01.CUST_CD_L        = M68_02.CUST_CD_L                                                                   " & vbNewLine _
                                            & "     AND F02_01.CUST_CD_M        = M68_02.CUST_CD_M                                                                   " & vbNewLine _
                                            & "     AND M68_02.SYS_DEL_FLG      = '0'                                                                                " & vbNewLine _
                                            & "    LEFT JOIN $LM_MST$..M_RPT      M22_02                                                                               " & vbNewLine _
                                            & "      ON M68_02.NRS_BR_CD        = M22_02.NRS_BR_CD                                                                   " & vbNewLine _
                                            & "     AND M68_02.PTN_ID           = M22_02.PTN_ID                                                                      " & vbNewLine _
                                            & "     AND M22_02.SYS_DEL_FLG = '0'                                                                                     " & vbNewLine _
                                            & "     AND M68_02.PTN_CD           = M22_02.PTN_CD                                                                      " & vbNewLine _
                                            & "----商品明細マスタ(丸和バイオ　ケース入数) 20150810                                             " & vbNewLine _
                                            & "  LEFT JOIN $LM_MST$..M_GOODS_DETAILS MGD_C                                                                " & vbNewLine _
                                            & "ON MGD_C.NRS_BR_CD   = F03_01.NRS_BR_CD                                                                      " & vbNewLine _
                                            & "AND MGD_C.GOODS_CD_NRS      = F03_01.GOODS_CD_NRS                                                                   " & vbNewLine _
                                            & "AND MGD_C.SUB_KB       = '52'                                                   " & vbNewLine _
                                            & "AND MGD_C.SYS_DEL_FLG  = '0'                                                                             " & vbNewLine _
                                            & "     --20150730                                                                                                       " & vbNewLine _
                                            & "     --EDILより送状依頼を取得                                                                                         " & vbNewLine _
                                            & "     LEFT JOIN                                                                                                        " & vbNewLine _
                                            & "     (                                                                                                                " & vbNewLine _
                                            & "           SELECT TOP 1 EL.* FROM                                                                                     " & vbNewLine _
                                            & "                 (                                                                                                    " & vbNewLine _
                                            & "                 SELECT                                                                                               " & vbNewLine _
                                            & "                    OL.NRS_BR_CD                                                                                      " & vbNewLine _
                                            & "                    ,OL.OUTKA_CTL_NO                                                                                  " & vbNewLine _
                                            & "  			   ,OL.FREE_C26                                                                                          " & vbNewLine _
                                            & "  			   FROM $LM_TRN$..H_OUTKAEDI_L OL                                                                          " & vbNewLine _
                                            & "  			   LEFT JOIN LM_TRN..F_UNSO_L UL                                                                         " & vbNewLine _
                                            & "  			   ON OL.NRS_BR_CD = UL.NRS_BR_CD                                                                         " & vbNewLine _
                                            & "  			   AND OL.OUTKA_CTL_NO = UL.INOUTKA_NO_L                                                                 " & vbNewLine _
                                            & "  			   AND UL.SYS_DEL_FLG = '0'                                                                              " & vbNewLine _
                                            & "  			   where                                                                                                 " & vbNewLine _
                                            & "  			   OL.NRS_BR_CD = '70'                                                                                   " & vbNewLine _
                                            & "  			                                                                                                         " & vbNewLine _
                                            & "  			   AND UNSO_NO_L  = @OUTKA_NO_L                                                                            " & vbNewLine _
                                            & "  			   AND (FREE_C26 <> '' AND FREE_C26 is not null)                                                         " & vbNewLine _
                                            & "  			   AND OL.SYS_DEL_FLG = '0'                                                                              " & vbNewLine _
                                            & "  			   --ORDER BY OL.FREE_C26                                                                                " & vbNewLine _
                                            & "  			   )AS EL                                                                                                " & vbNewLine _
                                            & "  		--WHERE BASE.OUTKA_CTL_NO = F02_01.INOUTKA_NO_L                                                              " & vbNewLine _
                                            & "  		                                                                                                             " & vbNewLine _
                                            & "      ) AS  EDIL                                                                                                      " & vbNewLine _
                                            & "     ON F02_01.NRS_BR_CD = EDIL.NRS_BR_CD                                                                             " & vbNewLine _
                                            & "     AND F02_01.INOUTKA_NO_L = EDIL.OUTKA_CTL_NO                                                                      " & vbNewLine _
                                            & "     --AND EDIL.SYS_DEL_FLG = '0'                                                                                     " & vbNewLine _
                                            & "                                                                                                                       " & vbNewLine _
                                            & "     --20150730                                                                                                     " & vbNewLine

    ''' <summary>
    ''' 運送グループ条件(九州・丸和バイオ)
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_GROUP_UNSO_DATA_MARUWA As String = " GROUP BY                                                                                  " & vbNewLine _
                                            & "          M22_02.PTN_CD                                                                    " & vbNewLine _
                                            & "        , M22_02.RPT_ID                                                                    " & vbNewLine _
                                            & "        , M22_01.PTN_CD                                                                    " & vbNewLine _
                                            & "        , M22_01.RPT_ID                                                                    " & vbNewLine _
                                            & "        , M07_01.DENPYO_NM                                                                 " & vbNewLine _
                                            & "        , M07_01.CUST_NM_L                                                                 " & vbNewLine _
                                            & "		--20150730 GOODS GROUP BY 有効化                                                      " & vbNewLine _
                                            & "        , M08_01.GOODS_CD_CUST                                                             " & vbNewLine _
                                            & "		--20150730                                                                            " & vbNewLine _
                                            & "        , JIS.JIS_CD                                                                       " & vbNewLine _
                                            & "        , F02_01.NRS_BR_CD                                                                 " & vbNewLine _
                                            & "        , F02_01.OUTKA_PLAN_DATE                                                           " & vbNewLine _
                                            & "        , F02_01.UNSO_NO_L                                                                 " & vbNewLine _
                                            & "        , F02_01.ARR_PLAN_DATE                                                             " & vbNewLine _
                                            & "        , F02_01.ARR_PLAN_TIME                                                             " & vbNewLine _
                                            & "        , DEST2.TEL                                                                        " & vbNewLine _
                                            & "        , DEST2.AD_1                                                                       " & vbNewLine _
                                            & "        , DEST2.AD_2                                                                       " & vbNewLine _
                                            & "        , F02_01.AD_3                                                                      " & vbNewLine _
                                            & "        , DEST2.DEST_NM                                                                    " & vbNewLine _
                                            & "        , M07_01.CUST_NM_L                                                                 " & vbNewLine _
                                            & "        , DEST2.ZIP                                                                        " & vbNewLine _
                                            & "        , F02_01.UNSO_WT                                                                        " & vbNewLine _
                                            & "        , F02_01.UNSO_PKG_NB                                                               " & vbNewLine _
                                            & "        , M01_01.NRS_BR_NM                                                                 " & vbNewLine _
                                            & "        , M01_01.AD_1                                                                      " & vbNewLine _
                                            & "        , M01_01.AD_2                                                                      " & vbNewLine _
                                            & "        , M01_01.TEL                                                                       " & vbNewLine _
                                            & "        , F02_01.CUST_CD_L                                                                 " & vbNewLine _
                                            & "        , F02_01.REMARK                                                                    " & vbNewLine _
                                            & "        , F02_01.BUY_CHU_NO                                                                " & vbNewLine _
                                            & "        , DEST2.DEST_NM                                                                    " & vbNewLine _
                                            & "        , DEST2.AD_1                                                                       " & vbNewLine _
                                            & "        , DEST2.AD_2                                                                       " & vbNewLine _
                                            & "        , DEST2.AD_3                                                                       " & vbNewLine _
                                            & "        , DEST2.TEL                                                                        " & vbNewLine _
                                            & "        , DEST2.DEST_CD                                                                    " & vbNewLine _
                                            & "        , M01_01.FAX                                                                       " & vbNewLine _
                                            & "        , SHIPDEST.DEST_NM                                                                 " & vbNewLine _
                                            & "        , KB0801.KBN_NM3                                                                   " & vbNewLine _
                                            & "        , KB0802.KBN_NM3                                                                   " & vbNewLine _
                                            & "        , MCD_SAI.SET_NAIYO                                                                " & vbNewLine _
                                            & "        , MCD_SAI.SET_NAIYO_3                                                              " & vbNewLine _
                                            & "        , MCD_NFC.SET_NAIYO                                                                " & vbNewLine _
                                            & "        , MCD_NFC.SET_NAIYO_2                                                              " & vbNewLine _
                                            & "        , MCD_NFC.SET_NAIYO_3                                                              " & vbNewLine _
                                            & "        , MCD_SAI.SET_NAIYO_2                                                              " & vbNewLine _
                                            & "        , DEST2.REMARK                                                                     " & vbNewLine _
                                            & "        , MCD_CUST.CUST_NAIYO_1                                                            " & vbNewLine _
                                            & "        --20150730                                                                         " & vbNewLine _
                                            & "		,M08_01.GOODS_NM_2                                                                    " & vbNewLine _
                                            & "		,EDIL.FREE_C26                                                                        " & vbNewLine _
                                            & "		,F03_01.UNSO_TTL_NB                                                                        " & vbNewLine _
                                            & "        ,MGD_C.SET_NAIYO                                                                     " & vbNewLine _
                                            & "        ,F03_01.HASU                                                                     " & vbNewLine _
                                            & "		,F03_01.UNSO_NO_M                                                                        " & vbNewLine


    ''' <summary>
    ''' 運送並び替え順条件(九州・丸和バイオ)
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_ORDER_UNSO_DATA_MARUWA As String = " ORDER BY                                                                                  " & vbNewLine _
                                            & "          F02_01.NRS_BR_CD                                                                    " & vbNewLine _
                                            & "        , F02_01.UNSO_NO_L                                                                    " & vbNewLine _
                                            & "        , F03_01.UNSO_NO_M                                                                    " & vbNewLine
    

    ''' <summary>
    ''' 運送抽出条件(九州・丸和バイオ)
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_WHERE_UNSO_DATA_MARUWA As String = "      WHERE  F02_01.UNSO_NO_L   = @OUTKA_NO_L                                                    " & vbNewLine _
                                                & "        AND  F02_01.SYS_DEL_FLG = '0'                                                            " & vbNewLine



#End Region

#End Region

#Region "出荷"

    ''' <summary>
    ''' 帳票種別取得用(☆★作業用コメント：ここは修正済み)
    ''' </summary>
    ''' <remarks></remarks>
#If True Then  'UPD 2018/08/02 千葉　日医工対応　　'UPD 2018/08/22 変更前に戻す
    Private Const SQL_SELECT_MPrt As String = "SELECT DISTINCT                                                                                      " & vbNewLine _
                                        & "    OUTL.NRS_BR_CD                                           AS NRS_BR_CD                            " & vbNewLine _
                                        & ",'11'                                                     AS PTN_ID                                  " & vbNewLine _
                                        & ",CASE WHEN MR2.PTN_CD IS NOT NULL THEN MR2.PTN_CD                                                    " & vbNewLine _
                                        & "         WHEN MR1.PTN_CD IS NOT NULL THEN MR1.PTN_CD                                                 " & vbNewLine _
                                        & "          ELSE '' END                                         AS PTN_CD                              " & vbNewLine _
                                        & ",CASE WHEN MR2.PTN_CD IS NOT NULL THEN MR2.RPT_ID                                                    " & vbNewLine _
                                        & "      WHEN MR1.PTN_CD IS NOT NULL THEN MR1.RPT_ID                                                    " & vbNewLine _
                                        & "         ELSE '' END                                         AS RPT_ID                               " & vbNewLine


#Else
    Private Const SQL_SELECT_MPrt As String = "SELECT DISTINCT                                                                                      " & vbNewLine _
                                        & "    OUTL.NRS_BR_CD                                           AS NRS_BR_CD                            " & vbNewLine _
                                        & ",'11'                                                     AS PTN_ID                                  " & vbNewLine _
                                        & ",CASE WHEN MR4.PTN_CD IS NOT NULL THEN MR4.PTN_CD                                                    " & vbNewLine _
                                        & "      WHEN MR2.PTN_CD IS NOT NULL THEN MR2.PTN_CD                                                    " & vbNewLine _
                                        & "      WHEN MR1.PTN_CD IS NOT NULL THEN MR1.PTN_CD                                                 " & vbNewLine _
                                        & "      ELSE '' END                                         AS PTN_CD                              " & vbNewLine _
                                        & ",CASE WHEN MR4.PTN_CD IS NOT NULL THEN MR4.RPT_ID                                                    " & vbNewLine _
                                        & "      WHEN MR2.PTN_CD IS NOT NULL THEN MR2.RPT_ID                                                    " & vbNewLine _
                                        & "      WHEN MR1.PTN_CD IS NOT NULL THEN MR1.RPT_ID                                                    " & vbNewLine _
                                        & "         ELSE '' END                                         AS RPT_ID                               " & vbNewLine



#End If


    '(2013.04.12)要望番号2015 SELECT句をBP送り状用　追加START(EDIテーブルを見ない)
    ''' <summary>
    ''' 印刷データ抽出用(☆★作業用コメント:ひとまず修正おわり)
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_SELECT_DATA_BPCEDIT As String = "  --SQL_SELECT_DATA                                                                                  " & vbNewLine _
                                            & " SELECT                                                                                               " & vbNewLine _
                                            & " CASE WHEN MR2.PTN_CD IS NOT NULL THEN MR2.RPT_ID                                                    " & vbNewLine _
                                            & "      WHEN MR1.PTN_CD IS NOT NULL THEN MR1.RPT_ID                                                    " & vbNewLine _
                                            & "      ELSE '' END            AS RPT_ID                                                               " & vbNewLine _
                                            & ",OUTL.NRS_BR_CD              AS NRS_BR_CD                                                            " & vbNewLine _
                                            & "--このあたりから要修正の可能性                                                                       " & vbNewLine _
                                            & "--LMC560                                                                                             " & vbNewLine _
                                            & ",OUTL.OUTKA_PLAN_DATE        AS OUTKA_PLAN_DATE                                                      " & vbNewLine _
                                            & ",OUTL.OUTKA_NO_L             AS OUTKA_NO_L                                                           " & vbNewLine _
                                            & ",KB01.KBN_NM4                AS SHITEN_TEL_560_1                                                     " & vbNewLine _
                                            & ",KB01.KBN_NM3                AS SHITEN_NM_560_1                                                      " & vbNewLine _
                                            & ",OUTL.ARR_PLAN_DATE          AS ARR_PLAN_DATE                                                        " & vbNewLine _
                                            & ",KB02.KBN_NM1                AS ARR_PLAN_TIME                                                        " & vbNewLine _
                                            & ",OUTL.DEST_TEL               AS DEST_TEL                                                             " & vbNewLine _
                                            & ",CST.TEL                     AS CUST_TEL                                                             " & vbNewLine _
                                            & ",CST.AD_1                    AS CUST_AD_1                                                            " & vbNewLine _
                                            & ",CST.AD_2                    AS CUST_AD_2                                                            " & vbNewLine _
                                            & ",CASE CUSTDTL2.SET_NAIYO WHEN '01' THEN DST_2.AD_1 ELSE DST.AD_1 END                  AS DEST_AD_1   " & vbNewLine _
                                            & ",CST.AD_3                    AS CUST_AD_3                                                            " & vbNewLine _
                                            & ",CASE CUSTDTL2.SET_NAIYO WHEN '01' THEN DST_2.AD_2 ELSE DST.AD_2 END                  AS DEST_AD_2   " & vbNewLine _
                                            & ",CASE CUSTDTL2.SET_NAIYO WHEN '01' THEN DST_2.AD_3 ELSE DST.AD_3 END                  AS DEST_AD_3   " & vbNewLine _
                                            & ",FL.UNSO_WT                  AS BETU_WT                                                              " & vbNewLine _
                                            & ",CASE CUSTDTL2.SET_NAIYO WHEN '01' THEN DST_2.DEST_NM ELSE DST.DEST_NM END            AS DEST_NM_1   " & vbNewLine _
                                            & ",CST.CUST_NM_L               AS CUST_NM_L                                                            " & vbNewLine _
                                            & "--LMC561                                                                                             " & vbNewLine _
                                            & ",CASE CUSTDTL2.SET_NAIYO WHEN '01' THEN DST_2.ZIP ELSE DST.ZIP END                    AS DEST_ZIP    " & vbNewLine _
                                            & "--LMC562                                                                                             " & vbNewLine _
                                            & "--,(OUTS.BETU_WT * OUTS.ALCTD_NB) AS UNSO_WT                                                         " & vbNewLine _
                                            & "--(2013.07.09)要望番号2076 --- START ---運送Lの運送重量を使用                                        " & vbNewLine _
                                            & ",FL.UNSO_WT                  AS UNSO_WT                                                              " & vbNewLine _
                                            & "--,(SELECT                                                                                             " & vbNewLine _
                                            & "--SUM (UNSO_WT.UNSO_WT) FROM                                                                           " & vbNewLine _
                                            & "--(SELECT                                                                                              " & vbNewLine _
                                            & "----	SUM(OUTS.BETU_WT * OUTS.ALCTD_NB) AS UNSO_WT                                                        " & vbNewLine _
                                            & "--	SUM(OUTS.ALCTD_QT * MG.STD_WT_KGS / MG.STD_IRIME_NB) AS UNSO_WT                                     " & vbNewLine _
                                            & "--	FROM                                                                                                " & vbNewLine _
                                            & "--	$LM_TRN$..C_OUTKA_L OUTL                                                                            " & vbNewLine _
                                            & "--	LEFT JOIN                                                                                           " & vbNewLine _
                                            & "--	$LM_TRN$..C_OUTKA_M OUTM                                                                            " & vbNewLine _
                                            & "--	  ON OUTL.NRS_BR_CD   = OUTM.NRS_BR_CD                                                              " & vbNewLine _
                                            & "--	 AND OUTL.OUTKA_NO_L  = OUTM.OUTKA_NO_L                                                             " & vbNewLine _
                                            & "--	 AND OUTM.SYS_DEL_FLG = '0'                                                                         " & vbNewLine _
                                            & "--	LEFT JOIN                                                                                           " & vbNewLine _
                                            & "--	$LM_TRN$..C_OUTKA_S OUTS                                                                            " & vbNewLine _
                                            & "--	  ON OUTL.NRS_BR_CD   = OUTS.NRS_BR_CD                                                              " & vbNewLine _
                                            & "--	 AND OUTL.OUTKA_NO_L  = OUTS.OUTKA_NO_L                                                             " & vbNewLine _
                                            & "--	 AND OUTM.OUTKA_NO_M  = OUTS.OUTKA_NO_M                                                             " & vbNewLine _
                                            & "--	 AND OUTS.SYS_DEL_FLG = '0'                                                                         " & vbNewLine _
                                            & "--	LEFT JOIN                                                                                           " & vbNewLine _
                                            & "--	$LM_MST$..M_GOODS MG                                                                            " & vbNewLine _
                                            & "--	  ON OUTM.NRS_BR_CD   = MG.NRS_BR_CD                                                              " & vbNewLine _
                                            & "--	 AND OUTM.GOODS_CD_NRS  = MG.GOODS_CD_NRS                                                             " & vbNewLine _
                                            & "--	WHERE                                                                                               " & vbNewLine _
                                            & "--	    OUTL.SYS_DEL_FLG  = '0'                                                                         " & vbNewLine _
                                            & "--	AND OUTL.NRS_BR_CD    = @NRS_BR_CD                                                                  " & vbNewLine _
                                            & "--	AND OUTL.OUTKA_NO_L   = @OUTKA_NO_L                                                                 " & vbNewLine _
                                            & "--	GROUP BY                                                                                            " & vbNewLine _
                                            & "--	 OUTS.BETU_WT                                                                                       " & vbNewLine _
                                            & "--	,OUTS.ALCTD_NB                                                                                      " & vbNewLine _
                                            & "--	,OUTL.NRS_BR_CD                                                                                     " & vbNewLine _
                                            & "--	,OUTL.OUTKA_NO_L                                                                                    " & vbNewLine _
                                            & "--	)  UNSO_WT                                                                                          " & vbNewLine _
                                            & "--	)  UNSO_WT                                                                                          " & vbNewLine _
                                            & ",FL.UNSO_PKG_NB              AS UNSO_PKG_NB                                                          " & vbNewLine _
                                            & ",CST.CUST_NM_M               AS CUST_NM_M                                                            " & vbNewLine _
                                            & "--LMC563                                                                                             " & vbNewLine _
                                            & ",NB.NRS_BR_NM                AS NRS_BR_NM                                                            " & vbNewLine _
                                            & ",EDIL.FREE_C15               AS DEST_HOSOKU                                                          " & vbNewLine _
                                            & ",NB.AD_1                     AS NRS_AD_1                                                             " & vbNewLine _
                                            & ",NB.AD_2                     AS NRS_AD_2                                                             " & vbNewLine _
                                            & ",NB.TEL                      AS NRS_TEL                                                              " & vbNewLine _
                                            & ",CST.CUST_CD_L               AS CUST_CD_L                                                            " & vbNewLine _
                                            & ",FL.REMARK                   AS UNSO_L_REMARK                                                        " & vbNewLine _
                                            & ",OUTL.REMARK                 AS OUTKA_L_REMARK                                                       " & vbNewLine _
                                            & ",MG.GOODS_NM_1               AS GOODS_NM_1                                                           " & vbNewLine _
                                            & ",MG.OUTKA_ATT                AS OUTKA_ATT                                                            " & vbNewLine _
                                            & ",OUTL.BUYER_ORD_NO           AS BUYER_ORD_NO                                                         " & vbNewLine _
                                            & ",''                          AS YELLOW_NO                                                            " & vbNewLine _
                                            & ",KB03.KBN_NM3                AS SHIHARAI_SHITEN_NM_563_1                                             " & vbNewLine _
                                            & ",''                          AS SHIHARAI_SHITEN_CD_563_1                                             " & vbNewLine _
                                            & ",KB03.KBN_NM4                AS SHIHARAI_SHITEN_TEL_563_1                                            " & vbNewLine _
                                            & "--LMC564                                                                                             " & vbNewLine _
                                            & ",KB05.KBN_NM4                AS SHITEN_TEL_1_564_1                                                   " & vbNewLine _
                                            & ",KB05.KBN_NM3                AS SHITEN_NM_564_1                                                      " & vbNewLine _
                                            & ",KB05.KBN_NM4                AS SHITEN_TEL_2_564_1                                                   " & vbNewLine _
                                            & ",NB.AD_1                     AS NRS_BR_AD_1                                                          " & vbNewLine _
                                            & ",NB.AD_2                     AS NRS_BR_AD_2                                                          " & vbNewLine _
                                            & ",NB.NRS_BR_NM                AS NRS_BR_NM_1                                                          " & vbNewLine _
                                            & "--LMC565                                                                                             " & vbNewLine _
                                            & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_NM                                                     " & vbNewLine _
                                            & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_NM                                                     " & vbNewLine _
                                            & "      ELSE DST.DEST_NM                                                                               " & vbNewLine _
                                            & " END                         AS DEST_NM                                                              " & vbNewLine _
                                            & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_AD_1                                                   " & vbNewLine _
                                            & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_AD_1                                                   " & vbNewLine _
                                            & "      ELSE DST.AD_1                                                                                  " & vbNewLine _
                                            & " END                         AS AD_1                                                                 " & vbNewLine _
                                            & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_AD_2                                                   " & vbNewLine _
                                            & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_AD_2                                                   " & vbNewLine _
                                            & "      ELSE DST.AD_2                                                                                  " & vbNewLine _
                                            & " END                         AS AD_2                                                                 " & vbNewLine _
                                            & ",OUTL.DEST_AD_3              AS AD_3                                                                 " & vbNewLine _
                                            & ",OUTL.DEST_TEL               AS TEL                                                                  " & vbNewLine _
                                            & ",OUTL.DEST_CD                AS DEST_CD                                                              " & vbNewLine _
                                            & ",OUTL.SHIP_CD_L              AS SHIP_CD_L                                                            " & vbNewLine _
                                            & ",KB0601.KBN_NM4              AS SHIHARAI_CD_565_1                                                    " & vbNewLine _
                                            & ",KB0602.KBN_NM4              AS SHIHARAI_CD_565_2                                                    " & vbNewLine _
                                            & "--LMC566                                                                                             " & vbNewLine _
                                            & ",NB.FAX                      AS NRS_FAX                                                              " & vbNewLine _
                                            & "--LMC567                                                                                             " & vbNewLine _
                                            & ",NB.AD_3                     AS NRS_AD_3                                                             " & vbNewLine _
                                            & "--LMC568                                                                                             " & vbNewLine _
                                            & ",OUTL.CUST_ORD_NO            AS CUST_ORD_NO                                                          " & vbNewLine _
                                            & ",MG.SHOBO_CD                 AS SHOBO_CD                                                             " & vbNewLine _
                                            & ",KB0701.KBN_NM5              AS CUST_CD_L_568_1                                                      " & vbNewLine _
                                            & ",KB0702.KBN_NM5              AS CUST_CD_L_568_2                                                      " & vbNewLine _
                                            & "--LMC569                                                                                             " & vbNewLine _
                                            & ",NB.ZIP                      AS NRS_BR_ZIP                                                           " & vbNewLine _
                                            & ",NB.TEL                      AS NRS_BR_TEL                                                           " & vbNewLine _
                                            & ",KB08.KBN_NM1                AS KOTEI_1                                                              " & vbNewLine _
                                            & ",KB08.KBN_NM3                AS KOTEI_2                                                              " & vbNewLine _
                                            & ",KB08.KBN_NM5                AS KOTEI_3                                                              " & vbNewLine _
                                            & "--LMC570                                                                                             " & vbNewLine _
                                            & ",FL.NB_UT                    AS NB_UT                                                                " & vbNewLine _
                                            & ",CST.DENPYO_NM               AS DENPYO_NM                                                            " & vbNewLine _
                                            & ",KB1001.KBN_NM3              AS SHITEN_NM_570_1                                                      " & vbNewLine _
                                            & ",KB1001.KBN_NM4              AS SHITEN_TEL_570_1                                                     " & vbNewLine _
                                            & ",KB1002.KBN_NM3              AS SHITEN_NM_570_2                                                      " & vbNewLine _
                                            & ",KB1002.KBN_NM4              AS SHITEN_TEL_570_2                                                     " & vbNewLine _
                                            & "--LMC572                                                                                             " & vbNewLine _
                                            & ",OUTL.OUTKA_PKG_NB           AS OUTKA_PKG_NB                                                         " & vbNewLine _
                                            & ",OUTM.IRIME                  AS IRIME                                                                " & vbNewLine _
                                            & ",OUTM.IRIME_UT               AS IRIME_UT                                                             " & vbNewLine _
                                            & ",OUTM.ALCTD_NB               AS ALCTD_NB                                                             " & vbNewLine _
                                            & ",OUTM.LOT_NO                 AS LOT_NO                                                               " & vbNewLine _
                                            & ",SHIPDST.DEST_NM             AS SHIP_NM_L                                                            " & vbNewLine _
                                            & ",CUSTDTL.SET_NAIYO           AS UNSO_CUST_CD                                                         " & vbNewLine _
                                            & ",KB0801.KBN_NM3              AS SHIHARAI_CD_575_1                                                    " & vbNewLine _
                                            & ",KB0802.KBN_NM3              AS SHIHARAI_CD_575_2                                                    " & vbNewLine _
                                            & "--LMC670                                                                                             " & vbNewLine _
                                            & ",KB0803.KBN_NM1              AS KBN_CUST_ZIP                                                         " & vbNewLine _
                                            & ",KB0803.KBN_NM2              AS KBN_CUST_AD                                                          " & vbNewLine _
                                            & ",KB0803.KBN_NM3              AS KBN_CUST_TEL                                                         " & vbNewLine _
                                            & ",KB0803.KBN_NM4              AS KBN_CUST_NM                                                          " & vbNewLine _
                                            & ",OUTL.OUTKO_DATE             AS OUTKO_DATE                                                           " & vbNewLine _
                                            & ",(MG.STD_WT_KGS * OUTM.ALCTD_NB) AS ALCTD_WT                                                         " & vbNewLine _
                                            & "--,OUTKAEDIL.FREE_C05          AS BUKA_CD                                                            " & vbNewLine _
                                            & ",EDIL.FREE_C05          AS BUKA_CD                                                                   " & vbNewLine _
                                            & ",CASE WHEN SHIPDST.DEST_NM <> ''                                                                     " & vbNewLine _
                                            & "           AND SHIPDST.DEST_NM IS NOT NULL THEN SHIPDST.DEST_NM                                      " & vbNewLine _
                                            & "      WHEN CST.DENPYO_NM   <> ''                                                                     " & vbNewLine _
                                            & "           AND CST.DENPYO_NM IS NOT NULL   THEN CST.DENPYO_NM                                        " & vbNewLine _
                                            & "      ELSE CST.CUST_NM_L                                                                             " & vbNewLine _
                                            & " END                         AS ATSUKAISYA_NM                                                        " & vbNewLine _
                                            & " ,MG.GOODS_CD_CUST           AS GOODS_CD_CUST                 --2012.05.25                           " & vbNewLine _
                                            & " ,LEFT(JIS.JIS_CD,2)         AS PREF_CD                       --2012.05.25                           " & vbNewLine _
                                            & ",CASE WHEN LEFT(JIS.JIS_CD,2) ='16' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '17' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '18' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '21' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '25'                  --ここまで飛騨運輸のエリア                      " & vbNewLine _
                                            & "          THEN '飛騨運輸'                                                                            " & vbNewLine _
                                            & "     WHEN LEFT(JIS.JIS_CD,2) = '24' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '29' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '30' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '47'                  --ここまで近鉄運輸のエリア                      " & vbNewLine _
                                            & "         THEN '近鉄運輸'                                                                             " & vbNewLine _
                                            & "    WHEN  LEFT(JIS.JIS_CD,2) = '26' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '28' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '31' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '32' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '33' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '34' OR                                                               " & vbNewLine _
                                            & "       LEFT(JIS.JIS_CD,2) = '35' OR                                                                  " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '36' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '37' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '38' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '39'                                                                  " & vbNewLine _
                                            & "          THEN '岡山県貨物'                                                                          " & vbNewLine _
                                            & "          ELSE    '' END            AS TORI_UNSOCO_NM                                                " & vbNewLine _
                                            & "     --THEN MUC.UNSOCO_NM   END                                                                      " & vbNewLine _
                                            & "    --                              AS TORI_UNSOCO_NM                                                " & vbNewLine _
                                            & " --,MUC.UNSOCO_NM              AS TORI_UNSOCO_NM                --2012.05.25                         " & vbNewLine _
                                            & " ,MCD_SAI.SET_NAIYO          AS SAI_SHIHARAI_CD               --2012.05.25                           " & vbNewLine _
                                            & " ,MCD_SAI.SET_NAIYO_3        AS SET_NM_L                      --2012.05.29                           " & vbNewLine _
                                            & " ,MCD_NFC.SET_NAIYO          AS NAIYO1                        --2012.06.01                           " & vbNewLine _
                                            & " ,MCD_NFC.SET_NAIYO_2        AS NAIYO2                        --2012.06.01                           " & vbNewLine _
                                            & " ,MCD_NFC.SET_NAIYO_3        AS NAIYO3                        --2012.06.01                           " & vbNewLine _
                                            & " ,MCD_SAI.SET_NAIYO_2        AS NAIYO_CUST_NM                 --2012.06.04                           " & vbNewLine _
                                            & " ,OUTM.CUST_ORD_NO_DTL      AS CUST_ORD_NO_DTL              --2012.06.11                             " & vbNewLine _
                                            & " --2012.07.24 丸和運輸　荷受人氏名下の注意書き(REMARK)開始                                           " & vbNewLine _
                                            & " ,CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.REMARK                                                     " & vbNewLine _
                                            & "       WHEN OUTL.DEST_KB = '02' THEN EDIL.REMARK                                                     " & vbNewLine _
                                            & "       ELSE DST.REMARK                                                                               " & vbNewLine _
                                            & "  END                         AS REMARK_DEST                                                         " & vbNewLine _
                                            & " --2012.07.24 丸和運輸　荷受人氏名下の注意書き(REMARK)終了                                           " & vbNewLine _
                                            & " --要望番号1383 [LMC664] --- START ---                                                               " & vbNewLine _
                                            & " ,ISNULL(MCD_CUST.CUST_NAIYO_1,'') AS CUST_FLG                                                       " & vbNewLine _
                                            & " --要望番号1383 [LMC664] --- END ---                                                                 " & vbNewLine _
                                                     & "           --送状番号自動採番用 2016.07.23--- STD ---                                           " & vbNewLine _
                                                 & "           ,FL.AUTO_DENP_KBN           AS AUTO_DENP_KBN                                         " & vbNewLine _
                                                 & "           ,FL.AUTO_DENP_NO            AS AUTO_DENP_NO                                          " & vbNewLine _
                                                 & "           --送状番号自動採番用 2016.07.23--- END ---                                           " & vbNewLine

    '(2013.04.12)要望番号2015 SELECT句をBP送り状用　追加END

#If True Then   'ADD 2018/08/02 依頼番号 : 001572   【LMS】まとめ送状_千葉日医工-出力値変更
    '下記SQL_SELECT_DATAを改修
    Private Const SQL_SELECT_DATA_NICHIIKO As String = "  --SQL_SELECT_DATA_NICHIIKO                                                            " & vbNewLine _
                                        & " SELECT                                                                                              " & vbNewLine _
                                        & " CASE WHEN MR4.PTN_CD IS NOT NULL THEN MR4.RPT_ID   --**ADD                                          " & vbNewLine _
                                        & "      WHEN MR2.PTN_CD IS NOT NULL THEN MR2.RPT_ID                                                    " & vbNewLine _
                                        & "      WHEN MR1.PTN_CD IS NOT NULL THEN MR1.RPT_ID                                                    " & vbNewLine _
                                        & "      ELSE '' END            AS RPT_ID                                                               " & vbNewLine _
                                        & ",OUTL.NRS_BR_CD              AS NRS_BR_CD                                                            " & vbNewLine _
                                        & "--このあたりから要修正の可能性                                                                       " & vbNewLine _
                                        & "--LMC560                                                                                             " & vbNewLine _
                                        & ",OUTL.OUTKA_PLAN_DATE        AS OUTKA_PLAN_DATE                                                      " & vbNewLine _
                                        & ",OUTL.OUTKA_NO_L             AS OUTKA_NO_L                                                           " & vbNewLine _
                                        & ",KB01.KBN_NM4                AS SHITEN_TEL_560_1                                                     " & vbNewLine _
                                        & ",KB01.KBN_NM3                AS SHITEN_NM_560_1                                                      " & vbNewLine _
                                        & ",OUTL.ARR_PLAN_DATE          AS ARR_PLAN_DATE                                                        " & vbNewLine _
                                        & ",KB02.KBN_NM1                AS ARR_PLAN_TIME                                                        " & vbNewLine _
                                        & ",OUTL.DEST_TEL               AS DEST_TEL                                                             " & vbNewLine _
                                        & ",CST.TEL                     AS CUST_TEL                                                             " & vbNewLine _
                                        & ",CST.AD_1                    AS CUST_AD_1                                                            " & vbNewLine _
                                        & ",CST.AD_2                    AS CUST_AD_2                                                            " & vbNewLine _
                                        & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_AD_1                                                   " & vbNewLine _
                                        & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_AD_1                                                   " & vbNewLine _
                                        & "      ELSE DST.AD_1                                                                                  " & vbNewLine _
                                        & " END                         AS DEST_AD_1                                                            " & vbNewLine _
                                        & ",CST.AD_3                    AS CUST_AD_3                                                            " & vbNewLine _
                                        & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_AD_2                                                   " & vbNewLine _
                                        & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_AD_2                                                   " & vbNewLine _
                                        & "      ELSE DST.AD_2                                                                                  " & vbNewLine _
                                        & " END                         AS DEST_AD_2                                                            " & vbNewLine _
                                        & ",OUTL.DEST_AD_3              AS DEST_AD_3                                                            " & vbNewLine _
                                        & ",FL.UNSO_WT                  AS BETU_WT                                                              " & vbNewLine _
                                        & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_NM                                                     " & vbNewLine _
                                        & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_NM                                                     " & vbNewLine _
                                        & "      ELSE DST.DEST_NM                                                                               " & vbNewLine _
                                        & " END                         AS DEST_NM_1                                                            " & vbNewLine _
                                        & ",CST.CUST_NM_L               AS CUST_NM_L                                                            " & vbNewLine _
                                        & "--LMC561                                                                                             " & vbNewLine _
                                        & ",CASE WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_ZIP                                                    " & vbNewLine _
                                        & "      ELSE DST.ZIP                                                                                   " & vbNewLine _
                                        & " END                         AS DEST_ZIP                                                             " & vbNewLine _
                                        & "--LMC562                                                                                             " & vbNewLine _
                                        & "--,(OUTS.BETU_WT * OUTS.ALCTD_NB) AS UNSO_WT                                                         " & vbNewLine _
                                        & ",(SELECT                                                                                             " & vbNewLine _
                                        & "SUM (UNSO_WT.UNSO_WT) FROM                                                                           " & vbNewLine _
                                        & "(SELECT                                                                                              " & vbNewLine _
                                        & "--	SUM(OUTS.BETU_WT * OUTS.ALCTD_NB) AS UNSO_WT                                                        " & vbNewLine _
                                        & "	SUM(OUTS.ALCTD_QT * MG.STD_WT_KGS / MG.STD_IRIME_NB) AS UNSO_WT                                     " & vbNewLine _
                                        & "	FROM                                                                                                " & vbNewLine _
                                        & "	$LM_TRN$..C_OUTKA_L OUTL                                                                            " & vbNewLine _
                                        & "	LEFT JOIN                                                                                           " & vbNewLine _
                                        & "	$LM_TRN$..C_OUTKA_M OUTM                                                                            " & vbNewLine _
                                        & "	  ON OUTL.NRS_BR_CD   = OUTM.NRS_BR_CD                                                              " & vbNewLine _
                                        & "	 AND OUTL.OUTKA_NO_L  = OUTM.OUTKA_NO_L                                                             " & vbNewLine _
                                        & "	 AND OUTM.SYS_DEL_FLG = '0'                                                                         " & vbNewLine _
                                        & "	LEFT JOIN                                                                                           " & vbNewLine _
                                        & "	$LM_TRN$..C_OUTKA_S OUTS                                                                            " & vbNewLine _
                                        & "	  ON OUTL.NRS_BR_CD   = OUTS.NRS_BR_CD                                                              " & vbNewLine _
                                        & "	 AND OUTL.OUTKA_NO_L  = OUTS.OUTKA_NO_L                                                             " & vbNewLine _
                                        & "	 AND OUTM.OUTKA_NO_M  = OUTS.OUTKA_NO_M                                                             " & vbNewLine _
                                        & "	 AND OUTS.SYS_DEL_FLG = '0'                                                                         " & vbNewLine _
                                        & "	LEFT JOIN                                                                                           " & vbNewLine _
                                        & "	$LM_MST$..M_GOODS MG                                                                            " & vbNewLine _
                                        & "	  ON OUTM.NRS_BR_CD   = MG.NRS_BR_CD                                                              " & vbNewLine _
                                        & "	 AND OUTM.GOODS_CD_NRS  = MG.GOODS_CD_NRS                                                             " & vbNewLine _
                                        & "	WHERE                                                                                               " & vbNewLine _
                                        & "	    OUTL.SYS_DEL_FLG  = '0'                                                                         " & vbNewLine _
                                        & "	AND OUTL.NRS_BR_CD    = @NRS_BR_CD                                                                  " & vbNewLine _
                                        & "	--AND OUTL.OUTKA_NO_L   = @OUTKA_NO_L                                                                 " & vbNewLine _
                                        & "   AND OUTL.OUTKA_NO_L IN (@OUTKA_NO_L)            --**UPD                                           " & vbNewLine _
                                        & "	GROUP BY                                                                                            " & vbNewLine _
                                        & "	 OUTS.BETU_WT                                                                                       " & vbNewLine _
                                        & "	,OUTS.ALCTD_NB                                                                                      " & vbNewLine _
                                        & "	,OUTL.NRS_BR_CD                                                                                     " & vbNewLine _
                                        & "	,OUTL.OUTKA_NO_L                                                                                    " & vbNewLine _
                                        & "	)  UNSO_WT                                                                                          " & vbNewLine _
                                        & "	)  UNSO_WT                                                                                          " & vbNewLine _
                                        & "--,FL.UNSO_PKG_NB              AS UNSO_PKG_NB                                                          " & vbNewLine _
                                        & "--** ADD Start                                                　　　　　　　　　　　　　　　　　　   " & vbNewLine _
                                        & ",(SELECT SUM(UNSO_PKG_NB)                                                                            " & vbNewLine _
                                        & "      FROM $LM_TRN$..F_UNSO_L FL                                                                     " & vbNewLine _
                                        & "      WHERE  FL.NRS_BR_CD    = OUTL.NRS_BR_CD                                                        " & vbNewLine _
                                        & "             AND FL.INOUTKA_NO_L IN (@OUTKA_NO_L)                                                    " & vbNewLine _
                                        & "             AND FL.MOTO_DATA_KB = '20'                                                              " & vbNewLine _
                                        & "             AND FL.SYS_DEL_FLG  = '0'                                                               " & vbNewLine _
                                        & " )  AS UNSO_PKG_NB                                                                                   " & vbNewLine _
                                        & "--** ADD End                                                                                         " & vbNewLine _
                                        & ",CST.CUST_NM_M               AS CUST_NM_M                                                            " & vbNewLine _
                                        & "--LMC563                                                                                             " & vbNewLine _
                                        & "--2018/03/07 001033 20180131【LMS】横浜BC帳票住所がYCCになっている対応 Annen upd start               " & vbNewLine _
                                        & ",SOKO.WH_NM                  AS NRS_BR_NM                                                            " & vbNewLine _
                                        & ",EDIL.FREE_C15               AS DEST_HOSOKU                                                          " & vbNewLine _
                                        & ",SOKO.AD_1                   AS NRS_AD_1                                                             " & vbNewLine _
                                        & ",SOKO.AD_2                   AS NRS_AD_2                                                             " & vbNewLine _
                                        & ",SOKO.TEL                    AS NRS_TEL                                                              " & vbNewLine _
                                        & "--,NB.NRS_BR_NM                AS NRS_BR_NM                                                            " & vbNewLine _
                                        & "--,EDIL.FREE_C15               AS DEST_HOSOKU                                                          " & vbNewLine _
                                        & "--,NB.AD_1                     AS NRS_AD_1                                                             " & vbNewLine _
                                        & "--,NB.AD_2                     AS NRS_AD_2                                                             " & vbNewLine _
                                        & "--,NB.TEL                      AS NRS_TEL                                                              " & vbNewLine _
                                        & "--2018/03/07 001033 20180131【LMS】横浜BC帳票住所がYCCになっている対応 Annen upd end                 " & vbNewLine _
                                        & ",CST.CUST_CD_L               AS CUST_CD_L                                                            " & vbNewLine _
                                        & ",FL.REMARK                   AS UNSO_L_REMARK                                                        " & vbNewLine _
                                        & ",OUTL.REMARK                 AS OUTKA_L_REMARK                                                       " & vbNewLine _
                                        & ",MG.GOODS_NM_1               AS GOODS_NM_1                                                           " & vbNewLine _
                                        & ",MG.OUTKA_ATT                AS OUTKA_ATT                                                            " & vbNewLine _
                                        & ",OUTL.BUYER_ORD_NO           AS BUYER_ORD_NO                                                         " & vbNewLine _
                                        & ",CASE WHEN OUTL.NRS_BR_CD = '50' THEN                                                                " & vbNewLine _
                                        & "      (                                                                                              " & vbNewLine _
                                        & "       CASE WHEN OUTL.CUST_CD_L = '20000' THEN MGD.SET_NAIYO                                         " & vbNewLine _
                                        & "             ELSE ''                                                                                 " & vbNewLine _
                                        & "       END                                                                                           " & vbNewLine _
                                        & "      )                                                                                              " & vbNewLine _
                                        & "      ELSE ''                                                                                        " & vbNewLine _
                                        & " END                         AS YELLOW_NO                                                            " & vbNewLine _
                                        & ",KB03.KBN_NM3                AS SHIHARAI_SHITEN_NM_563_1                                             " & vbNewLine _
                                        & ",CASE WHEN OUTL.NRS_BR_CD = '50' THEN                                                                " & vbNewLine _
                                        & "       (                                                                                             " & vbNewLine _
                                        & "         CASE WHEN OUTL.CUST_CD_L = '00007' THEN KB0401.KBN_NM3                                      " & vbNewLine _
                                        & "              WHEN OUTL.CUST_CD_L = '20000' THEN KB0402.KBN_NM3                                      " & vbNewLine _
                                        & "              WHEN OUTL.CUST_CD_L = '00950' THEN                                                     " & vbNewLine _
                                        & "                   (                                                                                 " & vbNewLine _
                                        & "                    CASE WHEN MG.SEARCH_KEY_1 = 'A0020' THEN KB0403.KBN_NM3                          " & vbNewLine _
                                        & "                         WHEN MG.SEARCH_KEY_1 = 'A0021' THEN KB0403.KBN_NM3                          " & vbNewLine _
                                        & "                         ELSE KB0404.KBN_NM3                                                         " & vbNewLine _
                                        & "                    END                                                                              " & vbNewLine _
                                        & "                   )                                                                                 " & vbNewLine _
                                        & "              ELSE KB0405.KBN_NM3                                                                    " & vbNewLine _
                                        & "         END                                                                                         " & vbNewLine _
                                        & "       )                                                                                             " & vbNewLine _
                                        & "      ELSE ''                                                                                        " & vbNewLine _
                                        & "END                          AS SHIHARAI_SHITEN_CD_563_1                                             " & vbNewLine _
                                        & ",KB03.KBN_NM4                AS SHIHARAI_SHITEN_TEL_563_1                                            " & vbNewLine _
                                        & "--LMC564                                                                                             " & vbNewLine _
                                        & ",KB05.KBN_NM4                AS SHITEN_TEL_1_564_1                                                   " & vbNewLine _
                                        & ",KB05.KBN_NM3                AS SHITEN_NM_564_1                                                      " & vbNewLine _
                                        & ",KB05.KBN_NM4                AS SHITEN_TEL_2_564_1                                                   " & vbNewLine _
                                        & "--2018/03/07 001033 20180131【LMS】横浜BC帳票住所がYCCになっている対応 Annen upd start               " & vbNewLine _
                                        & ",SOKO.AD_1                   AS NRS_BR_AD_1                                                          " & vbNewLine _
                                        & ",SOKO.AD_2                   AS NRS_BR_AD_2                                                          " & vbNewLine _
                                        & ",SOKO.WH_NM                  AS NRS_BR_NM_1                                                          " & vbNewLine _
                                        & "--,NB.AD_1                     AS NRS_BR_AD_1                                                          " & vbNewLine _
                                        & "--,NB.AD_2                     AS NRS_BR_AD_2                                                          " & vbNewLine _
                                        & "--,NB.NRS_BR_NM                AS NRS_BR_NM_1                                                          " & vbNewLine _
                                        & "--2018/03/07 001033 20180131【LMS】横浜BC帳票住所がYCCになっている対応 Annen upd end                 " & vbNewLine _
                                        & "--LMC565                                                                                             " & vbNewLine _
                                        & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_NM                                                     " & vbNewLine _
                                        & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_NM                                                     " & vbNewLine _
                                        & "      ELSE DST.DEST_NM                                                                               " & vbNewLine _
                                        & " END                         AS DEST_NM                                                              " & vbNewLine _
                                        & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_AD_1                                                   " & vbNewLine _
                                        & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_AD_1                                                   " & vbNewLine _
                                        & "      ELSE DST.AD_1                                                                                  " & vbNewLine _
                                        & " END                         AS AD_1                                                                 " & vbNewLine _
                                        & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_AD_2                                                   " & vbNewLine _
                                        & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_AD_2                                                   " & vbNewLine _
                                        & "      ELSE DST.AD_2                                                                                  " & vbNewLine _
                                        & " END                         AS AD_2                                                                 " & vbNewLine _
                                        & ",OUTL.DEST_AD_3              AS AD_3                                                                 " & vbNewLine _
                                        & ",OUTL.DEST_TEL               AS TEL                                                                  " & vbNewLine _
                                        & ",OUTL.DEST_CD                AS DEST_CD                                                              " & vbNewLine _
                                        & ",OUTL.SHIP_CD_L              AS SHIP_CD_L                                                            " & vbNewLine _
                                        & ",KB0601.KBN_NM4              AS SHIHARAI_CD_565_1                                                    " & vbNewLine _
                                        & ",KB0602.KBN_NM4              AS SHIHARAI_CD_565_2                                                    " & vbNewLine _
                                        & "--LMC566                                                                                             " & vbNewLine _
                                        & "--2018/03/07 001033 20180131【LMS】横浜BC帳票住所がYCCになっている対応 Annen upd start               " & vbNewLine _
                                        & ",SOKO.FAX                    AS NRS_FAX                                                              " & vbNewLine _
                                        & ",SOKO.AD_3                   AS NRS_AD_3                                                             " & vbNewLine _
                                        & "--,NB.FAX                      AS NRS_FAX                                                              " & vbNewLine _
                                        & "--LMC567                                                                                             " & vbNewLine _
                                        & "--,NB.AD_3                     AS NRS_AD_3                                                             " & vbNewLine _
                                        & "--2018/03/07 001033 20180131【LMS】横浜BC帳票住所がYCCになっている対応 Annen upd end                 " & vbNewLine _
                                        & "--LMC568                                                                                             " & vbNewLine _
                                        & ",OUTL.CUST_ORD_NO            AS CUST_ORD_NO                                                          " & vbNewLine _
                                        & ",MG.SHOBO_CD                 AS SHOBO_CD                                                             " & vbNewLine _
                                        & ",KB0701.KBN_NM5              AS CUST_CD_L_568_1                                                      " & vbNewLine _
                                        & ",KB0702.KBN_NM5              AS CUST_CD_L_568_2                                                      " & vbNewLine _
                                        & "--LMC569                                                                                             " & vbNewLine _
                                        & "--2018/03/07 001033 20180131【LMS】横浜BC帳票住所がYCCになっている対応 Annen upd start               " & vbNewLine _
                                        & ",SOKO.ZIP                    AS NRS_BR_ZIP                                                           " & vbNewLine _
                                        & ",SOKO.TEL                    AS NRS_BR_TEL                                                           " & vbNewLine _
                                        & "--,NB.ZIP                      AS NRS_BR_ZIP                                                           " & vbNewLine _
                                        & "--,NB.TEL                      AS NRS_BR_TEL                                                           " & vbNewLine _
                                        & "--2018/03/07 001033 20180131【LMS】横浜BC帳票住所がYCCになっている対応 Annen upd end                 " & vbNewLine _
                                        & ",KB08.KBN_NM1                AS KOTEI_1                                                              " & vbNewLine _
                                        & ",KB08.KBN_NM3                AS KOTEI_2                                                              " & vbNewLine _
                                        & ",KB08.KBN_NM5                AS KOTEI_3                                                              " & vbNewLine _
                                        & "--LMC570                                                                                             " & vbNewLine _
                                        & ",FL.NB_UT                    AS NB_UT                                                                " & vbNewLine _
                                        & ",CST.DENPYO_NM               AS DENPYO_NM                                                            " & vbNewLine _
                                        & ",KB1001.KBN_NM3              AS SHITEN_NM_570_1                                                      " & vbNewLine _
                                        & ",KB1001.KBN_NM4              AS SHITEN_TEL_570_1                                                     " & vbNewLine _
                                        & ",KB1002.KBN_NM3              AS SHITEN_NM_570_2                                                      " & vbNewLine _
                                        & ",KB1002.KBN_NM4              AS SHITEN_TEL_570_2                                                     " & vbNewLine _
                                        & "--LMC572                                                                                             " & vbNewLine _
                                        & ",OUTL.OUTKA_PKG_NB           AS OUTKA_PKG_NB                                                         " & vbNewLine _
                                        & ",OUTM.IRIME                  AS IRIME                                                                " & vbNewLine _
                                        & ",OUTM.IRIME_UT               AS IRIME_UT                                                             " & vbNewLine _
                                        & ",OUTM.ALCTD_NB               AS ALCTD_NB                                                             " & vbNewLine _
                                        & ",OUTM.LOT_NO                 AS LOT_NO                                                               " & vbNewLine _
                                        & ",SHIPDST.DEST_NM             AS SHIP_NM_L                                                            " & vbNewLine _
                                        & ",CUSTDTL.SET_NAIYO           AS UNSO_CUST_CD                                                         " & vbNewLine _
                                        & ",KB0801.KBN_NM3              AS SHIHARAI_CD_575_1                                                    " & vbNewLine _
                                        & ",KB0802.KBN_NM3              AS SHIHARAI_CD_575_2                                                    " & vbNewLine _
                                        & "--LMC670                                                                                             " & vbNewLine _
                                        & ",KB0803.KBN_NM1              AS KBN_CUST_ZIP                                                         " & vbNewLine _
                                        & ",KB0803.KBN_NM2              AS KBN_CUST_AD                                                          " & vbNewLine _
                                        & ",KB0803.KBN_NM3              AS KBN_CUST_TEL                                                         " & vbNewLine _
                                        & ",KB0803.KBN_NM4              AS KBN_CUST_NM                                                          " & vbNewLine _
                                        & ",OUTL.OUTKO_DATE             AS OUTKO_DATE                                                           " & vbNewLine _
                                        & ",(MG.STD_WT_KGS * OUTM.ALCTD_NB) AS ALCTD_WT                                                         " & vbNewLine _
                                        & "--,OUTKAEDIL.FREE_C05          AS BUKA_CD                                                            " & vbNewLine _
                                        & ",EDIL.FREE_C05          AS BUKA_CD                                                                   " & vbNewLine _
                                        & ",CASE WHEN SHIPDST.DEST_NM <> ''                                                                     " & vbNewLine _
                                        & "           AND SHIPDST.DEST_NM IS NOT NULL THEN SHIPDST.DEST_NM                                      " & vbNewLine _
                                        & "      WHEN CST.DENPYO_NM   <> ''                                                                     " & vbNewLine _
                                        & "           AND CST.DENPYO_NM IS NOT NULL   THEN CST.DENPYO_NM                                        " & vbNewLine _
                                        & "      ELSE CST.CUST_NM_L                                                                             " & vbNewLine _
                                        & " END                         AS ATSUKAISYA_NM                                                        " & vbNewLine _
                                        & " ,MG.GOODS_CD_CUST           AS GOODS_CD_CUST                 --2012.05.25                           " & vbNewLine _
                                        & " ,LEFT(JIS.JIS_CD,2)         AS PREF_CD                       --2012.05.25                           " & vbNewLine _
                                        & ",CASE WHEN LEFT(JIS.JIS_CD,2) ='16' OR                                                               " & vbNewLine _
                                        & "          LEFT(JIS.JIS_CD,2) = '17' OR                                                               " & vbNewLine _
                                        & "          LEFT(JIS.JIS_CD,2) = '18' OR                                                               " & vbNewLine _
                                        & "          LEFT(JIS.JIS_CD,2) = '21' OR                                                               " & vbNewLine _
                                        & "          LEFT(JIS.JIS_CD,2) = '25'                  --ここまで飛騨運輸のエリア                      " & vbNewLine _
                                        & "          THEN '飛騨運輸'                                                                            " & vbNewLine _
                                        & "     WHEN LEFT(JIS.JIS_CD,2) = '24' OR                                                               " & vbNewLine _
                                        & "          LEFT(JIS.JIS_CD,2) = '29' OR                                                               " & vbNewLine _
                                        & "          LEFT(JIS.JIS_CD,2) = '30' OR                                                               " & vbNewLine _
                                        & "          LEFT(JIS.JIS_CD,2) = '47'                  --ここまで近鉄運輸のエリア                      " & vbNewLine _
                                        & "         THEN '近鉄運輸'                                                                             " & vbNewLine _
                                        & "    WHEN  LEFT(JIS.JIS_CD,2) = '26' OR                                                               " & vbNewLine _
                                        & "          LEFT(JIS.JIS_CD,2) = '28' OR                                                               " & vbNewLine _
                                        & "          LEFT(JIS.JIS_CD,2) = '31' OR                                                               " & vbNewLine _
                                        & "          LEFT(JIS.JIS_CD,2) = '32' OR                                                               " & vbNewLine _
                                        & "          LEFT(JIS.JIS_CD,2) = '33' OR                                                               " & vbNewLine _
                                        & "          LEFT(JIS.JIS_CD,2) = '34' OR                                                               " & vbNewLine _
                                        & "       LEFT(JIS.JIS_CD,2) = '35' OR                                                                  " & vbNewLine _
                                        & "          LEFT(JIS.JIS_CD,2) = '36' OR                                                               " & vbNewLine _
                                        & "          LEFT(JIS.JIS_CD,2) = '37' OR                                                               " & vbNewLine _
                                        & "          LEFT(JIS.JIS_CD,2) = '38' OR                                                               " & vbNewLine _
                                        & "          LEFT(JIS.JIS_CD,2) = '39'                                                                  " & vbNewLine _
                                        & "          THEN '岡山県貨物'                                                                          " & vbNewLine _
                                        & "          ELSE    '' END            AS TORI_UNSOCO_NM                                                " & vbNewLine _
                                        & "     --THEN MUC.UNSOCO_NM   END                                                                      " & vbNewLine _
                                        & "    --                              AS TORI_UNSOCO_NM                                                " & vbNewLine _
                                        & " --,MUC.UNSOCO_NM              AS TORI_UNSOCO_NM                --2012.05.25                         " & vbNewLine _
                                        & " ,MCD_SAI.SET_NAIYO          AS SAI_SHIHARAI_CD               --2012.05.25                           " & vbNewLine _
                                        & " ,MCD_SAI.SET_NAIYO_3        AS SET_NM_L                      --2012.05.29                           " & vbNewLine _
                                        & " ,MCD_NFC.SET_NAIYO          AS NAIYO1                        --2012.06.01                           " & vbNewLine _
                                        & " ,MCD_NFC.SET_NAIYO_2        AS NAIYO2                        --2012.06.01                           " & vbNewLine _
                                        & " ,MCD_NFC.SET_NAIYO_3        AS NAIYO3                        --2012.06.01                           " & vbNewLine _
                                        & " ,MCD_SAI.SET_NAIYO_2        AS NAIYO_CUST_NM                 --2012.06.04                           " & vbNewLine _
                                        & " ,OUTM.CUST_ORD_NO_DTL      AS CUST_ORD_NO_DTL              --2012.06.11                             " & vbNewLine _
                                        & " --2012.07.24 丸和運輸　荷受人氏名下の注意書き(REMARK)開始                                           " & vbNewLine _
                                        & " ,CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.REMARK                                                     " & vbNewLine _
                                        & "       WHEN OUTL.DEST_KB = '02' THEN EDIL.REMARK                                                     " & vbNewLine _
                                        & "       ELSE DST.REMARK                                                                               " & vbNewLine _
                                        & "  END                         AS REMARK_DEST                                                         " & vbNewLine _
                                        & " --2012.07.24 丸和運輸　荷受人氏名下の注意書き(REMARK)終了                                           " & vbNewLine _
                                        & " --要望番号1383 [LMC664] --- START ---                                                               " & vbNewLine _
                                        & " ,ISNULL(MCD_CUST.CUST_NAIYO_1,'') AS CUST_FLG                                                       " & vbNewLine _
                                        & " --要望番号1383 [LMC664] --- END ---                                                                 " & vbNewLine _
                                                 & "           --送状番号自動採番用 2016.07.23--- STD ---                                           " & vbNewLine _
                                             & "           ,FL.AUTO_DENP_KBN           AS AUTO_DENP_KBN                                         " & vbNewLine _
                                             & "           ,FL.AUTO_DENP_NO            AS AUTO_DENP_NO                                          " & vbNewLine _
                                             & "           --送状番号自動採番用 2016.07.23--- END ---                                           " & vbNewLine


#End If

    ''' <summary>
    ''' 印刷データ抽出用(☆★作業用コメント:ひとまず修正おわり)
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_SELECT_DATA As String = "  --SQL_SELECT_DATA                                                                                  " & vbNewLine _
                                            & " SELECT                                                                                               " & vbNewLine _
                                            & " CASE WHEN MR2.PTN_CD IS NOT NULL THEN MR2.RPT_ID                                                    " & vbNewLine _
                                            & "      WHEN MR1.PTN_CD IS NOT NULL THEN MR1.RPT_ID                                                    " & vbNewLine _
                                            & "      ELSE '' END            AS RPT_ID                                                               " & vbNewLine _
                                            & ",OUTL.NRS_BR_CD              AS NRS_BR_CD                                                            " & vbNewLine _
                                            & "--このあたりから要修正の可能性                                                                       " & vbNewLine _
                                            & "--LMC560                                                                                             " & vbNewLine _
                                            & ",OUTL.OUTKA_PLAN_DATE        AS OUTKA_PLAN_DATE                                                      " & vbNewLine _
                                            & ",OUTL.OUTKA_NO_L             AS OUTKA_NO_L                                                           " & vbNewLine _
                                            & ",KB01.KBN_NM4                AS SHITEN_TEL_560_1                                                     " & vbNewLine _
                                            & ",KB01.KBN_NM3                AS SHITEN_NM_560_1                                                      " & vbNewLine _
                                            & ",OUTL.ARR_PLAN_DATE          AS ARR_PLAN_DATE                                                        " & vbNewLine _
                                            & ",KB02.KBN_NM1                AS ARR_PLAN_TIME                                                        " & vbNewLine _
                                            & ",OUTL.DEST_TEL               AS DEST_TEL                                                             " & vbNewLine _
                                            & ",CST.TEL                     AS CUST_TEL                                                             " & vbNewLine _
                                            & ",CST.AD_1                    AS CUST_AD_1                                                            " & vbNewLine _
                                            & ",CST.AD_2                    AS CUST_AD_2                                                            " & vbNewLine _
                                            & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_AD_1                                                   " & vbNewLine _
                                            & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_AD_1                                                   " & vbNewLine _
                                            & "      ELSE DST.AD_1                                                                                  " & vbNewLine _
                                            & " END                         AS DEST_AD_1                                                            " & vbNewLine _
                                            & ",CST.AD_3                    AS CUST_AD_3                                                            " & vbNewLine _
                                            & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_AD_2                                                   " & vbNewLine _
                                            & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_AD_2                                                   " & vbNewLine _
                                            & "      ELSE DST.AD_2                                                                                  " & vbNewLine _
                                            & " END                         AS DEST_AD_2                                                            " & vbNewLine _
                                            & ",OUTL.DEST_AD_3              AS DEST_AD_3                                                            " & vbNewLine _
                                            & ",FL.UNSO_WT                  AS BETU_WT                                                              " & vbNewLine _
                                            & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_NM                                                     " & vbNewLine _
                                            & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_NM                                                     " & vbNewLine _
                                            & "      ELSE DST.DEST_NM                                                                               " & vbNewLine _
                                            & " END                         AS DEST_NM_1                                                            " & vbNewLine _
                                            & ",CST.CUST_NM_L               AS CUST_NM_L                                                            " & vbNewLine _
                                            & "--LMC561                                                                                             " & vbNewLine _
                                            & ",CASE WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_ZIP                                                    " & vbNewLine _
                                            & "      ELSE DST.ZIP                                                                                   " & vbNewLine _
                                            & " END                         AS DEST_ZIP                                                             " & vbNewLine _
                                            & "--LMC562                                                                                             " & vbNewLine _
                                            & "--,(OUTS.BETU_WT * OUTS.ALCTD_NB) AS UNSO_WT                                                         " & vbNewLine _
                                            & ",(SELECT                                                                                             " & vbNewLine _
                                            & "SUM (UNSO_WT.UNSO_WT) FROM                                                                           " & vbNewLine _
                                            & "(SELECT                                                                                              " & vbNewLine _
                                            & "--	SUM(OUTS.BETU_WT * OUTS.ALCTD_NB) AS UNSO_WT                                                        " & vbNewLine _
                                            & "	SUM(OUTS.ALCTD_QT * MG.STD_WT_KGS / MG.STD_IRIME_NB) AS UNSO_WT                                     " & vbNewLine _
                                            & "	FROM                                                                                                " & vbNewLine _
                                            & "	$LM_TRN$..C_OUTKA_L OUTL                                                                            " & vbNewLine _
                                            & "	LEFT JOIN                                                                                           " & vbNewLine _
                                            & "	$LM_TRN$..C_OUTKA_M OUTM                                                                            " & vbNewLine _
                                            & "	  ON OUTL.NRS_BR_CD   = OUTM.NRS_BR_CD                                                              " & vbNewLine _
                                            & "	 AND OUTL.OUTKA_NO_L  = OUTM.OUTKA_NO_L                                                             " & vbNewLine _
                                            & "	 AND OUTM.SYS_DEL_FLG = '0'                                                                         " & vbNewLine _
                                            & "	LEFT JOIN                                                                                           " & vbNewLine _
                                            & "	$LM_TRN$..C_OUTKA_S OUTS                                                                            " & vbNewLine _
                                            & "	  ON OUTL.NRS_BR_CD   = OUTS.NRS_BR_CD                                                              " & vbNewLine _
                                            & "	 AND OUTL.OUTKA_NO_L  = OUTS.OUTKA_NO_L                                                             " & vbNewLine _
                                            & "	 AND OUTM.OUTKA_NO_M  = OUTS.OUTKA_NO_M                                                             " & vbNewLine _
                                            & "	 AND OUTS.SYS_DEL_FLG = '0'                                                                         " & vbNewLine _
                                            & "	LEFT JOIN                                                                                           " & vbNewLine _
                                            & "	$LM_MST$..M_GOODS MG                                                                            " & vbNewLine _
                                            & "	  ON OUTM.NRS_BR_CD   = MG.NRS_BR_CD                                                              " & vbNewLine _
                                            & "	 AND OUTM.GOODS_CD_NRS  = MG.GOODS_CD_NRS                                                             " & vbNewLine _
                                            & "	WHERE                                                                                               " & vbNewLine _
                                            & "	    OUTL.SYS_DEL_FLG  = '0'                                                                         " & vbNewLine _
                                            & "	AND OUTL.NRS_BR_CD    = @NRS_BR_CD                                                                  " & vbNewLine _
                                            & "	AND OUTL.OUTKA_NO_L   = @OUTKA_NO_L                                                                 " & vbNewLine _
                                            & "	GROUP BY                                                                                            " & vbNewLine _
                                            & "	 OUTS.BETU_WT                                                                                       " & vbNewLine _
                                            & "	,OUTS.ALCTD_NB                                                                                      " & vbNewLine _
                                            & "	,OUTL.NRS_BR_CD                                                                                     " & vbNewLine _
                                            & "	,OUTL.OUTKA_NO_L                                                                                    " & vbNewLine _
                                            & "	)  UNSO_WT                                                                                          " & vbNewLine _
                                            & "	)  UNSO_WT                                                                                          " & vbNewLine _
                                            & ",FL.UNSO_PKG_NB              AS UNSO_PKG_NB                                                          " & vbNewLine _
                                            & ",CST.CUST_NM_M               AS CUST_NM_M                                                            " & vbNewLine _
                                            & "--LMC563                                                                                             " & vbNewLine _
                                            & "--2018/03/07 001033 20180131【LMS】横浜BC帳票住所がYCCになっている対応 Annen upd start               " & vbNewLine _
                                            & ",SOKO.WH_NM                  AS NRS_BR_NM                                                            " & vbNewLine _
                                            & ",EDIL.FREE_C15               AS DEST_HOSOKU                                                          " & vbNewLine _
                                            & ",SOKO.AD_1                   AS NRS_AD_1                                                             " & vbNewLine _
                                            & ",SOKO.AD_2                   AS NRS_AD_2                                                             " & vbNewLine _
                                            & ",SOKO.TEL                    AS NRS_TEL                                                              " & vbNewLine _
                                            & "--,NB.NRS_BR_NM                AS NRS_BR_NM                                                            " & vbNewLine _
                                            & "--,EDIL.FREE_C15               AS DEST_HOSOKU                                                          " & vbNewLine _
                                            & "--,NB.AD_1                     AS NRS_AD_1                                                             " & vbNewLine _
                                            & "--,NB.AD_2                     AS NRS_AD_2                                                             " & vbNewLine _
                                            & "--,NB.TEL                      AS NRS_TEL                                                              " & vbNewLine _
                                            & "--2018/03/07 001033 20180131【LMS】横浜BC帳票住所がYCCになっている対応 Annen upd end                 " & vbNewLine _
                                            & ",CST.CUST_CD_L               AS CUST_CD_L                                                            " & vbNewLine _
                                            & ",FL.REMARK                   AS UNSO_L_REMARK                                                        " & vbNewLine _
                                            & ",OUTL.REMARK                 AS OUTKA_L_REMARK                                                       " & vbNewLine _
                                            & "--2018/12/13 MOD START 要望管理002461                                                                " & vbNewLine _
                                            & "--,MG.GOODS_NM_1               AS GOODS_NM_1                                                           " & vbNewLine _
                                            & ",CASE WHEN OUTL.NRS_BR_CD = '40' AND OUTL.CUST_CD_L = '00004' AND MCR1.NRS_BR_CD = '40' AND MCR1.UNSOCO_CD = '005' " & vbNewLine _
                                            & "      THEN '香料'                                                                                    " & vbNewLine _
                                            & "      ELSE MG.GOODS_NM_1                                                                             " & vbNewLine _
                                            & " END                         AS GOODS_NM_1                                                           " & vbNewLine _
                                            & "--2018/12/13 MOD END   要望管理002461                                                                " & vbNewLine _
                                            & ",MG.OUTKA_ATT                AS OUTKA_ATT                                                            " & vbNewLine _
                                            & ",OUTL.BUYER_ORD_NO           AS BUYER_ORD_NO                                                         " & vbNewLine _
                                            & ",CASE WHEN OUTL.NRS_BR_CD = '50' THEN                                                                " & vbNewLine _
                                            & "      (                                                                                              " & vbNewLine _
                                            & "       CASE WHEN OUTL.CUST_CD_L = '20000' THEN MGD.SET_NAIYO                                         " & vbNewLine _
                                            & "             ELSE ''                                                                                 " & vbNewLine _
                                            & "       END                                                                                           " & vbNewLine _
                                            & "      )                                                                                              " & vbNewLine _
                                            & "      ELSE ''                                                                                        " & vbNewLine _
                                            & " END                         AS YELLOW_NO                                                            " & vbNewLine _
                                            & ",KB03.KBN_NM3                AS SHIHARAI_SHITEN_NM_563_1                                             " & vbNewLine _
                                            & ",CASE WHEN OUTL.NRS_BR_CD = '50' THEN                                                                " & vbNewLine _
                                            & "       (                                                                                             " & vbNewLine _
                                            & "         CASE WHEN OUTL.CUST_CD_L = '00007' THEN KB0401.KBN_NM3                                      " & vbNewLine _
                                            & "              WHEN OUTL.CUST_CD_L = '20000' THEN KB0402.KBN_NM3                                      " & vbNewLine _
                                            & "              WHEN OUTL.CUST_CD_L = '00950' THEN                                                     " & vbNewLine _
                                            & "                   (                                                                                 " & vbNewLine _
                                            & "                    CASE WHEN MG.SEARCH_KEY_1 = 'A0020' THEN KB0403.KBN_NM3                          " & vbNewLine _
                                            & "                         WHEN MG.SEARCH_KEY_1 = 'A0021' THEN KB0403.KBN_NM3                          " & vbNewLine _
                                            & "                         ELSE KB0404.KBN_NM3                                                         " & vbNewLine _
                                            & "                    END                                                                              " & vbNewLine _
                                            & "                   )                                                                                 " & vbNewLine _
                                            & "              ELSE KB0405.KBN_NM3                                                                    " & vbNewLine _
                                            & "         END                                                                                         " & vbNewLine _
                                            & "       )                                                                                             " & vbNewLine _
                                            & "      ELSE ''                                                                                        " & vbNewLine _
                                            & "END                          AS SHIHARAI_SHITEN_CD_563_1                                             " & vbNewLine _
                                            & ",KB03.KBN_NM4                AS SHIHARAI_SHITEN_TEL_563_1                                            " & vbNewLine _
                                            & "--LMC564                                                                                             " & vbNewLine _
                                            & ",KB05.KBN_NM4                AS SHITEN_TEL_1_564_1                                                   " & vbNewLine _
                                            & ",KB05.KBN_NM3                AS SHITEN_NM_564_1                                                      " & vbNewLine _
                                            & ",KB05.KBN_NM4                AS SHITEN_TEL_2_564_1                                                   " & vbNewLine _
                                            & "--2018/03/07 001033 20180131【LMS】横浜BC帳票住所がYCCになっている対応 Annen upd start               " & vbNewLine _
                                            & ",SOKO.AD_1                   AS NRS_BR_AD_1                                                          " & vbNewLine _
                                            & ",SOKO.AD_2                   AS NRS_BR_AD_2                                                          " & vbNewLine _
                                            & ",SOKO.WH_NM                  AS NRS_BR_NM_1                                                          " & vbNewLine _
                                            & "--,NB.AD_1                     AS NRS_BR_AD_1                                                          " & vbNewLine _
                                            & "--,NB.AD_2                     AS NRS_BR_AD_2                                                          " & vbNewLine _
                                            & "--,NB.NRS_BR_NM                AS NRS_BR_NM_1                                                          " & vbNewLine _
                                            & "--2018/03/07 001033 20180131【LMS】横浜BC帳票住所がYCCになっている対応 Annen upd end                 " & vbNewLine _
                                            & "--LMC565                                                                                             " & vbNewLine _
                                            & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_NM                                                     " & vbNewLine _
                                            & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_NM                                                     " & vbNewLine _
                                            & "      ELSE DST.DEST_NM                                                                               " & vbNewLine _
                                            & " END                         AS DEST_NM                                                              " & vbNewLine _
                                            & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_AD_1                                                   " & vbNewLine _
                                            & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_AD_1                                                   " & vbNewLine _
                                            & "      ELSE DST.AD_1                                                                                  " & vbNewLine _
                                            & " END                         AS AD_1                                                                 " & vbNewLine _
                                            & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_AD_2                                                   " & vbNewLine _
                                            & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_AD_2                                                   " & vbNewLine _
                                            & "      ELSE DST.AD_2                                                                                  " & vbNewLine _
                                            & " END                         AS AD_2                                                                 " & vbNewLine _
                                            & ",OUTL.DEST_AD_3              AS AD_3                                                                 " & vbNewLine _
                                            & ",OUTL.DEST_TEL               AS TEL                                                                  " & vbNewLine _
                                            & ",OUTL.DEST_CD                AS DEST_CD                                                              " & vbNewLine _
                                            & ",OUTL.SHIP_CD_L              AS SHIP_CD_L                                                            " & vbNewLine _
                                            & ",KB0601.KBN_NM4              AS SHIHARAI_CD_565_1                                                    " & vbNewLine _
                                            & ",KB0602.KBN_NM4              AS SHIHARAI_CD_565_2                                                    " & vbNewLine _
                                            & "--LMC566                                                                                             " & vbNewLine _
                                            & "--2018/03/07 001033 20180131【LMS】横浜BC帳票住所がYCCになっている対応 Annen upd start               " & vbNewLine _
                                            & ",SOKO.FAX                    AS NRS_FAX                                                              " & vbNewLine _
                                            & ",SOKO.AD_3                   AS NRS_AD_3                                                             " & vbNewLine _
                                            & "--,NB.FAX                      AS NRS_FAX                                                              " & vbNewLine _
                                            & "--LMC567                                                                                             " & vbNewLine _
                                            & "--,NB.AD_3                     AS NRS_AD_3                                                             " & vbNewLine _
                                            & "--2018/03/07 001033 20180131【LMS】横浜BC帳票住所がYCCになっている対応 Annen upd end                 " & vbNewLine _
                                            & "--LMC568                                                                                             " & vbNewLine _
                                            & ",OUTL.CUST_ORD_NO            AS CUST_ORD_NO                                                          " & vbNewLine _
                                            & ",MG.SHOBO_CD                 AS SHOBO_CD                                                             " & vbNewLine _
                                            & ",KB0701.KBN_NM5              AS CUST_CD_L_568_1                                                      " & vbNewLine _
                                            & ",KB0702.KBN_NM5              AS CUST_CD_L_568_2                                                      " & vbNewLine _
                                            & "--LMC569                                                                                             " & vbNewLine _
                                            & "--2018/03/07 001033 20180131【LMS】横浜BC帳票住所がYCCになっている対応 Annen upd start               " & vbNewLine _
                                            & ",SOKO.ZIP                    AS NRS_BR_ZIP                                                           " & vbNewLine _
                                            & ",SOKO.TEL                    AS NRS_BR_TEL                                                           " & vbNewLine _
                                            & "--,NB.ZIP                      AS NRS_BR_ZIP                                                           " & vbNewLine _
                                            & "--,NB.TEL                      AS NRS_BR_TEL                                                           " & vbNewLine _
                                            & "--2018/03/07 001033 20180131【LMS】横浜BC帳票住所がYCCになっている対応 Annen upd end                 " & vbNewLine _
                                            & ",KB08.KBN_NM1                AS KOTEI_1                                                              " & vbNewLine _
                                            & ",KB08.KBN_NM3                AS KOTEI_2                                                              " & vbNewLine _
                                            & ",KB08.KBN_NM5                AS KOTEI_3                                                              " & vbNewLine _
                                            & "--LMC570                                                                                             " & vbNewLine _
                                            & ",FL.NB_UT                    AS NB_UT                                                                " & vbNewLine _
                                            & ",CST.DENPYO_NM               AS DENPYO_NM                                                            " & vbNewLine _
                                            & ",KB1001.KBN_NM3              AS SHITEN_NM_570_1                                                      " & vbNewLine _
                                            & ",KB1001.KBN_NM4              AS SHITEN_TEL_570_1                                                     " & vbNewLine _
                                            & ",KB1002.KBN_NM3              AS SHITEN_NM_570_2                                                      " & vbNewLine _
                                            & ",KB1002.KBN_NM4              AS SHITEN_TEL_570_2                                                     " & vbNewLine _
                                            & "--LMC572                                                                                             " & vbNewLine _
                                            & ",OUTL.OUTKA_PKG_NB           AS OUTKA_PKG_NB                                                         " & vbNewLine _
                                            & ",OUTM.IRIME                  AS IRIME                                                                " & vbNewLine _
                                            & ",OUTM.IRIME_UT               AS IRIME_UT                                                             " & vbNewLine _
                                            & ",OUTM.ALCTD_NB               AS ALCTD_NB                                                             " & vbNewLine _
                                            & ",OUTM.LOT_NO                 AS LOT_NO                                                               " & vbNewLine _
                                            & ",SHIPDST.DEST_NM             AS SHIP_NM_L                                                            " & vbNewLine _
                                            & ",CUSTDTL.SET_NAIYO           AS UNSO_CUST_CD                                                         " & vbNewLine _
                                            & ",KB0801.KBN_NM3              AS SHIHARAI_CD_575_1                                                    " & vbNewLine _
                                            & ",KB0802.KBN_NM3              AS SHIHARAI_CD_575_2                                                    " & vbNewLine _
                                            & "--LMC670                                                                                             " & vbNewLine _
                                            & ",KB0803.KBN_NM1              AS KBN_CUST_ZIP                                                         " & vbNewLine _
                                            & ",KB0803.KBN_NM2              AS KBN_CUST_AD                                                          " & vbNewLine _
                                            & ",KB0803.KBN_NM3              AS KBN_CUST_TEL                                                         " & vbNewLine _
                                            & ",KB0803.KBN_NM4              AS KBN_CUST_NM                                                          " & vbNewLine _
                                            & ",OUTL.OUTKO_DATE             AS OUTKO_DATE                                                           " & vbNewLine _
                                            & ",(MG.STD_WT_KGS * OUTM.ALCTD_NB) AS ALCTD_WT                                                         " & vbNewLine _
                                            & "--,OUTKAEDIL.FREE_C05          AS BUKA_CD                                                            " & vbNewLine _
                                            & ",EDIL.FREE_C05          AS BUKA_CD                                                                   " & vbNewLine _
                                            & ",CASE WHEN SHIPDST.DEST_NM <> ''                                                                     " & vbNewLine _
                                            & "           AND SHIPDST.DEST_NM IS NOT NULL THEN SHIPDST.DEST_NM                                      " & vbNewLine _
                                            & "      WHEN CST.DENPYO_NM   <> ''                                                                     " & vbNewLine _
                                            & "           AND CST.DENPYO_NM IS NOT NULL   THEN CST.DENPYO_NM                                        " & vbNewLine _
                                            & "      ELSE CST.CUST_NM_L                                                                             " & vbNewLine _
                                            & " END                         AS ATSUKAISYA_NM                                                        " & vbNewLine _
                                            & " ,MG.GOODS_CD_CUST           AS GOODS_CD_CUST                 --2012.05.25                           " & vbNewLine _
                                            & " ,LEFT(JIS.JIS_CD,2)         AS PREF_CD                       --2012.05.25                           " & vbNewLine _
                                            & ",CASE WHEN LEFT(JIS.JIS_CD,2) ='16' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '17' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '18' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '21' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '25'                  --ここまで飛騨運輸のエリア                      " & vbNewLine _
                                            & "          THEN '飛騨運輸'                                                                            " & vbNewLine _
                                            & "     WHEN LEFT(JIS.JIS_CD,2) = '24' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '29' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '30' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '47'                  --ここまで近鉄運輸のエリア                      " & vbNewLine _
                                            & "         THEN '近鉄運輸'                                                                             " & vbNewLine _
                                            & "    WHEN  LEFT(JIS.JIS_CD,2) = '26' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '28' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '31' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '32' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '33' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '34' OR                                                               " & vbNewLine _
                                            & "       LEFT(JIS.JIS_CD,2) = '35' OR                                                                  " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '36' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '37' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '38' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '39'                                                                  " & vbNewLine _
                                            & "          THEN '岡山県貨物'                                                                          " & vbNewLine _
                                            & "          ELSE    '' END            AS TORI_UNSOCO_NM                                                " & vbNewLine _
                                            & "     --THEN MUC.UNSOCO_NM   END                                                                      " & vbNewLine _
                                            & "    --                              AS TORI_UNSOCO_NM                                                " & vbNewLine _
                                            & " --,MUC.UNSOCO_NM              AS TORI_UNSOCO_NM                --2012.05.25                         " & vbNewLine _
                                            & " ,MCD_SAI.SET_NAIYO          AS SAI_SHIHARAI_CD               --2012.05.25                           " & vbNewLine _
                                            & " ,MCD_SAI.SET_NAIYO_3        AS SET_NM_L                      --2012.05.29                           " & vbNewLine _
                                            & " ,MCD_NFC.SET_NAIYO          AS NAIYO1                        --2012.06.01                           " & vbNewLine _
                                            & " ,MCD_NFC.SET_NAIYO_2        AS NAIYO2                        --2012.06.01                           " & vbNewLine _
                                            & " ,MCD_NFC.SET_NAIYO_3        AS NAIYO3                        --2012.06.01                           " & vbNewLine _
                                            & " ,MCD_SAI.SET_NAIYO_2        AS NAIYO_CUST_NM                 --2012.06.04                           " & vbNewLine _
                                            & " ,OUTM.CUST_ORD_NO_DTL      AS CUST_ORD_NO_DTL              --2012.06.11                             " & vbNewLine _
                                            & " --2012.07.24 丸和運輸　荷受人氏名下の注意書き(REMARK)開始                                           " & vbNewLine _
                                            & " ,CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.REMARK                                                     " & vbNewLine _
                                            & "       WHEN OUTL.DEST_KB = '02' THEN EDIL.REMARK                                                     " & vbNewLine _
                                            & "       ELSE DST.REMARK                                                                               " & vbNewLine _
                                            & "  END                         AS REMARK_DEST                                                         " & vbNewLine _
                                            & " --2012.07.24 丸和運輸　荷受人氏名下の注意書き(REMARK)終了                                           " & vbNewLine _
                                            & " --要望番号1383 [LMC664] --- START ---                                                               " & vbNewLine _
                                            & " ,ISNULL(MCD_CUST.CUST_NAIYO_1,'') AS CUST_FLG                                                       " & vbNewLine _
                                            & " --要望番号1383 [LMC664] --- END ---                                                                 " & vbNewLine _
                                                     & "           --送状番号自動採番用 2016.07.23--- STD ---                                           " & vbNewLine _
                                                 & "           ,FL.AUTO_DENP_KBN           AS AUTO_DENP_KBN                                         " & vbNewLine _
                                                 & "           ,FL.AUTO_DENP_NO            AS AUTO_DENP_NO                                          " & vbNewLine _
                                                 & "           --送状番号自動採番用 2016.07.23--- END ---                                           " & vbNewLine


#If True Then      'ADD 2020/01/15 009792【LMS】RD帳票作成_アンファー:送り状・納品書亜種

    ''' <summary>
    ''' 印刷データ抽出用(商品詳細で荷主名・TELを変更する)
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_SELECT_DATA2 As String = "  --SQL_SELECT_DATA                                                                                  " & vbNewLine _
                                            & " SELECT                                                                                               " & vbNewLine _
                                            & " CASE WHEN MR2.PTN_CD IS NOT NULL THEN MR2.RPT_ID                                                    " & vbNewLine _
                                            & "      WHEN MR1.PTN_CD IS NOT NULL THEN MR1.RPT_ID                                                    " & vbNewLine _
                                            & "      ELSE '' END            AS RPT_ID                                                               " & vbNewLine _
                                            & ",OUTL.NRS_BR_CD              AS NRS_BR_CD                                                            " & vbNewLine _
                                            & "--このあたりから要修正の可能性                                                                       " & vbNewLine _
                                            & "--LMC560                                                                                             " & vbNewLine _
                                            & ",OUTL.OUTKA_PLAN_DATE        AS OUTKA_PLAN_DATE                                                      " & vbNewLine _
                                            & ",OUTL.OUTKA_NO_L             AS OUTKA_NO_L                                                           " & vbNewLine _
                                            & ",KB01.KBN_NM4                AS SHITEN_TEL_560_1                                                     " & vbNewLine _
                                            & ",KB01.KBN_NM3                AS SHITEN_NM_560_1                                                      " & vbNewLine _
                                            & ",OUTL.ARR_PLAN_DATE          AS ARR_PLAN_DATE                                                        " & vbNewLine _
                                            & ",KB02.KBN_NM1                AS ARR_PLAN_TIME                                                        " & vbNewLine _
                                            & ",OUTL.DEST_TEL               AS DEST_TEL                                                             " & vbNewLine _
                                            & "--UPD 2020/01/15 009792,CST.TEL                     AS CUST_TEL                                                             " & vbNewLine _
                                            & ",CASE WHEN MGD2.GOODS_CD_NRS IS NULL                                                                 " & vbNewLine _
                                            & "        THEN CST.TEL                                                                                 " & vbNewLine _
                                            & " 	   ELSE MGD2.REMARK                                                                             " & vbNewLine _
                                            & " END AS           CUST_TEL                                                                           " & vbNewLine _
                                            & ",CST.AD_1                    AS CUST_AD_1                                                            " & vbNewLine _
                                            & ",CST.AD_2                    AS CUST_AD_2                                                            " & vbNewLine _
                                            & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_AD_1                                                   " & vbNewLine _
                                            & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_AD_1                                                   " & vbNewLine _
                                            & "      ELSE DST.AD_1                                                                                  " & vbNewLine _
                                            & " END                         AS DEST_AD_1                                                            " & vbNewLine _
                                            & ",CST.AD_3                    AS CUST_AD_3                                                            " & vbNewLine _
                                            & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_AD_2                                                   " & vbNewLine _
                                            & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_AD_2                                                   " & vbNewLine _
                                            & "      ELSE DST.AD_2                                                                                  " & vbNewLine _
                                            & " END                         AS DEST_AD_2                                                            " & vbNewLine _
                                            & ",OUTL.DEST_AD_3              AS DEST_AD_3                                                            " & vbNewLine _
                                            & ",FL.UNSO_WT                  AS BETU_WT                                                              " & vbNewLine _
                                            & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_NM                                                     " & vbNewLine _
                                            & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_NM                                                     " & vbNewLine _
                                            & "      ELSE DST.DEST_NM                                                                               " & vbNewLine _
                                            & " END                         AS DEST_NM_1                                                            " & vbNewLine _
                                            & "--UPD 2020/01/15 009792,CST.CUST_NM_L               AS CUST_NM_L                                                            " & vbNewLine _
                                            & ",CASE WHEN MGD2.GOODS_CD_NRS IS NULL                                                                 " & vbNewLine _
                                            & "        THEN CST.CUST_NM_L                                                                           " & vbNewLine _
                                            & "	   ELSE MGD2.SET_NAIYO                                                                              " & vbNewLine _
                                            & " END AS           CUST_NM_L                                                                          " & vbNewLine _
                                            & "--LMC561                                                                                             " & vbNewLine _
                                            & ",CASE WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_ZIP                                                    " & vbNewLine _
                                            & "      ELSE DST.ZIP                                                                                   " & vbNewLine _
                                            & " END                         AS DEST_ZIP                                                             " & vbNewLine _
                                            & "--LMC562                                                                                             " & vbNewLine _
                                            & "--,(OUTS.BETU_WT * OUTS.ALCTD_NB) AS UNSO_WT                                                         " & vbNewLine _
                                            & ",(SELECT                                                                                             " & vbNewLine _
                                            & "SUM (UNSO_WT.UNSO_WT) FROM                                                                           " & vbNewLine _
                                            & "(SELECT                                                                                              " & vbNewLine _
                                            & "--	SUM(OUTS.BETU_WT * OUTS.ALCTD_NB) AS UNSO_WT                                                        " & vbNewLine _
                                            & "	SUM(OUTS.ALCTD_QT * MG.STD_WT_KGS / MG.STD_IRIME_NB) AS UNSO_WT                                     " & vbNewLine _
                                            & "	FROM                                                                                                " & vbNewLine _
                                            & "	$LM_TRN$..C_OUTKA_L OUTL                                                                            " & vbNewLine _
                                            & "	LEFT JOIN                                                                                           " & vbNewLine _
                                            & "	$LM_TRN$..C_OUTKA_M OUTM                                                                            " & vbNewLine _
                                            & "	  ON OUTL.NRS_BR_CD   = OUTM.NRS_BR_CD                                                              " & vbNewLine _
                                            & "	 AND OUTL.OUTKA_NO_L  = OUTM.OUTKA_NO_L                                                             " & vbNewLine _
                                            & "	 AND OUTM.SYS_DEL_FLG = '0'                                                                         " & vbNewLine _
                                            & "	LEFT JOIN                                                                                           " & vbNewLine _
                                            & "	$LM_TRN$..C_OUTKA_S OUTS                                                                            " & vbNewLine _
                                            & "	  ON OUTL.NRS_BR_CD   = OUTS.NRS_BR_CD                                                              " & vbNewLine _
                                            & "	 AND OUTL.OUTKA_NO_L  = OUTS.OUTKA_NO_L                                                             " & vbNewLine _
                                            & "	 AND OUTM.OUTKA_NO_M  = OUTS.OUTKA_NO_M                                                             " & vbNewLine _
                                            & "	 AND OUTS.SYS_DEL_FLG = '0'                                                                         " & vbNewLine _
                                            & "	LEFT JOIN                                                                                           " & vbNewLine _
                                            & "	$LM_MST$..M_GOODS MG                                                                            " & vbNewLine _
                                            & "	  ON OUTM.NRS_BR_CD   = MG.NRS_BR_CD                                                              " & vbNewLine _
                                            & "	 AND OUTM.GOODS_CD_NRS  = MG.GOODS_CD_NRS                                                             " & vbNewLine _
                                            & "	WHERE                                                                                               " & vbNewLine _
                                            & "	    OUTL.SYS_DEL_FLG  = '0'                                                                         " & vbNewLine _
                                            & "	AND OUTL.NRS_BR_CD    = @NRS_BR_CD                                                                  " & vbNewLine _
                                            & "	AND OUTL.OUTKA_NO_L   = @OUTKA_NO_L                                                                 " & vbNewLine _
                                            & "	GROUP BY                                                                                            " & vbNewLine _
                                            & "	 OUTS.BETU_WT                                                                                       " & vbNewLine _
                                            & "	,OUTS.ALCTD_NB                                                                                      " & vbNewLine _
                                            & "	,OUTL.NRS_BR_CD                                                                                     " & vbNewLine _
                                            & "	,OUTL.OUTKA_NO_L                                                                                    " & vbNewLine _
                                            & "	)  UNSO_WT                                                                                          " & vbNewLine _
                                            & "	)  UNSO_WT                                                                                          " & vbNewLine _
                                            & ",FL.UNSO_PKG_NB              AS UNSO_PKG_NB                                                          " & vbNewLine _
                                            & ",CST.CUST_NM_M               AS CUST_NM_M                                                            " & vbNewLine _
                                            & "--LMC563                                                                                             " & vbNewLine _
                                            & "--2018/03/07 001033 20180131【LMS】横浜BC帳票住所がYCCになっている対応 Annen upd start               " & vbNewLine _
                                            & ",SOKO.WH_NM                  AS NRS_BR_NM                                                            " & vbNewLine _
                                            & ",EDIL.FREE_C15               AS DEST_HOSOKU                                                          " & vbNewLine _
                                            & ",SOKO.AD_1                   AS NRS_AD_1                                                             " & vbNewLine _
                                            & ",SOKO.AD_2                   AS NRS_AD_2                                                             " & vbNewLine _
                                            & ",SOKO.TEL                    AS NRS_TEL                                                              " & vbNewLine _
                                            & "--,NB.NRS_BR_NM                AS NRS_BR_NM                                                            " & vbNewLine _
                                            & "--,EDIL.FREE_C15               AS DEST_HOSOKU                                                          " & vbNewLine _
                                            & "--,NB.AD_1                     AS NRS_AD_1                                                             " & vbNewLine _
                                            & "--,NB.AD_2                     AS NRS_AD_2                                                             " & vbNewLine _
                                            & "--,NB.TEL                      AS NRS_TEL                                                              " & vbNewLine _
                                            & "--2018/03/07 001033 20180131【LMS】横浜BC帳票住所がYCCになっている対応 Annen upd end                 " & vbNewLine _
                                            & ",CST.CUST_CD_L               AS CUST_CD_L                                                            " & vbNewLine _
                                            & ",FL.REMARK                   AS UNSO_L_REMARK                                                        " & vbNewLine _
                                            & ",OUTL.REMARK                 AS OUTKA_L_REMARK                                                       " & vbNewLine _
                                            & "--2018/12/13 MOD START 要望管理002461                                                                " & vbNewLine _
                                            & "--,MG.GOODS_NM_1               AS GOODS_NM_1                                                           " & vbNewLine _
                                            & ",CASE WHEN OUTL.NRS_BR_CD = '40' AND OUTL.CUST_CD_L = '00004' AND MCR1.NRS_BR_CD = '40' AND MCR1.UNSOCO_CD = '005' " & vbNewLine _
                                            & "      THEN '香料'                                                                                    " & vbNewLine _
                                            & "      ELSE MG.GOODS_NM_1                                                                             " & vbNewLine _
                                            & " END                         AS GOODS_NM_1                                                           " & vbNewLine _
                                            & "--2018/12/13 MOD END   要望管理002461                                                                " & vbNewLine _
                                            & ",MG.OUTKA_ATT                AS OUTKA_ATT                                                            " & vbNewLine _
                                            & ",OUTL.BUYER_ORD_NO           AS BUYER_ORD_NO                                                         " & vbNewLine _
                                            & ",CASE WHEN OUTL.NRS_BR_CD = '50' THEN                                                                " & vbNewLine _
                                            & "      (                                                                                              " & vbNewLine _
                                            & "       CASE WHEN OUTL.CUST_CD_L = '20000' THEN MGD.SET_NAIYO                                         " & vbNewLine _
                                            & "             ELSE ''                                                                                 " & vbNewLine _
                                            & "       END                                                                                           " & vbNewLine _
                                            & "      )                                                                                              " & vbNewLine _
                                            & "      ELSE ''                                                                                        " & vbNewLine _
                                            & " END                         AS YELLOW_NO                                                            " & vbNewLine _
                                            & ",KB03.KBN_NM3                AS SHIHARAI_SHITEN_NM_563_1                                             " & vbNewLine _
                                            & ",CASE WHEN OUTL.NRS_BR_CD = '50' THEN                                                                " & vbNewLine _
                                            & "       (                                                                                             " & vbNewLine _
                                            & "         CASE WHEN OUTL.CUST_CD_L = '00007' THEN KB0401.KBN_NM3                                      " & vbNewLine _
                                            & "              WHEN OUTL.CUST_CD_L = '20000' THEN KB0402.KBN_NM3                                      " & vbNewLine _
                                            & "              WHEN OUTL.CUST_CD_L = '00950' THEN                                                     " & vbNewLine _
                                            & "                   (                                                                                 " & vbNewLine _
                                            & "                    CASE WHEN MG.SEARCH_KEY_1 = 'A0020' THEN KB0403.KBN_NM3                          " & vbNewLine _
                                            & "                         WHEN MG.SEARCH_KEY_1 = 'A0021' THEN KB0403.KBN_NM3                          " & vbNewLine _
                                            & "                         ELSE KB0404.KBN_NM3                                                         " & vbNewLine _
                                            & "                    END                                                                              " & vbNewLine _
                                            & "                   )                                                                                 " & vbNewLine _
                                            & "              ELSE KB0405.KBN_NM3                                                                    " & vbNewLine _
                                            & "         END                                                                                         " & vbNewLine _
                                            & "       )                                                                                             " & vbNewLine _
                                            & "      ELSE ''                                                                                        " & vbNewLine _
                                            & "END                          AS SHIHARAI_SHITEN_CD_563_1                                             " & vbNewLine _
                                            & ",KB03.KBN_NM4                AS SHIHARAI_SHITEN_TEL_563_1                                            " & vbNewLine _
                                            & "--LMC564                                                                                             " & vbNewLine _
                                            & ",KB05.KBN_NM4                AS SHITEN_TEL_1_564_1                                                   " & vbNewLine _
                                            & ",KB05.KBN_NM3                AS SHITEN_NM_564_1                                                      " & vbNewLine _
                                            & ",KB05.KBN_NM4                AS SHITEN_TEL_2_564_1                                                   " & vbNewLine _
                                            & "--2018/03/07 001033 20180131【LMS】横浜BC帳票住所がYCCになっている対応 Annen upd start               " & vbNewLine _
                                            & ",SOKO.AD_1                   AS NRS_BR_AD_1                                                          " & vbNewLine _
                                            & ",SOKO.AD_2                   AS NRS_BR_AD_2                                                          " & vbNewLine _
                                            & ",SOKO.WH_NM                  AS NRS_BR_NM_1                                                          " & vbNewLine _
                                            & "--,NB.AD_1                     AS NRS_BR_AD_1                                                          " & vbNewLine _
                                            & "--,NB.AD_2                     AS NRS_BR_AD_2                                                          " & vbNewLine _
                                            & "--,NB.NRS_BR_NM                AS NRS_BR_NM_1                                                          " & vbNewLine _
                                            & "--2018/03/07 001033 20180131【LMS】横浜BC帳票住所がYCCになっている対応 Annen upd end                 " & vbNewLine _
                                            & "--LMC565                                                                                             " & vbNewLine _
                                            & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_NM                                                     " & vbNewLine _
                                            & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_NM                                                     " & vbNewLine _
                                            & "      ELSE DST.DEST_NM                                                                               " & vbNewLine _
                                            & " END                         AS DEST_NM                                                              " & vbNewLine _
                                            & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_AD_1                                                   " & vbNewLine _
                                            & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_AD_1                                                   " & vbNewLine _
                                            & "      ELSE DST.AD_1                                                                                  " & vbNewLine _
                                            & " END                         AS AD_1                                                                 " & vbNewLine _
                                            & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_AD_2                                                   " & vbNewLine _
                                            & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_AD_2                                                   " & vbNewLine _
                                            & "      ELSE DST.AD_2                                                                                  " & vbNewLine _
                                            & " END                         AS AD_2                                                                 " & vbNewLine _
                                            & ",OUTL.DEST_AD_3              AS AD_3                                                                 " & vbNewLine _
                                            & ",OUTL.DEST_TEL               AS TEL                                                                  " & vbNewLine _
                                            & ",OUTL.DEST_CD                AS DEST_CD                                                              " & vbNewLine _
                                            & ",OUTL.SHIP_CD_L              AS SHIP_CD_L                                                            " & vbNewLine _
                                            & ",KB0601.KBN_NM4              AS SHIHARAI_CD_565_1                                                    " & vbNewLine _
                                            & ",KB0602.KBN_NM4              AS SHIHARAI_CD_565_2                                                    " & vbNewLine _
                                            & "--LMC566                                                                                             " & vbNewLine _
                                            & "--2018/03/07 001033 20180131【LMS】横浜BC帳票住所がYCCになっている対応 Annen upd start               " & vbNewLine _
                                            & ",SOKO.FAX                    AS NRS_FAX                                                              " & vbNewLine _
                                            & ",SOKO.AD_3                   AS NRS_AD_3                                                             " & vbNewLine _
                                            & "--,NB.FAX                      AS NRS_FAX                                                              " & vbNewLine _
                                            & "--LMC567                                                                                             " & vbNewLine _
                                            & "--,NB.AD_3                     AS NRS_AD_3                                                             " & vbNewLine _
                                            & "--2018/03/07 001033 20180131【LMS】横浜BC帳票住所がYCCになっている対応 Annen upd end                 " & vbNewLine _
                                            & "--LMC568                                                                                             " & vbNewLine _
                                            & ",OUTL.CUST_ORD_NO            AS CUST_ORD_NO                                                          " & vbNewLine _
                                            & ",MG.SHOBO_CD                 AS SHOBO_CD                                                             " & vbNewLine _
                                            & ",KB0701.KBN_NM5              AS CUST_CD_L_568_1                                                      " & vbNewLine _
                                            & ",KB0702.KBN_NM5              AS CUST_CD_L_568_2                                                      " & vbNewLine _
                                            & "--LMC569                                                                                             " & vbNewLine _
                                            & "--2018/03/07 001033 20180131【LMS】横浜BC帳票住所がYCCになっている対応 Annen upd start               " & vbNewLine _
                                            & ",SOKO.ZIP                    AS NRS_BR_ZIP                                                           " & vbNewLine _
                                            & ",SOKO.TEL                    AS NRS_BR_TEL                                                           " & vbNewLine _
                                            & "--,NB.ZIP                      AS NRS_BR_ZIP                                                           " & vbNewLine _
                                            & "--,NB.TEL                      AS NRS_BR_TEL                                                           " & vbNewLine _
                                            & "--2018/03/07 001033 20180131【LMS】横浜BC帳票住所がYCCになっている対応 Annen upd end                 " & vbNewLine _
                                            & ",KB08.KBN_NM1                AS KOTEI_1                                                              " & vbNewLine _
                                            & ",KB08.KBN_NM3                AS KOTEI_2                                                              " & vbNewLine _
                                            & ",KB08.KBN_NM5                AS KOTEI_3                                                              " & vbNewLine _
                                            & "--LMC570                                                                                             " & vbNewLine _
                                            & ",FL.NB_UT                    AS NB_UT                                                                " & vbNewLine _
                                            & ",CST.DENPYO_NM               AS DENPYO_NM                                                            " & vbNewLine _
                                            & ",KB1001.KBN_NM3              AS SHITEN_NM_570_1                                                      " & vbNewLine _
                                            & ",KB1001.KBN_NM4              AS SHITEN_TEL_570_1                                                     " & vbNewLine _
                                            & ",KB1002.KBN_NM3              AS SHITEN_NM_570_2                                                      " & vbNewLine _
                                            & ",KB1002.KBN_NM4              AS SHITEN_TEL_570_2                                                     " & vbNewLine _
                                            & "--LMC572                                                                                             " & vbNewLine _
                                            & ",OUTL.OUTKA_PKG_NB           AS OUTKA_PKG_NB                                                         " & vbNewLine _
                                            & ",OUTM.IRIME                  AS IRIME                                                                " & vbNewLine _
                                            & ",OUTM.IRIME_UT               AS IRIME_UT                                                             " & vbNewLine _
                                            & ",OUTM.ALCTD_NB               AS ALCTD_NB                                                             " & vbNewLine _
                                            & ",OUTM.LOT_NO                 AS LOT_NO                                                               " & vbNewLine _
                                            & ",SHIPDST.DEST_NM             AS SHIP_NM_L                                                            " & vbNewLine _
                                            & ",CUSTDTL.SET_NAIYO           AS UNSO_CUST_CD                                                         " & vbNewLine _
                                            & ",KB0801.KBN_NM3              AS SHIHARAI_CD_575_1                                                    " & vbNewLine _
                                            & ",KB0802.KBN_NM3              AS SHIHARAI_CD_575_2                                                    " & vbNewLine _
                                            & "--LMC670                                                                                             " & vbNewLine _
                                            & ",KB0803.KBN_NM1              AS KBN_CUST_ZIP                                                         " & vbNewLine _
                                            & ",KB0803.KBN_NM2              AS KBN_CUST_AD                                                          " & vbNewLine _
                                            & ",KB0803.KBN_NM3              AS KBN_CUST_TEL                                                         " & vbNewLine _
                                            & ",KB0803.KBN_NM4              AS KBN_CUST_NM                                                          " & vbNewLine _
                                            & ",OUTL.OUTKO_DATE             AS OUTKO_DATE                                                           " & vbNewLine _
                                            & ",(MG.STD_WT_KGS * OUTM.ALCTD_NB) AS ALCTD_WT                                                         " & vbNewLine _
                                            & "--,OUTKAEDIL.FREE_C05          AS BUKA_CD                                                            " & vbNewLine _
                                            & ",EDIL.FREE_C05          AS BUKA_CD                                                                   " & vbNewLine _
                                            & ",CASE WHEN SHIPDST.DEST_NM <> ''                                                                     " & vbNewLine _
                                            & "           AND SHIPDST.DEST_NM IS NOT NULL THEN SHIPDST.DEST_NM                                      " & vbNewLine _
                                            & "      WHEN CST.DENPYO_NM   <> ''                                                                     " & vbNewLine _
                                            & "           AND CST.DENPYO_NM IS NOT NULL   THEN CST.DENPYO_NM                                        " & vbNewLine _
                                            & "      WHEN MGD2.SET_NAIYO <> ''                                                                      " & vbNewLine _
                                            & "           AND MGD2.SET_NAIYO IS NOT NULL  THEN MGD2.SET_NAIYO                                       " & vbNewLine _
                                            & "      ELSE CST.CUST_NM_L                                                                             " & vbNewLine _
                                            & " END                         AS ATSUKAISYA_NM                                                        " & vbNewLine _
                                            & " ,MG.GOODS_CD_CUST           AS GOODS_CD_CUST                 --2012.05.25                           " & vbNewLine _
                                            & " ,LEFT(JIS.JIS_CD,2)         AS PREF_CD                       --2012.05.25                           " & vbNewLine _
                                            & ",CASE WHEN LEFT(JIS.JIS_CD,2) ='16' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '17' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '18' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '21' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '25'                  --ここまで飛騨運輸のエリア                      " & vbNewLine _
                                            & "          THEN '飛騨運輸'                                                                            " & vbNewLine _
                                            & "     WHEN LEFT(JIS.JIS_CD,2) = '24' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '29' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '30' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '47'                  --ここまで近鉄運輸のエリア                      " & vbNewLine _
                                            & "         THEN '近鉄運輸'                                                                             " & vbNewLine _
                                            & "    WHEN  LEFT(JIS.JIS_CD,2) = '26' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '28' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '31' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '32' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '33' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '34' OR                                                               " & vbNewLine _
                                            & "       LEFT(JIS.JIS_CD,2) = '35' OR                                                                  " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '36' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '37' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '38' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '39'                                                                  " & vbNewLine _
                                            & "          THEN '岡山県貨物'                                                                          " & vbNewLine _
                                            & "          ELSE    '' END            AS TORI_UNSOCO_NM                                                " & vbNewLine _
                                            & "     --THEN MUC.UNSOCO_NM   END                                                                      " & vbNewLine _
                                            & "    --                              AS TORI_UNSOCO_NM                                                " & vbNewLine _
                                            & " --,MUC.UNSOCO_NM              AS TORI_UNSOCO_NM                --2012.05.25                         " & vbNewLine _
                                            & " ,MCD_SAI.SET_NAIYO          AS SAI_SHIHARAI_CD               --2012.05.25                           " & vbNewLine _
                                            & " ,MCD_SAI.SET_NAIYO_3        AS SET_NM_L                      --2012.05.29                           " & vbNewLine _
                                            & " ,MCD_NFC.SET_NAIYO          AS NAIYO1                        --2012.06.01                           " & vbNewLine _
                                            & " ,MCD_NFC.SET_NAIYO_2        AS NAIYO2                        --2012.06.01                           " & vbNewLine _
                                            & " ,MCD_NFC.SET_NAIYO_3        AS NAIYO3                        --2012.06.01                           " & vbNewLine _
                                            & " ,MCD_SAI.SET_NAIYO_2        AS NAIYO_CUST_NM                 --2012.06.04                           " & vbNewLine _
                                            & " ,OUTM.CUST_ORD_NO_DTL      AS CUST_ORD_NO_DTL              --2012.06.11                             " & vbNewLine _
                                            & " --2012.07.24 丸和運輸　荷受人氏名下の注意書き(REMARK)開始                                           " & vbNewLine _
                                            & " ,CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.REMARK                                                     " & vbNewLine _
                                            & "       WHEN OUTL.DEST_KB = '02' THEN EDIL.REMARK                                                     " & vbNewLine _
                                            & "       ELSE DST.REMARK                                                                               " & vbNewLine _
                                            & "  END                         AS REMARK_DEST                                                         " & vbNewLine _
                                            & " --2012.07.24 丸和運輸　荷受人氏名下の注意書き(REMARK)終了                                           " & vbNewLine _
                                            & " --要望番号1383 [LMC664] --- START ---                                                               " & vbNewLine _
                                            & " ,ISNULL(MCD_CUST.CUST_NAIYO_1,'') AS CUST_FLG                                                       " & vbNewLine _
                                            & " --要望番号1383 [LMC664] --- END ---                                                                 " & vbNewLine _
                                                     & "           --送状番号自動採番用 2016.07.23--- STD ---                                           " & vbNewLine _
                                                 & "           ,FL.AUTO_DENP_KBN           AS AUTO_DENP_KBN                                         " & vbNewLine _
                                                 & "           ,FL.AUTO_DENP_NO            AS AUTO_DENP_NO                                          " & vbNewLine _
                                                 & "           --送状番号自動採番用 2016.07.23--- END ---                                           " & vbNewLine


#End If
    ''' <summary>
    ''' 送り状印刷データ抽出
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_SELECT_INVOICE_DATA As String = "  --SQL_SELECT_DATA                                                                                  " & vbNewLine _
                                            & " SELECT                                                                                               " & vbNewLine _
                                            & " CASE WHEN MR2.PTN_CD IS NOT NULL THEN MR2.RPT_ID                                                    " & vbNewLine _
                                            & "      WHEN MR1.PTN_CD IS NOT NULL THEN MR1.RPT_ID                                                    " & vbNewLine _
                                            & "      ELSE '' END            AS RPT_ID                                                               " & vbNewLine _
                                            & ",OUTL.NRS_BR_CD              AS NRS_BR_CD                                                            " & vbNewLine _
                                            & "--このあたりから要修正の可能性                                                                       " & vbNewLine _
                                            & "--LMC560                                                                                             " & vbNewLine _
                                            & ",OUTL.OUTKA_PLAN_DATE        AS OUTKA_PLAN_DATE                                                      " & vbNewLine _
                                            & ",OUTL.OUTKA_NO_L             AS OUTKA_NO_L                                                           " & vbNewLine _
                                            & ",KB01.KBN_NM4                AS SHITEN_TEL_560_1                                                     " & vbNewLine _
                                            & ",KB01.KBN_NM3                AS SHITEN_NM_560_1                                                      " & vbNewLine _
                                            & ",OUTL.ARR_PLAN_DATE          AS ARR_PLAN_DATE                                                        " & vbNewLine _
                                            & ",KB02.KBN_NM1                AS ARR_PLAN_TIME                                                        " & vbNewLine _
                                            & ",OUTL.DEST_TEL               AS DEST_TEL                                                             " & vbNewLine _
                                            & ",CST.TEL                     AS CUST_TEL                                                             " & vbNewLine _
                                            & ",CST.AD_1                    AS CUST_AD_1                                                            " & vbNewLine _
                                            & ",CST.AD_2                    AS CUST_AD_2                                                            " & vbNewLine _
                                            & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_AD_1                                                   " & vbNewLine _
                                            & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_AD_1                                                   " & vbNewLine _
                                            & "      ELSE DST.AD_1                                                                                  " & vbNewLine _
                                            & " END                         AS DEST_AD_1                                                            " & vbNewLine _
                                            & ",CST.AD_3                    AS CUST_AD_3                                                            " & vbNewLine _
                                            & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_AD_2                                                   " & vbNewLine _
                                            & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_AD_2                                                   " & vbNewLine _
                                            & "      ELSE DST.AD_2                                                                                  " & vbNewLine _
                                            & " END                         AS DEST_AD_2                                                            " & vbNewLine _
                                            & ",OUTL.DEST_AD_3              AS DEST_AD_3                                                            " & vbNewLine _
                                            & ",FL.UNSO_WT                  AS BETU_WT                                                              " & vbNewLine _
                                            & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_NM                                                     " & vbNewLine _
                                            & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_NM                                                     " & vbNewLine _
                                            & "      ELSE DST.DEST_NM                                                                               " & vbNewLine _
                                            & " END                         AS DEST_NM_1                                                            " & vbNewLine _
                                            & ",CST.CUST_NM_L               AS CUST_NM_L                                                            " & vbNewLine _
                                            & "--LMC561                                                                                             " & vbNewLine _
                                            & ",CASE WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_ZIP                                                    " & vbNewLine _
                                            & "      ELSE DST.ZIP                                                                                   " & vbNewLine _
                                            & " END                         AS DEST_ZIP                                                             " & vbNewLine _
                                            & "--LMC562                                                                                             " & vbNewLine _
                                            & "--,(OUTS.BETU_WT * OUTS.ALCTD_NB) AS UNSO_WT                                                         " & vbNewLine _
                                            & ",(SELECT                                                                                             " & vbNewLine _
                                            & "SUM (UNSO_WT.UNSO_WT) FROM                                                                           " & vbNewLine _
                                            & "(SELECT                                                                                              " & vbNewLine _
                                            & "--	SUM(OUTS.BETU_WT * OUTS.ALCTD_NB) AS UNSO_WT                                                        " & vbNewLine _
                                            & "	SUM(OUTS.ALCTD_QT * MG.STD_WT_KGS / MG.STD_IRIME_NB) AS UNSO_WT                                     " & vbNewLine _
                                            & "	FROM                                                                                                " & vbNewLine _
                                            & "	$LM_TRN$..C_OUTKA_L OUTL                                                                            " & vbNewLine _
                                            & "	LEFT JOIN                                                                                           " & vbNewLine _
                                            & "	$LM_TRN$..C_OUTKA_M OUTM                                                                            " & vbNewLine _
                                            & "	  ON OUTL.NRS_BR_CD   = OUTM.NRS_BR_CD                                                              " & vbNewLine _
                                            & "	 AND OUTL.OUTKA_NO_L  = OUTM.OUTKA_NO_L                                                             " & vbNewLine _
                                            & "	 AND OUTM.SYS_DEL_FLG = '0'                                                                         " & vbNewLine _
                                            & "	LEFT JOIN                                                                                           " & vbNewLine _
                                            & "	$LM_TRN$..C_OUTKA_S OUTS                                                                            " & vbNewLine _
                                            & "	  ON OUTL.NRS_BR_CD   = OUTS.NRS_BR_CD                                                              " & vbNewLine _
                                            & "	 AND OUTL.OUTKA_NO_L  = OUTS.OUTKA_NO_L                                                             " & vbNewLine _
                                            & "	 AND OUTM.OUTKA_NO_M  = OUTS.OUTKA_NO_M                                                             " & vbNewLine _
                                            & "	 AND OUTS.SYS_DEL_FLG = '0'                                                                         " & vbNewLine _
                                            & "	LEFT JOIN                                                                                           " & vbNewLine _
                                            & "	$LM_MST$..M_GOODS MG                                                                            " & vbNewLine _
                                            & "	  ON OUTM.NRS_BR_CD   = MG.NRS_BR_CD                                                              " & vbNewLine _
                                            & "	 AND OUTM.GOODS_CD_NRS  = MG.GOODS_CD_NRS                                                             " & vbNewLine _
                                            & "	WHERE                                                                                               " & vbNewLine _
                                            & "	    OUTL.SYS_DEL_FLG  = '0'                                                                         " & vbNewLine _
                                            & "	AND OUTL.NRS_BR_CD    = @NRS_BR_CD                                                                  " & vbNewLine _
                                            & "	AND OUTL.OUTKA_NO_L   = @OUTKA_NO_L                                                                 " & vbNewLine _
                                            & "	GROUP BY                                                                                            " & vbNewLine _
                                            & "	 OUTS.BETU_WT                                                                                       " & vbNewLine _
                                            & "	,OUTS.ALCTD_NB                                                                                      " & vbNewLine _
                                            & "	,OUTL.NRS_BR_CD                                                                                     " & vbNewLine _
                                            & "	,OUTL.OUTKA_NO_L                                                                                    " & vbNewLine _
                                            & "	)  UNSO_WT                                                                                          " & vbNewLine _
                                            & "	)  UNSO_WT                                                                                          " & vbNewLine _
                                            & ",FL.UNSO_PKG_NB              AS UNSO_PKG_NB                                                          " & vbNewLine _
                                            & ",CST.CUST_NM_M               AS CUST_NM_M                                                            " & vbNewLine _
                                            & "--LMC563                                                                                             " & vbNewLine _
                                            & "--2018/03/07 001033 20180131【LMS】横浜BC帳票住所がYCCになっている対応 Annen upd start               " & vbNewLine _
                                            & ",SOKO.WH_NM                  AS NRS_BR_NM                                                            " & vbNewLine _
                                            & ",EDIL.FREE_C15               AS DEST_HOSOKU                                                          " & vbNewLine _
                                            & ",SOKO.AD_1                   AS NRS_AD_1                                                             " & vbNewLine _
                                            & ",SOKO.AD_2                   AS NRS_AD_2                                                             " & vbNewLine _
                                            & ",SOKO.TEL                    AS NRS_TEL                                                              " & vbNewLine _
                                            & "--,NB.NRS_BR_NM                AS NRS_BR_NM                                                            " & vbNewLine _
                                            & "--,EDIL.FREE_C15               AS DEST_HOSOKU                                                          " & vbNewLine _
                                            & "--,NB.AD_1                     AS NRS_AD_1                                                             " & vbNewLine _
                                            & "--,NB.AD_2                     AS NRS_AD_2                                                             " & vbNewLine _
                                            & "--,NB.TEL                      AS NRS_TEL                                                              " & vbNewLine _
                                            & "--2018/03/07 001033 20180131【LMS】横浜BC帳票住所がYCCになっている対応 Annen upd end                 " & vbNewLine _
                                            & ",CST.CUST_CD_L               AS CUST_CD_L                                                            " & vbNewLine _
                                            & ",FL.REMARK                   AS UNSO_L_REMARK                                                        " & vbNewLine _
                                            & ",OUTL.REMARK                 AS OUTKA_L_REMARK                                                       " & vbNewLine _
                                            & ",MG.GOODS_NM_1               AS GOODS_NM_1                                                           " & vbNewLine _
                                            & ",MG.OUTKA_ATT                AS OUTKA_ATT                                                            " & vbNewLine _
                                            & ",OUTL.BUYER_ORD_NO           AS BUYER_ORD_NO                                                         " & vbNewLine _
                                            & ",CASE WHEN OUTL.NRS_BR_CD = '50' THEN                                                                " & vbNewLine _
                                            & "      (                                                                                              " & vbNewLine _
                                            & "       CASE WHEN OUTL.CUST_CD_L = '20000' THEN MGD.SET_NAIYO                                         " & vbNewLine _
                                            & "             ELSE ''                                                                                 " & vbNewLine _
                                            & "       END                                                                                           " & vbNewLine _
                                            & "      )                                                                                              " & vbNewLine _
                                            & "      ELSE ''                                                                                        " & vbNewLine _
                                            & " END                         AS YELLOW_NO                                                            " & vbNewLine _
                                            & ",KB03.KBN_NM3                AS SHIHARAI_SHITEN_NM_563_1                                             " & vbNewLine _
                                            & ",CASE WHEN OUTL.NRS_BR_CD = '50' THEN                                                                " & vbNewLine _
                                            & "       (                                                                                             " & vbNewLine _
                                            & "         CASE WHEN OUTL.CUST_CD_L = '00007' THEN KB0401.KBN_NM3                                      " & vbNewLine _
                                            & "              WHEN OUTL.CUST_CD_L = '20000' THEN KB0402.KBN_NM3                                      " & vbNewLine _
                                            & "              WHEN OUTL.CUST_CD_L = '00950' THEN                                                     " & vbNewLine _
                                            & "                   (                                                                                 " & vbNewLine _
                                            & "                    CASE WHEN MG.SEARCH_KEY_1 = 'A0020' THEN KB0403.KBN_NM3                          " & vbNewLine _
                                            & "                         WHEN MG.SEARCH_KEY_1 = 'A0021' THEN KB0403.KBN_NM3                          " & vbNewLine _
                                            & "                         ELSE KB0404.KBN_NM3                                                         " & vbNewLine _
                                            & "                    END                                                                              " & vbNewLine _
                                            & "                   )                                                                                 " & vbNewLine _
                                            & "              ELSE KB0405.KBN_NM3                                                                    " & vbNewLine _
                                            & "         END                                                                                         " & vbNewLine _
                                            & "       )                                                                                             " & vbNewLine _
                                            & "      ELSE ''                                                                                        " & vbNewLine _
                                            & "END                          AS SHIHARAI_SHITEN_CD_563_1                                             " & vbNewLine _
                                            & ",KB03.KBN_NM4                AS SHIHARAI_SHITEN_TEL_563_1                                            " & vbNewLine _
                                            & "--LMC564                                                                                             " & vbNewLine _
                                            & ",KB05.KBN_NM4                AS SHITEN_TEL_1_564_1                                                   " & vbNewLine _
                                            & ",KB05.KBN_NM3                AS SHITEN_NM_564_1                                                      " & vbNewLine _
                                            & ",KB05.KBN_NM4                AS SHITEN_TEL_2_564_1                                                   " & vbNewLine _
                                            & "--2018/03/07 001033 20180131【LMS】横浜BC帳票住所がYCCになっている対応 Annen upd start               " & vbNewLine _
                                            & ",SOKO.AD_1                   AS NRS_BR_AD_1                                                          " & vbNewLine _
                                            & ",SOKO.AD_2                   AS NRS_BR_AD_2                                                          " & vbNewLine _
                                            & ",SOKO.WH_NM                  AS NRS_BR_NM_1                                                          " & vbNewLine _
                                            & "--,NB.AD_1                     AS NRS_BR_AD_1                                                          " & vbNewLine _
                                            & "--,NB.AD_2                     AS NRS_BR_AD_2                                                          " & vbNewLine _
                                            & "--,NB.NRS_BR_NM                AS NRS_BR_NM_1                                                          " & vbNewLine _
                                            & "--2018/03/07 001033 20180131【LMS】横浜BC帳票住所がYCCになっている対応 Annen upd end                 " & vbNewLine _
                                            & "--LMC565                                                                                             " & vbNewLine _
                                            & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_NM                                                     " & vbNewLine _
                                            & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_NM                                                     " & vbNewLine _
                                            & "      ELSE DST.DEST_NM                                                                               " & vbNewLine _
                                            & " END                         AS DEST_NM                                                              " & vbNewLine _
                                            & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_AD_1                                                   " & vbNewLine _
                                            & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_AD_1                                                   " & vbNewLine _
                                            & "      ELSE DST.AD_1                                                                                  " & vbNewLine _
                                            & " END                         AS AD_1                                                                 " & vbNewLine _
                                            & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_AD_2                                                   " & vbNewLine _
                                            & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_AD_2                                                   " & vbNewLine _
                                            & "      ELSE DST.AD_2                                                                                  " & vbNewLine _
                                            & " END                         AS AD_2                                                                 " & vbNewLine _
                                            & ",OUTL.DEST_AD_3              AS AD_3                                                                 " & vbNewLine _
                                            & ",OUTL.DEST_TEL               AS TEL                                                                  " & vbNewLine _
                                            & ",OUTL.DEST_CD                AS DEST_CD                                                              " & vbNewLine _
                                            & ",OUTL.SHIP_CD_L              AS SHIP_CD_L                                                            " & vbNewLine _
                                            & ",KB0601.KBN_NM4              AS SHIHARAI_CD_565_1                                                    " & vbNewLine _
                                            & ",KB0602.KBN_NM4              AS SHIHARAI_CD_565_2                                                    " & vbNewLine _
                                            & "--LMC566                                                                                             " & vbNewLine _
                                            & "--2018/03/07 001033 20180131【LMS】横浜BC帳票住所がYCCになっている対応 Annen upd start               " & vbNewLine _
                                            & ",SOKO.FAX                    AS NRS_FAX                                                              " & vbNewLine _
                                            & ",SOKO.AD_3                   AS NRS_AD_3                                                             " & vbNewLine _
                                            & "--,NB.FAX                      AS NRS_FAX                                                              " & vbNewLine _
                                            & "--LMC567                                                                                             " & vbNewLine _
                                            & "--,NB.AD_3                     AS NRS_AD_3                                                             " & vbNewLine _
                                            & "--2018/03/07 001033 20180131【LMS】横浜BC帳票住所がYCCになっている対応 Annen upd end                 " & vbNewLine _
                                            & "--LMC568                                                                                             " & vbNewLine _
                                            & ",OUTL.CUST_ORD_NO            AS CUST_ORD_NO                                                          " & vbNewLine _
                                            & ",MG.SHOBO_CD                 AS SHOBO_CD                                                             " & vbNewLine _
                                            & ",KB0701.KBN_NM5              AS CUST_CD_L_568_1                                                      " & vbNewLine _
                                            & ",KB0702.KBN_NM5              AS CUST_CD_L_568_2                                                      " & vbNewLine _
                                            & "--LMC569                                                                                             " & vbNewLine _
                                            & "--2018/03/07 001033 20180131【LMS】横浜BC帳票住所がYCCになっている対応 Annen upd start               " & vbNewLine _
                                            & ",SOKO.ZIP                    AS NRS_BR_ZIP                                                           " & vbNewLine _
                                            & ",SOKO.TEL                    AS NRS_BR_TEL                                                           " & vbNewLine _
                                            & "--,NB.ZIP                      AS NRS_BR_ZIP                                                           " & vbNewLine _
                                            & "--,NB.TEL                      AS NRS_BR_TEL                                                           " & vbNewLine _
                                            & "--2018/03/07 001033 20180131【LMS】横浜BC帳票住所がYCCになっている対応 Annen upd end                 " & vbNewLine _
                                            & ",KB08.KBN_NM1                AS KOTEI_1                                                              " & vbNewLine _
                                            & ",KB08.KBN_NM3                AS KOTEI_2                                                              " & vbNewLine _
                                            & ",KB08.KBN_NM5                AS KOTEI_3                                                              " & vbNewLine _
                                            & "--LMC570                                                                                             " & vbNewLine _
                                            & ",FL.NB_UT                    AS NB_UT                                                                " & vbNewLine _
                                            & ",CST.DENPYO_NM               AS DENPYO_NM                                                            " & vbNewLine _
                                            & ",KB1001.KBN_NM3              AS SHITEN_NM_570_1                                                      " & vbNewLine _
                                            & ",KB1001.KBN_NM4              AS SHITEN_TEL_570_1                                                     " & vbNewLine _
                                            & ",KB1002.KBN_NM3              AS SHITEN_NM_570_2                                                      " & vbNewLine _
                                            & ",KB1002.KBN_NM4              AS SHITEN_TEL_570_2                                                     " & vbNewLine _
                                            & "--LMC572                                                                                             " & vbNewLine _
                                            & ",OUTL.OUTKA_PKG_NB           AS OUTKA_PKG_NB                                                         " & vbNewLine _
                                            & ",OUTM.IRIME                  AS IRIME                                                                " & vbNewLine _
                                            & ",OUTM.IRIME_UT               AS IRIME_UT                                                             " & vbNewLine _
                                            & ",OUTM.ALCTD_NB               AS ALCTD_NB                                                             " & vbNewLine _
                                            & ",OUTM.LOT_NO                 AS LOT_NO                                                               " & vbNewLine _
                                            & ",SHIPDST.DEST_NM             AS SHIP_NM_L                                                            " & vbNewLine _
                                            & ",CUSTDTL.SET_NAIYO           AS UNSO_CUST_CD                                                         " & vbNewLine _
                                            & ",KB0801.KBN_NM3              AS SHIHARAI_CD_575_1                                                    " & vbNewLine _
                                            & ",KB0802.KBN_NM3              AS SHIHARAI_CD_575_2                                                    " & vbNewLine _
                                            & "--LMC670                                                                                             " & vbNewLine _
                                            & ",KB0803.KBN_NM1              AS KBN_CUST_ZIP                                                         " & vbNewLine _
                                            & ",KB0803.KBN_NM2              AS KBN_CUST_AD                                                          " & vbNewLine _
                                            & ",KB0803.KBN_NM3              AS KBN_CUST_TEL                                                         " & vbNewLine _
                                            & ",KB0803.KBN_NM4              AS KBN_CUST_NM                                                          " & vbNewLine _
                                            & ",OUTL.OUTKO_DATE             AS OUTKO_DATE                                                           " & vbNewLine _
                                            & ",(MG.STD_WT_KGS * OUTM.ALCTD_NB) AS ALCTD_WT                                                         " & vbNewLine _
                                            & "--,OUTKAEDIL.FREE_C05          AS BUKA_CD                                                            " & vbNewLine _
                                            & ",EDIL.FREE_C05          AS BUKA_CD                                                                   " & vbNewLine _
                                            & ",CASE WHEN SHIPDST.DEST_NM <> ''                                                                     " & vbNewLine _
                                            & "           AND SHIPDST.DEST_NM IS NOT NULL THEN SHIPDST.DEST_NM                                      " & vbNewLine _
                                            & "      WHEN CST.DENPYO_NM   <> ''                                                                     " & vbNewLine _
                                            & "           AND CST.DENPYO_NM IS NOT NULL   THEN CST.DENPYO_NM                                        " & vbNewLine _
                                            & "      ELSE CST.CUST_NM_L                                                                             " & vbNewLine _
                                            & " END                         AS ATSUKAISYA_NM                                                        " & vbNewLine _
                                            & " ,MG.GOODS_CD_CUST           AS GOODS_CD_CUST                 --2012.05.25                           " & vbNewLine _
                                            & " ,LEFT(JIS.JIS_CD,2)         AS PREF_CD                       --2012.05.25                           " & vbNewLine _
                                            & ",CASE WHEN LEFT(JIS.JIS_CD,2) ='16' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '17' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '18' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '21' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '25'                  --ここまで飛騨運輸のエリア                      " & vbNewLine _
                                            & "          THEN '飛騨運輸'                                                                            " & vbNewLine _
                                            & "     WHEN LEFT(JIS.JIS_CD,2) = '24' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '29' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '30' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '47'                  --ここまで近鉄運輸のエリア                      " & vbNewLine _
                                            & "         THEN '近鉄運輸'                                                                             " & vbNewLine _
                                            & "    WHEN  LEFT(JIS.JIS_CD,2) = '26' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '28' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '31' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '32' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '33' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '34' OR                                                               " & vbNewLine _
                                            & "       LEFT(JIS.JIS_CD,2) = '35' OR                                                                  " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '36' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '37' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '38' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '39'                                                                  " & vbNewLine _
                                            & "          THEN '岡山県貨物'                                                                          " & vbNewLine _
                                            & "          ELSE    '' END            AS TORI_UNSOCO_NM                                                " & vbNewLine _
                                            & "     --THEN MUC.UNSOCO_NM   END                                                                      " & vbNewLine _
                                            & "    --                              AS TORI_UNSOCO_NM                                                " & vbNewLine _
                                            & " --,MUC.UNSOCO_NM              AS TORI_UNSOCO_NM                --2012.05.25                         " & vbNewLine _
                                            & " ,MCD_SAI.SET_NAIYO          AS SAI_SHIHARAI_CD               --2012.05.25                           " & vbNewLine _
                                            & " ,MCD_SAI.SET_NAIYO_3        AS SET_NM_L                      --2012.05.29                           " & vbNewLine _
                                            & " ,MCD_NFC.SET_NAIYO          AS NAIYO1                        --2012.06.01                           " & vbNewLine _
                                            & " ,MCD_NFC.SET_NAIYO_2        AS NAIYO2                        --2012.06.01                           " & vbNewLine _
                                            & " ,MCD_NFC.SET_NAIYO_3        AS NAIYO3                        --2012.06.01                           " & vbNewLine _
                                            & " ,MCD_SAI.SET_NAIYO_2        AS NAIYO_CUST_NM                 --2012.06.04                           " & vbNewLine _
                                            & " ,OUTM.CUST_ORD_NO_DTL      AS CUST_ORD_NO_DTL              --2012.06.11                             " & vbNewLine _
                                            & " --2012.07.24 丸和運輸　荷受人氏名下の注意書き(REMARK)開始                                           " & vbNewLine _
                                            & " ,CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.REMARK                                                     " & vbNewLine _
                                            & "       WHEN OUTL.DEST_KB = '02' THEN EDIL.REMARK                                                     " & vbNewLine _
                                            & "       ELSE DST.REMARK                                                                               " & vbNewLine _
                                            & "  END                         AS REMARK_DEST                                                         " & vbNewLine _
                                            & " --2012.07.24 丸和運輸　荷受人氏名下の注意書き(REMARK)終了                                           " & vbNewLine _
                                            & " --要望番号1383 [LMC664] --- START ---                                                               " & vbNewLine _
                                            & " ,ISNULL(MCD_CUST.CUST_NAIYO_1,'') AS CUST_FLG                                                       " & vbNewLine _
                                            & " --要望番号1383 [LMC664] --- END ---                                                                 " & vbNewLine _
                                                     & "           --送状番号自動採番用 2016.07.23--- STD ---                                           " & vbNewLine _
                                                 & "           ,FL.AUTO_DENP_KBN           AS AUTO_DENP_KBN                                         " & vbNewLine _
                                                 & "           ,FL.AUTO_DENP_NO            AS AUTO_DENP_NO                                          " & vbNewLine _
                                                 & "           --送状番号自動採番用 2016.07.23--- END ---                                           " & vbNewLine _
                                            & " ,MGD2.SET_NAIYO             AS SIMPLE_GOODS_NM                                                      " & vbNewLine


    '要望番号1961　修正START 纏め条件を届先CD⇒顧客運賃纏めコードに変更
    ''' <summary>
    ''' 印刷データ抽出用(☆★作業用コメント:ひとまず修正おわり)
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_SELECT_DATA_CUST_CD_M As String = "  ,CST.CUST_CD_M               AS CUST_CD_M      " & vbNewLine _
                                                      & "  ,DST.CUST_DEST_CD            AS CUST_DEST_CD   " & vbNewLine
    '要望番号1961　修正END 纏め条件を届先CD⇒顧客運賃纏めコードに変更    



    ''' <summary>
    ''' 印刷データ抽出用(FFEM用)
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_SELECT_DATA_ADD_FJF As String _
        = "  , CASE WHEN (CHARINDEX('|', FJF.ZFVYDTEKIYO) = 0)                                            " & vbNewLine _
        & "            OR CHARINDEX('|', FJF.ZFVYDTEKIYO, CHARINDEX('|', FJF.ZFVYDTEKIYO) + 1) = 0        " & vbNewLine _
        & "         THEN ''                                                                               " & vbNewLine _
        & "         ELSE LEFT(FJF.ZFVYDTEKIYO, CHARINDEX('|', FJF.ZFVYDTEKIYO) - 1)                       " & vbNewLine _
        & "    END AS DEST_AD_4                                                                                " & vbNewLine _
        & "  , CASE WHEN (CHARINDEX('|', FJF.ZFVYDTEKIYO) = 0)                                            " & vbNewLine _
        & "            OR CHARINDEX('|', FJF.ZFVYDTEKIYO, CHARINDEX('|', FJF.ZFVYDTEKIYO) + 1) = 0        " & vbNewLine _
        & "         THEN ''                                                                               " & vbNewLine _
        & "         ELSE SUBSTRING(FJF.ZFVYDTEKIYO                                                        " & vbNewLine _
        & "                      , CHARINDEX('|', FJF.ZFVYDTEKIYO) + 1                                    " & vbNewLine _
        & "                      , CHARINDEX('|', FJF.ZFVYDTEKIYO, CHARINDEX('|', FJF.ZFVYDTEKIYO) + 1)   " & vbNewLine _
        & "                      - CHARINDEX('|', FJF.ZFVYDTEKIYO) - 1 )                                  " & vbNewLine _
        & "    END AS DEST_AD_5                                                                                " & vbNewLine


    '(2013.04.12)要望番号2015 FROM句をBP送り状用　追加START
    ''' <summary>
    ''' データ抽出用FROM句(☆★作業用コメント：20110711)
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_FROM_BPCEDIT As String = "FROM                                                                                                        " & vbNewLine _
                                     & "$LM_TRN$..C_OUTKA_L OUTL                                                                                    " & vbNewLine _
                                     & "--(2012.09.11)要望番号1412対応  --- START ---                                                               " & vbNewLine _
                                     & "--出荷EDIL                                                                                                  " & vbNewLine _
                                     & "--LEFT JOIN                                                                                                 " & vbNewLine _
                                     & "--(SELECT                                                                                                   " & vbNewLine _
                                     & "--*                                                                                                         " & vbNewLine _
                                     & "--FROM                                                                                                      " & vbNewLine _
                                     & "--(SELECT                                                                                                   " & vbNewLine _
                                     & "--        DEST_AD_1   AS DEST_AD_1                                                                          " & vbNewLine _
                                     & "--       ,DEST_AD_2   AS DEST_AD_2                                                                          " & vbNewLine _
                                     & "--       ,DEST_AD_3                                                                                         " & vbNewLine _
                                     & "--       ,DEST_TEL                                                                                          " & vbNewLine _
                                     & "--       ,DEST_ZIP                                                                                          " & vbNewLine _
                                     & "--       ,FREE_C15                                                                                          " & vbNewLine _
                                     & "--       ,DEST_NM     AS DEST_NM                                                                            " & vbNewLine _
                                     & "--       ,NRS_BR_CD                                                                                         " & vbNewLine _
                                     & "--       ,OUTKA_CTL_NO                                                                                      " & vbNewLine _
                                     & "--       ,SHIP_NM_L                                                                                         " & vbNewLine _
                                     & "--       ,SYS_DEL_FLG                                                                                       " & vbNewLine _
                                     & "--       ,FREE_C05                                                                                          " & vbNewLine _
                                     & "--       --,REMARK                    --2012.07.24 丸和運輸　荷受人氏名下の注意書き                         " & vbNewLine _
                                     & "--       ,REMARK       AS REMARK      --2012.08.21 要望番号1355                                             " & vbNewLine _
                                     & "--       ,ROW_NUMBER() OVER  (PARTITION BY NRS_BR_CD ORDER BY EDI_CTL_NO) AS NUM                            " & vbNewLine _
                                     & "--  FROM                                                                                                    " & vbNewLine _
                                     & "--        $LM_TRN$..H_OUTKAEDI_L                                                                            " & vbNewLine _
                                     & "--  WHERE                                                                                                   " & vbNewLine _
                                     & "--        NRS_BR_CD = @NRS_BR_CD                                                                            " & vbNewLine _
                                     & "--    AND OUTKA_CTL_NO IN (@OUTKA_NO_L)                                                                     " & vbNewLine _
                                     & "--    AND SYS_DEL_FLG  = '0'                                                                                " & vbNewLine _
                                     & "-- ) AS BASE                                                                                                " & vbNewLine _
                                     & "-- WHERE                                                                                                    " & vbNewLine _
                                     & "-- BASE.NUM = 1                                                                                             " & vbNewLine _
                                     & "--) EDIL                                                                                                    " & vbNewLine _
                                     & "--ON                                                                                                        " & vbNewLine _
                                     & "--1 = 1                                                                                                     " & vbNewLine _
                                     & "--下記の内容に変更                                                                                          " & vbNewLine _
                                     & " LEFT JOIN (                                                                                                " & vbNewLine _
                                     & "            SELECT                                                                                          " & vbNewLine _
                                     & "                   NRS_BR_CD                                                                                " & vbNewLine _
                                     & "                 , EDI_CTL_NO                                                                               " & vbNewLine _
                                     & "                 , OUTKA_CTL_NO                                                                             " & vbNewLine _
                                     & "             FROM (                                                                                         " & vbNewLine _
                                     & "                    SELECT                                                                                  " & vbNewLine _
                                     & "                           EDIOUTL.NRS_BR_CD                                                                " & vbNewLine _
                                     & "                         , EDIOUTL.EDI_CTL_NO                                                               " & vbNewLine _
                                     & "                         , EDIOUTL.OUTKA_CTL_NO                                                             " & vbNewLine _
                                     & "                         , CASE WHEN EDIOUTL.OUTKA_CTL_NO = '' THEN 1                                       " & vbNewLine _
                                     & "                           ELSE ROW_NUMBER() OVER (PARTITION BY EDIOUTL.NRS_BR_CD                           " & vbNewLine _
                                     & "                                                              , EDIOUTL.OUTKA_CTL_NO                        " & vbNewLine _
                                     & "                                                       ORDER BY EDIOUTL.NRS_BR_CD                           " & vbNewLine _
                                     & "                                                              , EDIOUTL.EDI_CTL_NO                          " & vbNewLine _
                                     & "                                                  )                                                         " & vbNewLine _
                                     & "                           END AS IDX                                                                       " & vbNewLine _
                                     & "                      FROM $LM_TRN$..H_OUTKAEDI_L EDIOUTL                                                   " & vbNewLine _
                                     & "                     WHERE EDIOUTL.SYS_DEL_FLG  = '0'                                                       " & vbNewLine _
                                     & "                       AND EDIOUTL.NRS_BR_CD    = @NRS_BR_CD                                                " & vbNewLine _
                                     & "                       AND EDIOUTL.OUTKA_CTL_NO = @OUTKA_NO_L                                               " & vbNewLine _
                                     & "                  ) EBASE                                                                                   " & vbNewLine _
                                     & "            WHERE EBASE.IDX = 1                                                                             " & vbNewLine _
                                     & "            ) TOPEDI                                                                                        " & vbNewLine _
                                     & "        ON TOPEDI.NRS_BR_CD    = OUTL.NRS_BR_CD                                                             " & vbNewLine _
                                     & "       AND TOPEDI.OUTKA_CTL_NO = OUTL.OUTKA_NO_L                                                            " & vbNewLine _
                                     & " LEFT JOIN $LM_TRN$..H_OUTKAEDI_L EDIL                                                                      " & vbNewLine _
                                     & "        ON EDIL.NRS_BR_CD  = TOPEDI.NRS_BR_CD                                                               " & vbNewLine _
                                     & "       AND EDIL.EDI_CTL_NO = TOPEDI.EDI_CTL_NO                                                              " & vbNewLine _
                                     & "--(2012.09.11)要望番号1412対応  ---  END  ---                                                               " & vbNewLine _
                                     & "--出荷M                                                                                                     " & vbNewLine _
                                     & "LEFT JOIN                                                                                                   " & vbNewLine _
                                     & "(SELECT                                                                                                     " & vbNewLine _
                                     & "*                                                                                                           " & vbNewLine _
                                     & "FROM                                                                                                        " & vbNewLine _
                                     & "(SELECT                                                                                                     " & vbNewLine _
                                     & "   NRS_BR_CD                                                                                                " & vbNewLine _
                                     & "  ,GOODS_CD_NRS                                                                                             " & vbNewLine _
                                     & "  ,IRIME                                                                                                    " & vbNewLine _
                                     & "  ,IRIME_UT                                                                                                 " & vbNewLine _
                                     & "  ,ALCTD_NB                                                                                                 " & vbNewLine _
                                     & "  ,ALCTD_QT                                                                                                 " & vbNewLine _
                                     & "  ,LOT_NO                                                                                                   " & vbNewLine _
                                     & "  ,SYS_DEL_FLG                                                                                              " & vbNewLine _
                                     & "  ,CUST_ORD_NO_DTL                                                                                          " & vbNewLine _
                                     & "  ,ROW_NUMBER() OVER (PARTITION BY NRS_BR_CD ORDER BY OUTKA_NO_L,OUTKA_NO_M) AS NUM                         " & vbNewLine _
                                     & "  ,OUTKA_NO_L                                                                                               " & vbNewLine _
                                     & "  ,OUTKA_NO_M                                                                                               " & vbNewLine _
                                     & "  FROM                                                                                                      " & vbNewLine _
                                     & "   $LM_TRN$..C_OUTKA_M M                                                                                    " & vbNewLine _
                                     & "  WHERE                                                                                                     " & vbNewLine _
                                     & "      M.NRS_BR_CD = @NRS_BR_CD                                                                              " & vbNewLine _
                                     & "  AND M.OUTKA_NO_L IN(@OUTKA_NO_L)                                                                          " & vbNewLine _
                                     & "  AND SYS_DEL_FLG = '0'                                                                                     " & vbNewLine _
                                     & " ) AS BASE                                                                                                  " & vbNewLine _
                                     & " WHERE                                                                                                      " & vbNewLine _
                                     & " BASE.NUM = 1                                                                                               " & vbNewLine _
                                     & ") OUTM                                                                                                      " & vbNewLine _
                                     & "ON                                                                                                          " & vbNewLine _
                                     & "1 = 1                                                                                                       " & vbNewLine _
                                     & "--F運送L                                                                                                    " & vbNewLine _
                                     & "LEFT JOIN $LM_TRN$..F_UNSO_L FL                                                                             " & vbNewLine _
                                     & "ON  FL.MOTO_DATA_KB   = '20'                                                                                " & vbNewLine _
                                     & "AND FL.NRS_BR_CD      = OUTL.NRS_BR_CD                                                                      " & vbNewLine _
                                     & "AND FL.INOUTKA_NO_L   = OUTL.OUTKA_NO_L                                                                     " & vbNewLine _
                                     & "AND FL.SYS_DEL_FLG    = '0'                                                                                 " & vbNewLine _
                                     & "--出荷EDI L                                                                                                 " & vbNewLine _
                                     & "--LEFT JOIN $LM_TRN$..H_OUTKAEDI_L OUTKAEDIL                                                                  " & vbNewLine _
                                     & "--ON  OUTKAEDIL.NRS_BR_CD     = OUTL.NRS_BR_CD                                                                " & vbNewLine _
                                     & "--AND OUTKAEDIL.OUTKA_CTL_NO  = OUTL.OUTKA_NO_L                                                               " & vbNewLine _
                                     & "--AND OUTKAEDIL.SYS_DEL_FLG   = '0'                                                                           " & vbNewLine _
                                     & "--商品M                                                                                                     " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_GOODS MG                                                                              " & vbNewLine _
                                     & "ON  MG.NRS_BR_CD     = OUTM.NRS_BR_CD                                                                       " & vbNewLine _
                                     & "AND MG.GOODS_CD_NRS  = OUTM.GOODS_CD_NRS                                                                    " & vbNewLine _
                                     & "AND MG.SYS_DEL_FLG   = '0'                                                                                  " & vbNewLine _
                                     & "--荷主なしでの運送会社荷主別送り状パターン取得                                                              " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_UNSO_CUST_RPT MCR1                                                                    " & vbNewLine _
                                     & "ON  FL.NRS_BR_CD     = MCR1.NRS_BR_CD                                                                       " & vbNewLine _
                                     & "AND FL.UNSO_CD       = MCR1.UNSOCO_CD                                                                       " & vbNewLine _
                                     & "AND FL.UNSO_BR_CD    = MCR1.UNSOCO_BR_CD                                                                    " & vbNewLine _
                                     & "AND '11'             = MCR1.PTN_ID                                                                          " & vbNewLine _
                                     & "AND FL.PC_KB         = MCR1.MOTO_TYAKU_KB                                                                   " & vbNewLine _
                                     & "AND ''               = MCR1.CUST_CD_L                                                                       " & vbNewLine _
                                     & "AND ''               = MCR1.CUST_CD_M                                                                       " & vbNewLine _
                                     & "AND MCR1.SYS_DEL_FLG = '0'                                                                                  " & vbNewLine _
                                     & "--帳票パターン取得                                                                                          " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_RPT MR1                                                                               " & vbNewLine _
                                     & "ON  MR1.NRS_BR_CD   = MCR1.NRS_BR_CD                                                                        " & vbNewLine _
                                     & "AND MR1.PTN_ID      = MCR1.PTN_ID                                                                           " & vbNewLine _
                                     & "AND MR1.PTN_CD      = MCR1.PTN_CD                                                                           " & vbNewLine _
                                     & "AND MR1.SYS_DEL_FLG = '0'                                                                                   " & vbNewLine _
                                     & "--荷主込みでの運送会社荷主別送り状パターン取得                                                              " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_UNSO_CUST_RPT MCR2                                                                    " & vbNewLine _
                                     & "ON  FL.NRS_BR_CD     = MCR2.NRS_BR_CD                                                                       " & vbNewLine _
                                     & "AND FL.UNSO_CD       = MCR2.UNSOCO_CD                                                                       " & vbNewLine _
                                     & "AND FL.UNSO_BR_CD    = MCR2.UNSOCO_BR_CD                                                                    " & vbNewLine _
                                     & "AND '11'             = MCR2.PTN_ID                                                                          " & vbNewLine _
                                     & "AND FL.PC_KB         = MCR2.MOTO_TYAKU_KB                                                                   " & vbNewLine _
                                     & "AND FL.CUST_CD_L     = MCR2.CUST_CD_L                                                                       " & vbNewLine _
                                     & "AND FL.CUST_CD_M     = MCR2.CUST_CD_M                                                                       " & vbNewLine _
                                     & "AND MCR2.SYS_DEL_FLG = '0'                                                                                  " & vbNewLine _
                                     & "--帳票パターン取得                                                                                          " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_RPT MR2                                                                               " & vbNewLine _
                                     & "ON  MR2.NRS_BR_CD    = MCR2.NRS_BR_CD                                                                       " & vbNewLine _
                                     & "AND MR2.PTN_ID       = MCR2.PTN_ID                                                                          " & vbNewLine _
                                     & "AND MR2.PTN_CD       = MCR2.PTN_CD                                                                          " & vbNewLine _
                                     & "AND MR2.SYS_DEL_FLG  = '0'                                                                                  " & vbNewLine _
                                     & "--存在しない場合の帳票パターン取得                                                                          " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_RPT MR3                                                                               " & vbNewLine _
                                     & "ON  MR3.NRS_BR_CD     = OUTL.NRS_BR_CD                                                                      " & vbNewLine _
                                     & "AND MR3.PTN_ID        = '11'                                                                                " & vbNewLine _
                                     & "AND MR3.STANDARD_FLAG = '01'                                                                                " & vbNewLine _
                                     & "AND MR3.SYS_DEL_FLG   = '0'                                                                                 " & vbNewLine _
                                     & "--荷主マスタ (ここからメインプリント用)                                                                     " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_CUST CST                                                                              " & vbNewLine _
                                     & "ON  CST.NRS_BR_CD     = MG.NRS_BR_CD                                                                        " & vbNewLine _
                                     & "AND CST.CUST_CD_L     = MG.CUST_CD_L                                                                        " & vbNewLine _
                                     & "AND CST.CUST_CD_M     = MG.CUST_CD_M                                                                        " & vbNewLine _
                                     & "AND CST.CUST_CD_S     = MG.CUST_CD_S                                                                        " & vbNewLine _
                                     & "AND CST.CUST_CD_SS    = MG.CUST_CD_SS                                                                       " & vbNewLine _
                                     & "AND CST.SYS_DEL_FLG   = '0'                                                                                 " & vbNewLine _
                                     & "--届先マスタ                                                                                                " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_DEST DST                                                                              " & vbNewLine _
                                     & "ON  DST.NRS_BR_CD     = OUTL.NRS_BR_CD                                                                      " & vbNewLine _
                                     & "AND DST.CUST_CD_L     = OUTL.CUST_CD_L                                                                      " & vbNewLine _
                                     & "AND DST.DEST_CD       = OUTL.DEST_CD                                                                        " & vbNewLine _
                                     & "AND DST.SYS_DEL_FLG   = '0'                                                                                 " & vbNewLine _
                                     & "--(2013.04.12)要望番号2015 FROM句をBP送り状用　追加START                                                    " & vbNewLine _
                                     & "--届先マスタ(表示項目用)                                                                                    " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_DEST DST_2                                                                            " & vbNewLine _
                                     & "ON  DST.NRS_BR_CD     = DST_2.NRS_BR_CD                                                                     " & vbNewLine _
                                     & "AND DST.CUST_CD_L     = DST_2.CUST_CD_L                                                                     " & vbNewLine _
                                     & "AND DST.CUST_DEST_CD  = DST_2.DEST_CD                                                                       " & vbNewLine _
                                     & "AND DST.SYS_DEL_FLG   = '0'                                                                                 " & vbNewLine _
                                     & "--(2013.04.12)要望番号2015 FROM句をBP送り状用　追加END                                                    " & vbNewLine _
                                     & "--届先マスタ                                                                                                " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_DEST SHIPDST                                                                          " & vbNewLine _
                                     & "ON  SHIPDST.NRS_BR_CD     = OUTL.NRS_BR_CD                                                                  " & vbNewLine _
                                     & "AND SHIPDST.CUST_CD_L     = OUTL.CUST_CD_L                                                                  " & vbNewLine _
                                     & "AND SHIPDST.DEST_CD       = OUTL.SHIP_CD_L                                                                  " & vbNewLine _
                                     & "AND SHIPDST.SYS_DEL_FLG   = '0'                                                                             " & vbNewLine _
                                     & "--営業所マスタ                                                                                              " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_NRS_BR NB                                                                             " & vbNewLine _
                                     & "ON  NB.NRS_BR_CD      = OUTL.NRS_BR_CD                                                                      " & vbNewLine _
                                     & "AND NB.SYS_DEL_FLG    = '0'                                                                                 " & vbNewLine _
                                     & "--商品明細                                                                                                  " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_GOODS_DETAILS MGD                                                                     " & vbNewLine _
                                     & "ON  MGD.NRS_BR_CD       = OUTM.NRS_BR_CD                                                                    " & vbNewLine _
                                     & "AND MGD.GOODS_CD_NRS    = OUTM.GOODS_CD_NRS                                                                 " & vbNewLine _
                                     & "AND MGD.SUB_KB          = '01'                                                                              " & vbNewLine _
                                     & "AND MGD.SYS_DEL_FLG     = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC560支店TEL(NM4)・支店名(NM3))KB01                                                           " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB01                                                                              " & vbNewLine _
                                     & "ON  KB01.KBN_GROUP_CD = 'O007'                                                                              " & vbNewLine _
                                     & "AND KB01.KBN_CD       = '01'                                                                                " & vbNewLine _
                                     & "AND KB01.SYS_DEL_FLG  = '0'                                                                                 " & vbNewLine _
                                     & "--区分マスタ(納期文言)KB02                                                                                  " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB02                                                                              " & vbNewLine _
                                     & "ON  KB02.KBN_GROUP_CD = 'N010'                                                                              " & vbNewLine _
                                     & "AND KB02.KBN_CD       = OUTL.ARR_PLAN_TIME                                                                  " & vbNewLine _
                                     & "AND KB02.SYS_DEL_FLG  = '0'                                                                                 " & vbNewLine _
                                     & "--区分マスタ(LMC563支店名(NM3)、電話番号(NM4))KB03                                                          " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB03                                                                              " & vbNewLine _
                                     & "ON  KB03.KBN_GROUP_CD = 'O007'                                                                              " & vbNewLine _
                                     & "AND KB03.KBN_CD       = '10'                                                                                " & vbNewLine _
                                     & "AND KB03.SYS_DEL_FLG  = '0'                                                                                 " & vbNewLine _
                                     & "--区分マスタ(LMC563支払支店コード(NM3))KB0401                                                               " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0401                                                                            " & vbNewLine _
                                     & "ON  KB0401.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0401.KBN_CD       = '11'                                                                              " & vbNewLine _
                                     & "AND KB0401.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC563支払支店コード(NM3))KB0402                                                               " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0402                                                                            " & vbNewLine _
                                     & "ON  KB0402.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0402.KBN_CD       = '12'                                                                              " & vbNewLine _
                                     & "AND KB0402.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC563支払支店コード(NM3))KB0403                                                               " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0403                                                                            " & vbNewLine _
                                     & "ON  KB0403.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0403.KBN_CD       = '13'                                                                              " & vbNewLine _
                                     & "AND KB0403.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC563支払支店コード(NM3))KB0404                                                               " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0404                                                                            " & vbNewLine _
                                     & "ON  KB0404.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0404.KBN_CD       = '14'                                                                              " & vbNewLine _
                                     & "AND KB0404.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC563支払支店コード(NM3))KB0405                                                               " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0405                                                                            " & vbNewLine _
                                     & "ON  KB0405.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0405.KBN_CD       = '15'                                                                              " & vbNewLine _
                                     & "AND KB0405.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC564支店TEL、荷主TEL(NM4)・支店名(NM3))KB05                                                  " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB05                                                                              " & vbNewLine _
                                     & "ON  KB05.KBN_GROUP_CD   = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB05.KBN_CD         = '02'                                                                              " & vbNewLine _
                                     & "AND KB05.SYS_DEL_FLG    = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC565支払いコード(NM3)KB0601)                                                                 " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0601                                                                            " & vbNewLine _
                                     & "ON  KB0601.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0601.KBN_CD       = '07'                                                                              " & vbNewLine _
                                     & "AND KB0601.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC565支払いコード(NM3)KB0602)                                                                 " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0602                                                                            " & vbNewLine _
                                     & "ON  KB0602.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0602.KBN_CD       = '08'                                                                              " & vbNewLine _
                                     & "AND KB0602.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC568荷主コード(NM5)KB0701                                                                    " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0701                                                                            " & vbNewLine _
                                     & "ON  KB0701.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0701.KBN_CD       = '03'                                                                              " & vbNewLine _
                                     & "AND KB0701.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC568荷主コード(NM5)KB0702                                                                    " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0702                                                                            " & vbNewLine _
                                     & "ON  KB0702.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0702.KBN_CD       = '09'                                                                              " & vbNewLine _
                                     & "AND KB0702.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC569固定表示(NM1,3,4))KB08                                                                   " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB08                                                                              " & vbNewLine _
                                     & "ON  KB08.KBN_GROUP_CD   = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB08.KBN_CD         = '04'                                                                              " & vbNewLine _
                                     & "AND KB08.SYS_DEL_FLG    = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC570支店名(NM3)支店TEL(NM4))KB1001                                                           " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB1001                                                                            " & vbNewLine _
                                     & "ON  KB1001.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB1001.KBN_CD       = '05'                                                                              " & vbNewLine _
                                     & "AND KB1001.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC570支店名(NM3)支店TEL(NM4))KB1002                                                           " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB1002                                                                            " & vbNewLine _
                                     & "ON  KB1002.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB1002.KBN_CD       = '06'                                                                              " & vbNewLine _
                                     & "AND KB1002.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--荷主明細マスタ(LMC573にて運送契約荷主コード取得)                                                          " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_CUST_DETAILS CUSTDTL                                                                  " & vbNewLine _
                                     & "ON  CUSTDTL.NRS_BR_CD    = OUTL.NRS_BR_CD                                                                   " & vbNewLine _
                                     & "AND CUSTDTL.CUST_CD      = OUTL.CUST_CD_L + OUTL.CUST_CD_M                                                  " & vbNewLine _
                                     & "AND CUSTDTL.SUB_KB       = '03'                                                                             " & vbNewLine _
                                     & "AND CUSTDTL.SYS_DEL_FLG  = '0'                                                                              " & vbNewLine _
                                     & "--荷主明細マスタ(まとめ届先コード使用有無)                                                                  " & vbNewLine _
                                     & "LEFT JOIN LM_MST..M_CUST_DETAILS CUSTDTL2                                                                   " & vbNewLine _
                                     & "ON  CUSTDTL2.NRS_BR_CD    = OUTL.NRS_BR_CD                                                                  " & vbNewLine _
                                     & "AND CUSTDTL2.CUST_CD      = OUTL.CUST_CD_L                                                                  " & vbNewLine _
                                     & "AND CUSTDTL2.SUB_KB       = '57'                                                                            " & vbNewLine _
                                     & "AND CUSTDTL2.SYS_DEL_FLG  = '0'                                                                             " & vbNewLine _
                                     & "--区分マスタ(LMC575支払コード(NM3)KB0801)                                                                   " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0801                                                                            " & vbNewLine _
                                     & "ON  KB0801.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0801.KBN_CD       = '16'                                                                              " & vbNewLine _
                                     & "AND KB0801.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC575支払コード(NM3)KB0802)                                                                   " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0802                                                                            " & vbNewLine _
                                     & "ON  KB0802.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0802.KBN_CD       = '17'                                                                              " & vbNewLine _
                                     & "AND KB0802.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC670 KB0803)                                                                                 " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0803                                                                            " & vbNewLine _
                                     & "ON  KB0803.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0803.KBN_CD       = '18'                                                                              " & vbNewLine _
                                     & "AND KB0803.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_DEST      DEST_JIS --2012.05.25                                                       " & vbNewLine _
                                     & "ON  DEST_JIS.NRS_BR_CD    = OUTL.NRS_BR_CD                                                                  " & vbNewLine _
                                     & "AND DEST_JIS.CUST_CD_L    = OUTL.CUST_CD_L                                                                  " & vbNewLine _
                                     & "AND DEST_JIS.DEST_CD      = OUTL.DEST_CD                                                                    " & vbNewLine _
                                     & "AND DEST_JIS.SYS_DEL_FLG  = '0'                                                                             " & vbNewLine _
                                     & "--JISマスタ(LMC661にてJIS_CD2桁：都道府県コード取得)2012.05.25                                              " & vbNewLine _
                                     & "  LEFT JOIN  $LM_MST$..M_JIS   JIS                                                                          " & vbNewLine _
                                     & "  ON  JIS.JIS_CD       = DEST_JIS.JIS                                                                       " & vbNewLine _
                                     & " AND  JIS.SYS_DEL_FLG  = '0'                                                                                " & vbNewLine _
                                     & "--運送会社マスタ(LMC589にてUNSOCO_NM：取次先運送会社名取得)2012.05.25                                       " & vbNewLine _
                                     & "--  LEFT JOIN  $LM_MST$..M_UNSOCO   MUC                                                                     " & vbNewLine _
                                     & "--  ON  MUC.NRS_BR_CD    = FL.NRS_BR_CD                                                                     " & vbNewLine _
                                     & "-- AND  MUC.UNSOCO_CD    = FL.UNSO_CD                                                                       " & vbNewLine _
                                     & "-- AND  MUC.UNSOCO_BR_CD = FL.UNSO_BR_CD                                                                    " & vbNewLine _
                                     & "-- AND  MUC.SYS_DEL_FLG  = '0'                                                                              " & vbNewLine _
                                     & "--荷主明細マスタ(LMC660にてSET_NAIYO：支払コード取得)2012.05.25                                             " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_CUST_DETAILS MCD_SAI                                                                  " & vbNewLine _
                                     & "ON  MCD_SAI.NRS_BR_CD    = OUTL.NRS_BR_CD                                                                   " & vbNewLine _
                                     & "AND MCD_SAI.CUST_CD      = OUTL.CUST_CD_L                                                                   " & vbNewLine _
                                     & "--AND MCD_SAI.CUST_CD_EDA  = OUTL.CUST_CD_M                                                                   " & vbNewLine _
                                     & "AND MCD_SAI.SUB_KB       = '27'                                                                             " & vbNewLine _
                                     & "AND MCD_SAI.SYS_DEL_FLG  = '0'                                                                              " & vbNewLine _
                                     & "--荷主明細マスタ(LMC669にてSET_NAIYO：荷送人名称取得)2012.06.01                                             " & vbNewLine _
                                     & "  LEFT JOIN $LM_MST$..M_CUST_DETAILS MCD_NFC                                                                " & vbNewLine _
                                     & "ON MCD_NFC.NRS_BR_CD   = OUTL.NRS_BR_CD                                                                     " & vbNewLine _
                                     & "AND MCD_NFC.CUST_CD      = OUTL.CUST_CD_L                                                                   " & vbNewLine _
                                     & "--AND MCD_NFC.CUST_CD_EDA  = OUTL.CUST_CD_M  --notes 1118                                                   " & vbNewLine _
                                     & "AND MCD_NFC.SUB_KB       = '29'                                                                             " & vbNewLine _
                                     & "AND MCD_NFC.SYS_DEL_FLG  = '0'                                                                              " & vbNewLine _
                                     & "--WHERE                                                                                                       " & vbNewLine _
                                     & "--    OUTL.SYS_DEL_FLG    = '0'                                                                               " & vbNewLine _
                                     & "--AND OUTL.NRS_BR_CD      = @NRS_BR_CD                                                                        " & vbNewLine _
                                     & "--AND OUTL.OUTKA_NO_L IN(@OUTKA_NO_L)                                                                         " & vbNewLine _
                                     & " --要望番号1383 [LMC664] --- START ---                                                                      " & vbNewLine _
                                     & "LEFT JOIN (SELECT NRS_BR_CD   AS NRS_BR_CD                                                                  " & vbNewLine _
                                     & "                 , CUST_CD     AS CUST_CD                                                                   " & vbNewLine _
                                     & "                 , CUST_CLASS  AS CUST_CLASS                                                                " & vbNewLine _
                                     & "                 , SET_NAIYO   AS CUST_NAIYO_1                                                              " & vbNewLine _
                                     & "                 , SET_NAIYO_2 AS CUST_NAIYO_2                                                              " & vbNewLine _
                                     & "                 , SET_NAIYO_3 AS CUST_NAIYO_3                                                              " & vbNewLine _
                                     & "              FROM $LM_MST$..M_CUST_DETAILS                                                                 " & vbNewLine _
                                     & "             WHERE SUB_KB ='42'                                                                             " & vbNewLine _
                                     & "               AND SET_NAIYO_2 = @RPT_ID                                                                    " & vbNewLine _
                                     & "               AND SYS_DEL_FLG = '0'                                                                        " & vbNewLine _
                                     & "            ) MCD_CUST                                                                                      " & vbNewLine _
                                     & "        ON CST.NRS_BR_CD = MCD_CUST.NRS_BR_CD                                                               " & vbNewLine _
                                     & "       AND (CASE WHEN MCD_CUST.CUST_CLASS='00' THEN  CST.CUST_CD_L                                                   " & vbNewLine _
                                     & "                 WHEN MCD_CUST.CUST_CLASS='01' THEN (CST.CUST_CD_L + CST.CUST_CD_M)                                  " & vbNewLine _
                                     & "                 WHEN MCD_CUST.CUST_CLASS='02' THEN (CST.CUST_CD_L + CST.CUST_CD_M + CST.CUST_CD_S)                  " & vbNewLine _
                                     & "                 WHEN MCD_CUST.CUST_CLASS='03' THEN (CST.CUST_CD_L + CST.CUST_CD_M + CST.CUST_CD_S + CST.CUST_CD_SS) " & vbNewLine _
                                     & "            END                                                                                             " & vbNewLine _
                                     & "           ) = MCD_CUST.CUST_CD                                                                             " & vbNewLine _
                                     & " --要望番号1383 [LMC664] --- END ---                                                                        " & vbNewLine

    '(2013.04.12)要望番号2015 FROM句をBP送り状用　追加END


    ''' <summary>
    ''' データ抽出用FROM句(☆★作業用コメント：20110711)
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_FROM As String = "FROM                                                                                                        " & vbNewLine _
                                     & "$LM_TRN$..C_OUTKA_L OUTL                                                                                    " & vbNewLine _
                                     & "--(2012.09.11)要望番号1412対応  --- START ---                                                               " & vbNewLine _
                                     & "--出荷EDIL                                                                                                  " & vbNewLine _
                                     & "--LEFT JOIN                                                                                                 " & vbNewLine _
                                     & "--(SELECT                                                                                                   " & vbNewLine _
                                     & "--*                                                                                                         " & vbNewLine _
                                     & "--FROM                                                                                                      " & vbNewLine _
                                     & "--(SELECT                                                                                                   " & vbNewLine _
                                     & "--        DEST_AD_1   AS DEST_AD_1                                                                          " & vbNewLine _
                                     & "--       ,DEST_AD_2   AS DEST_AD_2                                                                          " & vbNewLine _
                                     & "--       ,DEST_AD_3                                                                                         " & vbNewLine _
                                     & "--       ,DEST_TEL                                                                                          " & vbNewLine _
                                     & "--       ,DEST_ZIP                                                                                          " & vbNewLine _
                                     & "--       ,FREE_C15                                                                                          " & vbNewLine _
                                     & "--       ,DEST_NM     AS DEST_NM                                                                            " & vbNewLine _
                                     & "--       ,NRS_BR_CD                                                                                         " & vbNewLine _
                                     & "--       ,OUTKA_CTL_NO                                                                                      " & vbNewLine _
                                     & "--       ,SHIP_NM_L                                                                                         " & vbNewLine _
                                     & "--       ,SYS_DEL_FLG                                                                                       " & vbNewLine _
                                     & "--       ,FREE_C05                                                                                          " & vbNewLine _
                                     & "--       --,REMARK                    --2012.07.24 丸和運輸　荷受人氏名下の注意書き                         " & vbNewLine _
                                     & "--       ,REMARK       AS REMARK      --2012.08.21 要望番号1355                                             " & vbNewLine _
                                     & "--       ,ROW_NUMBER() OVER  (PARTITION BY NRS_BR_CD ORDER BY EDI_CTL_NO) AS NUM                            " & vbNewLine _
                                     & "--  FROM                                                                                                    " & vbNewLine _
                                     & "--        $LM_TRN$..H_OUTKAEDI_L                                                                            " & vbNewLine _
                                     & "--  WHERE                                                                                                   " & vbNewLine _
                                     & "--        NRS_BR_CD = @NRS_BR_CD                                                                            " & vbNewLine _
                                     & "--    AND OUTKA_CTL_NO IN (@OUTKA_NO_L)                                                                     " & vbNewLine _
                                     & "--    AND SYS_DEL_FLG  = '0'                                                                                " & vbNewLine _
                                     & "-- ) AS BASE                                                                                                " & vbNewLine _
                                     & "-- WHERE                                                                                                    " & vbNewLine _
                                     & "-- BASE.NUM = 1                                                                                             " & vbNewLine _
                                     & "--) EDIL                                                                                                    " & vbNewLine _
                                     & "--ON                                                                                                        " & vbNewLine _
                                     & "--1 = 1                                                                                                     " & vbNewLine _
                                     & "--下記の内容に変更                                                                                          " & vbNewLine _
                                     & " LEFT JOIN (                                                                                                " & vbNewLine _
                                     & "            SELECT                                                                                          " & vbNewLine _
                                     & "                   NRS_BR_CD                                                                                " & vbNewLine _
                                     & "                 , EDI_CTL_NO                                                                               " & vbNewLine _
                                     & "                 , OUTKA_CTL_NO                                                                             " & vbNewLine _
                                     & "             FROM (                                                                                         " & vbNewLine _
                                     & "                    SELECT                                                                                  " & vbNewLine _
                                     & "                           EDIOUTL.NRS_BR_CD                                                                " & vbNewLine _
                                     & "                         , EDIOUTL.EDI_CTL_NO                                                               " & vbNewLine _
                                     & "                         , EDIOUTL.OUTKA_CTL_NO                                                             " & vbNewLine _
                                     & "                         , CASE WHEN EDIOUTL.OUTKA_CTL_NO = '' THEN 1                                       " & vbNewLine _
                                     & "                           ELSE ROW_NUMBER() OVER (PARTITION BY EDIOUTL.NRS_BR_CD                           " & vbNewLine _
                                     & "                                                              , EDIOUTL.OUTKA_CTL_NO                        " & vbNewLine _
                                     & "                                                       ORDER BY EDIOUTL.NRS_BR_CD                           " & vbNewLine _
                                     & "                                                              , EDIOUTL.EDI_CTL_NO                          " & vbNewLine _
                                     & "                                                  )                                                         " & vbNewLine _
                                     & "                           END AS IDX                                                                       " & vbNewLine _
                                     & "                      FROM $LM_TRN$..H_OUTKAEDI_L EDIOUTL                                                   " & vbNewLine _
                                     & "                     WHERE EDIOUTL.SYS_DEL_FLG  = '0'                                                       " & vbNewLine _
                                     & "                       AND EDIOUTL.NRS_BR_CD    = @NRS_BR_CD                                                " & vbNewLine _
                                     & "                       AND EDIOUTL.OUTKA_CTL_NO = @OUTKA_NO_L                                               " & vbNewLine _
                                     & "                  ) EBASE                                                                                   " & vbNewLine _
                                     & "            WHERE EBASE.IDX = 1                                                                             " & vbNewLine _
                                     & "            ) TOPEDI                                                                                        " & vbNewLine _
                                     & "        ON TOPEDI.NRS_BR_CD    = OUTL.NRS_BR_CD                                                             " & vbNewLine _
                                     & "       AND TOPEDI.OUTKA_CTL_NO = OUTL.OUTKA_NO_L                                                            " & vbNewLine _
                                     & " LEFT JOIN $LM_TRN$..H_OUTKAEDI_L EDIL                                                                      " & vbNewLine _
                                     & "        ON EDIL.NRS_BR_CD  = TOPEDI.NRS_BR_CD                                                               " & vbNewLine _
                                     & "       AND EDIL.EDI_CTL_NO = TOPEDI.EDI_CTL_NO                                                              " & vbNewLine _
                                     & "--(2012.09.11)要望番号1412対応  ---  END  ---                                                               " & vbNewLine _
                                     & "--出荷M                                                                                                     " & vbNewLine _
                                     & "LEFT JOIN                                                                                                   " & vbNewLine _
                                     & "(SELECT                                                                                                     " & vbNewLine _
                                     & "*                                                                                                           " & vbNewLine _
                                     & "FROM                                                                                                        " & vbNewLine _
                                     & "(SELECT                                                                                                     " & vbNewLine _
                                     & "   NRS_BR_CD                                                                                                " & vbNewLine _
                                     & "  ,GOODS_CD_NRS                                                                                             " & vbNewLine _
                                     & "  ,IRIME                                                                                                    " & vbNewLine _
                                     & "  ,IRIME_UT                                                                                                 " & vbNewLine _
                                     & "  ,ALCTD_NB                                                                                                 " & vbNewLine _
                                     & "  ,ALCTD_QT                                                                                                 " & vbNewLine _
                                     & "  ,LOT_NO                                                                                                   " & vbNewLine _
                                     & "  ,SYS_DEL_FLG                                                                                              " & vbNewLine _
                                     & "  ,CUST_ORD_NO_DTL                                                                                          " & vbNewLine _
                                     & "  ,ROW_NUMBER() OVER (PARTITION BY NRS_BR_CD ORDER BY OUTKA_NO_L,OUTKA_NO_M) AS NUM                         " & vbNewLine _
                                     & "  ,OUTKA_NO_L                                                                                               " & vbNewLine _
                                     & "  ,OUTKA_NO_M                                                                                               " & vbNewLine _
                                     & "  FROM                                                                                                      " & vbNewLine _
                                     & "   $LM_TRN$..C_OUTKA_M M                                                                                    " & vbNewLine _
                                     & "  WHERE                                                                                                     " & vbNewLine _
                                     & "      M.NRS_BR_CD = @NRS_BR_CD                                                                              " & vbNewLine _
                                     & "  AND M.OUTKA_NO_L IN(@OUTKA_NO_L)                                                                          " & vbNewLine _
                                     & "  AND SYS_DEL_FLG = '0'                                                                                     " & vbNewLine _
                                     & " ) AS BASE                                                                                                  " & vbNewLine _
                                     & " WHERE                                                                                                      " & vbNewLine _
                                     & " BASE.NUM = 1                                                                                               " & vbNewLine _
                                     & ") OUTM                                                                                                      " & vbNewLine _
                                     & "ON                                                                                                          " & vbNewLine _
                                     & "1 = 1                                                                                                       " & vbNewLine _
                                     & "--F運送L                                                                                                    " & vbNewLine _
                                     & "LEFT JOIN $LM_TRN$..F_UNSO_L FL                                                                             " & vbNewLine _
                                     & "ON  FL.MOTO_DATA_KB   = '20'                                                                                " & vbNewLine _
                                     & "AND FL.NRS_BR_CD      = OUTL.NRS_BR_CD                                                                      " & vbNewLine _
                                     & "AND FL.INOUTKA_NO_L   = OUTL.OUTKA_NO_L                                                                     " & vbNewLine _
                                     & "AND FL.SYS_DEL_FLG    = '0'                                                                                 " & vbNewLine _
                                     & "--出荷EDI L                                                                                                 " & vbNewLine _
                                     & "--LEFT JOIN $LM_TRN$..H_OUTKAEDI_L OUTKAEDIL                                                                  " & vbNewLine _
                                     & "--ON  OUTKAEDIL.NRS_BR_CD     = OUTL.NRS_BR_CD                                                                " & vbNewLine _
                                     & "--AND OUTKAEDIL.OUTKA_CTL_NO  = OUTL.OUTKA_NO_L                                                               " & vbNewLine _
                                     & "--AND OUTKAEDIL.SYS_DEL_FLG   = '0'                                                                           " & vbNewLine _
                                     & "--商品M                                                                                                     " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_GOODS MG                                                                              " & vbNewLine _
                                     & "ON  MG.NRS_BR_CD     = OUTM.NRS_BR_CD                                                                       " & vbNewLine _
                                     & "AND MG.GOODS_CD_NRS  = OUTM.GOODS_CD_NRS                                                                    " & vbNewLine _
                                     & "AND MG.SYS_DEL_FLG   = '0'                                                                                  " & vbNewLine _
                                     & "--荷主なしでの運送会社荷主別送り状パターン取得                                                              " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_UNSO_CUST_RPT MCR1                                                                    " & vbNewLine _
                                     & "ON  FL.NRS_BR_CD     = MCR1.NRS_BR_CD                                                                       " & vbNewLine _
                                     & "AND FL.UNSO_CD       = MCR1.UNSOCO_CD                                                                       " & vbNewLine _
                                     & "AND FL.UNSO_BR_CD    = MCR1.UNSOCO_BR_CD                                                                    " & vbNewLine _
                                     & "AND '11'             = MCR1.PTN_ID                                                                          " & vbNewLine _
                                     & "AND FL.PC_KB         = MCR1.MOTO_TYAKU_KB                                                                   " & vbNewLine _
                                     & "AND ''               = MCR1.CUST_CD_L                                                                       " & vbNewLine _
                                     & "AND ''               = MCR1.CUST_CD_M                                                                       " & vbNewLine _
                                     & "AND MCR1.SYS_DEL_FLG = '0'                                                                                  " & vbNewLine _
                                     & "--帳票パターン取得                                                                                          " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_RPT MR1                                                                               " & vbNewLine _
                                     & "ON  MR1.NRS_BR_CD   = MCR1.NRS_BR_CD                                                                        " & vbNewLine _
                                     & "AND MR1.PTN_ID      = MCR1.PTN_ID                                                                           " & vbNewLine _
                                     & "AND MR1.PTN_CD      = MCR1.PTN_CD                                                                           " & vbNewLine _
                                     & "AND MR1.SYS_DEL_FLG = '0'                                                                                   " & vbNewLine _
                                     & "--荷主込みでの運送会社荷主別送り状パターン取得                                                              " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_UNSO_CUST_RPT MCR2                                                                    " & vbNewLine _
                                     & "ON  FL.NRS_BR_CD     = MCR2.NRS_BR_CD                                                                       " & vbNewLine _
                                     & "AND FL.UNSO_CD       = MCR2.UNSOCO_CD                                                                       " & vbNewLine _
                                     & "AND FL.UNSO_BR_CD    = MCR2.UNSOCO_BR_CD                                                                    " & vbNewLine _
                                     & "AND '11'             = MCR2.PTN_ID                                                                          " & vbNewLine _
                                     & "AND FL.PC_KB         = MCR2.MOTO_TYAKU_KB                                                                   " & vbNewLine _
                                     & "AND FL.CUST_CD_L     = MCR2.CUST_CD_L                                                                       " & vbNewLine _
                                     & "AND FL.CUST_CD_M     = MCR2.CUST_CD_M                                                                       " & vbNewLine _
                                     & "AND MCR2.SYS_DEL_FLG = '0'                                                                                  " & vbNewLine _
                                     & "--出荷Lでの荷主帳票パターン取得           ------** ADD Start/End 2018/08/02                                 " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_CUST_RPT MCR3                                                                         " & vbNewLine _
                                     & "  ON OUTL.NRS_BR_CD = MCR3.NRS_BR_CD                                                                         " & vbNewLine _
                                     & " AND OUTL.CUST_CD_L = MCR3.CUST_CD_L                                                                        " & vbNewLine _
                                     & " AND OUTL.CUST_CD_M = MCR3.CUST_CD_M                                                                        " & vbNewLine _
                                     & " AND '00'           = MCR3.CUST_CD_S                                                                        " & vbNewLine _
                                     & " AND MCR3.PTN_ID = '11'                                                                                     " & vbNewLine _
                                     & "--出荷Lでの帳票パターン取得               ------** ADD Start/End 2018/08/02                                    " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_RPT MR4                                                                                " & vbNewLine _
                                     & " ON  MR4.NRS_BR_CD     = MCR3.NRS_BR_CD                                                                     " & vbNewLine _
                                     & " AND MR4.PTN_ID        = MCR3.PTN_ID                                                                        " & vbNewLine _
                                     & " AND MR4.PTN_CD        = MCR3.PTN_CD                                                                        " & vbNewLine _
                                     & " AND MR4.STANDARD_FLAG = '00'                                                                               " & vbNewLine _
                                     & " AND MR4.SYS_DEL_FLG      = '0'                                  　　                                       " & vbNewLine _
                                     & "--帳票パターン取得                                                                                          " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_RPT MR2                                                                               " & vbNewLine _
                                     & "ON  MR2.NRS_BR_CD    = MCR2.NRS_BR_CD                                                                       " & vbNewLine _
                                     & "AND MR2.PTN_ID       = MCR2.PTN_ID                                                                          " & vbNewLine _
                                     & "AND MR2.PTN_CD       = MCR2.PTN_CD                                                                          " & vbNewLine _
                                     & "AND MR2.SYS_DEL_FLG  = '0'                                                                                  " & vbNewLine _
                                     & "--存在しない場合の帳票パターン取得                                                                          " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_RPT MR3                                                                               " & vbNewLine _
                                     & "ON  MR3.NRS_BR_CD     = OUTL.NRS_BR_CD                                                                      " & vbNewLine _
                                     & "AND MR3.PTN_ID        = '11'                                                                                " & vbNewLine _
                                     & "AND MR3.STANDARD_FLAG = '01'                                                                                " & vbNewLine _
                                     & "AND MR3.SYS_DEL_FLG   = '0'                                                                                 " & vbNewLine _
                                     & "--荷主マスタ (ここからメインプリント用)                                                               " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_CUST CST                                                                              " & vbNewLine _
                                     & "ON  CST.NRS_BR_CD     = MG.NRS_BR_CD                                                                        " & vbNewLine _
                                     & "AND CST.CUST_CD_L     = MG.CUST_CD_L                                                                        " & vbNewLine _
                                     & "AND CST.CUST_CD_M     = MG.CUST_CD_M                                                                        " & vbNewLine _
                                     & "AND CST.CUST_CD_S     = MG.CUST_CD_S                                                                        " & vbNewLine _
                                     & "AND CST.CUST_CD_SS    = MG.CUST_CD_SS                                                                       " & vbNewLine _
                                     & "AND CST.SYS_DEL_FLG   = '0'                                                                                 " & vbNewLine _
                                     & "--届先マスタ                                                                                                " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_DEST DST                                                                              " & vbNewLine _
                                     & "ON  DST.NRS_BR_CD     = OUTL.NRS_BR_CD                                                                      " & vbNewLine _
                                     & "AND DST.CUST_CD_L     = OUTL.CUST_CD_L                                                                      " & vbNewLine _
                                     & "AND DST.DEST_CD       = OUTL.DEST_CD                                                                        " & vbNewLine _
                                     & "AND DST.SYS_DEL_FLG   = '0'                                                                                 " & vbNewLine _
                                     & "--届先マスタ                                                                                                " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_DEST SHIPDST                                                                          " & vbNewLine _
                                     & "ON  SHIPDST.NRS_BR_CD     = OUTL.NRS_BR_CD                                                                  " & vbNewLine _
                                     & "AND SHIPDST.CUST_CD_L     = OUTL.CUST_CD_L                                                                  " & vbNewLine _
                                     & "AND SHIPDST.DEST_CD       = OUTL.SHIP_CD_L                                                                  " & vbNewLine _
                                     & "AND SHIPDST.SYS_DEL_FLG   = '0'                                                                             " & vbNewLine _
                                     & "--2018/03/07 001033 20180131【LMS】横浜BC帳票住所がYCCになっている対応 Annen upd start                      " & vbNewLine _
                                     & "--倉庫マスタ                                                                                                " & vbNewLine _
                                     & "LEFT JOIN LM_MST..M_SOKO SOKO                                                                               " & vbNewLine _
                                     & "ON OUTL.NRS_BR_CD = SOKO.NRS_BR_CD                                                                          " & vbNewLine _
                                     & "AND OUTL.WH_CD = SOKO.WH_CD                                                                                 " & vbNewLine _
                                     & "AND SOKO.SYS_DEL_FLG = '0'                                                                                  " & vbNewLine _
                                     & "--LEFT JOIN $LM_MST$..M_NRS_BR NB                                                                             " & vbNewLine _
                                     & "--営業所マスタ                                                                                              " & vbNewLine _
                                     & "--ON  NB.NRS_BR_CD      = OUTL.NRS_BR_CD                                                                      " & vbNewLine _
                                     & "--AND NB.SYS_DEL_FLG    = '0'                                                                                 " & vbNewLine _
                                     & "--2018/03/07 001033 20180131【LMS】横浜BC帳票住所がYCCになっている対応 Annen upd end                        " & vbNewLine _
                                     & "--商品明細                                                                                                  " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_GOODS_DETAILS MGD                                                                     " & vbNewLine _
                                     & "ON  MGD.NRS_BR_CD       = OUTM.NRS_BR_CD                                                                    " & vbNewLine _
                                     & "AND MGD.GOODS_CD_NRS    = OUTM.GOODS_CD_NRS                                                                 " & vbNewLine _
                                     & "AND MGD.SUB_KB          = '01'                                                                              " & vbNewLine _
                                     & "AND MGD.SYS_DEL_FLG     = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC560支店TEL(NM4)・支店名(NM3))KB01                                                           " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB01                                                                              " & vbNewLine _
                                     & "ON  KB01.KBN_GROUP_CD = 'O007'                                                                              " & vbNewLine _
                                     & "AND KB01.KBN_CD       = '01'                                                                                " & vbNewLine _
                                     & "AND KB01.SYS_DEL_FLG  = '0'                                                                                 " & vbNewLine _
                                     & "--区分マスタ(納期文言)KB02                                                                                  " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB02                                                                              " & vbNewLine _
                                     & "ON  KB02.KBN_GROUP_CD = 'N010'                                                                              " & vbNewLine _
                                     & "AND KB02.KBN_CD       = OUTL.ARR_PLAN_TIME                                                                  " & vbNewLine _
                                     & "AND KB02.SYS_DEL_FLG  = '0'                                                                                 " & vbNewLine _
                                     & "--区分マスタ(LMC563支店名(NM3)、電話番号(NM4))KB03                                                          " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB03                                                                              " & vbNewLine _
                                     & "ON  KB03.KBN_GROUP_CD = 'O007'                                                                              " & vbNewLine _
                                     & "AND KB03.KBN_CD       = '10'                                                                                " & vbNewLine _
                                     & "AND KB03.SYS_DEL_FLG  = '0'                                                                                 " & vbNewLine _
                                     & "--区分マスタ(LMC563支払支店コード(NM3))KB0401                                                               " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0401                                                                            " & vbNewLine _
                                     & "ON  KB0401.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0401.KBN_CD       = '11'                                                                              " & vbNewLine _
                                     & "AND KB0401.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC563支払支店コード(NM3))KB0402                                                               " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0402                                                                            " & vbNewLine _
                                     & "ON  KB0402.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0402.KBN_CD       = '12'                                                                              " & vbNewLine _
                                     & "AND KB0402.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC563支払支店コード(NM3))KB0403                                                               " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0403                                                                            " & vbNewLine _
                                     & "ON  KB0403.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0403.KBN_CD       = '13'                                                                              " & vbNewLine _
                                     & "AND KB0403.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC563支払支店コード(NM3))KB0404                                                               " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0404                                                                            " & vbNewLine _
                                     & "ON  KB0404.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0404.KBN_CD       = '14'                                                                              " & vbNewLine _
                                     & "AND KB0404.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC563支払支店コード(NM3))KB0405                                                               " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0405                                                                            " & vbNewLine _
                                     & "ON  KB0405.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0405.KBN_CD       = '15'                                                                              " & vbNewLine _
                                     & "AND KB0405.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC564支店TEL、荷主TEL(NM4)・支店名(NM3))KB05                                                  " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB05                                                                              " & vbNewLine _
                                     & "ON  KB05.KBN_GROUP_CD   = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB05.KBN_CD         = '02'                                                                              " & vbNewLine _
                                     & "AND KB05.SYS_DEL_FLG    = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC565支払いコード(NM3)KB0601)                                                                 " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0601                                                                            " & vbNewLine _
                                     & "ON  KB0601.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0601.KBN_CD       = '07'                                                                              " & vbNewLine _
                                     & "AND KB0601.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC565支払いコード(NM3)KB0602)                                                                 " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0602                                                                            " & vbNewLine _
                                     & "ON  KB0602.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0602.KBN_CD       = '08'                                                                              " & vbNewLine _
                                     & "AND KB0602.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC568荷主コード(NM5)KB0701                                                                    " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0701                                                                            " & vbNewLine _
                                     & "ON  KB0701.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0701.KBN_CD       = '03'                                                                              " & vbNewLine _
                                     & "AND KB0701.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC568荷主コード(NM5)KB0702                                                                    " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0702                                                                            " & vbNewLine _
                                     & "ON  KB0702.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0702.KBN_CD       = '09'                                                                              " & vbNewLine _
                                     & "AND KB0702.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC569固定表示(NM1,3,4))KB08                                                                   " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB08                                                                              " & vbNewLine _
                                     & "ON  KB08.KBN_GROUP_CD   = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB08.KBN_CD         = '04'                                                                              " & vbNewLine _
                                     & "AND KB08.SYS_DEL_FLG    = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC570支店名(NM3)支店TEL(NM4))KB1001                                                           " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB1001                                                                            " & vbNewLine _
                                     & "ON  KB1001.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB1001.KBN_CD       = '05'                                                                              " & vbNewLine _
                                     & "AND KB1001.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC570支店名(NM3)支店TEL(NM4))KB1002                                                           " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB1002                                                                            " & vbNewLine _
                                     & "ON  KB1002.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB1002.KBN_CD       = '06'                                                                              " & vbNewLine _
                                     & "AND KB1002.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--荷主明細マスタ(LMC573にて運送契約荷主コード取得)                                                          " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_CUST_DETAILS CUSTDTL                                                                  " & vbNewLine _
                                     & "ON  CUSTDTL.NRS_BR_CD    = OUTL.NRS_BR_CD                                                                   " & vbNewLine _
                                     & "AND CUSTDTL.CUST_CD      = OUTL.CUST_CD_L + OUTL.CUST_CD_M                                                  " & vbNewLine _
                                     & "AND CUSTDTL.SUB_KB       = '03'                                                                             " & vbNewLine _
                                     & "AND CUSTDTL.SYS_DEL_FLG  = '0'                                                                              " & vbNewLine _
                                     & "--区分マスタ(LMC575支払コード(NM3)KB0801)                                                                   " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0801                                                                            " & vbNewLine _
                                     & "ON  KB0801.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0801.KBN_CD       = '16'                                                                              " & vbNewLine _
                                     & "AND KB0801.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC575支払コード(NM3)KB0802)                                                                   " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0802                                                                            " & vbNewLine _
                                     & "ON  KB0802.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0802.KBN_CD       = '17'                                                                              " & vbNewLine _
                                     & "AND KB0802.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC670 KB0803)                                                                                 " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0803                                                                            " & vbNewLine _
                                     & "ON  KB0803.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0803.KBN_CD       = '18'                                                                              " & vbNewLine _
                                     & "AND KB0803.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_DEST      DEST_JIS --2012.05.25                                                       " & vbNewLine _
                                     & "ON  DEST_JIS.NRS_BR_CD    = OUTL.NRS_BR_CD                                                                  " & vbNewLine _
                                     & "AND DEST_JIS.CUST_CD_L    = OUTL.CUST_CD_L                                                                  " & vbNewLine _
                                     & "AND DEST_JIS.DEST_CD      = OUTL.DEST_CD                                                                    " & vbNewLine _
                                     & "AND DEST_JIS.SYS_DEL_FLG  = '0'                                                                             " & vbNewLine _
                                     & "--JISマスタ(LMC661にてJIS_CD2桁：都道府県コード取得)2012.05.25                                              " & vbNewLine _
                                     & "  LEFT JOIN  $LM_MST$..M_JIS   JIS                                                                          " & vbNewLine _
                                     & "  ON  JIS.JIS_CD       = DEST_JIS.JIS                                                                       " & vbNewLine _
                                     & " AND  JIS.SYS_DEL_FLG  = '0'                                                                                " & vbNewLine _
                                     & "--運送会社マスタ(LMC589にてUNSOCO_NM：取次先運送会社名取得)2012.05.25                                       " & vbNewLine _
                                     & "--  LEFT JOIN  $LM_MST$..M_UNSOCO   MUC                                                                     " & vbNewLine _
                                     & "--  ON  MUC.NRS_BR_CD    = FL.NRS_BR_CD                                                                     " & vbNewLine _
                                     & "-- AND  MUC.UNSOCO_CD    = FL.UNSO_CD                                                                       " & vbNewLine _
                                     & "-- AND  MUC.UNSOCO_BR_CD = FL.UNSO_BR_CD                                                                    " & vbNewLine _
                                     & "-- AND  MUC.SYS_DEL_FLG  = '0'                                                                              " & vbNewLine _
                                     & "--荷主明細マスタ(LMC660にてSET_NAIYO：支払コード取得)2012.05.25                                             " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_CUST_DETAILS MCD_SAI                                                                  " & vbNewLine _
                                     & "ON  MCD_SAI.NRS_BR_CD    = OUTL.NRS_BR_CD                                                                   " & vbNewLine _
                                     & "AND MCD_SAI.CUST_CD      = OUTL.CUST_CD_L                                                                   " & vbNewLine _
                                     & "--AND MCD_SAI.CUST_CD_EDA  = OUTL.CUST_CD_M                                                                   " & vbNewLine _
                                     & "AND MCD_SAI.SUB_KB       = '27'                                                                             " & vbNewLine _
                                     & "AND MCD_SAI.SYS_DEL_FLG  = '0'                                                                              " & vbNewLine _
                                     & "--荷主明細マスタ(LMC669にてSET_NAIYO：荷送人名称取得)2012.06.01                                             " & vbNewLine _
                                     & "  LEFT JOIN $LM_MST$..M_CUST_DETAILS MCD_NFC                                                                " & vbNewLine _
                                     & "ON MCD_NFC.NRS_BR_CD   = OUTL.NRS_BR_CD                                                                     " & vbNewLine _
                                     & "AND MCD_NFC.CUST_CD      = OUTL.CUST_CD_L                                                                   " & vbNewLine _
                                     & "--AND MCD_NFC.CUST_CD_EDA  = OUTL.CUST_CD_M  --notes 1118                                                   " & vbNewLine _
                                     & "AND MCD_NFC.SUB_KB       = '29'                                                                             " & vbNewLine _
                                     & "AND MCD_NFC.SYS_DEL_FLG  = '0'                                                                              " & vbNewLine _
                                     & "--WHERE                                                                                                       " & vbNewLine _
                                     & "--    OUTL.SYS_DEL_FLG    = '0'                                                                               " & vbNewLine _
                                     & "--AND OUTL.NRS_BR_CD      = @NRS_BR_CD                                                                        " & vbNewLine _
                                     & "--AND OUTL.OUTKA_NO_L IN(@OUTKA_NO_L)                                                                         " & vbNewLine _
                                     & " --要望番号1383 [LMC664] --- START ---                                                                      " & vbNewLine _
                                     & "LEFT JOIN (SELECT NRS_BR_CD   AS NRS_BR_CD                                                                  " & vbNewLine _
                                     & "                 , CUST_CD     AS CUST_CD                                                                   " & vbNewLine _
                                     & "                 , CUST_CLASS  AS CUST_CLASS                                                                " & vbNewLine _
                                     & "                 , SET_NAIYO   AS CUST_NAIYO_1                                                              " & vbNewLine _
                                     & "                 , SET_NAIYO_2 AS CUST_NAIYO_2                                                              " & vbNewLine _
                                     & "                 , SET_NAIYO_3 AS CUST_NAIYO_3                                                              " & vbNewLine _
                                     & "              FROM $LM_MST$..M_CUST_DETAILS                                                                 " & vbNewLine _
                                     & "             WHERE SUB_KB ='42'                                                                             " & vbNewLine _
                                     & "               AND SET_NAIYO_2 = @RPT_ID                                                                    " & vbNewLine _
                                     & "               AND SYS_DEL_FLG = '0'                                                                        " & vbNewLine _
                                     & "            ) MCD_CUST                                                                                      " & vbNewLine _
                                     & "        ON CST.NRS_BR_CD = MCD_CUST.NRS_BR_CD                                                               " & vbNewLine _
                                     & "       AND (CASE WHEN MCD_CUST.CUST_CLASS='00' THEN  CST.CUST_CD_L                                                   " & vbNewLine _
                                     & "                 WHEN MCD_CUST.CUST_CLASS='01' THEN (CST.CUST_CD_L + CST.CUST_CD_M)                                  " & vbNewLine _
                                     & "                 WHEN MCD_CUST.CUST_CLASS='02' THEN (CST.CUST_CD_L + CST.CUST_CD_M + CST.CUST_CD_S)                  " & vbNewLine _
                                     & "                 WHEN MCD_CUST.CUST_CLASS='03' THEN (CST.CUST_CD_L + CST.CUST_CD_M + CST.CUST_CD_S + CST.CUST_CD_SS) " & vbNewLine _
                                     & "            END                                                                                             " & vbNewLine _
                                     & "           ) = MCD_CUST.CUST_CD                                                                             " & vbNewLine _
                                     & " --要望番号1383 [LMC664] --- END ---                                                                        " & vbNewLine 

#If True Then   'ADD 2020/01/15 009792【LMS】RD帳票作成_アンファー:送り状・納品書亜種
    ''' <summary>
    ''' データ抽出用FROM句(ADD)
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_FROM_ADD As String = "--出荷M(中MIN)                                                                                          " & vbNewLine _
                                     & "LEFT OUTER JOIN                                                                                             " & vbNewLine _
                                     & "       (SELECT                                                                                              " & vbNewLine _
                                     & "           NRS_BR_CD                                                                                        " & vbNewLine _
                                     & "           ,OUTKA_NO_L                                                                                      " & vbNewLine _
                                     & "           ,MIN(OUTKA_NO_M) AS  OUTKA_NO_M                                                                  " & vbNewLine _
                                     & "       FROM $LM_TRN$..C_OUTKA_M WHERE SYS_DEL_FLG ='0'                                                      " & vbNewLine _
                                     & "        AND NRS_BR_CD = @NRS_BR_CD                                                                          " & vbNewLine _
                                     & "        AND OUTKA_NO_L = @OUTKA_NO_L                                                                        " & vbNewLine _
                                     & "       GROUP BY NRS_BR_CD,OUTKA_NO_L) OUTM_MIN                                                              " & vbNewLine _
                                     & "       ON OUTM_MIN.NRS_BR_CD        = OUTL.NRS_BR_CD                                                        " & vbNewLine _
                                     & "       AND OUTM_MIN.OUTKA_NO_L      = OUTL.OUTKA_NO_L                                                       " & vbNewLine _
                                     & "--出荷M(中MIN)                                                                                              " & vbNewLine _
                                     & "LEFT JOIN $LM_TRN$..C_OUTKA_M OUTM2                                                                         " & vbNewLine _
                                     & "  ON  OUTM2.NRS_BR_CD = OUTL.NRS_BR_CD                                                                      " & vbNewLine _
                                     & " AND OUTM2.OUTKA_NO_L = OUTL.OUTKA_NO_L                                                                     " & vbNewLine _
                                     & " AND OUTM2.OUTKA_NO_M = OUTM_MIN.OUTKA_NO_M                                                                 " & vbNewLine _
                                     & " AND OUTM2.SYS_DEL_FLG = '0'                                                                                " & vbNewLine _
                                     & "LEFT JOIN   $LM_MST$..M_GOODS_DETAILS  MGD2                                                                 " & vbNewLine _
                                     & "  ON MGD2.SUB_KB = '73'                                                                                     " & vbNewLine _
                                     & " AND MGD2.SYS_DEL_FLG  = '0'                                                                                " & vbNewLine _
                                     & " AND MGD2.NRS_BR_CD    = OUTM2.NRS_BR_CD                                                                    " & vbNewLine _
                                     & " AND MGD2.GOODS_CD_NRS = OUTM2.GOODS_CD_NRS                                                                 " & vbNewLine
#End If

    ''' <summary>
    ''' 印刷データ抽出用FROM句
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_INVOICEFROM As String = "FROM                                                                                                        " & vbNewLine _
                                     & "$LM_TRN$..C_OUTKA_L OUTL                                                                                    " & vbNewLine _
                                     & "--(2012.09.11)要望番号1412対応  --- START ---                                                               " & vbNewLine _
                                     & "--出荷EDIL                                                                                                  " & vbNewLine _
                                     & "--LEFT JOIN                                                                                                 " & vbNewLine _
                                     & "--(SELECT                                                                                                   " & vbNewLine _
                                     & "--*                                                                                                         " & vbNewLine _
                                     & "--FROM                                                                                                      " & vbNewLine _
                                     & "--(SELECT                                                                                                   " & vbNewLine _
                                     & "--        DEST_AD_1   AS DEST_AD_1                                                                          " & vbNewLine _
                                     & "--       ,DEST_AD_2   AS DEST_AD_2                                                                          " & vbNewLine _
                                     & "--       ,DEST_AD_3                                                                                         " & vbNewLine _
                                     & "--       ,DEST_TEL                                                                                          " & vbNewLine _
                                     & "--       ,DEST_ZIP                                                                                          " & vbNewLine _
                                     & "--       ,FREE_C15                                                                                          " & vbNewLine _
                                     & "--       ,DEST_NM     AS DEST_NM                                                                            " & vbNewLine _
                                     & "--       ,NRS_BR_CD                                                                                         " & vbNewLine _
                                     & "--       ,OUTKA_CTL_NO                                                                                      " & vbNewLine _
                                     & "--       ,SHIP_NM_L                                                                                         " & vbNewLine _
                                     & "--       ,SYS_DEL_FLG                                                                                       " & vbNewLine _
                                     & "--       ,FREE_C05                                                                                          " & vbNewLine _
                                     & "--       --,REMARK                    --2012.07.24 丸和運輸　荷受人氏名下の注意書き                         " & vbNewLine _
                                     & "--       ,REMARK       AS REMARK      --2012.08.21 要望番号1355                                             " & vbNewLine _
                                     & "--       ,ROW_NUMBER() OVER  (PARTITION BY NRS_BR_CD ORDER BY EDI_CTL_NO) AS NUM                            " & vbNewLine _
                                     & "--  FROM                                                                                                    " & vbNewLine _
                                     & "--        $LM_TRN$..H_OUTKAEDI_L                                                                            " & vbNewLine _
                                     & "--  WHERE                                                                                                   " & vbNewLine _
                                     & "--        NRS_BR_CD = @NRS_BR_CD                                                                            " & vbNewLine _
                                     & "--    AND OUTKA_CTL_NO IN (@OUTKA_NO_L)                                                                     " & vbNewLine _
                                     & "--    AND SYS_DEL_FLG  = '0'                                                                                " & vbNewLine _
                                     & "-- ) AS BASE                                                                                                " & vbNewLine _
                                     & "-- WHERE                                                                                                    " & vbNewLine _
                                     & "-- BASE.NUM = 1                                                                                             " & vbNewLine _
                                     & "--) EDIL                                                                                                    " & vbNewLine _
                                     & "--ON                                                                                                        " & vbNewLine _
                                     & "--1 = 1                                                                                                     " & vbNewLine _
                                     & "--下記の内容に変更                                                                                          " & vbNewLine _
                                     & " LEFT JOIN (                                                                                                " & vbNewLine _
                                     & "            SELECT                                                                                          " & vbNewLine _
                                     & "                   NRS_BR_CD                                                                                " & vbNewLine _
                                     & "                 , EDI_CTL_NO                                                                               " & vbNewLine _
                                     & "                 , OUTKA_CTL_NO                                                                             " & vbNewLine _
                                     & "             FROM (                                                                                         " & vbNewLine _
                                     & "                    SELECT                                                                                  " & vbNewLine _
                                     & "                           EDIOUTL.NRS_BR_CD                                                                " & vbNewLine _
                                     & "                         , EDIOUTL.EDI_CTL_NO                                                               " & vbNewLine _
                                     & "                         , EDIOUTL.OUTKA_CTL_NO                                                             " & vbNewLine _
                                     & "                         , CASE WHEN EDIOUTL.OUTKA_CTL_NO = '' THEN 1                                       " & vbNewLine _
                                     & "                           ELSE ROW_NUMBER() OVER (PARTITION BY EDIOUTL.NRS_BR_CD                           " & vbNewLine _
                                     & "                                                              , EDIOUTL.OUTKA_CTL_NO                        " & vbNewLine _
                                     & "                                                       ORDER BY EDIOUTL.NRS_BR_CD                           " & vbNewLine _
                                     & "                                                              , EDIOUTL.EDI_CTL_NO                          " & vbNewLine _
                                     & "                                                  )                                                         " & vbNewLine _
                                     & "                           END AS IDX                                                                       " & vbNewLine _
                                     & "                      FROM $LM_TRN$..H_OUTKAEDI_L EDIOUTL                                                   " & vbNewLine _
                                     & "                     WHERE EDIOUTL.SYS_DEL_FLG  = '0'                                                       " & vbNewLine _
                                     & "                       AND EDIOUTL.NRS_BR_CD    = @NRS_BR_CD                                                " & vbNewLine _
                                     & "                       AND EDIOUTL.OUTKA_CTL_NO = @OUTKA_NO_L                                               " & vbNewLine _
                                     & "                  ) EBASE                                                                                   " & vbNewLine _
                                     & "            WHERE EBASE.IDX = 1                                                                             " & vbNewLine _
                                     & "            ) TOPEDI                                                                                        " & vbNewLine _
                                     & "        ON TOPEDI.NRS_BR_CD    = OUTL.NRS_BR_CD                                                             " & vbNewLine _
                                     & "       AND TOPEDI.OUTKA_CTL_NO = OUTL.OUTKA_NO_L                                                            " & vbNewLine _
                                     & " LEFT JOIN $LM_TRN$..H_OUTKAEDI_L EDIL                                                                      " & vbNewLine _
                                     & "        ON EDIL.NRS_BR_CD  = TOPEDI.NRS_BR_CD                                                               " & vbNewLine _
                                     & "       AND EDIL.EDI_CTL_NO = TOPEDI.EDI_CTL_NO                                                              " & vbNewLine _
                                     & "--(2012.09.11)要望番号1412対応  ---  END  ---                                                               " & vbNewLine _
                                     & "--出荷M                                                                                                     " & vbNewLine _
                                     & "LEFT JOIN                                                                                                   " & vbNewLine _
                                     & "(SELECT                                                                                                     " & vbNewLine _
                                     & "*                                                                                                           " & vbNewLine _
                                     & "FROM                                                                                                        " & vbNewLine _
                                     & "(SELECT                                                                                                     " & vbNewLine _
                                     & "   NRS_BR_CD                                                                                                " & vbNewLine _
                                     & "  ,GOODS_CD_NRS                                                                                             " & vbNewLine _
                                     & "  ,IRIME                                                                                                    " & vbNewLine _
                                     & "  ,IRIME_UT                                                                                                 " & vbNewLine _
                                     & "  ,ALCTD_NB                                                                                                 " & vbNewLine _
                                     & "  ,ALCTD_QT                                                                                                 " & vbNewLine _
                                     & "  ,LOT_NO                                                                                                   " & vbNewLine _
                                     & "  ,SYS_DEL_FLG                                                                                              " & vbNewLine _
                                     & "  ,CUST_ORD_NO_DTL                                                                                          " & vbNewLine _
                                     & "  ,ROW_NUMBER() OVER (PARTITION BY NRS_BR_CD ORDER BY OUTKA_NO_L,OUTKA_NO_M) AS NUM                         " & vbNewLine _
                                     & "  ,OUTKA_NO_L                                                                                               " & vbNewLine _
                                     & "  ,OUTKA_NO_M                                                                                               " & vbNewLine _
                                     & "  FROM                                                                                                      " & vbNewLine _
                                     & "   $LM_TRN$..C_OUTKA_M M                                                                                    " & vbNewLine _
                                     & "  WHERE                                                                                                     " & vbNewLine _
                                     & "      M.NRS_BR_CD = @NRS_BR_CD                                                                              " & vbNewLine _
                                     & "  AND M.OUTKA_NO_L IN(@OUTKA_NO_L)                                                                          " & vbNewLine _
                                     & "  AND SYS_DEL_FLG = '0'                                                                                     " & vbNewLine _
                                     & " ) AS BASE                                                                                                  " & vbNewLine _
                                     & " WHERE                                                                                                      " & vbNewLine _
                                     & " BASE.NUM = 1                                                                                               " & vbNewLine _
                                     & ") OUTM                                                                                                      " & vbNewLine _
                                     & "ON                                                                                                          " & vbNewLine _
                                     & "1 = 1                                                                                                       " & vbNewLine _
                                     & "--F運送L                                                                                                    " & vbNewLine _
                                     & "LEFT JOIN $LM_TRN$..F_UNSO_L FL                                                                             " & vbNewLine _
                                     & "ON  FL.MOTO_DATA_KB   = '20'                                                                                " & vbNewLine _
                                     & "AND FL.NRS_BR_CD      = OUTL.NRS_BR_CD                                                                      " & vbNewLine _
                                     & "AND FL.INOUTKA_NO_L   = OUTL.OUTKA_NO_L                                                                     " & vbNewLine _
                                     & "AND FL.SYS_DEL_FLG    = '0'                                                                                 " & vbNewLine _
                                     & "--出荷EDI L                                                                                                 " & vbNewLine _
                                     & "--LEFT JOIN $LM_TRN$..H_OUTKAEDI_L OUTKAEDIL                                                                  " & vbNewLine _
                                     & "--ON  OUTKAEDIL.NRS_BR_CD     = OUTL.NRS_BR_CD                                                                " & vbNewLine _
                                     & "--AND OUTKAEDIL.OUTKA_CTL_NO  = OUTL.OUTKA_NO_L                                                               " & vbNewLine _
                                     & "--AND OUTKAEDIL.SYS_DEL_FLG   = '0'                                                                           " & vbNewLine _
                                     & "--商品M                                                                                                     " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_GOODS MG                                                                              " & vbNewLine _
                                     & "ON  MG.NRS_BR_CD     = OUTM.NRS_BR_CD                                                                       " & vbNewLine _
                                     & "AND MG.GOODS_CD_NRS  = OUTM.GOODS_CD_NRS                                                                    " & vbNewLine _
                                     & "AND MG.SYS_DEL_FLG   = '0'                                                                                  " & vbNewLine _
                                     & "--荷主なしでの運送会社荷主別送り状パターン取得                                                              " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_UNSO_CUST_RPT MCR1                                                                    " & vbNewLine _
                                     & "ON  FL.NRS_BR_CD     = MCR1.NRS_BR_CD                                                                       " & vbNewLine _
                                     & "AND FL.UNSO_CD       = MCR1.UNSOCO_CD                                                                       " & vbNewLine _
                                     & "AND FL.UNSO_BR_CD    = MCR1.UNSOCO_BR_CD                                                                    " & vbNewLine _
                                     & "AND '11'             = MCR1.PTN_ID                                                                          " & vbNewLine _
                                     & "AND FL.PC_KB         = MCR1.MOTO_TYAKU_KB                                                                   " & vbNewLine _
                                     & "AND ''               = MCR1.CUST_CD_L                                                                       " & vbNewLine _
                                     & "AND ''               = MCR1.CUST_CD_M                                                                       " & vbNewLine _
                                     & "AND MCR1.SYS_DEL_FLG = '0'                                                                                  " & vbNewLine _
                                     & "--帳票パターン取得                                                                                          " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_RPT MR1                                                                               " & vbNewLine _
                                     & "ON  MR1.NRS_BR_CD   = MCR1.NRS_BR_CD                                                                        " & vbNewLine _
                                     & "AND MR1.PTN_ID      = MCR1.PTN_ID                                                                           " & vbNewLine _
                                     & "AND MR1.PTN_CD      = MCR1.PTN_CD                                                                           " & vbNewLine _
                                     & "AND MR1.SYS_DEL_FLG = '0'                                                                                   " & vbNewLine _
                                     & "--荷主込みでの運送会社荷主別送り状パターン取得                                                              " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_UNSO_CUST_RPT MCR2                                                                    " & vbNewLine _
                                     & "ON  FL.NRS_BR_CD     = MCR2.NRS_BR_CD                                                                       " & vbNewLine _
                                     & "AND FL.UNSO_CD       = MCR2.UNSOCO_CD                                                                       " & vbNewLine _
                                     & "AND FL.UNSO_BR_CD    = MCR2.UNSOCO_BR_CD                                                                    " & vbNewLine _
                                     & "AND '11'             = MCR2.PTN_ID                                                                          " & vbNewLine _
                                     & "AND FL.PC_KB         = MCR2.MOTO_TYAKU_KB                                                                   " & vbNewLine _
                                     & "AND FL.CUST_CD_L     = MCR2.CUST_CD_L                                                                       " & vbNewLine _
                                     & "AND FL.CUST_CD_M     = MCR2.CUST_CD_M                                                                       " & vbNewLine _
                                     & "AND MCR2.SYS_DEL_FLG = '0'                                                                                  " & vbNewLine _
                                     & "--出荷Lでの荷主帳票パターン取得           ------** ADD Start/End 2018/08/02                                 " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_CUST_RPT MCR3                                                                         " & vbNewLine _
                                     & "  ON OUTL.NRS_BR_CD = MCR3.NRS_BR_CD                                                                         " & vbNewLine _
                                     & " AND OUTL.CUST_CD_L = MCR3.CUST_CD_L                                                                        " & vbNewLine _
                                     & " AND OUTL.CUST_CD_M = MCR3.CUST_CD_M                                                                        " & vbNewLine _
                                     & " AND '00'           = MCR3.CUST_CD_S                                                                        " & vbNewLine _
                                     & " AND MCR3.PTN_ID = '11'                                                                                     " & vbNewLine _
                                     & "--出荷Lでの帳票パターン取得               ------** ADD Start/End 2018/08/02                                    " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_RPT MR4                                                                                " & vbNewLine _
                                     & " ON  MR4.NRS_BR_CD     = MCR3.NRS_BR_CD                                                                     " & vbNewLine _
                                     & " AND MR4.PTN_ID        = MCR3.PTN_ID                                                                        " & vbNewLine _
                                     & " AND MR4.PTN_CD        = MCR3.PTN_CD                                                                        " & vbNewLine _
                                     & " AND MR4.STANDARD_FLAG = '00'                                                                               " & vbNewLine _
                                     & " AND MR4.SYS_DEL_FLG      = '0'                                  　　                                       " & vbNewLine _
                                     & "--帳票パターン取得                                                                                          " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_RPT MR2                                                                               " & vbNewLine _
                                     & "ON  MR2.NRS_BR_CD    = MCR2.NRS_BR_CD                                                                       " & vbNewLine _
                                     & "AND MR2.PTN_ID       = MCR2.PTN_ID                                                                          " & vbNewLine _
                                     & "AND MR2.PTN_CD       = MCR2.PTN_CD                                                                          " & vbNewLine _
                                     & "AND MR2.SYS_DEL_FLG  = '0'                                                                                  " & vbNewLine _
                                     & "--存在しない場合の帳票パターン取得                                                                          " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_RPT MR3                                                                               " & vbNewLine _
                                     & "ON  MR3.NRS_BR_CD     = OUTL.NRS_BR_CD                                                                      " & vbNewLine _
                                     & "AND MR3.PTN_ID        = '11'                                                                                " & vbNewLine _
                                     & "AND MR3.STANDARD_FLAG = '01'                                                                                " & vbNewLine _
                                     & "AND MR3.SYS_DEL_FLG   = '0'                                                                                 " & vbNewLine _
                                     & "--荷主マスタ (ここからメインプリント用)                                                               " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_CUST CST                                                                              " & vbNewLine _
                                     & "ON  CST.NRS_BR_CD     = MG.NRS_BR_CD                                                                        " & vbNewLine _
                                     & "AND CST.CUST_CD_L     = MG.CUST_CD_L                                                                        " & vbNewLine _
                                     & "AND CST.CUST_CD_M     = MG.CUST_CD_M                                                                        " & vbNewLine _
                                     & "AND CST.CUST_CD_S     = MG.CUST_CD_S                                                                        " & vbNewLine _
                                     & "AND CST.CUST_CD_SS    = MG.CUST_CD_SS                                                                       " & vbNewLine _
                                     & "AND CST.SYS_DEL_FLG   = '0'                                                                                 " & vbNewLine _
                                     & "--届先マスタ                                                                                                " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_DEST DST                                                                              " & vbNewLine _
                                     & "ON  DST.NRS_BR_CD     = OUTL.NRS_BR_CD                                                                      " & vbNewLine _
                                     & "AND DST.CUST_CD_L     = OUTL.CUST_CD_L                                                                      " & vbNewLine _
                                     & "AND DST.DEST_CD       = OUTL.DEST_CD                                                                        " & vbNewLine _
                                     & "AND DST.SYS_DEL_FLG   = '0'                                                                                 " & vbNewLine _
                                     & "--届先マスタ                                                                                                " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_DEST SHIPDST                                                                          " & vbNewLine _
                                     & "ON  SHIPDST.NRS_BR_CD     = OUTL.NRS_BR_CD                                                                  " & vbNewLine _
                                     & "AND SHIPDST.CUST_CD_L     = OUTL.CUST_CD_L                                                                  " & vbNewLine _
                                     & "AND SHIPDST.DEST_CD       = OUTL.SHIP_CD_L                                                                  " & vbNewLine _
                                     & "AND SHIPDST.SYS_DEL_FLG   = '0'                                                                             " & vbNewLine _
                                     & "--2018/03/07 001033 20180131【LMS】横浜BC帳票住所がYCCになっている対応 Annen upd start                      " & vbNewLine _
                                     & "--倉庫マスタ                                                                                                " & vbNewLine _
                                     & "LEFT JOIN LM_MST..M_SOKO SOKO                                                                               " & vbNewLine _
                                     & "ON OUTL.NRS_BR_CD = SOKO.NRS_BR_CD                                                                          " & vbNewLine _
                                     & "AND OUTL.WH_CD = SOKO.WH_CD                                                                                 " & vbNewLine _
                                     & "AND SOKO.SYS_DEL_FLG = '0'                                                                                  " & vbNewLine _
                                     & "--LEFT JOIN $LM_MST$..M_NRS_BR NB                                                                             " & vbNewLine _
                                     & "--営業所マスタ                                                                                              " & vbNewLine _
                                     & "--ON  NB.NRS_BR_CD      = OUTL.NRS_BR_CD                                                                      " & vbNewLine _
                                     & "--AND NB.SYS_DEL_FLG    = '0'                                                                                 " & vbNewLine _
                                     & "--2018/03/07 001033 20180131【LMS】横浜BC帳票住所がYCCになっている対応 Annen upd end                        " & vbNewLine _
                                     & "--商品明細                                                                                                  " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_GOODS_DETAILS MGD                                                                     " & vbNewLine _
                                     & "ON  MGD.NRS_BR_CD       = OUTM.NRS_BR_CD                                                                    " & vbNewLine _
                                     & "AND MGD.GOODS_CD_NRS    = OUTM.GOODS_CD_NRS                                                                 " & vbNewLine _
                                     & "AND MGD.SUB_KB          = '01'                                                                              " & vbNewLine _
                                     & "AND MGD.SYS_DEL_FLG     = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC560支店TEL(NM4)・支店名(NM3))KB01                                                           " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB01                                                                              " & vbNewLine _
                                     & "ON  KB01.KBN_GROUP_CD = 'O007'                                                                              " & vbNewLine _
                                     & "AND KB01.KBN_CD       = '01'                                                                                " & vbNewLine _
                                     & "AND KB01.SYS_DEL_FLG  = '0'                                                                                 " & vbNewLine _
                                     & "--区分マスタ(納期文言)KB02                                                                                  " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB02                                                                              " & vbNewLine _
                                     & "ON  KB02.KBN_GROUP_CD = 'N010'                                                                              " & vbNewLine _
                                     & "AND KB02.KBN_CD       = OUTL.ARR_PLAN_TIME                                                                  " & vbNewLine _
                                     & "AND KB02.SYS_DEL_FLG  = '0'                                                                                 " & vbNewLine _
                                     & "--区分マスタ(LMC563支店名(NM3)、電話番号(NM4))KB03                                                          " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB03                                                                              " & vbNewLine _
                                     & "ON  KB03.KBN_GROUP_CD = 'O007'                                                                              " & vbNewLine _
                                     & "AND KB03.KBN_CD       = '10'                                                                                " & vbNewLine _
                                     & "AND KB03.SYS_DEL_FLG  = '0'                                                                                 " & vbNewLine _
                                     & "--区分マスタ(LMC563支払支店コード(NM3))KB0401                                                               " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0401                                                                            " & vbNewLine _
                                     & "ON  KB0401.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0401.KBN_CD       = '11'                                                                              " & vbNewLine _
                                     & "AND KB0401.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC563支払支店コード(NM3))KB0402                                                               " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0402                                                                            " & vbNewLine _
                                     & "ON  KB0402.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0402.KBN_CD       = '12'                                                                              " & vbNewLine _
                                     & "AND KB0402.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC563支払支店コード(NM3))KB0403                                                               " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0403                                                                            " & vbNewLine _
                                     & "ON  KB0403.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0403.KBN_CD       = '13'                                                                              " & vbNewLine _
                                     & "AND KB0403.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC563支払支店コード(NM3))KB0404                                                               " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0404                                                                            " & vbNewLine _
                                     & "ON  KB0404.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0404.KBN_CD       = '14'                                                                              " & vbNewLine _
                                     & "AND KB0404.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC563支払支店コード(NM3))KB0405                                                               " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0405                                                                            " & vbNewLine _
                                     & "ON  KB0405.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0405.KBN_CD       = '15'                                                                              " & vbNewLine _
                                     & "AND KB0405.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC564支店TEL、荷主TEL(NM4)・支店名(NM3))KB05                                                  " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB05                                                                              " & vbNewLine _
                                     & "ON  KB05.KBN_GROUP_CD   = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB05.KBN_CD         = '02'                                                                              " & vbNewLine _
                                     & "AND KB05.SYS_DEL_FLG    = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC565支払いコード(NM3)KB0601)                                                                 " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0601                                                                            " & vbNewLine _
                                     & "ON  KB0601.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0601.KBN_CD       = '07'                                                                              " & vbNewLine _
                                     & "AND KB0601.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC565支払いコード(NM3)KB0602)                                                                 " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0602                                                                            " & vbNewLine _
                                     & "ON  KB0602.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0602.KBN_CD       = '08'                                                                              " & vbNewLine _
                                     & "AND KB0602.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC568荷主コード(NM5)KB0701                                                                    " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0701                                                                            " & vbNewLine _
                                     & "ON  KB0701.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0701.KBN_CD       = '03'                                                                              " & vbNewLine _
                                     & "AND KB0701.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC568荷主コード(NM5)KB0702                                                                    " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0702                                                                            " & vbNewLine _
                                     & "ON  KB0702.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0702.KBN_CD       = '09'                                                                              " & vbNewLine _
                                     & "AND KB0702.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC569固定表示(NM1,3,4))KB08                                                                   " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB08                                                                              " & vbNewLine _
                                     & "ON  KB08.KBN_GROUP_CD   = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB08.KBN_CD         = '04'                                                                              " & vbNewLine _
                                     & "AND KB08.SYS_DEL_FLG    = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC570支店名(NM3)支店TEL(NM4))KB1001                                                           " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB1001                                                                            " & vbNewLine _
                                     & "ON  KB1001.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB1001.KBN_CD       = '05'                                                                              " & vbNewLine _
                                     & "AND KB1001.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC570支店名(NM3)支店TEL(NM4))KB1002                                                           " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB1002                                                                            " & vbNewLine _
                                     & "ON  KB1002.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB1002.KBN_CD       = '06'                                                                              " & vbNewLine _
                                     & "AND KB1002.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--荷主明細マスタ(LMC573にて運送契約荷主コード取得)                                                          " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_CUST_DETAILS CUSTDTL                                                                  " & vbNewLine _
                                     & "ON  CUSTDTL.NRS_BR_CD    = OUTL.NRS_BR_CD                                                                   " & vbNewLine _
                                     & "AND CUSTDTL.CUST_CD      = OUTL.CUST_CD_L + OUTL.CUST_CD_M                                                  " & vbNewLine _
                                     & "AND CUSTDTL.SUB_KB       = '03'                                                                             " & vbNewLine _
                                     & "AND CUSTDTL.SYS_DEL_FLG  = '0'                                                                              " & vbNewLine _
                                     & "--区分マスタ(LMC575支払コード(NM3)KB0801)                                                                   " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0801                                                                            " & vbNewLine _
                                     & "ON  KB0801.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0801.KBN_CD       = '16'                                                                              " & vbNewLine _
                                     & "AND KB0801.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC575支払コード(NM3)KB0802)                                                                   " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0802                                                                            " & vbNewLine _
                                     & "ON  KB0802.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0802.KBN_CD       = '17'                                                                              " & vbNewLine _
                                     & "AND KB0802.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC670 KB0803)                                                                                 " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0803                                                                            " & vbNewLine _
                                     & "ON  KB0803.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0803.KBN_CD       = '18'                                                                              " & vbNewLine _
                                     & "AND KB0803.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_DEST      DEST_JIS --2012.05.25                                                       " & vbNewLine _
                                     & "ON  DEST_JIS.NRS_BR_CD    = OUTL.NRS_BR_CD                                                                  " & vbNewLine _
                                     & "AND DEST_JIS.CUST_CD_L    = OUTL.CUST_CD_L                                                                  " & vbNewLine _
                                     & "AND DEST_JIS.DEST_CD      = OUTL.DEST_CD                                                                    " & vbNewLine _
                                     & "AND DEST_JIS.SYS_DEL_FLG  = '0'                                                                             " & vbNewLine _
                                     & "--JISマスタ(LMC661にてJIS_CD2桁：都道府県コード取得)2012.05.25                                              " & vbNewLine _
                                     & "  LEFT JOIN  $LM_MST$..M_JIS   JIS                                                                          " & vbNewLine _
                                     & "  ON  JIS.JIS_CD       = DEST_JIS.JIS                                                                       " & vbNewLine _
                                     & " AND  JIS.SYS_DEL_FLG  = '0'                                                                                " & vbNewLine _
                                     & "--運送会社マスタ(LMC589にてUNSOCO_NM：取次先運送会社名取得)2012.05.25                                       " & vbNewLine _
                                     & "--  LEFT JOIN  $LM_MST$..M_UNSOCO   MUC                                                                     " & vbNewLine _
                                     & "--  ON  MUC.NRS_BR_CD    = FL.NRS_BR_CD                                                                     " & vbNewLine _
                                     & "-- AND  MUC.UNSOCO_CD    = FL.UNSO_CD                                                                       " & vbNewLine _
                                     & "-- AND  MUC.UNSOCO_BR_CD = FL.UNSO_BR_CD                                                                    " & vbNewLine _
                                     & "-- AND  MUC.SYS_DEL_FLG  = '0'                                                                              " & vbNewLine _
                                     & "--荷主明細マスタ(LMC660にてSET_NAIYO：支払コード取得)2012.05.25                                             " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_CUST_DETAILS MCD_SAI                                                                  " & vbNewLine _
                                     & "ON  MCD_SAI.NRS_BR_CD    = OUTL.NRS_BR_CD                                                                   " & vbNewLine _
                                     & "AND MCD_SAI.CUST_CD      = OUTL.CUST_CD_L                                                                   " & vbNewLine _
                                     & "--AND MCD_SAI.CUST_CD_EDA  = OUTL.CUST_CD_M                                                                   " & vbNewLine _
                                     & "AND MCD_SAI.SUB_KB       = '27'                                                                             " & vbNewLine _
                                     & "AND MCD_SAI.SYS_DEL_FLG  = '0'                                                                              " & vbNewLine _
                                     & "--荷主明細マスタ(LMC669にてSET_NAIYO：荷送人名称取得)2012.06.01                                             " & vbNewLine _
                                     & "  LEFT JOIN $LM_MST$..M_CUST_DETAILS MCD_NFC                                                                " & vbNewLine _
                                     & "ON MCD_NFC.NRS_BR_CD   = OUTL.NRS_BR_CD                                                                     " & vbNewLine _
                                     & "AND MCD_NFC.CUST_CD      = OUTL.CUST_CD_L                                                                   " & vbNewLine _
                                     & "--AND MCD_NFC.CUST_CD_EDA  = OUTL.CUST_CD_M  --notes 1118                                                   " & vbNewLine _
                                     & "AND MCD_NFC.SUB_KB       = '29'                                                                             " & vbNewLine _
                                     & "AND MCD_NFC.SYS_DEL_FLG  = '0'                                                                              " & vbNewLine _
                                     & "--WHERE                                                                                                       " & vbNewLine _
                                     & "--    OUTL.SYS_DEL_FLG    = '0'                                                                               " & vbNewLine _
                                     & "--AND OUTL.NRS_BR_CD      = @NRS_BR_CD                                                                        " & vbNewLine _
                                     & "--AND OUTL.OUTKA_NO_L IN(@OUTKA_NO_L)                                                                         " & vbNewLine _
                                     & " --要望番号1383 [LMC664] --- START ---                                                                      " & vbNewLine _
                                     & "LEFT JOIN (SELECT NRS_BR_CD   AS NRS_BR_CD                                                                  " & vbNewLine _
                                     & "                 , CUST_CD     AS CUST_CD                                                                   " & vbNewLine _
                                     & "                 , CUST_CLASS  AS CUST_CLASS                                                                " & vbNewLine _
                                     & "                 , SET_NAIYO   AS CUST_NAIYO_1                                                              " & vbNewLine _
                                     & "                 , SET_NAIYO_2 AS CUST_NAIYO_2                                                              " & vbNewLine _
                                     & "                 , SET_NAIYO_3 AS CUST_NAIYO_3                                                              " & vbNewLine _
                                     & "              FROM $LM_MST$..M_CUST_DETAILS                                                                 " & vbNewLine _
                                     & "             WHERE SUB_KB ='42'                                                                             " & vbNewLine _
                                     & "               AND SET_NAIYO_2 = @RPT_ID                                                                    " & vbNewLine _
                                     & "               AND SYS_DEL_FLG = '0'                                                                        " & vbNewLine _
                                     & "            ) MCD_CUST                                                                                      " & vbNewLine _
                                     & "        ON CST.NRS_BR_CD = MCD_CUST.NRS_BR_CD                                                               " & vbNewLine _
                                     & "       AND (CASE WHEN MCD_CUST.CUST_CLASS='00' THEN  CST.CUST_CD_L                                                   " & vbNewLine _
                                     & "                 WHEN MCD_CUST.CUST_CLASS='01' THEN (CST.CUST_CD_L + CST.CUST_CD_M)                                  " & vbNewLine _
                                     & "                 WHEN MCD_CUST.CUST_CLASS='02' THEN (CST.CUST_CD_L + CST.CUST_CD_M + CST.CUST_CD_S)                  " & vbNewLine _
                                     & "                 WHEN MCD_CUST.CUST_CLASS='03' THEN (CST.CUST_CD_L + CST.CUST_CD_M + CST.CUST_CD_S + CST.CUST_CD_SS) " & vbNewLine _
                                     & "            END                                                                                             " & vbNewLine _
                                     & "           ) = MCD_CUST.CUST_CD                                                                             " & vbNewLine _
                                     & " --要望番号1383 [LMC664] --- END ---                                                                        " & vbNewLine _
                                     & " --省略商品名対応 2018.08.15                                                                                " & vbNewLine _
                                     & " LEFT JOIN $LM_MST$..M_GOODS_DETAILS MGD2    																" & vbNewLine _
                                     & " ON  MGD2.NRS_BR_CD       = OUTM.NRS_BR_CD   																" & vbNewLine _
                                     & " AND MGD2.GOODS_CD_NRS    = OUTM.GOODS_CD_NRS																" & vbNewLine _
                                     & " AND MGD2.SUB_KB          = '66'             																" & vbNewLine _
                                     & " AND MGD2.SYS_DEL_FLG     = '0'                                                                             " & vbNewLine


    ''' <summary>
    ''' データ抽出用FROM句浮間用(☆★作業用コメント：20110711)
    ''' 明細出力のため、SQL_FROMにあった"WHERE BASE.NUM=をコメントアウトし、
    ''' 商品分だけレコードを出力。
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_FROM_UKIMA_MATOME As String = "FROM                                                                                           " & vbNewLine _
                                     & "$LM_TRN$..C_OUTKA_L OUTL                                                                                    " & vbNewLine _
                                     & "--(2012.09.11)要望番号1412対応  --- START ---                                                               " & vbNewLine _
                                     & "--出荷EDIL                                                                                                  " & vbNewLine _
                                     & "--LEFT JOIN                                                                                                 " & vbNewLine _
                                     & "-- (                                                                                                        " & vbNewLine _
                                     & "--  SELECT                                                                                                  " & vbNewLine _
                                     & "--        MIN(DEST_AD_1)   AS DEST_AD_1                                                                     " & vbNewLine _
                                     & "--       ,MIN(DEST_AD_2)   AS DEST_AD_2                                                                     " & vbNewLine _
                                     & "--       ,DEST_AD_3                                                                                         " & vbNewLine _
                                     & "--       ,DEST_TEL                                                                                          " & vbNewLine _
                                     & "--       ,DEST_ZIP                                                                                          " & vbNewLine _
                                     & "--       ,FREE_C15                                                                                          " & vbNewLine _
                                     & "--       ,MIN(DEST_NM)     AS DEST_NM                                                                       " & vbNewLine _
                                     & "--       ,NRS_BR_CD                                                                                         " & vbNewLine _
                                     & "--       ,OUTKA_CTL_NO                                                                                      " & vbNewLine _
                                     & "--       ,SHIP_NM_L                                                                                         " & vbNewLine _
                                     & "--       ,SYS_DEL_FLG                                                                                       " & vbNewLine _
                                     & "--       ,FREE_C05                                                                                          " & vbNewLine _
                                     & "--       --,REMARK                    --2012.07.24 丸和運輸　荷受人氏名下の注意書き                         " & vbNewLine _
                                     & "--       ,MIN(REMARK)      AS REMARK  --2012.08.21 要望番号1355                                             " & vbNewLine _
                                     & "--  FROM                                                                                                    " & vbNewLine _
                                     & "--        $LM_TRN$..H_OUTKAEDI_L                                                                            " & vbNewLine _
                                     & "--  GROUP BY                                                                                                " & vbNewLine _
                                     & "--        DEST_AD_3                                                                                         " & vbNewLine _
                                     & "--       ,DEST_TEL                                                                                          " & vbNewLine _
                                     & "--       ,DEST_ZIP                                                                                          " & vbNewLine _
                                     & "--       ,FREE_C15                                                                                          " & vbNewLine _
                                     & "--       ,NRS_BR_CD                                                                                         " & vbNewLine _
                                     & "--       ,OUTKA_CTL_NO                                                                                      " & vbNewLine _
                                     & "--       ,SHIP_NM_L                                                                                         " & vbNewLine _
                                     & "--       ,SYS_DEL_FLG                                                                                       " & vbNewLine _
                                     & "--       ,FREE_C05                                                                                          " & vbNewLine _
                                     & "--       --,REMARK   --2012.07.24 丸和運輸　荷受人氏名下の注意書き   2012.08.21 要望番号1355 コメント化     " & vbNewLine _
                                     & "-- )                                                                                                        " & vbNewLine _
                                     & "--  EDIL                                                                                                    " & vbNewLine _
                                     & "--ON   EDIL.NRS_BR_CD   = OUTL.NRS_BR_CD                                                                    " & vbNewLine _
                                     & "--AND EDIL.OUTKA_CTL_NO = OUTL.OUTKA_NO_L                                                                   " & vbNewLine _
                                     & "--AND EDIL.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--AND EDIL.NRS_BR_CD    = OUTL.NRS_BR_CD                                                                    " & vbNewLine _
                                     & "--下記の内容に変更                                                                                          " & vbNewLine _
                                     & " LEFT JOIN (                                                                                                " & vbNewLine _
                                     & "            SELECT                                                                                          " & vbNewLine _
                                     & "                   NRS_BR_CD                                                                                " & vbNewLine _
                                     & "                 , EDI_CTL_NO                                                                               " & vbNewLine _
                                     & "                 , OUTKA_CTL_NO                                                                             " & vbNewLine _
                                     & "             FROM (                                                                                         " & vbNewLine _
                                     & "                    SELECT                                                                                  " & vbNewLine _
                                     & "                           EDIOUTL.NRS_BR_CD                                                                " & vbNewLine _
                                     & "                         , EDIOUTL.EDI_CTL_NO                                                               " & vbNewLine _
                                     & "                         , EDIOUTL.OUTKA_CTL_NO                                                             " & vbNewLine _
                                     & "                         , CASE WHEN EDIOUTL.OUTKA_CTL_NO = '' THEN 1                                       " & vbNewLine _
                                     & "                           ELSE ROW_NUMBER() OVER (PARTITION BY EDIOUTL.NRS_BR_CD                           " & vbNewLine _
                                     & "                                                              , EDIOUTL.OUTKA_CTL_NO                        " & vbNewLine _
                                     & "                                                       ORDER BY EDIOUTL.NRS_BR_CD                           " & vbNewLine _
                                     & "                                                              , EDIOUTL.EDI_CTL_NO                          " & vbNewLine _
                                     & "                                                  )                                                         " & vbNewLine _
                                     & "                           END AS IDX                                                                       " & vbNewLine _
                                     & "                      FROM $LM_TRN$..H_OUTKAEDI_L EDIOUTL                                                   " & vbNewLine _
                                     & "                     WHERE EDIOUTL.SYS_DEL_FLG  = '0'                                                       " & vbNewLine _
                                     & "                       AND EDIOUTL.NRS_BR_CD    = @NRS_BR_CD                                                " & vbNewLine _
                                     & "--要望管理1451                   AND EDIOUTL.OUTKA_CTL_NO = @OUTKA_NO_L                                               " & vbNewLine _
                                     & "                   ) EBASE                                                                                  " & vbNewLine _
                                     & "            WHERE EBASE.IDX = 1                                                                             " & vbNewLine _
                                     & "            ) TOPEDI                                                                                        " & vbNewLine _
                                     & "        ON TOPEDI.NRS_BR_CD    = OUTL.NRS_BR_CD                                                             " & vbNewLine _
                                     & "       AND TOPEDI.OUTKA_CTL_NO = OUTL.OUTKA_NO_L                                                            " & vbNewLine _
                                     & " LEFT JOIN $LM_TRN$..H_OUTKAEDI_L EDIL                                                                      " & vbNewLine _
                                     & "        ON EDIL.NRS_BR_CD  = TOPEDI.NRS_BR_CD                                                               " & vbNewLine _
                                     & "       AND EDIL.EDI_CTL_NO = TOPEDI.EDI_CTL_NO                                                              " & vbNewLine _
                                     & "--(2012.09.11)要望番号1412対応  ---  END  ---                                                               " & vbNewLine _
                                     & "--出荷M                                                                                                     " & vbNewLine _
                                     & "LEFT JOIN                                                                                                   " & vbNewLine _
                                     & "(SELECT                                                                                                     " & vbNewLine _
                                     & "*                                                                                                           " & vbNewLine _
                                     & "FROM                                                                                                        " & vbNewLine _
                                     & "(SELECT                                                                                                     " & vbNewLine _
                                     & "--(2012.06.18)要望番号1160対応 --- START ----                                                               " & vbNewLine _
                                     & "--   NRS_BR_CD                                                                                              " & vbNewLine _
                                     & "--  ,GOODS_CD_NRS                                                                                           " & vbNewLine _
                                     & "--  ,IRIME                                                                                                  " & vbNewLine _
                                     & "--  ,IRIME_UT                                                                                               " & vbNewLine _
                                     & "--  ,ALCTD_NB                                                                                               " & vbNewLine _
                                     & "--  ,LOT_NO                                                                                                 " & vbNewLine _
                                     & "--  ,CUST_ORD_NO_DTL   --2012/06/11浮間対応                                                                 " & vbNewLine _
                                     & "--  ,SYS_DEL_FLG                                                                                            " & vbNewLine _
                                     & "--  ,ROW_NUMBER() OVER (PARTITION BY NRS_BR_CD ORDER BY OUTKA_NO_L,OUTKA_NO_M) AS NUM                       " & vbNewLine _
                                     & "   M.NRS_BR_CD                                                                                              " & vbNewLine _
                                     & "  ,M.GOODS_CD_NRS                                                                                           " & vbNewLine _
                                     & "  ,M.IRIME                                                                                                  " & vbNewLine _
                                     & "  ,M.IRIME_UT                                                                                               " & vbNewLine _
                                     & "  ,M.ALCTD_NB                                                                                               " & vbNewLine _
                                     & "  ,M.ALCTD_QT                                                                                              " & vbNewLine _
                                     & "  ,M.LOT_NO                                                                                                 " & vbNewLine _
                                     & "  ,M.CUST_ORD_NO_DTL   --2012/06/11浮間対応                                                                 " & vbNewLine _
                                     & "  ,M.SYS_DEL_FLG                                                                                            " & vbNewLine _
                                     & "  ,ROW_NUMBER() OVER (PARTITION BY M.NRS_BR_CD ORDER BY M.OUTKA_NO_L,M.OUTKA_NO_M) AS NUM                   " & vbNewLine _
                                     & "  ,M.OUTKA_NO_L                                                                                             " & vbNewLine _
                                     & "  ,M.OUTKA_NO_M                                                                                             " & vbNewLine _
                                     & "  ,M.PRINT_SORT                                                                                             " & vbNewLine _
                                     & "  FROM                                                                                                      " & vbNewLine _
                                     & "--(2012.06.18)要望番号1160対応 ---  END  ----                                                               " & vbNewLine _
                                     & "   $LM_TRN$..C_OUTKA_M M                                                                                    " & vbNewLine _
                                     & "--(2012.06.18)要望番号1160対応 --- START ----                                                               " & vbNewLine _
                                     & "   LEFT JOIN $LM_TRN$..C_OUTKA_L OUTL                                                                       " & vbNewLine _
                                     & "          ON OUTL.NRS_BR_CD  = M.NRS_BR_CD                                                                  " & vbNewLine _
                                     & "         AND OUTL.OUTKA_NO_L = M.OUTKA_NO_L                                                                 " & vbNewLine _
                                     & "         AND OUTL.SYS_DEL_FLG  = '0'                                                                        " & vbNewLine _
                                     & "   LEFT JOIN $LM_TRN$..F_UNSO_L FL                                                                          " & vbNewLine _
                                     & "          ON FL.NRS_BR_CD    = M.NRS_BR_CD                                                                  " & vbNewLine _
                                     & "         AND FL.INOUTKA_NO_L = M.OUTKA_NO_L                                                                 " & vbNewLine _
                                     & "         AND FL.MOTO_DATA_KB = '20'                                                                         " & vbNewLine _
                                     & "         AND FL.SYS_DEL_FLG  = '0'                                                                          " & vbNewLine _
                                     & "--(2012.06.18)要望番号1160対応 ---  END  ----                                                               " & vbNewLine _
                                     & "  WHERE                                                                                                     " & vbNewLine _
                                     & "      M.NRS_BR_CD = @NRS_BR_CD                                                                              " & vbNewLine _
                                     & "--(2012.06.18)要望番号1160対応 --- START ----                                                               " & vbNewLine _
                                     & "    AND OUTL.CUST_CD_L       = @CUST_CD_L                                                                   " & vbNewLine _
                                     & "    AND OUTL.CUST_CD_M       = @CUST_CD_M                                                                   " & vbNewLine _
                                     & "    AND OUTL.OUTKA_PLAN_DATE = @OUTKA_PLAN_DATE                                                             " & vbNewLine _
                                     & "    AND OUTL.ARR_PLAN_DATE   = @ARR_PLAN_DATE                                                               " & vbNewLine _
                                     & "    AND FL.UNSO_CD           = @UNSO_CD                                                                     " & vbNewLine _
                                     & "    AND FL.UNSO_BR_CD        = @UNSO_BR_CD                                                                  " & vbNewLine _
                                     & "    AND OUTL.DEST_CD         = @DEST_CD                                                                     " & vbNewLine _
                                     & "--  AND M.OUTKA_NO_L IN(@OUTKA_NO_L)                                                                        " & vbNewLine _
                                     & "--  AND SYS_DEL_FLG = '0'                                                                                   " & vbNewLine _
                                     & "    AND M.SYS_DEL_FLG = '0'                                                                                 " & vbNewLine _
                                     & "--(2012.06.18)要望番号1160対応 ---  END  ----                                                               " & vbNewLine _
                                     & " ) AS BASE                                                                                                  " & vbNewLine _
                                     & "-- WHERE                                                                                                    " & vbNewLine _
                                     & "-- BASE.NUM = 1                                                                                             " & vbNewLine _
                                     & ") OUTM                                                                                                      " & vbNewLine _
                                     & "--ON                                                                                                        " & vbNewLine _
                                     & "--1 = 1                                                                                                     " & vbNewLine _
                                     & "--(2012.06.18)要望番号1160対応 --- START ----                                                               " & vbNewLine _
                                     & " ON OUTL.NRS_BR_CD  = OUTM.NRS_BR_CD                                                                        " & vbNewLine _
                                     & "AND OUTL.OUTKA_NO_L = OUTM.OUTKA_NO_L                                                                       " & vbNewLine _
                                     & "--(2012.06.18)要望番号1160対応 ---  END  ----                                                               " & vbNewLine _
                                     & "--F運送L                                                                                                    " & vbNewLine _
                                     & "LEFT JOIN $LM_TRN$..F_UNSO_L FL                                                                             " & vbNewLine _
                                     & "ON  FL.MOTO_DATA_KB   = '20'                                                                                " & vbNewLine _
                                     & "AND FL.NRS_BR_CD      = OUTL.NRS_BR_CD                                                                      " & vbNewLine _
                                     & "AND FL.INOUTKA_NO_L   = OUTL.OUTKA_NO_L                                                                     " & vbNewLine _
                                     & "AND FL.SYS_DEL_FLG    = '0'                                                                                 " & vbNewLine _
                                     & "--出荷EDI L                                                                                                 " & vbNewLine _
                                     & "--LEFT JOIN $LM_TRN$..H_OUTKAEDI_L OUTKAEDIL                                                                  " & vbNewLine _
                                     & "--ON  OUTKAEDIL.NRS_BR_CD     = OUTL.NRS_BR_CD                                                                " & vbNewLine _
                                     & "--AND OUTKAEDIL.OUTKA_CTL_NO  = OUTL.OUTKA_NO_L                                                               " & vbNewLine _
                                     & "--AND OUTKAEDIL.SYS_DEL_FLG   = '0'                                                                           " & vbNewLine _
                                     & "--商品M                                                                                                     " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_GOODS MG                                                                              " & vbNewLine _
                                     & "ON  MG.NRS_BR_CD     = OUTM.NRS_BR_CD                                                                       " & vbNewLine _
                                     & "AND MG.GOODS_CD_NRS  = OUTM.GOODS_CD_NRS                                                                    " & vbNewLine _
                                     & "AND MG.SYS_DEL_FLG   = '0'                                                                                  " & vbNewLine _
                                     & "--荷主なしでの運送会社荷主別送り状パターン取得                                                              " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_UNSO_CUST_RPT MCR1                                                                    " & vbNewLine _
                                     & "ON  FL.NRS_BR_CD     = MCR1.NRS_BR_CD                                                                       " & vbNewLine _
                                     & "AND FL.UNSO_CD       = MCR1.UNSOCO_CD                                                                       " & vbNewLine _
                                     & "AND FL.UNSO_BR_CD    = MCR1.UNSOCO_BR_CD                                                                    " & vbNewLine _
                                     & "AND '11'             = MCR1.PTN_ID                                                                          " & vbNewLine _
                                     & "AND FL.PC_KB         = MCR1.MOTO_TYAKU_KB                                                                   " & vbNewLine _
                                     & "AND ''               = MCR1.CUST_CD_L                                                                       " & vbNewLine _
                                     & "AND ''               = MCR1.CUST_CD_M                                                                       " & vbNewLine _
                                     & "AND MCR1.SYS_DEL_FLG = '0'                                                                                  " & vbNewLine _
                                     & "--帳票パターン取得                                                                                          " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_RPT MR1                                                                               " & vbNewLine _
                                     & "ON  MR1.NRS_BR_CD   = MCR1.NRS_BR_CD                                                                        " & vbNewLine _
                                     & "AND MR1.PTN_ID      = MCR1.PTN_ID                                                                           " & vbNewLine _
                                     & "AND MR1.PTN_CD      = MCR1.PTN_CD                                                                           " & vbNewLine _
                                     & "AND MR1.SYS_DEL_FLG = '0'                                                                                   " & vbNewLine _
                                     & "--荷主込みでの運送会社荷主別送り状パターン取得                                                              " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_UNSO_CUST_RPT MCR2                                                                    " & vbNewLine _
                                     & "ON  FL.NRS_BR_CD     = MCR2.NRS_BR_CD                                                                       " & vbNewLine _
                                     & "AND FL.UNSO_CD       = MCR2.UNSOCO_CD                                                                       " & vbNewLine _
                                     & "AND FL.UNSO_BR_CD    = MCR2.UNSOCO_BR_CD                                                                    " & vbNewLine _
                                     & "AND '11'             = MCR2.PTN_ID                                                                          " & vbNewLine _
                                     & "AND FL.PC_KB         = MCR2.MOTO_TYAKU_KB                                                                   " & vbNewLine _
                                     & "AND FL.CUST_CD_L     = MCR2.CUST_CD_L                                                                       " & vbNewLine _
                                     & "AND FL.CUST_CD_M     = MCR2.CUST_CD_M                                                                       " & vbNewLine _
                                     & "AND MCR2.SYS_DEL_FLG = '0'                                                                                  " & vbNewLine _
                                     & "--帳票パターン取得                                                                                          " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_RPT MR2                                                                               " & vbNewLine _
                                     & "ON  MR2.NRS_BR_CD    = MCR2.NRS_BR_CD                                                                       " & vbNewLine _
                                     & "AND MR2.PTN_ID       = MCR2.PTN_ID                                                                          " & vbNewLine _
                                     & "AND MR2.PTN_CD       = MCR2.PTN_CD                                                                          " & vbNewLine _
                                     & "AND MR2.SYS_DEL_FLG  = '0'                                                                                  " & vbNewLine _
                                     & "--存在しない場合の帳票パターン取得                                                                          " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_RPT MR3                                                                               " & vbNewLine _
                                     & "ON  MR3.NRS_BR_CD     = OUTL.NRS_BR_CD                                                                      " & vbNewLine _
                                     & "AND MR3.PTN_ID        = '11'                                                                                " & vbNewLine _
                                     & "AND MR3.STANDARD_FLAG = '01'                                                                                " & vbNewLine _
                                     & "AND MR3.SYS_DEL_FLG   = '0'                                                                                 " & vbNewLine _
                                     & "--荷主マスタ (ここからメインプリント用)                                                               " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_CUST CST                                                                              " & vbNewLine _
                                     & "ON  CST.NRS_BR_CD     = MG.NRS_BR_CD                                                                        " & vbNewLine _
                                     & "AND CST.CUST_CD_L     = MG.CUST_CD_L                                                                        " & vbNewLine _
                                     & "AND CST.CUST_CD_M     = MG.CUST_CD_M                                                                        " & vbNewLine _
                                     & "AND CST.CUST_CD_S     = MG.CUST_CD_S                                                                        " & vbNewLine _
                                     & "AND CST.CUST_CD_SS    = MG.CUST_CD_SS                                                                       " & vbNewLine _
                                     & "AND CST.SYS_DEL_FLG   = '0'                                                                                 " & vbNewLine _
                                     & "--届先マスタ                                                                                                " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_DEST DST                                                                              " & vbNewLine _
                                     & "ON  DST.NRS_BR_CD     = OUTL.NRS_BR_CD                                                                      " & vbNewLine _
                                     & "AND DST.CUST_CD_L     = OUTL.CUST_CD_L                                                                      " & vbNewLine _
                                     & "AND DST.DEST_CD       = OUTL.DEST_CD                                                                        " & vbNewLine _
                                     & "AND DST.SYS_DEL_FLG   = '0'                                                                                 " & vbNewLine _
                                     & "--届先マスタ                                                                                                " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_DEST SHIPDST                                                                          " & vbNewLine _
                                     & "ON  SHIPDST.NRS_BR_CD     = OUTL.NRS_BR_CD                                                                  " & vbNewLine _
                                     & "AND SHIPDST.CUST_CD_L     = OUTL.CUST_CD_L                                                                  " & vbNewLine _
                                     & "AND SHIPDST.DEST_CD       = OUTL.SHIP_CD_L                                                                  " & vbNewLine _
                                     & "AND SHIPDST.SYS_DEL_FLG   = '0'                                                                             " & vbNewLine _
                                     & "--2018/03/07 001033 20180131【LMS】横浜BC帳票住所がYCCになっている対応 Annen upd start                      " & vbNewLine _
                                     & "--倉庫マスタ                                                                                                " & vbNewLine _
                                     & "LEFT JOIN LM_MST..M_SOKO SOKO                                                                               " & vbNewLine _
                                     & "ON OUTL.NRS_BR_CD = SOKO.NRS_BR_CD                                                                          " & vbNewLine _
                                     & "AND OUTL.WH_CD = SOKO.WH_CD                                                                                 " & vbNewLine _
                                     & "AND SOKO.SYS_DEL_FLG = '0'                                                                                  " & vbNewLine _
                                     & "--営業所マスタ                                                                                              " & vbNewLine _
                                     & "--LEFT JOIN $LM_MST$..M_NRS_BR NB                                                                             " & vbNewLine _
                                     & "--ON  NB.NRS_BR_CD      = OUTL.NRS_BR_CD                                                                      " & vbNewLine _
                                     & "--AND NB.SYS_DEL_FLG    = '0'                                                                                 " & vbNewLine _
                                     & "--2018/03/07 001033 20180131【LMS】横浜BC帳票住所がYCCになっている対応 Annen upd end                        " & vbNewLine _
                                     & "--商品明細                                                                                                  " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_GOODS_DETAILS MGD                                                                     " & vbNewLine _
                                     & "ON  MGD.NRS_BR_CD       = OUTM.NRS_BR_CD                                                                    " & vbNewLine _
                                     & "AND MGD.GOODS_CD_NRS    = OUTM.GOODS_CD_NRS                                                                 " & vbNewLine _
                                     & "AND MGD.SUB_KB          = '01'                                                                              " & vbNewLine _
                                     & "AND MGD.SYS_DEL_FLG     = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC560支店TEL(NM4)・支店名(NM3))KB01                                                           " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB01                                                                              " & vbNewLine _
                                     & "ON  KB01.KBN_GROUP_CD = 'O007'                                                                              " & vbNewLine _
                                     & "AND KB01.KBN_CD       = '01'                                                                                " & vbNewLine _
                                     & "AND KB01.SYS_DEL_FLG  = '0'                                                                                 " & vbNewLine _
                                     & "--区分マスタ(納期文言)KB02                                                                                  " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB02                                                                              " & vbNewLine _
                                     & "ON  KB02.KBN_GROUP_CD = 'N010'                                                                              " & vbNewLine _
                                     & "AND KB02.KBN_CD       = OUTL.ARR_PLAN_TIME                                                                  " & vbNewLine _
                                     & "AND KB02.SYS_DEL_FLG  = '0'                                                                                 " & vbNewLine _
                                     & "--区分マスタ(LMC563支店名(NM3)、電話番号(NM4))KB03                                                          " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB03                                                                              " & vbNewLine _
                                     & "ON  KB03.KBN_GROUP_CD = 'O007'                                                                              " & vbNewLine _
                                     & "AND KB03.KBN_CD       = '10'                                                                                " & vbNewLine _
                                     & "AND KB03.SYS_DEL_FLG  = '0'                                                                                 " & vbNewLine _
                                     & "--区分マスタ(LMC563支払支店コード(NM3))KB0401                                                               " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0401                                                                            " & vbNewLine _
                                     & "ON  KB0401.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0401.KBN_CD       = '11'                                                                              " & vbNewLine _
                                     & "AND KB0401.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC563支払支店コード(NM3))KB0402                                                               " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0402                                                                            " & vbNewLine _
                                     & "ON  KB0402.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0402.KBN_CD       = '12'                                                                              " & vbNewLine _
                                     & "AND KB0402.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC563支払支店コード(NM3))KB0403                                                               " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0403                                                                            " & vbNewLine _
                                     & "ON  KB0403.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0403.KBN_CD       = '13'                                                                              " & vbNewLine _
                                     & "AND KB0403.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC563支払支店コード(NM3))KB0404                                                               " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0404                                                                            " & vbNewLine _
                                     & "ON  KB0404.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0404.KBN_CD       = '14'                                                                              " & vbNewLine _
                                     & "AND KB0404.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC563支払支店コード(NM3))KB0405                                                               " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0405                                                                            " & vbNewLine _
                                     & "ON  KB0405.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0405.KBN_CD       = '15'                                                                              " & vbNewLine _
                                     & "AND KB0405.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC564支店TEL、荷主TEL(NM4)・支店名(NM3))KB05                                                  " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB05                                                                              " & vbNewLine _
                                     & "ON  KB05.KBN_GROUP_CD   = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB05.KBN_CD         = '02'                                                                              " & vbNewLine _
                                     & "AND KB05.SYS_DEL_FLG    = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC565支払いコード(NM3)KB0601)                                                                 " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0601                                                                            " & vbNewLine _
                                     & "ON  KB0601.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0601.KBN_CD       = '07'                                                                              " & vbNewLine _
                                     & "AND KB0601.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC565支払いコード(NM3)KB0602)                                                                 " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0602                                                                            " & vbNewLine _
                                     & "ON  KB0602.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0602.KBN_CD       = '08'                                                                              " & vbNewLine _
                                     & "AND KB0602.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC568荷主コード(NM5)KB0701                                                                    " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0701                                                                            " & vbNewLine _
                                     & "ON  KB0701.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0701.KBN_CD       = '03'                                                                              " & vbNewLine _
                                     & "AND KB0701.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC568荷主コード(NM5)KB0702                                                                    " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0702                                                                            " & vbNewLine _
                                     & "ON  KB0702.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0702.KBN_CD       = '09'                                                                              " & vbNewLine _
                                     & "AND KB0702.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC569固定表示(NM1,3,4))KB08                                                                   " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB08                                                                              " & vbNewLine _
                                     & "ON  KB08.KBN_GROUP_CD   = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB08.KBN_CD         = '04'                                                                              " & vbNewLine _
                                     & "AND KB08.SYS_DEL_FLG    = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC570支店名(NM3)支店TEL(NM4))KB1001                                                           " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB1001                                                                            " & vbNewLine _
                                     & "ON  KB1001.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB1001.KBN_CD       = '05'                                                                              " & vbNewLine _
                                     & "AND KB1001.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC570支店名(NM3)支店TEL(NM4))KB1002                                                           " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB1002                                                                            " & vbNewLine _
                                     & "ON  KB1002.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB1002.KBN_CD       = '06'                                                                              " & vbNewLine _
                                     & "AND KB1002.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--荷主明細マスタ(LMC573にて運送契約荷主コード取得)                                                          " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_CUST_DETAILS CUSTDTL                                                                  " & vbNewLine _
                                     & "ON  CUSTDTL.NRS_BR_CD    = OUTL.NRS_BR_CD                                                                   " & vbNewLine _
                                     & "AND CUSTDTL.CUST_CD      = OUTL.CUST_CD_L + OUTL.CUST_CD_M                                                  " & vbNewLine _
                                     & "AND CUSTDTL.SUB_KB       = '03'                                                                             " & vbNewLine _
                                     & "AND CUSTDTL.SYS_DEL_FLG  = '0'                                                                              " & vbNewLine _
                                     & "--区分マスタ(LMC575支払コード(NM3)KB0801)                                                                   " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0801                                                                            " & vbNewLine _
                                     & "ON  KB0801.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0801.KBN_CD       = '16'                                                                              " & vbNewLine _
                                     & "AND KB0801.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC575支払コード(NM3)KB0802)                                                                   " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0802                                                                            " & vbNewLine _
                                     & "ON  KB0802.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0802.KBN_CD       = '17'                                                                              " & vbNewLine _
                                     & "AND KB0802.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC670 KB0803)                                                                                 " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0803                                                                            " & vbNewLine _
                                     & "ON  KB0803.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0803.KBN_CD       = '18'                                                                              " & vbNewLine _
                                     & "AND KB0803.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_DEST      DEST_JIS --2012.05.25                                                       " & vbNewLine _
                                     & "ON  DEST_JIS.NRS_BR_CD    = OUTL.NRS_BR_CD                                                                  " & vbNewLine _
                                     & "AND DEST_JIS.CUST_CD_L    = OUTL.CUST_CD_L                                                                  " & vbNewLine _
                                     & "AND DEST_JIS.DEST_CD      = OUTL.DEST_CD                                                                    " & vbNewLine _
                                     & "AND DEST_JIS.SYS_DEL_FLG  = '0'                                                                             " & vbNewLine _
                                     & "--JISマスタ(LMC661にてJIS_CD2桁：都道府県コード取得)2012.05.25                                              " & vbNewLine _
                                     & "  LEFT JOIN  $LM_MST$..M_JIS   JIS                                                                          " & vbNewLine _
                                     & "  ON  JIS.JIS_CD       = DEST_JIS.JIS                                                                       " & vbNewLine _
                                     & " AND  JIS.SYS_DEL_FLG  = '0'                                                                                " & vbNewLine _
                                     & "--運送会社マスタ(LMC589にてUNSOCO_NM：取次先運送会社名取得)2012.05.25                                       " & vbNewLine _
                                     & "--  LEFT JOIN  $LM_MST$..M_UNSOCO   MUC                                                                     " & vbNewLine _
                                     & "--  ON  MUC.NRS_BR_CD    = FL.NRS_BR_CD                                                                     " & vbNewLine _
                                     & "-- AND  MUC.UNSOCO_CD    = FL.UNSO_CD                                                                       " & vbNewLine _
                                     & "-- AND  MUC.UNSOCO_BR_CD = FL.UNSO_BR_CD                                                                    " & vbNewLine _
                                     & "-- AND  MUC.SYS_DEL_FLG  = '0'                                                                              " & vbNewLine _
                                     & "--荷主明細マスタ(LMC660にてSET_NAIYO：支払コード取得)2012.05.25                                             " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_CUST_DETAILS MCD_SAI                                                                  " & vbNewLine _
                                     & "ON  MCD_SAI.NRS_BR_CD    = OUTL.NRS_BR_CD                                                                   " & vbNewLine _
                                     & "AND MCD_SAI.CUST_CD      = OUTL.CUST_CD_L                                                                   " & vbNewLine _
                                     & "--AND MCD_SAI.CUST_CD_EDA  = OUTL.CUST_CD_M                                                                   " & vbNewLine _
                                     & "AND MCD_SAI.SUB_KB       = '27'                                                                             " & vbNewLine _
                                     & "AND MCD_SAI.SYS_DEL_FLG  = '0'                                                                              " & vbNewLine _
                                     & "--荷主明細マスタ(LMC669にてSET_NAIYO：荷送人名称取得)2012.06.01                                             " & vbNewLine _
                                     & "  LEFT JOIN $LM_MST$..M_CUST_DETAILS MCD_NFC                                                                " & vbNewLine _
                                     & "ON MCD_NFC.NRS_BR_CD   = OUTL.NRS_BR_CD                                                                     " & vbNewLine _
                                     & "AND MCD_NFC.CUST_CD      = OUTL.CUST_CD_L                                                                   " & vbNewLine _
                                     & "--AND MCD_NFC.CUST_CD_EDA  = OUTL.CUST_CD_M                                                                   " & vbNewLine _
                                     & "AND MCD_NFC.SUB_KB       = '29'                                                                             " & vbNewLine _
                                     & "AND MCD_NFC.SYS_DEL_FLG  = '0'                                                                              " & vbNewLine _
                                     & "--WHERE                                                                                                       " & vbNewLine _
                                     & "--    OUTL.SYS_DEL_FLG    = '0'                                                                               " & vbNewLine _
                                     & "--AND OUTL.NRS_BR_CD      = @NRS_BR_CD                                                                        " & vbNewLine _
                                     & "--AND OUTL.OUTKA_NO_L IN(@OUTKA_NO_L)                                                                         " & vbNewLine _
                                     & " --要望番号1383 [LMC664] --- START ---                                                          " & vbNewLine _
                                     & "         LEFT JOIN (SELECT NRS_BR_CD   AS NRS_BR_CD                                             " & vbNewLine _
                                     & "                         , CUST_CD     AS CUST_CD                                               " & vbNewLine _
                                     & "                         , CUST_CLASS  AS CUST_CLASS                                            " & vbNewLine _
                                     & "                         , SET_NAIYO   AS CUST_NAIYO_1                                          " & vbNewLine _
                                     & "                         , SET_NAIYO_2 AS CUST_NAIYO_2                                          " & vbNewLine _
                                     & "                         , SET_NAIYO_3 AS CUST_NAIYO_3                                          " & vbNewLine _
                                     & "                      FROM $LM_MST$..M_CUST_DETAILS                                             " & vbNewLine _
                                     & "                     WHERE SUB_KB ='42'                                                         " & vbNewLine _
                                     & "                       AND SET_NAIYO_2 = @RPT_ID                                                " & vbNewLine _
                                     & "                       AND SYS_DEL_FLG = '0'                                                    " & vbNewLine _
                                     & "                    ) MCD_CUST                                                                  " & vbNewLine _
                                     & "                ON CST.NRS_BR_CD = MCD_CUST.NRS_BR_CD                                           " & vbNewLine _
                                     & "               AND (CASE WHEN MCD_CUST.CUST_CLASS='00' THEN  CST.CUST_CD_L                                                   " & vbNewLine _
                                     & "                         WHEN MCD_CUST.CUST_CLASS='01' THEN (CST.CUST_CD_L + CST.CUST_CD_M)                                  " & vbNewLine _
                                     & "                         WHEN MCD_CUST.CUST_CLASS='02' THEN (CST.CUST_CD_L + CST.CUST_CD_M + CST.CUST_CD_S)                  " & vbNewLine _
                                     & "                         WHEN MCD_CUST.CUST_CLASS='03' THEN (CST.CUST_CD_L + CST.CUST_CD_M + CST.CUST_CD_S + CST.CUST_CD_SS) " & vbNewLine _
                                     & "                    END                                                                         " & vbNewLine _
                                     & "                   ) = MCD_CUST.CUST_CD                                                         " & vbNewLine _
                                     & " --要望番号1383 [LMC664] --- END ---                                                            " & vbNewLine



    ''' <summary>
    ''' データ抽出用FROM句浮間用(☆★作業用コメント：20110711)
    ''' 明細出力のため、SQL_FROMにあった"WHERE BASE.NUM=をコメントアウトし、
    ''' 商品分だけレコードを出力。
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_FROM_UKIMA As String = "FROM                                                                                                  " & vbNewLine _
                                     & "$LM_TRN$..C_OUTKA_L OUTL                                                                                    " & vbNewLine _
                                     & "--(2012.09.11)要望番号1412対応  --- START ---                                                               " & vbNewLine _
                                     & "--出荷EDIL                                                                                                  " & vbNewLine _
                                     & "--LEFT JOIN                                                                                                 " & vbNewLine _
                                     & "-- (                                                                                                        " & vbNewLine _
                                     & "--  SELECT                                                                                                  " & vbNewLine _
                                     & "--        MIN(DEST_AD_1)   AS DEST_AD_1                                                                     " & vbNewLine _
                                     & "--       ,MIN(DEST_AD_2)   AS DEST_AD_2                                                                     " & vbNewLine _
                                     & "--       ,DEST_AD_3                                                                                         " & vbNewLine _
                                     & "--       ,DEST_TEL                                                                                          " & vbNewLine _
                                     & "--       ,DEST_ZIP                                                                                          " & vbNewLine _
                                     & "--       ,FREE_C15                                                                                          " & vbNewLine _
                                     & "--       ,MIN(DEST_NM)     AS DEST_NM                                                                       " & vbNewLine _
                                     & "--       ,NRS_BR_CD                                                                                         " & vbNewLine _
                                     & "--       ,OUTKA_CTL_NO                                                                                      " & vbNewLine _
                                     & "--       ,SHIP_NM_L                                                                                         " & vbNewLine _
                                     & "--       ,SYS_DEL_FLG                                                                                       " & vbNewLine _
                                     & "--       ,FREE_C05                                                                                          " & vbNewLine _
                                     & "--       --,REMARK                    --2012.07.24 丸和運輸　荷受人氏名下の注意書き                         " & vbNewLine _
                                     & "--       ,MIN(REMARK)      AS REMARK  --2012.08.21 要望番号1355                                             " & vbNewLine _
                                     & "--  FROM                                                                                                    " & vbNewLine _
                                     & "--        $LM_TRN$..H_OUTKAEDI_L                                                                            " & vbNewLine _
                                     & "--  GROUP BY                                                                                                " & vbNewLine _
                                     & "--        DEST_AD_3                                                                                         " & vbNewLine _
                                     & "--       ,DEST_TEL                                                                                          " & vbNewLine _
                                     & "--       ,DEST_ZIP                                                                                          " & vbNewLine _
                                     & "--       ,FREE_C15                                                                                          " & vbNewLine _
                                     & "--       ,NRS_BR_CD                                                                                         " & vbNewLine _
                                     & "--       ,OUTKA_CTL_NO                                                                                      " & vbNewLine _
                                     & "--       ,SHIP_NM_L                                                                                         " & vbNewLine _
                                     & "--       ,SYS_DEL_FLG                                                                                       " & vbNewLine _
                                     & "--       ,FREE_C05                                                                                          " & vbNewLine _
                                     & "--       --,REMARK   --2012.07.24 丸和運輸　荷受人氏名下の注意書き   2012.08.21 要望番号1355 コメント化     " & vbNewLine _
                                     & "-- )                                                                                                        " & vbNewLine _
                                     & "--  EDIL                                                                                                    " & vbNewLine _
                                     & "--ON   EDIL.NRS_BR_CD   = OUTL.NRS_BR_CD                                                                    " & vbNewLine _
                                     & "--AND EDIL.OUTKA_CTL_NO = OUTL.OUTKA_NO_L                                                                   " & vbNewLine _
                                     & "--AND EDIL.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--AND EDIL.NRS_BR_CD    = OUTL.NRS_BR_CD                                                                    " & vbNewLine _
                                     & "--下記の内容に変更                                                                                          " & vbNewLine _
                                     & " LEFT JOIN (                                                                                                " & vbNewLine _
                                     & "            SELECT                                                                                          " & vbNewLine _
                                     & "                   NRS_BR_CD                                                                                " & vbNewLine _
                                     & "                 , EDI_CTL_NO                                                                               " & vbNewLine _
                                     & "                 , OUTKA_CTL_NO                                                                             " & vbNewLine _
                                     & "             FROM (                                                                                         " & vbNewLine _
                                     & "                    SELECT                                                                                  " & vbNewLine _
                                     & "                           EDIOUTL.NRS_BR_CD                                                                " & vbNewLine _
                                     & "                         , EDIOUTL.EDI_CTL_NO                                                               " & vbNewLine _
                                     & "                         , EDIOUTL.OUTKA_CTL_NO                                                             " & vbNewLine _
                                     & "                         , CASE WHEN EDIOUTL.OUTKA_CTL_NO = '' THEN 1                                       " & vbNewLine _
                                     & "                           ELSE ROW_NUMBER() OVER (PARTITION BY EDIOUTL.NRS_BR_CD                           " & vbNewLine _
                                     & "                                                              , EDIOUTL.OUTKA_CTL_NO                        " & vbNewLine _
                                     & "                                                       ORDER BY EDIOUTL.NRS_BR_CD                           " & vbNewLine _
                                     & "                                                              , EDIOUTL.EDI_CTL_NO                          " & vbNewLine _
                                     & "                                                  )                                                         " & vbNewLine _
                                     & "                           END AS IDX                                                                       " & vbNewLine _
                                     & "                      FROM $LM_TRN$..H_OUTKAEDI_L EDIOUTL                                                   " & vbNewLine _
                                     & "                     WHERE EDIOUTL.SYS_DEL_FLG  = '0'                                                       " & vbNewLine _
                                     & "                       AND EDIOUTL.NRS_BR_CD    = @NRS_BR_CD                                                " & vbNewLine _
                                     & "                       AND EDIOUTL.OUTKA_CTL_NO = @OUTKA_NO_L                                               " & vbNewLine _
                                     & "                   ) EBASE                                                                                  " & vbNewLine _
                                     & "            WHERE EBASE.IDX = 1                                                                             " & vbNewLine _
                                     & "            ) TOPEDI                                                                                        " & vbNewLine _
                                     & "        ON TOPEDI.NRS_BR_CD    = OUTL.NRS_BR_CD                                                             " & vbNewLine _
                                     & "       AND TOPEDI.OUTKA_CTL_NO = OUTL.OUTKA_NO_L                                                            " & vbNewLine _
                                     & " LEFT JOIN $LM_TRN$..H_OUTKAEDI_L EDIL                                                                      " & vbNewLine _
                                     & "        ON EDIL.NRS_BR_CD  = TOPEDI.NRS_BR_CD                                                               " & vbNewLine _
                                     & "       AND EDIL.EDI_CTL_NO = TOPEDI.EDI_CTL_NO                                                              " & vbNewLine _
                                     & "--(2012.09.11)要望番号1412対応  ---  END  ---                                                               " & vbNewLine _
                                     & "--出荷M                                                                                                     " & vbNewLine _
                                     & "LEFT JOIN                                                                                                   " & vbNewLine _
                                     & "(SELECT                                                                                                     " & vbNewLine _
                                     & "*                                                                                                           " & vbNewLine _
                                     & "FROM                                                                                                        " & vbNewLine _
                                     & "(SELECT                                                                                                     " & vbNewLine _
                                     & "   NRS_BR_CD                                                                                                " & vbNewLine _
                                     & "  ,GOODS_CD_NRS                                                                                             " & vbNewLine _
                                     & "  ,IRIME                                                                                                    " & vbNewLine _
                                     & "  ,IRIME_UT                                                                                                 " & vbNewLine _
                                     & "  ,ALCTD_NB                                                                                                 " & vbNewLine _
                                     & "  ,ALCTD_QT                                                                                                 " & vbNewLine _
                                     & "  ,LOT_NO                                                                                                   " & vbNewLine _
                                     & "  ,CUST_ORD_NO_DTL   --2012/06/11浮間対応                                                                   " & vbNewLine _
                                     & "  ,SYS_DEL_FLG                                                                                              " & vbNewLine _
                                     & "  ,ROW_NUMBER() OVER (PARTITION BY NRS_BR_CD ORDER BY OUTKA_NO_L,OUTKA_NO_M) AS NUM                         " & vbNewLine _
                                     & "  ,OUTKA_NO_L                                                                                               " & vbNewLine _
                                     & "  ,OUTKA_NO_M                                                                                               " & vbNewLine _
                                     & "  ,PRINT_SORT                                                                                               " & vbNewLine _
                                     & "   FROM $LM_TRN$..C_OUTKA_M M                                                                               " & vbNewLine _
                                     & "  WHERE                                                                                                     " & vbNewLine _
                                     & "      M.NRS_BR_CD = @NRS_BR_CD                                                                              " & vbNewLine _
                                     & "  AND M.OUTKA_NO_L IN(@OUTKA_NO_L)                                                                          " & vbNewLine _
                                     & "  AND SYS_DEL_FLG = '0'                                                                                     " & vbNewLine _
                                     & " ) AS BASE                                                                                                  " & vbNewLine _
                                     & "-- WHERE                                                                                                    " & vbNewLine _
                                     & "-- BASE.NUM = 1                                                                                             " & vbNewLine _
                                     & ") OUTM                                                                                                      " & vbNewLine _
                                     & "ON                                                                                                          " & vbNewLine _
                                     & "1 = 1                                                                                                       " & vbNewLine _
                                     & "--F運送L                                                                                                    " & vbNewLine _
                                     & "LEFT JOIN $LM_TRN$..F_UNSO_L FL                                                                             " & vbNewLine _
                                     & "ON  FL.MOTO_DATA_KB   = '20'                                                                                " & vbNewLine _
                                     & "AND FL.NRS_BR_CD      = OUTL.NRS_BR_CD                                                                      " & vbNewLine _
                                     & "AND FL.INOUTKA_NO_L   = OUTL.OUTKA_NO_L                                                                     " & vbNewLine _
                                     & "AND FL.SYS_DEL_FLG    = '0'                                                                                 " & vbNewLine _
                                     & "--出荷EDI L                                                                                                 " & vbNewLine _
                                     & "--LEFT JOIN $LM_TRN$..H_OUTKAEDI_L OUTKAEDIL                                                                  " & vbNewLine _
                                     & "--ON  OUTKAEDIL.NRS_BR_CD     = OUTL.NRS_BR_CD                                                                " & vbNewLine _
                                     & "--AND OUTKAEDIL.OUTKA_CTL_NO  = OUTL.OUTKA_NO_L                                                               " & vbNewLine _
                                     & "--AND OUTKAEDIL.SYS_DEL_FLG   = '0'                                                                           " & vbNewLine _
                                     & "--商品M                                                                                                     " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_GOODS MG                                                                              " & vbNewLine _
                                     & "ON  MG.NRS_BR_CD     = OUTM.NRS_BR_CD                                                                       " & vbNewLine _
                                     & "AND MG.GOODS_CD_NRS  = OUTM.GOODS_CD_NRS                                                                    " & vbNewLine _
                                     & "AND MG.SYS_DEL_FLG   = '0'                                                                                  " & vbNewLine _
                                     & "--荷主なしでの運送会社荷主別送り状パターン取得                                                              " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_UNSO_CUST_RPT MCR1                                                                    " & vbNewLine _
                                     & "ON  FL.NRS_BR_CD     = MCR1.NRS_BR_CD                                                                       " & vbNewLine _
                                     & "AND FL.UNSO_CD       = MCR1.UNSOCO_CD                                                                       " & vbNewLine _
                                     & "AND FL.UNSO_BR_CD    = MCR1.UNSOCO_BR_CD                                                                    " & vbNewLine _
                                     & "AND '11'             = MCR1.PTN_ID                                                                          " & vbNewLine _
                                     & "AND FL.PC_KB         = MCR1.MOTO_TYAKU_KB                                                                   " & vbNewLine _
                                     & "AND ''               = MCR1.CUST_CD_L                                                                       " & vbNewLine _
                                     & "AND ''               = MCR1.CUST_CD_M                                                                       " & vbNewLine _
                                     & "AND MCR1.SYS_DEL_FLG = '0'                                                                                  " & vbNewLine _
                                     & "--帳票パターン取得                                                                                          " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_RPT MR1                                                                               " & vbNewLine _
                                     & "ON  MR1.NRS_BR_CD   = MCR1.NRS_BR_CD                                                                        " & vbNewLine _
                                     & "AND MR1.PTN_ID      = MCR1.PTN_ID                                                                           " & vbNewLine _
                                     & "AND MR1.PTN_CD      = MCR1.PTN_CD                                                                           " & vbNewLine _
                                     & "AND MR1.SYS_DEL_FLG = '0'                                                                                   " & vbNewLine _
                                     & "--荷主込みでの運送会社荷主別送り状パターン取得                                                              " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_UNSO_CUST_RPT MCR2                                                                    " & vbNewLine _
                                     & "ON  FL.NRS_BR_CD     = MCR2.NRS_BR_CD                                                                       " & vbNewLine _
                                     & "AND FL.UNSO_CD       = MCR2.UNSOCO_CD                                                                       " & vbNewLine _
                                     & "AND FL.UNSO_BR_CD    = MCR2.UNSOCO_BR_CD                                                                    " & vbNewLine _
                                     & "AND '11'             = MCR2.PTN_ID                                                                          " & vbNewLine _
                                     & "AND FL.PC_KB         = MCR2.MOTO_TYAKU_KB                                                                   " & vbNewLine _
                                     & "AND FL.CUST_CD_L     = MCR2.CUST_CD_L                                                                       " & vbNewLine _
                                     & "AND FL.CUST_CD_M     = MCR2.CUST_CD_M                                                                       " & vbNewLine _
                                     & "AND MCR2.SYS_DEL_FLG = '0'                                                                                  " & vbNewLine _
                                     & "--帳票パターン取得                                                                                          " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_RPT MR2                                                                               " & vbNewLine _
                                     & "ON  MR2.NRS_BR_CD    = MCR2.NRS_BR_CD                                                                       " & vbNewLine _
                                     & "AND MR2.PTN_ID       = MCR2.PTN_ID                                                                          " & vbNewLine _
                                     & "AND MR2.PTN_CD       = MCR2.PTN_CD                                                                          " & vbNewLine _
                                     & "AND MR2.SYS_DEL_FLG  = '0'                                                                                  " & vbNewLine _
                                     & "--存在しない場合の帳票パターン取得                                                                          " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_RPT MR3                                                                               " & vbNewLine _
                                     & "ON  MR3.NRS_BR_CD     = OUTL.NRS_BR_CD                                                                      " & vbNewLine _
                                     & "AND MR3.PTN_ID        = '11'                                                                                " & vbNewLine _
                                     & "AND MR3.STANDARD_FLAG = '01'                                                                                " & vbNewLine _
                                     & "AND MR3.SYS_DEL_FLG   = '0'                                                                                 " & vbNewLine _
                                     & "--荷主マスタ (ここからメインプリント用)                                                               " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_CUST CST                                                                              " & vbNewLine _
                                     & "ON  CST.NRS_BR_CD     = MG.NRS_BR_CD                                                                        " & vbNewLine _
                                     & "AND CST.CUST_CD_L     = MG.CUST_CD_L                                                                        " & vbNewLine _
                                     & "AND CST.CUST_CD_M     = MG.CUST_CD_M                                                                        " & vbNewLine _
                                     & "AND CST.CUST_CD_S     = MG.CUST_CD_S                                                                        " & vbNewLine _
                                     & "AND CST.CUST_CD_SS    = MG.CUST_CD_SS                                                                       " & vbNewLine _
                                     & "AND CST.SYS_DEL_FLG   = '0'                                                                                 " & vbNewLine _
                                     & "--届先マスタ                                                                                                " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_DEST DST                                                                              " & vbNewLine _
                                     & "ON  DST.NRS_BR_CD     = OUTL.NRS_BR_CD                                                                      " & vbNewLine _
                                     & "AND DST.CUST_CD_L     = OUTL.CUST_CD_L                                                                      " & vbNewLine _
                                     & "AND DST.DEST_CD       = OUTL.DEST_CD                                                                        " & vbNewLine _
                                     & "AND DST.SYS_DEL_FLG   = '0'                                                                                 " & vbNewLine _
                                     & "--届先マスタ                                                                                                " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_DEST SHIPDST                                                                          " & vbNewLine _
                                     & "ON  SHIPDST.NRS_BR_CD     = OUTL.NRS_BR_CD                                                                  " & vbNewLine _
                                     & "AND SHIPDST.CUST_CD_L     = OUTL.CUST_CD_L                                                                  " & vbNewLine _
                                     & "AND SHIPDST.DEST_CD       = OUTL.SHIP_CD_L                                                                  " & vbNewLine _
                                     & "AND SHIPDST.SYS_DEL_FLG   = '0'                                                                             " & vbNewLine _
                                     & "--2018/03/08 001033 20180131【LMS】横浜BC帳票住所がYCCになっている対応 Annen upd start                      " & vbNewLine _
                                     & "--倉庫マスタ                                                                                                " & vbNewLine _
                                     & "LEFT JOIN LM_MST..M_SOKO SOKO                                                                               " & vbNewLine _
                                     & "ON OUTL.NRS_BR_CD = SOKO.NRS_BR_CD                                                                          " & vbNewLine _
                                     & "AND OUTL.WH_CD = SOKO.WH_CD                                                                                 " & vbNewLine _
                                     & "AND SOKO.SYS_DEL_FLG = '0'                                                                                  " & vbNewLine _
                                     & "--営業所マスタ                                                                                              " & vbNewLine _
                                     & "--LEFT JOIN $LM_MST$..M_NRS_BR NB                                                                             " & vbNewLine _
                                     & "--ON  NB.NRS_BR_CD      = OUTL.NRS_BR_CD                                                                      " & vbNewLine _
                                     & "--AND NB.SYS_DEL_FLG    = '0'                                                                                 " & vbNewLine _
                                     & "--2018/03/08 001033 20180131【LMS】横浜BC帳票住所がYCCになっている対応 Annen upd end                        " & vbNewLine _
                                     & "--商品明細                                                                                                  " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_GOODS_DETAILS MGD                                                                     " & vbNewLine _
                                     & "ON  MGD.NRS_BR_CD       = OUTM.NRS_BR_CD                                                                    " & vbNewLine _
                                     & "AND MGD.GOODS_CD_NRS    = OUTM.GOODS_CD_NRS                                                                 " & vbNewLine _
                                     & "AND MGD.SUB_KB          = '01'                                                                              " & vbNewLine _
                                     & "AND MGD.SYS_DEL_FLG     = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC560支店TEL(NM4)・支店名(NM3))KB01                                                           " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB01                                                                              " & vbNewLine _
                                     & "ON  KB01.KBN_GROUP_CD = 'O007'                                                                              " & vbNewLine _
                                     & "AND KB01.KBN_CD       = '01'                                                                                " & vbNewLine _
                                     & "AND KB01.SYS_DEL_FLG  = '0'                                                                                 " & vbNewLine _
                                     & "--区分マスタ(納期文言)KB02                                                                                  " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB02                                                                              " & vbNewLine _
                                     & "ON  KB02.KBN_GROUP_CD = 'N010'                                                                              " & vbNewLine _
                                     & "AND KB02.KBN_CD       = OUTL.ARR_PLAN_TIME                                                                  " & vbNewLine _
                                     & "AND KB02.SYS_DEL_FLG  = '0'                                                                                 " & vbNewLine _
                                     & "--区分マスタ(LMC563支店名(NM3)、電話番号(NM4))KB03                                                          " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB03                                                                              " & vbNewLine _
                                     & "ON  KB03.KBN_GROUP_CD = 'O007'                                                                              " & vbNewLine _
                                     & "AND KB03.KBN_CD       = '10'                                                                                " & vbNewLine _
                                     & "AND KB03.SYS_DEL_FLG  = '0'                                                                                 " & vbNewLine _
                                     & "--区分マスタ(LMC563支払支店コード(NM3))KB0401                                                               " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0401                                                                            " & vbNewLine _
                                     & "ON  KB0401.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0401.KBN_CD       = '11'                                                                              " & vbNewLine _
                                     & "AND KB0401.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC563支払支店コード(NM3))KB0402                                                               " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0402                                                                            " & vbNewLine _
                                     & "ON  KB0402.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0402.KBN_CD       = '12'                                                                              " & vbNewLine _
                                     & "AND KB0402.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC563支払支店コード(NM3))KB0403                                                               " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0403                                                                            " & vbNewLine _
                                     & "ON  KB0403.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0403.KBN_CD       = '13'                                                                              " & vbNewLine _
                                     & "AND KB0403.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC563支払支店コード(NM3))KB0404                                                               " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0404                                                                            " & vbNewLine _
                                     & "ON  KB0404.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0404.KBN_CD       = '14'                                                                              " & vbNewLine _
                                     & "AND KB0404.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC563支払支店コード(NM3))KB0405                                                               " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0405                                                                            " & vbNewLine _
                                     & "ON  KB0405.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0405.KBN_CD       = '15'                                                                              " & vbNewLine _
                                     & "AND KB0405.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC564支店TEL、荷主TEL(NM4)・支店名(NM3))KB05                                                  " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB05                                                                              " & vbNewLine _
                                     & "ON  KB05.KBN_GROUP_CD   = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB05.KBN_CD         = '02'                                                                              " & vbNewLine _
                                     & "AND KB05.SYS_DEL_FLG    = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC565支払いコード(NM3)KB0601)                                                                 " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0601                                                                            " & vbNewLine _
                                     & "ON  KB0601.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0601.KBN_CD       = '07'                                                                              " & vbNewLine _
                                     & "AND KB0601.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC565支払いコード(NM3)KB0602)                                                                 " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0602                                                                            " & vbNewLine _
                                     & "ON  KB0602.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0602.KBN_CD       = '08'                                                                              " & vbNewLine _
                                     & "AND KB0602.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC568荷主コード(NM5)KB0701                                                                    " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0701                                                                            " & vbNewLine _
                                     & "ON  KB0701.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0701.KBN_CD       = '03'                                                                              " & vbNewLine _
                                     & "AND KB0701.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC568荷主コード(NM5)KB0702                                                                    " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0702                                                                            " & vbNewLine _
                                     & "ON  KB0702.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0702.KBN_CD       = '09'                                                                              " & vbNewLine _
                                     & "AND KB0702.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC569固定表示(NM1,3,4))KB08                                                                   " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB08                                                                              " & vbNewLine _
                                     & "ON  KB08.KBN_GROUP_CD   = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB08.KBN_CD         = '04'                                                                              " & vbNewLine _
                                     & "AND KB08.SYS_DEL_FLG    = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC570支店名(NM3)支店TEL(NM4))KB1001                                                           " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB1001                                                                            " & vbNewLine _
                                     & "ON  KB1001.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB1001.KBN_CD       = '05'                                                                              " & vbNewLine _
                                     & "AND KB1001.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC570支店名(NM3)支店TEL(NM4))KB1002                                                           " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB1002                                                                            " & vbNewLine _
                                     & "ON  KB1002.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB1002.KBN_CD       = '06'                                                                              " & vbNewLine _
                                     & "AND KB1002.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--荷主明細マスタ(LMC573にて運送契約荷主コード取得)                                                          " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_CUST_DETAILS CUSTDTL                                                                  " & vbNewLine _
                                     & "ON  CUSTDTL.NRS_BR_CD    = OUTL.NRS_BR_CD                                                                   " & vbNewLine _
                                     & "AND CUSTDTL.CUST_CD      = OUTL.CUST_CD_L + OUTL.CUST_CD_M                                                  " & vbNewLine _
                                     & "AND CUSTDTL.SUB_KB       = '03'                                                                             " & vbNewLine _
                                     & "AND CUSTDTL.SYS_DEL_FLG  = '0'                                                                              " & vbNewLine _
                                     & "--区分マスタ(LMC575支払コード(NM3)KB0801)                                                                   " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0801                                                                            " & vbNewLine _
                                     & "ON  KB0801.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0801.KBN_CD       = '16'                                                                              " & vbNewLine _
                                     & "AND KB0801.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC575支払コード(NM3)KB0802)                                                                   " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0802                                                                            " & vbNewLine _
                                     & "ON  KB0802.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0802.KBN_CD       = '17'                                                                              " & vbNewLine _
                                     & "AND KB0802.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC670 KB0803)                                                                                 " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0803                                                                            " & vbNewLine _
                                     & "ON  KB0803.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0803.KBN_CD       = '18'                                                                              " & vbNewLine _
                                     & "AND KB0803.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_DEST      DEST_JIS --2012.05.25                                                       " & vbNewLine _
                                     & "ON  DEST_JIS.NRS_BR_CD    = OUTL.NRS_BR_CD                                                                  " & vbNewLine _
                                     & "AND DEST_JIS.CUST_CD_L    = OUTL.CUST_CD_L                                                                  " & vbNewLine _
                                     & "AND DEST_JIS.DEST_CD      = OUTL.DEST_CD                                                                    " & vbNewLine _
                                     & "AND DEST_JIS.SYS_DEL_FLG  = '0'                                                                             " & vbNewLine _
                                     & "--JISマスタ(LMC661にてJIS_CD2桁：都道府県コード取得)2012.05.25                                              " & vbNewLine _
                                     & "  LEFT JOIN  $LM_MST$..M_JIS   JIS                                                                          " & vbNewLine _
                                     & "  ON  JIS.JIS_CD       = DEST_JIS.JIS                                                                       " & vbNewLine _
                                     & " AND  JIS.SYS_DEL_FLG  = '0'                                                                                " & vbNewLine _
                                     & "--運送会社マスタ(LMC589にてUNSOCO_NM：取次先運送会社名取得)2012.05.25                                       " & vbNewLine _
                                     & "--  LEFT JOIN  $LM_MST$..M_UNSOCO   MUC                                                                     " & vbNewLine _
                                     & "--  ON  MUC.NRS_BR_CD    = FL.NRS_BR_CD                                                                     " & vbNewLine _
                                     & "-- AND  MUC.UNSOCO_CD    = FL.UNSO_CD                                                                       " & vbNewLine _
                                     & "-- AND  MUC.UNSOCO_BR_CD = FL.UNSO_BR_CD                                                                    " & vbNewLine _
                                     & "-- AND  MUC.SYS_DEL_FLG  = '0'                                                                              " & vbNewLine _
                                     & "--荷主明細マスタ(LMC660にてSET_NAIYO：支払コード取得)2012.05.25                                             " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_CUST_DETAILS MCD_SAI                                                                  " & vbNewLine _
                                     & "ON  MCD_SAI.NRS_BR_CD    = OUTL.NRS_BR_CD                                                                   " & vbNewLine _
                                     & "AND MCD_SAI.CUST_CD      = OUTL.CUST_CD_L                                                                   " & vbNewLine _
                                     & "--AND MCD_SAI.CUST_CD_EDA  = OUTL.CUST_CD_M                                                                   " & vbNewLine _
                                     & "AND MCD_SAI.SUB_KB       = '27'                                                                             " & vbNewLine _
                                     & "AND MCD_SAI.SYS_DEL_FLG  = '0'                                                                              " & vbNewLine _
                                     & "--荷主明細マスタ(LMC669にてSET_NAIYO：荷送人名称取得)2012.06.01                                             " & vbNewLine _
                                     & "  LEFT JOIN $LM_MST$..M_CUST_DETAILS MCD_NFC                                                                " & vbNewLine _
                                     & "ON MCD_NFC.NRS_BR_CD   = OUTL.NRS_BR_CD                                                                     " & vbNewLine _
                                     & "AND MCD_NFC.CUST_CD      = OUTL.CUST_CD_L                                                                   " & vbNewLine _
                                     & "--AND MCD_NFC.CUST_CD_EDA  = OUTL.CUST_CD_M                                                                   " & vbNewLine _
                                     & "AND MCD_NFC.SUB_KB       = '29'                                                                             " & vbNewLine _
                                     & "AND MCD_NFC.SYS_DEL_FLG  = '0'                                                                              " & vbNewLine _
                                     & " --要望番号1383 [LMC664] --- START ---                                                          " & vbNewLine _
                                     & "         LEFT JOIN (SELECT NRS_BR_CD   AS NRS_BR_CD                                             " & vbNewLine _
                                     & "                         , CUST_CD     AS CUST_CD                                               " & vbNewLine _
                                     & "                         , CUST_CLASS  AS CUST_CLASS                                            " & vbNewLine _
                                     & "                         , SET_NAIYO   AS CUST_NAIYO_1                                          " & vbNewLine _
                                     & "                         , SET_NAIYO_2 AS CUST_NAIYO_2                                          " & vbNewLine _
                                     & "                         , SET_NAIYO_3 AS CUST_NAIYO_3                                          " & vbNewLine _
                                     & "                      FROM $LM_MST$..M_CUST_DETAILS                                             " & vbNewLine _
                                     & "                     WHERE SUB_KB ='42'                                                         " & vbNewLine _
                                     & "                       AND SET_NAIYO_2 = @RPT_ID                                                " & vbNewLine _
                                     & "                       AND SYS_DEL_FLG = '0'                                                    " & vbNewLine _
                                     & "                    ) MCD_CUST                                                                  " & vbNewLine _
                                     & "                ON CST.NRS_BR_CD = MCD_CUST.NRS_BR_CD                                           " & vbNewLine _
                                     & "               AND (CASE WHEN MCD_CUST.CUST_CLASS='00' THEN  CST.CUST_CD_L                                                   " & vbNewLine _
                                     & "                         WHEN MCD_CUST.CUST_CLASS='01' THEN (CST.CUST_CD_L + CST.CUST_CD_M)                                  " & vbNewLine _
                                     & "                         WHEN MCD_CUST.CUST_CLASS='02' THEN (CST.CUST_CD_L + CST.CUST_CD_M + CST.CUST_CD_S)                  " & vbNewLine _
                                     & "                         WHEN MCD_CUST.CUST_CLASS='03' THEN (CST.CUST_CD_L + CST.CUST_CD_M + CST.CUST_CD_S + CST.CUST_CD_SS) " & vbNewLine _
                                     & "                    END                                                                         " & vbNewLine _
                                     & "                   ) = MCD_CUST.CUST_CD                                                         " & vbNewLine _
                                     & " --要望番号1383 [LMC664] --- END ---                                                            " & vbNewLine _
                                     & "--WHERE                                                                                         " & vbNewLine _
                                     & "--    OUTL.SYS_DEL_FLG    = '0'                                                                 " & vbNewLine _
                                     & "--AND OUTL.NRS_BR_CD      = @NRS_BR_CD                                                          " & vbNewLine


    '& "--AND OUTL.OUTKA_NO_L IN(@OUTKA_NO_L)                                                                         " & vbNewLine


    ''' <summary>
    ''' データ抽出用FROM句(FFEM用)
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_FROM_ADD_FJF As String _
        = "LEFT JOIN (                                               " & vbNewLine _
        & "            SELECT                                        " & vbNewLine _
        & "                   NRS_BR_CD         AS NRS_BR_CD         " & vbNewLine _
        & "                 , OUTKA_CTL_NO      AS OUTKA_CTL_NO      " & vbNewLine _
        & "                 , MAX(ZFVYDTEKIYO)  AS ZFVYDTEKIYO       " & vbNewLine _
        & "              FROM  $LM_TRN$..H_INOUTKAEDI_HED_FJF        " & vbNewLine _
        & "             WHERE SYS_DEL_FLG     = '0'                  " & vbNewLine _
        & "               AND DEL_KB          = '0'                  " & vbNewLine _
        & "               AND INOUT_KB        = '0'                  " & vbNewLine _
        & "               AND NRS_BR_CD       = @NRS_BR_CD           " & vbNewLine _
        & "               AND OUTKA_CTL_NO    = @OUTKA_NO_L          " & vbNewLine _
        & "             GROUP BY NRS_BR_CD                           " & vbNewLine _
        & "                    , OUTKA_CTL_NO                        " & vbNewLine _
        & "          ) AS FJF                                        " & vbNewLine _
        & "  ON FJF.NRS_BR_CD    = OUTL.NRS_BR_CD                    " & vbNewLine _
        & " AND FJF.OUTKA_CTL_NO = OUTL.OUTKA_NO_L                   " & vbNewLine


    ''' <summary>
    ''' 通常印刷用WHERE句
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_WHERE As String = "WHERE                                                                                                     " & vbNewLine _
                                     & "    OUTL.SYS_DEL_FLG    = '0'                                                                               " & vbNewLine _
                                     & "AND OUTL.NRS_BR_CD      = @NRS_BR_CD                                                                        " & vbNewLine _
                                     & "AND OUTL.OUTKA_NO_L IN(@OUTKA_NO_L)                                                                         " & vbNewLine



    ''' <summary>
    ''' ORDER BY（①出荷管理番号L)）(☆★作業用コメント：修正済)
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_ORDER_BY As String = "ORDER BY                                                                                                " & vbNewLine _
                                         & "     OUTL.NRS_BR_CD                                                                                     " & vbNewLine _
                                         & "    ,OUTL.OUTKA_NO_L                                                                                    " & vbNewLine _
                                         & "    ,OUTM.PRINT_SORT                                                                                    " & vbNewLine _
                                         & "    ,OUTM.OUTKA_NO_M                                                                                    " & vbNewLine

    ''' <summary>
    ''' ORDER BY（①出荷管理番号L)）(☆★作業用コメント：修正済)
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_ORDER_BY_NOMAL As String = "ORDER BY                                                                                                " & vbNewLine _
                                               & "     OUTL.NRS_BR_CD                                                                                     " & vbNewLine _
                                               & "    ,OUTL.OUTKA_NO_L                                                                                    " & vbNewLine

#Region "埼玉 BP用"

    ''' <summary>
    ''' 印刷データ抽出用(☆★作業用コメント:ひとまず修正おわり)
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_SELECT_DATA_BPC As String = "  --SQL_SELECT_DATA_BPC                                                                              " & vbNewLine _
                                                & " SELECT                                                                                              " & vbNewLine _
                                                & " CASE WHEN MR2.PTN_CD IS NOT NULL THEN MR2.RPT_ID                                                    " & vbNewLine _
                                                & "      WHEN MR1.PTN_CD IS NOT NULL THEN MR1.RPT_ID                                                    " & vbNewLine _
                                                & "      ELSE '' END            AS RPT_ID                                                               " & vbNewLine _
                                                & ",OUTL.NRS_BR_CD              AS NRS_BR_CD                                                            " & vbNewLine _
                                                & "--LMC560                                                                                             " & vbNewLine _
                                                & ",OUTL.OUTKA_PLAN_DATE        AS OUTKA_PLAN_DATE                                                      " & vbNewLine _
                                                & ",OUTL.OUTKA_NO_L             AS OUTKA_NO_L                                                           " & vbNewLine _
                                                & ",''                          AS SHITEN_TEL_560_1                                                     " & vbNewLine _
                                                & ",''                          AS SHITEN_NM_560_1                                                      " & vbNewLine _
                                                & ",OUTL.ARR_PLAN_DATE          AS ARR_PLAN_DATE                                                        " & vbNewLine _
                                                & ",KB02.KBN_NM1                AS ARR_PLAN_TIME                                                        " & vbNewLine _
                                                & ",OUTL.DEST_TEL               AS DEST_TEL                                                             " & vbNewLine _
                                                & ",CST.TEL                     AS CUST_TEL                                                             " & vbNewLine _
                                                & ",CST.AD_1                    AS CUST_AD_1                                                            " & vbNewLine _
                                                & ",CST.AD_2                    AS CUST_AD_2                                                            " & vbNewLine _
                                                & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_AD_1                                                   " & vbNewLine _
                                                & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_AD_1                                                   " & vbNewLine _
                                                & "      ELSE DST.AD_1                                                                                  " & vbNewLine _
                                                & " END                         AS DEST_AD_1                                                            " & vbNewLine _
                                                & ",CST.AD_3                    AS CUST_AD_3                                                            " & vbNewLine _
                                                & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_AD_2                                                   " & vbNewLine _
                                                & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_AD_2                                                   " & vbNewLine _
                                                & "      ELSE DST.AD_2                                                                                  " & vbNewLine _
                                                & " END                         AS DEST_AD_2                                                            " & vbNewLine _
                                                & ",OUTL.DEST_AD_3              AS DEST_AD_3                                                            " & vbNewLine _
                                                & ",FL.UNSO_WT                  AS BETU_WT                                                              " & vbNewLine _
                                                & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_NM                                                     " & vbNewLine _
                                                & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_NM                                                     " & vbNewLine _
                                                & "      ELSE DST.DEST_NM                                                                               " & vbNewLine _
                                                & " END                         AS DEST_NM_1                                                            " & vbNewLine _
                                                & ",CST.CUST_NM_L               AS CUST_NM_L                                                            " & vbNewLine _
                                                & "----LMC561                                                                                           " & vbNewLine _
                                                & ",CASE WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_ZIP                                                    " & vbNewLine _
                                                & "      ELSE DST.ZIP                                                                                   " & vbNewLine _
                                                & " END                         AS DEST_ZIP                                                             " & vbNewLine _
                                                & "--LMC562                                                                                             " & vbNewLine _
                                                & ",(SELECT                                                                                             " & vbNewLine _
                                                & "SUM (UNSO_WT.UNSO_WT) FROM                                                                           " & vbNewLine _
                                                & "(SELECT                                                                                              " & vbNewLine _
                                                & " --SUM(OUTS.BETU_WT * OUTS.ALCTD_NB) AS UNSO_WT                                                        " & vbNewLine _
                                                & "	SUM(OUTS.ALCTD_QT * MG.STD_WT_KGS / MG.STD_IRIME_NB) AS UNSO_WT                                     " & vbNewLine _
                                                & " FROM                                                                                                " & vbNewLine _
                                                & " $LM_TRN$..C_OUTKA_L OUTL                                                                            " & vbNewLine _
                                                & " LEFT JOIN                                                                                           " & vbNewLine _
                                                & " $LM_TRN$..C_OUTKA_M OUTM                                                                            " & vbNewLine _
                                                & "   ON OUTL.NRS_BR_CD   = OUTM.NRS_BR_CD                                                              " & vbNewLine _
                                                & "  AND OUTL.OUTKA_NO_L  = OUTM.OUTKA_NO_L                                                             " & vbNewLine _
                                                & "  AND OUTM.SYS_DEL_FLG = '0'                                                                         " & vbNewLine _
                                                & " LEFT JOIN                                                                                           " & vbNewLine _
                                                & " $LM_TRN$..C_OUTKA_S OUTS                                                                            " & vbNewLine _
                                                & "   ON OUTL.NRS_BR_CD   = OUTS.NRS_BR_CD                                                              " & vbNewLine _
                                                & "  AND OUTL.OUTKA_NO_L  = OUTS.OUTKA_NO_L                                                             " & vbNewLine _
                                                & "  AND OUTM.OUTKA_NO_M  = OUTS.OUTKA_NO_M                                                             " & vbNewLine _
                                                & "  AND OUTS.SYS_DEL_FLG = '0'                                                                         " & vbNewLine _
                                                & "	LEFT JOIN                                                                                           " & vbNewLine _
                                                & "	$LM_MST$..M_GOODS MG                                                                            " & vbNewLine _
                                                & "	  ON OUTM.NRS_BR_CD   = MG.NRS_BR_CD                                                              " & vbNewLine _
                                                & "	 AND OUTM.GOODS_CD_NRS  = MG.GOODS_CD_NRS                                                             " & vbNewLine _
                                                & " WHERE                                                                                               " & vbNewLine _
                                                & "     OUTL.SYS_DEL_FLG  = '0'                                                                         " & vbNewLine _
                                                & " AND OUTL.NRS_BR_CD    = @NRS_BR_CD                                                                  " & vbNewLine _
                                                & " AND OUTL.OUTKA_NO_L   = @OUTKA_NO_L                                                                 " & vbNewLine _
                                                & " GROUP BY                                                                                            " & vbNewLine _
                                                & "  OUTS.BETU_WT                                                                                       " & vbNewLine _
                                                & " ,OUTS.ALCTD_NB                                                                                      " & vbNewLine _
                                                & " ,OUTL.NRS_BR_CD                                                                                     " & vbNewLine _
                                                & " ,OUTL.OUTKA_NO_L                                                                                    " & vbNewLine _
                                                & " )  UNSO_WT                                                                                          " & vbNewLine _
                                                & " )  UNSO_WT                                                                                          " & vbNewLine _
                                                & "                                                                                                     " & vbNewLine _
                                                & ",FL.UNSO_PKG_NB              AS UNSO_PKG_NB                                                          " & vbNewLine _
                                                & ",CST.CUST_NM_M               AS CUST_NM_M                                                            " & vbNewLine _
                                                & "------LMC563                                                                                         " & vbNewLine _
                                                & ",NB.NRS_BR_NM                AS NRS_BR_NM                                                            " & vbNewLine _
                                                & ",''                          AS DEST_HOSOKU                                                          " & vbNewLine _
                                                & ",NB.AD_1                     AS NRS_AD_1                                                             " & vbNewLine _
                                                & ",NB.AD_2                     AS NRS_AD_2                                                             " & vbNewLine _
                                                & ",NB.TEL                      AS NRS_TEL                                                              " & vbNewLine _
                                                & ",CST.CUST_CD_L               AS CUST_CD_L                                                            " & vbNewLine _
                                                & ",FL.REMARK                   AS UNSO_L_REMARK                                                        " & vbNewLine _
                                                & ",OUTL.REMARK                 AS OUTKA_L_REMARK                                                       " & vbNewLine _
                                                & ",MIN(MG.GOODS_NM_1)          AS GOODS_NM_1                                                           " & vbNewLine _
                                                & ",MG.OUTKA_ATT                AS OUTKA_ATT                                                            " & vbNewLine _
                                                & ",OUTL.BUYER_ORD_NO           AS BUYER_ORD_NO                                                         " & vbNewLine _
                                                & ",''                          AS YELLOW_NO                                                            " & vbNewLine _
                                                & ",''                          AS SHIHARAI_SHITEN_NM_563_1                                             " & vbNewLine _
                                                & ",''                          AS SHIHARAI_SHITEN_CD_563_1                                             " & vbNewLine _
                                                & ",''                          AS SHIHARAI_SHITEN_TEL_563_1                                            " & vbNewLine _
                                                & "----LMC564                                                                                           " & vbNewLine _
                                                & ",''                          AS SHITEN_TEL_1_564_1                                                   " & vbNewLine _
                                                & ",''                          AS SHITEN_NM_564_1                                                      " & vbNewLine _
                                                & ",''                          AS SHITEN_TEL_2_564_1                                                   " & vbNewLine _
                                                & ",NB.AD_1                     AS NRS_BR_AD_1                                                          " & vbNewLine _
                                                & ",NB.AD_2                     AS NRS_BR_AD_2                                                          " & vbNewLine _
                                                & ",NB.NRS_BR_NM                AS NRS_BR_NM_1                                                          " & vbNewLine _
                                                & "----LMC565                                                                                           " & vbNewLine _
                                                & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_NM                                                     " & vbNewLine _
                                                & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_NM                                                     " & vbNewLine _
                                                & "      ELSE DST.DEST_NM                                                                               " & vbNewLine _
                                                & " END                         AS DEST_NM                                                              " & vbNewLine _
                                                & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_AD_1                                                   " & vbNewLine _
                                                & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_AD_1                                                   " & vbNewLine _
                                                & "      ELSE DST.AD_1                                                                                  " & vbNewLine _
                                                & " END                         AS AD_1                                                                 " & vbNewLine _
                                                & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_AD_2                                                   " & vbNewLine _
                                                & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_AD_2                                                   " & vbNewLine _
                                                & "      ELSE DST.AD_2                                                                                  " & vbNewLine _
                                                & " END                         AS AD_2                                                                 " & vbNewLine _
                                                & ",OUTL.DEST_AD_3              AS AD_3                                                                 " & vbNewLine _
                                                & ",OUTL.DEST_TEL               AS TEL                                                                  " & vbNewLine _
                                                & ",OUTL.DEST_CD                AS DEST_CD                                                              " & vbNewLine _
                                                & ",OUTL.SHIP_CD_L              AS SHIP_CD_L                                                            " & vbNewLine _
                                                & ",''                          AS SHIHARAI_CD_565_1                                                    " & vbNewLine _
                                                & ",''                          AS SHIHARAI_CD_565_2                                                    " & vbNewLine _
                                                & "----LMC566                                                                                           " & vbNewLine _
                                                & ",NB.FAX                      AS NRS_FAX                                                              " & vbNewLine _
                                                & "----LMC567                                                                                           " & vbNewLine _
                                                & ",NB.AD_3                     AS NRS_AD_3                                                             " & vbNewLine _
                                                & ",''                          AS CUST_ORD_NO                                                          " & vbNewLine _
                                                & ",MG.SHOBO_CD                 AS SHOBO_CD                                                             " & vbNewLine _
                                                & ",''                          AS CUST_CD_L_568_1                                                      " & vbNewLine _
                                                & ",''                          AS CUST_CD_L_568_2                                                      " & vbNewLine _
                                                & "----LMC569                                                                                           " & vbNewLine _
                                                & ",NB.ZIP                      AS NRS_BR_ZIP                                                           " & vbNewLine _
                                                & ",NB.TEL                      AS NRS_BR_TEL                                                           " & vbNewLine _
                                                & ",KB08.KBN_NM1                AS KOTEI_1                                                              " & vbNewLine _
                                                & ",KB08.KBN_NM3                AS KOTEI_2                                                              " & vbNewLine _
                                                & ",KB08.KBN_NM5                AS KOTEI_3                                                              " & vbNewLine _
                                                & "----LMC570                                                                                           " & vbNewLine _
                                                & ",FL.NB_UT                    AS NB_UT                                                                " & vbNewLine _
                                                & ",CST.DENPYO_NM               AS DENPYO_NM                                                            " & vbNewLine _
                                                & ",''                          AS SHITEN_NM_570_1                                                      " & vbNewLine _
                                                & ",''                          AS SHITEN_TEL_570_1                                                     " & vbNewLine _
                                                & ",''                          AS SHITEN_NM_570_2                                                      " & vbNewLine _
                                                & ",''                          AS SHITEN_TEL_570_2                                                     " & vbNewLine _
                                                & "----LMC572                                                                                           " & vbNewLine _
                                                & "--,OUTL.OUTKA_PKG_NB           AS OUTKA_PKG_NB                                                       " & vbNewLine _
                                                & ",ISNULL((SELECT BASE.OUTKA_PKG_NB                                                                    " & vbNewLine _
                                                & "FROM                                                                                                 " & vbNewLine _
                                                & "    (SELECT                                                                                          " & vbNewLine _
                                                & "	  SUM(OUTKA_PKG_NB) AS OUTKA_PKG_NB                                                                 " & vbNewLine _
                                                & "FROM $LM_TRN$..C_OUTKA_L OUTL                                                                        " & vbNewLine _
                                                & "WHERE                                                                                                " & vbNewLine _
                                                & "       OUTL.SYS_DEL_FLG     = '0'                                                                    " & vbNewLine _
                                                & "   AND OUTL.NRS_BR_CD       = MAT.NRS_BR_CD --@NRS_BR_CD  --MAT.NRS_BR_CD                                            " & vbNewLine _
                                                & "   AND OUTL.CUST_CD_L       = MAT.CUST_CD_L --@CUST_CD_L  --MAT.CUST_CD_L                                            " & vbNewLine _
                                                & "   AND OUTL.CUST_CD_M       = MAT.CUST_CD_M  --@CUST_CD_M  --MAT.CUST_CD_M                                            " & vbNewLine _
                                                & "   AND OUTL.CUST_CD_M       = MAT.CUST_CD_M  --@CUST_CD_M  --MAT.CUST_CD_M                                            " & vbNewLine _
                                                & "   AND OUTL.OUTKA_PLAN_DATE = MAT.OUTKA_PLAN_DATE --@OUTKA_PLAN_DATE  --MAT.OUTKA_PLAN_DATE                                " & vbNewLine _
                                                & "   AND OUTL.ARR_PLAN_DATE   = MAT.ARR_PLAN_DATE  --@ARR_PLAN_DATE  --MAT.ARR_PLAN_DATE                                    " & vbNewLine _
                                                & "   AND OUTL.DEST_CD         = MAT.DEST_CD  --@DEST_CD   --'60032900'  --MAT.DEST_CD                                 " & vbNewLine _
                                                & "   ) AS BASE                                                                                         " & vbNewLine _
                                                & "),0) AS OUTKA_PKG_NB                                                                                 " & vbNewLine _
                                                & ",OUTM.IRIME                  AS IRIME                                                                " & vbNewLine _
                                                & ",OUTM.IRIME_UT               AS IRIME_UT                                                             " & vbNewLine _
                                                & ",OUTM.ALCTD_NB               AS ALCTD_NB                                                             " & vbNewLine _
                                                & "--,MIN(OUTM.LOT_NO)            AS LOT_NO                                                             " & vbNewLine _
                                                & ",''                          AS LOT_NO                                                               " & vbNewLine _
                                                & ",SHIPDST.DEST_NM             AS SHIP_NM_L                                                            " & vbNewLine _
                                                & ",CUSTDTL.SET_NAIYO           AS UNSO_CUST_CD                                                         " & vbNewLine _
                                                & ",''                          AS SHIHARAI_CD_575_1                                                    " & vbNewLine _
                                                & ",''                          AS SHIHARAI_CD_575_2                                                    " & vbNewLine _
                                                & "----LMC670                                                                                           " & vbNewLine _
                                                & ",KB0803.KBN_NM1              AS KBN_CUST_ZIP                                                         " & vbNewLine _
                                                & ",KB0803.KBN_NM2              AS KBN_CUST_AD                                                          " & vbNewLine _
                                                & ",KB0803.KBN_NM3              AS KBN_CUST_TEL                                                         " & vbNewLine _
                                                & ",KB0803.KBN_NM4              AS KBN_CUST_NM                                                          " & vbNewLine _
                                                & ",OUTL.OUTKO_DATE             AS OUTKO_DATE                                                           " & vbNewLine _
                                                & "--,SUM(MG.STD_WT_KGS * OUTM.ALCTD_NB) AS ALCTD_WT                                                      " & vbNewLine _
                                                & ",SUM(MG.STD_WT_KGS * OUTM.ALCTD_QT / MG.STD_IRIME_NB) AS ALCTD_WT                                                      " & vbNewLine _
                                                & ", ''                         AS BUKA_CD                                                              " & vbNewLine _
                                                & ", ''                         AS ATSUKAISYA_NM                                                        " & vbNewLine _
                                                & ", ''                         AS GOODS_CD_CUST                 --2012.05.25                           " & vbNewLine _
                                                & ",''                          AS PREF_CD                       --2012.05.25                           " & vbNewLine _
                                                & ",''                          AS TORI_UNSOCO_NM                                                       " & vbNewLine _
                                                & ",MCD_SAI.SET_NAIYO           AS SAI_SHIHARAI_CD               --2012.05.25                           " & vbNewLine _
                                                & ",MCD_SAI.SET_NAIYO_3         AS SET_NM_L                      --2012.05.29                           " & vbNewLine _
                                                & ",MCD_NFC.SET_NAIYO           AS NAIYO1                        --2012.06.01                           " & vbNewLine _
                                                & ",MCD_NFC.SET_NAIYO_2         AS NAIYO2                        --2012.06.01                           " & vbNewLine _
                                                & ",MCD_NFC.SET_NAIYO_3         AS NAIYO3                        --2012.06.01                           " & vbNewLine _
                                                & ",MCD_SAI.SET_NAIYO_2         AS NAIYO_CUST_NM                 --2012.06.04                           " & vbNewLine _
                                                & ",OUTM.CUST_ORD_NO_DTL        AS CUST_ORD_NO_DTL              --2012.06.11                            " & vbNewLine _
                                                & "-- --2012.07.24 丸和運輸　荷受人氏名下の注意書き(REMARK)開始                                         " & vbNewLine _
                                                & "-- ,CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.REMARK                                                   " & vbNewLine _
                                                & "--       WHEN OUTL.DEST_KB = '02' THEN EDIL.REMARK                                                   " & vbNewLine _
                                                & "--       ELSE DST.REMARK                                                                             " & vbNewLine _
                                                & "--  END                         AS REMARK_DEST                                                       " & vbNewLine _
                                                & ",''                           AS REMARK_DEST                                                         " & vbNewLine _
                                                & "-- --2012.07.24 丸和運輸　荷受人氏名下の注意書き(REMARK)終了                                         " & vbNewLine _
                                                & "-- --要望番号1383 [LMC664] --- START ---                                                             " & vbNewLine _
                                                & "-- ,ISNULL(MCD_CUST.CUST_NAIYO_1,'') AS CUST_FLG                                                     " & vbNewLine _
                                                & ", ''                          AS CUST_FLG                                                            " & vbNewLine _
                                                & "-- --要望番号1383 [LMC664] --- END ---                                                               " & vbNewLine _
                                                & "                                                                                                     " & vbNewLine _
                                                & ",ISNULL((SELECT BASE.CUST_ORD_NO                                                                     " & vbNewLine _
                                                & " FROM                                                                                                " & vbNewLine _
                                                & "     (SELECT                                                                                         " & vbNewLine _
                                                & "     CUST_ORD_NO AS CUST_ORD_NO                                                                      " & vbNewLine _
                                                & "	,OUTKA_NO_L AS OUTKA_NO_L                                                                           " & vbNewLine _
                                                & "	,ROW_NUMBER() OVER                                                                                  " & vbNewLine _
                                                & "         (ORDER BY OUTKA_NO_L)                                                                       " & vbNewLine _
                                                & "      AS   NUM                                                                                       " & vbNewLine _
                                                & "      FROM $LM_TRN$..C_OUTKA_L L                                                                     " & vbNewLine _
                                                & "      WHERE L.NRS_BR_CD       = @NRS_BR_CD --MAT.NRS_BR_CD                                    -- '50'" & vbNewLine _
                                                & "	    AND	L.CUST_CD_L       = @CUST_CD_L    --MAT.CUST_CD_L                                  --'00023'" & vbNewLine _
                                                & "		AND	L.CUST_CD_M       = @CUST_CD_M    --MAT.CUST_CD_M                                  --'00'AND" & vbNewLine _
                                                & "        AND L.OUTKA_PLAN_DATE = @OUTKA_PLAN_DATE  --MAT.OUTKA_PLAN_DATE                  --'20121211'" & vbNewLine _
                                                & "		AND	L.ARR_PLAN_DATE   = @ARR_PLAN_DATE --MAT.ARR_PLAN_DATE                          --'20121212'" & vbNewLine _
                                                & "		AND L.DEST_CD         = @DEST_CD  --MAT.DEST_CD                                    --'62022570' " & vbNewLine _
                                                & "        AND L.SYS_DEL_FLG = '0'                                                                      " & vbNewLine _
                                                & "     ) AS BASE                                                                                       " & vbNewLine _
                                                & " WHERE BASE.NUM = 1),'') AS CUST_ORD_NO_1                                                            " & vbNewLine _
                                                & "                                                                                                     " & vbNewLine _
                                                & "                                                                                                     " & vbNewLine _
                                                & ",ISNULL((SELECT BASE.CUST_ORD_NO                                                                     " & vbNewLine _
                                                & " FROM                                                                                                " & vbNewLine _
                                                & "     (SELECT                                                                                         " & vbNewLine _
                                                & "     CUST_ORD_NO AS CUST_ORD_NO                                                                      " & vbNewLine _
                                                & "	,OUTKA_NO_L AS OUTKA_NO_L                                                                           " & vbNewLine _
                                                & "	,ROW_NUMBER() OVER                                                                                  " & vbNewLine _
                                                & "         (ORDER BY OUTKA_NO_L)                                                                       " & vbNewLine _
                                                & "      AS   NUM                                                                                       " & vbNewLine _
                                                & "      FROM $LM_TRN$..C_OUTKA_L L                                                                     " & vbNewLine _
                                                & "      WHERE L.NRS_BR_CD       = @NRS_BR_CD  --MAT.NRS_BR_CD                                          " & vbNewLine _
                                                & "	    AND	L.CUST_CD_L       =    @CUST_CD_L  --MAT.CUST_CD_L                                          " & vbNewLine _
                                                & "		AND	L.CUST_CD_M       =    @CUST_CD_M  --MAT.CUST_CD_M                                          " & vbNewLine _
                                                & "        AND L.OUTKA_PLAN_DATE = @OUTKA_PLAN_DATE  --MAT.OUTKA_PLAN_DATE                              " & vbNewLine _
                                                & "		AND	L.ARR_PLAN_DATE   =    @ARR_PLAN_DATE --MAT.ARR_PLAN_DATE                                   " & vbNewLine _
                                                & "		AND L.DEST_CD         =    @DEST_CD  --MAT.DEST_CD                                              " & vbNewLine _
                                                & "        AND L.SYS_DEL_FLG = '0'                                                                      " & vbNewLine _
                                                & "     ) AS BASE                                                                                       " & vbNewLine _
                                                & " WHERE BASE.NUM = 2),'') AS CUST_ORD_NO_2                                                            " & vbNewLine _
                                                & "                                                                                                     " & vbNewLine _
                                                & ",ISNULL((SELECT BASE.CUST_ORD_NO                                                                     " & vbNewLine _
                                                & " FROM                                                                                                " & vbNewLine _
                                                & "     (SELECT                                                                                         " & vbNewLine _
                                                & "     CUST_ORD_NO AS CUST_ORD_NO                                                                      " & vbNewLine _
                                                & "	,OUTKA_NO_L AS OUTKA_NO_L                                                                           " & vbNewLine _
                                                & "	,ROW_NUMBER() OVER                                                                                  " & vbNewLine _
                                                & "         (ORDER BY OUTKA_NO_L)                                                                       " & vbNewLine _
                                                & "      AS   NUM                                                                                       " & vbNewLine _
                                                & "      FROM $LM_TRN$..C_OUTKA_L L                                                                     " & vbNewLine _
                                                & "      WHERE L.NRS_BR_CD       = @NRS_BR_CD  --MAT.NRS_BR_CD                                          " & vbNewLine _
                                                & "	    AND	L.CUST_CD_L       =    @CUST_CD_L  --MAT.CUST_CD_L                                          " & vbNewLine _
                                                & "		AND	L.CUST_CD_M       =    @CUST_CD_M  --MAT.CUST_CD_M                                          " & vbNewLine _
                                                & "        AND L.OUTKA_PLAN_DATE = @OUTKA_PLAN_DATE  --MAT.OUTKA_PLAN_DATE                              " & vbNewLine _
                                                & "		AND	L.ARR_PLAN_DATE   = @ARR_PLAN_DATE --MAT.ARR_PLAN_DATE                                      " & vbNewLine _
                                                & "		AND L.DEST_CD         = @DEST_CD  --MAT.DEST_CD                                                 " & vbNewLine _
                                                & "        AND L.SYS_DEL_FLG = '0'                                                                      " & vbNewLine _
                                                & "     ) AS BASE                                                                                       " & vbNewLine _
                                                & " WHERE BASE.NUM = 3),'') AS CUST_ORD_NO_3                                                            " & vbNewLine _
                                                & "                                                                                                     " & vbNewLine _
                                                & ",ISNULL((SELECT BASE.CUST_ORD_NO                                                                     " & vbNewLine _
                                                & " FROM                                                                                                " & vbNewLine _
                                                & "     (SELECT                                                                                         " & vbNewLine _
                                                & "     CUST_ORD_NO AS CUST_ORD_NO                                                                      " & vbNewLine _
                                                & "	,OUTKA_NO_L AS OUTKA_NO_L                                                                           " & vbNewLine _
                                                & "	,ROW_NUMBER() OVER                                                                                  " & vbNewLine _
                                                & "         (ORDER BY OUTKA_NO_L)                                                                       " & vbNewLine _
                                                & "      AS   NUM                                                                                       " & vbNewLine _
                                                & "      FROM $LM_TRN$..C_OUTKA_L L                                                                     " & vbNewLine _
                                                & "      WHERE L.NRS_BR_CD       = @NRS_BR_CD  --MAT.NRS_BR_CD                                          " & vbNewLine _
                                                & "	    AND	L.CUST_CD_L       = @CUST_CD_L  --MAT.CUST_CD_L                                             " & vbNewLine _
                                                & "		AND	L.CUST_CD_M       = @CUST_CD_M  --MAT.CUST_CD_M                                             " & vbNewLine _
                                                & "        AND L.OUTKA_PLAN_DATE = @OUTKA_PLAN_DATE  --MAT.OUTKA_PLAN_DATE                              " & vbNewLine _
                                                & "		AND	L.ARR_PLAN_DATE   =  @ARR_PLAN_DATE --MAT.ARR_PLAN_DATE                                     " & vbNewLine _
                                                & "		AND L.DEST_CD         = @DEST_CD  --MAT.DEST_CD                                                 " & vbNewLine _
                                                & "        AND L.SYS_DEL_FLG = '0'                                                                      " & vbNewLine _
                                                & "     ) AS BASE                                                                                       " & vbNewLine _
                                                & " WHERE BASE.NUM = 4),'') AS CUST_ORD_NO_4                                                            " & vbNewLine _
                                                & "                                                                                                     " & vbNewLine _
                                                & ",ISNULL((SELECT BASE.CUST_ORD_NO                                                                     " & vbNewLine _
                                                & " FROM                                                                                                " & vbNewLine _
                                                & "     (SELECT                                                                                         " & vbNewLine _
                                                & "     CUST_ORD_NO AS CUST_ORD_NO                                                                      " & vbNewLine _
                                                & "	,OUTKA_NO_L AS OUTKA_NO_L                                                                           " & vbNewLine _
                                                & "	,ROW_NUMBER() OVER                                                                                  " & vbNewLine _
                                                & "         (ORDER BY OUTKA_NO_L)                                                                       " & vbNewLine _
                                                & "      AS   NUM                                                                                       " & vbNewLine _
                                                & "      FROM $LM_TRN$..C_OUTKA_L L                                                                     " & vbNewLine _
                                                & "      WHERE L.NRS_BR_CD       = @NRS_BR_CD  --MAT.NRS_BR_CD                                          " & vbNewLine _
                                                & "	    AND	L.CUST_CD_L       = @CUST_CD_L  --MAT.CUST_CD_L                                             " & vbNewLine _
                                                & "		AND	L.CUST_CD_M       = @CUST_CD_M  --MAT.CUST_CD_M                                             " & vbNewLine _
                                                & "        AND L.OUTKA_PLAN_DATE = @OUTKA_PLAN_DATE  --MAT.OUTKA_PLAN_DATE                              " & vbNewLine _
                                                & "		AND	L.ARR_PLAN_DATE   = @ARR_PLAN_DATE --MAT.ARR_PLAN_DATE                                      " & vbNewLine _
                                                & "		AND L.DEST_CD         =  @DEST_CD  --MAT.DEST_CD                                                " & vbNewLine _
                                                & "        AND L.SYS_DEL_FLG = '0'                                                                      " & vbNewLine _
                                                & "     ) AS BASE                                                                                       " & vbNewLine _
                                                & " WHERE BASE.NUM = 5),'') AS CUST_ORD_NO_5                                                            " & vbNewLine _
                                                & "                                                                                                     " & vbNewLine _
                                                & ",ISNULL((SELECT BASE.CUST_ORD_NO                                                                     " & vbNewLine _
                                                & " FROM                                                                                                " & vbNewLine _
                                                & "     (SELECT                                                                                         " & vbNewLine _
                                                & "     CUST_ORD_NO AS CUST_ORD_NO                                                                      " & vbNewLine _
                                                & "	,OUTKA_NO_L AS OUTKA_NO_L                                                                           " & vbNewLine _
                                                & "	,ROW_NUMBER() OVER                                                                                  " & vbNewLine _
                                                & "         (ORDER BY OUTKA_NO_L)                                                                       " & vbNewLine _
                                                & "      AS   NUM                                                                                       " & vbNewLine _
                                                & "      FROM $LM_TRN$..C_OUTKA_L L                                                                     " & vbNewLine _
                                                & "      WHERE L.NRS_BR_CD       = @NRS_BR_CD  --MAT.NRS_BR_CD                                          " & vbNewLine _
                                                & "	    AND	L.CUST_CD_L       = @CUST_CD_L  --MAT.CUST_CD_L                                             " & vbNewLine _
                                                & "		AND	L.CUST_CD_M       = @CUST_CD_M  --MAT.CUST_CD_M                                             " & vbNewLine _
                                                & "        AND L.OUTKA_PLAN_DATE = @OUTKA_PLAN_DATE  --MAT.OUTKA_PLAN_DATE                              " & vbNewLine _
                                                & "		AND	L.ARR_PLAN_DATE   = @ARR_PLAN_DATE --MAT.ARR_PLAN_DATE                                      " & vbNewLine _
                                                & "		AND L.DEST_CD         = @DEST_CD  --MAT.DEST_CD                                                 " & vbNewLine _
                                                & "        AND L.SYS_DEL_FLG = '0'                                                                      " & vbNewLine _
                                                & "     ) AS BASE                                                                                       " & vbNewLine _
                                                & " WHERE BASE.NUM = 6),'') AS CUST_ORD_NO_6                                                            " & vbNewLine _
                                                & "                                                                                                     " & vbNewLine _
                                                & ",ISNULL((SELECT BASE.CUST_ORD_NO                                                                     " & vbNewLine _
                                                & " FROM                                                                                                " & vbNewLine _
                                                & "     (SELECT                                                                                         " & vbNewLine _
                                                & "     CUST_ORD_NO AS CUST_ORD_NO                                                                      " & vbNewLine _
                                                & "	,OUTKA_NO_L AS OUTKA_NO_L                                                                           " & vbNewLine _
                                                & "	,ROW_NUMBER() OVER                                                                                  " & vbNewLine _
                                                & "         (ORDER BY OUTKA_NO_L)                                                                       " & vbNewLine _
                                                & "      AS   NUM                                                                                       " & vbNewLine _
                                                & "      FROM $LM_TRN$..C_OUTKA_L L                                                                     " & vbNewLine _
                                                & "      WHERE L.NRS_BR_CD       = @NRS_BR_CD  --MAT.NRS_BR_CD                                                        " & vbNewLine _
                                                & "	    AND	L.CUST_CD_L       = @CUST_CD_L  --MAT.CUST_CD_L                                                           " & vbNewLine _
                                                & "		AND	L.CUST_CD_M       = @CUST_CD_M  --MAT.CUST_CD_M                                                           " & vbNewLine _
                                                & "        AND L.OUTKA_PLAN_DATE = @OUTKA_PLAN_DATE  --MAT.OUTKA_PLAN_DATE                                                  " & vbNewLine _
                                                & "		AND	L.ARR_PLAN_DATE   = @ARR_PLAN_DATE --MAT.ARR_PLAN_DATE                                                       " & vbNewLine _
                                                & "		AND L.DEST_CD         = @DEST_CD  --MAT.DEST_CD                                                             " & vbNewLine _
                                                & "        AND L.SYS_DEL_FLG = '0'                                                                      " & vbNewLine _
                                                & "     ) AS BASE                                                                                       " & vbNewLine _
                                                & " WHERE BASE.NUM = 7),'') AS CUST_ORD_NO_7                                                            " & vbNewLine

    ''' <summary>
    ''' 印刷データ抽出用(☆★作業用コメント:ひとまず修正おわり)
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_FROM_BPC As String = "  --SQL_FROM_BPC                                                                                                   " & vbNewLine _
                                                & "FROM                                                                                                        " & vbNewLine _
                                                & "$LM_TRN$..C_OUTKA_L OUTL                                                                                    " & vbNewLine _
                                                & " LEFT JOIN (                                                                                                " & vbNewLine _
                                                & "            SELECT                                                                                          " & vbNewLine _
                                                & "                   NRS_BR_CD                                                                                " & vbNewLine _
                                                & "                 , EDI_CTL_NO                                                                               " & vbNewLine _
                                                & "                 , OUTKA_CTL_NO                                                                             " & vbNewLine _
                                                & "             FROM (                                                                                         " & vbNewLine _
                                                & "                    SELECT                                                                                  " & vbNewLine _
                                                & "                           EDIOUTL.NRS_BR_CD                                                                " & vbNewLine _
                                                & "                         , EDIOUTL.EDI_CTL_NO                                                               " & vbNewLine _
                                                & "                         , EDIOUTL.OUTKA_CTL_NO                                                             " & vbNewLine _
                                                & "                         , CASE WHEN EDIOUTL.OUTKA_CTL_NO = '' THEN 1                                       " & vbNewLine _
                                                & "                           ELSE ROW_NUMBER() OVER (PARTITION BY EDIOUTL.NRS_BR_CD                           " & vbNewLine _
                                                & "                                                              , EDIOUTL.OUTKA_CTL_NO                        " & vbNewLine _
                                                & "                                                       ORDER BY EDIOUTL.NRS_BR_CD                           " & vbNewLine _
                                                & "                                                              , EDIOUTL.EDI_CTL_NO                          " & vbNewLine _
                                                & "                                                  )                                                         " & vbNewLine _
                                                & "                           END AS IDX                                                                       " & vbNewLine _
                                                & "                      FROM $LM_TRN$..H_OUTKAEDI_L EDIOUTL                                                   " & vbNewLine _
                                                & "                     WHERE EDIOUTL.SYS_DEL_FLG  = '0'                                                       " & vbNewLine _
                                                & "                       AND EDIOUTL.NRS_BR_CD    = @NRS_BR_CD                                                      " & vbNewLine _
                                                & "                       AND EDIOUTL.OUTKA_CTL_NO = @OUTKA_NO_L                                               " & vbNewLine _
                                                & "                  ) EBASE                                                                                   " & vbNewLine _
                                                & "            WHERE EBASE.IDX = 1                                                                             " & vbNewLine _
                                                & "            ) TOPEDI                                                                                        " & vbNewLine _
                                                & "        ON TOPEDI.NRS_BR_CD    = OUTL.NRS_BR_CD                                                             " & vbNewLine _
                                                & "       AND TOPEDI.OUTKA_CTL_NO = OUTL.OUTKA_NO_L                                                            " & vbNewLine _
                                                & " LEFT JOIN $LM_TRN$..H_OUTKAEDI_L EDIL                                                                      " & vbNewLine _
                                                & "        ON EDIL.NRS_BR_CD  = TOPEDI.NRS_BR_CD                                                               " & vbNewLine _
                                                & "       AND EDIL.EDI_CTL_NO = TOPEDI.EDI_CTL_NO                                                              " & vbNewLine _
                                                & "--(2012.09.11)要望番号1412対応  ---  END  ---                                                               " & vbNewLine _
                                                & "--出荷M                                                                                                     " & vbNewLine _
                                                & "LEFT JOIN                                                                                                   " & vbNewLine _
                                                & "(SELECT                                                                                                     " & vbNewLine _
                                                & "*                                                                                                           " & vbNewLine _
                                                & "FROM                                                                                                        " & vbNewLine _
                                                & "(SELECT                                                                                                     " & vbNewLine _
                                                & "   NRS_BR_CD                                                                                                " & vbNewLine _
                                                & "  ,GOODS_CD_NRS                                                                                             " & vbNewLine _
                                                & "  ,IRIME                                                                                                    " & vbNewLine _
                                                & "  ,IRIME_UT                                                                                                 " & vbNewLine _
                                                & "  ,ALCTD_NB                                                                                                 " & vbNewLine _
                                                & "  ,ALCTD_QT                                                                                                 " & vbNewLine _
                                                & "  ,LOT_NO                                                                                                   " & vbNewLine _
                                                & "  ,SYS_DEL_FLG                                                                                              " & vbNewLine _
                                                & "  ,CUST_ORD_NO_DTL                                                                                          " & vbNewLine _
                                                & "  ,ROW_NUMBER() OVER (PARTITION BY NRS_BR_CD ORDER BY OUTKA_NO_L,OUTKA_NO_M) AS NUM                         " & vbNewLine _
                                                & "  ,OUTKA_NO_L                                                                                               " & vbNewLine _
                                                & "  ,OUTKA_NO_M                                                                                               " & vbNewLine _
                                                & "  FROM                                                                                                      " & vbNewLine _
                                                & "   $LM_TRN$..C_OUTKA_M M                                                                                    " & vbNewLine _
                                                & "  WHERE                                                                                                     " & vbNewLine _
                                                & "      M.NRS_BR_CD = '50'                                                                                    " & vbNewLine _
                                                & "  AND M.OUTKA_NO_L IN(@OUTKA_NO_L)                                                                          " & vbNewLine _
                                                & "  AND SYS_DEL_FLG = '0'                                                                                     " & vbNewLine _
                                                & " ) AS BASE                                                                                                  " & vbNewLine _
                                                & "-- WHERE                                                                                                    " & vbNewLine _
                                                & "-- BASE.NUM = 1                                                                                             " & vbNewLine _
                                                & ") OUTM                                                                                                      " & vbNewLine _
                                                & "ON                                                                                                          " & vbNewLine _
                                                & "1 = 1                                                                                                       " & vbNewLine _
                                                & "--F運送L                                                                                                    " & vbNewLine _
                                                & "LEFT JOIN $LM_TRN$..F_UNSO_L FL                                                                             " & vbNewLine _
                                                & "ON  FL.MOTO_DATA_KB   = '20'                                                                                " & vbNewLine _
                                                & "AND FL.NRS_BR_CD      = OUTL.NRS_BR_CD                                                                      " & vbNewLine _
                                                & "AND FL.INOUTKA_NO_L   = OUTL.OUTKA_NO_L                                                                     " & vbNewLine _
                                                & "AND FL.SYS_DEL_FLG    = '0'                                                                                 " & vbNewLine _
                                                & "--商品M                                                                                                     " & vbNewLine _
                                                & "LEFT JOIN $LM_MST$..M_GOODS MG                                                                              " & vbNewLine _
                                                & "ON  MG.NRS_BR_CD     = OUTM.NRS_BR_CD                                                                       " & vbNewLine _
                                                & "AND MG.GOODS_CD_NRS  = OUTM.GOODS_CD_NRS                                                                    " & vbNewLine _
                                                & "AND MG.SYS_DEL_FLG   = '0'                                                                                  " & vbNewLine _
                                                & "--荷主なしでの運送会社荷主別送り状パターン取得                                                              " & vbNewLine _
                                                & "LEFT JOIN $LM_MST$..M_UNSO_CUST_RPT MCR1                                                                    " & vbNewLine _
                                                & "ON  FL.NRS_BR_CD     = MCR1.NRS_BR_CD                                                                       " & vbNewLine _
                                                & "AND FL.UNSO_CD       = MCR1.UNSOCO_CD                                                                       " & vbNewLine _
                                                & "AND FL.UNSO_BR_CD    = MCR1.UNSOCO_BR_CD                                                                    " & vbNewLine _
                                                & "AND '11'             = MCR1.PTN_ID                                                                          " & vbNewLine _
                                                & "AND FL.PC_KB         = MCR1.MOTO_TYAKU_KB                                                                   " & vbNewLine _
                                                & "AND ''               = MCR1.CUST_CD_L                                                                       " & vbNewLine _
                                                & "AND ''               = MCR1.CUST_CD_M                                                                       " & vbNewLine _
                                                & "AND MCR1.SYS_DEL_FLG = '0'                                                                                  " & vbNewLine _
                                                & "--帳票パターン取得                                                                                          " & vbNewLine _
                                                & "LEFT JOIN $LM_MST$..M_RPT MR1                                                                               " & vbNewLine _
                                                & "ON  MR1.NRS_BR_CD   = MCR1.NRS_BR_CD                                                                        " & vbNewLine _
                                                & "AND MR1.PTN_ID      = MCR1.PTN_ID                                                                           " & vbNewLine _
                                                & "AND MR1.PTN_CD      = MCR1.PTN_CD                                                                           " & vbNewLine _
                                                & "AND MR1.SYS_DEL_FLG = '0'                                                                                   " & vbNewLine _
                                                & "--荷主込みでの運送会社荷主別送り状パターン取得                                                              " & vbNewLine _
                                                & "LEFT JOIN $LM_MST$..M_UNSO_CUST_RPT MCR2                                                                    " & vbNewLine _
                                                & "ON  FL.NRS_BR_CD     = MCR2.NRS_BR_CD                                                                       " & vbNewLine _
                                                & "AND FL.UNSO_CD       = MCR2.UNSOCO_CD                                                                       " & vbNewLine _
                                                & "AND FL.UNSO_BR_CD    = MCR2.UNSOCO_BR_CD                                                                    " & vbNewLine _
                                                & "AND '11'             = MCR2.PTN_ID                                                                          " & vbNewLine _
                                                & "AND FL.PC_KB         = MCR2.MOTO_TYAKU_KB                                                                   " & vbNewLine _
                                                & "AND FL.CUST_CD_L     = MCR2.CUST_CD_L                                                                       " & vbNewLine _
                                                & "AND FL.CUST_CD_M     = MCR2.CUST_CD_M                                                                       " & vbNewLine _
                                                & "AND MCR2.SYS_DEL_FLG = '0'                                                                                  " & vbNewLine _
                                                & "--帳票パターン取得                                                                                          " & vbNewLine _
                                                & "LEFT JOIN $LM_MST$..M_RPT MR2                                                                               " & vbNewLine _
                                                & "ON  MR2.NRS_BR_CD    = MCR2.NRS_BR_CD                                                                       " & vbNewLine _
                                                & "AND MR2.PTN_ID       = MCR2.PTN_ID                                                                          " & vbNewLine _
                                                & "AND MR2.PTN_CD       = MCR2.PTN_CD                                                                          " & vbNewLine _
                                                & "AND MR2.SYS_DEL_FLG  = '0'                                                                                  " & vbNewLine _
                                                & "----荷主マスタ (ここからメインプリント用)                                                                   " & vbNewLine _
                                                & "LEFT JOIN $LM_MST$..M_CUST CST                                                                              " & vbNewLine _
                                                & "ON  CST.NRS_BR_CD     = MG.NRS_BR_CD                                                                        " & vbNewLine _
                                                & "AND CST.CUST_CD_L     = MG.CUST_CD_L                                                                        " & vbNewLine _
                                                & "AND CST.CUST_CD_M     = MG.CUST_CD_M                                                                        " & vbNewLine _
                                                & "AND CST.CUST_CD_S     = MG.CUST_CD_S                                                                        " & vbNewLine _
                                                & "AND CST.CUST_CD_SS    = MG.CUST_CD_SS                                                                       " & vbNewLine _
                                                & "AND CST.SYS_DEL_FLG   = '0'                                                                                 " & vbNewLine _
                                                & "--届先マスタ                                                                                                " & vbNewLine _
                                                & "LEFT JOIN $LM_MST$..M_DEST DST                                                                              " & vbNewLine _
                                                & "ON  DST.NRS_BR_CD     = OUTL.NRS_BR_CD                                                                      " & vbNewLine _
                                                & "AND DST.CUST_CD_L     = OUTL.CUST_CD_L                                                                      " & vbNewLine _
                                                & "AND DST.DEST_CD       = OUTL.DEST_CD                                                                        " & vbNewLine _
                                                & "AND DST.SYS_DEL_FLG   = '0'                                                                                 " & vbNewLine _
                                                & "--届先マスタ                                                                                                " & vbNewLine _
                                                & "LEFT JOIN $LM_MST$..M_DEST SHIPDST                                                                          " & vbNewLine _
                                                & "ON  SHIPDST.NRS_BR_CD     = OUTL.NRS_BR_CD                                                                  " & vbNewLine _
                                                & "AND SHIPDST.CUST_CD_L     = OUTL.CUST_CD_L                                                                  " & vbNewLine _
                                                & "AND SHIPDST.DEST_CD       = OUTL.SHIP_CD_L                                                                  " & vbNewLine _
                                                & "AND SHIPDST.SYS_DEL_FLG   = '0'                                                                             " & vbNewLine _
                                                & "--営業所マスタ                                                                                              " & vbNewLine _
                                                & "LEFT JOIN $LM_MST$..M_NRS_BR NB                                                                             " & vbNewLine _
                                                & "ON  NB.NRS_BR_CD      = OUTL.NRS_BR_CD                                                                      " & vbNewLine _
                                                & "AND NB.SYS_DEL_FLG    = '0'                                                                                 " & vbNewLine _
                                                & "--区分マスタ(納期文言)KB02                                                                                  " & vbNewLine _
                                                & "LEFT JOIN $LM_MST$..Z_KBN KB02                                                                              " & vbNewLine _
                                                & "ON  KB02.KBN_GROUP_CD = 'N010'                                                                              " & vbNewLine _
                                                & "AND KB02.KBN_CD       = OUTL.ARR_PLAN_TIME                                                                  " & vbNewLine _
                                                & "AND KB02.SYS_DEL_FLG  = '0'                                                                                 " & vbNewLine _
                                                & "--区分マスタ(LMC569固定表示(NM1,3,4))KB08                                                                   " & vbNewLine _
                                                & "LEFT JOIN $LM_MST$..Z_KBN KB08                                                                              " & vbNewLine _
                                                & "ON  KB08.KBN_GROUP_CD   = 'O007'                                                                            " & vbNewLine _
                                                & "AND KB08.KBN_CD         = '04'                                                                              " & vbNewLine _
                                                & "AND KB08.SYS_DEL_FLG    = '0'                                                                               " & vbNewLine _
                                                & "--荷主明細マスタ(LMC573にて運送契約荷主コード取得)                                                          " & vbNewLine _
                                                & "LEFT JOIN $LM_MST$..M_CUST_DETAILS CUSTDTL                                                                  " & vbNewLine _
                                                & "ON  CUSTDTL.NRS_BR_CD    = OUTL.NRS_BR_CD                                                                   " & vbNewLine _
                                                & "AND CUSTDTL.CUST_CD      = OUTL.CUST_CD_L + OUTL.CUST_CD_M                                                  " & vbNewLine _
                                                & "AND CUSTDTL.SUB_KB       = '03'                                                                             " & vbNewLine _
                                                & "AND CUSTDTL.SYS_DEL_FLG  = '0'                                                                              " & vbNewLine _
                                                & "--区分マスタ(LMC670 KB0803)                                                                                 " & vbNewLine _
                                                & "LEFT JOIN $LM_MST$..Z_KBN KB0803                                                                            " & vbNewLine _
                                                & "ON  KB0803.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                                & "AND KB0803.KBN_CD       = '18'                                                                              " & vbNewLine _
                                                & "AND KB0803.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                                & "--荷主明細マスタ(LMC660にてSET_NAIYO：支払コード取得)2012.05.25                                             " & vbNewLine _
                                                & "LEFT JOIN $LM_MST$..M_CUST_DETAILS MCD_SAI                                                                  " & vbNewLine _
                                                & "ON  MCD_SAI.NRS_BR_CD    = OUTL.NRS_BR_CD                                                                   " & vbNewLine _
                                                & "AND MCD_SAI.CUST_CD      = OUTL.CUST_CD_L                                                                   " & vbNewLine _
                                                & "--AND MCD_SAI.CUST_CD_EDA  = OUTL.CUST_CD_M                                                                 " & vbNewLine _
                                                & "AND MCD_SAI.SUB_KB       = '27'                                                                             " & vbNewLine _
                                                & "AND MCD_SAI.SYS_DEL_FLG  = '0'                                                                              " & vbNewLine _
                                                & "--荷主明細マスタ(LMC669にてSET_NAIYO：荷送人名称取得)2012.06.01                                             " & vbNewLine _
                                                & "  LEFT JOIN $LM_MST$..M_CUST_DETAILS MCD_NFC                                                                " & vbNewLine _
                                                & "ON MCD_NFC.NRS_BR_CD   = OUTL.NRS_BR_CD                                                                     " & vbNewLine _
                                                & "AND MCD_NFC.CUST_CD      = OUTL.CUST_CD_L                                                                   " & vbNewLine _
                                                & "AND MCD_NFC.SUB_KB       = '29'                                                                             " & vbNewLine _
                                                & "AND MCD_NFC.SYS_DEL_FLG  = '0'                                                                              " & vbNewLine _
                                                & "--要望番号1383 [LMC664] --- START ---                                                                       " & vbNewLine _
                                                & "LEFT JOIN (SELECT NRS_BR_CD   AS NRS_BR_CD                                                                  " & vbNewLine _
                                                & "                 , CUST_CD     AS CUST_CD                                                                   " & vbNewLine _
                                                & "                 , CUST_CLASS  AS CUST_CLASS                                                                " & vbNewLine _
                                                & "                 , SET_NAIYO   AS CUST_NAIYO_1                                                              " & vbNewLine _
                                                & "                 , SET_NAIYO_2 AS CUST_NAIYO_2                                                              " & vbNewLine _
                                                & "                 , SET_NAIYO_3 AS CUST_NAIYO_3                                                              " & vbNewLine _
                                                & "              FROM $LM_MST$..M_CUST_DETAILS                                                                 " & vbNewLine _
                                                & "             WHERE SUB_KB ='42'                                                                             " & vbNewLine _
                                                & "               AND SET_NAIYO_2 = @RPT_ID                                                                   " & vbNewLine _
                                                & "               AND SYS_DEL_FLG = '0'                                                                        " & vbNewLine _
                                                & "            ) MCD_CUST                                                                                      " & vbNewLine _
                                                & "        ON CST.NRS_BR_CD = MCD_CUST.NRS_BR_CD                                                               " & vbNewLine _
                                                & "       AND (CASE WHEN MCD_CUST.CUST_CLASS='00' THEN  CST.CUST_CD_L                                          " & vbNewLine _
                                                & "                 WHEN MCD_CUST.CUST_CLASS='01' THEN (CST.CUST_CD_L + CST.CUST_CD_M)                         " & vbNewLine _
                                                & "                 WHEN MCD_CUST.CUST_CLASS='02' THEN (CST.CUST_CD_L + CST.CUST_CD_M + CST.CUST_CD_S)         " & vbNewLine _
                                                & "                 WHEN MCD_CUST.CUST_CLASS='03' THEN (CST.CUST_CD_L + CST.CUST_CD_M + CST.CUST_CD_S + CST.CUST_CD_SS) " & vbNewLine _
                                                & "            END                                                                                             " & vbNewLine _
                                                & "           ) = MCD_CUST.CUST_CD                                                                             " & vbNewLine _
                                                & "                                                                                                            " & vbNewLine _
                                                & "----まとめから　開始                                                                                        " & vbNewLine _
                                                & ",( SELECT                                                                                                 " & vbNewLine _
                                                & "        OUTL.NRS_BR_CD       AS NRS_BR_CD                                                                 " & vbNewLine _
                                                & "      , OUTL.CUST_CD_L       AS CUST_CD_L                                                                 " & vbNewLine _
                                                & "      , OUTL.CUST_CD_M       AS CUST_CD_M                                                                 " & vbNewLine _
                                                & "      , OUTL.OUTKA_PLAN_DATE AS OUTKA_PLAN_DATE                                                           " & vbNewLine _
                                                & "      , OUTL.ARR_PLAN_DATE   AS ARR_PLAN_DATE                                                             " & vbNewLine _
                                                & "      , UNSOL.UNSO_CD        AS UNSO_CD                                                                   " & vbNewLine _
                                                & "      , UNSOL.UNSO_BR_CD     AS UNSO_BR_CD                                                                " & vbNewLine _
                                                & "      , OUTL.DEST_CD         AS DEST_CD                                                                   " & vbNewLine _
                                                & "      , OUTL.OUTKA_NO_L      AS OUTKA_NO_L                                                                " & vbNewLine _
                                                & "  FROM $LM_TRN$..C_OUTKA_L OUTL                                                                           " & vbNewLine _
                                                & "       LEFT JOIN $LM_TRN$..F_UNSO_L UNSOL                                                                 " & vbNewLine _
                                                & "              ON OUTL.NRS_BR_CD  = UNSOL.NRS_BR_CD                                                        " & vbNewLine _
                                                & "             AND OUTL.OUTKA_NO_L = UNSOL.INOUTKA_NO_L                                                     " & vbNewLine _
                                                & "             AND UNSOL.MOTO_DATA_KB = '20'                                                                " & vbNewLine _
                                                & " WHERE OUTL.SYS_DEL_FLG = '0'                                                                             " & vbNewLine _
                                                & "   AND OUTL.OUTKA_NO_L  = @OUTKA_NO_L )MAT                                                                " & vbNewLine _
                                                & "                                                                                                            " & vbNewLine _
                                                & "----まとめから　終了                                                                                        " & vbNewLine _
                                                & "                                                                                                            " & vbNewLine _
                                                & "-- --要望番号1383 [LMC664] --- END ---                                                                      " & vbNewLine



    ''' <summary>
    ''' 通常印刷用WHERE句
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_WHERE_BPC As String = "WHERE                                                                                            " & vbNewLine _
                                          & "       OUTL.SYS_DEL_FLG     = '0'                                                                " & vbNewLine _
                                          & "   AND OUTL.NRS_BR_CD       = MAT.NRS_BR_CD                                                      " & vbNewLine _
                                          & "   AND OUTL.CUST_CD_L       = MAT.CUST_CD_L                                                      " & vbNewLine _
                                          & "   AND OUTL.CUST_CD_M       = MAT.CUST_CD_M                                                      " & vbNewLine _
                                          & "   AND OUTL.OUTKA_PLAN_DATE = MAT.OUTKA_PLAN_DATE                                                " & vbNewLine _
                                          & "   AND OUTL.ARR_PLAN_DATE   = MAT.ARR_PLAN_DATE                                                  " & vbNewLine _
                                          & "   AND FL.UNSO_CD           = MAT.UNSO_CD                                                        " & vbNewLine _
                                          & "   AND FL.UNSO_BR_CD        = MAT.UNSO_BR_CD                                                     " & vbNewLine _
                                          & "   AND OUTL.DEST_CD         = MAT.DEST_CD                                                        " & vbNewLine _
                                          & "   AND OUTL.OUTKA_NO_L IN(@OUTKA_NO_L)                                                         " & vbNewLine


    ''' <summary>
    ''' 運送グループ条件
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_GROUP_BPC As String = " GROUP BY                                     " & vbNewLine _
                                          & " OUTL.NRS_BR_CD                               " & vbNewLine _
                                          & ",OUTL.OUTKA_PLAN_DATE                         " & vbNewLine _
                                          & ",OUTL.OUTKA_NO_L                              " & vbNewLine _
                                          & ",OUTL.CUST_CD_L                               " & vbNewLine _
                                          & ",OUTL.ARR_PLAN_DATE                           " & vbNewLine _
                                          & ",OUTL.DEST_TEL                                " & vbNewLine _
                                          & ",OUTL.DEST_AD_3                               " & vbNewLine _
                                          & ",OUTL.DEST_TEL                                " & vbNewLine _
                                          & ",OUTL.DEST_CD                                 " & vbNewLine _
                                          & ",OUTL.SHIP_CD_L                               " & vbNewLine _
                                          & ",OUTL.CUST_ORD_NO                             " & vbNewLine _
                                          & ",OUTL.OUTKA_PKG_NB                            " & vbNewLine _
                                          & ",OUTL.OUTKO_DATE                              " & vbNewLine _
                                          & ",OUTL.CUST_CD_M                               " & vbNewLine _
                                          & ",OUTL.DEST_KB                                 " & vbNewLine _
                                          & ",OUTL.DEST_AD_1                               " & vbNewLine _
                                          & ",OUTL.DEST_AD_2                               " & vbNewLine _
                                          & ",OUTL.DEST_NM                                 " & vbNewLine _
                                          & ",OUTL.BUYER_ORD_NO                            " & vbNewLine _
                                          & ",OUTL.REMARK                                  " & vbNewLine _
                                          & ",OUTM.IRIME                                   " & vbNewLine _
                                          & ",OUTM.IRIME_UT                                " & vbNewLine _
                                          & ",OUTM.ALCTD_NB                                " & vbNewLine _
                                          & ",OUTM.CUST_ORD_NO_DTL                         " & vbNewLine _
                                          & ",MG.OUTKA_ATT                                 " & vbNewLine _
                                          & ",MG.SHOBO_CD                                  " & vbNewLine _
                                          & ",CST.DENPYO_NM                                " & vbNewLine _
                                          & ",CST.TEL                                      " & vbNewLine _
                                          & ",CST.AD_1                                     " & vbNewLine _
                                          & ",CST.AD_2                                     " & vbNewLine _
                                          & ",CST.AD_3                                     " & vbNewLine _
                                          & ",CST.CUST_NM_L                                " & vbNewLine _
                                          & ",CST.CUST_NM_M                                " & vbNewLine _
                                          & ",CST.CUST_CD_L                                " & vbNewLine _
                                          & "                                              " & vbNewLine _
                                          & ",SHIPDST.DEST_NM                              " & vbNewLine _
                                          & "                                              " & vbNewLine _
                                          & ",FL.UNSO_WT                                   " & vbNewLine _
                                          & ",FL.UNSO_PKG_NB                               " & vbNewLine _
                                          & ",FL.REMARK                                    " & vbNewLine _
                                          & ",FL.NB_UT                                     " & vbNewLine _
                                          & "                                              " & vbNewLine _
                                          & ",NB.NRS_BR_NM                                 " & vbNewLine _
                                          & ",NB.AD_1                                      " & vbNewLine _
                                          & ",NB.AD_2                                      " & vbNewLine _
                                          & ",NB.AD_3                                      " & vbNewLine _
                                          & ",NB.TEL                                       " & vbNewLine _
                                          & ",NB.FAX                                       " & vbNewLine _
                                          & ",NB.ZIP                                       " & vbNewLine _
                                          & "                                              " & vbNewLine _
                                          & ",KB0803.KBN_NM1                               " & vbNewLine _
                                          & ",KB0803.KBN_NM2                               " & vbNewLine _
                                          & ",KB0803.KBN_NM3                               " & vbNewLine _
                                          & ",KB0803.KBN_NM4                               " & vbNewLine _
                                          & "                                              " & vbNewLine _
                                          & ",CUSTDTL.SET_NAIYO                            " & vbNewLine _
                                          & "                                              " & vbNewLine _
                                          & ",MCD_SAI.SET_NAIYO                            " & vbNewLine _
                                          & ",MCD_SAI.SET_NAIYO_3                          " & vbNewLine _
                                          & ",MCD_SAI.SET_NAIYO_2                          " & vbNewLine _
                                          & "                                              " & vbNewLine _
                                          & ",MCD_NFC.SET_NAIYO                            " & vbNewLine _
                                          & ",MCD_NFC.SET_NAIYO_2                          " & vbNewLine _
                                          & ",MCD_NFC.SET_NAIYO_3                          " & vbNewLine _
                                          & "                                              " & vbNewLine _
                                          & ",KB08.KBN_NM1                                 " & vbNewLine _
                                          & ",KB08.KBN_NM3                                 " & vbNewLine _
                                          & ",KB08.KBN_NM5                                 " & vbNewLine _
                                          & "                                              " & vbNewLine _
                                          & ",MR1.PTN_CD                                   " & vbNewLine _
                                          & ",MR1.RPT_ID                                   " & vbNewLine _
                                          & ",MR2.PTN_CD                                   " & vbNewLine _
                                          & ",MR2.RPT_ID                                   " & vbNewLine _
                                          & "                                              " & vbNewLine _
                                          & ",KB02.KBN_NM1                                 " & vbNewLine _
                                          & "                                              " & vbNewLine _
                                          & ",EDIL.DEST_AD_1                               " & vbNewLine _
                                          & ",EDIL.DEST_AD_2                               " & vbNewLine _
                                          & ",EDIL.DEST_NM                                 " & vbNewLine _
                                          & ",EDIL.DEST_ZIP                                " & vbNewLine _
                                          & "                                              " & vbNewLine _
                                          & ",DST.AD_1                                     " & vbNewLine _
                                          & ",DST.AD_2                                     " & vbNewLine _
                                          & ",DST.DEST_NM                                  " & vbNewLine _
                                          & ",DST.ZIP                                      " & vbNewLine _
                                          & "                                              " & vbNewLine _
                                          & ",MAT.NRS_BR_CD                              " & vbNewLine _
                                          & ",MAT.OUTKA_NO_L                             " & vbNewLine _
                                          & ",MAT.CUST_CD_L                              " & vbNewLine _
                                          & ",MAT.CUST_CD_M                              " & vbNewLine _
                                          & ",MAT.OUTKA_PLAN_DATE                        " & vbNewLine _
                                          & ",MAT.ARR_PLAN_DATE                          " & vbNewLine _
                                          & ",MAT.DEST_CD                                " & vbNewLine _
                                          & "                                              " & vbNewLine _
                                          & "ORDER BY                                      " & vbNewLine _
                                          & "                                              " & vbNewLine _
                                          & "     OUTL.NRS_BR_CD                           " & vbNewLine _
                                          & "    ,OUTL.OUTKA_NO_L                          " & vbNewLine

    ''' <summary>
    ''' データ抽出用FROM句浮間用(☆★作業用コメント：20110711)
    ''' 明細出力のため、SQL_FROMにあった"WHERE BASE.NUM=をコメントアウトし、
    ''' 商品分だけレコードを出力。
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_FROM_BPC_MATOME As String = "FROM                                                                                           " & vbNewLine _
                                     & "$LM_TRN$..C_OUTKA_L OUTL                                                                                    " & vbNewLine _
                                     & "--(2012.09.11)要望番号1412対応  --- START ---                                                               " & vbNewLine _
                                     & "--出荷EDIL                                                                                                  " & vbNewLine _
                                     & "--LEFT JOIN                                                                                                 " & vbNewLine _
                                     & "-- (                                                                                                        " & vbNewLine _
                                     & "--  SELECT                                                                                                  " & vbNewLine _
                                     & "--        MIN(DEST_AD_1)   AS DEST_AD_1                                                                     " & vbNewLine _
                                     & "--       ,MIN(DEST_AD_2)   AS DEST_AD_2                                                                     " & vbNewLine _
                                     & "--       ,DEST_AD_3                                                                                         " & vbNewLine _
                                     & "--       ,DEST_TEL                                                                                          " & vbNewLine _
                                     & "--       ,DEST_ZIP                                                                                          " & vbNewLine _
                                     & "--       ,FREE_C15                                                                                          " & vbNewLine _
                                     & "--       ,MIN(DEST_NM)     AS DEST_NM                                                                       " & vbNewLine _
                                     & "--       ,NRS_BR_CD                                                                                         " & vbNewLine _
                                     & "--       ,OUTKA_CTL_NO                                                                                      " & vbNewLine _
                                     & "--       ,SHIP_NM_L                                                                                         " & vbNewLine _
                                     & "--       ,SYS_DEL_FLG                                                                                       " & vbNewLine _
                                     & "--       ,FREE_C05                                                                                          " & vbNewLine _
                                     & "--       --,REMARK                    --2012.07.24 丸和運輸　荷受人氏名下の注意書き                         " & vbNewLine _
                                     & "--       ,MIN(REMARK)      AS REMARK  --2012.08.21 要望番号1355                                             " & vbNewLine _
                                     & "--  FROM                                                                                                    " & vbNewLine _
                                     & "--        $LM_TRN$..H_OUTKAEDI_L                                                                            " & vbNewLine _
                                     & "--  GROUP BY                                                                                                " & vbNewLine _
                                     & "--        DEST_AD_3                                                                                         " & vbNewLine _
                                     & "--       ,DEST_TEL                                                                                          " & vbNewLine _
                                     & "--       ,DEST_ZIP                                                                                          " & vbNewLine _
                                     & "--       ,FREE_C15                                                                                          " & vbNewLine _
                                     & "--       ,NRS_BR_CD                                                                                         " & vbNewLine _
                                     & "--       ,OUTKA_CTL_NO                                                                                      " & vbNewLine _
                                     & "--       ,SHIP_NM_L                                                                                         " & vbNewLine _
                                     & "--       ,SYS_DEL_FLG                                                                                       " & vbNewLine _
                                     & "--       ,FREE_C05                                                                                          " & vbNewLine _
                                     & "--       --,REMARK   --2012.07.24 丸和運輸　荷受人氏名下の注意書き   2012.08.21 要望番号1355 コメント化     " & vbNewLine _
                                     & "-- )                                                                                                        " & vbNewLine _
                                     & "--  EDIL                                                                                                    " & vbNewLine _
                                     & "--ON   EDIL.NRS_BR_CD   = OUTL.NRS_BR_CD                                                                    " & vbNewLine _
                                     & "--AND EDIL.OUTKA_CTL_NO = OUTL.OUTKA_NO_L                                                                   " & vbNewLine _
                                     & "--AND EDIL.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--AND EDIL.NRS_BR_CD    = OUTL.NRS_BR_CD                                                                    " & vbNewLine _
                                     & "--下記の内容に変更                                                                                          " & vbNewLine _
                                     & " LEFT JOIN (                                                                                                " & vbNewLine _
                                     & "            SELECT                                                                                          " & vbNewLine _
                                     & "                   NRS_BR_CD                                                                                " & vbNewLine _
                                     & "                 , EDI_CTL_NO                                                                               " & vbNewLine _
                                     & "                 , OUTKA_CTL_NO                                                                             " & vbNewLine _
                                     & "             FROM (                                                                                         " & vbNewLine _
                                     & "                    SELECT                                                                                  " & vbNewLine _
                                     & "                           EDIOUTL.NRS_BR_CD                                                                " & vbNewLine _
                                     & "                         , EDIOUTL.EDI_CTL_NO                                                               " & vbNewLine _
                                     & "                         , EDIOUTL.OUTKA_CTL_NO                                                             " & vbNewLine _
                                     & "                         , CASE WHEN EDIOUTL.OUTKA_CTL_NO = '' THEN 1                                       " & vbNewLine _
                                     & "                           ELSE ROW_NUMBER() OVER (PARTITION BY EDIOUTL.NRS_BR_CD                           " & vbNewLine _
                                     & "                                                              , EDIOUTL.OUTKA_CTL_NO                        " & vbNewLine _
                                     & "                                                       ORDER BY EDIOUTL.NRS_BR_CD                           " & vbNewLine _
                                     & "                                                              , EDIOUTL.EDI_CTL_NO                          " & vbNewLine _
                                     & "                                                  )                                                         " & vbNewLine _
                                     & "                           END AS IDX                                                                       " & vbNewLine _
                                     & "                      FROM $LM_TRN$..H_OUTKAEDI_L EDIOUTL                                                   " & vbNewLine _
                                     & "                     WHERE EDIOUTL.SYS_DEL_FLG  = '0'                                                       " & vbNewLine _
                                     & "                       AND EDIOUTL.NRS_BR_CD    = @NRS_BR_CD                                                " & vbNewLine _
                                     & "--要望管理1451                   AND EDIOUTL.OUTKA_CTL_NO = @OUTKA_NO_L                                               " & vbNewLine _
                                     & "                   ) EBASE                                                                                  " & vbNewLine _
                                     & "            WHERE EBASE.IDX = 1                                                                             " & vbNewLine _
                                     & "            ) TOPEDI                                                                                        " & vbNewLine _
                                     & "        ON TOPEDI.NRS_BR_CD    = OUTL.NRS_BR_CD                                                             " & vbNewLine _
                                     & "       AND TOPEDI.OUTKA_CTL_NO = OUTL.OUTKA_NO_L                                                            " & vbNewLine _
                                     & " LEFT JOIN $LM_TRN$..H_OUTKAEDI_L EDIL                                                                      " & vbNewLine _
                                     & "        ON EDIL.NRS_BR_CD  = TOPEDI.NRS_BR_CD                                                               " & vbNewLine _
                                     & "       AND EDIL.EDI_CTL_NO = TOPEDI.EDI_CTL_NO                                                              " & vbNewLine _
                                     & "--(2012.09.11)要望番号1412対応  ---  END  ---                                                               " & vbNewLine _
                                     & "--出荷M                                                                                                     " & vbNewLine _
                                     & "LEFT JOIN                                                                                                   " & vbNewLine _
                                     & "(SELECT                                                                                                     " & vbNewLine _
                                     & "*                                                                                                           " & vbNewLine _
                                     & "FROM                                                                                                        " & vbNewLine _
                                     & "(SELECT                                                                                                     " & vbNewLine _
                                     & "--(2012.06.18)要望番号1160対応 --- START ----                                                               " & vbNewLine _
                                     & "--   NRS_BR_CD                                                                                              " & vbNewLine _
                                     & "--  ,GOODS_CD_NRS                                                                                           " & vbNewLine _
                                     & "--  ,IRIME                                                                                                  " & vbNewLine _
                                     & "--  ,IRIME_UT                                                                                               " & vbNewLine _
                                     & "--  ,ALCTD_NB                                                                                               " & vbNewLine _
                                     & "--  ,LOT_NO                                                                                                 " & vbNewLine _
                                     & "--  ,CUST_ORD_NO_DTL   --2012/06/11浮間対応                                                                 " & vbNewLine _
                                     & "--  ,SYS_DEL_FLG                                                                                            " & vbNewLine _
                                     & "--  ,ROW_NUMBER() OVER (PARTITION BY NRS_BR_CD ORDER BY OUTKA_NO_L,OUTKA_NO_M) AS NUM                       " & vbNewLine _
                                     & "   M.NRS_BR_CD                                                                                              " & vbNewLine _
                                     & "  ,M.GOODS_CD_NRS                                                                                           " & vbNewLine _
                                     & "  ,M.IRIME                                                                                                  " & vbNewLine _
                                     & "  ,M.IRIME_UT                                                                                               " & vbNewLine _
                                     & "  ,M.ALCTD_NB                                                                                               " & vbNewLine _
                                     & "  ,M.ALCTD_QT                                                                                               " & vbNewLine _
                                     & "  ,M.LOT_NO                                                                                                 " & vbNewLine _
                                     & "  ,M.CUST_ORD_NO_DTL   --2012/06/11浮間対応                                                                 " & vbNewLine _
                                     & "  ,M.SYS_DEL_FLG                                                                                            " & vbNewLine _
                                     & "  ,ROW_NUMBER() OVER (PARTITION BY M.NRS_BR_CD ORDER BY M.OUTKA_NO_L,M.OUTKA_NO_M) AS NUM                   " & vbNewLine _
                                     & "  ,M.OUTKA_NO_L                                                                                             " & vbNewLine _
                                     & "  ,M.OUTKA_NO_M                                                                                             " & vbNewLine _
                                     & "  ,M.PRINT_SORT                                                                                             " & vbNewLine _
                                     & "  FROM                                                                                                      " & vbNewLine _
                                     & "--(2012.06.18)要望番号1160対応 ---  END  ----                                                               " & vbNewLine _
                                     & "   $LM_TRN$..C_OUTKA_M M                                                                                    " & vbNewLine _
                                     & "--(2012.06.18)要望番号1160対応 --- START ----                                                               " & vbNewLine _
                                     & "   LEFT JOIN $LM_TRN$..C_OUTKA_L OUTL                                                                       " & vbNewLine _
                                     & "          ON OUTL.NRS_BR_CD  = M.NRS_BR_CD                                                                  " & vbNewLine _
                                     & "         AND OUTL.OUTKA_NO_L = M.OUTKA_NO_L                                                                 " & vbNewLine _
                                     & "         AND OUTL.SYS_DEL_FLG  = '0'                                                                        " & vbNewLine _
                                     & "   LEFT JOIN $LM_TRN$..F_UNSO_L FL                                                                          " & vbNewLine _
                                     & "          ON FL.NRS_BR_CD    = M.NRS_BR_CD                                                                  " & vbNewLine _
                                     & "         AND FL.INOUTKA_NO_L = M.OUTKA_NO_L                                                                 " & vbNewLine _
                                     & "         AND FL.MOTO_DATA_KB = '20'                                                                         " & vbNewLine _
                                     & "         AND FL.SYS_DEL_FLG  = '0'                                                                          " & vbNewLine _
                                     & "--(2012.06.18)要望番号1160対応 ---  END  ----                                                               " & vbNewLine _
                                     & "  WHERE                                                                                                     " & vbNewLine _
                                     & "      M.NRS_BR_CD = @NRS_BR_CD                                                                              " & vbNewLine _
                                     & "--(2012.06.18)要望番号1160対応 --- START ----                                                               " & vbNewLine _
                                     & "    AND OUTL.CUST_CD_L       = @CUST_CD_L                                                                   " & vbNewLine _
                                     & "    AND OUTL.CUST_CD_M       = @CUST_CD_M                                                                   " & vbNewLine _
                                     & "    AND OUTL.OUTKA_PLAN_DATE = @OUTKA_PLAN_DATE                                                             " & vbNewLine _
                                     & "    AND OUTL.ARR_PLAN_DATE   = @ARR_PLAN_DATE                                                               " & vbNewLine _
                                     & "    AND FL.UNSO_CD           = @UNSO_CD                                                                     " & vbNewLine _
                                     & "    AND FL.UNSO_BR_CD        = @UNSO_BR_CD                                                                  " & vbNewLine _
                                     & "    AND OUTL.DEST_CD         = @DEST_CD                                                                     " & vbNewLine _
                                     & "    AND M.OUTKA_NO_L IN(@OUTKA_NO_L)                                                                        " & vbNewLine _
                                     & "--  AND SYS_DEL_FLG = '0'                                                                                   " & vbNewLine _
                                     & "    AND M.SYS_DEL_FLG = '0'                                                                                 " & vbNewLine _
                                     & "--(2012.06.18)要望番号1160対応 ---  END  ----                                                               " & vbNewLine _
                                     & " ) AS BASE                                                                                                  " & vbNewLine _
                                     & "-- WHERE                                                                                                    " & vbNewLine _
                                     & "-- BASE.NUM = 1                                                                                             " & vbNewLine _
                                     & ") OUTM                                                                                                      " & vbNewLine _
                                     & "--ON                                                                                                        " & vbNewLine _
                                     & "--1 = 1                                                                                                     " & vbNewLine _
                                     & "--(2012.06.18)要望番号1160対応 --- START ----                                                               " & vbNewLine _
                                     & " ON OUTL.NRS_BR_CD  = OUTM.NRS_BR_CD                                                                        " & vbNewLine _
                                     & "AND OUTL.OUTKA_NO_L = OUTM.OUTKA_NO_L                                                                       " & vbNewLine _
                                     & "--(2012.06.18)要望番号1160対応 ---  END  ----                                                               " & vbNewLine _
                                     & "--F運送L                                                                                                    " & vbNewLine _
                                     & "LEFT JOIN $LM_TRN$..F_UNSO_L FL                                                                             " & vbNewLine _
                                     & "ON  FL.MOTO_DATA_KB   = '20'                                                                                " & vbNewLine _
                                     & "AND FL.NRS_BR_CD      = OUTL.NRS_BR_CD                                                                      " & vbNewLine _
                                     & "AND FL.INOUTKA_NO_L   = OUTL.OUTKA_NO_L                                                                     " & vbNewLine _
                                     & "AND FL.SYS_DEL_FLG    = '0'                                                                                 " & vbNewLine _
                                     & "--出荷EDI L                                                                                                 " & vbNewLine _
                                     & "--LEFT JOIN $LM_TRN$..H_OUTKAEDI_L OUTKAEDIL                                                                  " & vbNewLine _
                                     & "--ON  OUTKAEDIL.NRS_BR_CD     = OUTL.NRS_BR_CD                                                                " & vbNewLine _
                                     & "--AND OUTKAEDIL.OUTKA_CTL_NO  = OUTL.OUTKA_NO_L                                                               " & vbNewLine _
                                     & "--AND OUTKAEDIL.SYS_DEL_FLG   = '0'                                                                           " & vbNewLine _
                                     & "--商品M                                                                                                     " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_GOODS MG                                                                              " & vbNewLine _
                                     & "ON  MG.NRS_BR_CD     = OUTM.NRS_BR_CD                                                                       " & vbNewLine _
                                     & "AND MG.GOODS_CD_NRS  = OUTM.GOODS_CD_NRS                                                                    " & vbNewLine _
                                     & "AND MG.SYS_DEL_FLG   = '0'                                                                                  " & vbNewLine _
                                     & "--荷主なしでの運送会社荷主別送り状パターン取得                                                              " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_UNSO_CUST_RPT MCR1                                                                    " & vbNewLine _
                                     & "ON  FL.NRS_BR_CD     = MCR1.NRS_BR_CD                                                                       " & vbNewLine _
                                     & "AND FL.UNSO_CD       = MCR1.UNSOCO_CD                                                                       " & vbNewLine _
                                     & "AND FL.UNSO_BR_CD    = MCR1.UNSOCO_BR_CD                                                                    " & vbNewLine _
                                     & "AND '11'             = MCR1.PTN_ID                                                                          " & vbNewLine _
                                     & "AND FL.PC_KB         = MCR1.MOTO_TYAKU_KB                                                                   " & vbNewLine _
                                     & "AND ''               = MCR1.CUST_CD_L                                                                       " & vbNewLine _
                                     & "AND ''               = MCR1.CUST_CD_M                                                                       " & vbNewLine _
                                     & "AND MCR1.SYS_DEL_FLG = '0'                                                                                  " & vbNewLine _
                                     & "--帳票パターン取得                                                                                          " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_RPT MR1                                                                               " & vbNewLine _
                                     & "ON  MR1.NRS_BR_CD   = MCR1.NRS_BR_CD                                                                        " & vbNewLine _
                                     & "AND MR1.PTN_ID      = MCR1.PTN_ID                                                                           " & vbNewLine _
                                     & "AND MR1.PTN_CD      = MCR1.PTN_CD                                                                           " & vbNewLine _
                                     & "AND MR1.SYS_DEL_FLG = '0'                                                                                   " & vbNewLine _
                                     & "--荷主込みでの運送会社荷主別送り状パターン取得                                                              " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_UNSO_CUST_RPT MCR2                                                                    " & vbNewLine _
                                     & "ON  FL.NRS_BR_CD     = MCR2.NRS_BR_CD                                                                       " & vbNewLine _
                                     & "AND FL.UNSO_CD       = MCR2.UNSOCO_CD                                                                       " & vbNewLine _
                                     & "AND FL.UNSO_BR_CD    = MCR2.UNSOCO_BR_CD                                                                    " & vbNewLine _
                                     & "AND '11'             = MCR2.PTN_ID                                                                          " & vbNewLine _
                                     & "AND FL.PC_KB         = MCR2.MOTO_TYAKU_KB                                                                   " & vbNewLine _
                                     & "AND FL.CUST_CD_L     = MCR2.CUST_CD_L                                                                       " & vbNewLine _
                                     & "AND FL.CUST_CD_M     = MCR2.CUST_CD_M                                                                       " & vbNewLine _
                                     & "AND MCR2.SYS_DEL_FLG = '0'                                                                                  " & vbNewLine _
                                     & "--帳票パターン取得                                                                                          " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_RPT MR2                                                                               " & vbNewLine _
                                     & "ON  MR2.NRS_BR_CD    = MCR2.NRS_BR_CD                                                                       " & vbNewLine _
                                     & "AND MR2.PTN_ID       = MCR2.PTN_ID                                                                          " & vbNewLine _
                                     & "AND MR2.PTN_CD       = MCR2.PTN_CD                                                                          " & vbNewLine _
                                     & "AND MR2.SYS_DEL_FLG  = '0'                                                                                  " & vbNewLine _
                                     & "--存在しない場合の帳票パターン取得                                                                          " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_RPT MR3                                                                               " & vbNewLine _
                                     & "ON  MR3.NRS_BR_CD     = OUTL.NRS_BR_CD                                                                      " & vbNewLine _
                                     & "AND MR3.PTN_ID        = '11'                                                                                " & vbNewLine _
                                     & "AND MR3.STANDARD_FLAG = '01'                                                                                " & vbNewLine _
                                     & "AND MR3.SYS_DEL_FLG   = '0'                                                                                 " & vbNewLine _
                                     & "--荷主マスタ (ここからメインプリント用)                                                               " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_CUST CST                                                                              " & vbNewLine _
                                     & "ON  CST.NRS_BR_CD     = MG.NRS_BR_CD                                                                        " & vbNewLine _
                                     & "AND CST.CUST_CD_L     = MG.CUST_CD_L                                                                        " & vbNewLine _
                                     & "AND CST.CUST_CD_M     = MG.CUST_CD_M                                                                        " & vbNewLine _
                                     & "AND CST.CUST_CD_S     = MG.CUST_CD_S                                                                        " & vbNewLine _
                                     & "AND CST.CUST_CD_SS    = MG.CUST_CD_SS                                                                       " & vbNewLine _
                                     & "AND CST.SYS_DEL_FLG   = '0'                                                                                 " & vbNewLine _
                                     & "--届先マスタ                                                                                                " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_DEST DST                                                                              " & vbNewLine _
                                     & "ON  DST.NRS_BR_CD     = OUTL.NRS_BR_CD                                                                      " & vbNewLine _
                                     & "AND DST.CUST_CD_L     = OUTL.CUST_CD_L                                                                      " & vbNewLine _
                                     & "AND DST.DEST_CD       = OUTL.DEST_CD                                                                        " & vbNewLine _
                                     & "AND DST.SYS_DEL_FLG   = '0'                                                                                 " & vbNewLine _
                                     & "--届先マスタ                                                                                                " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_DEST SHIPDST                                                                          " & vbNewLine _
                                     & "ON  SHIPDST.NRS_BR_CD     = OUTL.NRS_BR_CD                                                                  " & vbNewLine _
                                     & "AND SHIPDST.CUST_CD_L     = OUTL.CUST_CD_L                                                                  " & vbNewLine _
                                     & "AND SHIPDST.DEST_CD       = OUTL.SHIP_CD_L                                                                  " & vbNewLine _
                                     & "AND SHIPDST.SYS_DEL_FLG   = '0'                                                                             " & vbNewLine _
                                     & "--営業所マスタ                                                                                              " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_NRS_BR NB                                                                             " & vbNewLine _
                                     & "ON  NB.NRS_BR_CD      = OUTL.NRS_BR_CD                                                                      " & vbNewLine _
                                     & "AND NB.SYS_DEL_FLG    = '0'                                                                                 " & vbNewLine _
                                     & "--商品明細                                                                                                  " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_GOODS_DETAILS MGD                                                                     " & vbNewLine _
                                     & "ON  MGD.NRS_BR_CD       = OUTM.NRS_BR_CD                                                                    " & vbNewLine _
                                     & "AND MGD.GOODS_CD_NRS    = OUTM.GOODS_CD_NRS                                                                 " & vbNewLine _
                                     & "AND MGD.SUB_KB          = '01'                                                                              " & vbNewLine _
                                     & "AND MGD.SYS_DEL_FLG     = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC560支店TEL(NM4)・支店名(NM3))KB01                                                           " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB01                                                                              " & vbNewLine _
                                     & "ON  KB01.KBN_GROUP_CD = 'O007'                                                                              " & vbNewLine _
                                     & "AND KB01.KBN_CD       = '01'                                                                                " & vbNewLine _
                                     & "AND KB01.SYS_DEL_FLG  = '0'                                                                                 " & vbNewLine _
                                     & "--区分マスタ(納期文言)KB02                                                                                  " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB02                                                                              " & vbNewLine _
                                     & "ON  KB02.KBN_GROUP_CD = 'N010'                                                                              " & vbNewLine _
                                     & "AND KB02.KBN_CD       = OUTL.ARR_PLAN_TIME                                                                  " & vbNewLine _
                                     & "AND KB02.SYS_DEL_FLG  = '0'                                                                                 " & vbNewLine _
                                     & "--区分マスタ(LMC563支店名(NM3)、電話番号(NM4))KB03                                                          " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB03                                                                              " & vbNewLine _
                                     & "ON  KB03.KBN_GROUP_CD = 'O007'                                                                              " & vbNewLine _
                                     & "AND KB03.KBN_CD       = '10'                                                                                " & vbNewLine _
                                     & "AND KB03.SYS_DEL_FLG  = '0'                                                                                 " & vbNewLine _
                                     & "--区分マスタ(LMC563支払支店コード(NM3))KB0401                                                               " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0401                                                                            " & vbNewLine _
                                     & "ON  KB0401.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0401.KBN_CD       = '11'                                                                              " & vbNewLine _
                                     & "AND KB0401.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC563支払支店コード(NM3))KB0402                                                               " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0402                                                                            " & vbNewLine _
                                     & "ON  KB0402.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0402.KBN_CD       = '12'                                                                              " & vbNewLine _
                                     & "AND KB0402.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC563支払支店コード(NM3))KB0403                                                               " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0403                                                                            " & vbNewLine _
                                     & "ON  KB0403.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0403.KBN_CD       = '13'                                                                              " & vbNewLine _
                                     & "AND KB0403.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC563支払支店コード(NM3))KB0404                                                               " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0404                                                                            " & vbNewLine _
                                     & "ON  KB0404.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0404.KBN_CD       = '14'                                                                              " & vbNewLine _
                                     & "AND KB0404.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC563支払支店コード(NM3))KB0405                                                               " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0405                                                                            " & vbNewLine _
                                     & "ON  KB0405.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0405.KBN_CD       = '15'                                                                              " & vbNewLine _
                                     & "AND KB0405.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC564支店TEL、荷主TEL(NM4)・支店名(NM3))KB05                                                  " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB05                                                                              " & vbNewLine _
                                     & "ON  KB05.KBN_GROUP_CD   = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB05.KBN_CD         = '02'                                                                              " & vbNewLine _
                                     & "AND KB05.SYS_DEL_FLG    = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC565支払いコード(NM3)KB0601)                                                                 " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0601                                                                            " & vbNewLine _
                                     & "ON  KB0601.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0601.KBN_CD       = '07'                                                                              " & vbNewLine _
                                     & "AND KB0601.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC565支払いコード(NM3)KB0602)                                                                 " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0602                                                                            " & vbNewLine _
                                     & "ON  KB0602.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0602.KBN_CD       = '08'                                                                              " & vbNewLine _
                                     & "AND KB0602.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC568荷主コード(NM5)KB0701                                                                    " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0701                                                                            " & vbNewLine _
                                     & "ON  KB0701.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0701.KBN_CD       = '03'                                                                              " & vbNewLine _
                                     & "AND KB0701.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC568荷主コード(NM5)KB0702                                                                    " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0702                                                                            " & vbNewLine _
                                     & "ON  KB0702.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0702.KBN_CD       = '09'                                                                              " & vbNewLine _
                                     & "AND KB0702.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC569固定表示(NM1,3,4))KB08                                                                   " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB08                                                                              " & vbNewLine _
                                     & "ON  KB08.KBN_GROUP_CD   = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB08.KBN_CD         = '04'                                                                              " & vbNewLine _
                                     & "AND KB08.SYS_DEL_FLG    = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC570支店名(NM3)支店TEL(NM4))KB1001                                                           " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB1001                                                                            " & vbNewLine _
                                     & "ON  KB1001.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB1001.KBN_CD       = '05'                                                                              " & vbNewLine _
                                     & "AND KB1001.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC570支店名(NM3)支店TEL(NM4))KB1002                                                           " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB1002                                                                            " & vbNewLine _
                                     & "ON  KB1002.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB1002.KBN_CD       = '06'                                                                              " & vbNewLine _
                                     & "AND KB1002.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--荷主明細マスタ(LMC573にて運送契約荷主コード取得)                                                          " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_CUST_DETAILS CUSTDTL                                                                  " & vbNewLine _
                                     & "ON  CUSTDTL.NRS_BR_CD    = OUTL.NRS_BR_CD                                                                   " & vbNewLine _
                                     & "AND CUSTDTL.CUST_CD      = OUTL.CUST_CD_L + OUTL.CUST_CD_M                                                  " & vbNewLine _
                                     & "AND CUSTDTL.SUB_KB       = '03'                                                                             " & vbNewLine _
                                     & "AND CUSTDTL.SYS_DEL_FLG  = '0'                                                                              " & vbNewLine _
                                     & "--区分マスタ(LMC575支払コード(NM3)KB0801)                                                                   " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0801                                                                            " & vbNewLine _
                                     & "ON  KB0801.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0801.KBN_CD       = '16'                                                                              " & vbNewLine _
                                     & "AND KB0801.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC575支払コード(NM3)KB0802)                                                                   " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0802                                                                            " & vbNewLine _
                                     & "ON  KB0802.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0802.KBN_CD       = '17'                                                                              " & vbNewLine _
                                     & "AND KB0802.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC670 KB0803)                                                                                 " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0803                                                                            " & vbNewLine _
                                     & "ON  KB0803.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0803.KBN_CD       = '18'                                                                              " & vbNewLine _
                                     & "AND KB0803.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_DEST      DEST_JIS --2012.05.25                                                       " & vbNewLine _
                                     & "ON  DEST_JIS.NRS_BR_CD    = OUTL.NRS_BR_CD                                                                  " & vbNewLine _
                                     & "AND DEST_JIS.CUST_CD_L    = OUTL.CUST_CD_L                                                                  " & vbNewLine _
                                     & "AND DEST_JIS.DEST_CD      = OUTL.DEST_CD                                                                    " & vbNewLine _
                                     & "AND DEST_JIS.SYS_DEL_FLG  = '0'                                                                             " & vbNewLine _
                                     & "--JISマスタ(LMC661にてJIS_CD2桁：都道府県コード取得)2012.05.25                                              " & vbNewLine _
                                     & "  LEFT JOIN  $LM_MST$..M_JIS   JIS                                                                          " & vbNewLine _
                                     & "  ON  JIS.JIS_CD       = DEST_JIS.JIS                                                                       " & vbNewLine _
                                     & " AND  JIS.SYS_DEL_FLG  = '0'                                                                                " & vbNewLine _
                                     & "--運送会社マスタ(LMC589にてUNSOCO_NM：取次先運送会社名取得)2012.05.25                                       " & vbNewLine _
                                     & "--  LEFT JOIN  $LM_MST$..M_UNSOCO   MUC                                                                     " & vbNewLine _
                                     & "--  ON  MUC.NRS_BR_CD    = FL.NRS_BR_CD                                                                     " & vbNewLine _
                                     & "-- AND  MUC.UNSOCO_CD    = FL.UNSO_CD                                                                       " & vbNewLine _
                                     & "-- AND  MUC.UNSOCO_BR_CD = FL.UNSO_BR_CD                                                                    " & vbNewLine _
                                     & "-- AND  MUC.SYS_DEL_FLG  = '0'                                                                              " & vbNewLine _
                                     & "--荷主明細マスタ(LMC660にてSET_NAIYO：支払コード取得)2012.05.25                                             " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_CUST_DETAILS MCD_SAI                                                                  " & vbNewLine _
                                     & "ON  MCD_SAI.NRS_BR_CD    = OUTL.NRS_BR_CD                                                                   " & vbNewLine _
                                     & "AND MCD_SAI.CUST_CD      = OUTL.CUST_CD_L                                                                   " & vbNewLine _
                                     & "--AND MCD_SAI.CUST_CD_EDA  = OUTL.CUST_CD_M                                                                   " & vbNewLine _
                                     & "AND MCD_SAI.SUB_KB       = '27'                                                                             " & vbNewLine _
                                     & "AND MCD_SAI.SYS_DEL_FLG  = '0'                                                                              " & vbNewLine _
                                     & "--荷主明細マスタ(LMC669にてSET_NAIYO：荷送人名称取得)2012.06.01                                             " & vbNewLine _
                                     & "  LEFT JOIN $LM_MST$..M_CUST_DETAILS MCD_NFC                                                                " & vbNewLine _
                                     & "ON MCD_NFC.NRS_BR_CD   = OUTL.NRS_BR_CD                                                                     " & vbNewLine _
                                     & "AND MCD_NFC.CUST_CD      = OUTL.CUST_CD_L                                                                   " & vbNewLine _
                                     & "--AND MCD_NFC.CUST_CD_EDA  = OUTL.CUST_CD_M                                                                   " & vbNewLine _
                                     & "AND MCD_NFC.SUB_KB       = '29'                                                                             " & vbNewLine _
                                     & "AND MCD_NFC.SYS_DEL_FLG  = '0'                                                                              " & vbNewLine _
                                     & "--WHERE                                                                                                       " & vbNewLine _
                                     & "--    OUTL.SYS_DEL_FLG    = '0'                                                                               " & vbNewLine _
                                     & "--AND OUTL.NRS_BR_CD      = @NRS_BR_CD                                                                        " & vbNewLine _
                                     & "--AND OUTL.OUTKA_NO_L IN(@OUTKA_NO_L)                                                                         " & vbNewLine _
                                     & " --要望番号1383 [LMC664] --- START ---                                                          " & vbNewLine _
                                     & "         LEFT JOIN (SELECT NRS_BR_CD   AS NRS_BR_CD                                             " & vbNewLine _
                                     & "                         , CUST_CD     AS CUST_CD                                               " & vbNewLine _
                                     & "                         , CUST_CLASS  AS CUST_CLASS                                            " & vbNewLine _
                                     & "                         , SET_NAIYO   AS CUST_NAIYO_1                                          " & vbNewLine _
                                     & "                         , SET_NAIYO_2 AS CUST_NAIYO_2                                          " & vbNewLine _
                                     & "                         , SET_NAIYO_3 AS CUST_NAIYO_3                                          " & vbNewLine _
                                     & "                      FROM $LM_MST$..M_CUST_DETAILS                                             " & vbNewLine _
                                     & "                     WHERE SUB_KB ='42'                                                         " & vbNewLine _
                                     & "                       AND SET_NAIYO_2 = @RPT_ID                                                " & vbNewLine _
                                     & "                       AND SYS_DEL_FLG = '0'                                                    " & vbNewLine _
                                     & "                    ) MCD_CUST                                                                  " & vbNewLine _
                                     & "                ON CST.NRS_BR_CD = MCD_CUST.NRS_BR_CD                                           " & vbNewLine _
                                     & "               AND (CASE WHEN MCD_CUST.CUST_CLASS='00' THEN  CST.CUST_CD_L                                                   " & vbNewLine _
                                     & "                         WHEN MCD_CUST.CUST_CLASS='01' THEN (CST.CUST_CD_L + CST.CUST_CD_M)                                  " & vbNewLine _
                                     & "                         WHEN MCD_CUST.CUST_CLASS='02' THEN (CST.CUST_CD_L + CST.CUST_CD_M + CST.CUST_CD_S)                  " & vbNewLine _
                                     & "                         WHEN MCD_CUST.CUST_CLASS='03' THEN (CST.CUST_CD_L + CST.CUST_CD_M + CST.CUST_CD_S + CST.CUST_CD_SS) " & vbNewLine _
                                     & "                    END                                                                         " & vbNewLine _
                                     & "                   ) = MCD_CUST.CUST_CD                                                         " & vbNewLine _
                                     & " --要望番号1383 [LMC664] --- END ---                                                            " & vbNewLine



#End Region

    '2012.12.26 大阪用(出荷) ━━━━━━START━━━━━━
#Region "大阪用"

    ''' <summary>
    ''' 印刷データ抽出用(☆★作業用コメント:ひとまず修正おわり)
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_SELECT_DATA_707 As String = "  --SQL_SELECT_DATA                                                                                  " & vbNewLine _
                                            & " SELECT                                                                                               " & vbNewLine _
                                            & " CASE WHEN MR2.PTN_CD IS NOT NULL THEN MR2.RPT_ID                                                    " & vbNewLine _
                                            & "      WHEN MR1.PTN_CD IS NOT NULL THEN MR1.RPT_ID                                                    " & vbNewLine _
                                            & "      ELSE '' END            AS RPT_ID                                                               " & vbNewLine _
                                            & ",OUTL.NRS_BR_CD              AS NRS_BR_CD                                                            " & vbNewLine _
                                            & "--このあたりから要修正の可能性                                                                       " & vbNewLine _
                                            & "--LMC560                                                                                             " & vbNewLine _
                                            & ",OUTL.OUTKA_PLAN_DATE        AS OUTKA_PLAN_DATE                                                      " & vbNewLine _
                                            & ",OUTL.OUTKA_NO_L             AS OUTKA_NO_L                                                           " & vbNewLine _
                                            & ",KB01.KBN_NM4                AS SHITEN_TEL_560_1                                                     " & vbNewLine _
                                            & ",KB01.KBN_NM3                AS SHITEN_NM_560_1                                                      " & vbNewLine _
                                            & ",OUTL.ARR_PLAN_DATE          AS ARR_PLAN_DATE                                                        " & vbNewLine _
                                            & ",KB02.KBN_NM1                AS ARR_PLAN_TIME                                                        " & vbNewLine _
                                            & ",OUTL.DEST_TEL               AS DEST_TEL                                                             " & vbNewLine _
                                            & ",CST.TEL                     AS CUST_TEL                                                             " & vbNewLine _
                                            & ",CST.AD_1                    AS CUST_AD_1                                                            " & vbNewLine _
                                            & ",CST.AD_2                    AS CUST_AD_2                                                            " & vbNewLine _
                                            & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_AD_1                                                   " & vbNewLine _
                                            & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_AD_1                                                   " & vbNewLine _
                                            & "      ELSE DST.AD_1                                                                                  " & vbNewLine _
                                            & " END                         AS DEST_AD_1                                                            " & vbNewLine _
                                            & ",CST.AD_3                    AS CUST_AD_3                                                            " & vbNewLine _
                                            & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_AD_2                                                   " & vbNewLine _
                                            & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_AD_2                                                   " & vbNewLine _
                                            & "      ELSE DST.AD_2                                                                                  " & vbNewLine _
                                            & " END                         AS DEST_AD_2                                                            " & vbNewLine _
                                            & ",OUTL.DEST_AD_3              AS DEST_AD_3                                                            " & vbNewLine _
                                            & ",FL.UNSO_WT                  AS BETU_WT                                                              " & vbNewLine _
                                            & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_NM                                                     " & vbNewLine _
                                            & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_NM                                                     " & vbNewLine _
                                            & "      ELSE DST.DEST_NM                                                                               " & vbNewLine _
                                            & " END                         AS DEST_NM_1                                                            " & vbNewLine _
                                            & ",CST.CUST_NM_L               AS CUST_NM_L                                                            " & vbNewLine _
                                            & "--LMC561                                                                                             " & vbNewLine _
                                            & ",CASE WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_ZIP                                                    " & vbNewLine _
                                            & "      ELSE DST.ZIP                                                                                   " & vbNewLine _
                                            & " END                         AS DEST_ZIP                                                             " & vbNewLine _
                                            & "--LMC562                                                                                             " & vbNewLine _
                                            & "--,(OUTS.BETU_WT * OUTS.ALCTD_NB) AS UNSO_WT                                                         " & vbNewLine _
                                            & ",(SELECT                                                                                             " & vbNewLine _
                                            & "SUM (UNSO_WT.UNSO_WT) FROM                                                                           " & vbNewLine _
                                            & "(SELECT                                                                                              " & vbNewLine _
                                            & "--	SUM(OUTS.BETU_WT * OUTS.ALCTD_NB) AS UNSO_WT                                                        " & vbNewLine _
                                            & "	SUM(OUTS.ALCTD_QT * MG.STD_WT_KGS / MG.STD_IRIME_NB) AS UNSO_WT                                     " & vbNewLine _
                                            & "	FROM                                                                                                " & vbNewLine _
                                            & "	$LM_TRN$..C_OUTKA_L OUTL                                                                            " & vbNewLine _
                                            & "	LEFT JOIN                                                                                           " & vbNewLine _
                                            & "	$LM_TRN$..C_OUTKA_M OUTM                                                                            " & vbNewLine _
                                            & "	  ON OUTL.NRS_BR_CD   = OUTM.NRS_BR_CD                                                              " & vbNewLine _
                                            & "	 AND OUTL.OUTKA_NO_L  = OUTM.OUTKA_NO_L                                                             " & vbNewLine _
                                            & "	 AND OUTM.SYS_DEL_FLG = '0'                                                                         " & vbNewLine _
                                            & "	LEFT JOIN                                                                                           " & vbNewLine _
                                            & "	$LM_TRN$..C_OUTKA_S OUTS                                                                            " & vbNewLine _
                                            & "	  ON OUTL.NRS_BR_CD   = OUTS.NRS_BR_CD                                                              " & vbNewLine _
                                            & "	 AND OUTL.OUTKA_NO_L  = OUTS.OUTKA_NO_L                                                             " & vbNewLine _
                                            & "	 AND OUTM.OUTKA_NO_M  = OUTS.OUTKA_NO_M                                                             " & vbNewLine _
                                            & "	 AND OUTS.SYS_DEL_FLG = '0'                                                                         " & vbNewLine _
                                            & "	LEFT JOIN                                                                                           " & vbNewLine _
                                            & "	$LM_MST$..M_GOODS MG                                                                            " & vbNewLine _
                                            & "	  ON OUTM.NRS_BR_CD   = MG.NRS_BR_CD                                                              " & vbNewLine _
                                            & "	 AND OUTM.GOODS_CD_NRS  = MG.GOODS_CD_NRS                                                             " & vbNewLine _
                                            & "	WHERE                                                                                               " & vbNewLine _
                                            & "	    OUTL.SYS_DEL_FLG  = '0'                                                                         " & vbNewLine _
                                            & "	AND OUTL.NRS_BR_CD    = @NRS_BR_CD                                                                  " & vbNewLine _
                                            & "	AND OUTL.OUTKA_NO_L   = @OUTKA_NO_L                                                                 " & vbNewLine _
                                            & "	GROUP BY                                                                                            " & vbNewLine _
                                            & "	 OUTS.BETU_WT                                                                                       " & vbNewLine _
                                            & "	,OUTS.ALCTD_NB                                                                                      " & vbNewLine _
                                            & "	,OUTL.NRS_BR_CD                                                                                     " & vbNewLine _
                                            & "	,OUTL.OUTKA_NO_L                                                                                    " & vbNewLine _
                                            & "	)  UNSO_WT                                                                                          " & vbNewLine _
                                            & "	)  UNSO_WT                                                                                          " & vbNewLine _
                                            & ",FL.UNSO_PKG_NB              AS UNSO_PKG_NB                                                          " & vbNewLine _
                                            & ",CST.CUST_NM_M               AS CUST_NM_M                                                            " & vbNewLine _
                                            & "--LMC563                                                                                             " & vbNewLine _
                                            & ",NB.NRS_BR_NM                AS NRS_BR_NM                                                            " & vbNewLine _
                                            & ",EDIL.FREE_C15               AS DEST_HOSOKU                                                          " & vbNewLine _
                                            & ",NB.AD_1                     AS NRS_AD_1                                                             " & vbNewLine _
                                            & ",NB.AD_2                     AS NRS_AD_2                                                             " & vbNewLine _
                                            & ",NB.TEL                      AS NRS_TEL                                                              " & vbNewLine _
                                            & ",CST.CUST_CD_L               AS CUST_CD_L                                                            " & vbNewLine _
                                            & ",FL.REMARK                   AS UNSO_L_REMARK                                                        " & vbNewLine _
                                            & ",OUTL.REMARK                 AS OUTKA_L_REMARK                                                       " & vbNewLine _
                                            & ",EDIM.GOODS_NM               AS GOODS_NM_1                                                           " & vbNewLine _
                                            & ",MG.OUTKA_ATT                AS OUTKA_ATT                                                            " & vbNewLine _
                                            & ",OUTL.BUYER_ORD_NO           AS BUYER_ORD_NO                                                         " & vbNewLine _
                                            & ",CASE WHEN OUTL.NRS_BR_CD = '50' THEN                                                                " & vbNewLine _
                                            & "      (                                                                                              " & vbNewLine _
                                            & "       CASE WHEN OUTL.CUST_CD_L = '20000' THEN MGD.SET_NAIYO                                         " & vbNewLine _
                                            & "             ELSE ''                                                                                 " & vbNewLine _
                                            & "       END                                                                                           " & vbNewLine _
                                            & "      )                                                                                              " & vbNewLine _
                                            & "      ELSE ''                                                                                        " & vbNewLine _
                                            & " END                         AS YELLOW_NO                                                            " & vbNewLine _
                                            & ",KB03.KBN_NM3                AS SHIHARAI_SHITEN_NM_563_1                                             " & vbNewLine _
                                            & ",CASE WHEN OUTL.NRS_BR_CD = '50' THEN                                                                " & vbNewLine _
                                            & "       (                                                                                             " & vbNewLine _
                                            & "         CASE WHEN OUTL.CUST_CD_L = '00007' THEN KB0401.KBN_NM3                                      " & vbNewLine _
                                            & "              WHEN OUTL.CUST_CD_L = '20000' THEN KB0402.KBN_NM3                                      " & vbNewLine _
                                            & "              WHEN OUTL.CUST_CD_L = '00950' THEN                                                     " & vbNewLine _
                                            & "                   (                                                                                 " & vbNewLine _
                                            & "                    CASE WHEN MG.SEARCH_KEY_1 = 'A0020' THEN KB0403.KBN_NM3                          " & vbNewLine _
                                            & "                         WHEN MG.SEARCH_KEY_1 = 'A0021' THEN KB0403.KBN_NM3                          " & vbNewLine _
                                            & "                         ELSE KB0404.KBN_NM3                                                         " & vbNewLine _
                                            & "                    END                                                                              " & vbNewLine _
                                            & "                   )                                                                                 " & vbNewLine _
                                            & "              ELSE KB0405.KBN_NM3                                                                    " & vbNewLine _
                                            & "         END                                                                                         " & vbNewLine _
                                            & "       )                                                                                             " & vbNewLine _
                                            & "      ELSE ''                                                                                        " & vbNewLine _
                                            & "END                          AS SHIHARAI_SHITEN_CD_563_1                                             " & vbNewLine _
                                            & ",KB03.KBN_NM4                AS SHIHARAI_SHITEN_TEL_563_1                                            " & vbNewLine _
                                            & "--LMC564                                                                                             " & vbNewLine _
                                            & ",KB05.KBN_NM4                AS SHITEN_TEL_1_564_1                                                   " & vbNewLine _
                                            & ",KB05.KBN_NM3                AS SHITEN_NM_564_1                                                      " & vbNewLine _
                                            & ",KB05.KBN_NM4                AS SHITEN_TEL_2_564_1                                                   " & vbNewLine _
                                            & ",NB.AD_1                     AS NRS_BR_AD_1                                                          " & vbNewLine _
                                            & ",NB.AD_2                     AS NRS_BR_AD_2                                                          " & vbNewLine _
                                            & ",NB.NRS_BR_NM                AS NRS_BR_NM_1                                                          " & vbNewLine _
                                            & "--LMC565                                                                                             " & vbNewLine _
                                            & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_NM                                                     " & vbNewLine _
                                            & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_NM                                                     " & vbNewLine _
                                            & "      ELSE DST.DEST_NM                                                                               " & vbNewLine _
                                            & " END                         AS DEST_NM                                                              " & vbNewLine _
                                            & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_AD_1                                                   " & vbNewLine _
                                            & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_AD_1                                                   " & vbNewLine _
                                            & "      ELSE DST.AD_1                                                                                  " & vbNewLine _
                                            & " END                         AS AD_1                                                                 " & vbNewLine _
                                            & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_AD_2                                                   " & vbNewLine _
                                            & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_AD_2                                                   " & vbNewLine _
                                            & "      ELSE DST.AD_2                                                                                  " & vbNewLine _
                                            & " END                         AS AD_2                                                                 " & vbNewLine _
                                            & ",OUTL.DEST_AD_3              AS AD_3                                                                 " & vbNewLine _
                                            & ",OUTL.DEST_TEL               AS TEL                                                                  " & vbNewLine _
                                            & ",OUTL.DEST_CD                AS DEST_CD                                                              " & vbNewLine _
                                            & ",OUTL.SHIP_CD_L              AS SHIP_CD_L                                                            " & vbNewLine _
                                            & ",KB0601.KBN_NM4              AS SHIHARAI_CD_565_1                                                    " & vbNewLine _
                                            & ",KB0602.KBN_NM4              AS SHIHARAI_CD_565_2                                                    " & vbNewLine _
                                            & "--LMC566                                                                                             " & vbNewLine _
                                            & ",NB.FAX                      AS NRS_FAX                                                              " & vbNewLine _
                                            & "--LMC567                                                                                             " & vbNewLine _
                                            & ",NB.AD_3                     AS NRS_AD_3                                                             " & vbNewLine _
                                            & "--LMC568                                                                                             " & vbNewLine _
                                            & ",OUTL.CUST_ORD_NO            AS CUST_ORD_NO                                                          " & vbNewLine _
                                            & ",MG.SHOBO_CD                 AS SHOBO_CD                                                             " & vbNewLine _
                                            & ",KB0701.KBN_NM5              AS CUST_CD_L_568_1                                                      " & vbNewLine _
                                            & ",KB0702.KBN_NM5              AS CUST_CD_L_568_2                                                      " & vbNewLine _
                                            & "--LMC569                                                                                             " & vbNewLine _
                                            & ",NB.ZIP                      AS NRS_BR_ZIP                                                           " & vbNewLine _
                                            & ",NB.TEL                      AS NRS_BR_TEL                                                           " & vbNewLine _
                                            & ",KB08.KBN_NM1                AS KOTEI_1                                                              " & vbNewLine _
                                            & ",KB08.KBN_NM3                AS KOTEI_2                                                              " & vbNewLine _
                                            & ",KB08.KBN_NM5                AS KOTEI_3                                                              " & vbNewLine _
                                            & "--LMC570                                                                                             " & vbNewLine _
                                            & ",FL.NB_UT                    AS NB_UT                                                                " & vbNewLine _
                                            & ",CST.DENPYO_NM               AS DENPYO_NM                                                            " & vbNewLine _
                                            & ",KB1001.KBN_NM3              AS SHITEN_NM_570_1                                                      " & vbNewLine _
                                            & ",KB1001.KBN_NM4              AS SHITEN_TEL_570_1                                                     " & vbNewLine _
                                            & ",KB1002.KBN_NM3              AS SHITEN_NM_570_2                                                      " & vbNewLine _
                                            & ",KB1002.KBN_NM4              AS SHITEN_TEL_570_2                                                     " & vbNewLine _
                                            & "--LMC572                                                                                             " & vbNewLine _
                                            & ",OUTL.OUTKA_PKG_NB           AS OUTKA_PKG_NB                                                         " & vbNewLine _
                                            & ",OUTM.IRIME                  AS IRIME                                                                " & vbNewLine _
                                            & ",OUTM.IRIME_UT               AS IRIME_UT                                                             " & vbNewLine _
                                            & ",OUTM.ALCTD_NB               AS ALCTD_NB                                                             " & vbNewLine _
                                            & ",OUTM.LOT_NO                 AS LOT_NO                                                               " & vbNewLine _
                                            & ",SHIPDST.DEST_NM             AS SHIP_NM_L                                                            " & vbNewLine _
                                            & ",CUSTDTL.SET_NAIYO           AS UNSO_CUST_CD                                                         " & vbNewLine _
                                            & ",KB0801.KBN_NM3              AS SHIHARAI_CD_575_1                                                    " & vbNewLine _
                                            & ",KB0802.KBN_NM3              AS SHIHARAI_CD_575_2                                                    " & vbNewLine _
                                            & "--LMC670                                                                                             " & vbNewLine _
                                            & ",KB0803.KBN_NM1              AS KBN_CUST_ZIP                                                         " & vbNewLine _
                                            & ",KB0803.KBN_NM2              AS KBN_CUST_AD                                                          " & vbNewLine _
                                            & ",KB0803.KBN_NM3              AS KBN_CUST_TEL                                                         " & vbNewLine _
                                            & ",KB0803.KBN_NM4              AS KBN_CUST_NM                                                          " & vbNewLine _
                                            & ",OUTL.OUTKO_DATE             AS OUTKO_DATE                                                           " & vbNewLine _
                                            & "--,(MG.STD_WT_KGS * OUTM.ALCTD_NB) AS ALCTD_WT                                                         " & vbNewLine _
                                            & ",(MG.STD_WT_KGS * OUTM.ALCTD_QT / MG.STD_WT_KGS) AS ALCTD_WT                                                         " & vbNewLine _
                                            & "--,OUTKAEDIL.FREE_C05          AS BUKA_CD                                                            " & vbNewLine _
                                            & ",EDIL.FREE_C05          AS BUKA_CD                                                                   " & vbNewLine _
                                            & ",CASE WHEN SHIPDST.DEST_NM <> ''                                                                     " & vbNewLine _
                                            & "           AND SHIPDST.DEST_NM IS NOT NULL THEN SHIPDST.DEST_NM                                      " & vbNewLine _
                                            & "      WHEN CST.DENPYO_NM   <> ''                                                                     " & vbNewLine _
                                            & "           AND CST.DENPYO_NM IS NOT NULL   THEN CST.DENPYO_NM                                        " & vbNewLine _
                                            & "      ELSE CST.CUST_NM_L                                                                             " & vbNewLine _
                                            & " END                         AS ATSUKAISYA_NM                                                        " & vbNewLine _
                                            & "-- ,MG.GOODS_CD_CUST           AS GOODS_CD_CUST                 --2012.05.25                           " & vbNewLine _
                                            & "   ,EDIM.FREE_C01 + '  ' + EDIM.FREE_C02              AS GOODS_CD_CUST   --2012.05.25                " & vbNewLine _
                                            & " ,LEFT(JIS.JIS_CD,2)         AS PREF_CD                       --2012.05.25                           " & vbNewLine _
                                            & ",CASE WHEN LEFT(JIS.JIS_CD,2) ='16' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '17' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '18' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '21' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '25'                  --ここまで飛騨運輸のエリア                      " & vbNewLine _
                                            & "          THEN '飛騨運輸'                                                                            " & vbNewLine _
                                            & "     WHEN LEFT(JIS.JIS_CD,2) = '24' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '29' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '30' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '47'                  --ここまで近鉄運輸のエリア                      " & vbNewLine _
                                            & "         THEN '近鉄運輸'                                                                             " & vbNewLine _
                                            & "    WHEN  LEFT(JIS.JIS_CD,2) = '26' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '28' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '31' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '32' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '33' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '34' OR                                                               " & vbNewLine _
                                            & "       LEFT(JIS.JIS_CD,2) = '35' OR                                                                  " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '36' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '37' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '38' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '39'                                                                  " & vbNewLine _
                                            & "          THEN '岡山県貨物'                                                                          " & vbNewLine _
                                            & "          ELSE    '' END            AS TORI_UNSOCO_NM                                                " & vbNewLine _
                                            & "     --THEN MUC.UNSOCO_NM   END                                                                      " & vbNewLine _
                                            & "    --                              AS TORI_UNSOCO_NM                                                " & vbNewLine _
                                            & " --,MUC.UNSOCO_NM              AS TORI_UNSOCO_NM                --2012.05.25                         " & vbNewLine _
                                            & " ,MCD_SAI.SET_NAIYO          AS SAI_SHIHARAI_CD               --2012.05.25                           " & vbNewLine _
                                            & " ,MCD_SAI.SET_NAIYO_3        AS SET_NM_L                      --2012.05.29                           " & vbNewLine _
                                            & " ,MCD_NFC.SET_NAIYO          AS NAIYO1                        --2012.06.01                           " & vbNewLine _
                                            & " ,MCD_NFC.SET_NAIYO_2        AS NAIYO2                        --2012.06.01                           " & vbNewLine _
                                            & " ,MCD_NFC.SET_NAIYO_3        AS NAIYO3                        --2012.06.01                           " & vbNewLine _
                                            & " ,MCD_SAI.SET_NAIYO_2        AS NAIYO_CUST_NM                 --2012.06.04                           " & vbNewLine _
                                            & " ,OUTM.CUST_ORD_NO_DTL      AS CUST_ORD_NO_DTL              --2012.06.11                             " & vbNewLine _
                                            & " --2012.07.24 丸和運輸　荷受人氏名下の注意書き(REMARK)開始                                           " & vbNewLine _
                                            & " ,CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.REMARK                                                     " & vbNewLine _
                                            & "       WHEN OUTL.DEST_KB = '02' THEN EDIL.REMARK                                                     " & vbNewLine _
                                            & "       ELSE DST.REMARK                                                                               " & vbNewLine _
                                            & "  END                         AS REMARK_DEST                                                         " & vbNewLine _
                                            & " --2012.07.24 丸和運輸　荷受人氏名下の注意書き(REMARK)終了                                           " & vbNewLine _
                                            & " --要望番号1383 [LMC664] --- START ---                                                               " & vbNewLine _
                                            & " ,ISNULL(MCD_CUST.CUST_NAIYO_1,'') AS CUST_FLG                                                       " & vbNewLine _
                                            & "		   ,ROW_NUMBER() OVER (PARTITION BY OUTL.NRS_BR_CD                                              " & vbNewLine _
                                            & "			ORDER BY OUTL.OUTKA_PLAN_DATE) AS REC_NO                                                    " & vbNewLine _
                                            & " --要望番号1383 [LMC664] --- END ---                                                                 " & vbNewLine _
                                            & " ,''      AS CUST_ORD_NO_1              --2012.12.26                                                 " & vbNewLine _
                                            & " ,''      AS CUST_ORD_NO_2              --2012.12.26                                                 " & vbNewLine _
                                            & " ,''      AS CUST_ORD_NO_3              --2012.12.26                                                 " & vbNewLine _
                                            & " ,''      AS CUST_ORD_NO_4              --2012.12.26                                                 " & vbNewLine _
                                            & " ,''      AS CUST_ORD_NO_5              --2012.12.26                                                 " & vbNewLine _
                                            & " ,''      AS CUST_ORD_NO_6              --2012.12.26                                                 " & vbNewLine _
                                            & " ,''      AS CUST_ORD_NO_7              --2012.12.26                                                 " & vbNewLine _
                                            & " ,ISNULL(FL.AUTO_DENP_KBN,'')              AS      AUTO_DENP_KBN     --ADD 2017/09/28                " & vbNewLine _
                                            & " ,ISNULL(FL.AUTO_DENP_NO,'')               AS      AUTO_DENP_NO      --ADD 2017/09/28                " & vbNewLine


    ''' <summary>
    ''' データ抽出用FROM句(☆★作業用コメント：20110711)
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_FROM_707 As String = "FROM                                                                                                        " & vbNewLine _
                                     & "$LM_TRN$..C_OUTKA_L OUTL                                                                                    " & vbNewLine _
                                     & " LEFT JOIN (                                                                                                " & vbNewLine _
                                     & "            SELECT                                                                                          " & vbNewLine _
                                     & "                   NRS_BR_CD                                                                                " & vbNewLine _
                                     & "                 , EDI_CTL_NO                                                                               " & vbNewLine _
                                     & "                 , OUTKA_CTL_NO                                                                             " & vbNewLine _
                                     & "             FROM (                                                                                         " & vbNewLine _
                                     & "                    SELECT                                                                                  " & vbNewLine _
                                     & "                           EDIOUTL.NRS_BR_CD                                                                " & vbNewLine _
                                     & "                         , EDIOUTL.EDI_CTL_NO                                                               " & vbNewLine _
                                     & "                         , EDIOUTL.OUTKA_CTL_NO                                                             " & vbNewLine _
                                     & "                         , CASE WHEN EDIOUTL.OUTKA_CTL_NO = '' THEN 1                                       " & vbNewLine _
                                     & "                           ELSE ROW_NUMBER() OVER (PARTITION BY EDIOUTL.NRS_BR_CD                           " & vbNewLine _
                                     & "                                                              , EDIOUTL.OUTKA_CTL_NO                        " & vbNewLine _
                                     & "                                                       ORDER BY EDIOUTL.NRS_BR_CD                           " & vbNewLine _
                                     & "                                                              , EDIOUTL.EDI_CTL_NO                          " & vbNewLine _
                                     & "                                                  )                                                         " & vbNewLine _
                                     & "                           END AS IDX                                                                       " & vbNewLine _
                                     & "                      FROM $LM_TRN$..H_OUTKAEDI_L EDIOUTL                                                   " & vbNewLine _
                                     & "                     WHERE EDIOUTL.SYS_DEL_FLG  = '0'                                                       " & vbNewLine _
                                     & "                       AND EDIOUTL.NRS_BR_CD    = @NRS_BR_CD                                                " & vbNewLine _
                                     & "                       AND EDIOUTL.OUTKA_CTL_NO = @OUTKA_NO_L                                               " & vbNewLine _
                                     & "                  ) EBASE                                                                                   " & vbNewLine _
                                     & "            WHERE EBASE.IDX = 1                                                                             " & vbNewLine _
                                     & "            ) TOPEDI                                                                                        " & vbNewLine _
                                     & "        ON TOPEDI.NRS_BR_CD    = OUTL.NRS_BR_CD                                                             " & vbNewLine _
                                     & "       AND TOPEDI.OUTKA_CTL_NO = OUTL.OUTKA_NO_L                                                            " & vbNewLine _
                                     & " LEFT JOIN $LM_TRN$..H_OUTKAEDI_L EDIL                                                                      " & vbNewLine _
                                     & "        ON EDIL.NRS_BR_CD  = TOPEDI.NRS_BR_CD                                                               " & vbNewLine _
                                     & "       AND EDIL.EDI_CTL_NO = TOPEDI.EDI_CTL_NO                                                              " & vbNewLine _
                                     & "--(2013.01.09)要望番号1754対応  --- START ---                                                               " & vbNewLine _
                                     & "--    LEFT JOIN $LM_TRN$..H_OUTKAEDI_M EDIM                                                                 " & vbNewLine _
                                     & "--        ON EDIM.NRS_BR_CD  = EDIL.NRS_BR_CD                                                               " & vbNewLine _
                                     & "--       AND EDIM.EDI_CTL_NO = EDIL.EDI_CTL_NO                                                              " & vbNewLine _
                                     & "--(2013.01.09)要望番号1754対応  ---  END　---                                                               " & vbNewLine _
                                     & "--出荷M                                                                                                     " & vbNewLine _
                                     & "LEFT JOIN                                                                                                   " & vbNewLine _
                                     & "(SELECT                                                                                                     " & vbNewLine _
                                     & "*                                                                                                           " & vbNewLine _
                                     & "FROM                                                                                                        " & vbNewLine _
                                     & "(SELECT                                                                                                     " & vbNewLine _
                                     & "   NRS_BR_CD                                                                                                " & vbNewLine _
                                     & "  ,GOODS_CD_NRS                                                                                             " & vbNewLine _
                                     & "  ,IRIME                                                                                                    " & vbNewLine _
                                     & "  ,IRIME_UT                                                                                                 " & vbNewLine _
                                     & "  ,ALCTD_NB                                                                                                 " & vbNewLine _
                                     & "  ,ALCTD_QT                                                                                                 " & vbNewLine _
                                     & "  ,LOT_NO                                                                                                   " & vbNewLine _
                                     & "  ,SYS_DEL_FLG                                                                                              " & vbNewLine _
                                     & "  ,CUST_ORD_NO_DTL                                                                                          " & vbNewLine _
                                     & "  ,ROW_NUMBER() OVER (PARTITION BY NRS_BR_CD ORDER BY OUTKA_NO_L,OUTKA_NO_M) AS NUM                         " & vbNewLine _
                                     & "  ,OUTKA_NO_L                                                                                               " & vbNewLine _
                                     & "  ,OUTKA_NO_M                                                                                               " & vbNewLine _
                                     & "  FROM                                                                                                      " & vbNewLine _
                                     & "   $LM_TRN$..C_OUTKA_M M                                                                                    " & vbNewLine _
                                     & "  WHERE                                                                                                     " & vbNewLine _
                                     & "      M.NRS_BR_CD = @NRS_BR_CD                                                                              " & vbNewLine _
                                     & "  AND M.OUTKA_NO_L IN(@OUTKA_NO_L)                                                                          " & vbNewLine _
                                     & "  AND SYS_DEL_FLG = '0'                                                                                     " & vbNewLine _
                                     & " ) AS BASE                                                                                                  " & vbNewLine _
                                     & " --WHERE                                                                                                      " & vbNewLine _
                                     & " --BASE.NUM = 1                                                                                               " & vbNewLine _
                                     & ") OUTM                                                                                                      " & vbNewLine _
                                     & "ON                                                                                                          " & vbNewLine _
                                     & "1 = 1                                                                                                       " & vbNewLine _
                                     & "--(2013.01.09)要望番号1754対応  --- START ---                                                               " & vbNewLine _
                                     & " LEFT JOIN $LM_TRN$..H_OUTKAEDI_M EDIM                                                                      " & vbNewLine _
                                     & "        ON EDIM.NRS_BR_CD  = OUTM.NRS_BR_CD                                                                 " & vbNewLine _
                                     & "       AND EDIM.OUTKA_CTL_NO = OUTM.OUTKA_NO_L                                                              " & vbNewLine _
                                     & "       AND EDIM.OUTKA_CTL_NO_CHU = OUTM.OUTKA_NO_M                                                          " & vbNewLine _
                                     & "--(2013.01.09)要望番号1754対応  ---  END　---                                                               " & vbNewLine _
                                     & "--F運送L                                                                                                    " & vbNewLine _
                                     & "LEFT JOIN $LM_TRN$..F_UNSO_L FL                                                                             " & vbNewLine _
                                     & "ON  FL.MOTO_DATA_KB   = '20'                                                                                " & vbNewLine _
                                     & "AND FL.NRS_BR_CD      = OUTL.NRS_BR_CD                                                                      " & vbNewLine _
                                     & "AND FL.INOUTKA_NO_L   = OUTL.OUTKA_NO_L                                                                     " & vbNewLine _
                                     & "AND FL.SYS_DEL_FLG    = '0'                                                                                 " & vbNewLine _
                                     & "--商品M                                                                                                     " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_GOODS MG                                                                              " & vbNewLine _
                                     & "ON  MG.NRS_BR_CD     = OUTM.NRS_BR_CD                                                                       " & vbNewLine _
                                     & "AND MG.GOODS_CD_NRS  = OUTM.GOODS_CD_NRS                                                                    " & vbNewLine _
                                     & "AND MG.SYS_DEL_FLG   = '0'                                                                                  " & vbNewLine _
                                     & "--荷主なしでの運送会社荷主別送り状パターン取得                                                              " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_UNSO_CUST_RPT MCR1                                                                    " & vbNewLine _
                                     & "ON  FL.NRS_BR_CD     = MCR1.NRS_BR_CD                                                                       " & vbNewLine _
                                     & "AND FL.UNSO_CD       = MCR1.UNSOCO_CD                                                                       " & vbNewLine _
                                     & "AND FL.UNSO_BR_CD    = MCR1.UNSOCO_BR_CD                                                                    " & vbNewLine _
                                     & "AND '11'             = MCR1.PTN_ID                                                                          " & vbNewLine _
                                     & "AND FL.PC_KB         = MCR1.MOTO_TYAKU_KB                                                                   " & vbNewLine _
                                     & "AND ''               = MCR1.CUST_CD_L                                                                       " & vbNewLine _
                                     & "AND ''               = MCR1.CUST_CD_M                                                                       " & vbNewLine _
                                     & "AND MCR1.SYS_DEL_FLG = '0'                                                                                  " & vbNewLine _
                                     & "--帳票パターン取得                                                                                          " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_RPT MR1                                                                               " & vbNewLine _
                                     & "ON  MR1.NRS_BR_CD   = MCR1.NRS_BR_CD                                                                        " & vbNewLine _
                                     & "AND MR1.PTN_ID      = MCR1.PTN_ID                                                                           " & vbNewLine _
                                     & "AND MR1.PTN_CD      = MCR1.PTN_CD                                                                           " & vbNewLine _
                                     & "AND MR1.SYS_DEL_FLG = '0'                                                                                   " & vbNewLine _
                                     & "--荷主込みでの運送会社荷主別送り状パターン取得                                                              " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_UNSO_CUST_RPT MCR2                                                                    " & vbNewLine _
                                     & "ON  FL.NRS_BR_CD     = MCR2.NRS_BR_CD                                                                       " & vbNewLine _
                                     & "AND FL.UNSO_CD       = MCR2.UNSOCO_CD                                                                       " & vbNewLine _
                                     & "AND FL.UNSO_BR_CD    = MCR2.UNSOCO_BR_CD                                                                    " & vbNewLine _
                                     & "AND '11'             = MCR2.PTN_ID                                                                          " & vbNewLine _
                                     & "AND FL.PC_KB         = MCR2.MOTO_TYAKU_KB                                                                   " & vbNewLine _
                                     & "AND FL.CUST_CD_L     = MCR2.CUST_CD_L                                                                       " & vbNewLine _
                                     & "AND FL.CUST_CD_M     = MCR2.CUST_CD_M                                                                       " & vbNewLine _
                                     & "AND MCR2.SYS_DEL_FLG = '0'                                                                                  " & vbNewLine _
                                     & "--帳票パターン取得                                                                                          " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_RPT MR2                                                                               " & vbNewLine _
                                     & "ON  MR2.NRS_BR_CD    = MCR2.NRS_BR_CD                                                                       " & vbNewLine _
                                     & "AND MR2.PTN_ID       = MCR2.PTN_ID                                                                          " & vbNewLine _
                                     & "AND MR2.PTN_CD       = MCR2.PTN_CD                                                                          " & vbNewLine _
                                     & "AND MR2.SYS_DEL_FLG  = '0'                                                                                  " & vbNewLine _
                                     & "--存在しない場合の帳票パターン取得                                                                          " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_RPT MR3                                                                               " & vbNewLine _
                                     & "ON  MR3.NRS_BR_CD     = OUTL.NRS_BR_CD                                                                      " & vbNewLine _
                                     & "AND MR3.PTN_ID        = '11'                                                                                " & vbNewLine _
                                     & "AND MR3.STANDARD_FLAG = '01'                                                                                " & vbNewLine _
                                     & "AND MR3.SYS_DEL_FLG   = '0'                                                                                 " & vbNewLine _
                                     & "--荷主マスタ (ここからメインプリント用)                                                               " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_CUST CST                                                                              " & vbNewLine _
                                     & "ON  CST.NRS_BR_CD     = MG.NRS_BR_CD                                                                        " & vbNewLine _
                                     & "AND CST.CUST_CD_L     = MG.CUST_CD_L                                                                        " & vbNewLine _
                                     & "AND CST.CUST_CD_M     = MG.CUST_CD_M                                                                        " & vbNewLine _
                                     & "AND CST.CUST_CD_S     = MG.CUST_CD_S                                                                        " & vbNewLine _
                                     & "AND CST.CUST_CD_SS    = MG.CUST_CD_SS                                                                       " & vbNewLine _
                                     & "AND CST.SYS_DEL_FLG   = '0'                                                                                 " & vbNewLine _
                                     & "--届先マスタ                                                                                                " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_DEST DST                                                                              " & vbNewLine _
                                     & "ON  DST.NRS_BR_CD     = OUTL.NRS_BR_CD                                                                      " & vbNewLine _
                                     & "AND DST.CUST_CD_L     = OUTL.CUST_CD_L                                                                      " & vbNewLine _
                                     & "AND DST.DEST_CD       = OUTL.DEST_CD                                                                        " & vbNewLine _
                                     & "AND DST.SYS_DEL_FLG   = '0'                                                                                 " & vbNewLine _
                                     & "--届先マスタ                                                                                                " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_DEST SHIPDST                                                                          " & vbNewLine _
                                     & "ON  SHIPDST.NRS_BR_CD     = OUTL.NRS_BR_CD                                                                  " & vbNewLine _
                                     & "AND SHIPDST.CUST_CD_L     = OUTL.CUST_CD_L                                                                  " & vbNewLine _
                                     & "AND SHIPDST.DEST_CD       = OUTL.SHIP_CD_L                                                                  " & vbNewLine _
                                     & "AND SHIPDST.SYS_DEL_FLG   = '0'                                                                             " & vbNewLine _
                                     & "--営業所マスタ                                                                                              " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_NRS_BR NB                                                                             " & vbNewLine _
                                     & "ON  NB.NRS_BR_CD      = OUTL.NRS_BR_CD                                                                      " & vbNewLine _
                                     & "AND NB.SYS_DEL_FLG    = '0'                                                                                 " & vbNewLine _
                                     & "--商品明細                                                                                                  " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_GOODS_DETAILS MGD                                                                     " & vbNewLine _
                                     & "ON  MGD.NRS_BR_CD       = OUTM.NRS_BR_CD                                                                    " & vbNewLine _
                                     & "AND MGD.GOODS_CD_NRS    = OUTM.GOODS_CD_NRS                                                                 " & vbNewLine _
                                     & "AND MGD.SUB_KB          = '01'                                                                              " & vbNewLine _
                                     & "AND MGD.SYS_DEL_FLG     = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC560支店TEL(NM4)・支店名(NM3))KB01                                                           " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB01                                                                              " & vbNewLine _
                                     & "ON  KB01.KBN_GROUP_CD = 'O007'                                                                              " & vbNewLine _
                                     & "AND KB01.KBN_CD       = '01'                                                                                " & vbNewLine _
                                     & "AND KB01.SYS_DEL_FLG  = '0'                                                                                 " & vbNewLine _
                                     & "--区分マスタ(納期文言)KB02                                                                                  " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB02                                                                              " & vbNewLine _
                                     & "ON  KB02.KBN_GROUP_CD = 'N010'                                                                              " & vbNewLine _
                                     & "AND KB02.KBN_CD       = OUTL.ARR_PLAN_TIME                                                                  " & vbNewLine _
                                     & "AND KB02.SYS_DEL_FLG  = '0'                                                                                 " & vbNewLine _
                                     & "--区分マスタ(LMC563支店名(NM3)、電話番号(NM4))KB03                                                          " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB03                                                                              " & vbNewLine _
                                     & "ON  KB03.KBN_GROUP_CD = 'O007'                                                                              " & vbNewLine _
                                     & "AND KB03.KBN_CD       = '10'                                                                                " & vbNewLine _
                                     & "AND KB03.SYS_DEL_FLG  = '0'                                                                                 " & vbNewLine _
                                     & "--区分マスタ(LMC563支払支店コード(NM3))KB0401                                                               " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0401                                                                            " & vbNewLine _
                                     & "ON  KB0401.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0401.KBN_CD       = '11'                                                                              " & vbNewLine _
                                     & "AND KB0401.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC563支払支店コード(NM3))KB0402                                                               " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0402                                                                            " & vbNewLine _
                                     & "ON  KB0402.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0402.KBN_CD       = '12'                                                                              " & vbNewLine _
                                     & "AND KB0402.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC563支払支店コード(NM3))KB0403                                                               " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0403                                                                            " & vbNewLine _
                                     & "ON  KB0403.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0403.KBN_CD       = '13'                                                                              " & vbNewLine _
                                     & "AND KB0403.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC563支払支店コード(NM3))KB0404                                                               " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0404                                                                            " & vbNewLine _
                                     & "ON  KB0404.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0404.KBN_CD       = '14'                                                                              " & vbNewLine _
                                     & "AND KB0404.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC563支払支店コード(NM3))KB0405                                                               " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0405                                                                            " & vbNewLine _
                                     & "ON  KB0405.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0405.KBN_CD       = '15'                                                                              " & vbNewLine _
                                     & "AND KB0405.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC564支店TEL、荷主TEL(NM4)・支店名(NM3))KB05                                                  " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB05                                                                              " & vbNewLine _
                                     & "ON  KB05.KBN_GROUP_CD   = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB05.KBN_CD         = '02'                                                                              " & vbNewLine _
                                     & "AND KB05.SYS_DEL_FLG    = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC565支払いコード(NM3)KB0601)                                                                 " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0601                                                                            " & vbNewLine _
                                     & "ON  KB0601.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0601.KBN_CD       = '07'                                                                              " & vbNewLine _
                                     & "AND KB0601.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC565支払いコード(NM3)KB0602)                                                                 " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0602                                                                            " & vbNewLine _
                                     & "ON  KB0602.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0602.KBN_CD       = '08'                                                                              " & vbNewLine _
                                     & "AND KB0602.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC568荷主コード(NM5)KB0701                                                                    " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0701                                                                            " & vbNewLine _
                                     & "ON  KB0701.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0701.KBN_CD       = '03'                                                                              " & vbNewLine _
                                     & "AND KB0701.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC568荷主コード(NM5)KB0702                                                                    " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0702                                                                            " & vbNewLine _
                                     & "ON  KB0702.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0702.KBN_CD       = '09'                                                                              " & vbNewLine _
                                     & "AND KB0702.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC569固定表示(NM1,3,4))KB08                                                                   " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB08                                                                              " & vbNewLine _
                                     & "ON  KB08.KBN_GROUP_CD   = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB08.KBN_CD         = '04'                                                                              " & vbNewLine _
                                     & "AND KB08.SYS_DEL_FLG    = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC570支店名(NM3)支店TEL(NM4))KB1001                                                           " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB1001                                                                            " & vbNewLine _
                                     & "ON  KB1001.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB1001.KBN_CD       = '05'                                                                              " & vbNewLine _
                                     & "AND KB1001.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC570支店名(NM3)支店TEL(NM4))KB1002                                                           " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB1002                                                                            " & vbNewLine _
                                     & "ON  KB1002.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB1002.KBN_CD       = '06'                                                                              " & vbNewLine _
                                     & "AND KB1002.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--荷主明細マスタ(LMC573にて運送契約荷主コード取得)                                                          " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_CUST_DETAILS CUSTDTL                                                                  " & vbNewLine _
                                     & "ON  CUSTDTL.NRS_BR_CD    = OUTL.NRS_BR_CD                                                                   " & vbNewLine _
                                     & "AND CUSTDTL.CUST_CD      = OUTL.CUST_CD_L + OUTL.CUST_CD_M                                                  " & vbNewLine _
                                     & "AND CUSTDTL.SUB_KB       = '03'                                                                             " & vbNewLine _
                                     & "AND CUSTDTL.SYS_DEL_FLG  = '0'                                                                              " & vbNewLine _
                                     & "--区分マスタ(LMC575支払コード(NM3)KB0801)                                                                   " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0801                                                                            " & vbNewLine _
                                     & "ON  KB0801.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0801.KBN_CD       = '16'                                                                              " & vbNewLine _
                                     & "AND KB0801.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC575支払コード(NM3)KB0802)                                                                   " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0802                                                                            " & vbNewLine _
                                     & "ON  KB0802.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0802.KBN_CD       = '17'                                                                              " & vbNewLine _
                                     & "AND KB0802.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC670 KB0803)                                                                                 " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0803                                                                            " & vbNewLine _
                                     & "ON  KB0803.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0803.KBN_CD       = '18'                                                                              " & vbNewLine _
                                     & "AND KB0803.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_DEST      DEST_JIS --2012.05.25                                                       " & vbNewLine _
                                     & "ON  DEST_JIS.NRS_BR_CD    = OUTL.NRS_BR_CD                                                                  " & vbNewLine _
                                     & "AND DEST_JIS.CUST_CD_L    = OUTL.CUST_CD_L                                                                  " & vbNewLine _
                                     & "AND DEST_JIS.DEST_CD      = OUTL.DEST_CD                                                                    " & vbNewLine _
                                     & "AND DEST_JIS.SYS_DEL_FLG  = '0'                                                                             " & vbNewLine _
                                     & "--JISマスタ(LMC661にてJIS_CD2桁：都道府県コード取得)2012.05.25                                              " & vbNewLine _
                                     & "  LEFT JOIN  $LM_MST$..M_JIS   JIS                                                                          " & vbNewLine _
                                     & "  ON  JIS.JIS_CD       = DEST_JIS.JIS                                                                       " & vbNewLine _
                                     & " AND  JIS.SYS_DEL_FLG  = '0'                                                                                " & vbNewLine _
                                     & "--荷主明細マスタ(LMC660にてSET_NAIYO：支払コード取得)2012.05.25                                             " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_CUST_DETAILS MCD_SAI                                                                  " & vbNewLine _
                                     & "ON  MCD_SAI.NRS_BR_CD    = OUTL.NRS_BR_CD                                                                   " & vbNewLine _
                                     & "AND MCD_SAI.CUST_CD      = OUTL.CUST_CD_L                                                                   " & vbNewLine _
                                     & "--AND MCD_SAI.CUST_CD_EDA  = OUTL.CUST_CD_M                                                                   " & vbNewLine _
                                     & "AND MCD_SAI.SUB_KB       = '27'                                                                             " & vbNewLine _
                                     & "AND MCD_SAI.SYS_DEL_FLG  = '0'                                                                              " & vbNewLine _
                                     & "--荷主明細マスタ(LMC669にてSET_NAIYO：荷送人名称取得)2012.06.01                                             " & vbNewLine _
                                     & "  LEFT JOIN $LM_MST$..M_CUST_DETAILS MCD_NFC                                                                " & vbNewLine _
                                     & "ON MCD_NFC.NRS_BR_CD   = OUTL.NRS_BR_CD                                                                     " & vbNewLine _
                                     & "AND MCD_NFC.CUST_CD      = OUTL.CUST_CD_L                                                                   " & vbNewLine _
                                     & "--AND MCD_NFC.CUST_CD_EDA  = OUTL.CUST_CD_M  --notes 1118                                                   " & vbNewLine _
                                     & "AND MCD_NFC.SUB_KB       = '29'                                                                             " & vbNewLine _
                                     & "AND MCD_NFC.SYS_DEL_FLG  = '0'                                                                              " & vbNewLine _
                                     & "--WHERE                                                                                                       " & vbNewLine _
                                     & "--    OUTL.SYS_DEL_FLG    = '0'                                                                               " & vbNewLine _
                                     & "--AND OUTL.NRS_BR_CD      = @NRS_BR_CD                                                                        " & vbNewLine _
                                     & "--AND OUTL.OUTKA_NO_L IN(@OUTKA_NO_L)                                                                         " & vbNewLine _
                                     & " --要望番号1383 [LMC664] --- START ---                                                                      " & vbNewLine _
                                     & "LEFT JOIN (SELECT NRS_BR_CD   AS NRS_BR_CD                                                                  " & vbNewLine _
                                     & "                 , CUST_CD     AS CUST_CD                                                                   " & vbNewLine _
                                     & "                 , CUST_CLASS  AS CUST_CLASS                                                                " & vbNewLine _
                                     & "                 , SET_NAIYO   AS CUST_NAIYO_1                                                              " & vbNewLine _
                                     & "                 , SET_NAIYO_2 AS CUST_NAIYO_2                                                              " & vbNewLine _
                                     & "                 , SET_NAIYO_3 AS CUST_NAIYO_3                                                              " & vbNewLine _
                                     & "              FROM $LM_MST$..M_CUST_DETAILS                                                                 " & vbNewLine _
                                     & "             WHERE SUB_KB ='42'                                                                             " & vbNewLine _
                                     & "               AND SET_NAIYO_2 = @RPT_ID                                                                    " & vbNewLine _
                                     & "               AND SYS_DEL_FLG = '0'                                                                        " & vbNewLine _
                                     & "            ) MCD_CUST                                                                                      " & vbNewLine _
                                     & "        ON CST.NRS_BR_CD = MCD_CUST.NRS_BR_CD                                                               " & vbNewLine _
                                     & "       AND (CASE WHEN MCD_CUST.CUST_CLASS='00' THEN  CST.CUST_CD_L                                                   " & vbNewLine _
                                     & "                 WHEN MCD_CUST.CUST_CLASS='01' THEN (CST.CUST_CD_L + CST.CUST_CD_M)                                  " & vbNewLine _
                                     & "                 WHEN MCD_CUST.CUST_CLASS='02' THEN (CST.CUST_CD_L + CST.CUST_CD_M + CST.CUST_CD_S)                  " & vbNewLine _
                                     & "                 WHEN MCD_CUST.CUST_CLASS='03' THEN (CST.CUST_CD_L + CST.CUST_CD_M + CST.CUST_CD_S + CST.CUST_CD_SS) " & vbNewLine _
                                     & "            END                                                                                             " & vbNewLine _
                                     & "           ) = MCD_CUST.CUST_CD                                                                             " & vbNewLine _
                                     & " --要望番号1383 [LMC664] --- END ---                                                                        " & vbNewLine

    ''' <summary>
    ''' 大阪用印刷用WHERE句
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_WHERE_707 As String = "WHERE                                                                                                     " & vbNewLine _
                                     & "    OUTL.SYS_DEL_FLG    = '0'                                                                               " & vbNewLine _
                                     & "AND OUTL.NRS_BR_CD      = @NRS_BR_CD                                                                        " & vbNewLine _
                                     & "AND OUTL.OUTKA_NO_L IN(@OUTKA_NO_L)                                                                         " & vbNewLine

    ''' <summary>
    ''' ORDER BY（①出荷管理番号L)）(☆★作業用コメント：修正済)
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_ORDER_BY_NOMAL_707 As String = "ORDER BY                                                                                                " & vbNewLine _
                                               & "     OUTL.NRS_BR_CD                                                                                     " & vbNewLine _
                                               & "    ,OUTL.OUTKA_NO_L                                                                                    " & vbNewLine

    ''' <summary>
    ''' 印刷データ抽出用
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_SELECT_DATA_MATOME_707 As String = "  --SQL_SELECT_DATA                                                                                  " & vbNewLine _
                                            & " SELECT                                                                                               " & vbNewLine _
                                            & " CASE WHEN MR2.PTN_CD IS NOT NULL THEN MR2.RPT_ID                                                    " & vbNewLine _
                                            & "      WHEN MR1.PTN_CD IS NOT NULL THEN MR1.RPT_ID                                                    " & vbNewLine _
                                            & "      ELSE '' END            AS RPT_ID                                                               " & vbNewLine _
                                            & ",OUTL.NRS_BR_CD              AS NRS_BR_CD                                                            " & vbNewLine _
                                            & "--このあたりから要修正の可能性                                                                       " & vbNewLine _
                                            & "--LMC560                                                                                             " & vbNewLine _
                                            & ",OUTL.OUTKA_PLAN_DATE        AS OUTKA_PLAN_DATE                                                      " & vbNewLine _
                                            & ",OUTL.OUTKA_NO_L             AS OUTKA_NO_L                                                           " & vbNewLine _
                                            & ",KB01.KBN_NM4                AS SHITEN_TEL_560_1                                                     " & vbNewLine _
                                            & ",KB01.KBN_NM3                AS SHITEN_NM_560_1                                                      " & vbNewLine _
                                            & ",OUTL.ARR_PLAN_DATE          AS ARR_PLAN_DATE                                                        " & vbNewLine _
                                            & ",KB02.KBN_NM1                AS ARR_PLAN_TIME                                                        " & vbNewLine _
                                            & ",OUTL.DEST_TEL               AS DEST_TEL                                                             " & vbNewLine _
                                            & ",CST.TEL                     AS CUST_TEL                                                             " & vbNewLine _
                                            & ",CST.AD_1                    AS CUST_AD_1                                                            " & vbNewLine _
                                            & ",CST.AD_2                    AS CUST_AD_2                                                            " & vbNewLine _
                                            & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_AD_1                                                   " & vbNewLine _
                                            & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_AD_1                                                   " & vbNewLine _
                                            & "      ELSE DST.AD_1                                                                                  " & vbNewLine _
                                            & " END                         AS DEST_AD_1                                                            " & vbNewLine _
                                            & ",CST.AD_3                    AS CUST_AD_3                                                            " & vbNewLine _
                                            & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_AD_2                                                   " & vbNewLine _
                                            & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_AD_2                                                   " & vbNewLine _
                                            & "      ELSE DST.AD_2                                                                                  " & vbNewLine _
                                            & " END                         AS DEST_AD_2                                                            " & vbNewLine _
                                            & ",OUTL.DEST_AD_3              AS DEST_AD_3                                                            " & vbNewLine _
                                            & ",FL.UNSO_WT                  AS BETU_WT                                                              " & vbNewLine _
                                            & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_NM                                                     " & vbNewLine _
                                            & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_NM                                                     " & vbNewLine _
                                            & "      ELSE DST.DEST_NM                                                                               " & vbNewLine _
                                            & " END                         AS DEST_NM_1                                                            " & vbNewLine _
                                            & ",CST.CUST_NM_L               AS CUST_NM_L                                                            " & vbNewLine _
                                            & "--LMC561                                                                                             " & vbNewLine _
                                            & ",CASE WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_ZIP                                                    " & vbNewLine _
                                            & "      ELSE DST.ZIP                                                                                   " & vbNewLine _
                                            & " END                         AS DEST_ZIP                                                             " & vbNewLine _
                                            & "--LMC562                                                                                             " & vbNewLine _
                                            & "--,(OUTS.BETU_WT * OUTS.ALCTD_NB) AS UNSO_WT                                                         " & vbNewLine _
                                            & ",(SELECT                                                                                             " & vbNewLine _
                                            & "SUM (UNSO_WT.UNSO_WT) FROM                                                                           " & vbNewLine _
                                            & "(SELECT                                                                                              " & vbNewLine _
                                            & "	--SUM(OUTS.BETU_WT * OUTS.ALCTD_NB) AS UNSO_WT                                                        " & vbNewLine _
                                            & "	SUM(OUTS.ALCTD_QT * MG.STD_WT_KGS / MG.STD_IRIME_NB) AS UNSO_WT                                     " & vbNewLine _
                                            & "	FROM                                                                                                " & vbNewLine _
                                            & "	$LM_TRN$..C_OUTKA_L OUTL                                                                            " & vbNewLine _
                                            & "	LEFT JOIN                                                                                           " & vbNewLine _
                                            & "	$LM_TRN$..C_OUTKA_M OUTM                                                                            " & vbNewLine _
                                            & "	  ON OUTL.NRS_BR_CD   = OUTM.NRS_BR_CD                                                              " & vbNewLine _
                                            & "	 AND OUTL.OUTKA_NO_L  = OUTM.OUTKA_NO_L                                                             " & vbNewLine _
                                            & "	 AND OUTM.SYS_DEL_FLG = '0'                                                                         " & vbNewLine _
                                            & "	LEFT JOIN                                                                                           " & vbNewLine _
                                            & "	$LM_TRN$..C_OUTKA_S OUTS                                                                            " & vbNewLine _
                                            & "	  ON OUTL.NRS_BR_CD   = OUTS.NRS_BR_CD                                                              " & vbNewLine _
                                            & "	 AND OUTL.OUTKA_NO_L  = OUTS.OUTKA_NO_L                                                             " & vbNewLine _
                                            & "	 AND OUTM.OUTKA_NO_M  = OUTS.OUTKA_NO_M                                                             " & vbNewLine _
                                            & "	 AND OUTS.SYS_DEL_FLG = '0'                                                                         " & vbNewLine _
                                            & "	LEFT JOIN                                                                                           " & vbNewLine _
                                            & "	$LM_MST$..M_GOODS MG                                                                            " & vbNewLine _
                                            & "	  ON OUTM.NRS_BR_CD   = MG.NRS_BR_CD                                                              " & vbNewLine _
                                            & "	 AND OUTM.GOODS_CD_NRS  = MG.GOODS_CD_NRS                                                             " & vbNewLine _
                                            & "	WHERE                                                                                               " & vbNewLine _
                                            & "	    OUTL.SYS_DEL_FLG  = '0'                                                                         " & vbNewLine _
                                            & "	AND OUTL.NRS_BR_CD    = @NRS_BR_CD                                                                  " & vbNewLine _
                                            & "	AND OUTL.OUTKA_NO_L   = @OUTKA_NO_L                                                                 " & vbNewLine _
                                            & "	GROUP BY                                                                                            " & vbNewLine _
                                            & "	 OUTS.BETU_WT                                                                                       " & vbNewLine _
                                            & "	,OUTS.ALCTD_NB                                                                                      " & vbNewLine _
                                            & "	,OUTL.NRS_BR_CD                                                                                     " & vbNewLine _
                                            & "	,OUTL.OUTKA_NO_L                                                                                    " & vbNewLine _
                                            & "	)  UNSO_WT                                                                                          " & vbNewLine _
                                            & "	)  UNSO_WT                                                                                          " & vbNewLine _
                                            & ",FL.UNSO_PKG_NB              AS UNSO_PKG_NB                                                          " & vbNewLine _
                                            & ",CST.CUST_NM_M               AS CUST_NM_M                                                            " & vbNewLine _
                                            & "--LMC563                                                                                             " & vbNewLine _
                                            & ",NB.NRS_BR_NM                AS NRS_BR_NM                                                            " & vbNewLine _
                                            & ",EDIL.FREE_C15               AS DEST_HOSOKU                                                          " & vbNewLine _
                                            & ",NB.AD_1                     AS NRS_AD_1                                                             " & vbNewLine _
                                            & ",NB.AD_2                     AS NRS_AD_2                                                             " & vbNewLine _
                                            & ",NB.TEL                      AS NRS_TEL                                                              " & vbNewLine _
                                            & ",CST.CUST_CD_L               AS CUST_CD_L                                                            " & vbNewLine _
                                            & ",FL.REMARK                   AS UNSO_L_REMARK                                                        " & vbNewLine _
                                            & ",OUTL.REMARK                 AS OUTKA_L_REMARK                                                       " & vbNewLine _
                                            & ",EDIM.GOODS_NM               AS GOODS_NM_1                                                           " & vbNewLine _
                                            & ",MG.OUTKA_ATT                AS OUTKA_ATT                                                            " & vbNewLine _
                                            & ",OUTL.BUYER_ORD_NO           AS BUYER_ORD_NO                                                         " & vbNewLine _
                                            & ",CASE WHEN OUTL.NRS_BR_CD = '50' THEN                                                                " & vbNewLine _
                                            & "      (                                                                                              " & vbNewLine _
                                            & "       CASE WHEN OUTL.CUST_CD_L = '20000' THEN MGD.SET_NAIYO                                         " & vbNewLine _
                                            & "             ELSE ''                                                                                 " & vbNewLine _
                                            & "       END                                                                                           " & vbNewLine _
                                            & "      )                                                                                              " & vbNewLine _
                                            & "      ELSE ''                                                                                        " & vbNewLine _
                                            & " END                         AS YELLOW_NO                                                            " & vbNewLine _
                                            & ",KB03.KBN_NM3                AS SHIHARAI_SHITEN_NM_563_1                                             " & vbNewLine _
                                            & ",CASE WHEN OUTL.NRS_BR_CD = '50' THEN                                                                " & vbNewLine _
                                            & "       (                                                                                             " & vbNewLine _
                                            & "         CASE WHEN OUTL.CUST_CD_L = '00007' THEN KB0401.KBN_NM3                                      " & vbNewLine _
                                            & "              WHEN OUTL.CUST_CD_L = '20000' THEN KB0402.KBN_NM3                                      " & vbNewLine _
                                            & "              WHEN OUTL.CUST_CD_L = '00950' THEN                                                     " & vbNewLine _
                                            & "                   (                                                                                 " & vbNewLine _
                                            & "                    CASE WHEN MG.SEARCH_KEY_1 = 'A0020' THEN KB0403.KBN_NM3                          " & vbNewLine _
                                            & "                         WHEN MG.SEARCH_KEY_1 = 'A0021' THEN KB0403.KBN_NM3                          " & vbNewLine _
                                            & "                         ELSE KB0404.KBN_NM3                                                         " & vbNewLine _
                                            & "                    END                                                                              " & vbNewLine _
                                            & "                   )                                                                                 " & vbNewLine _
                                            & "              ELSE KB0405.KBN_NM3                                                                    " & vbNewLine _
                                            & "         END                                                                                         " & vbNewLine _
                                            & "       )                                                                                             " & vbNewLine _
                                            & "      ELSE ''                                                                                        " & vbNewLine _
                                            & "END                          AS SHIHARAI_SHITEN_CD_563_1                                             " & vbNewLine _
                                            & ",KB03.KBN_NM4                AS SHIHARAI_SHITEN_TEL_563_1                                            " & vbNewLine _
                                            & "--LMC564                                                                                             " & vbNewLine _
                                            & ",KB05.KBN_NM4                AS SHITEN_TEL_1_564_1                                                   " & vbNewLine _
                                            & ",KB05.KBN_NM3                AS SHITEN_NM_564_1                                                      " & vbNewLine _
                                            & ",KB05.KBN_NM4                AS SHITEN_TEL_2_564_1                                                   " & vbNewLine _
                                            & ",NB.AD_1                     AS NRS_BR_AD_1                                                          " & vbNewLine _
                                            & ",NB.AD_2                     AS NRS_BR_AD_2                                                          " & vbNewLine _
                                            & ",NB.NRS_BR_NM                AS NRS_BR_NM_1                                                          " & vbNewLine _
                                            & "--LMC565                                                                                             " & vbNewLine _
                                            & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_NM                                                     " & vbNewLine _
                                            & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_NM                                                     " & vbNewLine _
                                            & "      ELSE DST.DEST_NM                                                                               " & vbNewLine _
                                            & " END                         AS DEST_NM                                                              " & vbNewLine _
                                            & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_AD_1                                                   " & vbNewLine _
                                            & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_AD_1                                                   " & vbNewLine _
                                            & "      ELSE DST.AD_1                                                                                  " & vbNewLine _
                                            & " END                         AS AD_1                                                                 " & vbNewLine _
                                            & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_AD_2                                                   " & vbNewLine _
                                            & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_AD_2                                                   " & vbNewLine _
                                            & "      ELSE DST.AD_2                                                                                  " & vbNewLine _
                                            & " END                         AS AD_2                                                                 " & vbNewLine _
                                            & ",OUTL.DEST_AD_3              AS AD_3                                                                 " & vbNewLine _
                                            & ",OUTL.DEST_TEL               AS TEL                                                                  " & vbNewLine _
                                            & ",OUTL.DEST_CD                AS DEST_CD                                                              " & vbNewLine _
                                            & ",OUTL.SHIP_CD_L              AS SHIP_CD_L                                                            " & vbNewLine _
                                            & ",KB0601.KBN_NM4              AS SHIHARAI_CD_565_1                                                    " & vbNewLine _
                                            & ",KB0602.KBN_NM4              AS SHIHARAI_CD_565_2                                                    " & vbNewLine _
                                            & "--LMC566                                                                                             " & vbNewLine _
                                            & ",NB.FAX                      AS NRS_FAX                                                              " & vbNewLine _
                                            & "--LMC567                                                                                             " & vbNewLine _
                                            & ",NB.AD_3                     AS NRS_AD_3                                                             " & vbNewLine _
                                            & "--LMC568                                                                                             " & vbNewLine _
                                            & ",OUTL.CUST_ORD_NO            AS CUST_ORD_NO                                                          " & vbNewLine _
                                            & ",MG.SHOBO_CD                 AS SHOBO_CD                                                             " & vbNewLine _
                                            & ",KB0701.KBN_NM5              AS CUST_CD_L_568_1                                                      " & vbNewLine _
                                            & ",KB0702.KBN_NM5              AS CUST_CD_L_568_2                                                      " & vbNewLine _
                                            & "--LMC569                                                                                             " & vbNewLine _
                                            & ",NB.ZIP                      AS NRS_BR_ZIP                                                           " & vbNewLine _
                                            & ",NB.TEL                      AS NRS_BR_TEL                                                           " & vbNewLine _
                                            & ",KB08.KBN_NM1                AS KOTEI_1                                                              " & vbNewLine _
                                            & ",KB08.KBN_NM3                AS KOTEI_2                                                              " & vbNewLine _
                                            & ",KB08.KBN_NM5                AS KOTEI_3                                                              " & vbNewLine _
                                            & "--LMC570                                                                                             " & vbNewLine _
                                            & ",FL.NB_UT                    AS NB_UT                                                                " & vbNewLine _
                                            & ",CST.DENPYO_NM               AS DENPYO_NM                                                            " & vbNewLine _
                                            & ",KB1001.KBN_NM3              AS SHITEN_NM_570_1                                                      " & vbNewLine _
                                            & ",KB1001.KBN_NM4              AS SHITEN_TEL_570_1                                                     " & vbNewLine _
                                            & ",KB1002.KBN_NM3              AS SHITEN_NM_570_2                                                      " & vbNewLine _
                                            & ",KB1002.KBN_NM4              AS SHITEN_TEL_570_2                                                     " & vbNewLine _
                                            & "--LMC572                                                                                             " & vbNewLine _
                                            & ",OUTL.OUTKA_PKG_NB           AS OUTKA_PKG_NB                                                         " & vbNewLine _
                                            & ",OUTM.IRIME                  AS IRIME                                                                " & vbNewLine _
                                            & ",OUTM.IRIME_UT               AS IRIME_UT                                                             " & vbNewLine _
                                            & ",OUTM.ALCTD_NB               AS ALCTD_NB                                                             " & vbNewLine _
                                            & ",OUTM.LOT_NO                 AS LOT_NO                                                               " & vbNewLine _
                                            & ",SHIPDST.DEST_NM             AS SHIP_NM_L                                                            " & vbNewLine _
                                            & ",CUSTDTL.SET_NAIYO           AS UNSO_CUST_CD                                                         " & vbNewLine _
                                            & ",KB0801.KBN_NM3              AS SHIHARAI_CD_575_1                                                    " & vbNewLine _
                                            & ",KB0802.KBN_NM3              AS SHIHARAI_CD_575_2                                                    " & vbNewLine _
                                            & "--LMC670                                                                                             " & vbNewLine _
                                            & ",KB0803.KBN_NM1              AS KBN_CUST_ZIP                                                         " & vbNewLine _
                                            & ",KB0803.KBN_NM2              AS KBN_CUST_AD                                                          " & vbNewLine _
                                            & ",KB0803.KBN_NM3              AS KBN_CUST_TEL                                                         " & vbNewLine _
                                            & ",KB0803.KBN_NM4              AS KBN_CUST_NM                                                          " & vbNewLine _
                                            & ",OUTL.OUTKO_DATE             AS OUTKO_DATE                                                           " & vbNewLine _
                                            & "--,(MG.STD_WT_KGS * OUTM.ALCTD_NB) AS ALCTD_WT                                                         " & vbNewLine _
                                            & ",(MG.STD_WT_KGS * OUTM.ALCTD_QT / MG.STD_IRIME_NB) AS ALCTD_WT                                                         " & vbNewLine _
                                            & "--,OUTKAEDIL.FREE_C05          AS BUKA_CD                                                            " & vbNewLine _
                                            & ",EDIL.FREE_C05          AS BUKA_CD                                                                   " & vbNewLine _
                                            & ",CASE WHEN SHIPDST.DEST_NM <> ''                                                                     " & vbNewLine _
                                            & "           AND SHIPDST.DEST_NM IS NOT NULL THEN SHIPDST.DEST_NM                                      " & vbNewLine _
                                            & "      WHEN CST.DENPYO_NM   <> ''                                                                     " & vbNewLine _
                                            & "           AND CST.DENPYO_NM IS NOT NULL   THEN CST.DENPYO_NM                                        " & vbNewLine _
                                            & "      ELSE CST.CUST_NM_L                                                                             " & vbNewLine _
                                            & " END                         AS ATSUKAISYA_NM                                                        " & vbNewLine _
                                            & "-- ,MG.GOODS_CD_CUST           AS GOODS_CD_CUST                 --2012.05.25                           " & vbNewLine _
                                            & "   ,EDIM.FREE_C01 + '  ' + EDIM.FREE_C02              AS GOODS_CD_CUST   --2012.05.25                " & vbNewLine _
                                            & " ,LEFT(JIS.JIS_CD,2)         AS PREF_CD                       --2012.05.25                           " & vbNewLine _
                                            & ",CASE WHEN LEFT(JIS.JIS_CD,2) ='16' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '17' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '18' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '21' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '25'                  --ここまで飛騨運輸のエリア                      " & vbNewLine _
                                            & "          THEN '飛騨運輸'                                                                            " & vbNewLine _
                                            & "     WHEN LEFT(JIS.JIS_CD,2) = '24' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '29' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '30' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '47'                  --ここまで近鉄運輸のエリア                      " & vbNewLine _
                                            & "         THEN '近鉄運輸'                                                                             " & vbNewLine _
                                            & "    WHEN  LEFT(JIS.JIS_CD,2) = '26' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '28' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '31' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '32' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '33' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '34' OR                                                               " & vbNewLine _
                                            & "       LEFT(JIS.JIS_CD,2) = '35' OR                                                                  " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '36' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '37' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '38' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '39'                                                                  " & vbNewLine _
                                            & "          THEN '岡山県貨物'                                                                          " & vbNewLine _
                                            & "          ELSE    '' END            AS TORI_UNSOCO_NM                                                " & vbNewLine _
                                            & "     --THEN MUC.UNSOCO_NM   END                                                                      " & vbNewLine _
                                            & "    --                              AS TORI_UNSOCO_NM                                                " & vbNewLine _
                                            & " --,MUC.UNSOCO_NM              AS TORI_UNSOCO_NM                --2012.05.25                         " & vbNewLine _
                                            & " ,MCD_SAI.SET_NAIYO          AS SAI_SHIHARAI_CD               --2012.05.25                           " & vbNewLine _
                                            & " ,MCD_SAI.SET_NAIYO_3        AS SET_NM_L                      --2012.05.29                           " & vbNewLine _
                                            & " ,MCD_NFC.SET_NAIYO          AS NAIYO1                        --2012.06.01                           " & vbNewLine _
                                            & " ,MCD_NFC.SET_NAIYO_2        AS NAIYO2                        --2012.06.01                           " & vbNewLine _
                                            & " ,MCD_NFC.SET_NAIYO_3        AS NAIYO3                        --2012.06.01                           " & vbNewLine _
                                            & " ,MCD_SAI.SET_NAIYO_2        AS NAIYO_CUST_NM                 --2012.06.04                           " & vbNewLine _
                                            & " ,OUTM.CUST_ORD_NO_DTL      AS CUST_ORD_NO_DTL              --2012.06.11                             " & vbNewLine _
                                            & " --2012.07.24 丸和運輸　荷受人氏名下の注意書き(REMARK)開始                                           " & vbNewLine _
                                            & " ,CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.REMARK                                                     " & vbNewLine _
                                            & "       WHEN OUTL.DEST_KB = '02' THEN EDIL.REMARK                                                     " & vbNewLine _
                                            & "       ELSE DST.REMARK                                                                               " & vbNewLine _
                                            & "  END                         AS REMARK_DEST                                                         " & vbNewLine _
                                            & " --2012.07.24 丸和運輸　荷受人氏名下の注意書き(REMARK)終了                                           " & vbNewLine _
                                            & " --要望番号1383 [LMC664] --- START ---                                                               " & vbNewLine _
                                            & " ,ISNULL(MCD_CUST.CUST_NAIYO_1,'') AS CUST_FLG                                                       " & vbNewLine _
                                            & " --要望番号1383 [LMC664] --- END ---                                                                 " & vbNewLine _
                                            & "		   ,ROW_NUMBER() OVER (PARTITION BY OUTL.NRS_BR_CD                                              " & vbNewLine _
                                           & "			ORDER BY OUTL.OUTKA_PLAN_DATE) AS REC_NO                                                    " & vbNewLine

    ''' <summary>
    ''' データ抽出用FROM句浮間用(☆★作業用コメント：20110711)
    ''' 明細出力のため、SQL_FROMにあった"WHERE BASE.NUM=をコメントアウトし、
    ''' 商品分だけレコードを出力。
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_FROM_NIKKO_MATOME_707 As String = "FROM                                                                                           " & vbNewLine _
                                     & "$LM_TRN$..C_OUTKA_L OUTL                                                                                    " & vbNewLine _
                                     & "--(2012.09.11)要望番号1412対応  --- START ---                                                               " & vbNewLine _
                                     & "--出荷EDIL                                                                                                  " & vbNewLine _
                                     & "--LEFT JOIN                                                                                                 " & vbNewLine _
                                     & "-- (                                                                                                        " & vbNewLine _
                                     & "--  SELECT                                                                                                  " & vbNewLine _
                                     & "--        MIN(DEST_AD_1)   AS DEST_AD_1                                                                     " & vbNewLine _
                                     & "--       ,MIN(DEST_AD_2)   AS DEST_AD_2                                                                     " & vbNewLine _
                                     & "--       ,DEST_AD_3                                                                                         " & vbNewLine _
                                     & "--       ,DEST_TEL                                                                                          " & vbNewLine _
                                     & "--       ,DEST_ZIP                                                                                          " & vbNewLine _
                                     & "--       ,FREE_C15                                                                                          " & vbNewLine _
                                     & "--       ,MIN(DEST_NM)     AS DEST_NM                                                                       " & vbNewLine _
                                     & "--       ,NRS_BR_CD                                                                                         " & vbNewLine _
                                     & "--       ,OUTKA_CTL_NO                                                                                      " & vbNewLine _
                                     & "--       ,SHIP_NM_L                                                                                         " & vbNewLine _
                                     & "--       ,SYS_DEL_FLG                                                                                       " & vbNewLine _
                                     & "--       ,FREE_C05                                                                                          " & vbNewLine _
                                     & "--       --,REMARK                    --2012.07.24 丸和運輸　荷受人氏名下の注意書き                         " & vbNewLine _
                                     & "--       ,MIN(REMARK)      AS REMARK  --2012.08.21 要望番号1355                                             " & vbNewLine _
                                     & "--  FROM                                                                                                    " & vbNewLine _
                                     & "--        $LM_TRN$..H_OUTKAEDI_L                                                                            " & vbNewLine _
                                     & "--  GROUP BY                                                                                                " & vbNewLine _
                                     & "--        DEST_AD_3                                                                                         " & vbNewLine _
                                     & "--       ,DEST_TEL                                                                                          " & vbNewLine _
                                     & "--       ,DEST_ZIP                                                                                          " & vbNewLine _
                                     & "--       ,FREE_C15                                                                                          " & vbNewLine _
                                     & "--       ,NRS_BR_CD                                                                                         " & vbNewLine _
                                     & "--       ,OUTKA_CTL_NO                                                                                      " & vbNewLine _
                                     & "--       ,SHIP_NM_L                                                                                         " & vbNewLine _
                                     & "--       ,SYS_DEL_FLG                                                                                       " & vbNewLine _
                                     & "--       ,FREE_C05                                                                                          " & vbNewLine _
                                     & "--       --,REMARK   --2012.07.24 丸和運輸　荷受人氏名下の注意書き   2012.08.21 要望番号1355 コメント化     " & vbNewLine _
                                     & "-- )                                                                                                        " & vbNewLine _
                                     & "--  EDIL                                                                                                    " & vbNewLine _
                                     & "--ON   EDIL.NRS_BR_CD   = OUTL.NRS_BR_CD                                                                    " & vbNewLine _
                                     & "--AND EDIL.OUTKA_CTL_NO = OUTL.OUTKA_NO_L                                                                   " & vbNewLine _
                                     & "--AND EDIL.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--AND EDIL.NRS_BR_CD    = OUTL.NRS_BR_CD                                                                    " & vbNewLine _
                                     & "--下記の内容に変更                                                                                          " & vbNewLine _
                                     & " LEFT JOIN (                                                                                                " & vbNewLine _
                                     & "            SELECT                                                                                          " & vbNewLine _
                                     & "                   NRS_BR_CD                                                                                " & vbNewLine _
                                     & "                 , EDI_CTL_NO                                                                               " & vbNewLine _
                                     & "                 , OUTKA_CTL_NO                                                                             " & vbNewLine _
                                     & "             FROM (                                                                                         " & vbNewLine _
                                     & "                    SELECT                                                                                  " & vbNewLine _
                                     & "                           EDIOUTL.NRS_BR_CD                                                                " & vbNewLine _
                                     & "                         , EDIOUTL.EDI_CTL_NO                                                               " & vbNewLine _
                                     & "                         , EDIOUTL.OUTKA_CTL_NO                                                             " & vbNewLine _
                                     & "                         , CASE WHEN EDIOUTL.OUTKA_CTL_NO = '' THEN 1                                       " & vbNewLine _
                                     & "                           ELSE ROW_NUMBER() OVER (PARTITION BY EDIOUTL.NRS_BR_CD                           " & vbNewLine _
                                     & "                                                              , EDIOUTL.OUTKA_CTL_NO                        " & vbNewLine _
                                     & "                                                       ORDER BY EDIOUTL.NRS_BR_CD                           " & vbNewLine _
                                     & "                                                              , EDIOUTL.EDI_CTL_NO                          " & vbNewLine _
                                     & "                                                  )                                                         " & vbNewLine _
                                     & "                           END AS IDX                                                                       " & vbNewLine _
                                     & "                      FROM $LM_TRN$..H_OUTKAEDI_L EDIOUTL                                                   " & vbNewLine _
                                     & "                     WHERE EDIOUTL.SYS_DEL_FLG  = '0'                                                       " & vbNewLine _
                                     & "                       AND EDIOUTL.NRS_BR_CD    = @NRS_BR_CD                                                " & vbNewLine _
                                     & "--要望管理1451                   AND EDIOUTL.OUTKA_CTL_NO = @OUTKA_NO_L                                     " & vbNewLine _
                                     & "                   ) EBASE                                                                                  " & vbNewLine _
                                     & "            WHERE EBASE.IDX = 1                                                                             " & vbNewLine _
                                     & "            ) TOPEDI                                                                                        " & vbNewLine _
                                     & "        ON TOPEDI.NRS_BR_CD    = OUTL.NRS_BR_CD                                                             " & vbNewLine _
                                     & "       AND TOPEDI.OUTKA_CTL_NO = OUTL.OUTKA_NO_L                                                            " & vbNewLine _
                                     & " LEFT JOIN $LM_TRN$..H_OUTKAEDI_L EDIL                                                                      " & vbNewLine _
                                     & "        ON EDIL.NRS_BR_CD  = TOPEDI.NRS_BR_CD                                                               " & vbNewLine _
                                     & "       AND EDIL.EDI_CTL_NO = TOPEDI.EDI_CTL_NO                                                              " & vbNewLine _
                                     & "--(2012.09.11)要望番号1412対応  ---  END  ---                                                               " & vbNewLine _
                                     & " LEFT JOIN $LM_TRN$..H_OUTKAEDI_M EDIM                                                                      " & vbNewLine _
                                     & "         ON EDIM.NRS_BR_CD  = EDIL.NRS_BR_CD                                                                " & vbNewLine _
                                     & "        AND EDIM.EDI_CTL_NO = EDIL.EDI_CTL_NO                                                               " & vbNewLine _
                                     & "--出荷M                                                                                                     " & vbNewLine _
                                     & "LEFT JOIN                                                                                                   " & vbNewLine _
                                     & "(SELECT                                                                                                     " & vbNewLine _
                                     & "*                                                                                                           " & vbNewLine _
                                     & "FROM                                                                                                        " & vbNewLine _
                                     & "(SELECT                                                                                                     " & vbNewLine _
                                     & "--(2012.06.18)要望番号1160対応 --- START ----                                                               " & vbNewLine _
                                     & "--   NRS_BR_CD                                                                                              " & vbNewLine _
                                     & "--  ,GOODS_CD_NRS                                                                                           " & vbNewLine _
                                     & "--  ,IRIME                                                                                                  " & vbNewLine _
                                     & "--  ,IRIME_UT                                                                                               " & vbNewLine _
                                     & "--  ,ALCTD_NB                                                                                               " & vbNewLine _
                                     & "--  ,LOT_NO                                                                                                 " & vbNewLine _
                                     & "--  ,CUST_ORD_NO_DTL   --2012/06/11浮間対応                                                                 " & vbNewLine _
                                     & "--  ,SYS_DEL_FLG                                                                                            " & vbNewLine _
                                     & "--  ,ROW_NUMBER() OVER (PARTITION BY NRS_BR_CD ORDER BY OUTKA_NO_L,OUTKA_NO_M) AS NUM                       " & vbNewLine _
                                     & "   M.NRS_BR_CD                                                                                              " & vbNewLine _
                                     & "  ,M.GOODS_CD_NRS                                                                                           " & vbNewLine _
                                     & "  ,M.IRIME                                                                                                  " & vbNewLine _
                                     & "  ,M.IRIME_UT                                                                                               " & vbNewLine _
                                     & "  ,M.ALCTD_NB                                                                                               " & vbNewLine _
                                     & "  ,M.ALCTD_QT                                                                                               " & vbNewLine _
                                     & "  ,M.LOT_NO                                                                                                 " & vbNewLine _
                                     & "  ,M.CUST_ORD_NO_DTL   --2012/06/11浮間対応                                                                 " & vbNewLine _
                                     & "  ,M.SYS_DEL_FLG                                                                                            " & vbNewLine _
                                     & "  ,ROW_NUMBER() OVER (PARTITION BY M.NRS_BR_CD ORDER BY M.OUTKA_NO_L,M.OUTKA_NO_M) AS NUM                   " & vbNewLine _
                                     & "  ,M.OUTKA_NO_L                                                                                             " & vbNewLine _
                                     & "  ,M.OUTKA_NO_M                                                                                             " & vbNewLine _
                                     & "  ,M.PRINT_SORT                                                                                             " & vbNewLine _
                                     & "  FROM                                                                                                      " & vbNewLine _
                                     & "--(2012.06.18)要望番号1160対応 ---  END  ----                                                               " & vbNewLine _
                                     & "   $LM_TRN$..C_OUTKA_M M                                                                                    " & vbNewLine _
                                     & "--(2012.06.18)要望番号1160対応 --- START ----                                                               " & vbNewLine _
                                     & "   LEFT JOIN $LM_TRN$..C_OUTKA_L OUTL                                                                       " & vbNewLine _
                                     & "          ON OUTL.NRS_BR_CD  = M.NRS_BR_CD                                                                  " & vbNewLine _
                                     & "         AND OUTL.OUTKA_NO_L = M.OUTKA_NO_L                                                                 " & vbNewLine _
                                     & "         AND OUTL.SYS_DEL_FLG  = '0'                                                                        " & vbNewLine _
                                     & "   LEFT JOIN $LM_TRN$..F_UNSO_L FL                                                                          " & vbNewLine _
                                     & "          ON FL.NRS_BR_CD    = M.NRS_BR_CD                                                                  " & vbNewLine _
                                     & "         AND FL.INOUTKA_NO_L = M.OUTKA_NO_L                                                                 " & vbNewLine _
                                     & "         AND FL.MOTO_DATA_KB = '20'                                                                         " & vbNewLine _
                                     & "         AND FL.SYS_DEL_FLG  = '0'                                                                          " & vbNewLine _
                                     & "--(2012.06.18)要望番号1160対応 ---  END  ----                                                               " & vbNewLine _
                                     & "  WHERE                                                                                                     " & vbNewLine _
                                     & "      M.NRS_BR_CD = @NRS_BR_CD                                                                              " & vbNewLine _
                                     & "--(2012.06.18)要望番号1160対応 --- START ----                                                               " & vbNewLine _
                                     & "    AND OUTL.CUST_CD_L       = @CUST_CD_L                                                                   " & vbNewLine _
                                     & "    AND OUTL.CUST_CD_M       = @CUST_CD_M                                                                   " & vbNewLine _
                                     & "    AND OUTL.OUTKA_PLAN_DATE = @OUTKA_PLAN_DATE                                                             " & vbNewLine _
                                     & "    AND OUTL.ARR_PLAN_DATE   = @ARR_PLAN_DATE                                                               " & vbNewLine _
                                     & "    AND FL.UNSO_CD           = @UNSO_CD                                                                     " & vbNewLine _
                                     & "    AND FL.UNSO_BR_CD        = @UNSO_BR_CD                                                                  " & vbNewLine _
                                     & "    AND OUTL.DEST_CD         = @DEST_CD                                                                     " & vbNewLine _
                                     & "--  AND M.OUTKA_NO_L IN(@OUTKA_NO_L)                                                                        " & vbNewLine _
                                     & "--  AND SYS_DEL_FLG = '0'                                                                                   " & vbNewLine _
                                     & "    AND M.SYS_DEL_FLG = '0'                                                                                 " & vbNewLine _
                                     & "--(2012.06.18)要望番号1160対応 ---  END  ----                                                               " & vbNewLine _
                                     & " ) AS BASE                                                                                                  " & vbNewLine _
                                     & "-- WHERE                                                                                                    " & vbNewLine _
                                     & "-- BASE.NUM = 1                                                                                             " & vbNewLine _
                                     & ") OUTM                                                                                                      " & vbNewLine _
                                     & "--ON                                                                                                        " & vbNewLine _
                                     & "--1 = 1                                                                                                     " & vbNewLine _
                                     & "--(2012.06.18)要望番号1160対応 --- START ----                                                               " & vbNewLine _
                                     & " ON OUTL.NRS_BR_CD  = OUTM.NRS_BR_CD                                                                        " & vbNewLine _
                                     & "AND OUTL.OUTKA_NO_L = OUTM.OUTKA_NO_L                                                                       " & vbNewLine _
                                     & "--(2012.06.18)要望番号1160対応 ---  END  ----                                                               " & vbNewLine _
                                     & "--F運送L                                                                                                    " & vbNewLine _
                                     & "LEFT JOIN $LM_TRN$..F_UNSO_L FL                                                                             " & vbNewLine _
                                     & "ON  FL.MOTO_DATA_KB   = '20'                                                                                " & vbNewLine _
                                     & "AND FL.NRS_BR_CD      = OUTL.NRS_BR_CD                                                                      " & vbNewLine _
                                     & "AND FL.INOUTKA_NO_L   = OUTL.OUTKA_NO_L                                                                     " & vbNewLine _
                                     & "AND FL.SYS_DEL_FLG    = '0'                                                                                 " & vbNewLine _
                                     & "--出荷EDI L                                                                                                 " & vbNewLine _
                                     & "--LEFT JOIN $LM_TRN$..H_OUTKAEDI_L OUTKAEDIL                                                                  " & vbNewLine _
                                     & "--ON  OUTKAEDIL.NRS_BR_CD     = OUTL.NRS_BR_CD                                                                " & vbNewLine _
                                     & "--AND OUTKAEDIL.OUTKA_CTL_NO  = OUTL.OUTKA_NO_L                                                               " & vbNewLine _
                                     & "--AND OUTKAEDIL.SYS_DEL_FLG   = '0'                                                                           " & vbNewLine _
                                     & "--商品M                                                                                                     " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_GOODS MG                                                                              " & vbNewLine _
                                     & "ON  MG.NRS_BR_CD     = OUTM.NRS_BR_CD                                                                       " & vbNewLine _
                                     & "AND MG.GOODS_CD_NRS  = OUTM.GOODS_CD_NRS                                                                    " & vbNewLine _
                                     & "AND MG.SYS_DEL_FLG   = '0'                                                                                  " & vbNewLine _
                                     & "--荷主なしでの運送会社荷主別送り状パターン取得                                                              " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_UNSO_CUST_RPT MCR1                                                                    " & vbNewLine _
                                     & "ON  FL.NRS_BR_CD     = MCR1.NRS_BR_CD                                                                       " & vbNewLine _
                                     & "AND FL.UNSO_CD       = MCR1.UNSOCO_CD                                                                       " & vbNewLine _
                                     & "AND FL.UNSO_BR_CD    = MCR1.UNSOCO_BR_CD                                                                    " & vbNewLine _
                                     & "AND '11'             = MCR1.PTN_ID                                                                          " & vbNewLine _
                                     & "AND FL.PC_KB         = MCR1.MOTO_TYAKU_KB                                                                   " & vbNewLine _
                                     & "AND ''               = MCR1.CUST_CD_L                                                                       " & vbNewLine _
                                     & "AND ''               = MCR1.CUST_CD_M                                                                       " & vbNewLine _
                                     & "AND MCR1.SYS_DEL_FLG = '0'                                                                                  " & vbNewLine _
                                     & "--帳票パターン取得                                                                                          " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_RPT MR1                                                                               " & vbNewLine _
                                     & "ON  MR1.NRS_BR_CD   = MCR1.NRS_BR_CD                                                                        " & vbNewLine _
                                     & "AND MR1.PTN_ID      = MCR1.PTN_ID                                                                           " & vbNewLine _
                                     & "AND MR1.PTN_CD      = MCR1.PTN_CD                                                                           " & vbNewLine _
                                     & "AND MR1.SYS_DEL_FLG = '0'                                                                                   " & vbNewLine _
                                     & "--荷主込みでの運送会社荷主別送り状パターン取得                                                              " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_UNSO_CUST_RPT MCR2                                                                    " & vbNewLine _
                                     & "ON  FL.NRS_BR_CD     = MCR2.NRS_BR_CD                                                                       " & vbNewLine _
                                     & "AND FL.UNSO_CD       = MCR2.UNSOCO_CD                                                                       " & vbNewLine _
                                     & "AND FL.UNSO_BR_CD    = MCR2.UNSOCO_BR_CD                                                                    " & vbNewLine _
                                     & "AND '11'             = MCR2.PTN_ID                                                                          " & vbNewLine _
                                     & "AND FL.PC_KB         = MCR2.MOTO_TYAKU_KB                                                                   " & vbNewLine _
                                     & "AND FL.CUST_CD_L     = MCR2.CUST_CD_L                                                                       " & vbNewLine _
                                     & "AND FL.CUST_CD_M     = MCR2.CUST_CD_M                                                                       " & vbNewLine _
                                     & "AND MCR2.SYS_DEL_FLG = '0'                                                                                  " & vbNewLine _
                                     & "--帳票パターン取得                                                                                          " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_RPT MR2                                                                               " & vbNewLine _
                                     & "ON  MR2.NRS_BR_CD    = MCR2.NRS_BR_CD                                                                       " & vbNewLine _
                                     & "AND MR2.PTN_ID       = MCR2.PTN_ID                                                                          " & vbNewLine _
                                     & "AND MR2.PTN_CD       = MCR2.PTN_CD                                                                          " & vbNewLine _
                                     & "AND MR2.SYS_DEL_FLG  = '0'                                                                                  " & vbNewLine _
                                     & "--存在しない場合の帳票パターン取得                                                                          " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_RPT MR3                                                                               " & vbNewLine _
                                     & "ON  MR3.NRS_BR_CD     = OUTL.NRS_BR_CD                                                                      " & vbNewLine _
                                     & "AND MR3.PTN_ID        = '11'                                                                                " & vbNewLine _
                                     & "AND MR3.STANDARD_FLAG = '01'                                                                                " & vbNewLine _
                                     & "AND MR3.SYS_DEL_FLG   = '0'                                                                                 " & vbNewLine _
                                     & "--荷主マスタ (ここからメインプリント用)                                                               " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_CUST CST                                                                              " & vbNewLine _
                                     & "ON  CST.NRS_BR_CD     = MG.NRS_BR_CD                                                                        " & vbNewLine _
                                     & "AND CST.CUST_CD_L     = MG.CUST_CD_L                                                                        " & vbNewLine _
                                     & "AND CST.CUST_CD_M     = MG.CUST_CD_M                                                                        " & vbNewLine _
                                     & "AND CST.CUST_CD_S     = MG.CUST_CD_S                                                                        " & vbNewLine _
                                     & "AND CST.CUST_CD_SS    = MG.CUST_CD_SS                                                                       " & vbNewLine _
                                     & "AND CST.SYS_DEL_FLG   = '0'                                                                                 " & vbNewLine _
                                     & "--届先マスタ                                                                                                " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_DEST DST                                                                              " & vbNewLine _
                                     & "ON  DST.NRS_BR_CD     = OUTL.NRS_BR_CD                                                                      " & vbNewLine _
                                     & "AND DST.CUST_CD_L     = OUTL.CUST_CD_L                                                                      " & vbNewLine _
                                     & "AND DST.DEST_CD       = OUTL.DEST_CD                                                                        " & vbNewLine _
                                     & "AND DST.SYS_DEL_FLG   = '0'                                                                                 " & vbNewLine _
                                     & "--届先マスタ                                                                                                " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_DEST SHIPDST                                                                          " & vbNewLine _
                                     & "ON  SHIPDST.NRS_BR_CD     = OUTL.NRS_BR_CD                                                                  " & vbNewLine _
                                     & "AND SHIPDST.CUST_CD_L     = OUTL.CUST_CD_L                                                                  " & vbNewLine _
                                     & "AND SHIPDST.DEST_CD       = OUTL.SHIP_CD_L                                                                  " & vbNewLine _
                                     & "AND SHIPDST.SYS_DEL_FLG   = '0'                                                                             " & vbNewLine _
                                     & "--営業所マスタ                                                                                              " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_NRS_BR NB                                                                             " & vbNewLine _
                                     & "ON  NB.NRS_BR_CD      = OUTL.NRS_BR_CD                                                                      " & vbNewLine _
                                     & "AND NB.SYS_DEL_FLG    = '0'                                                                                 " & vbNewLine _
                                     & "--商品明細                                                                                                  " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_GOODS_DETAILS MGD                                                                     " & vbNewLine _
                                     & "ON  MGD.NRS_BR_CD       = OUTM.NRS_BR_CD                                                                    " & vbNewLine _
                                     & "AND MGD.GOODS_CD_NRS    = OUTM.GOODS_CD_NRS                                                                 " & vbNewLine _
                                     & "AND MGD.SUB_KB          = '01'                                                                              " & vbNewLine _
                                     & "AND MGD.SYS_DEL_FLG     = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC560支店TEL(NM4)・支店名(NM3))KB01                                                           " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB01                                                                              " & vbNewLine _
                                     & "ON  KB01.KBN_GROUP_CD = 'O007'                                                                              " & vbNewLine _
                                     & "AND KB01.KBN_CD       = '01'                                                                                " & vbNewLine _
                                     & "AND KB01.SYS_DEL_FLG  = '0'                                                                                 " & vbNewLine _
                                     & "--区分マスタ(納期文言)KB02                                                                                  " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB02                                                                              " & vbNewLine _
                                     & "ON  KB02.KBN_GROUP_CD = 'N010'                                                                              " & vbNewLine _
                                     & "AND KB02.KBN_CD       = OUTL.ARR_PLAN_TIME                                                                  " & vbNewLine _
                                     & "AND KB02.SYS_DEL_FLG  = '0'                                                                                 " & vbNewLine _
                                     & "--区分マスタ(LMC563支店名(NM3)、電話番号(NM4))KB03                                                          " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB03                                                                              " & vbNewLine _
                                     & "ON  KB03.KBN_GROUP_CD = 'O007'                                                                              " & vbNewLine _
                                     & "AND KB03.KBN_CD       = '10'                                                                                " & vbNewLine _
                                     & "AND KB03.SYS_DEL_FLG  = '0'                                                                                 " & vbNewLine _
                                     & "--区分マスタ(LMC563支払支店コード(NM3))KB0401                                                               " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0401                                                                            " & vbNewLine _
                                     & "ON  KB0401.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0401.KBN_CD       = '11'                                                                              " & vbNewLine _
                                     & "AND KB0401.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC563支払支店コード(NM3))KB0402                                                               " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0402                                                                            " & vbNewLine _
                                     & "ON  KB0402.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0402.KBN_CD       = '12'                                                                              " & vbNewLine _
                                     & "AND KB0402.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC563支払支店コード(NM3))KB0403                                                               " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0403                                                                            " & vbNewLine _
                                     & "ON  KB0403.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0403.KBN_CD       = '13'                                                                              " & vbNewLine _
                                     & "AND KB0403.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC563支払支店コード(NM3))KB0404                                                               " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0404                                                                            " & vbNewLine _
                                     & "ON  KB0404.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0404.KBN_CD       = '14'                                                                              " & vbNewLine _
                                     & "AND KB0404.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC563支払支店コード(NM3))KB0405                                                               " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0405                                                                            " & vbNewLine _
                                     & "ON  KB0405.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0405.KBN_CD       = '15'                                                                              " & vbNewLine _
                                     & "AND KB0405.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC564支店TEL、荷主TEL(NM4)・支店名(NM3))KB05                                                  " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB05                                                                              " & vbNewLine _
                                     & "ON  KB05.KBN_GROUP_CD   = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB05.KBN_CD         = '02'                                                                              " & vbNewLine _
                                     & "AND KB05.SYS_DEL_FLG    = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC565支払いコード(NM3)KB0601)                                                                 " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0601                                                                            " & vbNewLine _
                                     & "ON  KB0601.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0601.KBN_CD       = '07'                                                                              " & vbNewLine _
                                     & "AND KB0601.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC565支払いコード(NM3)KB0602)                                                                 " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0602                                                                            " & vbNewLine _
                                     & "ON  KB0602.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0602.KBN_CD       = '08'                                                                              " & vbNewLine _
                                     & "AND KB0602.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC568荷主コード(NM5)KB0701                                                                    " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0701                                                                            " & vbNewLine _
                                     & "ON  KB0701.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0701.KBN_CD       = '03'                                                                              " & vbNewLine _
                                     & "AND KB0701.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC568荷主コード(NM5)KB0702                                                                    " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0702                                                                            " & vbNewLine _
                                     & "ON  KB0702.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0702.KBN_CD       = '09'                                                                              " & vbNewLine _
                                     & "AND KB0702.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC569固定表示(NM1,3,4))KB08                                                                   " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB08                                                                              " & vbNewLine _
                                     & "ON  KB08.KBN_GROUP_CD   = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB08.KBN_CD         = '04'                                                                              " & vbNewLine _
                                     & "AND KB08.SYS_DEL_FLG    = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC570支店名(NM3)支店TEL(NM4))KB1001                                                           " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB1001                                                                            " & vbNewLine _
                                     & "ON  KB1001.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB1001.KBN_CD       = '05'                                                                              " & vbNewLine _
                                     & "AND KB1001.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC570支店名(NM3)支店TEL(NM4))KB1002                                                           " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB1002                                                                            " & vbNewLine _
                                     & "ON  KB1002.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB1002.KBN_CD       = '06'                                                                              " & vbNewLine _
                                     & "AND KB1002.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--荷主明細マスタ(LMC573にて運送契約荷主コード取得)                                                          " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_CUST_DETAILS CUSTDTL                                                                  " & vbNewLine _
                                     & "ON  CUSTDTL.NRS_BR_CD    = OUTL.NRS_BR_CD                                                                   " & vbNewLine _
                                     & "AND CUSTDTL.CUST_CD      = OUTL.CUST_CD_L + OUTL.CUST_CD_M                                                  " & vbNewLine _
                                     & "AND CUSTDTL.SUB_KB       = '03'                                                                             " & vbNewLine _
                                     & "AND CUSTDTL.SYS_DEL_FLG  = '0'                                                                              " & vbNewLine _
                                     & "--区分マスタ(LMC575支払コード(NM3)KB0801)                                                                   " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0801                                                                            " & vbNewLine _
                                     & "ON  KB0801.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0801.KBN_CD       = '16'                                                                              " & vbNewLine _
                                     & "AND KB0801.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC575支払コード(NM3)KB0802)                                                                   " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0802                                                                            " & vbNewLine _
                                     & "ON  KB0802.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0802.KBN_CD       = '17'                                                                              " & vbNewLine _
                                     & "AND KB0802.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC670 KB0803)                                                                                 " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0803                                                                            " & vbNewLine _
                                     & "ON  KB0803.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0803.KBN_CD       = '18'                                                                              " & vbNewLine _
                                     & "AND KB0803.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_DEST      DEST_JIS --2012.05.25                                                       " & vbNewLine _
                                     & "ON  DEST_JIS.NRS_BR_CD    = OUTL.NRS_BR_CD                                                                  " & vbNewLine _
                                     & "AND DEST_JIS.CUST_CD_L    = OUTL.CUST_CD_L                                                                  " & vbNewLine _
                                     & "AND DEST_JIS.DEST_CD      = OUTL.DEST_CD                                                                    " & vbNewLine _
                                     & "AND DEST_JIS.SYS_DEL_FLG  = '0'                                                                             " & vbNewLine _
                                     & "--JISマスタ(LMC661にてJIS_CD2桁：都道府県コード取得)2012.05.25                                              " & vbNewLine _
                                     & "  LEFT JOIN  $LM_MST$..M_JIS   JIS                                                                          " & vbNewLine _
                                     & "  ON  JIS.JIS_CD       = DEST_JIS.JIS                                                                       " & vbNewLine _
                                     & " AND  JIS.SYS_DEL_FLG  = '0'                                                                                " & vbNewLine _
                                     & "--運送会社マスタ(LMC589にてUNSOCO_NM：取次先運送会社名取得)2012.05.25                                       " & vbNewLine _
                                     & "--  LEFT JOIN  $LM_MST$..M_UNSOCO   MUC                                                                     " & vbNewLine _
                                     & "--  ON  MUC.NRS_BR_CD    = FL.NRS_BR_CD                                                                     " & vbNewLine _
                                     & "-- AND  MUC.UNSOCO_CD    = FL.UNSO_CD                                                                       " & vbNewLine _
                                     & "-- AND  MUC.UNSOCO_BR_CD = FL.UNSO_BR_CD                                                                    " & vbNewLine _
                                     & "-- AND  MUC.SYS_DEL_FLG  = '0'                                                                              " & vbNewLine _
                                     & "--荷主明細マスタ(LMC660にてSET_NAIYO：支払コード取得)2012.05.25                                             " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_CUST_DETAILS MCD_SAI                                                                  " & vbNewLine _
                                     & "ON  MCD_SAI.NRS_BR_CD    = OUTL.NRS_BR_CD                                                                   " & vbNewLine _
                                     & "AND MCD_SAI.CUST_CD      = OUTL.CUST_CD_L                                                                   " & vbNewLine _
                                     & "--AND MCD_SAI.CUST_CD_EDA  = OUTL.CUST_CD_M                                                                   " & vbNewLine _
                                     & "AND MCD_SAI.SUB_KB       = '27'                                                                             " & vbNewLine _
                                     & "AND MCD_SAI.SYS_DEL_FLG  = '0'                                                                              " & vbNewLine _
                                     & "--荷主明細マスタ(LMC669にてSET_NAIYO：荷送人名称取得)2012.06.01                                             " & vbNewLine _
                                     & "  LEFT JOIN $LM_MST$..M_CUST_DETAILS MCD_NFC                                                                " & vbNewLine _
                                     & "ON MCD_NFC.NRS_BR_CD   = OUTL.NRS_BR_CD                                                                     " & vbNewLine _
                                     & "AND MCD_NFC.CUST_CD      = OUTL.CUST_CD_L                                                                   " & vbNewLine _
                                     & "--AND MCD_NFC.CUST_CD_EDA  = OUTL.CUST_CD_M                                                                   " & vbNewLine _
                                     & "AND MCD_NFC.SUB_KB       = '29'                                                                             " & vbNewLine _
                                     & "AND MCD_NFC.SYS_DEL_FLG  = '0'                                                                              " & vbNewLine _
                                     & "--WHERE                                                                                                       " & vbNewLine _
                                     & "--    OUTL.SYS_DEL_FLG    = '0'                                                                               " & vbNewLine _
                                     & "--AND OUTL.NRS_BR_CD      = @NRS_BR_CD                                                                        " & vbNewLine _
                                     & "--AND OUTL.OUTKA_NO_L IN(@OUTKA_NO_L)                                                                         " & vbNewLine _
                                     & " --要望番号1383 [LMC664] --- START ---                                                          " & vbNewLine _
                                     & "         LEFT JOIN (SELECT NRS_BR_CD   AS NRS_BR_CD                                             " & vbNewLine _
                                     & "                         , CUST_CD     AS CUST_CD                                               " & vbNewLine _
                                     & "                         , CUST_CLASS  AS CUST_CLASS                                            " & vbNewLine _
                                     & "                         , SET_NAIYO   AS CUST_NAIYO_1                                          " & vbNewLine _
                                     & "                         , SET_NAIYO_2 AS CUST_NAIYO_2                                          " & vbNewLine _
                                     & "                         , SET_NAIYO_3 AS CUST_NAIYO_3                                          " & vbNewLine _
                                     & "                      FROM $LM_MST$..M_CUST_DETAILS                                             " & vbNewLine _
                                     & "                     WHERE SUB_KB ='42'                                                         " & vbNewLine _
                                     & "                       AND SET_NAIYO_2 = @RPT_ID                                                " & vbNewLine _
                                     & "                       AND SYS_DEL_FLG = '0'                                                    " & vbNewLine _
                                     & "                    ) MCD_CUST                                                                  " & vbNewLine _
                                     & "                ON CST.NRS_BR_CD = MCD_CUST.NRS_BR_CD                                           " & vbNewLine _
                                     & "               AND (CASE WHEN MCD_CUST.CUST_CLASS='00' THEN  CST.CUST_CD_L                                                   " & vbNewLine _
                                     & "                         WHEN MCD_CUST.CUST_CLASS='01' THEN (CST.CUST_CD_L + CST.CUST_CD_M)                                  " & vbNewLine _
                                     & "                         WHEN MCD_CUST.CUST_CLASS='02' THEN (CST.CUST_CD_L + CST.CUST_CD_M + CST.CUST_CD_S)                  " & vbNewLine _
                                     & "                         WHEN MCD_CUST.CUST_CLASS='03' THEN (CST.CUST_CD_L + CST.CUST_CD_M + CST.CUST_CD_S + CST.CUST_CD_SS) " & vbNewLine _
                                     & "                    END                                                                         " & vbNewLine _
                                     & "                   ) = MCD_CUST.CUST_CD                                                         " & vbNewLine _
                                     & " --要望番号1383 [LMC664] --- END ---                                                            " & vbNewLine

    ''' <summary>
    ''' 纏め送り状 データ抽出WHERE句
    ''' </summary>
    ''' <remarks>@纏め送り状対応</remarks>
    Private Const SQL_WHERE_MATOME_707 As String = "    WHERE OUTL.SYS_DEL_FLG     = '0'                                                                " & vbNewLine _
                                                & "   AND OUTL.NRS_BR_CD       = @NRS_BR_CD                                                         " & vbNewLine _
                                                & "   AND OUTL.CUST_CD_L       = @CUST_CD_L                                                         " & vbNewLine _
                                                & "   AND OUTL.CUST_CD_M       = @CUST_CD_M                                                         " & vbNewLine _
                                                & "   AND OUTL.OUTKA_PLAN_DATE = @OUTKA_PLAN_DATE                                                   " & vbNewLine _
                                                & "   AND OUTL.ARR_PLAN_DATE   = @ARR_PLAN_DATE                                                     " & vbNewLine _
                                                & "   AND FL.UNSO_CD           = @UNSO_CD                                                           " & vbNewLine _
                                                & "   AND FL.UNSO_BR_CD        = @UNSO_BR_CD                                                        " & vbNewLine _
                                                & "   AND OUTL.DEST_CD         = @DEST_CD                                                           " & vbNewLine

    ''' <summary>
    ''' ORDER BY
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_ORDER_BY_MATOME_707 As String = "ORDER BY                                                                                                " & vbNewLine _
                                         & "     OUTL.NRS_BR_CD                                                                                     " & vbNewLine _
                                         & "    ,OUTL.OUTKA_NO_L                                                                                    " & vbNewLine _
                                         & "    ,OUTM.PRINT_SORT                                                                                    " & vbNewLine _
                                         & "    ,OUTM.OUTKA_NO_M                                                                                    " & vbNewLine



#End Region
    '2012.12.26 大阪用(出荷) ━━━━━━ END ━━━━━━

#End Region

#Region "纏め送り状"

    ''' <summary>
    ''' 纏め送り状 条件抽出SELECT句
    ''' </summary>
    ''' <remarks>@(2012.06.05)纏め送り状対応</remarks>
    Private Const SQL_SELECT_MATOME_IN As String = " SELECT                                                                                         " & vbNewLine _
                                                 & "        OUTL.NRS_BR_CD       AS NRS_BR_CD                                                       " & vbNewLine _
                                                 & "      , OUTL.CUST_CD_L       AS CUST_CD_L                                                       " & vbNewLine _
                                                 & "      , OUTL.CUST_CD_M       AS CUST_CD_M                                                       " & vbNewLine _
                                                 & "      , OUTL.OUTKA_PLAN_DATE AS OUTKA_PLAN_DATE                                                 " & vbNewLine _
                                                 & "      , OUTL.ARR_PLAN_DATE   AS ARR_PLAN_DATE                                                   " & vbNewLine _
                                                 & "      , UNSOL.UNSO_CD        AS UNSO_CD                                                         " & vbNewLine _
                                                 & "      , UNSOL.UNSO_BR_CD     AS UNSO_BR_CD                                                      " & vbNewLine _
                                                 & "      , OUTL.DEST_CD         AS DEST_CD                                                         " & vbNewLine

    ''' <summary>
    ''' 纏め送り状 条件出FROM句
    ''' </summary>
    ''' <remarks>@(2012.06.05)纏め送り状対応</remarks>
    Private Const SQL_FROM_MATOME_IN As String = "  FROM $LM_TRN$..C_OUTKA_L OUTL                                                                   " & vbNewLine _
                                               & "       LEFT JOIN $LM_TRN$..F_UNSO_L UNSOL                                                         " & vbNewLine _
                                               & "              ON OUTL.NRS_BR_CD  = UNSOL.NRS_BR_CD                                                " & vbNewLine _
                                               & "             AND OUTL.OUTKA_NO_L = UNSOL.INOUTKA_NO_L                                             " & vbNewLine _
                                               & "             AND UNSOL.MOTO_DATA_KB = '20'                                                        " & vbNewLine _
                                               & " WHERE OUTL.SYS_DEL_FLG = '0'                                                                     " & vbNewLine _
                                               & "   AND OUTL.OUTKA_NO_L  = @OUTKA_NO_L                                                             " & vbNewLine




    ''' <summary>
    ''' 纏め送り状 データ抽出SELECT句
    ''' </summary>
    ''' <remarks>@(2012.06.05)纏め送り状対応</remarks>
    Private Const SQL_SELECT_MATOME_OUT2 As String = " SELECT                                                                                       " & vbNewLine _
                                                  & "        BASE.NRS_BR_CD         AS NRS_BR_CD                                                    " & vbNewLine _
                                                  & "      , MIN(BASE.OUTKA_NO_L)   AS OUTKA_NO_L     --2018/08/07    依頼番号 : 001572                                  " & vbNewLine _
                                                  & "      , BASE.CUST_CD_L         AS CUST_CD_L                                                    " & vbNewLine _
                                                  & "      , BASE.CUST_CD_M         AS CUST_CD_M                                                    " & vbNewLine _
                                                  & "      , BASE.OUTKA_PLAN_DATE   AS OUTKA_PLAN_DATE                                              " & vbNewLine _
                                                  & "      , BASE.ARR_PLAN_DATE     AS ARR_PLAN_DATE                                                " & vbNewLine _
                                                  & "      , BASE.DEST_CD           AS DEST_CD                                                      " & vbNewLine _
                                                  & "      , BASE.UNSO_CD           AS UNSO_CD                                                      " & vbNewLine _
                                                  & "      , BASE.UNSO_BR_CD        AS UNSO_BR_CD                                                   " & vbNewLine _
                                                  & "      , SUM(BASE.OUTKA_PKG_NB) AS OUTKA_PKG_NB                                                 " & vbNewLine _
                                                  & "      , SUM(BASE.BETU_WT)      AS BETU_WT                                                      " & vbNewLine _
                                                  & "      , SUM(BASE.UNSO_WT)      AS UNSO_WT                                                      " & vbNewLine _
                                                  & "      , SUM(BASE.UNSO_PKG_NB)  AS UNSO_PKG_NB                                                  " & vbNewLine _
                                                  & "  FROM (                                                                                       " & vbNewLine

    ''' <summary>
    ''' 纏め送り状 データ抽出SELECT句
    ''' </summary>
    ''' <remarks>@(2012.06.05)纏め送り状対応</remarks>
    Private Const SQL_SELECT_MATOME_OUT As String = " SELECT                                                                                        " & vbNewLine _
                                                  & "        OUTL.NRS_BR_CD         AS NRS_BR_CD                                                    " & vbNewLine _
                                                  & "      , OUTL.CUST_CD_L         AS CUST_CD_L                                                    " & vbNewLine _
                                                  & "      , OUTL.CUST_CD_M         AS CUST_CD_M                                                    " & vbNewLine _
                                                  & "      , OUTL.OUTKA_PLAN_DATE   AS OUTKA_PLAN_DATE                                              " & vbNewLine _
                                                  & "      , OUTL.ARR_PLAN_DATE     AS ARR_PLAN_DATE                                                " & vbNewLine _
                                                  & "      , OUTL.DEST_CD           AS DEST_CD                                                      " & vbNewLine _
                                                  & "      , FL.UNSO_CD             AS UNSO_CD                                                      " & vbNewLine _
                                                  & "      , FL.UNSO_BR_CD          AS UNSO_BR_CD                                                   " & vbNewLine _
                                                  & "      , OUTL.OUTKA_NO_L        AS OUTKA_NO_L                                                   " & vbNewLine _
                                                  & "      , OUTL.OUTKA_PKG_NB      AS OUTKA_PKG_NB                                                 " & vbNewLine _
                                                  & "      , FL.UNSO_WT             AS BETU_WT                                                      " & vbNewLine _
                                                  & "--      , SUM(OUTS.BETU_WT * OUTS.ALCTD_NB)  AS UNSO_WT                                        " & vbNewLine _
                                                  & "      , SUM(OUTS.ALCTD_QT * MG.STD_WT_KGS / MG.STD_IRIME_NB)  AS UNSO_WT                       " & vbNewLine _
                                                  & "      , FL.UNSO_PKG_NB         AS UNSO_PKG_NB                                                  " & vbNewLine

    ''' <summary>
    ''' 纏め送り状 データ抽出FROM句
    ''' </summary>
    ''' <remarks>@(2012.06.05)纏め送り状対応</remarks>
    Private Const SQL_FROM_MATOME_OUT As String = "  FROM $LM_TRN$..C_OUTKA_L OUTL                                                                  " & vbNewLine _
                                                & "       --F運送L                                                                                  " & vbNewLine _
                                                & "       LEFT JOIN $LM_TRN$..F_UNSO_L FL                                                           " & vbNewLine _
                                                & "              ON FL.MOTO_DATA_KB = '20'                                                          " & vbNewLine _
                                                & "             AND FL.NRS_BR_CD    = OUTL.NRS_BR_CD                                                " & vbNewLine _
                                                & "             AND FL.INOUTKA_NO_L = OUTL.OUTKA_NO_L                                               " & vbNewLine _
                                                & "             AND FL.SYS_DEL_FLG  = '0'                                                           " & vbNewLine _
                                                & "   LEFT JOIN $LM_TRN$..C_OUTKA_M OUTM                                                            " & vbNewLine _
                                                & "          ON OUTL.NRS_BR_CD  = OUTM.NRS_BR_CD                                                    " & vbNewLine _
                                                & "         AND OUTL.OUTKA_NO_L = OUTM.OUTKA_NO_L                                                   " & vbNewLine _
                                                & "         AND OUTM.SYS_DEL_FLG  = '0'                                                             " & vbNewLine _
                                                & "   LEFT JOIN $LM_TRN$..C_OUTKA_S OUTS                                                            " & vbNewLine _
                                                & "          ON OUTM.NRS_BR_CD  = OUTS.NRS_BR_CD                                                    " & vbNewLine _
                                                & "         AND OUTM.OUTKA_NO_L = OUTS.OUTKA_NO_L                                                   " & vbNewLine _
                                                & "         AND OUTM.OUTKA_NO_M = OUTS.OUTKA_NO_M                                                   " & vbNewLine _
                                                & "         AND OUTS.SYS_DEL_FLG  = '0'                                                             " & vbNewLine _
                                                & "	  LEFT JOIN $LM_MST$..M_GOODS MG                                                                " & vbNewLine _
                                                & "	         ON OUTM.NRS_BR_CD     = MG.NRS_BR_CD                                                   " & vbNewLine _
                                                & "	        AND OUTM.GOODS_CD_NRS  = MG.GOODS_CD_NRS                                                " & vbNewLine _
                                                & " WHERE OUTL.SYS_DEL_FLG     = '0'                                                                " & vbNewLine _
                                                & "   AND OUTL.NRS_BR_CD       = @NRS_BR_CD                                                         " & vbNewLine _
                                                & "   AND OUTL.CUST_CD_L       = @CUST_CD_L                                                         " & vbNewLine _
                                                & "   AND OUTL.CUST_CD_M       = @CUST_CD_M                                                         " & vbNewLine _
                                                & "   AND OUTL.OUTKA_PLAN_DATE = @OUTKA_PLAN_DATE                                                   " & vbNewLine _
                                                & "   AND OUTL.ARR_PLAN_DATE   = @ARR_PLAN_DATE                                                     " & vbNewLine _
                                                & "   AND FL.UNSO_CD           = @UNSO_CD                                                           " & vbNewLine _
                                                & "   AND FL.UNSO_BR_CD        = @UNSO_BR_CD                                                        " & vbNewLine _
                                                & "   AND OUTL.DEST_CD         = @DEST_CD                                                           " & vbNewLine

    ''' <summary>
    ''' 纏め送り状 データ抽出GROUP BY句
    ''' </summary>
    ''' <remarks>@(2012.06.05)纏め送り状対応</remarks>
    Private Const SQL_GROUP_BY_MATOME_OUT As String = " GROUP BY                                                                                    " & vbNewLine _
                                                    & "       OUTL.NRS_BR_CD                                                                        " & vbNewLine _
                                                    & "     , OUTL.CUST_CD_L                                                                        " & vbNewLine _
                                                    & "     , OUTL.CUST_CD_M                                                                        " & vbNewLine _
                                                    & "     , OUTL.OUTKA_PLAN_DATE                                                                  " & vbNewLine _
                                                    & "     , OUTL.ARR_PLAN_DATE                                                                    " & vbNewLine _
                                                    & "     , OUTL.DEST_CD                                                                          " & vbNewLine _
                                                    & "     , FL.UNSO_CD                                                                            " & vbNewLine _
                                                    & "     , FL.UNSO_BR_CD                                                                         " & vbNewLine _
                                                    & "     , OUTL.OUTKA_NO_L                                                                       " & vbNewLine _
                                                    & "     , OUTL.OUTKA_PKG_NB                                                                     " & vbNewLine _
                                                    & "     , FL.UNSO_WT                                                                            " & vbNewLine _
                                                    & "     , FL.UNSO_PKG_NB                                                                        " & vbNewLine

    Private Const SQL_GROUP_BY_MATOME_OUT2 As String = ") BASE                                                                                      " & vbNewLine _
                                                & "   GROUP BY                                                                                      " & vbNewLine _
                                                & "       BASE.NRS_BR_CD                                                                            " & vbNewLine _
                                                & "     , BASE.CUST_CD_L                                                                            " & vbNewLine _
                                                & "     , BASE.CUST_CD_M                                                                            " & vbNewLine _
                                                & "     , BASE.OUTKA_PLAN_DATE                                                                      " & vbNewLine _
                                                & "     , BASE.ARR_PLAN_DATE                                                                        " & vbNewLine _
                                                & "     , BASE.DEST_CD                                                                              " & vbNewLine _
                                                & "     , BASE.UNSO_CD                                                                              " & vbNewLine _
                                                & "     , BASE.UNSO_BR_CD                                                                           " & vbNewLine

    ''' <summary>
    ''' 纏め送り状 オーダー番号 データ抽出SELECT句
    ''' </summary>
    ''' <remarks>@(2012.06.05)纏め送り状 オーダー番号対応</remarks>
    Private Const SQL_SELECT_MATOME_ORDER2 As String = " SELECT                                                                                       " & vbNewLine _
                                                  & "        BASE.NRS_BR_CD         AS NRS_BR_CD                                                    " & vbNewLine _
                                                  & "      , BASE.CUST_CD_L         AS CUST_CD_L                                                    " & vbNewLine _
                                                  & "      , BASE.CUST_CD_M         AS CUST_CD_M                                                    " & vbNewLine _
                                                  & "      , BASE.OUTKA_PLAN_DATE   AS OUTKA_PLAN_DATE                                              " & vbNewLine _
                                                  & "      , BASE.ARR_PLAN_DATE     AS ARR_PLAN_DATE                                                " & vbNewLine _
                                                  & "      , BASE.DEST_CD           AS DEST_CD                                                      " & vbNewLine _
                                                  & "      , BASE.UNSO_CD           AS UNSO_CD                                                      " & vbNewLine _
                                                  & "      , BASE.UNSO_BR_CD        AS UNSO_BR_CD                                                   " & vbNewLine _
                                                  & "      , BASE.CUST_ORD_NO        AS CUST_ORD_NO                                                   " & vbNewLine _
                                                  & "      , BASE.OUTKA_NO_L        AS OUTKA_NO_L   --ADD 2018/09/25     依頼番号 : 002487                 " & vbNewLine _
                                                  & "  FROM (                                                                                       " & vbNewLine

    ''' <summary>
    ''' 纏め送り状 オーダー番号 データ抽出SELECT句
    ''' </summary>
    ''' <remarks>@(2012.06.05)纏め送り状 オーダー番号対応</remarks>
    Private Const SQL_SELECT_MATOME_ORDER As String = " SELECT                                                                                        " & vbNewLine _
                                                  & "        OUTL.NRS_BR_CD         AS NRS_BR_CD                                                    " & vbNewLine _
                                                  & "      , OUTL.CUST_CD_L         AS CUST_CD_L                                                    " & vbNewLine _
                                                  & "      , OUTL.CUST_CD_M         AS CUST_CD_M                                                    " & vbNewLine _
                                                  & "      , OUTL.OUTKA_PLAN_DATE   AS OUTKA_PLAN_DATE                                              " & vbNewLine _
                                                  & "      , OUTL.ARR_PLAN_DATE     AS ARR_PLAN_DATE                                                " & vbNewLine _
                                                  & "      , OUTL.DEST_CD           AS DEST_CD                                                      " & vbNewLine _
                                                  & "      , OUTL.CUST_ORD_NO       AS CUST_ORD_NO                                                  " & vbNewLine _
                                                  & "      , FL.UNSO_CD             AS UNSO_CD                                                      " & vbNewLine _
                                                  & "      , FL.UNSO_BR_CD          AS UNSO_BR_CD                                                   " & vbNewLine _
                                                  & "      , OUTL.OUTKA_NO_L        AS OUTKA_NO_L                                                   " & vbNewLine _
                                                  & "      , OUTL.OUTKA_PKG_NB      AS OUTKA_PKG_NB                                                 " & vbNewLine _
                                                  & "      , FL.UNSO_WT             AS BETU_WT                                                      " & vbNewLine _
                                                  & "--      , SUM(OUTS.BETU_WT * OUTS.ALCTD_NB)  AS UNSO_WT                                        " & vbNewLine _
                                                  & "--del  2018/09/25     依頼番号 : 002487       , SUM(OUTS.ALCTD_QT * MG.STD_WT_KGS / MG.STD_IRIME_NB)  AS UNSO_WT                       " & vbNewLine _
                                                  & "--del  2018/09/25     依頼番号 : 002487       , FL.UNSO_PKG_NB         AS UNSO_PKG_NB                                                  " & vbNewLine

    ''' <summary>
    ''' 纏め送り状 オーダー番号 データ抽出FROM句
    ''' </summary>
    ''' <remarks>@(2012.06.05)纏め送り状 オーダー番号対応</remarks>
    Private Const SQL_FROM_MATOME_ORDER As String = "  FROM $LM_TRN$..C_OUTKA_L OUTL                                                                  " & vbNewLine _
                                                & "       --F運送L                                                                                  " & vbNewLine _
                                                & "       LEFT JOIN $LM_TRN$..F_UNSO_L FL                                                           " & vbNewLine _
                                                & "              ON FL.MOTO_DATA_KB = '20'                                                          " & vbNewLine _
                                                & "             AND FL.NRS_BR_CD    = OUTL.NRS_BR_CD                                                " & vbNewLine _
                                                & "             AND FL.INOUTKA_NO_L = OUTL.OUTKA_NO_L                                               " & vbNewLine _
                                                & "             AND FL.SYS_DEL_FLG  = '0'                                                           " & vbNewLine _
                                                & "   LEFT JOIN $LM_TRN$..C_OUTKA_M OUTM                                                            " & vbNewLine _
                                                & "          ON OUTL.NRS_BR_CD  = OUTM.NRS_BR_CD                                                    " & vbNewLine _
                                                & "         AND OUTL.OUTKA_NO_L = OUTM.OUTKA_NO_L                                                   " & vbNewLine _
                                                & "         AND OUTM.SYS_DEL_FLG  = '0'                                                             " & vbNewLine _
                                                & "   LEFT JOIN $LM_TRN$..C_OUTKA_S OUTS                                                            " & vbNewLine _
                                                & "          ON OUTM.NRS_BR_CD  = OUTS.NRS_BR_CD                                                    " & vbNewLine _
                                                & "         AND OUTM.OUTKA_NO_L = OUTS.OUTKA_NO_L                                                   " & vbNewLine _
                                                & "         AND OUTM.OUTKA_NO_M = OUTS.OUTKA_NO_M                                                   " & vbNewLine _
                                                & "         AND OUTS.SYS_DEL_FLG  = '0'                                                             " & vbNewLine _
                                                & "	  LEFT JOIN $LM_MST$..M_GOODS MG                                                                " & vbNewLine _
                                                & "	         ON OUTM.NRS_BR_CD     = MG.NRS_BR_CD                                                   " & vbNewLine _
                                                & "	        AND OUTM.GOODS_CD_NRS  = MG.GOODS_CD_NRS                                                " & vbNewLine _
                                                & " WHERE OUTL.SYS_DEL_FLG     = '0'                                                                " & vbNewLine _
                                                & "   AND OUTL.NRS_BR_CD       = @NRS_BR_CD                                                         " & vbNewLine _
                                                & "   AND OUTL.CUST_CD_L       = @CUST_CD_L                                                         " & vbNewLine _
                                                & "   AND OUTL.CUST_CD_M       = @CUST_CD_M                                                         " & vbNewLine _
                                                & "   AND OUTL.OUTKA_PLAN_DATE = @OUTKA_PLAN_DATE                                                   " & vbNewLine _
                                                & "   AND OUTL.ARR_PLAN_DATE   = @ARR_PLAN_DATE                                                     " & vbNewLine _
                                                & "   AND FL.UNSO_CD           = @UNSO_CD                                                           " & vbNewLine _
                                                & "   AND FL.UNSO_BR_CD        = @UNSO_BR_CD                                                        " & vbNewLine _
                                                & "   AND OUTL.DEST_CD         = @DEST_CD                                                           " & vbNewLine

    ''' <summary>
    ''' 纏め送り状 オーダー番号 データ抽出GROUP BY句
    ''' </summary>
    ''' <remarks>@(2012.06.05)纏め送り状 オーダー番号対応</remarks>
    Private Const SQL_GROUP_BY_MATOME_ORDER As String = " GROUP BY                                                                                    " & vbNewLine _
                                                    & "       OUTL.NRS_BR_CD                                                                        " & vbNewLine _
                                                    & "     , OUTL.CUST_CD_L                                                                        " & vbNewLine _
                                                    & "     , OUTL.CUST_CD_M                                                                        " & vbNewLine _
                                                    & "     , OUTL.OUTKA_PLAN_DATE                                                                  " & vbNewLine _
                                                    & "     , OUTL.ARR_PLAN_DATE                                                                    " & vbNewLine _
                                                    & "     , OUTL.DEST_CD                                                                          " & vbNewLine _
                                                    & "     , OUTL.CUST_ORD_NO                                                                          " & vbNewLine _
                                                    & "     , FL.UNSO_CD                                                                            " & vbNewLine _
                                                    & "     , FL.UNSO_BR_CD                                                                         " & vbNewLine _
                                                    & "     , OUTL.OUTKA_NO_L                                                                       " & vbNewLine _
                                                    & "     , OUTL.OUTKA_PKG_NB                                                                     " & vbNewLine _
                                                    & "     , FL.UNSO_WT                                                                            " & vbNewLine _
                                                    & "     , FL.UNSO_PKG_NB                                                                        " & vbNewLine

    Private Const SQL_GROUP_BY_MATOME_ORDER2 As String = ") BASE                                                                                      " & vbNewLine _
                                                & "   GROUP BY                                                                                      " & vbNewLine _
                                                & "       BASE.NRS_BR_CD                                                                            " & vbNewLine _
                                                & "     , BASE.CUST_CD_L                                                                            " & vbNewLine _
                                                & "     , BASE.CUST_CD_M                                                                            " & vbNewLine _
                                                & "     , BASE.CUST_ORD_NO                                                                          " & vbNewLine _
                                                & "     , BASE.OUTKA_PLAN_DATE                                                                      " & vbNewLine _
                                                & "     , BASE.ARR_PLAN_DATE                                                                        " & vbNewLine _
                                                & "     , BASE.DEST_CD                                                                              " & vbNewLine _
                                                & "     , BASE.UNSO_CD                                                                              " & vbNewLine _
                                                & "     , BASE.UNSO_BR_CD                                                                           " & vbNewLine

    ''' <summary>
    ''' 纏め送り状 データ抽出WHERE句
    ''' </summary>
    ''' <remarks>@(2012.06.15)纏め送り状対応</remarks>
    Private Const SQL_WHERE_MATOME As String = "    WHERE OUTL.SYS_DEL_FLG     = '0'                                                                " & vbNewLine _
                                                & "   AND OUTL.NRS_BR_CD       = @NRS_BR_CD                                                         " & vbNewLine _
                                                & "   AND OUTL.CUST_CD_L       = @CUST_CD_L                                                         " & vbNewLine _
                                                & "   AND OUTL.CUST_CD_M       = @CUST_CD_M                                                         " & vbNewLine _
                                                & "   AND OUTL.OUTKA_PLAN_DATE = @OUTKA_PLAN_DATE                                                   " & vbNewLine _
                                                & "   AND OUTL.ARR_PLAN_DATE   = @ARR_PLAN_DATE                                                     " & vbNewLine _
                                                & "   AND FL.UNSO_CD           = @UNSO_CD                                                           " & vbNewLine _
                                                & "   AND FL.UNSO_BR_CD        = @UNSO_BR_CD                                                        " & vbNewLine _
                                                & "   AND OUTL.DEST_CD         = @DEST_CD                                                           " & vbNewLine

    ''' <summary>
    ''' データ抽出用(MAIN)
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_SELECT_DATA_MATOME As String = " --SQL_SELECT_DATA_MATOME                                                                                        " & vbNewLine _
                                                   & "SELECT TOP 1                                                                                        " & vbNewLine _
                                                   & " RPT_ID                                                                                        " & vbNewLine _
                                                   & ",NRS_BR_CD                                                                                     " & vbNewLine _
                                                   & ",OUTKA_PLAN_DATE                                                                               " & vbNewLine _
                                                   & ",MIN(OUTKA_NO_L) AS OUTKA_NO_L                                                                 " & vbNewLine _
                                                   & ",SHITEN_TEL_560_1                                                                              " & vbNewLine _
                                                   & ",SHITEN_NM_560_1                                                                               " & vbNewLine _
                                                   & ",ARR_PLAN_DATE                                                                                 " & vbNewLine _
                                                   & ",ARR_PLAN_TIME                                                                                 " & vbNewLine _
                                                   & ",DEST_TEL                                                                                      " & vbNewLine _
                                                   & ",CUST_TEL                                                                                      " & vbNewLine _
                                                   & ",CUST_AD_1                                                                                     " & vbNewLine _
                                                   & ",CUST_AD_2                                                                                     " & vbNewLine _
                                                   & ",DEST_AD_1                                                                                     " & vbNewLine _
                                                   & ",CUST_AD_3                                                                                     " & vbNewLine _
                                                   & ",DEST_AD_2                                                                                     " & vbNewLine _
                                                   & ",DEST_AD_3                                                                                     " & vbNewLine _
                                                   & ",BETU_WT                                                                                       " & vbNewLine _
                                                   & ",DEST_NM_1                                                                                     " & vbNewLine _
                                                   & ",CUST_NM_L                                                                                     " & vbNewLine _
                                                   & ",DEST_ZIP                                                                                      " & vbNewLine _
                                                   & ",UNSO_WT                                                                                       " & vbNewLine _
                                                   & ",UNSO_PKG_NB                                                                                   " & vbNewLine _
                                                   & ",CUST_NM_M                                                                                     " & vbNewLine _
                                                   & ",NRS_BR_NM                                                                                     " & vbNewLine _
                                                   & ",MIN(DEST_HOSOKU) AS DEST_HOSOKU                                                               " & vbNewLine _
                                                   & ",NRS_AD_1                                                                                      " & vbNewLine _
                                                   & ",NRS_AD_2                                                                                      " & vbNewLine _
                                                   & ",NRS_TEL                                                                                       " & vbNewLine _
                                                   & ",CUST_CD_L                                                                                     " & vbNewLine _
                                                   & ",MIN(UNSO_L_REMARK) AS UNSO_L_REMARK                                                           " & vbNewLine _
                                                   & ",MIN(OUTKA_L_REMARK) AS OUTKA_L_REMARK                                                         " & vbNewLine _
                                                   & ",MIN(GOODS_NM_1) AS GOODS_NM_1                                                                 " & vbNewLine _
                                                   & ",OUTKA_ATT                                                                                     " & vbNewLine _
                                                   & ",BUYER_ORD_NO                                                                                  " & vbNewLine _
                                                   & ",YELLOW_NO                                                                                     " & vbNewLine _
                                                   & ",SHIHARAI_SHITEN_NM_563_1                                                                      " & vbNewLine _
                                                   & ",SHIHARAI_SHITEN_CD_563_1                                                                      " & vbNewLine _
                                                   & ",SHIHARAI_SHITEN_TEL_563_1                                                                     " & vbNewLine _
                                                   & ",SHITEN_TEL_1_564_1                                                                            " & vbNewLine _
                                                   & ",SHITEN_NM_564_1                                                                               " & vbNewLine _
                                                   & ",SHITEN_TEL_2_564_1                                                                            " & vbNewLine _
                                                   & ",NRS_BR_AD_1                                                                                   " & vbNewLine _
                                                   & ",NRS_BR_AD_2                                                                                   " & vbNewLine _
                                                   & ",NRS_BR_NM_1                                                                                   " & vbNewLine _
                                                   & ",DEST_NM                                                                                       " & vbNewLine _
                                                   & ",AD_1                                                                                          " & vbNewLine _
                                                   & ",AD_2                                                                                          " & vbNewLine _
                                                   & ",AD_3                                                                                          " & vbNewLine _
                                                   & ",TEL                                                                                           " & vbNewLine _
                                                   & ",DEST_CD                                                                                       " & vbNewLine _
                                                   & ",SHIP_CD_L                                                                                     " & vbNewLine _
                                                   & ",SHIHARAI_CD_565_1                                                                             " & vbNewLine _
                                                   & ",SHIHARAI_CD_565_2                                                                             " & vbNewLine _
                                                   & ",NRS_FAX                                                                                       " & vbNewLine _
                                                   & ",NRS_AD_3                                                                                      " & vbNewLine _
                                                   & ",MIN(CUST_ORD_NO) AS CUST_ORD_NO                                                               " & vbNewLine _
                                                   & ",SHOBO_CD                                                                                      " & vbNewLine _
                                                   & ",CUST_CD_L_568_1                                                                               " & vbNewLine _
                                                   & ",CUST_CD_L_568_2                                                                               " & vbNewLine _
                                                   & ",NRS_BR_ZIP                                                                                    " & vbNewLine _
                                                   & ",NRS_BR_TEL                                                                                    " & vbNewLine _
                                                   & ",KOTEI_1                                                                                       " & vbNewLine _
                                                   & ",KOTEI_2                                                                                       " & vbNewLine _
                                                   & ",KOTEI_3                                                                                       " & vbNewLine _
                                                   & ",NB_UT                                                                                         " & vbNewLine _
                                                   & ",DENPYO_NM                                                                                     " & vbNewLine _
                                                   & ",SHITEN_NM_570_1                                                                               " & vbNewLine _
                                                   & ",SHITEN_TEL_570_1                                                                              " & vbNewLine _
                                                   & ",SHITEN_NM_570_2                                                                               " & vbNewLine _
                                                   & ",SHITEN_TEL_570_2                                                                              " & vbNewLine _
                                                   & ",OUTKA_PKG_NB                                                                                  " & vbNewLine _
                                                   & ",IRIME                                                                                         " & vbNewLine _
                                                   & ",IRIME_UT                                                                                      " & vbNewLine _
                                                   & ",ALCTD_NB                                                                                      " & vbNewLine _
                                                   & ",MIN(LOT_NO) AS LOT_NO                                                                         " & vbNewLine _
                                                   & ",SHIP_NM_L                                                                                     " & vbNewLine _
                                                   & ",UNSO_CUST_CD                                                                                  " & vbNewLine _
                                                   & ",SHIHARAI_CD_575_1                                                                             " & vbNewLine _
                                                   & ",SHIHARAI_CD_575_2                                                                             " & vbNewLine _
                                                   & ",KBN_CUST_ZIP                                                                                  " & vbNewLine _
                                                   & ",KBN_CUST_AD                                                                                   " & vbNewLine _
                                                   & ",KBN_CUST_TEL                                                                                  " & vbNewLine _
                                                   & ",KBN_CUST_NM                                                                                   " & vbNewLine _
                                                   & ",OUTKO_DATE                                                                                    " & vbNewLine _
                                                   & ",ALCTD_WT                                                                                      " & vbNewLine _
                                                   & ",BUKA_CD                                                                                       " & vbNewLine _
                                                   & ",ATSUKAISYA_NM                                                                                 " & vbNewLine _
                                                   & ",MIN(GOODS_CD_CUST) AS GOODS_CD_CUST                                                           " & vbNewLine _
                                                   & ",PREF_CD                                                                                       " & vbNewLine _
                                                   & ",TORI_UNSOCO_NM                                                                                " & vbNewLine _
                                                   & ",SAI_SHIHARAI_CD                                                                               " & vbNewLine _
                                                   & ",SET_NM_L                                                                                      " & vbNewLine _
                                                   & ",NAIYO1                                                                                        " & vbNewLine _
                                                   & ",NAIYO2                                                                                        " & vbNewLine _
                                                   & ",NAIYO3                                                                                        " & vbNewLine _
                                                   & ",NAIYO_CUST_NM                                                                                 " & vbNewLine _
                                                   & ",MIN(CUST_ORD_NO_DTL) AS CUST_ORD_NO_DTL                                                       " & vbNewLine _
                                                   & ",REMARK_DEST   --2012.07.24 丸和運輸　荷受人氏名下の注意書き                                   " & vbNewLine _
                                                   & "--要望番号1383 [LMC664] --- START ---                                                          " & vbNewLine _
                                                   & ",CUST_FLG                                                                                      " & vbNewLine _
                                                   & "--要望番号1383 [LMC664] --- END ---                                                            " & vbNewLine _
                                                   & ",AUTO_DENP_NO     -- ADD 2016/08/29 要望番号:2615                                                                                      " & vbNewLine _
                                                   & " FROM (                                                                                        " & vbNewLine

#If True Then   'ADD 2018/08/02 依頼番号 : 001572   【LMS】まとめ送状_千葉日医工-出力値変更
    '下記SQL_FROM_MATOMEを改修

    Private Const SQL_FROM_MATOME_NICHIIKO As String = "-- SQL_FROM_MATOME_NICHIIKO                                                             " & vbNewLine _
                                 & "FROM                                                                                                        " & vbNewLine _
                                 & "$LM_TRN$..C_OUTKA_L OUTL                                                                                    " & vbNewLine _
                                 & " LEFT JOIN (                                                                                                " & vbNewLine _
                                 & "            SELECT                                                                                          " & vbNewLine _
                                 & "                   EDIOUTL.NRS_BR_CD         AS NRS_BR_CD                                                   " & vbNewLine _
                                 & "                 , MIN(EDIOUTL.EDI_CTL_NO)   AS EDI_CTL_NO                                                  " & vbNewLine _
                                 & "                 , EDIOUTL.OUTKA_CTL_NO      AS OUTKA_CTL_NO                                                " & vbNewLine _
                                 & "              FROM $LM_TRN$..H_OUTKAEDI_L EDIOUTL                                                           " & vbNewLine _
                                 & "             WHERE EDIOUTL.SYS_DEL_FLG  = '0'                                                               " & vbNewLine _
                                 & "               AND EDIOUTL.NRS_BR_CD    = @NRS_BR_CD                                                        " & vbNewLine _
                                 & "               AND EDIOUTL.DEL_KB       = '0'                                                               " & vbNewLine _
                                 & "               AND LEN(EDIOUTL.OUTKA_CTL_NO) > 0                                                            " & vbNewLine _
                                 & "             GROUP BY                                                                                       " & vbNewLine _
                                 & "                   EDIOUTL.NRS_BR_CD                                                                        " & vbNewLine _
                                 & "                 , EDIOUTL.OUTKA_CTL_NO                                                                     " & vbNewLine _
                                 & "            ) TOPEDI                                                                                        " & vbNewLine _
                                 & "        ON TOPEDI.NRS_BR_CD    = OUTL.NRS_BR_CD                                                             " & vbNewLine _
                                 & "       AND TOPEDI.OUTKA_CTL_NO = OUTL.OUTKA_NO_L                                                            " & vbNewLine _
                                 & " LEFT JOIN $LM_TRN$..H_OUTKAEDI_L EDIL                                                                      " & vbNewLine _
                                 & "        ON EDIL.NRS_BR_CD  = TOPEDI.NRS_BR_CD                                                               " & vbNewLine _
                                 & "       AND EDIL.EDI_CTL_NO = TOPEDI.EDI_CTL_NO                                                              " & vbNewLine _
                                 & "--(2012.09.11)要望番号1412対応  ---  END  ---                                                               " & vbNewLine _
                                 & "--出荷M                                                                                                     " & vbNewLine _
                                 & "LEFT JOIN                                                                                                   " & vbNewLine _
                                 & "(SELECT                                                                                                     " & vbNewLine _
                                 & "*                                                                                                           " & vbNewLine _
                                 & "FROM                                                                                                        " & vbNewLine _
                                 & "(SELECT                                                                                                     " & vbNewLine _
                                 & "--(2012.06.18)要望番号1160対応 --- START ----                                                               " & vbNewLine _
                                 & "--   NRS_BR_CD                                                                                              " & vbNewLine _
                                 & "--  ,GOODS_CD_NRS                                                                                           " & vbNewLine _
                                 & "--  ,IRIME                                                                                                  " & vbNewLine _
                                 & "--  ,IRIME_UT                                                                                               " & vbNewLine _
                                 & "--  ,ALCTD_NB                                                                                               " & vbNewLine _
                                 & "--  ,LOT_NO                                                                                                 " & vbNewLine _
                                 & "--  ,CUST_ORD_NO_DTL   --2012/06/11浮間対応                                                                 " & vbNewLine _
                                 & "--  ,SYS_DEL_FLG                                                                                            " & vbNewLine _
                                 & "--  ,ROW_NUMBER() OVER (PARTITION BY NRS_BR_CD ORDER BY OUTKA_NO_L,OUTKA_NO_M) AS NUM                       " & vbNewLine _
                                 & "   M.NRS_BR_CD                                                                                              " & vbNewLine _
                                 & "  ,M.GOODS_CD_NRS                                                                                           " & vbNewLine _
                                 & "  ,M.IRIME                                                                                                  " & vbNewLine _
                                 & "  ,M.IRIME_UT                                                                                               " & vbNewLine _
                                 & "  ,M.ALCTD_NB                                                                                               " & vbNewLine _
                                 & "  ,M.ALCTD_QT                                                                                               " & vbNewLine _
                                 & "  ,M.LOT_NO                                                                                                 " & vbNewLine _
                                 & "  ,M.CUST_ORD_NO_DTL   --2012/06/11浮間対応                                                                 " & vbNewLine _
                                 & "  ,M.SYS_DEL_FLG                                                                                            " & vbNewLine _
                                 & "  ,ROW_NUMBER() OVER (PARTITION BY M.NRS_BR_CD ORDER BY M.OUTKA_NO_L,M.OUTKA_NO_M) AS NUM                   " & vbNewLine _
                                 & "  ,M.OUTKA_NO_L                                                                                             " & vbNewLine _
                                 & "  ,M.OUTKA_NO_M                                                                                             " & vbNewLine _
                                 & "  FROM                                                                                                      " & vbNewLine _
                                 & "--(2012.06.18)要望番号1160対応 ---  END  ----                                                               " & vbNewLine _
                                 & "   $LM_TRN$..C_OUTKA_M M                                                                                    " & vbNewLine _
                                 & "--(2012.06.18)要望番号1160対応 --- START ----                                                               " & vbNewLine _
                                 & "   LEFT JOIN $LM_TRN$..C_OUTKA_L OUTL                                                                       " & vbNewLine _
                                 & "          ON OUTL.NRS_BR_CD  = M.NRS_BR_CD                                                                  " & vbNewLine _
                                 & "         AND OUTL.OUTKA_NO_L = M.OUTKA_NO_L                                                                 " & vbNewLine _
                                 & "         AND OUTL.SYS_DEL_FLG  = '0'                                                                        " & vbNewLine _
                                 & "   LEFT JOIN $LM_TRN$..F_UNSO_L FL                                                                          " & vbNewLine _
                                 & "          ON FL.NRS_BR_CD    = M.NRS_BR_CD                                                                  " & vbNewLine _
                                 & "         AND FL.INOUTKA_NO_L = M.OUTKA_NO_L                                                                 " & vbNewLine _
                                 & "         AND FL.MOTO_DATA_KB = '20'                                                                         " & vbNewLine _
                                 & "         AND FL.SYS_DEL_FLG  = '0'                                                                          " & vbNewLine _
                                 & "--(2012.06.18)要望番号1160対応 ---  END  ----                                                               " & vbNewLine _
                                 & "  WHERE                                                                                                     " & vbNewLine _
                                 & "      M.NRS_BR_CD = @NRS_BR_CD                                                                              " & vbNewLine _
                                 & "--(2012.06.18)要望番号1160対応 --- START ----                                                               " & vbNewLine _
                                 & "    AND OUTL.CUST_CD_L       = @CUST_CD_L                                                                   " & vbNewLine _
                                 & "    AND OUTL.CUST_CD_M       = @CUST_CD_M                                                                   " & vbNewLine _
                                 & "    AND OUTL.OUTKA_PLAN_DATE = @OUTKA_PLAN_DATE                                                             " & vbNewLine _
                                 & "    AND OUTL.ARR_PLAN_DATE   = @ARR_PLAN_DATE                                                               " & vbNewLine _
                                 & "    AND FL.UNSO_CD           = @UNSO_CD                                                                     " & vbNewLine _
                                 & "    AND FL.UNSO_BR_CD        = @UNSO_BR_CD                                                                  " & vbNewLine _
                                 & "    AND OUTL.DEST_CD         = @DEST_CD                                                                     " & vbNewLine _
                                 & "--  AND M.OUTKA_NO_L IN(@OUTKA_NO_L)                                                                        " & vbNewLine _
                                 & "--  AND SYS_DEL_FLG = '0'                                                                                   " & vbNewLine _
                                 & "    AND M.SYS_DEL_FLG = '0'                                                                                 " & vbNewLine _
                                 & "--(2012.06.18)要望番号1160対応 ---  END  ----                                                               " & vbNewLine _
                                 & " ) AS BASE                                                                                                  " & vbNewLine _
                                 & "-- WHERE                                                                                                    " & vbNewLine _
                                 & "-- BASE.NUM = 1                                                                                             " & vbNewLine _
                                 & ") OUTM                                                                                                      " & vbNewLine _
                                 & "--ON                                                                                                        " & vbNewLine _
                                 & "--1 = 1                                                                                                     " & vbNewLine _
                                 & "--(2012.06.18)要望番号1160対応 --- START ----                                                               " & vbNewLine _
                                 & " ON OUTL.NRS_BR_CD  = OUTM.NRS_BR_CD                                                                        " & vbNewLine _
                                 & "AND OUTL.OUTKA_NO_L = OUTM.OUTKA_NO_L                                                                       " & vbNewLine _
                                 & "--(2012.06.18)要望番号1160対応 ---  END  ----                                                               " & vbNewLine _
                                 & "--F運送L                                                                                                    " & vbNewLine _
                                 & "LEFT JOIN $LM_TRN$..F_UNSO_L FL                                                                             " & vbNewLine _
                                 & "ON  FL.MOTO_DATA_KB   = '20'                                                                                " & vbNewLine _
                                 & "AND FL.NRS_BR_CD      = OUTL.NRS_BR_CD                                                                      " & vbNewLine _
                                 & "AND FL.INOUTKA_NO_L   = OUTL.OUTKA_NO_L                                                                     " & vbNewLine _
                                 & "AND FL.SYS_DEL_FLG    = '0'                                                                                 " & vbNewLine _
                                 & "--出荷EDI L                                                                                                 " & vbNewLine _
                                 & "--LEFT JOIN $LM_TRN$..H_OUTKAEDI_L OUTKAEDIL                                                                  " & vbNewLine _
                                 & "--ON  OUTKAEDIL.NRS_BR_CD     = OUTL.NRS_BR_CD                                                                " & vbNewLine _
                                 & "--AND OUTKAEDIL.OUTKA_CTL_NO  = OUTL.OUTKA_NO_L                                                               " & vbNewLine _
                                 & "--AND OUTKAEDIL.SYS_DEL_FLG   = '0'                                                                           " & vbNewLine _
                                 & "--商品M                                                                                                     " & vbNewLine _
                                 & "LEFT JOIN $LM_MST$..M_GOODS MG                                                                              " & vbNewLine _
                                 & "ON  MG.NRS_BR_CD     = OUTM.NRS_BR_CD                                                                       " & vbNewLine _
                                 & "AND MG.GOODS_CD_NRS  = OUTM.GOODS_CD_NRS                                                                    " & vbNewLine _
                                 & "AND MG.SYS_DEL_FLG   = '0'                                                                                  " & vbNewLine _
                                 & "--荷主なしでの運送会社荷主別送り状パターン取得                                                              " & vbNewLine _
                                 & "LEFT JOIN $LM_MST$..M_UNSO_CUST_RPT MCR1                                                                    " & vbNewLine _
                                 & "ON  FL.NRS_BR_CD     = MCR1.NRS_BR_CD                                                                       " & vbNewLine _
                                 & "AND FL.UNSO_CD       = MCR1.UNSOCO_CD                                                                       " & vbNewLine _
                                 & "AND FL.UNSO_BR_CD    = MCR1.UNSOCO_BR_CD                                                                    " & vbNewLine _
                                 & "AND '11'             = MCR1.PTN_ID                                                                          " & vbNewLine _
                                 & "AND FL.PC_KB         = MCR1.MOTO_TYAKU_KB                                                                   " & vbNewLine _
                                 & "AND ''               = MCR1.CUST_CD_L                                                                       " & vbNewLine _
                                 & "AND ''               = MCR1.CUST_CD_M                                                                       " & vbNewLine _
                                 & "AND MCR1.SYS_DEL_FLG = '0'                                                                                  " & vbNewLine _
                                 & "--出荷Lでの荷主帳票パターン取得           ------** ADD Start/End                                            " & vbNewLine _
                                 & "LEFT JOIN $LM_MST$..M_CUST_RPT MCR3                                                                         " & vbNewLine _
                                 & " ON OUTL.NRS_BR_CD = MCR3.NRS_BR_CD                                                                         " & vbNewLine _
                                 & " AND OUTL.CUST_CD_L = MCR3.CUST_CD_L                                                                        " & vbNewLine _
                                 & " AND OUTL.CUST_CD_M = MCR3.CUST_CD_M                                                                        " & vbNewLine _
                                 & " AND '00'           = MCR3.CUST_CD_S                                                                        " & vbNewLine _
                                 & " AND MCR3.PTN_ID = '11'                                                                                     " & vbNewLine _
                                 & "--帳票パターン取得                                                                                          " & vbNewLine _
                                 & "LEFT JOIN $LM_MST$..M_RPT MR1                                                                               " & vbNewLine _
                                 & "ON  MR1.NRS_BR_CD   = MCR1.NRS_BR_CD                                                                        " & vbNewLine _
                                 & "AND MR1.PTN_ID      = MCR1.PTN_ID                                                                           " & vbNewLine _
                                 & "AND MR1.PTN_CD      = MCR1.PTN_CD                                                                           " & vbNewLine _
                                 & "AND MR1.SYS_DEL_FLG = '0'                                                                                   " & vbNewLine _
                                 & "--荷主込みでの運送会社荷主別送り状パターン取得                                                              " & vbNewLine _
                                 & "LEFT JOIN $LM_MST$..M_UNSO_CUST_RPT MCR2                                                                    " & vbNewLine _
                                 & "ON  FL.NRS_BR_CD     = MCR2.NRS_BR_CD                                                                       " & vbNewLine _
                                 & "AND FL.UNSO_CD       = MCR2.UNSOCO_CD                                                                       " & vbNewLine _
                                 & "AND FL.UNSO_BR_CD    = MCR2.UNSOCO_BR_CD                                                                    " & vbNewLine _
                                 & "AND '11'             = MCR2.PTN_ID                                                                          " & vbNewLine _
                                 & "AND FL.PC_KB         = MCR2.MOTO_TYAKU_KB                                                                   " & vbNewLine _
                                 & "AND FL.CUST_CD_L     = MCR2.CUST_CD_L                                                                       " & vbNewLine _
                                 & "AND FL.CUST_CD_M     = MCR2.CUST_CD_M                                                                       " & vbNewLine _
                                 & "AND MCR2.SYS_DEL_FLG = '0'                                                                                  " & vbNewLine _
                                 & "--帳票パターン取得                                                                                          " & vbNewLine _
                                 & "LEFT JOIN $LM_MST$..M_RPT MR2                                                                               " & vbNewLine _
                                 & "ON  MR2.NRS_BR_CD    = MCR2.NRS_BR_CD                                                                       " & vbNewLine _
                                 & "AND MR2.PTN_ID       = MCR2.PTN_ID                                                                          " & vbNewLine _
                                 & "AND MR2.PTN_CD       = MCR2.PTN_CD                                                                          " & vbNewLine _
                                 & "AND MR2.SYS_DEL_FLG  = '0'                                                                                  " & vbNewLine _
                                 & "--存在しない場合の帳票パターン取得                                                                          " & vbNewLine _
                                 & "LEFT JOIN $LM_MST$..M_RPT MR3                                                                               " & vbNewLine _
                                 & "ON  MR3.NRS_BR_CD     = OUTL.NRS_BR_CD                                                                      " & vbNewLine _
                                 & "AND MR3.PTN_ID        = '11'                                                                                " & vbNewLine _
                                 & "AND MR3.STANDARD_FLAG = '01'                                                                                " & vbNewLine _
                                 & "AND MR3.SYS_DEL_FLG   = '0'                                                                                 " & vbNewLine _
                                 & "--出荷Lでの帳票パターン取得                        -----** ADD Start/End                                    " & vbNewLine _
                                 & "LEFT JOIN $LM_MST$..M_RPT MR4                                                                                " & vbNewLine _
                                 & " ON  MR4.NRS_BR_CD     = MCR3.NRS_BR_CD                                                                     " & vbNewLine _
                                 & " AND MR4.PTN_ID        = MCR3.PTN_ID                                                                        " & vbNewLine _
                                 & " AND MR4.PTN_CD        = MCR3.PTN_CD                                                                        " & vbNewLine _
                                 & " AND MR4.STANDARD_FLAG = '00'                                                                               " & vbNewLine _
                                 & " AND MR4.SYS_DEL_FLG      = '0'                                  　　                                       " & vbNewLine _
                                 & "--荷主マスタ (ここからメインプリント用)                              　　　　　　　　　                     " & vbNewLine _
                                 & "LEFT JOIN $LM_MST$..M_CUST CST                                                                              " & vbNewLine _
                                 & "ON  CST.NRS_BR_CD     = MG.NRS_BR_CD                                                                        " & vbNewLine _
                                 & "AND CST.CUST_CD_L     = MG.CUST_CD_L                                                                        " & vbNewLine _
                                 & "AND CST.CUST_CD_M     = MG.CUST_CD_M                                                                        " & vbNewLine _
                                 & "AND CST.CUST_CD_S     = MG.CUST_CD_S                                                                        " & vbNewLine _
                                 & "AND CST.CUST_CD_SS    = MG.CUST_CD_SS                                                                       " & vbNewLine _
                                 & "AND CST.SYS_DEL_FLG   = '0'                                                                                 " & vbNewLine _
                                 & "--届先マスタ                                                                                                " & vbNewLine _
                                 & "LEFT JOIN $LM_MST$..M_DEST DST                                                                              " & vbNewLine _
                                 & "ON  DST.NRS_BR_CD     = OUTL.NRS_BR_CD                                                                      " & vbNewLine _
                                 & "AND DST.CUST_CD_L     = OUTL.CUST_CD_L                                                                      " & vbNewLine _
                                 & "AND DST.DEST_CD       = OUTL.DEST_CD                                                                        " & vbNewLine _
                                 & "AND DST.SYS_DEL_FLG   = '0'                                                                                 " & vbNewLine _
                                 & "--届先マスタ                                                                                                " & vbNewLine _
                                 & "LEFT JOIN $LM_MST$..M_DEST SHIPDST                                                                          " & vbNewLine _
                                 & "ON  SHIPDST.NRS_BR_CD     = OUTL.NRS_BR_CD                                                                  " & vbNewLine _
                                 & "AND SHIPDST.CUST_CD_L     = OUTL.CUST_CD_L                                                                  " & vbNewLine _
                                 & "AND SHIPDST.DEST_CD       = OUTL.SHIP_CD_L                                                                  " & vbNewLine _
                                 & "AND SHIPDST.SYS_DEL_FLG   = '0'                                                                             " & vbNewLine _
                                 & "--2018/03/07 001033 20180131【LMS】横浜BC帳票住所がYCCになっている対応 Annen upd start                      " & vbNewLine _
                                 & "--倉庫マスタ                                                                                                " & vbNewLine _
                                 & "LEFT JOIN LM_MST..M_SOKO SOKO                                                                               " & vbNewLine _
                                 & "ON OUTL.NRS_BR_CD = SOKO.NRS_BR_CD                                                                          " & vbNewLine _
                                 & "AND OUTL.WH_CD = SOKO.WH_CD                                                                                 " & vbNewLine _
                                 & "AND SOKO.SYS_DEL_FLG = '0'                                                                                  " & vbNewLine _
                                 & "--営業所マスタ                                                                                              " & vbNewLine _
                                 & "--LEFT JOIN $LM_MST$..M_NRS_BR NB                                                                             " & vbNewLine _
                                 & "--ON  NB.NRS_BR_CD      = OUTL.NRS_BR_CD                                                                      " & vbNewLine _
                                 & "--AND NB.SYS_DEL_FLG    = '0'                                                                                 " & vbNewLine _
                                 & "--2018/03/07 001033 20180131【LMS】横浜BC帳票住所がYCCになっている対応 Annen upd end                        " & vbNewLine _
                                 & "--商品明細                                                                                                  " & vbNewLine _
                                 & "LEFT JOIN $LM_MST$..M_GOODS_DETAILS MGD                                                                     " & vbNewLine _
                                 & "ON  MGD.NRS_BR_CD       = OUTM.NRS_BR_CD                                                                    " & vbNewLine _
                                 & "AND MGD.GOODS_CD_NRS    = OUTM.GOODS_CD_NRS                                                                 " & vbNewLine _
                                 & "AND MGD.SUB_KB          = '01'                                                                              " & vbNewLine _
                                 & "AND MGD.SYS_DEL_FLG     = '0'                                                                               " & vbNewLine _
                                 & "--区分マスタ(LMC560支店TEL(NM4)・支店名(NM3))KB01                                                           " & vbNewLine _
                                 & "LEFT JOIN $LM_MST$..Z_KBN KB01                                                                              " & vbNewLine _
                                 & "ON  KB01.KBN_GROUP_CD = 'O007'                                                                              " & vbNewLine _
                                 & "AND KB01.KBN_CD       = '01'                                                                                " & vbNewLine _
                                 & "AND KB01.SYS_DEL_FLG  = '0'                                                                                 " & vbNewLine _
                                 & "--区分マスタ(納期文言)KB02                                                                                  " & vbNewLine _
                                 & "LEFT JOIN $LM_MST$..Z_KBN KB02                                                                              " & vbNewLine _
                                 & "ON  KB02.KBN_GROUP_CD = 'N010'                                                                              " & vbNewLine _
                                 & "AND KB02.KBN_CD       = OUTL.ARR_PLAN_TIME                                                                  " & vbNewLine _
                                 & "AND KB02.SYS_DEL_FLG  = '0'                                                                                 " & vbNewLine _
                                 & "--区分マスタ(LMC563支店名(NM3)、電話番号(NM4))KB03                                                          " & vbNewLine _
                                 & "LEFT JOIN $LM_MST$..Z_KBN KB03                                                                              " & vbNewLine _
                                 & "ON  KB03.KBN_GROUP_CD = 'O007'                                                                              " & vbNewLine _
                                 & "AND KB03.KBN_CD       = '10'                                                                                " & vbNewLine _
                                 & "AND KB03.SYS_DEL_FLG  = '0'                                                                                 " & vbNewLine _
                                 & "--区分マスタ(LMC563支払支店コード(NM3))KB0401                                                               " & vbNewLine _
                                 & "LEFT JOIN $LM_MST$..Z_KBN KB0401                                                                            " & vbNewLine _
                                 & "ON  KB0401.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                 & "AND KB0401.KBN_CD       = '11'                                                                              " & vbNewLine _
                                 & "AND KB0401.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                 & "--区分マスタ(LMC563支払支店コード(NM3))KB0402                                                               " & vbNewLine _
                                 & "LEFT JOIN $LM_MST$..Z_KBN KB0402                                                                            " & vbNewLine _
                                 & "ON  KB0402.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                 & "AND KB0402.KBN_CD       = '12'                                                                              " & vbNewLine _
                                 & "AND KB0402.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                 & "--区分マスタ(LMC563支払支店コード(NM3))KB0403                                                               " & vbNewLine _
                                 & "LEFT JOIN $LM_MST$..Z_KBN KB0403                                                                            " & vbNewLine _
                                 & "ON  KB0403.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                 & "AND KB0403.KBN_CD       = '13'                                                                              " & vbNewLine _
                                 & "AND KB0403.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                 & "--区分マスタ(LMC563支払支店コード(NM3))KB0404                                                               " & vbNewLine _
                                 & "LEFT JOIN $LM_MST$..Z_KBN KB0404                                                                            " & vbNewLine _
                                 & "ON  KB0404.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                 & "AND KB0404.KBN_CD       = '14'                                                                              " & vbNewLine _
                                 & "AND KB0404.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                 & "--区分マスタ(LMC563支払支店コード(NM3))KB0405                                                               " & vbNewLine _
                                 & "LEFT JOIN $LM_MST$..Z_KBN KB0405                                                                            " & vbNewLine _
                                 & "ON  KB0405.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                 & "AND KB0405.KBN_CD       = '15'                                                                              " & vbNewLine _
                                 & "AND KB0405.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                 & "--区分マスタ(LMC564支店TEL、荷主TEL(NM4)・支店名(NM3))KB05                                                  " & vbNewLine _
                                 & "LEFT JOIN $LM_MST$..Z_KBN KB05                                                                              " & vbNewLine _
                                 & "ON  KB05.KBN_GROUP_CD   = 'O007'                                                                            " & vbNewLine _
                                 & "AND KB05.KBN_CD         = '02'                                                                              " & vbNewLine _
                                 & "AND KB05.SYS_DEL_FLG    = '0'                                                                               " & vbNewLine _
                                 & "--区分マスタ(LMC565支払いコード(NM3)KB0601)                                                                 " & vbNewLine _
                                 & "LEFT JOIN $LM_MST$..Z_KBN KB0601                                                                            " & vbNewLine _
                                 & "ON  KB0601.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                 & "AND KB0601.KBN_CD       = '07'                                                                              " & vbNewLine _
                                 & "AND KB0601.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                 & "--区分マスタ(LMC565支払いコード(NM3)KB0602)                                                                 " & vbNewLine _
                                 & "LEFT JOIN $LM_MST$..Z_KBN KB0602                                                                            " & vbNewLine _
                                 & "ON  KB0602.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                 & "AND KB0602.KBN_CD       = '08'                                                                              " & vbNewLine _
                                 & "AND KB0602.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                 & "--区分マスタ(LMC568荷主コード(NM5)KB0701                                                                    " & vbNewLine _
                                 & "LEFT JOIN $LM_MST$..Z_KBN KB0701                                                                            " & vbNewLine _
                                 & "ON  KB0701.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                 & "AND KB0701.KBN_CD       = '03'                                                                              " & vbNewLine _
                                 & "AND KB0701.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                 & "--区分マスタ(LMC568荷主コード(NM5)KB0702                                                                    " & vbNewLine _
                                 & "LEFT JOIN $LM_MST$..Z_KBN KB0702                                                                            " & vbNewLine _
                                 & "ON  KB0702.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                 & "AND KB0702.KBN_CD       = '09'                                                                              " & vbNewLine _
                                 & "AND KB0702.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                 & "--区分マスタ(LMC569固定表示(NM1,3,4))KB08                                                                   " & vbNewLine _
                                 & "LEFT JOIN $LM_MST$..Z_KBN KB08                                                                              " & vbNewLine _
                                 & "ON  KB08.KBN_GROUP_CD   = 'O007'                                                                            " & vbNewLine _
                                 & "AND KB08.KBN_CD         = '04'                                                                              " & vbNewLine _
                                 & "AND KB08.SYS_DEL_FLG    = '0'                                                                               " & vbNewLine _
                                 & "--区分マスタ(LMC570支店名(NM3)支店TEL(NM4))KB1001                                                           " & vbNewLine _
                                 & "LEFT JOIN $LM_MST$..Z_KBN KB1001                                                                            " & vbNewLine _
                                 & "ON  KB1001.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                 & "AND KB1001.KBN_CD       = '05'                                                                              " & vbNewLine _
                                 & "AND KB1001.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                 & "--区分マスタ(LMC570支店名(NM3)支店TEL(NM4))KB1002                                                           " & vbNewLine _
                                 & "LEFT JOIN $LM_MST$..Z_KBN KB1002                                                                            " & vbNewLine _
                                 & "ON  KB1002.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                 & "AND KB1002.KBN_CD       = '06'                                                                              " & vbNewLine _
                                 & "AND KB1002.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                 & "--荷主明細マスタ(LMC573にて運送契約荷主コード取得)                                                          " & vbNewLine _
                                 & "LEFT JOIN $LM_MST$..M_CUST_DETAILS CUSTDTL                                                                  " & vbNewLine _
                                 & "ON  CUSTDTL.NRS_BR_CD    = OUTL.NRS_BR_CD                                                                   " & vbNewLine _
                                 & "AND CUSTDTL.CUST_CD      = OUTL.CUST_CD_L + OUTL.CUST_CD_M                                                  " & vbNewLine _
                                 & "AND CUSTDTL.SUB_KB       = '03'                                                                             " & vbNewLine _
                                 & "AND CUSTDTL.SYS_DEL_FLG  = '0'                                                                              " & vbNewLine _
                                 & "--区分マスタ(LMC575支払コード(NM3)KB0801)                                                                   " & vbNewLine _
                                 & "LEFT JOIN $LM_MST$..Z_KBN KB0801                                                                            " & vbNewLine _
                                 & "ON  KB0801.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                 & "AND KB0801.KBN_CD       = '16'                                                                              " & vbNewLine _
                                 & "AND KB0801.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                 & "--区分マスタ(LMC575支払コード(NM3)KB0802)                                                                   " & vbNewLine _
                                 & "LEFT JOIN $LM_MST$..Z_KBN KB0802                                                                            " & vbNewLine _
                                 & "ON  KB0802.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                 & "AND KB0802.KBN_CD       = '17'                                                                              " & vbNewLine _
                                 & "AND KB0802.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                 & "--区分マスタ(LMC670 KB0803)                                                                                 " & vbNewLine _
                                 & "LEFT JOIN $LM_MST$..Z_KBN KB0803                                                                            " & vbNewLine _
                                 & "ON  KB0803.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                 & "AND KB0803.KBN_CD       = '18'                                                                              " & vbNewLine _
                                 & "AND KB0803.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                 & "LEFT JOIN $LM_MST$..M_DEST      DEST_JIS --2012.05.25                                                       " & vbNewLine _
                                 & "ON  DEST_JIS.NRS_BR_CD    = OUTL.NRS_BR_CD                                                                  " & vbNewLine _
                                 & "AND DEST_JIS.CUST_CD_L    = OUTL.CUST_CD_L                                                                  " & vbNewLine _
                                 & "AND DEST_JIS.DEST_CD      = OUTL.DEST_CD                                                                    " & vbNewLine _
                                 & "AND DEST_JIS.SYS_DEL_FLG  = '0'                                                                             " & vbNewLine _
                                 & "--JISマスタ(LMC661にてJIS_CD2桁：都道府県コード取得)2012.05.25                                              " & vbNewLine _
                                 & "  LEFT JOIN  $LM_MST$..M_JIS   JIS                                                                          " & vbNewLine _
                                 & "  ON  JIS.JIS_CD       = DEST_JIS.JIS                                                                       " & vbNewLine _
                                 & " AND  JIS.SYS_DEL_FLG  = '0'                                                                                " & vbNewLine _
                                 & "--運送会社マスタ(LMC589にてUNSOCO_NM：取次先運送会社名取得)2012.05.25                                       " & vbNewLine _
                                 & "--  LEFT JOIN  $LM_MST$..M_UNSOCO   MUC                                                                     " & vbNewLine _
                                 & "--  ON  MUC.NRS_BR_CD    = FL.NRS_BR_CD                                                                     " & vbNewLine _
                                 & "-- AND  MUC.UNSOCO_CD    = FL.UNSO_CD                                                                       " & vbNewLine _
                                 & "-- AND  MUC.UNSOCO_BR_CD = FL.UNSO_BR_CD                                                                    " & vbNewLine _
                                 & "-- AND  MUC.SYS_DEL_FLG  = '0'                                                                              " & vbNewLine _
                                 & "--荷主明細マスタ(LMC660にてSET_NAIYO：支払コード取得)2012.05.25                                             " & vbNewLine _
                                 & "LEFT JOIN $LM_MST$..M_CUST_DETAILS MCD_SAI                                                                  " & vbNewLine _
                                 & "ON  MCD_SAI.NRS_BR_CD    = OUTL.NRS_BR_CD                                                                   " & vbNewLine _
                                 & "AND MCD_SAI.CUST_CD      = OUTL.CUST_CD_L                                                                   " & vbNewLine _
                                 & "--AND MCD_SAI.CUST_CD_EDA  = OUTL.CUST_CD_M                                                                   " & vbNewLine _
                                 & "AND MCD_SAI.SUB_KB       = '27'                                                                             " & vbNewLine _
                                 & "AND MCD_SAI.SYS_DEL_FLG  = '0'                                                                              " & vbNewLine _
                                 & "--荷主明細マスタ(LMC669にてSET_NAIYO：荷送人名称取得)2012.06.01                                             " & vbNewLine _
                                 & "  LEFT JOIN $LM_MST$..M_CUST_DETAILS MCD_NFC                                                                " & vbNewLine _
                                 & "ON MCD_NFC.NRS_BR_CD   = OUTL.NRS_BR_CD                                                                     " & vbNewLine _
                                 & "AND MCD_NFC.CUST_CD      = OUTL.CUST_CD_L                                                                   " & vbNewLine _
                                 & "--AND MCD_NFC.CUST_CD_EDA  = OUTL.CUST_CD_M                                                                   " & vbNewLine _
                                 & "AND MCD_NFC.SUB_KB       = '29'                                                                             " & vbNewLine _
                                 & "AND MCD_NFC.SYS_DEL_FLG  = '0'                                                                              " & vbNewLine _
                                 & " --要望番号1383 [LMC664] --- START ---                                                                      " & vbNewLine _
                                 & "         LEFT JOIN (SELECT NRS_BR_CD   AS NRS_BR_CD                                                         " & vbNewLine _
                                 & "                         , CUST_CD     AS CUST_CD                                                           " & vbNewLine _
                                 & "                         , CUST_CLASS  AS CUST_CLASS                                                        " & vbNewLine _
                                 & "                         , SET_NAIYO   AS CUST_NAIYO_1                                                      " & vbNewLine _
                                 & "                         , SET_NAIYO_2 AS CUST_NAIYO_2                                                      " & vbNewLine _
                                 & "                         , SET_NAIYO_3 AS CUST_NAIYO_3                                                      " & vbNewLine _
                                 & "                      FROM $LM_MST$..M_CUST_DETAILS                                                         " & vbNewLine _
                                 & "                     WHERE SUB_KB ='42'                                                                     " & vbNewLine _
                                 & "                       AND SET_NAIYO_2 = @RPT_ID                                                            " & vbNewLine _
                                 & "                       AND SYS_DEL_FLG = '0'                                                                " & vbNewLine _
                                 & "                    ) MCD_CUST                                                                              " & vbNewLine _
                                 & "                ON CST.NRS_BR_CD = MCD_CUST.NRS_BR_CD                                                       " & vbNewLine _
                                 & "               AND (CASE WHEN MCD_CUST.CUST_CLASS='00' THEN  CST.CUST_CD_L                                                   " & vbNewLine _
                                 & "                         WHEN MCD_CUST.CUST_CLASS='01' THEN (CST.CUST_CD_L + CST.CUST_CD_M)                                  " & vbNewLine _
                                 & "                         WHEN MCD_CUST.CUST_CLASS='02' THEN (CST.CUST_CD_L + CST.CUST_CD_M + CST.CUST_CD_S)                  " & vbNewLine _
                                 & "                         WHEN MCD_CUST.CUST_CLASS='03' THEN (CST.CUST_CD_L + CST.CUST_CD_M + CST.CUST_CD_S + CST.CUST_CD_SS) " & vbNewLine _
                                 & "                    END                                                                                     " & vbNewLine _
                                 & "                   ) = MCD_CUST.CUST_CD                                                                     " & vbNewLine _
                                 & " --要望番号1383 [LMC664] --- END ---                                                                        " & vbNewLine _
                                 & "--WHERE                                                                                                     " & vbNewLine _
                                 & "--    OUTL.SYS_DEL_FLG    = '0'                                                                             " & vbNewLine _
                                 & "--AND OUTL.NRS_BR_CD      = @NRS_BR_CD                                                                      " & vbNewLine _
                                 & "--AND OUTL.OUTKA_NO_L IN(@OUTKA_NO_L)                                                                       " & vbNewLine _
                                 & " WHERE OUTL.SYS_DEL_FLG     = '0'                                                                           " & vbNewLine _
                                 & "   AND OUTL.NRS_BR_CD       = @NRS_BR_CD                                                                    " & vbNewLine _
                                 & "   AND OUTL.CUST_CD_L       = @CUST_CD_L                                                                    " & vbNewLine _
                                 & "   AND OUTL.CUST_CD_M       = @CUST_CD_M                                                                    " & vbNewLine _
                                 & "   AND OUTL.OUTKA_PLAN_DATE = @OUTKA_PLAN_DATE                                                              " & vbNewLine _
                                 & "   AND OUTL.ARR_PLAN_DATE   = @ARR_PLAN_DATE                                                                " & vbNewLine _
                                 & "   AND FL.UNSO_CD           = @UNSO_CD                                                                      " & vbNewLine _
                                 & "   AND FL.UNSO_BR_CD        = @UNSO_BR_CD                                                                   " & vbNewLine _
                                 & "   AND OUTL.DEST_CD         = @DEST_CD                                                                      " & vbNewLine _
                                 & "   AND OUTL.OUTKA_NO_L  IN (@OUTKA_NO_L)                                                          " & vbNewLine _
                                 & "   ) MAIN                                                                                                   " & vbNewLine


#End If

    ''' <summary>
    ''' データ抽出用FROM句浮間用(☆★作業用コメント：20120618)
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_FROM_MATOME As String = "-- SQL_FROM_MATOME                                                                                   " & vbNewLine _
                                     & "FROM                                                                                                        " & vbNewLine _
                                     & "$LM_TRN$..C_OUTKA_L OUTL                                                                                    " & vbNewLine _
                                     & " LEFT JOIN (                                                                                                " & vbNewLine _
                                     & "            SELECT                                                                                          " & vbNewLine _
                                     & "                   EDIOUTL.NRS_BR_CD         AS NRS_BR_CD                                                   " & vbNewLine _
                                     & "                 , MIN(EDIOUTL.EDI_CTL_NO)   AS EDI_CTL_NO                                                  " & vbNewLine _
                                     & "                 , EDIOUTL.OUTKA_CTL_NO      AS OUTKA_CTL_NO                                                " & vbNewLine _
                                     & "              FROM $LM_TRN$..H_OUTKAEDI_L EDIOUTL                                                           " & vbNewLine _
                                     & "             WHERE EDIOUTL.SYS_DEL_FLG  = '0'                                                               " & vbNewLine _
                                     & "               AND EDIOUTL.NRS_BR_CD    = @NRS_BR_CD                                                        " & vbNewLine _
                                     & "               AND EDIOUTL.DEL_KB       = '0'                                                               " & vbNewLine _
                                     & "               AND LEN(EDIOUTL.OUTKA_CTL_NO) > 0                                                            " & vbNewLine _
                                     & "             GROUP BY                                                                                       " & vbNewLine _
                                     & "                   EDIOUTL.NRS_BR_CD                                                                        " & vbNewLine _
                                     & "                 , EDIOUTL.OUTKA_CTL_NO                                                                     " & vbNewLine _
                                     & "            ) TOPEDI                                                                                        " & vbNewLine _
                                     & "        ON TOPEDI.NRS_BR_CD    = OUTL.NRS_BR_CD                                                             " & vbNewLine _
                                     & "       AND TOPEDI.OUTKA_CTL_NO = OUTL.OUTKA_NO_L                                                            " & vbNewLine _
                                     & " LEFT JOIN $LM_TRN$..H_OUTKAEDI_L EDIL                                                                      " & vbNewLine _
                                     & "        ON EDIL.NRS_BR_CD  = TOPEDI.NRS_BR_CD                                                               " & vbNewLine _
                                     & "       AND EDIL.EDI_CTL_NO = TOPEDI.EDI_CTL_NO                                                              " & vbNewLine _
                                     & "--(2012.09.11)要望番号1412対応  ---  END  ---                                                               " & vbNewLine _
                                     & "--出荷M                                                                                                     " & vbNewLine _
                                     & "LEFT JOIN                                                                                                   " & vbNewLine _
                                     & "(SELECT                                                                                                     " & vbNewLine _
                                     & "*                                                                                                           " & vbNewLine _
                                     & "FROM                                                                                                        " & vbNewLine _
                                     & "(SELECT                                                                                                     " & vbNewLine _
                                     & "--(2012.06.18)要望番号1160対応 --- START ----                                                               " & vbNewLine _
                                     & "--   NRS_BR_CD                                                                                              " & vbNewLine _
                                     & "--  ,GOODS_CD_NRS                                                                                           " & vbNewLine _
                                     & "--  ,IRIME                                                                                                  " & vbNewLine _
                                     & "--  ,IRIME_UT                                                                                               " & vbNewLine _
                                     & "--  ,ALCTD_NB                                                                                               " & vbNewLine _
                                     & "--  ,LOT_NO                                                                                                 " & vbNewLine _
                                     & "--  ,CUST_ORD_NO_DTL   --2012/06/11浮間対応                                                                 " & vbNewLine _
                                     & "--  ,SYS_DEL_FLG                                                                                            " & vbNewLine _
                                     & "--  ,ROW_NUMBER() OVER (PARTITION BY NRS_BR_CD ORDER BY OUTKA_NO_L,OUTKA_NO_M) AS NUM                       " & vbNewLine _
                                     & "   M.NRS_BR_CD                                                                                              " & vbNewLine _
                                     & "  ,M.GOODS_CD_NRS                                                                                           " & vbNewLine _
                                     & "  ,M.IRIME                                                                                                  " & vbNewLine _
                                     & "  ,M.IRIME_UT                                                                                               " & vbNewLine _
                                     & "  ,M.ALCTD_NB                                                                                               " & vbNewLine _
                                     & "  ,M.ALCTD_QT                                                                                               " & vbNewLine _
                                     & "  ,M.LOT_NO                                                                                                 " & vbNewLine _
                                     & "  ,M.CUST_ORD_NO_DTL   --2012/06/11浮間対応                                                                 " & vbNewLine _
                                     & "  ,M.SYS_DEL_FLG                                                                                            " & vbNewLine _
                                     & "  ,ROW_NUMBER() OVER (PARTITION BY M.NRS_BR_CD ORDER BY M.OUTKA_NO_L,M.OUTKA_NO_M) AS NUM                   " & vbNewLine _
                                     & "  ,M.OUTKA_NO_L                                                                                             " & vbNewLine _
                                     & "  ,M.OUTKA_NO_M                                                                                             " & vbNewLine _
                                     & "  FROM                                                                                                      " & vbNewLine _
                                     & "--(2012.06.18)要望番号1160対応 ---  END  ----                                                               " & vbNewLine _
                                     & "   $LM_TRN$..C_OUTKA_M M                                                                                    " & vbNewLine _
                                     & "--(2012.06.18)要望番号1160対応 --- START ----                                                               " & vbNewLine _
                                     & "   LEFT JOIN $LM_TRN$..C_OUTKA_L OUTL                                                                       " & vbNewLine _
                                     & "          ON OUTL.NRS_BR_CD  = M.NRS_BR_CD                                                                  " & vbNewLine _
                                     & "         AND OUTL.OUTKA_NO_L = M.OUTKA_NO_L                                                                 " & vbNewLine _
                                     & "         AND OUTL.SYS_DEL_FLG  = '0'                                                                        " & vbNewLine _
                                     & "   LEFT JOIN $LM_TRN$..F_UNSO_L FL                                                                          " & vbNewLine _
                                     & "          ON FL.NRS_BR_CD    = M.NRS_BR_CD                                                                  " & vbNewLine _
                                     & "         AND FL.INOUTKA_NO_L = M.OUTKA_NO_L                                                                 " & vbNewLine _
                                     & "         AND FL.MOTO_DATA_KB = '20'                                                                         " & vbNewLine _
                                     & "         AND FL.SYS_DEL_FLG  = '0'                                                                          " & vbNewLine _
                                     & "--(2012.06.18)要望番号1160対応 ---  END  ----                                                               " & vbNewLine _
                                     & "  WHERE                                                                                                     " & vbNewLine _
                                     & "      M.NRS_BR_CD = @NRS_BR_CD                                                                              " & vbNewLine _
                                     & "--(2012.06.18)要望番号1160対応 --- START ----                                                               " & vbNewLine _
                                     & "    AND OUTL.CUST_CD_L       = @CUST_CD_L                                                                   " & vbNewLine _
                                     & "    AND OUTL.CUST_CD_M       = @CUST_CD_M                                                                   " & vbNewLine _
                                     & "    AND OUTL.OUTKA_PLAN_DATE = @OUTKA_PLAN_DATE                                                             " & vbNewLine _
                                     & "    AND OUTL.ARR_PLAN_DATE   = @ARR_PLAN_DATE                                                               " & vbNewLine _
                                     & "    AND FL.UNSO_CD           = @UNSO_CD                                                                     " & vbNewLine _
                                     & "    AND FL.UNSO_BR_CD        = @UNSO_BR_CD                                                                  " & vbNewLine _
                                     & "    AND OUTL.DEST_CD         = @DEST_CD                                                                     " & vbNewLine _
                                     & "--  AND M.OUTKA_NO_L IN(@OUTKA_NO_L)                                                                        " & vbNewLine _
                                     & "--  AND SYS_DEL_FLG = '0'                                                                                   " & vbNewLine _
                                     & "    AND M.SYS_DEL_FLG = '0'                                                                                 " & vbNewLine _
                                     & "--(2012.06.18)要望番号1160対応 ---  END  ----                                                               " & vbNewLine _
                                     & " ) AS BASE                                                                                                  " & vbNewLine _
                                     & "-- WHERE                                                                                                    " & vbNewLine _
                                     & "-- BASE.NUM = 1                                                                                             " & vbNewLine _
                                     & ") OUTM                                                                                                      " & vbNewLine _
                                     & "--ON                                                                                                        " & vbNewLine _
                                     & "--1 = 1                                                                                                     " & vbNewLine _
                                     & "--(2012.06.18)要望番号1160対応 --- START ----                                                               " & vbNewLine _
                                     & " ON OUTL.NRS_BR_CD  = OUTM.NRS_BR_CD                                                                        " & vbNewLine _
                                     & "AND OUTL.OUTKA_NO_L = OUTM.OUTKA_NO_L                                                                       " & vbNewLine _
                                     & "--(2012.06.18)要望番号1160対応 ---  END  ----                                                               " & vbNewLine _
                                     & "--F運送L                                                                                                    " & vbNewLine _
                                     & "LEFT JOIN $LM_TRN$..F_UNSO_L FL                                                                             " & vbNewLine _
                                     & "ON  FL.MOTO_DATA_KB   = '20'                                                                                " & vbNewLine _
                                     & "AND FL.NRS_BR_CD      = OUTL.NRS_BR_CD                                                                      " & vbNewLine _
                                     & "AND FL.INOUTKA_NO_L   = OUTL.OUTKA_NO_L                                                                     " & vbNewLine _
                                     & "AND FL.SYS_DEL_FLG    = '0'                                                                                 " & vbNewLine _
                                     & "--出荷EDI L                                                                                                 " & vbNewLine _
                                     & "--LEFT JOIN $LM_TRN$..H_OUTKAEDI_L OUTKAEDIL                                                                  " & vbNewLine _
                                     & "--ON  OUTKAEDIL.NRS_BR_CD     = OUTL.NRS_BR_CD                                                                " & vbNewLine _
                                     & "--AND OUTKAEDIL.OUTKA_CTL_NO  = OUTL.OUTKA_NO_L                                                               " & vbNewLine _
                                     & "--AND OUTKAEDIL.SYS_DEL_FLG   = '0'                                                                           " & vbNewLine _
                                     & "--商品M                                                                                                     " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_GOODS MG                                                                              " & vbNewLine _
                                     & "ON  MG.NRS_BR_CD     = OUTM.NRS_BR_CD                                                                       " & vbNewLine _
                                     & "AND MG.GOODS_CD_NRS  = OUTM.GOODS_CD_NRS                                                                    " & vbNewLine _
                                     & "AND MG.SYS_DEL_FLG   = '0'                                                                                  " & vbNewLine _
                                     & "--荷主なしでの運送会社荷主別送り状パターン取得                                                              " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_UNSO_CUST_RPT MCR1                                                                    " & vbNewLine _
                                     & "ON  FL.NRS_BR_CD     = MCR1.NRS_BR_CD                                                                       " & vbNewLine _
                                     & "AND FL.UNSO_CD       = MCR1.UNSOCO_CD                                                                       " & vbNewLine _
                                     & "AND FL.UNSO_BR_CD    = MCR1.UNSOCO_BR_CD                                                                    " & vbNewLine _
                                     & "AND '11'             = MCR1.PTN_ID                                                                          " & vbNewLine _
                                     & "AND FL.PC_KB         = MCR1.MOTO_TYAKU_KB                                                                   " & vbNewLine _
                                     & "AND ''               = MCR1.CUST_CD_L                                                                       " & vbNewLine _
                                     & "AND ''               = MCR1.CUST_CD_M                                                                       " & vbNewLine _
                                     & "AND MCR1.SYS_DEL_FLG = '0'                                                                                  " & vbNewLine _
                                     & "--帳票パターン取得                                                                                          " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_RPT MR1                                                                               " & vbNewLine _
                                     & "ON  MR1.NRS_BR_CD   = MCR1.NRS_BR_CD                                                                        " & vbNewLine _
                                     & "AND MR1.PTN_ID      = MCR1.PTN_ID                                                                           " & vbNewLine _
                                     & "AND MR1.PTN_CD      = MCR1.PTN_CD                                                                           " & vbNewLine _
                                     & "AND MR1.SYS_DEL_FLG = '0'                                                                                   " & vbNewLine _
                                     & "--荷主込みでの運送会社荷主別送り状パターン取得                                                              " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_UNSO_CUST_RPT MCR2                                                                    " & vbNewLine _
                                     & "ON  FL.NRS_BR_CD     = MCR2.NRS_BR_CD                                                                       " & vbNewLine _
                                     & "AND FL.UNSO_CD       = MCR2.UNSOCO_CD                                                                       " & vbNewLine _
                                     & "AND FL.UNSO_BR_CD    = MCR2.UNSOCO_BR_CD                                                                    " & vbNewLine _
                                     & "AND '11'             = MCR2.PTN_ID                                                                          " & vbNewLine _
                                     & "AND FL.PC_KB         = MCR2.MOTO_TYAKU_KB                                                                   " & vbNewLine _
                                     & "AND FL.CUST_CD_L     = MCR2.CUST_CD_L                                                                       " & vbNewLine _
                                     & "AND FL.CUST_CD_M     = MCR2.CUST_CD_M                                                                       " & vbNewLine _
                                     & "AND MCR2.SYS_DEL_FLG = '0'                                                                                  " & vbNewLine _
                                     & "--帳票パターン取得                                                                                          " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_RPT MR2                                                                               " & vbNewLine _
                                     & "ON  MR2.NRS_BR_CD    = MCR2.NRS_BR_CD                                                                       " & vbNewLine _
                                     & "AND MR2.PTN_ID       = MCR2.PTN_ID                                                                          " & vbNewLine _
                                     & "AND MR2.PTN_CD       = MCR2.PTN_CD                                                                          " & vbNewLine _
                                     & "AND MR2.SYS_DEL_FLG  = '0'                                                                                  " & vbNewLine _
                                     & "--存在しない場合の帳票パターン取得                                                                          " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_RPT MR3                                                                               " & vbNewLine _
                                     & "ON  MR3.NRS_BR_CD     = OUTL.NRS_BR_CD                                                                      " & vbNewLine _
                                     & "AND MR3.PTN_ID        = '11'                                                                                " & vbNewLine _
                                     & "AND MR3.STANDARD_FLAG = '01'                                                                                " & vbNewLine _
                                     & "AND MR3.SYS_DEL_FLG   = '0'                                                                                 " & vbNewLine _
                                     & "--荷主マスタ (ここからメインプリント用)                                                               " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_CUST CST                                                                              " & vbNewLine _
                                     & "ON  CST.NRS_BR_CD     = MG.NRS_BR_CD                                                                        " & vbNewLine _
                                     & "AND CST.CUST_CD_L     = MG.CUST_CD_L                                                                        " & vbNewLine _
                                     & "AND CST.CUST_CD_M     = MG.CUST_CD_M                                                                        " & vbNewLine _
                                     & "AND CST.CUST_CD_S     = MG.CUST_CD_S                                                                        " & vbNewLine _
                                     & "AND CST.CUST_CD_SS    = MG.CUST_CD_SS                                                                       " & vbNewLine _
                                     & "AND CST.SYS_DEL_FLG   = '0'                                                                                 " & vbNewLine _
                                     & "--届先マスタ                                                                                                " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_DEST DST                                                                              " & vbNewLine _
                                     & "ON  DST.NRS_BR_CD     = OUTL.NRS_BR_CD                                                                      " & vbNewLine _
                                     & "AND DST.CUST_CD_L     = OUTL.CUST_CD_L                                                                      " & vbNewLine _
                                     & "AND DST.DEST_CD       = OUTL.DEST_CD                                                                        " & vbNewLine _
                                     & "AND DST.SYS_DEL_FLG   = '0'                                                                                 " & vbNewLine _
                                     & "--届先マスタ                                                                                                " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_DEST SHIPDST                                                                          " & vbNewLine _
                                     & "ON  SHIPDST.NRS_BR_CD     = OUTL.NRS_BR_CD                                                                  " & vbNewLine _
                                     & "AND SHIPDST.CUST_CD_L     = OUTL.CUST_CD_L                                                                  " & vbNewLine _
                                     & "AND SHIPDST.DEST_CD       = OUTL.SHIP_CD_L                                                                  " & vbNewLine _
                                     & "AND SHIPDST.SYS_DEL_FLG   = '0'                                                                             " & vbNewLine _
                                     & "--2018/03/07 001033 20180131【LMS】横浜BC帳票住所がYCCになっている対応 Annen upd start                      " & vbNewLine _
                                     & "--倉庫マスタ                                                                                                " & vbNewLine _
                                     & "LEFT JOIN LM_MST..M_SOKO SOKO                                                                               " & vbNewLine _
                                     & "ON OUTL.NRS_BR_CD = SOKO.NRS_BR_CD                                                                          " & vbNewLine _
                                     & "AND OUTL.WH_CD = SOKO.WH_CD                                                                                 " & vbNewLine _
                                     & "AND SOKO.SYS_DEL_FLG = '0'                                                                                  " & vbNewLine _
                                     & "--営業所マスタ                                                                                              " & vbNewLine _
                                     & "--LEFT JOIN $LM_MST$..M_NRS_BR NB                                                                             " & vbNewLine _
                                     & "--ON  NB.NRS_BR_CD      = OUTL.NRS_BR_CD                                                                      " & vbNewLine _
                                     & "--AND NB.SYS_DEL_FLG    = '0'                                                                                 " & vbNewLine _
                                     & "--2018/03/07 001033 20180131【LMS】横浜BC帳票住所がYCCになっている対応 Annen upd end                        " & vbNewLine _
                                     & "--商品明細                                                                                                  " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_GOODS_DETAILS MGD                                                                     " & vbNewLine _
                                     & "ON  MGD.NRS_BR_CD       = OUTM.NRS_BR_CD                                                                    " & vbNewLine _
                                     & "AND MGD.GOODS_CD_NRS    = OUTM.GOODS_CD_NRS                                                                 " & vbNewLine _
                                     & "AND MGD.SUB_KB          = '01'                                                                              " & vbNewLine _
                                     & "AND MGD.SYS_DEL_FLG     = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC560支店TEL(NM4)・支店名(NM3))KB01                                                           " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB01                                                                              " & vbNewLine _
                                     & "ON  KB01.KBN_GROUP_CD = 'O007'                                                                              " & vbNewLine _
                                     & "AND KB01.KBN_CD       = '01'                                                                                " & vbNewLine _
                                     & "AND KB01.SYS_DEL_FLG  = '0'                                                                                 " & vbNewLine _
                                     & "--区分マスタ(納期文言)KB02                                                                                  " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB02                                                                              " & vbNewLine _
                                     & "ON  KB02.KBN_GROUP_CD = 'N010'                                                                              " & vbNewLine _
                                     & "AND KB02.KBN_CD       = OUTL.ARR_PLAN_TIME                                                                  " & vbNewLine _
                                     & "AND KB02.SYS_DEL_FLG  = '0'                                                                                 " & vbNewLine _
                                     & "--区分マスタ(LMC563支店名(NM3)、電話番号(NM4))KB03                                                          " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB03                                                                              " & vbNewLine _
                                     & "ON  KB03.KBN_GROUP_CD = 'O007'                                                                              " & vbNewLine _
                                     & "AND KB03.KBN_CD       = '10'                                                                                " & vbNewLine _
                                     & "AND KB03.SYS_DEL_FLG  = '0'                                                                                 " & vbNewLine _
                                     & "--区分マスタ(LMC563支払支店コード(NM3))KB0401                                                               " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0401                                                                            " & vbNewLine _
                                     & "ON  KB0401.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0401.KBN_CD       = '11'                                                                              " & vbNewLine _
                                     & "AND KB0401.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC563支払支店コード(NM3))KB0402                                                               " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0402                                                                            " & vbNewLine _
                                     & "ON  KB0402.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0402.KBN_CD       = '12'                                                                              " & vbNewLine _
                                     & "AND KB0402.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC563支払支店コード(NM3))KB0403                                                               " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0403                                                                            " & vbNewLine _
                                     & "ON  KB0403.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0403.KBN_CD       = '13'                                                                              " & vbNewLine _
                                     & "AND KB0403.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC563支払支店コード(NM3))KB0404                                                               " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0404                                                                            " & vbNewLine _
                                     & "ON  KB0404.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0404.KBN_CD       = '14'                                                                              " & vbNewLine _
                                     & "AND KB0404.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC563支払支店コード(NM3))KB0405                                                               " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0405                                                                            " & vbNewLine _
                                     & "ON  KB0405.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0405.KBN_CD       = '15'                                                                              " & vbNewLine _
                                     & "AND KB0405.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC564支店TEL、荷主TEL(NM4)・支店名(NM3))KB05                                                  " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB05                                                                              " & vbNewLine _
                                     & "ON  KB05.KBN_GROUP_CD   = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB05.KBN_CD         = '02'                                                                              " & vbNewLine _
                                     & "AND KB05.SYS_DEL_FLG    = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC565支払いコード(NM3)KB0601)                                                                 " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0601                                                                            " & vbNewLine _
                                     & "ON  KB0601.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0601.KBN_CD       = '07'                                                                              " & vbNewLine _
                                     & "AND KB0601.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC565支払いコード(NM3)KB0602)                                                                 " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0602                                                                            " & vbNewLine _
                                     & "ON  KB0602.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0602.KBN_CD       = '08'                                                                              " & vbNewLine _
                                     & "AND KB0602.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC568荷主コード(NM5)KB0701                                                                    " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0701                                                                            " & vbNewLine _
                                     & "ON  KB0701.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0701.KBN_CD       = '03'                                                                              " & vbNewLine _
                                     & "AND KB0701.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC568荷主コード(NM5)KB0702                                                                    " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0702                                                                            " & vbNewLine _
                                     & "ON  KB0702.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0702.KBN_CD       = '09'                                                                              " & vbNewLine _
                                     & "AND KB0702.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC569固定表示(NM1,3,4))KB08                                                                   " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB08                                                                              " & vbNewLine _
                                     & "ON  KB08.KBN_GROUP_CD   = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB08.KBN_CD         = '04'                                                                              " & vbNewLine _
                                     & "AND KB08.SYS_DEL_FLG    = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC570支店名(NM3)支店TEL(NM4))KB1001                                                           " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB1001                                                                            " & vbNewLine _
                                     & "ON  KB1001.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB1001.KBN_CD       = '05'                                                                              " & vbNewLine _
                                     & "AND KB1001.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC570支店名(NM3)支店TEL(NM4))KB1002                                                           " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB1002                                                                            " & vbNewLine _
                                     & "ON  KB1002.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB1002.KBN_CD       = '06'                                                                              " & vbNewLine _
                                     & "AND KB1002.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--荷主明細マスタ(LMC573にて運送契約荷主コード取得)                                                          " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_CUST_DETAILS CUSTDTL                                                                  " & vbNewLine _
                                     & "ON  CUSTDTL.NRS_BR_CD    = OUTL.NRS_BR_CD                                                                   " & vbNewLine _
                                     & "AND CUSTDTL.CUST_CD      = OUTL.CUST_CD_L + OUTL.CUST_CD_M                                                  " & vbNewLine _
                                     & "AND CUSTDTL.SUB_KB       = '03'                                                                             " & vbNewLine _
                                     & "AND CUSTDTL.SYS_DEL_FLG  = '0'                                                                              " & vbNewLine _
                                     & "--区分マスタ(LMC575支払コード(NM3)KB0801)                                                                   " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0801                                                                            " & vbNewLine _
                                     & "ON  KB0801.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0801.KBN_CD       = '16'                                                                              " & vbNewLine _
                                     & "AND KB0801.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC575支払コード(NM3)KB0802)                                                                   " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0802                                                                            " & vbNewLine _
                                     & "ON  KB0802.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0802.KBN_CD       = '17'                                                                              " & vbNewLine _
                                     & "AND KB0802.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC670 KB0803)                                                                                 " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0803                                                                            " & vbNewLine _
                                     & "ON  KB0803.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0803.KBN_CD       = '18'                                                                              " & vbNewLine _
                                     & "AND KB0803.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_DEST      DEST_JIS --2012.05.25                                                       " & vbNewLine _
                                     & "ON  DEST_JIS.NRS_BR_CD    = OUTL.NRS_BR_CD                                                                  " & vbNewLine _
                                     & "AND DEST_JIS.CUST_CD_L    = OUTL.CUST_CD_L                                                                  " & vbNewLine _
                                     & "AND DEST_JIS.DEST_CD      = OUTL.DEST_CD                                                                    " & vbNewLine _
                                     & "AND DEST_JIS.SYS_DEL_FLG  = '0'                                                                             " & vbNewLine _
                                     & "--JISマスタ(LMC661にてJIS_CD2桁：都道府県コード取得)2012.05.25                                              " & vbNewLine _
                                     & "  LEFT JOIN  $LM_MST$..M_JIS   JIS                                                                          " & vbNewLine _
                                     & "  ON  JIS.JIS_CD       = DEST_JIS.JIS                                                                       " & vbNewLine _
                                     & " AND  JIS.SYS_DEL_FLG  = '0'                                                                                " & vbNewLine _
                                     & "--運送会社マスタ(LMC589にてUNSOCO_NM：取次先運送会社名取得)2012.05.25                                       " & vbNewLine _
                                     & "--  LEFT JOIN  $LM_MST$..M_UNSOCO   MUC                                                                     " & vbNewLine _
                                     & "--  ON  MUC.NRS_BR_CD    = FL.NRS_BR_CD                                                                     " & vbNewLine _
                                     & "-- AND  MUC.UNSOCO_CD    = FL.UNSO_CD                                                                       " & vbNewLine _
                                     & "-- AND  MUC.UNSOCO_BR_CD = FL.UNSO_BR_CD                                                                    " & vbNewLine _
                                     & "-- AND  MUC.SYS_DEL_FLG  = '0'                                                                              " & vbNewLine _
                                     & "--荷主明細マスタ(LMC660にてSET_NAIYO：支払コード取得)2012.05.25                                             " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_CUST_DETAILS MCD_SAI                                                                  " & vbNewLine _
                                     & "ON  MCD_SAI.NRS_BR_CD    = OUTL.NRS_BR_CD                                                                   " & vbNewLine _
                                     & "AND MCD_SAI.CUST_CD      = OUTL.CUST_CD_L                                                                   " & vbNewLine _
                                     & "--AND MCD_SAI.CUST_CD_EDA  = OUTL.CUST_CD_M                                                                   " & vbNewLine _
                                     & "AND MCD_SAI.SUB_KB       = '27'                                                                             " & vbNewLine _
                                     & "AND MCD_SAI.SYS_DEL_FLG  = '0'                                                                              " & vbNewLine _
                                     & "--荷主明細マスタ(LMC669にてSET_NAIYO：荷送人名称取得)2012.06.01                                             " & vbNewLine _
                                     & "  LEFT JOIN $LM_MST$..M_CUST_DETAILS MCD_NFC                                                                " & vbNewLine _
                                     & "ON MCD_NFC.NRS_BR_CD   = OUTL.NRS_BR_CD                                                                     " & vbNewLine _
                                     & "AND MCD_NFC.CUST_CD      = OUTL.CUST_CD_L                                                                   " & vbNewLine _
                                     & "--AND MCD_NFC.CUST_CD_EDA  = OUTL.CUST_CD_M                                                                   " & vbNewLine _
                                     & "AND MCD_NFC.SUB_KB       = '29'                                                                             " & vbNewLine _
                                     & "AND MCD_NFC.SYS_DEL_FLG  = '0'                                                                              " & vbNewLine _
                                     & " --要望番号1383 [LMC664] --- START ---                                                                      " & vbNewLine _
                                     & "         LEFT JOIN (SELECT NRS_BR_CD   AS NRS_BR_CD                                                         " & vbNewLine _
                                     & "                         , CUST_CD     AS CUST_CD                                                           " & vbNewLine _
                                     & "                         , CUST_CLASS  AS CUST_CLASS                                                        " & vbNewLine _
                                     & "                         , SET_NAIYO   AS CUST_NAIYO_1                                                      " & vbNewLine _
                                     & "                         , SET_NAIYO_2 AS CUST_NAIYO_2                                                      " & vbNewLine _
                                     & "                         , SET_NAIYO_3 AS CUST_NAIYO_3                                                      " & vbNewLine _
                                     & "                      FROM $LM_MST$..M_CUST_DETAILS                                                         " & vbNewLine _
                                     & "                     WHERE SUB_KB ='42'                                                                     " & vbNewLine _
                                     & "                       AND SET_NAIYO_2 = @RPT_ID                                                            " & vbNewLine _
                                     & "                       AND SYS_DEL_FLG = '0'                                                                " & vbNewLine _
                                     & "                    ) MCD_CUST                                                                              " & vbNewLine _
                                     & "                ON CST.NRS_BR_CD = MCD_CUST.NRS_BR_CD                                                       " & vbNewLine _
                                     & "               AND (CASE WHEN MCD_CUST.CUST_CLASS='00' THEN  CST.CUST_CD_L                                                   " & vbNewLine _
                                     & "                         WHEN MCD_CUST.CUST_CLASS='01' THEN (CST.CUST_CD_L + CST.CUST_CD_M)                                  " & vbNewLine _
                                     & "                         WHEN MCD_CUST.CUST_CLASS='02' THEN (CST.CUST_CD_L + CST.CUST_CD_M + CST.CUST_CD_S)                  " & vbNewLine _
                                     & "                         WHEN MCD_CUST.CUST_CLASS='03' THEN (CST.CUST_CD_L + CST.CUST_CD_M + CST.CUST_CD_S + CST.CUST_CD_SS) " & vbNewLine _
                                     & "                    END                                                                                     " & vbNewLine _
                                     & "                   ) = MCD_CUST.CUST_CD                                                                     " & vbNewLine _
                                     & " --要望番号1383 [LMC664] --- END ---                                                                        " & vbNewLine _
                                     & "--WHERE                                                                                                     " & vbNewLine _
                                     & "--    OUTL.SYS_DEL_FLG    = '0'                                                                             " & vbNewLine _
                                     & "--AND OUTL.NRS_BR_CD      = @NRS_BR_CD                                                                      " & vbNewLine _
                                     & "--AND OUTL.OUTKA_NO_L IN(@OUTKA_NO_L)                                                                       " & vbNewLine _
                                     & " WHERE OUTL.SYS_DEL_FLG     = '0'                                                                           " & vbNewLine _
                                     & "   AND OUTL.NRS_BR_CD       = @NRS_BR_CD                                                                    " & vbNewLine _
                                     & "   AND OUTL.CUST_CD_L       = @CUST_CD_L                                                                    " & vbNewLine _
                                     & "   AND OUTL.CUST_CD_M       = @CUST_CD_M                                                                    " & vbNewLine _
                                     & "   AND OUTL.OUTKA_PLAN_DATE = @OUTKA_PLAN_DATE                                                              " & vbNewLine _
                                     & "   AND OUTL.ARR_PLAN_DATE   = @ARR_PLAN_DATE                                                                " & vbNewLine _
                                     & "   AND FL.UNSO_CD           = @UNSO_CD                                                                      " & vbNewLine _
                                     & "   AND FL.UNSO_BR_CD        = @UNSO_BR_CD                                                                   " & vbNewLine _
                                     & "   AND OUTL.DEST_CD         = @DEST_CD                                                                      " & vbNewLine _
                                     & "   ) MAIN                                                                                                   " & vbNewLine

#If True Then       'ADD 2018/10/18 依頼番号 : 002601   【LMS】日医工_まとめ送状(選択)_送り状番号更新 ＋ オーダー番号最小の個数のみ送り状表示(千葉BC柴田) 

    ''' <summary>
    ''' データ抽出用FROM句浮間用(☆★作業用コメント：20120618)
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_FROM_MATOME_SELECT As String = "-- SQL_FROM_MATOME_SELECT                                                                      " & vbNewLine _
                                     & "FROM                                                                                                        " & vbNewLine _
                                     & "$LM_TRN$..C_OUTKA_L OUTL                                                                                    " & vbNewLine _
                                     & " LEFT JOIN (                                                                                                " & vbNewLine _
                                     & "            SELECT                                                                                          " & vbNewLine _
                                     & "                   EDIOUTL.NRS_BR_CD         AS NRS_BR_CD                                                   " & vbNewLine _
                                     & "                 , MIN(EDIOUTL.EDI_CTL_NO)   AS EDI_CTL_NO                                                  " & vbNewLine _
                                     & "                 , EDIOUTL.OUTKA_CTL_NO      AS OUTKA_CTL_NO                                                " & vbNewLine _
                                     & "              FROM $LM_TRN$..H_OUTKAEDI_L EDIOUTL                                                           " & vbNewLine _
                                     & "             WHERE EDIOUTL.SYS_DEL_FLG  = '0'                                                               " & vbNewLine _
                                     & "               AND EDIOUTL.NRS_BR_CD    = @NRS_BR_CD                                                        " & vbNewLine _
                                     & "               AND EDIOUTL.DEL_KB       = '0'                                                               " & vbNewLine _
                                     & "               AND LEN(EDIOUTL.OUTKA_CTL_NO) > 0                                                            " & vbNewLine _
                                     & "             GROUP BY                                                                                       " & vbNewLine _
                                     & "                   EDIOUTL.NRS_BR_CD                                                                        " & vbNewLine _
                                     & "                 , EDIOUTL.OUTKA_CTL_NO                                                                     " & vbNewLine _
                                     & "            ) TOPEDI                                                                                        " & vbNewLine _
                                     & "        ON TOPEDI.NRS_BR_CD    = OUTL.NRS_BR_CD                                                             " & vbNewLine _
                                     & "       AND TOPEDI.OUTKA_CTL_NO = OUTL.OUTKA_NO_L                                                            " & vbNewLine _
                                     & " LEFT JOIN $LM_TRN$..H_OUTKAEDI_L EDIL                                                                      " & vbNewLine _
                                     & "        ON EDIL.NRS_BR_CD  = TOPEDI.NRS_BR_CD                                                               " & vbNewLine _
                                     & "       AND EDIL.EDI_CTL_NO = TOPEDI.EDI_CTL_NO                                                              " & vbNewLine _
                                     & "--(2012.09.11)要望番号1412対応  ---  END  ---                                                               " & vbNewLine _
                                     & "--出荷M                                                                                                     " & vbNewLine _
                                     & "LEFT JOIN                                                                                                   " & vbNewLine _
                                     & "(SELECT                                                                                                     " & vbNewLine _
                                     & "*                                                                                                           " & vbNewLine _
                                     & "FROM                                                                                                        " & vbNewLine _
                                     & "(SELECT                                                                                                     " & vbNewLine _
                                     & "--(2012.06.18)要望番号1160対応 --- START ----                                                               " & vbNewLine _
                                     & "--   NRS_BR_CD                                                                                              " & vbNewLine _
                                     & "--  ,GOODS_CD_NRS                                                                                           " & vbNewLine _
                                     & "--  ,IRIME                                                                                                  " & vbNewLine _
                                     & "--  ,IRIME_UT                                                                                               " & vbNewLine _
                                     & "--  ,ALCTD_NB                                                                                               " & vbNewLine _
                                     & "--  ,LOT_NO                                                                                                 " & vbNewLine _
                                     & "--  ,CUST_ORD_NO_DTL   --2012/06/11浮間対応                                                                 " & vbNewLine _
                                     & "--  ,SYS_DEL_FLG                                                                                            " & vbNewLine _
                                     & "--  ,ROW_NUMBER() OVER (PARTITION BY NRS_BR_CD ORDER BY OUTKA_NO_L,OUTKA_NO_M) AS NUM                       " & vbNewLine _
                                     & "   M.NRS_BR_CD                                                                                              " & vbNewLine _
                                     & "  ,M.GOODS_CD_NRS                                                                                           " & vbNewLine _
                                     & "  ,M.IRIME                                                                                                  " & vbNewLine _
                                     & "  ,M.IRIME_UT                                                                                               " & vbNewLine _
                                     & "  ,M.ALCTD_NB                                                                                               " & vbNewLine _
                                     & "  ,M.ALCTD_QT                                                                                               " & vbNewLine _
                                     & "  ,M.LOT_NO                                                                                                 " & vbNewLine _
                                     & "  ,M.CUST_ORD_NO_DTL   --2012/06/11浮間対応                                                                 " & vbNewLine _
                                     & "  ,M.SYS_DEL_FLG                                                                                            " & vbNewLine _
                                     & "  ,ROW_NUMBER() OVER (PARTITION BY M.NRS_BR_CD ORDER BY M.OUTKA_NO_L,M.OUTKA_NO_M) AS NUM                   " & vbNewLine _
                                     & "  ,M.OUTKA_NO_L                                                                                             " & vbNewLine _
                                     & "  ,M.OUTKA_NO_M                                                                                             " & vbNewLine _
                                     & "  FROM                                                                                                      " & vbNewLine _
                                     & "--(2012.06.18)要望番号1160対応 ---  END  ----                                                               " & vbNewLine _
                                     & "   $LM_TRN$..C_OUTKA_M M                                                                                    " & vbNewLine _
                                     & "--(2012.06.18)要望番号1160対応 --- START ----                                                               " & vbNewLine _
                                     & "   LEFT JOIN $LM_TRN$..C_OUTKA_L OUTL                                                                       " & vbNewLine _
                                     & "          ON OUTL.NRS_BR_CD  = M.NRS_BR_CD                                                                  " & vbNewLine _
                                     & "         AND OUTL.OUTKA_NO_L = M.OUTKA_NO_L                                                                 " & vbNewLine _
                                     & "         AND OUTL.SYS_DEL_FLG  = '0'                                                                        " & vbNewLine _
                                     & "   LEFT JOIN $LM_TRN$..F_UNSO_L FL                                                                          " & vbNewLine _
                                     & "          ON FL.NRS_BR_CD    = M.NRS_BR_CD                                                                  " & vbNewLine _
                                     & "         AND FL.INOUTKA_NO_L = M.OUTKA_NO_L                                                                 " & vbNewLine _
                                     & "         AND FL.MOTO_DATA_KB = '20'                                                                         " & vbNewLine _
                                     & "         AND FL.SYS_DEL_FLG  = '0'                                                                          " & vbNewLine _
                                     & "--(2012.06.18)要望番号1160対応 ---  END  ----                                                               " & vbNewLine _
                                     & "  WHERE                                                                                                     " & vbNewLine _
                                     & "      M.NRS_BR_CD = @NRS_BR_CD                                                                              " & vbNewLine _
                                     & "--(2012.06.18)要望番号1160対応 --- START ----                                                               " & vbNewLine _
                                     & "    AND OUTL.CUST_CD_L       = @CUST_CD_L                                                                   " & vbNewLine _
                                     & "    AND OUTL.CUST_CD_M       = @CUST_CD_M                                                                   " & vbNewLine _
                                     & "    AND OUTL.OUTKA_PLAN_DATE = @OUTKA_PLAN_DATE                                                             " & vbNewLine _
                                     & "    AND OUTL.ARR_PLAN_DATE   = @ARR_PLAN_DATE                                                               " & vbNewLine _
                                     & "    AND FL.UNSO_CD           = @UNSO_CD                                                                     " & vbNewLine _
                                     & "    AND FL.UNSO_BR_CD        = @UNSO_BR_CD                                                                  " & vbNewLine _
                                     & "    AND OUTL.DEST_CD         = @DEST_CD                                                                     " & vbNewLine _
                                     & "--  AND M.OUTKA_NO_L IN(@OUTKA_NO_L)                                                                        " & vbNewLine _
                                     & "--  AND SYS_DEL_FLG = '0'                                                                                   " & vbNewLine _
                                     & "    AND M.SYS_DEL_FLG = '0'                                                                                 " & vbNewLine _
                                     & "--(2012.06.18)要望番号1160対応 ---  END  ----                                                               " & vbNewLine _
                                     & " ) AS BASE                                                                                                  " & vbNewLine _
                                     & "-- WHERE                                                                                                    " & vbNewLine _
                                     & "-- BASE.NUM = 1                                                                                             " & vbNewLine _
                                     & ") OUTM                                                                                                      " & vbNewLine _
                                     & "--ON                                                                                                        " & vbNewLine _
                                     & "--1 = 1                                                                                                     " & vbNewLine _
                                     & "--(2012.06.18)要望番号1160対応 --- START ----                                                               " & vbNewLine _
                                     & " ON OUTL.NRS_BR_CD  = OUTM.NRS_BR_CD                                                                        " & vbNewLine _
                                     & "AND OUTL.OUTKA_NO_L = OUTM.OUTKA_NO_L                                                                       " & vbNewLine _
                                     & "--(2012.06.18)要望番号1160対応 ---  END  ----                                                               " & vbNewLine _
                                     & "--F運送L                                                                                                    " & vbNewLine _
                                     & "LEFT JOIN $LM_TRN$..F_UNSO_L FL                                                                             " & vbNewLine _
                                     & "ON  FL.MOTO_DATA_KB   = '20'                                                                                " & vbNewLine _
                                     & "AND FL.NRS_BR_CD      = OUTL.NRS_BR_CD                                                                      " & vbNewLine _
                                     & "AND FL.INOUTKA_NO_L   = OUTL.OUTKA_NO_L                                                                     " & vbNewLine _
                                     & "AND FL.SYS_DEL_FLG    = '0'                                                                                 " & vbNewLine _
                                     & "--出荷EDI L                                                                                                 " & vbNewLine _
                                     & "--LEFT JOIN $LM_TRN$..H_OUTKAEDI_L OUTKAEDIL                                                                  " & vbNewLine _
                                     & "--ON  OUTKAEDIL.NRS_BR_CD     = OUTL.NRS_BR_CD                                                                " & vbNewLine _
                                     & "--AND OUTKAEDIL.OUTKA_CTL_NO  = OUTL.OUTKA_NO_L                                                               " & vbNewLine _
                                     & "--AND OUTKAEDIL.SYS_DEL_FLG   = '0'                                                                           " & vbNewLine _
                                     & "--商品M                                                                                                     " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_GOODS MG                                                                              " & vbNewLine _
                                     & "ON  MG.NRS_BR_CD     = OUTM.NRS_BR_CD                                                                       " & vbNewLine _
                                     & "AND MG.GOODS_CD_NRS  = OUTM.GOODS_CD_NRS                                                                    " & vbNewLine _
                                     & "AND MG.SYS_DEL_FLG   = '0'                                                                                  " & vbNewLine _
                                     & "--荷主なしでの運送会社荷主別送り状パターン取得                                                              " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_UNSO_CUST_RPT MCR1                                                                    " & vbNewLine _
                                     & "ON  FL.NRS_BR_CD     = MCR1.NRS_BR_CD                                                                       " & vbNewLine _
                                     & "AND FL.UNSO_CD       = MCR1.UNSOCO_CD                                                                       " & vbNewLine _
                                     & "AND FL.UNSO_BR_CD    = MCR1.UNSOCO_BR_CD                                                                    " & vbNewLine _
                                     & "AND '11'             = MCR1.PTN_ID                                                                          " & vbNewLine _
                                     & "AND FL.PC_KB         = MCR1.MOTO_TYAKU_KB                                                                   " & vbNewLine _
                                     & "AND ''               = MCR1.CUST_CD_L                                                                       " & vbNewLine _
                                     & "AND ''               = MCR1.CUST_CD_M                                                                       " & vbNewLine _
                                     & "AND MCR1.SYS_DEL_FLG = '0'                                                                                  " & vbNewLine _
                                     & "--帳票パターン取得                                                                                          " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_RPT MR1                                                                               " & vbNewLine _
                                     & "ON  MR1.NRS_BR_CD   = MCR1.NRS_BR_CD                                                                        " & vbNewLine _
                                     & "AND MR1.PTN_ID      = MCR1.PTN_ID                                                                           " & vbNewLine _
                                     & "AND MR1.PTN_CD      = MCR1.PTN_CD                                                                           " & vbNewLine _
                                     & "AND MR1.SYS_DEL_FLG = '0'                                                                                   " & vbNewLine _
                                     & "--荷主込みでの運送会社荷主別送り状パターン取得                                                              " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_UNSO_CUST_RPT MCR2                                                                    " & vbNewLine _
                                     & "ON  FL.NRS_BR_CD     = MCR2.NRS_BR_CD                                                                       " & vbNewLine _
                                     & "AND FL.UNSO_CD       = MCR2.UNSOCO_CD                                                                       " & vbNewLine _
                                     & "AND FL.UNSO_BR_CD    = MCR2.UNSOCO_BR_CD                                                                    " & vbNewLine _
                                     & "AND '11'             = MCR2.PTN_ID                                                                          " & vbNewLine _
                                     & "AND FL.PC_KB         = MCR2.MOTO_TYAKU_KB                                                                   " & vbNewLine _
                                     & "AND FL.CUST_CD_L     = MCR2.CUST_CD_L                                                                       " & vbNewLine _
                                     & "AND FL.CUST_CD_M     = MCR2.CUST_CD_M                                                                       " & vbNewLine _
                                     & "AND MCR2.SYS_DEL_FLG = '0'                                                                                  " & vbNewLine _
                                     & "--帳票パターン取得                                                                                          " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_RPT MR2                                                                               " & vbNewLine _
                                     & "ON  MR2.NRS_BR_CD    = MCR2.NRS_BR_CD                                                                       " & vbNewLine _
                                     & "AND MR2.PTN_ID       = MCR2.PTN_ID                                                                          " & vbNewLine _
                                     & "AND MR2.PTN_CD       = MCR2.PTN_CD                                                                          " & vbNewLine _
                                     & "AND MR2.SYS_DEL_FLG  = '0'                                                                                  " & vbNewLine _
                                     & "--存在しない場合の帳票パターン取得                                                                          " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_RPT MR3                                                                               " & vbNewLine _
                                     & "ON  MR3.NRS_BR_CD     = OUTL.NRS_BR_CD                                                                      " & vbNewLine _
                                     & "AND MR3.PTN_ID        = '11'                                                                                " & vbNewLine _
                                     & "AND MR3.STANDARD_FLAG = '01'                                                                                " & vbNewLine _
                                     & "AND MR3.SYS_DEL_FLG   = '0'                                                                                 " & vbNewLine _
                                     & "--荷主マスタ (ここからメインプリント用)                                                               " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_CUST CST                                                                              " & vbNewLine _
                                     & "ON  CST.NRS_BR_CD     = MG.NRS_BR_CD                                                                        " & vbNewLine _
                                     & "AND CST.CUST_CD_L     = MG.CUST_CD_L                                                                        " & vbNewLine _
                                     & "AND CST.CUST_CD_M     = MG.CUST_CD_M                                                                        " & vbNewLine _
                                     & "AND CST.CUST_CD_S     = MG.CUST_CD_S                                                                        " & vbNewLine _
                                     & "AND CST.CUST_CD_SS    = MG.CUST_CD_SS                                                                       " & vbNewLine _
                                     & "AND CST.SYS_DEL_FLG   = '0'                                                                                 " & vbNewLine _
                                     & "--届先マスタ                                                                                                " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_DEST DST                                                                              " & vbNewLine _
                                     & "ON  DST.NRS_BR_CD     = OUTL.NRS_BR_CD                                                                      " & vbNewLine _
                                     & "AND DST.CUST_CD_L     = OUTL.CUST_CD_L                                                                      " & vbNewLine _
                                     & "AND DST.DEST_CD       = OUTL.DEST_CD                                                                        " & vbNewLine _
                                     & "AND DST.SYS_DEL_FLG   = '0'                                                                                 " & vbNewLine _
                                     & "--届先マスタ                                                                                                " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_DEST SHIPDST                                                                          " & vbNewLine _
                                     & "ON  SHIPDST.NRS_BR_CD     = OUTL.NRS_BR_CD                                                                  " & vbNewLine _
                                     & "AND SHIPDST.CUST_CD_L     = OUTL.CUST_CD_L                                                                  " & vbNewLine _
                                     & "AND SHIPDST.DEST_CD       = OUTL.SHIP_CD_L                                                                  " & vbNewLine _
                                     & "AND SHIPDST.SYS_DEL_FLG   = '0'                                                                             " & vbNewLine _
                                     & "--2018/03/07 001033 20180131【LMS】横浜BC帳票住所がYCCになっている対応 Annen upd start                      " & vbNewLine _
                                     & "--倉庫マスタ                                                                                                " & vbNewLine _
                                     & "LEFT JOIN LM_MST..M_SOKO SOKO                                                                               " & vbNewLine _
                                     & "ON OUTL.NRS_BR_CD = SOKO.NRS_BR_CD                                                                          " & vbNewLine _
                                     & "AND OUTL.WH_CD = SOKO.WH_CD                                                                                 " & vbNewLine _
                                     & "AND SOKO.SYS_DEL_FLG = '0'                                                                                  " & vbNewLine _
                                     & "--営業所マスタ                                                                                              " & vbNewLine _
                                     & "--LEFT JOIN $LM_MST$..M_NRS_BR NB                                                                             " & vbNewLine _
                                     & "--ON  NB.NRS_BR_CD      = OUTL.NRS_BR_CD                                                                      " & vbNewLine _
                                     & "--AND NB.SYS_DEL_FLG    = '0'                                                                                 " & vbNewLine _
                                     & "--2018/03/07 001033 20180131【LMS】横浜BC帳票住所がYCCになっている対応 Annen upd end                        " & vbNewLine _
                                     & "--商品明細                                                                                                  " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_GOODS_DETAILS MGD                                                                     " & vbNewLine _
                                     & "ON  MGD.NRS_BR_CD       = OUTM.NRS_BR_CD                                                                    " & vbNewLine _
                                     & "AND MGD.GOODS_CD_NRS    = OUTM.GOODS_CD_NRS                                                                 " & vbNewLine _
                                     & "AND MGD.SUB_KB          = '01'                                                                              " & vbNewLine _
                                     & "AND MGD.SYS_DEL_FLG     = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC560支店TEL(NM4)・支店名(NM3))KB01                                                           " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB01                                                                              " & vbNewLine _
                                     & "ON  KB01.KBN_GROUP_CD = 'O007'                                                                              " & vbNewLine _
                                     & "AND KB01.KBN_CD       = '01'                                                                                " & vbNewLine _
                                     & "AND KB01.SYS_DEL_FLG  = '0'                                                                                 " & vbNewLine _
                                     & "--区分マスタ(納期文言)KB02                                                                                  " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB02                                                                              " & vbNewLine _
                                     & "ON  KB02.KBN_GROUP_CD = 'N010'                                                                              " & vbNewLine _
                                     & "AND KB02.KBN_CD       = OUTL.ARR_PLAN_TIME                                                                  " & vbNewLine _
                                     & "AND KB02.SYS_DEL_FLG  = '0'                                                                                 " & vbNewLine _
                                     & "--区分マスタ(LMC563支店名(NM3)、電話番号(NM4))KB03                                                          " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB03                                                                              " & vbNewLine _
                                     & "ON  KB03.KBN_GROUP_CD = 'O007'                                                                              " & vbNewLine _
                                     & "AND KB03.KBN_CD       = '10'                                                                                " & vbNewLine _
                                     & "AND KB03.SYS_DEL_FLG  = '0'                                                                                 " & vbNewLine _
                                     & "--区分マスタ(LMC563支払支店コード(NM3))KB0401                                                               " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0401                                                                            " & vbNewLine _
                                     & "ON  KB0401.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0401.KBN_CD       = '11'                                                                              " & vbNewLine _
                                     & "AND KB0401.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC563支払支店コード(NM3))KB0402                                                               " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0402                                                                            " & vbNewLine _
                                     & "ON  KB0402.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0402.KBN_CD       = '12'                                                                              " & vbNewLine _
                                     & "AND KB0402.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC563支払支店コード(NM3))KB0403                                                               " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0403                                                                            " & vbNewLine _
                                     & "ON  KB0403.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0403.KBN_CD       = '13'                                                                              " & vbNewLine _
                                     & "AND KB0403.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC563支払支店コード(NM3))KB0404                                                               " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0404                                                                            " & vbNewLine _
                                     & "ON  KB0404.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0404.KBN_CD       = '14'                                                                              " & vbNewLine _
                                     & "AND KB0404.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC563支払支店コード(NM3))KB0405                                                               " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0405                                                                            " & vbNewLine _
                                     & "ON  KB0405.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0405.KBN_CD       = '15'                                                                              " & vbNewLine _
                                     & "AND KB0405.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC564支店TEL、荷主TEL(NM4)・支店名(NM3))KB05                                                  " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB05                                                                              " & vbNewLine _
                                     & "ON  KB05.KBN_GROUP_CD   = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB05.KBN_CD         = '02'                                                                              " & vbNewLine _
                                     & "AND KB05.SYS_DEL_FLG    = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC565支払いコード(NM3)KB0601)                                                                 " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0601                                                                            " & vbNewLine _
                                     & "ON  KB0601.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0601.KBN_CD       = '07'                                                                              " & vbNewLine _
                                     & "AND KB0601.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC565支払いコード(NM3)KB0602)                                                                 " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0602                                                                            " & vbNewLine _
                                     & "ON  KB0602.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0602.KBN_CD       = '08'                                                                              " & vbNewLine _
                                     & "AND KB0602.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC568荷主コード(NM5)KB0701                                                                    " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0701                                                                            " & vbNewLine _
                                     & "ON  KB0701.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0701.KBN_CD       = '03'                                                                              " & vbNewLine _
                                     & "AND KB0701.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC568荷主コード(NM5)KB0702                                                                    " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0702                                                                            " & vbNewLine _
                                     & "ON  KB0702.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0702.KBN_CD       = '09'                                                                              " & vbNewLine _
                                     & "AND KB0702.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC569固定表示(NM1,3,4))KB08                                                                   " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB08                                                                              " & vbNewLine _
                                     & "ON  KB08.KBN_GROUP_CD   = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB08.KBN_CD         = '04'                                                                              " & vbNewLine _
                                     & "AND KB08.SYS_DEL_FLG    = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC570支店名(NM3)支店TEL(NM4))KB1001                                                           " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB1001                                                                            " & vbNewLine _
                                     & "ON  KB1001.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB1001.KBN_CD       = '05'                                                                              " & vbNewLine _
                                     & "AND KB1001.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC570支店名(NM3)支店TEL(NM4))KB1002                                                           " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB1002                                                                            " & vbNewLine _
                                     & "ON  KB1002.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB1002.KBN_CD       = '06'                                                                              " & vbNewLine _
                                     & "AND KB1002.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--荷主明細マスタ(LMC573にて運送契約荷主コード取得)                                                          " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_CUST_DETAILS CUSTDTL                                                                  " & vbNewLine _
                                     & "ON  CUSTDTL.NRS_BR_CD    = OUTL.NRS_BR_CD                                                                   " & vbNewLine _
                                     & "AND CUSTDTL.CUST_CD      = OUTL.CUST_CD_L + OUTL.CUST_CD_M                                                  " & vbNewLine _
                                     & "AND CUSTDTL.SUB_KB       = '03'                                                                             " & vbNewLine _
                                     & "AND CUSTDTL.SYS_DEL_FLG  = '0'                                                                              " & vbNewLine _
                                     & "--区分マスタ(LMC575支払コード(NM3)KB0801)                                                                   " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0801                                                                            " & vbNewLine _
                                     & "ON  KB0801.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0801.KBN_CD       = '16'                                                                              " & vbNewLine _
                                     & "AND KB0801.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC575支払コード(NM3)KB0802)                                                                   " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0802                                                                            " & vbNewLine _
                                     & "ON  KB0802.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0802.KBN_CD       = '17'                                                                              " & vbNewLine _
                                     & "AND KB0802.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC670 KB0803)                                                                                 " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0803                                                                            " & vbNewLine _
                                     & "ON  KB0803.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0803.KBN_CD       = '18'                                                                              " & vbNewLine _
                                     & "AND KB0803.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_DEST      DEST_JIS --2012.05.25                                                       " & vbNewLine _
                                     & "ON  DEST_JIS.NRS_BR_CD    = OUTL.NRS_BR_CD                                                                  " & vbNewLine _
                                     & "AND DEST_JIS.CUST_CD_L    = OUTL.CUST_CD_L                                                                  " & vbNewLine _
                                     & "AND DEST_JIS.DEST_CD      = OUTL.DEST_CD                                                                    " & vbNewLine _
                                     & "AND DEST_JIS.SYS_DEL_FLG  = '0'                                                                             " & vbNewLine _
                                     & "--JISマスタ(LMC661にてJIS_CD2桁：都道府県コード取得)2012.05.25                                              " & vbNewLine _
                                     & "  LEFT JOIN  $LM_MST$..M_JIS   JIS                                                                          " & vbNewLine _
                                     & "  ON  JIS.JIS_CD       = DEST_JIS.JIS                                                                       " & vbNewLine _
                                     & " AND  JIS.SYS_DEL_FLG  = '0'                                                                                " & vbNewLine _
                                     & "--運送会社マスタ(LMC589にてUNSOCO_NM：取次先運送会社名取得)2012.05.25                                       " & vbNewLine _
                                     & "--  LEFT JOIN  $LM_MST$..M_UNSOCO   MUC                                                                     " & vbNewLine _
                                     & "--  ON  MUC.NRS_BR_CD    = FL.NRS_BR_CD                                                                     " & vbNewLine _
                                     & "-- AND  MUC.UNSOCO_CD    = FL.UNSO_CD                                                                       " & vbNewLine _
                                     & "-- AND  MUC.UNSOCO_BR_CD = FL.UNSO_BR_CD                                                                    " & vbNewLine _
                                     & "-- AND  MUC.SYS_DEL_FLG  = '0'                                                                              " & vbNewLine _
                                     & "--荷主明細マスタ(LMC660にてSET_NAIYO：支払コード取得)2012.05.25                                             " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_CUST_DETAILS MCD_SAI                                                                  " & vbNewLine _
                                     & "ON  MCD_SAI.NRS_BR_CD    = OUTL.NRS_BR_CD                                                                   " & vbNewLine _
                                     & "AND MCD_SAI.CUST_CD      = OUTL.CUST_CD_L                                                                   " & vbNewLine _
                                     & "--AND MCD_SAI.CUST_CD_EDA  = OUTL.CUST_CD_M                                                                   " & vbNewLine _
                                     & "AND MCD_SAI.SUB_KB       = '27'                                                                             " & vbNewLine _
                                     & "AND MCD_SAI.SYS_DEL_FLG  = '0'                                                                              " & vbNewLine _
                                     & "--荷主明細マスタ(LMC669にてSET_NAIYO：荷送人名称取得)2012.06.01                                             " & vbNewLine _
                                     & "  LEFT JOIN $LM_MST$..M_CUST_DETAILS MCD_NFC                                                                " & vbNewLine _
                                     & "ON MCD_NFC.NRS_BR_CD   = OUTL.NRS_BR_CD                                                                     " & vbNewLine _
                                     & "AND MCD_NFC.CUST_CD      = OUTL.CUST_CD_L                                                                   " & vbNewLine _
                                     & "--AND MCD_NFC.CUST_CD_EDA  = OUTL.CUST_CD_M                                                                   " & vbNewLine _
                                     & "AND MCD_NFC.SUB_KB       = '29'                                                                             " & vbNewLine _
                                     & "AND MCD_NFC.SYS_DEL_FLG  = '0'                                                                              " & vbNewLine _
                                     & " --要望番号1383 [LMC664] --- START ---                                                                      " & vbNewLine _
                                     & "         LEFT JOIN (SELECT NRS_BR_CD   AS NRS_BR_CD                                                         " & vbNewLine _
                                     & "                         , CUST_CD     AS CUST_CD                                                           " & vbNewLine _
                                     & "                         , CUST_CLASS  AS CUST_CLASS                                                        " & vbNewLine _
                                     & "                         , SET_NAIYO   AS CUST_NAIYO_1                                                      " & vbNewLine _
                                     & "                         , SET_NAIYO_2 AS CUST_NAIYO_2                                                      " & vbNewLine _
                                     & "                         , SET_NAIYO_3 AS CUST_NAIYO_3                                                      " & vbNewLine _
                                     & "                      FROM $LM_MST$..M_CUST_DETAILS                                                         " & vbNewLine _
                                     & "                     WHERE SUB_KB ='42'                                                                     " & vbNewLine _
                                     & "                       AND SET_NAIYO_2 = @RPT_ID                                                            " & vbNewLine _
                                     & "                       AND SYS_DEL_FLG = '0'                                                                " & vbNewLine _
                                     & "                    ) MCD_CUST                                                                              " & vbNewLine _
                                     & "                ON CST.NRS_BR_CD = MCD_CUST.NRS_BR_CD                                                       " & vbNewLine _
                                     & "               AND (CASE WHEN MCD_CUST.CUST_CLASS='00' THEN  CST.CUST_CD_L                                                   " & vbNewLine _
                                     & "                         WHEN MCD_CUST.CUST_CLASS='01' THEN (CST.CUST_CD_L + CST.CUST_CD_M)                                  " & vbNewLine _
                                     & "                         WHEN MCD_CUST.CUST_CLASS='02' THEN (CST.CUST_CD_L + CST.CUST_CD_M + CST.CUST_CD_S)                  " & vbNewLine _
                                     & "                         WHEN MCD_CUST.CUST_CLASS='03' THEN (CST.CUST_CD_L + CST.CUST_CD_M + CST.CUST_CD_S + CST.CUST_CD_SS) " & vbNewLine _
                                     & "                    END                                                                                     " & vbNewLine _
                                     & "                   ) = MCD_CUST.CUST_CD                                                                     " & vbNewLine _
                                     & " --要望番号1383 [LMC664] --- END ---                                                                        " & vbNewLine _
                                     & "--WHERE                                                                                                     " & vbNewLine _
                                     & "--    OUTL.SYS_DEL_FLG    = '0'                                                                             " & vbNewLine _
                                     & "--AND OUTL.NRS_BR_CD      = @NRS_BR_CD                                                                      " & vbNewLine _
                                     & "--AND OUTL.OUTKA_NO_L IN(@OUTKA_NO_L)                                                                       " & vbNewLine _
                                     & " WHERE OUTL.SYS_DEL_FLG     = '0'                                                                           " & vbNewLine _
                                     & "   AND OUTL.NRS_BR_CD       = @NRS_BR_CD                                                                    " & vbNewLine _
                                     & "   AND OUTL.CUST_CD_L       = @CUST_CD_L                                                                    " & vbNewLine _
                                     & "   AND OUTL.CUST_CD_M       = @CUST_CD_M                                                                    " & vbNewLine _
                                     & "   AND OUTL.OUTKA_PLAN_DATE = @OUTKA_PLAN_DATE                                                              " & vbNewLine _
                                     & "   AND OUTL.ARR_PLAN_DATE   = @ARR_PLAN_DATE                                                                " & vbNewLine _
                                     & "   AND FL.UNSO_CD           = @UNSO_CD                                                                      " & vbNewLine _
                                     & "   AND FL.UNSO_BR_CD        = @UNSO_BR_CD                                                                   " & vbNewLine _
                                     & "   AND OUTL.DEST_CD         = @DEST_CD                                                                      " & vbNewLine 

    Private Const SQL_FROM_MATOME_SELECT2 As String = "-- SQL_FROM_MATOME_SELECT2                                                                   " & vbNewLine _
                                     & "   ) MAIN                                                                                                   " & vbNewLine

#End If

    ''' <summary>
    ''' データ抽出用FROM 浮間以外送り状　まとめ　20120618
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_GOURP_MATOME As String = "--SQL_GOURP_MATOME                                                                                  " & vbNewLine _
                                             & "GROUP BY                                                                                            " & vbNewLine _
                                             & " MAIN.RPT_ID                                                                                        " & vbNewLine _
                                             & ",MAIN.NRS_BR_CD                                                                                     " & vbNewLine _
                                             & ",MAIN.OUTKA_PLAN_DATE                                                                               " & vbNewLine _
                                             & "--,MAIN.OUTKA_NO_L                                                                                  " & vbNewLine _
                                             & ",MAIN.SHITEN_TEL_560_1                                                                              " & vbNewLine _
                                             & ",MAIN.SHITEN_NM_560_1                                                                               " & vbNewLine _
                                             & ",MAIN.ARR_PLAN_DATE                                                                                 " & vbNewLine _
                                             & ",MAIN.ARR_PLAN_TIME                                                                                 " & vbNewLine _
                                             & ",MAIN.DEST_TEL                                                                                      " & vbNewLine _
                                             & ",MAIN.CUST_TEL                                                                                      " & vbNewLine _
                                             & ",MAIN.CUST_AD_1                                                                                     " & vbNewLine _
                                             & ",MAIN.CUST_AD_2                                                                                     " & vbNewLine _
                                             & ",MAIN.DEST_AD_1                                                                                     " & vbNewLine _
                                             & ",MAIN.CUST_AD_3                                                                                     " & vbNewLine _
                                             & ",MAIN.DEST_AD_2                                                                                     " & vbNewLine _
                                             & ",MAIN.DEST_AD_3                                                                                     " & vbNewLine _
                                             & ",MAIN.BETU_WT                                                                                       " & vbNewLine _
                                             & ",MAIN.DEST_NM_1                                                                                     " & vbNewLine _
                                             & ",MAIN.CUST_NM_L                                                                                     " & vbNewLine _
                                             & ",MAIN.DEST_ZIP                                                                                      " & vbNewLine _
                                             & ",MAIN.UNSO_WT                                                                                       " & vbNewLine _
                                             & ",MAIN.UNSO_PKG_NB                                                                                   " & vbNewLine _
                                             & ",MAIN.CUST_NM_M                                                                                     " & vbNewLine _
                                             & ",MAIN.NRS_BR_NM                                                                                     " & vbNewLine _
                                             & "--,MAIN.DEST_HOSOKU                                                                                 " & vbNewLine _
                                             & ",MAIN.NRS_AD_1                                                                                      " & vbNewLine _
                                             & ",MAIN.NRS_AD_2                                                                                      " & vbNewLine _
                                             & ",MAIN.NRS_TEL                                                                                       " & vbNewLine _
                                             & ",MAIN.CUST_CD_L                                                                                     " & vbNewLine _
                                             & "--,MAIN.UNSO_L_REMARK                                                                               " & vbNewLine _
                                             & "--,MAIN.OUTKA_L_REMARK                                                                              " & vbNewLine _
                                             & "--,MAIN.GOODS_NM_1                                                                                  " & vbNewLine _
                                             & ",MAIN.OUTKA_ATT                                                                                     " & vbNewLine _
                                             & ",MAIN.BUYER_ORD_NO                                                                                  " & vbNewLine _
                                             & ",MAIN.YELLOW_NO                                                                                     " & vbNewLine _
                                             & ",MAIN.SHIHARAI_SHITEN_NM_563_1                                                                      " & vbNewLine _
                                             & ",MAIN.SHIHARAI_SHITEN_CD_563_1                                                                      " & vbNewLine _
                                             & ",MAIN.SHIHARAI_SHITEN_TEL_563_1                                                                     " & vbNewLine _
                                             & ",MAIN.SHITEN_TEL_1_564_1                                                                            " & vbNewLine _
                                             & ",MAIN.SHITEN_NM_564_1                                                                               " & vbNewLine _
                                             & ",MAIN.SHITEN_TEL_2_564_1                                                                            " & vbNewLine _
                                             & ",MAIN.NRS_BR_AD_1                                                                                   " & vbNewLine _
                                             & ",MAIN.NRS_BR_AD_2                                                                                   " & vbNewLine _
                                             & ",MAIN.NRS_BR_NM_1                                                                                   " & vbNewLine _
                                             & ",MAIN.DEST_NM                                                                                       " & vbNewLine _
                                             & ",MAIN.AD_1                                                                                          " & vbNewLine _
                                             & ",MAIN.AD_2                                                                                          " & vbNewLine _
                                             & ",MAIN.AD_3                                                                                          " & vbNewLine _
                                             & ",MAIN.TEL                                                                                           " & vbNewLine _
                                             & ",MAIN.DEST_CD                                                                                       " & vbNewLine _
                                             & ",MAIN.SHIP_CD_L                                                                                     " & vbNewLine _
                                             & ",MAIN.SHIHARAI_CD_565_1                                                                             " & vbNewLine _
                                             & ",MAIN.SHIHARAI_CD_565_2                                                                             " & vbNewLine _
                                             & ",MAIN.NRS_FAX                                                                                       " & vbNewLine _
                                             & ",MAIN.NRS_AD_3                                                                                      " & vbNewLine _
                                             & "--,MAIN.CUST_ORD_NO                                                                                 " & vbNewLine _
                                             & ",MAIN.SHOBO_CD                                                                                      " & vbNewLine _
                                             & ",MAIN.CUST_CD_L_568_1                                                                               " & vbNewLine _
                                             & ",MAIN.CUST_CD_L_568_2                                                                               " & vbNewLine _
                                             & ",MAIN.NRS_BR_ZIP                                                                                    " & vbNewLine _
                                             & ",MAIN.NRS_BR_TEL                                                                                    " & vbNewLine _
                                             & ",MAIN.KOTEI_1                                                                                       " & vbNewLine _
                                             & ",MAIN.KOTEI_2                                                                                       " & vbNewLine _
                                             & ",MAIN.KOTEI_3                                                                                       " & vbNewLine _
                                             & ",MAIN.NB_UT                                                                                         " & vbNewLine _
                                             & ",MAIN.DENPYO_NM                                                                                     " & vbNewLine _
                                             & ",MAIN.SHITEN_NM_570_1                                                                               " & vbNewLine _
                                             & ",MAIN.SHITEN_TEL_570_1                                                                              " & vbNewLine _
                                             & ",MAIN.SHITEN_NM_570_2                                                                               " & vbNewLine _
                                             & ",MAIN.SHITEN_TEL_570_2                                                                              " & vbNewLine _
                                             & ",MAIN.OUTKA_PKG_NB                                                                                  " & vbNewLine _
                                             & ",MAIN.IRIME                                                                                         " & vbNewLine _
                                             & ",MAIN.IRIME_UT                                                                                      " & vbNewLine _
                                             & ",MAIN.ALCTD_NB                                                                                      " & vbNewLine _
                                             & "--,MAIN.LOT_NO                                                                                      " & vbNewLine _
                                             & ",MAIN.SHIP_NM_L                                                                                     " & vbNewLine _
                                             & ",MAIN.UNSO_CUST_CD                                                                                  " & vbNewLine _
                                             & ",MAIN.SHIHARAI_CD_575_1                                                                             " & vbNewLine _
                                             & ",MAIN.SHIHARAI_CD_575_2                                                                             " & vbNewLine _
                                             & ",MAIN.KBN_CUST_ZIP                                                                                  " & vbNewLine _
                                             & ",MAIN.KBN_CUST_AD                                                                                   " & vbNewLine _
                                             & ",MAIN.KBN_CUST_TEL                                                                                  " & vbNewLine _
                                             & ",MAIN.KBN_CUST_NM                                                                                   " & vbNewLine _
                                             & ",MAIN.OUTKO_DATE                                                                                    " & vbNewLine _
                                             & ",MAIN.ALCTD_WT                                                                                      " & vbNewLine _
                                             & ",MAIN.BUKA_CD                                                                                       " & vbNewLine _
                                             & ",MAIN.ATSUKAISYA_NM                                                                                 " & vbNewLine _
                                             & "--,MAIN.GOODS_CD_CUST                                                                               " & vbNewLine _
                                             & ",MAIN.PREF_CD                                                                                       " & vbNewLine _
                                             & ",MAIN.TORI_UNSOCO_NM                                                                                " & vbNewLine _
                                             & ",MAIN.SAI_SHIHARAI_CD                                                                               " & vbNewLine _
                                             & ",MAIN.SET_NM_L                                                                                      " & vbNewLine _
                                             & ",MAIN.NAIYO1                                                                                        " & vbNewLine _
                                             & ",MAIN.NAIYO2                                                                                        " & vbNewLine _
                                             & ",MAIN.NAIYO3                                                                                        " & vbNewLine _
                                             & ",MAIN.NAIYO_CUST_NM                                                                                 " & vbNewLine _
                                             & "--,MAIN.CUST_ORD_NO_DTL                                                                             " & vbNewLine _
                                             & ",MAIN.REMARK_DEST                                                                                   " & vbNewLine _
                                             & "--要望番号1383 [LMC664] --- START ---                                                               " & vbNewLine _
                                             & ",MAIN.CUST_FLG                                                                                      " & vbNewLine _
                                             & "--要望番号1383 [LMC664] --- END ---                                                                 " & vbNewLine _
                                             & ",MAIN.AUTO_DENP_NO          -- ADD 2016/08/29 要望番号:2615                                         " & vbNewLine

    ''' <summary>
    ''' 浮間以外用まとめ送り状ORDER BY（①出荷管理番号L)）20120618
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_ORDER_BY_MATOME As String = "--SQL_ORDER_BY_MATOME                                                                      " & vbNewLine _
                                         & "     ORDER BY                                                                                     " & vbNewLine _
                                         & "     MAIN.NRS_BR_CD                                                                               " & vbNewLine _
                                         & "     ,MIN(OUTKA_NO_L)                                                                             " & vbNewLine

#Region "maruwa"
    ''' <summary>
    ''' 印刷データ抽出用(九州・丸和バイオ)
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_MARUWA_SELECT_DATA As String = "  --SQL_SELECT_DATA                                                                                  " & vbNewLine _
                                            & " SELECT                                                                                               " & vbNewLine _
                                            & " CASE WHEN MR2.PTN_CD IS NOT NULL THEN MR2.RPT_ID                                                    " & vbNewLine _
                                            & "      WHEN MR1.PTN_CD IS NOT NULL THEN MR1.RPT_ID                                                    " & vbNewLine _
                                            & "      ELSE '' END            AS RPT_ID                                                               " & vbNewLine _
                                            & ",OUTL.NRS_BR_CD              AS NRS_BR_CD                                                            " & vbNewLine _
                                            & "--このあたりから要修正の可能性                                                                       " & vbNewLine _
                                            & "--LMC560                                                                                             " & vbNewLine _
                                            & ",OUTL.OUTKA_PLAN_DATE        AS OUTKA_PLAN_DATE                                                      " & vbNewLine _
                                            & ",OUTL.OUTKA_NO_L             AS OUTKA_NO_L                                                           " & vbNewLine _
                                            & ",KB01.KBN_NM4                AS SHITEN_TEL_560_1                                                     " & vbNewLine _
                                            & ",KB01.KBN_NM3                AS SHITEN_NM_560_1                                                      " & vbNewLine _
                                            & ",OUTL.ARR_PLAN_DATE          AS ARR_PLAN_DATE                                                        " & vbNewLine _
                                            & ",KB02.KBN_NM1                AS ARR_PLAN_TIME                                                        " & vbNewLine _
                                            & ",OUTL.DEST_TEL               AS DEST_TEL                                                             " & vbNewLine _
                                            & ",CST.TEL                     AS CUST_TEL                                                             " & vbNewLine _
                                            & ",CST.AD_1                    AS CUST_AD_1                                                            " & vbNewLine _
                                            & ",CST.AD_2                    AS CUST_AD_2                                                            " & vbNewLine _
                                            & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_AD_1                                                   " & vbNewLine _
                                            & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_AD_1                                                   " & vbNewLine _
                                            & "      ELSE DST.AD_1                                                                                  " & vbNewLine _
                                            & " END                         AS DEST_AD_1                                                            " & vbNewLine _
                                            & ",CST.AD_3                    AS CUST_AD_3                                                            " & vbNewLine _
                                            & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_AD_2                                                   " & vbNewLine _
                                            & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_AD_2                                                   " & vbNewLine _
                                            & "      ELSE DST.AD_2                                                                                  " & vbNewLine _
                                            & " END                         AS DEST_AD_2                                                            " & vbNewLine _
                                            & ",OUTL.DEST_AD_3              AS DEST_AD_3                                                            " & vbNewLine _
                                            & ",FL.UNSO_WT                  AS BETU_WT                                                              " & vbNewLine _
                                            & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_NM                                                     " & vbNewLine _
                                            & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_NM                                                     " & vbNewLine _
                                            & "      ELSE DST.DEST_NM                                                                               " & vbNewLine _
                                            & " END                         AS DEST_NM_1                                                            " & vbNewLine _
                                            & ",CST.CUST_NM_L               AS CUST_NM_L                                                            " & vbNewLine _
                                            & "--LMC561                                                                                             " & vbNewLine _
                                            & ",CASE WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_ZIP                                                    " & vbNewLine _
                                            & "      ELSE DST.ZIP                                                                                   " & vbNewLine _
                                            & " END                         AS DEST_ZIP                                                             " & vbNewLine _
                                            & "--LMC562                                                                                             " & vbNewLine _
                                            & "--,(OUTS.BETU_WT * OUTS.ALCTD_NB) AS UNSO_WT                                                         " & vbNewLine _
                                            & ",(SELECT                                                                                             " & vbNewLine _
                                            & "SUM (UNSO_WT.UNSO_WT) FROM                                                                           " & vbNewLine _
                                            & "(SELECT                                                                                              " & vbNewLine _
                                            & "--	SUM(OUTS.BETU_WT * OUTS.ALCTD_NB) AS UNSO_WT                                                        " & vbNewLine _
                                            & "	SUM(OUTS.ALCTD_QT * MG.STD_WT_KGS / MG.STD_IRIME_NB) AS UNSO_WT                                     " & vbNewLine _
                                            & "	FROM                                                                                                " & vbNewLine _
                                            & "	$LM_TRN$..C_OUTKA_L OUTL                                                                            " & vbNewLine _
                                            & "	LEFT JOIN                                                                                           " & vbNewLine _
                                            & "	$LM_TRN$..C_OUTKA_M OUTM                                                                            " & vbNewLine _
                                            & "	  ON OUTL.NRS_BR_CD   = OUTM.NRS_BR_CD                                                              " & vbNewLine _
                                            & "	 AND OUTL.OUTKA_NO_L  = OUTM.OUTKA_NO_L                                                             " & vbNewLine _
                                            & "	 AND OUTM.SYS_DEL_FLG = '0'                                                                         " & vbNewLine _
                                            & "	LEFT JOIN                                                                                           " & vbNewLine _
                                            & "	$LM_TRN$..C_OUTKA_S OUTS                                                                            " & vbNewLine _
                                            & "	  ON OUTL.NRS_BR_CD   = OUTS.NRS_BR_CD                                                              " & vbNewLine _
                                            & "	 AND OUTL.OUTKA_NO_L  = OUTS.OUTKA_NO_L                                                             " & vbNewLine _
                                            & "	 AND OUTM.OUTKA_NO_M  = OUTS.OUTKA_NO_M                                                             " & vbNewLine _
                                            & "	 AND OUTS.SYS_DEL_FLG = '0'                                                                         " & vbNewLine _
                                            & "	LEFT JOIN                                                                                           " & vbNewLine _
                                            & "	$LM_MST$..M_GOODS MG                                                                            " & vbNewLine _
                                            & "	  ON OUTM.NRS_BR_CD   = MG.NRS_BR_CD                                                              " & vbNewLine _
                                            & "	 AND OUTM.GOODS_CD_NRS  = MG.GOODS_CD_NRS                                                             " & vbNewLine _
                                            & "	WHERE                                                                                               " & vbNewLine _
                                            & "	    OUTL.SYS_DEL_FLG  = '0'                                                                         " & vbNewLine _
                                            & "	AND OUTL.NRS_BR_CD    = @NRS_BR_CD                                                                  " & vbNewLine _
                                            & "	AND OUTL.OUTKA_NO_L   = @OUTKA_NO_L                                                                 " & vbNewLine _
                                            & "	GROUP BY                                                                                            " & vbNewLine _
                                            & "	 OUTS.BETU_WT                                                                                       " & vbNewLine _
                                            & "	,OUTS.ALCTD_NB                                                                                      " & vbNewLine _
                                            & "	,OUTL.NRS_BR_CD                                                                                     " & vbNewLine _
                                            & "	,OUTL.OUTKA_NO_L                                                                                    " & vbNewLine _
                                            & "	)  UNSO_WT                                                                                          " & vbNewLine _
                                            & "	)  UNSO_WT                                                                                          " & vbNewLine _
                                            & ",FL.UNSO_PKG_NB              AS UNSO_PKG_NB                                                          " & vbNewLine _
                                            & ",CST.CUST_NM_M               AS CUST_NM_M                                                            " & vbNewLine _
                                            & "--LMC563                                                                                             " & vbNewLine _
                                            & ",NB.NRS_BR_NM                AS NRS_BR_NM                                                            " & vbNewLine _
                                            & ",EDIL.FREE_C15               AS DEST_HOSOKU                                                          " & vbNewLine _
                                            & ",NB.AD_1                     AS NRS_AD_1                                                             " & vbNewLine _
                                            & ",NB.AD_2                     AS NRS_AD_2                                                             " & vbNewLine _
                                            & ",NB.TEL                      AS NRS_TEL                                                              " & vbNewLine _
                                            & ",CST.CUST_CD_L               AS CUST_CD_L                                                            " & vbNewLine _
                                            & ",FL.REMARK                   AS UNSO_L_REMARK                                                        " & vbNewLine _
                                            & ",OUTL.REMARK                 AS OUTKA_L_REMARK                                                       " & vbNewLine _
                                            & ",MG.GOODS_NM_1               AS GOODS_NM_1                                                           " & vbNewLine _
                                            & ",MG.OUTKA_ATT                AS OUTKA_ATT                                                            " & vbNewLine _
                                            & ",OUTL.BUYER_ORD_NO           AS BUYER_ORD_NO                                                         " & vbNewLine _
                                            & ",CASE WHEN OUTL.NRS_BR_CD = '50' THEN                                                                " & vbNewLine _
                                            & "      (                                                                                              " & vbNewLine _
                                            & "       CASE WHEN OUTL.CUST_CD_L = '20000' THEN MGD.SET_NAIYO                                         " & vbNewLine _
                                            & "             ELSE ''                                                                                 " & vbNewLine _
                                            & "       END                                                                                           " & vbNewLine _
                                            & "      )                                                                                              " & vbNewLine _
                                            & "      ELSE ''                                                                                        " & vbNewLine _
                                            & " END                         AS YELLOW_NO                                                            " & vbNewLine _
                                            & ",KB03.KBN_NM3                AS SHIHARAI_SHITEN_NM_563_1                                             " & vbNewLine _
                                            & ",CASE WHEN OUTL.NRS_BR_CD = '50' THEN                                                                " & vbNewLine _
                                            & "       (                                                                                             " & vbNewLine _
                                            & "         CASE WHEN OUTL.CUST_CD_L = '00007' THEN KB0401.KBN_NM3                                      " & vbNewLine _
                                            & "              WHEN OUTL.CUST_CD_L = '20000' THEN KB0402.KBN_NM3                                      " & vbNewLine _
                                            & "              WHEN OUTL.CUST_CD_L = '00950' THEN                                                     " & vbNewLine _
                                            & "                   (                                                                                 " & vbNewLine _
                                            & "                    CASE WHEN MG.SEARCH_KEY_1 = 'A0020' THEN KB0403.KBN_NM3                          " & vbNewLine _
                                            & "                         WHEN MG.SEARCH_KEY_1 = 'A0021' THEN KB0403.KBN_NM3                          " & vbNewLine _
                                            & "                         ELSE KB0404.KBN_NM3                                                         " & vbNewLine _
                                            & "                    END                                                                              " & vbNewLine _
                                            & "                   )                                                                                 " & vbNewLine _
                                            & "              ELSE KB0405.KBN_NM3                                                                    " & vbNewLine _
                                            & "         END                                                                                         " & vbNewLine _
                                            & "       )                                                                                             " & vbNewLine _
                                            & "      ELSE ''                                                                                        " & vbNewLine _
                                            & "END                          AS SHIHARAI_SHITEN_CD_563_1                                             " & vbNewLine _
                                            & ",KB03.KBN_NM4                AS SHIHARAI_SHITEN_TEL_563_1                                            " & vbNewLine _
                                            & "--LMC564                                                                                             " & vbNewLine _
                                            & ",KB05.KBN_NM4                AS SHITEN_TEL_1_564_1                                                   " & vbNewLine _
                                            & ",KB05.KBN_NM3                AS SHITEN_NM_564_1                                                      " & vbNewLine _
                                            & ",KB05.KBN_NM4                AS SHITEN_TEL_2_564_1                                                   " & vbNewLine _
                                            & ",NB.AD_1                     AS NRS_BR_AD_1                                                          " & vbNewLine _
                                            & ",NB.AD_2                     AS NRS_BR_AD_2                                                          " & vbNewLine _
                                            & ",NB.NRS_BR_NM                AS NRS_BR_NM_1                                                          " & vbNewLine _
                                            & "--LMC565                                                                                             " & vbNewLine _
                                            & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_NM                                                     " & vbNewLine _
                                            & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_NM                                                     " & vbNewLine _
                                            & "      ELSE DST.DEST_NM                                                                               " & vbNewLine _
                                            & " END                         AS DEST_NM                                                              " & vbNewLine _
                                            & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_AD_1                                                   " & vbNewLine _
                                            & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_AD_1                                                   " & vbNewLine _
                                            & "      ELSE DST.AD_1                                                                                  " & vbNewLine _
                                            & " END                         AS AD_1                                                                 " & vbNewLine _
                                            & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_AD_2                                                   " & vbNewLine _
                                            & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_AD_2                                                   " & vbNewLine _
                                            & "      ELSE DST.AD_2                                                                                  " & vbNewLine _
                                            & " END                         AS AD_2                                                                 " & vbNewLine _
                                            & ",OUTL.DEST_AD_3              AS AD_3                                                                 " & vbNewLine _
                                            & ",OUTL.DEST_TEL               AS TEL                                                                  " & vbNewLine _
                                            & ",OUTL.DEST_CD                AS DEST_CD                                                              " & vbNewLine _
                                            & ",OUTL.SHIP_CD_L              AS SHIP_CD_L                                                            " & vbNewLine _
                                            & ",KB0601.KBN_NM4              AS SHIHARAI_CD_565_1                                                    " & vbNewLine _
                                            & ",KB0602.KBN_NM4              AS SHIHARAI_CD_565_2                                                    " & vbNewLine _
                                            & "--LMC566                                                                                             " & vbNewLine _
                                            & ",NB.FAX                      AS NRS_FAX                                                              " & vbNewLine _
                                            & "--LMC567                                                                                             " & vbNewLine _
                                            & ",NB.AD_3                     AS NRS_AD_3                                                             " & vbNewLine _
                                            & "--LMC568                                                                                             " & vbNewLine _
                                            & ",OUTL.CUST_ORD_NO            AS CUST_ORD_NO                                                          " & vbNewLine _
                                            & ",MG.SHOBO_CD                 AS SHOBO_CD                                                             " & vbNewLine _
                                            & ",KB0701.KBN_NM5              AS CUST_CD_L_568_1                                                      " & vbNewLine _
                                            & ",KB0702.KBN_NM5              AS CUST_CD_L_568_2                                                      " & vbNewLine _
                                            & "--LMC569                                                                                             " & vbNewLine _
                                            & ",NB.ZIP                      AS NRS_BR_ZIP                                                           " & vbNewLine _
                                            & ",NB.TEL                      AS NRS_BR_TEL                                                           " & vbNewLine _
                                            & ",KB08.KBN_NM1                AS KOTEI_1                                                              " & vbNewLine _
                                            & ",KB08.KBN_NM3                AS KOTEI_2                                                              " & vbNewLine _
                                            & ",KB08.KBN_NM5                AS KOTEI_3                                                              " & vbNewLine _
                                            & "--LMC570                                                                                             " & vbNewLine _
                                            & ",FL.NB_UT                    AS NB_UT                                                                " & vbNewLine _
                                            & ",CST.DENPYO_NM               AS DENPYO_NM                                                            " & vbNewLine _
                                            & ",KB1001.KBN_NM3              AS SHITEN_NM_570_1                                                      " & vbNewLine _
                                            & ",KB1001.KBN_NM4              AS SHITEN_TEL_570_1                                                     " & vbNewLine _
                                            & ",KB1002.KBN_NM3              AS SHITEN_NM_570_2                                                      " & vbNewLine _
                                            & ",KB1002.KBN_NM4              AS SHITEN_TEL_570_2                                                     " & vbNewLine _
                                            & "--LMC572                                                                                             " & vbNewLine _
                                            & ",OUTL.OUTKA_PKG_NB           AS OUTKA_PKG_NB                                                         " & vbNewLine _
                                            & ",OUTM.IRIME                  AS IRIME                                                                " & vbNewLine _
                                            & ",OUTM.IRIME_UT               AS IRIME_UT                                                             " & vbNewLine _
                                            & ",OUTM.ALCTD_NB               AS ALCTD_NB                                                             " & vbNewLine _
                                            & ",OUTM.LOT_NO                 AS LOT_NO                                                               " & vbNewLine _
                                            & ",SHIPDST.DEST_NM             AS SHIP_NM_L                                                            " & vbNewLine _
                                            & ",CUSTDTL.SET_NAIYO           AS UNSO_CUST_CD                                                         " & vbNewLine _
                                            & ",KB0801.KBN_NM3              AS SHIHARAI_CD_575_1                                                    " & vbNewLine _
                                            & ",KB0802.KBN_NM3              AS SHIHARAI_CD_575_2                                                    " & vbNewLine _
                                            & "--LMC670                                                                                             " & vbNewLine _
                                            & ",KB0803.KBN_NM1              AS KBN_CUST_ZIP                                                         " & vbNewLine _
                                            & ",KB0803.KBN_NM2              AS KBN_CUST_AD                                                          " & vbNewLine _
                                            & ",KB0803.KBN_NM3              AS KBN_CUST_TEL                                                         " & vbNewLine _
                                            & ",KB0803.KBN_NM4              AS KBN_CUST_NM                                                          " & vbNewLine _
                                            & ",KB0806.KBN_NM1              AS QT_UT_NM                                                          " & vbNewLine _
                                            & ",OUTL.OUTKO_DATE             AS OUTKO_DATE                                                           " & vbNewLine _
                                            & ",(MG.STD_WT_KGS * OUTM.ALCTD_NB) AS ALCTD_WT                                                         " & vbNewLine _
                                            & "--,OUTKAEDIL.FREE_C05          AS BUKA_CD                                                            " & vbNewLine _
                                            & ",EDIL.FREE_C05          AS BUKA_CD                                                                   " & vbNewLine _
                                            & ",CASE WHEN SHIPDST.DEST_NM <> ''                                                                     " & vbNewLine _
                                            & "           AND SHIPDST.DEST_NM IS NOT NULL THEN SHIPDST.DEST_NM                                      " & vbNewLine _
                                            & "      WHEN CST.DENPYO_NM   <> ''                                                                     " & vbNewLine _
                                            & "           AND CST.DENPYO_NM IS NOT NULL   THEN CST.DENPYO_NM                                        " & vbNewLine _
                                            & "      ELSE CST.CUST_NM_L                                                                             " & vbNewLine _
                                            & " END                         AS ATSUKAISYA_NM                                                        " & vbNewLine _
                                            & " ,MG.GOODS_CD_CUST           AS GOODS_CD_CUST                 --2012.05.25                           " & vbNewLine _
                                            & " ,LEFT(JIS.JIS_CD,2)         AS PREF_CD                       --2012.05.25                           " & vbNewLine _
                                            & ",CASE WHEN LEFT(JIS.JIS_CD,2) ='16' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '17' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '18' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '21' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '25'                  --ここまで飛騨運輸のエリア                      " & vbNewLine _
                                            & "          THEN '飛騨運輸'                                                                            " & vbNewLine _
                                            & "     WHEN LEFT(JIS.JIS_CD,2) = '24' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '29' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '30' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '47'                  --ここまで近鉄運輸のエリア                      " & vbNewLine _
                                            & "         THEN '近鉄運輸'                                                                             " & vbNewLine _
                                            & "    WHEN  LEFT(JIS.JIS_CD,2) = '26' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '28' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '31' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '32' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '33' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '34' OR                                                               " & vbNewLine _
                                            & "       LEFT(JIS.JIS_CD,2) = '35' OR                                                                  " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '36' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '37' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '38' OR                                                               " & vbNewLine _
                                            & "          LEFT(JIS.JIS_CD,2) = '39'                                                                  " & vbNewLine _
                                            & "          THEN '岡山県貨物'                                                                          " & vbNewLine _
                                            & "          ELSE    '' END            AS TORI_UNSOCO_NM                                                " & vbNewLine _
                                            & "     --THEN MUC.UNSOCO_NM   END                                                                      " & vbNewLine _
                                            & "    --                              AS TORI_UNSOCO_NM                                                " & vbNewLine _
                                            & " --,MUC.UNSOCO_NM              AS TORI_UNSOCO_NM                --2012.05.25                         " & vbNewLine _
                                            & " ,MCD_SAI.SET_NAIYO          AS SAI_SHIHARAI_CD               --2012.05.25                           " & vbNewLine _
                                            & " ,MCD_SAI.SET_NAIYO_3        AS SET_NM_L                      --2012.05.29                           " & vbNewLine _
                                            & " ,MCD_NFC.SET_NAIYO          AS NAIYO1                        --2012.06.01                           " & vbNewLine _
                                            & " ,MCD_NFC.SET_NAIYO_2        AS NAIYO2                        --2012.06.01                           " & vbNewLine _
                                            & " ,MCD_NFC.SET_NAIYO_3        AS NAIYO3                        --2012.06.01                           " & vbNewLine _
                                            & " ,MCD_SAI.SET_NAIYO_2        AS NAIYO_CUST_NM                 --2012.06.04                           " & vbNewLine _
                                            & " ,OUTM.CUST_ORD_NO_DTL      AS CUST_ORD_NO_DTL              --2012.06.11                             " & vbNewLine _
                                            & " --2012.07.24 丸和運輸　荷受人氏名下の注意書き(REMARK)開始                                           " & vbNewLine _
                                            & " ,CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.REMARK                                                     " & vbNewLine _
                                            & "       WHEN OUTL.DEST_KB = '02' THEN EDIL.REMARK                                                     " & vbNewLine _
                                            & "       ELSE DST.REMARK                                                                               " & vbNewLine _
                                            & "  END                         AS REMARK_DEST                                                         " & vbNewLine _
                                            & " --2012.07.24 丸和運輸　荷受人氏名下の注意書き(REMARK)終了                                           " & vbNewLine _
                                            & " --要望番号1383 [LMC664] --- START ---                                                               " & vbNewLine _
                                            & " ,ISNULL(MCD_CUST.CUST_NAIYO_1,'') AS CUST_FLG                                                       " & vbNewLine _
                                            & " --要望番号1383 [LMC664] --- END ---                                                                 " & vbNewLine _
                                            & " --20150716 adachi                                                                                   " & vbNewLine _
                                            & " ,MG.GOODS_NM_2               AS GOODS_NM_2                                                          " & vbNewLine _
                                            & " ,KB0806.KBN_NM1              AS QT_UT_NM                                                            " & vbNewLine _
                                            & " ,EDIL.FREE_C26              AS OKURIJO_IRAI                                                         " & vbNewLine _
                                            & " ,OUTM.OUTKA_TTL_NB AS  OUTKA_TTL_NB_M                                                               " & vbNewLine _
                                            & " --,MG.PKG_NB AS  IRISU                                                                              " & vbNewLine _
                                            & " ,MGD_C.SET_NAIYO AS CASE_IRISU                                                                      " & vbNewLine _
                                            & " ,OUTM.OUTKA_NO_M AS  OUTKA_NO_M                                                                     " & vbNewLine _
                                            & " --20150716 adachi                                                                                   " & vbNewLine _
                                            & " --20160726 takahashi                                                                                " & vbNewLine _
                                            & " ,FL.AUTO_DENP_KBN AS  AUTO_DENP_KBN                                                                 " & vbNewLine _
                                            & " ,FL.AUTO_DENP_NO AS  AUTO_DENP_NO                                                                   " & vbNewLine _
                                            & " --20160726 takahashi                                                                                " & vbNewLine



    ''' <summary>
    ''' データ抽出用FROM句(九州・丸和バイオ)
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_MARUWA_FROM As String = "FROM                                                                                                        " & vbNewLine _
                                     & "$LM_TRN$..C_OUTKA_L OUTL                                                                                    " & vbNewLine _
                                     & "--(2012.09.11)要望番号1412対応  --- START ---                                                               " & vbNewLine _
                                     & "--出荷EDIL                                                                                                  " & vbNewLine _
                                     & "--LEFT JOIN                                                                                                 " & vbNewLine _
                                     & "--(SELECT                                                                                                   " & vbNewLine _
                                     & "--*                                                                                                         " & vbNewLine _
                                     & "--FROM                                                                                                      " & vbNewLine _
                                     & "--(SELECT                                                                                                   " & vbNewLine _
                                     & "--        DEST_AD_1   AS DEST_AD_1                                                                          " & vbNewLine _
                                     & "--       ,DEST_AD_2   AS DEST_AD_2                                                                          " & vbNewLine _
                                     & "--       ,DEST_AD_3                                                                                         " & vbNewLine _
                                     & "--       ,DEST_TEL                                                                                          " & vbNewLine _
                                     & "--       ,DEST_ZIP                                                                                          " & vbNewLine _
                                     & "--       ,FREE_C15                                                                                          " & vbNewLine _
                                     & "--       ,DEST_NM     AS DEST_NM                                                                            " & vbNewLine _
                                     & "--       ,NRS_BR_CD                                                                                         " & vbNewLine _
                                     & "--       ,OUTKA_CTL_NO                                                                                      " & vbNewLine _
                                     & "--       ,SHIP_NM_L                                                                                         " & vbNewLine _
                                     & "--       ,SYS_DEL_FLG                                                                                       " & vbNewLine _
                                     & "--       ,FREE_C05                                                                                          " & vbNewLine _
                                     & "--       --,REMARK                    --2012.07.24 丸和運輸　荷受人氏名下の注意書き                         " & vbNewLine _
                                     & "--       ,REMARK       AS REMARK      --2012.08.21 要望番号1355                                             " & vbNewLine _
                                     & "--       ,ROW_NUMBER() OVER  (PARTITION BY NRS_BR_CD ORDER BY EDI_CTL_NO) AS NUM                            " & vbNewLine _
                                     & "--  FROM                                                                                                    " & vbNewLine _
                                     & "--        $LM_TRN$..H_OUTKAEDI_L                                                                            " & vbNewLine _
                                     & "--  WHERE                                                                                                   " & vbNewLine _
                                     & "--        NRS_BR_CD = @NRS_BR_CD                                                                            " & vbNewLine _
                                     & "--    AND OUTKA_CTL_NO IN (@OUTKA_NO_L)                                                                     " & vbNewLine _
                                     & "--    AND SYS_DEL_FLG  = '0'                                                                                " & vbNewLine _
                                     & "-- ) AS BASE                                                                                                " & vbNewLine _
                                     & "-- WHERE                                                                                                    " & vbNewLine _
                                     & "-- BASE.NUM = 1                                                                                             " & vbNewLine _
                                     & "--) EDIL                                                                                                    " & vbNewLine _
                                     & "--ON                                                                                                        " & vbNewLine _
                                     & "--1 = 1                                                                                                     " & vbNewLine _
                                     & "--下記の内容に変更                                                                                          " & vbNewLine _
                                     & " LEFT JOIN (                                                                                                " & vbNewLine _
                                     & "            SELECT                                                                                          " & vbNewLine _
                                     & "                   NRS_BR_CD                                                                                " & vbNewLine _
                                     & "                 , EDI_CTL_NO                                                                               " & vbNewLine _
                                     & "                 , OUTKA_CTL_NO                                                                             " & vbNewLine _
                                     & "             FROM (                                                                                         " & vbNewLine _
                                     & "                    SELECT                                                                                  " & vbNewLine _
                                     & "                           EDIOUTL.NRS_BR_CD                                                                " & vbNewLine _
                                     & "                         , EDIOUTL.EDI_CTL_NO                                                               " & vbNewLine _
                                     & "                         , EDIOUTL.OUTKA_CTL_NO                                                             " & vbNewLine _
                                     & "                         , CASE WHEN EDIOUTL.OUTKA_CTL_NO = '' THEN 1                                       " & vbNewLine _
                                     & "                           ELSE ROW_NUMBER() OVER (PARTITION BY EDIOUTL.NRS_BR_CD                           " & vbNewLine _
                                     & "                                                              , EDIOUTL.OUTKA_CTL_NO                        " & vbNewLine _
                                     & "                                                       ORDER BY EDIOUTL.NRS_BR_CD                           " & vbNewLine _
                                     & "                                                              , EDIOUTL.EDI_CTL_NO                          " & vbNewLine _
                                     & "                                                  )                                                         " & vbNewLine _
                                     & "                           END AS IDX                                                                       " & vbNewLine _
                                     & "                      FROM $LM_TRN$..H_OUTKAEDI_L EDIOUTL                                                   " & vbNewLine _
                                     & "                     WHERE EDIOUTL.SYS_DEL_FLG  = '0'                                                       " & vbNewLine _
                                     & "                       AND EDIOUTL.NRS_BR_CD    = @NRS_BR_CD                                                " & vbNewLine _
                                     & "                       AND EDIOUTL.OUTKA_CTL_NO = @OUTKA_NO_L                                               " & vbNewLine _
                                     & "                  ) EBASE                                                                                   " & vbNewLine _
                                     & "            WHERE EBASE.IDX = 1                                                                             " & vbNewLine _
                                     & "            ) TOPEDI                                                                                        " & vbNewLine _
                                     & "        ON TOPEDI.NRS_BR_CD    = OUTL.NRS_BR_CD                                                             " & vbNewLine _
                                     & "       AND TOPEDI.OUTKA_CTL_NO = OUTL.OUTKA_NO_L                                                            " & vbNewLine _
                                     & " LEFT JOIN $LM_TRN$..H_OUTKAEDI_L EDIL                                                                      " & vbNewLine _
                                     & "        ON EDIL.NRS_BR_CD  = TOPEDI.NRS_BR_CD                                                               " & vbNewLine _
                                     & "       AND EDIL.EDI_CTL_NO = TOPEDI.EDI_CTL_NO                                                              " & vbNewLine _
                                     & "--(2012.09.11)要望番号1412対応  ---  END  ---                                                               " & vbNewLine _
                                     & "--出荷M                                                                                                     " & vbNewLine _
                                     & "LEFT JOIN                                                                                                   " & vbNewLine _
                                     & " (SELECT TOP 4                                                                                                     " & vbNewLine _
                                     & "   NRS_BR_CD                                                                                                " & vbNewLine _
                                     & "                                                                                                   " & vbNewLine _
                                     & "  ,GOODS_CD_NRS                                                                                             " & vbNewLine _
                                     & "  ,IRIME                                                                                                    " & vbNewLine _
                                     & "  ,IRIME_UT                                                                                                 " & vbNewLine _
                                     & "  ,ALCTD_NB                                                                                                 " & vbNewLine _
                                     & "  ,ALCTD_QT                                                                                                 " & vbNewLine _
                                     & "  ,OUTKA_TTL_NB                                                                                                 " & vbNewLine _
                                     & "  ,LOT_NO                                                                                                   " & vbNewLine _
                                     & "  ,SYS_DEL_FLG                                                                                              " & vbNewLine _
                                     & "  ,CUST_ORD_NO_DTL                                                                                          " & vbNewLine _
                                     & "  ,ROW_NUMBER() OVER (PARTITION BY NRS_BR_CD ORDER BY OUTKA_NO_L,OUTKA_NO_M) AS NUM                         " & vbNewLine _
                                     & "  ,OUTKA_NO_L                                                                                               " & vbNewLine _
                                     & "  ,OUTKA_NO_M                                                                                               " & vbNewLine _
                                     & "  FROM                                                                                                      " & vbNewLine _
                                     & "   $LM_TRN$..C_OUTKA_M M                                                                                    " & vbNewLine _
                                     & "  WHERE                                                                                                     " & vbNewLine _
                                     & "      M.NRS_BR_CD = @NRS_BR_CD                                                                              " & vbNewLine _
                                     & "  AND M.OUTKA_NO_L IN(@OUTKA_NO_L)                                                                          " & vbNewLine _
                                     & "  AND SYS_DEL_FLG = '0'                                                                                     " & vbNewLine _
                                     & ") OUTM                                                                                                      " & vbNewLine _
                                     & "ON                                                                                                          " & vbNewLine _
                                     & "  OUTM.OUTKA_NO_L = OUTL.OUTKA_NO_L                                                                                                    " & vbNewLine _
                                     & "  AND OUTM.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                                     " & vbNewLine _
                                     & "--F運送L                                                                                                    " & vbNewLine _
                                     & "LEFT JOIN $LM_TRN$..F_UNSO_L FL                                                                             " & vbNewLine _
                                     & "ON  FL.MOTO_DATA_KB   = '20'                                                                                " & vbNewLine _
                                     & "AND FL.NRS_BR_CD      = OUTL.NRS_BR_CD                                                                      " & vbNewLine _
                                     & "AND FL.INOUTKA_NO_L   = OUTL.OUTKA_NO_L                                                                     " & vbNewLine _
                                     & "AND FL.SYS_DEL_FLG    = '0'                                                                                 " & vbNewLine _
                                     & "--出荷EDI L                                                                                                 " & vbNewLine _
                                     & "--LEFT JOIN $LM_TRN$..H_OUTKAEDI_L OUTKAEDIL                                                                  " & vbNewLine _
                                     & "--ON  OUTKAEDIL.NRS_BR_CD     = OUTL.NRS_BR_CD                                                                " & vbNewLine _
                                     & "--AND OUTKAEDIL.OUTKA_CTL_NO  = OUTL.OUTKA_NO_L                                                               " & vbNewLine _
                                     & "--AND OUTKAEDIL.SYS_DEL_FLG   = '0'                                                                           " & vbNewLine _
                                     & "--商品M                                                                                                     " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_GOODS MG                                                                              " & vbNewLine _
                                     & "ON  MG.NRS_BR_CD     = OUTM.NRS_BR_CD                                                                       " & vbNewLine _
                                     & "AND MG.GOODS_CD_NRS  = OUTM.GOODS_CD_NRS                                                                    " & vbNewLine _
                                     & "AND MG.SYS_DEL_FLG   = '0'                                                                                  " & vbNewLine _
                                     & "--荷主なしでの運送会社荷主別送り状パターン取得                                                              " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_UNSO_CUST_RPT MCR1                                                                    " & vbNewLine _
                                     & "ON  FL.NRS_BR_CD     = MCR1.NRS_BR_CD                                                                       " & vbNewLine _
                                     & "AND FL.UNSO_CD       = MCR1.UNSOCO_CD                                                                       " & vbNewLine _
                                     & "AND FL.UNSO_BR_CD    = MCR1.UNSOCO_BR_CD                                                                    " & vbNewLine _
                                     & "AND '11'             = MCR1.PTN_ID                                                                          " & vbNewLine _
                                     & "AND FL.PC_KB         = MCR1.MOTO_TYAKU_KB                                                                   " & vbNewLine _
                                     & "AND ''               = MCR1.CUST_CD_L                                                                       " & vbNewLine _
                                     & "AND ''               = MCR1.CUST_CD_M                                                                       " & vbNewLine _
                                     & "AND MCR1.SYS_DEL_FLG = '0'                                                                                  " & vbNewLine _
                                     & "--帳票パターン取得                                                                                          " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_RPT MR1                                                                               " & vbNewLine _
                                     & "ON  MR1.NRS_BR_CD   = MCR1.NRS_BR_CD                                                                        " & vbNewLine _
                                     & "AND MR1.PTN_ID      = MCR1.PTN_ID                                                                           " & vbNewLine _
                                     & "AND MR1.PTN_CD      = MCR1.PTN_CD                                                                           " & vbNewLine _
                                     & "AND MR1.SYS_DEL_FLG = '0'                                                                                   " & vbNewLine _
                                     & "--荷主込みでの運送会社荷主別送り状パターン取得                                                              " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_UNSO_CUST_RPT MCR2                                                                    " & vbNewLine _
                                     & "ON  FL.NRS_BR_CD     = MCR2.NRS_BR_CD                                                                       " & vbNewLine _
                                     & "AND FL.UNSO_CD       = MCR2.UNSOCO_CD                                                                       " & vbNewLine _
                                     & "AND FL.UNSO_BR_CD    = MCR2.UNSOCO_BR_CD                                                                    " & vbNewLine _
                                     & "AND '11'             = MCR2.PTN_ID                                                                          " & vbNewLine _
                                     & "AND FL.PC_KB         = MCR2.MOTO_TYAKU_KB                                                                   " & vbNewLine _
                                     & "AND FL.CUST_CD_L     = MCR2.CUST_CD_L                                                                       " & vbNewLine _
                                     & "AND FL.CUST_CD_M     = MCR2.CUST_CD_M                                                                       " & vbNewLine _
                                     & "AND MCR2.SYS_DEL_FLG = '0'                                                                                  " & vbNewLine _
                                     & "--帳票パターン取得                                                                                          " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_RPT MR2                                                                               " & vbNewLine _
                                     & "ON  MR2.NRS_BR_CD    = MCR2.NRS_BR_CD                                                                       " & vbNewLine _
                                     & "AND MR2.PTN_ID       = MCR2.PTN_ID                                                                          " & vbNewLine _
                                     & "AND MR2.PTN_CD       = MCR2.PTN_CD                                                                          " & vbNewLine _
                                     & "AND MR2.SYS_DEL_FLG  = '0'                                                                                  " & vbNewLine _
                                     & "--存在しない場合の帳票パターン取得                                                                          " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_RPT MR3                                                                               " & vbNewLine _
                                     & "ON  MR3.NRS_BR_CD     = OUTL.NRS_BR_CD                                                                      " & vbNewLine _
                                     & "AND MR3.PTN_ID        = '11'                                                                                " & vbNewLine _
                                     & "AND MR3.STANDARD_FLAG = '01'                                                                                " & vbNewLine _
                                     & "AND MR3.SYS_DEL_FLG   = '0'                                                                                 " & vbNewLine _
                                     & "--荷主マスタ (ここからメインプリント用)                                                               " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_CUST CST                                                                              " & vbNewLine _
                                     & "ON  CST.NRS_BR_CD     = MG.NRS_BR_CD                                                                        " & vbNewLine _
                                     & "AND CST.CUST_CD_L     = MG.CUST_CD_L                                                                        " & vbNewLine _
                                     & "AND CST.CUST_CD_M     = MG.CUST_CD_M                                                                        " & vbNewLine _
                                     & "AND CST.CUST_CD_S     = MG.CUST_CD_S                                                                        " & vbNewLine _
                                     & "AND CST.CUST_CD_SS    = MG.CUST_CD_SS                                                                       " & vbNewLine _
                                     & "AND CST.SYS_DEL_FLG   = '0'                                                                                 " & vbNewLine _
                                     & "--届先マスタ                                                                                                " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_DEST DST                                                                              " & vbNewLine _
                                     & "ON  DST.NRS_BR_CD     = OUTL.NRS_BR_CD                                                                      " & vbNewLine _
                                     & "AND DST.CUST_CD_L     = OUTL.CUST_CD_L                                                                      " & vbNewLine _
                                     & "AND DST.DEST_CD       = OUTL.DEST_CD                                                                        " & vbNewLine _
                                     & "AND DST.SYS_DEL_FLG   = '0'                                                                                 " & vbNewLine _
                                     & "--届先マスタ                                                                                                " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_DEST SHIPDST                                                                          " & vbNewLine _
                                     & "ON  SHIPDST.NRS_BR_CD     = OUTL.NRS_BR_CD                                                                  " & vbNewLine _
                                     & "AND SHIPDST.CUST_CD_L     = OUTL.CUST_CD_L                                                                  " & vbNewLine _
                                     & "AND SHIPDST.DEST_CD       = OUTL.SHIP_CD_L                                                                  " & vbNewLine _
                                     & "AND SHIPDST.SYS_DEL_FLG   = '0'                                                                             " & vbNewLine _
                                     & "--営業所マスタ                                                                                              " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_NRS_BR NB                                                                             " & vbNewLine _
                                     & "ON  NB.NRS_BR_CD      = OUTL.NRS_BR_CD                                                                      " & vbNewLine _
                                     & "AND NB.SYS_DEL_FLG    = '0'                                                                                 " & vbNewLine _
                                     & "--商品明細                                                                                                  " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_GOODS_DETAILS MGD                                                                     " & vbNewLine _
                                     & "ON  MGD.NRS_BR_CD       = OUTM.NRS_BR_CD                                                                    " & vbNewLine _
                                     & "AND MGD.GOODS_CD_NRS    = OUTM.GOODS_CD_NRS                                                                 " & vbNewLine _
                                     & "AND MGD.SUB_KB          = '01'                                                                              " & vbNewLine _
                                     & "AND MGD.SYS_DEL_FLG     = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC560支店TEL(NM4)・支店名(NM3))KB01                                                           " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB01                                                                              " & vbNewLine _
                                     & "ON  KB01.KBN_GROUP_CD = 'O007'                                                                              " & vbNewLine _
                                     & "AND KB01.KBN_CD       = '01'                                                                                " & vbNewLine _
                                     & "AND KB01.SYS_DEL_FLG  = '0'                                                                                 " & vbNewLine _
                                     & "--区分マスタ(納期文言)KB02                                                                                  " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB02                                                                              " & vbNewLine _
                                     & "ON  KB02.KBN_GROUP_CD = 'N010'                                                                              " & vbNewLine _
                                     & "AND KB02.KBN_CD       = OUTL.ARR_PLAN_TIME                                                                  " & vbNewLine _
                                     & "AND KB02.SYS_DEL_FLG  = '0'                                                                                 " & vbNewLine _
                                     & "--区分マスタ(LMC563支店名(NM3)、電話番号(NM4))KB03                                                          " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB03                                                                              " & vbNewLine _
                                     & "ON  KB03.KBN_GROUP_CD = 'O007'                                                                              " & vbNewLine _
                                     & "AND KB03.KBN_CD       = '10'                                                                                " & vbNewLine _
                                     & "AND KB03.SYS_DEL_FLG  = '0'                                                                                 " & vbNewLine _
                                     & "--区分マスタ(LMC563支払支店コード(NM3))KB0401                                                               " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0401                                                                            " & vbNewLine _
                                     & "ON  KB0401.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0401.KBN_CD       = '11'                                                                              " & vbNewLine _
                                     & "AND KB0401.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC563支払支店コード(NM3))KB0402                                                               " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0402                                                                            " & vbNewLine _
                                     & "ON  KB0402.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0402.KBN_CD       = '12'                                                                              " & vbNewLine _
                                     & "AND KB0402.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC563支払支店コード(NM3))KB0403                                                               " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0403                                                                            " & vbNewLine _
                                     & "ON  KB0403.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0403.KBN_CD       = '13'                                                                              " & vbNewLine _
                                     & "AND KB0403.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC563支払支店コード(NM3))KB0404                                                               " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0404                                                                            " & vbNewLine _
                                     & "ON  KB0404.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0404.KBN_CD       = '14'                                                                              " & vbNewLine _
                                     & "AND KB0404.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC563支払支店コード(NM3))KB0405                                                               " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0405                                                                            " & vbNewLine _
                                     & "ON  KB0405.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0405.KBN_CD       = '15'                                                                              " & vbNewLine _
                                     & "AND KB0405.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC564支店TEL、荷主TEL(NM4)・支店名(NM3))KB05                                                  " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB05                                                                              " & vbNewLine _
                                     & "ON  KB05.KBN_GROUP_CD   = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB05.KBN_CD         = '02'                                                                              " & vbNewLine _
                                     & "AND KB05.SYS_DEL_FLG    = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC565支払いコード(NM3)KB0601)                                                                 " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0601                                                                            " & vbNewLine _
                                     & "ON  KB0601.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0601.KBN_CD       = '07'                                                                              " & vbNewLine _
                                     & "AND KB0601.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC565支払いコード(NM3)KB0602)                                                                 " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0602                                                                            " & vbNewLine _
                                     & "ON  KB0602.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0602.KBN_CD       = '08'                                                                              " & vbNewLine _
                                     & "AND KB0602.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC568荷主コード(NM5)KB0701                                                                    " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0701                                                                            " & vbNewLine _
                                     & "ON  KB0701.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0701.KBN_CD       = '03'                                                                              " & vbNewLine _
                                     & "AND KB0701.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC568荷主コード(NM5)KB0702                                                                    " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0702                                                                            " & vbNewLine _
                                     & "ON  KB0702.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0702.KBN_CD       = '09'                                                                              " & vbNewLine _
                                     & "AND KB0702.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC569固定表示(NM1,3,4))KB08                                                                   " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB08                                                                              " & vbNewLine _
                                     & "ON  KB08.KBN_GROUP_CD   = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB08.KBN_CD         = '04'                                                                              " & vbNewLine _
                                     & "AND KB08.SYS_DEL_FLG    = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC570支店名(NM3)支店TEL(NM4))KB1001                                                           " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB1001                                                                            " & vbNewLine _
                                     & "ON  KB1001.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB1001.KBN_CD       = '05'                                                                              " & vbNewLine _
                                     & "AND KB1001.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC570支店名(NM3)支店TEL(NM4))KB1002                                                           " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB1002                                                                            " & vbNewLine _
                                     & "ON  KB1002.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB1002.KBN_CD       = '06'                                                                              " & vbNewLine _
                                     & "AND KB1002.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--荷主明細マスタ(LMC573にて運送契約荷主コード取得)                                                          " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_CUST_DETAILS CUSTDTL                                                                  " & vbNewLine _
                                     & "ON  CUSTDTL.NRS_BR_CD    = OUTL.NRS_BR_CD                                                                   " & vbNewLine _
                                     & "AND CUSTDTL.CUST_CD      = OUTL.CUST_CD_L + OUTL.CUST_CD_M                                                  " & vbNewLine _
                                     & "AND CUSTDTL.SUB_KB       = '03'                                                                             " & vbNewLine _
                                     & "AND CUSTDTL.SYS_DEL_FLG  = '0'                                                                              " & vbNewLine _
                                     & "--区分マスタ(LMC575支払コード(NM3)KB0801)                                                                   " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0801                                                                            " & vbNewLine _
                                     & "ON  KB0801.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0801.KBN_CD       = '16'                                                                              " & vbNewLine _
                                     & "AND KB0801.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC575支払コード(NM3)KB0802)                                                                   " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0802                                                                            " & vbNewLine _
                                     & "ON  KB0802.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0802.KBN_CD       = '17'                                                                              " & vbNewLine _
                                     & "AND KB0802.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC670 KB0803)                                                                                 " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0803                                                                            " & vbNewLine _
                                     & "ON  KB0803.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0803.KBN_CD       = '18'                                                                              " & vbNewLine _
                                     & "AND KB0803.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC806 標準入目単位和名)                                                                     " & vbNewLine _
                                     & "        LEFT JOIN $LM_MST$..Z_KBN KB0806                                                        " & vbNewLine _
                                     & "        ON  KB0806.KBN_GROUP_CD = 'I001'                                                        " & vbNewLine _
                                     & "        AND KB0806.KBN_CD       = MG.STD_IRIME_UT                                                           " & vbNewLine _
                                     & "        AND KB0806.SYS_DEL_FLG  = '0'                                                           " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_DEST      DEST_JIS --2012.05.25                                                       " & vbNewLine _
                                     & "ON  DEST_JIS.NRS_BR_CD    = OUTL.NRS_BR_CD                                                                  " & vbNewLine _
                                     & "AND DEST_JIS.CUST_CD_L    = OUTL.CUST_CD_L                                                                  " & vbNewLine _
                                     & "AND DEST_JIS.DEST_CD      = OUTL.DEST_CD                                                                    " & vbNewLine _
                                     & "AND DEST_JIS.SYS_DEL_FLG  = '0'                                                                             " & vbNewLine _
                                     & "--JISマスタ(LMC661にてJIS_CD2桁：都道府県コード取得)2012.05.25                                              " & vbNewLine _
                                     & "  LEFT JOIN  $LM_MST$..M_JIS   JIS                                                                          " & vbNewLine _
                                     & "  ON  JIS.JIS_CD       = DEST_JIS.JIS                                                                       " & vbNewLine _
                                     & " AND  JIS.SYS_DEL_FLG  = '0'                                                                                " & vbNewLine _
                                     & "--運送会社マスタ(LMC589にてUNSOCO_NM：取次先運送会社名取得)2012.05.25                                       " & vbNewLine _
                                     & "--  LEFT JOIN  $LM_MST$..M_UNSOCO   MUC                                                                     " & vbNewLine _
                                     & "--  ON  MUC.NRS_BR_CD    = FL.NRS_BR_CD                                                                     " & vbNewLine _
                                     & "-- AND  MUC.UNSOCO_CD    = FL.UNSO_CD                                                                       " & vbNewLine _
                                     & "-- AND  MUC.UNSOCO_BR_CD = FL.UNSO_BR_CD                                                                    " & vbNewLine _
                                     & "-- AND  MUC.SYS_DEL_FLG  = '0'                                                                              " & vbNewLine _
                                     & "--荷主明細マスタ(LMC660にてSET_NAIYO：支払コード取得)2012.05.25                                             " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_CUST_DETAILS MCD_SAI                                                                  " & vbNewLine _
                                     & "ON  MCD_SAI.NRS_BR_CD    = OUTL.NRS_BR_CD                                                                   " & vbNewLine _
                                     & "AND MCD_SAI.CUST_CD      = OUTL.CUST_CD_L                                                                   " & vbNewLine _
                                     & "--AND MCD_SAI.CUST_CD_EDA  = OUTL.CUST_CD_M                                                                   " & vbNewLine _
                                     & "AND MCD_SAI.SUB_KB       = '27'                                                                             " & vbNewLine _
                                     & "AND MCD_SAI.SYS_DEL_FLG  = '0'                                                                              " & vbNewLine _
                                     & "--荷主明細マスタ(LMC669にてSET_NAIYO：荷送人名称取得)2012.06.01                                             " & vbNewLine _
                                     & "  LEFT JOIN $LM_MST$..M_CUST_DETAILS MCD_NFC                                                                " & vbNewLine _
                                     & "ON MCD_NFC.NRS_BR_CD   = OUTL.NRS_BR_CD                                                                     " & vbNewLine _
                                     & "AND MCD_NFC.CUST_CD      = OUTL.CUST_CD_L                                                                   " & vbNewLine _
                                     & "--AND MCD_NFC.CUST_CD_EDA  = OUTL.CUST_CD_M  --notes 1118                                                   " & vbNewLine _
                                     & "AND MCD_NFC.SUB_KB       = '29'                                                                             " & vbNewLine _
                                     & "AND MCD_NFC.SYS_DEL_FLG  = '0'                                                                              " & vbNewLine _
                                     & "----商品明細マスタ(丸和バイオ　ケース入数) 20150810                                             " & vbNewLine _
                                     & "  LEFT JOIN $LM_MST$..M_GOODS_DETAILS MGD_C                                                                " & vbNewLine _
                                     & "ON MGD_C.NRS_BR_CD   = OUTL.NRS_BR_CD                                                                      " & vbNewLine _
                                     & "AND MGD_C.GOODS_CD_NRS      = OUTM.GOODS_CD_NRS                                                                   " & vbNewLine _
                                     & "AND MGD_C.SUB_KB       = '52'                                                   " & vbNewLine _
                                     & "AND MGD_C.SYS_DEL_FLG  = '0'                                                                             " & vbNewLine _
                                     & "                                                                             " & vbNewLine _
                                     & "--WHERE                                                                                                       " & vbNewLine _
                                     & "--    OUTL.SYS_DEL_FLG    = '0'                                                                               " & vbNewLine _
                                     & "--AND OUTL.NRS_BR_CD      = @NRS_BR_CD                                                                        " & vbNewLine _
                                     & "--AND OUTL.OUTKA_NO_L IN(@OUTKA_NO_L)                                                                         " & vbNewLine _
                                     & " --要望番号1383 [LMC664] --- START ---                                                                      " & vbNewLine _
                                     & "LEFT JOIN (SELECT NRS_BR_CD   AS NRS_BR_CD                                                                  " & vbNewLine _
                                     & "                 , CUST_CD     AS CUST_CD                                                                   " & vbNewLine _
                                     & "                 , CUST_CLASS  AS CUST_CLASS                                                                " & vbNewLine _
                                     & "                 , SET_NAIYO   AS CUST_NAIYO_1                                                              " & vbNewLine _
                                     & "                 , SET_NAIYO_2 AS CUST_NAIYO_2                                                              " & vbNewLine _
                                     & "                 , SET_NAIYO_3 AS CUST_NAIYO_3                                                              " & vbNewLine _
                                     & "              FROM $LM_MST$..M_CUST_DETAILS                                                                 " & vbNewLine _
                                     & "             WHERE SUB_KB ='42'                                                                             " & vbNewLine _
                                     & "               AND SET_NAIYO_2 = @RPT_ID                                                                    " & vbNewLine _
                                     & "               AND SYS_DEL_FLG = '0'                                                                        " & vbNewLine _
                                     & "            ) MCD_CUST                                                                                      " & vbNewLine _
                                     & "        ON CST.NRS_BR_CD = MCD_CUST.NRS_BR_CD                                                               " & vbNewLine _
                                     & "       AND (CASE WHEN MCD_CUST.CUST_CLASS='00' THEN  CST.CUST_CD_L                                                   " & vbNewLine _
                                     & "                 WHEN MCD_CUST.CUST_CLASS='01' THEN (CST.CUST_CD_L + CST.CUST_CD_M)                                  " & vbNewLine _
                                     & "                 WHEN MCD_CUST.CUST_CLASS='02' THEN (CST.CUST_CD_L + CST.CUST_CD_M + CST.CUST_CD_S)                  " & vbNewLine _
                                     & "                 WHEN MCD_CUST.CUST_CLASS='03' THEN (CST.CUST_CD_L + CST.CUST_CD_M + CST.CUST_CD_S + CST.CUST_CD_SS) " & vbNewLine _
                                     & "            END                                                                                             " & vbNewLine _
                                     & "           ) = MCD_CUST.CUST_CD                                                                             " & vbNewLine _
                                     & " --要望番号1383 [LMC664] --- END ---                                                                        " & vbNewLine



    ''' <summary>
    ''' 印刷用WHERE句 (九州・丸和バイオ)
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_MARUWA_WHERE As String = "WHERE                                                                                                     " & vbNewLine _
                                     & "    OUTL.SYS_DEL_FLG    = '0'                                                                               " & vbNewLine _
                                     & "AND OUTL.NRS_BR_CD      = @NRS_BR_CD                                                                        " & vbNewLine _
                                     & "AND OUTL.OUTKA_NO_L IN(@OUTKA_NO_L)                                                                         " & vbNewLine



    ''' <summary>
    ''' ORDER BY（①出荷管理番号L)）(九州・丸和バイオ)
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_MARUWA_ORDER_BY As String = "ORDER BY                                                                                                " & vbNewLine _
                                         & "     OUTL.NRS_BR_CD                                                                                     " & vbNewLine _
                                         & "    ,OUTL.OUTKA_NO_L                                                                                    " & vbNewLine _
                                         & "    ,OUTM.PRINT_SORT                                                                                    " & vbNewLine _
                                         & "    ,OUTM.OUTKA_NO_M                                                                                    " & vbNewLine

    ''' <summary>
    ''' ORDER BY（①出荷管理番号L)）(九州・丸和バイオ)
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_MARUWA_ORDER_BY_NOMAL As String = "ORDER BY                                                                                                " & vbNewLine _
                                               & "     OUTL.NRS_BR_CD                                                                                     " & vbNewLine _
                                               & "    ,OUTL.OUTKA_NO_L                                                                                    " & vbNewLine _
                                               & "    ,OUTM.OUTKA_NO_M                                                                                     " & vbNewLine




#End Region

#Region "纏め送り状"

    ''' <summary>
    ''' データ抽出用(MAIN)(九州・丸和バイオ)
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_MARUWA_SELECT_DATA_MATOME As String = " --SQL_SELECT_DATA_MATOME                                                                                        " & vbNewLine _
                                                   & "SELECT TOP 4                                                                                        " & vbNewLine _
                                                   & " RPT_ID                                                                                        " & vbNewLine _
                                                   & ",NRS_BR_CD                                                                                     " & vbNewLine _
                                                   & ",OUTKA_PLAN_DATE                                                                               " & vbNewLine _
                                                   & ",MIN(OUTKA_NO_L) AS OUTKA_NO_L                                                                 " & vbNewLine _
                                                   & ",SHITEN_TEL_560_1                                                                              " & vbNewLine _
                                                   & ",SHITEN_NM_560_1                                                                               " & vbNewLine _
                                                   & ",ARR_PLAN_DATE                                                                                 " & vbNewLine _
                                                   & ",ARR_PLAN_TIME                                                                                 " & vbNewLine _
                                                   & ",DEST_TEL                                                                                      " & vbNewLine _
                                                   & ",CUST_TEL                                                                                      " & vbNewLine _
                                                   & ",CUST_AD_1                                                                                     " & vbNewLine _
                                                   & ",CUST_AD_2                                                                                     " & vbNewLine _
                                                   & ",DEST_AD_1                                                                                     " & vbNewLine _
                                                   & ",CUST_AD_3                                                                                     " & vbNewLine _
                                                   & ",DEST_AD_2                                                                                     " & vbNewLine _
                                                   & ",DEST_AD_3                                                                                     " & vbNewLine _
                                                   & ",BETU_WT                                                                                       " & vbNewLine _
                                                   & ",DEST_NM_1                                                                                     " & vbNewLine _
                                                   & ",CUST_NM_L                                                                                     " & vbNewLine _
                                                   & ",DEST_ZIP                                                                                      " & vbNewLine _
                                                   & ",UNSO_WT                                                                                       " & vbNewLine _
                                                   & ",UNSO_PKG_NB                                                                                   " & vbNewLine _
                                                   & ",CUST_NM_M                                                                                     " & vbNewLine _
                                                   & ",NRS_BR_NM                                                                                     " & vbNewLine _
                                                   & ",MIN(DEST_HOSOKU) AS DEST_HOSOKU                                                               " & vbNewLine _
                                                   & ",NRS_AD_1                                                                                      " & vbNewLine _
                                                   & ",NRS_AD_2                                                                                      " & vbNewLine _
                                                   & ",NRS_TEL                                                                                       " & vbNewLine _
                                                   & ",CUST_CD_L                                                                                     " & vbNewLine _
                                                   & ",MIN(UNSO_L_REMARK) AS UNSO_L_REMARK                                                           " & vbNewLine _
                                                   & ",MIN(OUTKA_L_REMARK) AS OUTKA_L_REMARK                                                         " & vbNewLine _
                                                   & ",MIN(GOODS_NM_1) AS GOODS_NM_1                                                                 " & vbNewLine _
                                                   & ",OUTKA_ATT                                                                                     " & vbNewLine _
                                                   & ",BUYER_ORD_NO                                                                                  " & vbNewLine _
                                                   & ",YELLOW_NO                                                                                     " & vbNewLine _
                                                   & ",SHIHARAI_SHITEN_NM_563_1                                                                      " & vbNewLine _
                                                   & ",SHIHARAI_SHITEN_CD_563_1                                                                      " & vbNewLine _
                                                   & ",SHIHARAI_SHITEN_TEL_563_1                                                                     " & vbNewLine _
                                                   & ",SHITEN_TEL_1_564_1                                                                            " & vbNewLine _
                                                   & ",SHITEN_NM_564_1                                                                               " & vbNewLine _
                                                   & ",SHITEN_TEL_2_564_1                                                                            " & vbNewLine _
                                                   & ",NRS_BR_AD_1                                                                                   " & vbNewLine _
                                                   & ",NRS_BR_AD_2                                                                                   " & vbNewLine _
                                                   & ",NRS_BR_NM_1                                                                                   " & vbNewLine _
                                                   & ",DEST_NM                                                                                       " & vbNewLine _
                                                   & ",AD_1                                                                                          " & vbNewLine _
                                                   & ",AD_2                                                                                          " & vbNewLine _
                                                   & ",AD_3                                                                                          " & vbNewLine _
                                                   & ",TEL                                                                                           " & vbNewLine _
                                                   & ",DEST_CD                                                                                       " & vbNewLine _
                                                   & ",SHIP_CD_L                                                                                     " & vbNewLine _
                                                   & ",SHIHARAI_CD_565_1                                                                             " & vbNewLine _
                                                   & ",SHIHARAI_CD_565_2                                                                             " & vbNewLine _
                                                   & ",NRS_FAX                                                                                       " & vbNewLine _
                                                   & ",NRS_AD_3                                                                                      " & vbNewLine _
                                                   & ",MIN(CUST_ORD_NO) AS CUST_ORD_NO                                                               " & vbNewLine _
                                                   & ",SHOBO_CD                                                                                      " & vbNewLine _
                                                   & ",CUST_CD_L_568_1                                                                               " & vbNewLine _
                                                   & ",CUST_CD_L_568_2                                                                               " & vbNewLine _
                                                   & ",NRS_BR_ZIP                                                                                    " & vbNewLine _
                                                   & ",NRS_BR_TEL                                                                                    " & vbNewLine _
                                                   & ",KOTEI_1                                                                                       " & vbNewLine _
                                                   & ",KOTEI_2                                                                                       " & vbNewLine _
                                                   & ",KOTEI_3                                                                                       " & vbNewLine _
                                                   & ",NB_UT                                                                                         " & vbNewLine _
                                                   & ",DENPYO_NM                                                                                     " & vbNewLine _
                                                   & ",SHITEN_NM_570_1                                                                               " & vbNewLine _
                                                   & ",SHITEN_TEL_570_1                                                                              " & vbNewLine _
                                                   & ",SHITEN_NM_570_2                                                                               " & vbNewLine _
                                                   & ",SHITEN_TEL_570_2                                                                              " & vbNewLine _
                                                   & ",OUTKA_PKG_NB                                                                                  " & vbNewLine _
                                                   & ",IRIME                                                                                         " & vbNewLine _
                                                   & ",IRIME_UT                                                                                      " & vbNewLine _
                                                   & ",ALCTD_NB                                                                                      " & vbNewLine _
                                                   & ",MIN(LOT_NO) AS LOT_NO                                                                         " & vbNewLine _
                                                   & ",SHIP_NM_L                                                                                     " & vbNewLine _
                                                   & ",UNSO_CUST_CD                                                                                  " & vbNewLine _
                                                   & ",SHIHARAI_CD_575_1                                                                             " & vbNewLine _
                                                   & ",SHIHARAI_CD_575_2                                                                             " & vbNewLine _
                                                   & ",KBN_CUST_ZIP                                                                                  " & vbNewLine _
                                                   & ",KBN_CUST_AD                                                                                   " & vbNewLine _
                                                   & ",KBN_CUST_TEL                                                                                  " & vbNewLine _
                                                   & ",KBN_CUST_NM                                                                                   " & vbNewLine _
                                                   & ",OUTKO_DATE                                                                                    " & vbNewLine _
                                                   & ",ALCTD_WT                                                                                      " & vbNewLine _
                                                   & ",BUKA_CD                                                                                       " & vbNewLine _
                                                   & ",ATSUKAISYA_NM                                                                                 " & vbNewLine _
                                                   & ",MIN(GOODS_CD_CUST) AS GOODS_CD_CUST                                                           " & vbNewLine _
                                                   & ",PREF_CD                                                                                       " & vbNewLine _
                                                   & ",TORI_UNSOCO_NM                                                                                " & vbNewLine _
                                                   & ",SAI_SHIHARAI_CD                                                                               " & vbNewLine _
                                                   & ",SET_NM_L                                                                                      " & vbNewLine _
                                                   & ",NAIYO1                                                                                        " & vbNewLine _
                                                   & ",NAIYO2                                                                                        " & vbNewLine _
                                                   & ",NAIYO3                                                                                        " & vbNewLine _
                                                   & ",NAIYO_CUST_NM                                                                                 " & vbNewLine _
                                                   & ",MIN(CUST_ORD_NO_DTL) AS CUST_ORD_NO_DTL                                                       " & vbNewLine _
                                                   & ",REMARK_DEST   --2012.07.24 丸和運輸　荷受人氏名下の注意書き                                   " & vbNewLine _
                                                   & "--要望番号1383 [LMC664] --- START ---                                                          " & vbNewLine _
                                                   & ",CUST_FLG                                                                                      " & vbNewLine _
                                                   & ",GOODS_NM_2                                                                                      " & vbNewLine _
                                                   & ",QT_UT_NM                                                                                      " & vbNewLine _
                                                   & ",OKURIJO_IRAI                                                                            " & vbNewLine _
                                                   & ",OUTKA_TTL_NB_M                                                                            " & vbNewLine _
                                                   & ",CASE_IRISU                                                                            " & vbNewLine _
                                                   & ",OUTKA_NO_M                                                                            " & vbNewLine _
                                                   & "--要望番号1383 [LMC664] --- END ---                                                            " & vbNewLine _
                                                   & " FROM (                                                                                        " & vbNewLine


    ''' <summary>
    ''' データ抽出用FROM句(九州・丸和バイオ)
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_MARUWA_FROM_MATOME As String = "-- SQL_FROM_MATOME                                                                                   " & vbNewLine _
                                     & "FROM                                                                                                        " & vbNewLine _
                                     & "$LM_TRN$..C_OUTKA_L OUTL                                                                                    " & vbNewLine _
                                     & " LEFT JOIN (                                                                                                " & vbNewLine _
                                     & "            SELECT                                                                                          " & vbNewLine _
                                     & "                   NRS_BR_CD                                                                                " & vbNewLine _
                                     & "                 , EDI_CTL_NO                                                                               " & vbNewLine _
                                     & "                 , OUTKA_CTL_NO                                                                             " & vbNewLine _
                                     & "             FROM (                                                                                         " & vbNewLine _
                                     & "                    SELECT                                                                                  " & vbNewLine _
                                     & "                           EDIOUTL.NRS_BR_CD                                                                " & vbNewLine _
                                     & "                         , EDIOUTL.EDI_CTL_NO                                                               " & vbNewLine _
                                     & "                         , EDIOUTL.OUTKA_CTL_NO                                                             " & vbNewLine _
                                     & "                         , CASE WHEN EDIOUTL.OUTKA_CTL_NO = '' THEN 1                                       " & vbNewLine _
                                     & "                           ELSE ROW_NUMBER() OVER (PARTITION BY EDIOUTL.NRS_BR_CD                           " & vbNewLine _
                                     & "                                                              , EDIOUTL.OUTKA_CTL_NO                        " & vbNewLine _
                                     & "                                                       ORDER BY EDIOUTL.NRS_BR_CD                           " & vbNewLine _
                                     & "                                                              , EDIOUTL.EDI_CTL_NO                          " & vbNewLine _
                                     & "                                                  )                                                         " & vbNewLine _
                                     & "                           END AS IDX                                                                       " & vbNewLine _
                                     & "                      FROM $LM_TRN$..H_OUTKAEDI_L EDIOUTL                                                   " & vbNewLine _
                                     & "                     WHERE EDIOUTL.SYS_DEL_FLG  = '0'                                                       " & vbNewLine _
                                     & "                       AND EDIOUTL.NRS_BR_CD    = @NRS_BR_CD                                                " & vbNewLine _
                                     & "--要望管理1451                       AND EDIOUTL.OUTKA_CTL_NO = @OUTKA_NO_L                                               " & vbNewLine _
                                     & "                   ) EBASE                                                                                  " & vbNewLine _
                                     & "            WHERE EBASE.IDX = 1                                                                             " & vbNewLine _
                                     & "            ) TOPEDI                                                                                        " & vbNewLine _
                                     & "        ON TOPEDI.NRS_BR_CD    = OUTL.NRS_BR_CD                                                             " & vbNewLine _
                                     & "       AND TOPEDI.OUTKA_CTL_NO = OUTL.OUTKA_NO_L                                                            " & vbNewLine _
                                     & " LEFT JOIN $LM_TRN$..H_OUTKAEDI_L EDIL                                                                      " & vbNewLine _
                                     & "        ON EDIL.NRS_BR_CD  = TOPEDI.NRS_BR_CD                                                               " & vbNewLine _
                                     & "       AND EDIL.EDI_CTL_NO = TOPEDI.EDI_CTL_NO                                                              " & vbNewLine _
                                     & "--(2012.09.11)要望番号1412対応  ---  END  ---                                                               " & vbNewLine _
                                     & "--出荷M 20150729                                                                                                    " & vbNewLine _
                                     & "LEFT JOIN                                                                                                   " & vbNewLine _
                                     & "(SELECT                                                                                                     " & vbNewLine _
                                     & "*                                                                                                           " & vbNewLine _
                                     & "FROM                                                                                                        " & vbNewLine _
                                     & "(SELECT  TOP 4                                                                                                   " & vbNewLine _
                                     & "   M.NRS_BR_CD                                                                                              " & vbNewLine _
                                     & "  ,M.GOODS_CD_NRS                                                                                           " & vbNewLine _
                                     & "  ,M.IRIME                                                                                                  " & vbNewLine _
                                     & "  ,M.IRIME_UT                                                                                               " & vbNewLine _
                                     & "  ,M.ALCTD_NB                                                                                               " & vbNewLine _
                                     & "  ,M.ALCTD_QT                                                                                               " & vbNewLine _
                                     & "  ,M.ALCTD_QT                                                                                               " & vbNewLine _
                                     & "  ,M.OUTKA_TTL_NB                                                                                               " & vbNewLine _
                                     & "  ,M.ALCTD_QT                                                                                               " & vbNewLine _
                                     & "  ,M.LOT_NO                                                                                                 " & vbNewLine _
                                     & "  ,M.CUST_ORD_NO_DTL   --2012/06/11浮間対応                                                                 " & vbNewLine _
                                     & "  ,M.SYS_DEL_FLG                                                                                            " & vbNewLine _
                                     & "  ,ROW_NUMBER() OVER (PARTITION BY M.NRS_BR_CD ORDER BY M.OUTKA_NO_L,M.OUTKA_NO_M) AS NUM                   " & vbNewLine _
                                     & "  ,M.OUTKA_NO_L                                                                                             " & vbNewLine _
                                     & "  ,M.OUTKA_NO_M                                                                                             " & vbNewLine _
                                     & "  FROM                                                                                                      " & vbNewLine _
                                     & "--(2012.06.18)要望番号1160対応 ---  END  ----                                                               " & vbNewLine _
                                     & "   $LM_TRN$..C_OUTKA_M M                                                                                    " & vbNewLine _
                                     & "--(2012.06.18)要望番号1160対応 --- START ----                                                               " & vbNewLine _
                                     & "   LEFT JOIN $LM_TRN$..C_OUTKA_L OUTL                                                                       " & vbNewLine _
                                     & "          ON OUTL.NRS_BR_CD  = M.NRS_BR_CD                                                                  " & vbNewLine _
                                     & "         AND OUTL.OUTKA_NO_L = M.OUTKA_NO_L                                                                 " & vbNewLine _
                                     & "         AND OUTL.SYS_DEL_FLG  = '0'                                                                        " & vbNewLine _
                                     & "   LEFT JOIN $LM_TRN$..F_UNSO_L FL                                                                          " & vbNewLine _
                                     & "          ON FL.NRS_BR_CD    = M.NRS_BR_CD                                                                  " & vbNewLine _
                                     & "         AND FL.INOUTKA_NO_L = M.OUTKA_NO_L                                                                 " & vbNewLine _
                                     & "         AND FL.MOTO_DATA_KB = '20'                                                                         " & vbNewLine _
                                     & "         AND FL.SYS_DEL_FLG  = '0'                                                                          " & vbNewLine _
                                     & "--(2012.06.18)要望番号1160対応 ---  END  ----                                                               " & vbNewLine _
                                     & "  WHERE                                                                                                     " & vbNewLine _
                                     & "      M.NRS_BR_CD = @NRS_BR_CD                                                                              " & vbNewLine _
                                     & "--(2012.06.18)要望番号1160対応 --- START ----                                                               " & vbNewLine _
                                     & "    AND OUTL.CUST_CD_L       = @CUST_CD_L                                                                   " & vbNewLine _
                                     & "    AND OUTL.CUST_CD_M       = @CUST_CD_M                                                                   " & vbNewLine _
                                     & "    AND OUTL.OUTKA_PLAN_DATE = @OUTKA_PLAN_DATE                                                             " & vbNewLine _
                                     & "    AND OUTL.ARR_PLAN_DATE   = @ARR_PLAN_DATE                                                               " & vbNewLine _
                                     & "    AND FL.UNSO_CD           = @UNSO_CD                                                                     " & vbNewLine _
                                     & "    AND FL.UNSO_BR_CD        = @UNSO_BR_CD                                                                  " & vbNewLine _
                                     & "    AND OUTL.DEST_CD         = @DEST_CD                                                                     " & vbNewLine _
                                     & "--  AND M.OUTKA_NO_L IN(@OUTKA_NO_L)                                                                        " & vbNewLine _
                                     & "--  AND SYS_DEL_FLG = '0'                                                                                   " & vbNewLine _
                                     & "    AND M.SYS_DEL_FLG = '0'                                                                                 " & vbNewLine _
                                     & "--(2012.06.18)要望番号1160対応 ---  END  ----                                                               " & vbNewLine _
                                     & " ) AS BASE                                                                                                  " & vbNewLine _
                                     & "-- WHERE                                                                                                    " & vbNewLine _
                                     & "-- BASE.NUM = 1                                                                                             " & vbNewLine _
                                     & ") OUTM                                                                                                      " & vbNewLine _
                                     & "--ON                                                                                                        " & vbNewLine _
                                     & "--1 = 1                                                                                                     " & vbNewLine _
                                     & "--(2012.06.18)要望番号1160対応 --- START ----                                                               " & vbNewLine _
                                     & " ON OUTL.NRS_BR_CD  = OUTM.NRS_BR_CD                                                                        " & vbNewLine _
                                     & "AND OUTL.OUTKA_NO_L = OUTM.OUTKA_NO_L                                                                       " & vbNewLine _
                                     & "--(2012.06.18)要望番号1160対応 ---  END  ----                                                               " & vbNewLine _
                                     & "--F運送L                                                                                                    " & vbNewLine _
                                     & "LEFT JOIN $LM_TRN$..F_UNSO_L FL                                                                             " & vbNewLine _
                                     & "ON  FL.MOTO_DATA_KB   = '20'                                                                                " & vbNewLine _
                                     & "AND FL.NRS_BR_CD      = OUTL.NRS_BR_CD                                                                      " & vbNewLine _
                                     & "AND FL.INOUTKA_NO_L   = OUTL.OUTKA_NO_L                                                                     " & vbNewLine _
                                     & "AND FL.SYS_DEL_FLG    = '0'                                                                                 " & vbNewLine _
                                     & "--出荷EDI L                                                                                                 " & vbNewLine _
                                     & "--LEFT JOIN $LM_TRN$..H_OUTKAEDI_L OUTKAEDIL                                                                  " & vbNewLine _
                                     & "--ON  OUTKAEDIL.NRS_BR_CD     = OUTL.NRS_BR_CD                                                                " & vbNewLine _
                                     & "--AND OUTKAEDIL.OUTKA_CTL_NO  = OUTL.OUTKA_NO_L                                                               " & vbNewLine _
                                     & "--AND OUTKAEDIL.SYS_DEL_FLG   = '0'                                                                           " & vbNewLine _
                                     & "--商品M                                                                                                     " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_GOODS MG                                                                              " & vbNewLine _
                                     & "ON  MG.NRS_BR_CD     = OUTM.NRS_BR_CD                                                                       " & vbNewLine _
                                     & "AND MG.GOODS_CD_NRS  = OUTM.GOODS_CD_NRS                                                                    " & vbNewLine _
                                     & "AND MG.SYS_DEL_FLG   = '0'                                                                                  " & vbNewLine _
                                     & "--荷主なしでの運送会社荷主別送り状パターン取得                                                              " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_UNSO_CUST_RPT MCR1                                                                    " & vbNewLine _
                                     & "ON  FL.NRS_BR_CD     = MCR1.NRS_BR_CD                                                                       " & vbNewLine _
                                     & "AND FL.UNSO_CD       = MCR1.UNSOCO_CD                                                                       " & vbNewLine _
                                     & "AND FL.UNSO_BR_CD    = MCR1.UNSOCO_BR_CD                                                                    " & vbNewLine _
                                     & "AND '11'             = MCR1.PTN_ID                                                                          " & vbNewLine _
                                     & "AND FL.PC_KB         = MCR1.MOTO_TYAKU_KB                                                                   " & vbNewLine _
                                     & "AND ''               = MCR1.CUST_CD_L                                                                       " & vbNewLine _
                                     & "AND ''               = MCR1.CUST_CD_M                                                                       " & vbNewLine _
                                     & "AND MCR1.SYS_DEL_FLG = '0'                                                                                  " & vbNewLine _
                                     & "--帳票パターン取得                                                                                          " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_RPT MR1                                                                               " & vbNewLine _
                                     & "ON  MR1.NRS_BR_CD   = MCR1.NRS_BR_CD                                                                        " & vbNewLine _
                                     & "AND MR1.PTN_ID      = MCR1.PTN_ID                                                                           " & vbNewLine _
                                     & "AND MR1.PTN_CD      = MCR1.PTN_CD                                                                           " & vbNewLine _
                                     & "AND MR1.SYS_DEL_FLG = '0'                                                                                   " & vbNewLine _
                                     & "--荷主込みでの運送会社荷主別送り状パターン取得                                                              " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_UNSO_CUST_RPT MCR2                                                                    " & vbNewLine _
                                     & "ON  FL.NRS_BR_CD     = MCR2.NRS_BR_CD                                                                       " & vbNewLine _
                                     & "AND FL.UNSO_CD       = MCR2.UNSOCO_CD                                                                       " & vbNewLine _
                                     & "AND FL.UNSO_BR_CD    = MCR2.UNSOCO_BR_CD                                                                    " & vbNewLine _
                                     & "AND '11'             = MCR2.PTN_ID                                                                          " & vbNewLine _
                                     & "AND FL.PC_KB         = MCR2.MOTO_TYAKU_KB                                                                   " & vbNewLine _
                                     & "AND FL.CUST_CD_L     = MCR2.CUST_CD_L                                                                       " & vbNewLine _
                                     & "AND FL.CUST_CD_M     = MCR2.CUST_CD_M                                                                       " & vbNewLine _
                                     & "AND MCR2.SYS_DEL_FLG = '0'                                                                                  " & vbNewLine _
                                     & "--帳票パターン取得                                                                                          " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_RPT MR2                                                                               " & vbNewLine _
                                     & "ON  MR2.NRS_BR_CD    = MCR2.NRS_BR_CD                                                                       " & vbNewLine _
                                     & "AND MR2.PTN_ID       = MCR2.PTN_ID                                                                          " & vbNewLine _
                                     & "AND MR2.PTN_CD       = MCR2.PTN_CD                                                                          " & vbNewLine _
                                     & "AND MR2.SYS_DEL_FLG  = '0'                                                                                  " & vbNewLine _
                                     & "--存在しない場合の帳票パターン取得                                                                          " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_RPT MR3                                                                               " & vbNewLine _
                                     & "ON  MR3.NRS_BR_CD     = OUTL.NRS_BR_CD                                                                      " & vbNewLine _
                                     & "AND MR3.PTN_ID        = '11'                                                                                " & vbNewLine _
                                     & "AND MR3.STANDARD_FLAG = '01'                                                                                " & vbNewLine _
                                     & "AND MR3.SYS_DEL_FLG   = '0'                                                                                 " & vbNewLine _
                                     & "--荷主マスタ (ここからメインプリント用)                                                               " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_CUST CST                                                                              " & vbNewLine _
                                     & "ON  CST.NRS_BR_CD     = MG.NRS_BR_CD                                                                        " & vbNewLine _
                                     & "AND CST.CUST_CD_L     = MG.CUST_CD_L                                                                        " & vbNewLine _
                                     & "AND CST.CUST_CD_M     = MG.CUST_CD_M                                                                        " & vbNewLine _
                                     & "AND CST.CUST_CD_S     = MG.CUST_CD_S                                                                        " & vbNewLine _
                                     & "AND CST.CUST_CD_SS    = MG.CUST_CD_SS                                                                       " & vbNewLine _
                                     & "AND CST.SYS_DEL_FLG   = '0'                                                                                 " & vbNewLine _
                                     & "--届先マスタ                                                                                                " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_DEST DST                                                                              " & vbNewLine _
                                     & "ON  DST.NRS_BR_CD     = OUTL.NRS_BR_CD                                                                      " & vbNewLine _
                                     & "AND DST.CUST_CD_L     = OUTL.CUST_CD_L                                                                      " & vbNewLine _
                                     & "AND DST.DEST_CD       = OUTL.DEST_CD                                                                        " & vbNewLine _
                                     & "AND DST.SYS_DEL_FLG   = '0'                                                                                 " & vbNewLine _
                                     & "--届先マスタ                                                                                                " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_DEST SHIPDST                                                                          " & vbNewLine _
                                     & "ON  SHIPDST.NRS_BR_CD     = OUTL.NRS_BR_CD                                                                  " & vbNewLine _
                                     & "AND SHIPDST.CUST_CD_L     = OUTL.CUST_CD_L                                                                  " & vbNewLine _
                                     & "AND SHIPDST.DEST_CD       = OUTL.SHIP_CD_L                                                                  " & vbNewLine _
                                     & "AND SHIPDST.SYS_DEL_FLG   = '0'                                                                             " & vbNewLine _
                                     & "--営業所マスタ                                                                                              " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_NRS_BR NB                                                                             " & vbNewLine _
                                     & "ON  NB.NRS_BR_CD      = OUTL.NRS_BR_CD                                                                      " & vbNewLine _
                                     & "AND NB.SYS_DEL_FLG    = '0'                                                                                 " & vbNewLine _
                                     & "--商品明細                                                                                                  " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_GOODS_DETAILS MGD                                                                     " & vbNewLine _
                                     & "ON  MGD.NRS_BR_CD       = OUTM.NRS_BR_CD                                                                    " & vbNewLine _
                                     & "AND MGD.GOODS_CD_NRS    = OUTM.GOODS_CD_NRS                                                                 " & vbNewLine _
                                     & "AND MGD.SUB_KB          = '01'                                                                              " & vbNewLine _
                                     & "AND MGD.SYS_DEL_FLG     = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC560支店TEL(NM4)・支店名(NM3))KB01                                                           " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB01                                                                              " & vbNewLine _
                                     & "ON  KB01.KBN_GROUP_CD = 'O007'                                                                              " & vbNewLine _
                                     & "AND KB01.KBN_CD       = '01'                                                                                " & vbNewLine _
                                     & "AND KB01.SYS_DEL_FLG  = '0'                                                                                 " & vbNewLine _
                                     & "--区分マスタ(納期文言)KB02                                                                                  " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB02                                                                              " & vbNewLine _
                                     & "ON  KB02.KBN_GROUP_CD = 'N010'                                                                              " & vbNewLine _
                                     & "AND KB02.KBN_CD       = OUTL.ARR_PLAN_TIME                                                                  " & vbNewLine _
                                     & "AND KB02.SYS_DEL_FLG  = '0'                                                                                 " & vbNewLine _
                                     & "--区分マスタ(LMC563支店名(NM3)、電話番号(NM4))KB03                                                          " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB03                                                                              " & vbNewLine _
                                     & "ON  KB03.KBN_GROUP_CD = 'O007'                                                                              " & vbNewLine _
                                     & "AND KB03.KBN_CD       = '10'                                                                                " & vbNewLine _
                                     & "AND KB03.SYS_DEL_FLG  = '0'                                                                                 " & vbNewLine _
                                     & "--区分マスタ(LMC563支払支店コード(NM3))KB0401                                                               " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0401                                                                            " & vbNewLine _
                                     & "ON  KB0401.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0401.KBN_CD       = '11'                                                                              " & vbNewLine _
                                     & "AND KB0401.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC563支払支店コード(NM3))KB0402                                                               " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0402                                                                            " & vbNewLine _
                                     & "ON  KB0402.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0402.KBN_CD       = '12'                                                                              " & vbNewLine _
                                     & "AND KB0402.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC563支払支店コード(NM3))KB0403                                                               " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0403                                                                            " & vbNewLine _
                                     & "ON  KB0403.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0403.KBN_CD       = '13'                                                                              " & vbNewLine _
                                     & "AND KB0403.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC563支払支店コード(NM3))KB0404                                                               " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0404                                                                            " & vbNewLine _
                                     & "ON  KB0404.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0404.KBN_CD       = '14'                                                                              " & vbNewLine _
                                     & "AND KB0404.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC563支払支店コード(NM3))KB0405                                                               " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0405                                                                            " & vbNewLine _
                                     & "ON  KB0405.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0405.KBN_CD       = '15'                                                                              " & vbNewLine _
                                     & "AND KB0405.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC564支店TEL、荷主TEL(NM4)・支店名(NM3))KB05                                                  " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB05                                                                              " & vbNewLine _
                                     & "ON  KB05.KBN_GROUP_CD   = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB05.KBN_CD         = '02'                                                                              " & vbNewLine _
                                     & "AND KB05.SYS_DEL_FLG    = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC565支払いコード(NM3)KB0601)                                                                 " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0601                                                                            " & vbNewLine _
                                     & "ON  KB0601.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0601.KBN_CD       = '07'                                                                              " & vbNewLine _
                                     & "AND KB0601.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC565支払いコード(NM3)KB0602)                                                                 " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0602                                                                            " & vbNewLine _
                                     & "ON  KB0602.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0602.KBN_CD       = '08'                                                                              " & vbNewLine _
                                     & "AND KB0602.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC568荷主コード(NM5)KB0701                                                                    " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0701                                                                            " & vbNewLine _
                                     & "ON  KB0701.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0701.KBN_CD       = '03'                                                                              " & vbNewLine _
                                     & "AND KB0701.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC568荷主コード(NM5)KB0702                                                                    " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0702                                                                            " & vbNewLine _
                                     & "ON  KB0702.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0702.KBN_CD       = '09'                                                                              " & vbNewLine _
                                     & "AND KB0702.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC569固定表示(NM1,3,4))KB08                                                                   " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB08                                                                              " & vbNewLine _
                                     & "ON  KB08.KBN_GROUP_CD   = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB08.KBN_CD         = '04'                                                                              " & vbNewLine _
                                     & "AND KB08.SYS_DEL_FLG    = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC570支店名(NM3)支店TEL(NM4))KB1001                                                           " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB1001                                                                            " & vbNewLine _
                                     & "ON  KB1001.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB1001.KBN_CD       = '05'                                                                              " & vbNewLine _
                                     & "AND KB1001.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC570支店名(NM3)支店TEL(NM4))KB1002                                                           " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB1002                                                                            " & vbNewLine _
                                     & "ON  KB1002.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB1002.KBN_CD       = '06'                                                                              " & vbNewLine _
                                     & "AND KB1002.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--荷主明細マスタ(LMC573にて運送契約荷主コード取得)                                                          " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_CUST_DETAILS CUSTDTL                                                                  " & vbNewLine _
                                     & "ON  CUSTDTL.NRS_BR_CD    = OUTL.NRS_BR_CD                                                                   " & vbNewLine _
                                     & "AND CUSTDTL.CUST_CD      = OUTL.CUST_CD_L + OUTL.CUST_CD_M                                                  " & vbNewLine _
                                     & "AND CUSTDTL.SUB_KB       = '03'                                                                             " & vbNewLine _
                                     & "AND CUSTDTL.SYS_DEL_FLG  = '0'                                                                              " & vbNewLine _
                                     & "--区分マスタ(LMC575支払コード(NM3)KB0801)                                                                   " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0801                                                                            " & vbNewLine _
                                     & "ON  KB0801.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0801.KBN_CD       = '16'                                                                              " & vbNewLine _
                                     & "AND KB0801.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC575支払コード(NM3)KB0802)                                                                   " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0802                                                                            " & vbNewLine _
                                     & "ON  KB0802.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0802.KBN_CD       = '17'                                                                              " & vbNewLine _
                                     & "AND KB0802.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "--区分マスタ(LMC670 KB0803)                                                                                 " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0803                                                                            " & vbNewLine _
                                     & "ON  KB0803.KBN_GROUP_CD = 'O007'                                                                            " & vbNewLine _
                                     & "AND KB0803.KBN_CD       = '18'                                                                              " & vbNewLine _
                                     & "AND KB0803.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..Z_KBN KB0806                                                                            " & vbNewLine _
                                     & "ON  KB0806.KBN_GROUP_CD = 'I001'                                                                            " & vbNewLine _
                                     & "AND KB0806.KBN_CD       = MG.STD_IRIME_UT                                                                            " & vbNewLine _
                                     & "AND KB0806.SYS_DEL_FLG  = '0'                                                                               " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_DEST      DEST_JIS --2012.05.25                                                       " & vbNewLine _
                                     & "ON  DEST_JIS.NRS_BR_CD    = OUTL.NRS_BR_CD                                                                  " & vbNewLine _
                                     & "AND DEST_JIS.CUST_CD_L    = OUTL.CUST_CD_L                                                                  " & vbNewLine _
                                     & "AND DEST_JIS.DEST_CD      = OUTL.DEST_CD                                                                    " & vbNewLine _
                                     & "AND DEST_JIS.SYS_DEL_FLG  = '0'                                                                             " & vbNewLine _
                                     & "--JISマスタ(LMC661にてJIS_CD2桁：都道府県コード取得)2012.05.25                                              " & vbNewLine _
                                     & "  LEFT JOIN  $LM_MST$..M_JIS   JIS                                                                          " & vbNewLine _
                                     & "  ON  JIS.JIS_CD       = DEST_JIS.JIS                                                                       " & vbNewLine _
                                     & " AND  JIS.SYS_DEL_FLG  = '0'                                                                                " & vbNewLine _
                                     & "--運送会社マスタ(LMC589にてUNSOCO_NM：取次先運送会社名取得)2012.05.25                                       " & vbNewLine _
                                     & "--  LEFT JOIN  $LM_MST$..M_UNSOCO   MUC                                                                     " & vbNewLine _
                                     & "--  ON  MUC.NRS_BR_CD    = FL.NRS_BR_CD                                                                     " & vbNewLine _
                                     & "-- AND  MUC.UNSOCO_CD    = FL.UNSO_CD                                                                       " & vbNewLine _
                                     & "-- AND  MUC.UNSOCO_BR_CD = FL.UNSO_BR_CD                                                                    " & vbNewLine _
                                     & "-- AND  MUC.SYS_DEL_FLG  = '0'                                                                              " & vbNewLine _
                                     & "--荷主明細マスタ(LMC660にてSET_NAIYO：支払コード取得)2012.05.25                                             " & vbNewLine _
                                     & "LEFT JOIN $LM_MST$..M_CUST_DETAILS MCD_SAI                                                                  " & vbNewLine _
                                     & "ON  MCD_SAI.NRS_BR_CD    = OUTL.NRS_BR_CD                                                                   " & vbNewLine _
                                     & "AND MCD_SAI.CUST_CD      = OUTL.CUST_CD_L                                                                   " & vbNewLine _
                                     & "--AND MCD_SAI.CUST_CD_EDA  = OUTL.CUST_CD_M                                                                   " & vbNewLine _
                                     & "AND MCD_SAI.SUB_KB       = '27'                                                                             " & vbNewLine _
                                     & "AND MCD_SAI.SYS_DEL_FLG  = '0'                                                                              " & vbNewLine _
                                     & "--荷主明細マスタ(LMC669にてSET_NAIYO：荷送人名称取得)2012.06.01                                             " & vbNewLine _
                                     & "  LEFT JOIN $LM_MST$..M_CUST_DETAILS MCD_NFC                                                                " & vbNewLine _
                                     & "ON MCD_NFC.NRS_BR_CD   = OUTL.NRS_BR_CD                                                                     " & vbNewLine _
                                     & "AND MCD_NFC.CUST_CD      = OUTL.CUST_CD_L                                                                   " & vbNewLine _
                                     & "--AND MCD_NFC.CUST_CD_EDA  = OUTL.CUST_CD_M                                                                   " & vbNewLine _
                                     & "AND MCD_NFC.SUB_KB       = '29'                                                                             " & vbNewLine _
                                     & "AND MCD_NFC.SYS_DEL_FLG  = '0'                                                                              " & vbNewLine _
                                     & " --要望番号1383 [LMC664] --- START ---                                                                      " & vbNewLine _
                                     & "         LEFT JOIN (SELECT NRS_BR_CD   AS NRS_BR_CD                                                         " & vbNewLine _
                                     & "                         , CUST_CD     AS CUST_CD                                                           " & vbNewLine _
                                     & "                         , CUST_CLASS  AS CUST_CLASS                                                        " & vbNewLine _
                                     & "                         , SET_NAIYO   AS CUST_NAIYO_1                                                      " & vbNewLine _
                                     & "                         , SET_NAIYO_2 AS CUST_NAIYO_2                                                      " & vbNewLine _
                                     & "                         , SET_NAIYO_3 AS CUST_NAIYO_3                                                      " & vbNewLine _
                                     & "                      FROM $LM_MST$..M_CUST_DETAILS                                                         " & vbNewLine _
                                     & "                     WHERE SUB_KB ='42'                                                                     " & vbNewLine _
                                     & "                       AND SET_NAIYO_2 = @RPT_ID                                                            " & vbNewLine _
                                     & "                       AND SYS_DEL_FLG = '0'                                                                " & vbNewLine _
                                     & "                    ) MCD_CUST                                                                              " & vbNewLine _
                                     & "                ON CST.NRS_BR_CD = MCD_CUST.NRS_BR_CD                                                       " & vbNewLine _
                                     & "               AND (CASE WHEN MCD_CUST.CUST_CLASS='00' THEN  CST.CUST_CD_L                                                   " & vbNewLine _
                                     & "                         WHEN MCD_CUST.CUST_CLASS='01' THEN (CST.CUST_CD_L + CST.CUST_CD_M)                                  " & vbNewLine _
                                     & "                         WHEN MCD_CUST.CUST_CLASS='02' THEN (CST.CUST_CD_L + CST.CUST_CD_M + CST.CUST_CD_S)                  " & vbNewLine _
                                     & "                         WHEN MCD_CUST.CUST_CLASS='03' THEN (CST.CUST_CD_L + CST.CUST_CD_M + CST.CUST_CD_S + CST.CUST_CD_SS) " & vbNewLine _
                                     & "                    END                                                                                     " & vbNewLine _
                                     & "                   ) = MCD_CUST.CUST_CD                                                                     " & vbNewLine _
                                     & " --要望番号1383 [LMC664] --- END ---                                                                        " & vbNewLine _
                                     & "--WHERE                                                                                                     " & vbNewLine _
                                     & "--    OUTL.SYS_DEL_FLG    = '0'                                                                             " & vbNewLine _
                                     & "--AND OUTL.NRS_BR_CD      = @NRS_BR_CD                                                                      " & vbNewLine _
                                     & "--AND OUTL.OUTKA_NO_L IN(@OUTKA_NO_L)                                                                       " & vbNewLine _
                                     & " WHERE OUTL.SYS_DEL_FLG     = '0'                                                                           " & vbNewLine _
                                     & "   AND OUTL.NRS_BR_CD       = @NRS_BR_CD                                                                    " & vbNewLine _
                                     & "   AND OUTL.CUST_CD_L       = @CUST_CD_L                                                                    " & vbNewLine _
                                     & "   AND OUTL.CUST_CD_M       = @CUST_CD_M                                                                    " & vbNewLine _
                                     & "   AND OUTL.OUTKA_PLAN_DATE = @OUTKA_PLAN_DATE                                                              " & vbNewLine _
                                     & "   AND OUTL.ARR_PLAN_DATE   = @ARR_PLAN_DATE                                                                " & vbNewLine _
                                     & "   AND FL.UNSO_CD           = @UNSO_CD                                                                      " & vbNewLine _
                                     & "   AND FL.UNSO_BR_CD        = @UNSO_BR_CD                                                                   " & vbNewLine _
                                     & "   AND OUTL.DEST_CD         = @DEST_CD                                                                      " & vbNewLine _
                                     & "   ) MAIN                                                                                                   " & vbNewLine



    ''' <summary>
    ''' データ抽出用FROM 送り状　まとめ　(九州・丸和バイオ)
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_MARUWA_GOURP_MATOME As String = "--SQL_GOURP_MATOME                                                                                  " & vbNewLine _
                                             & "GROUP BY                                                                                            " & vbNewLine _
                                             & " MAIN.RPT_ID                                                                                        " & vbNewLine _
                                             & ",MAIN.NRS_BR_CD                                                                                     " & vbNewLine _
                                             & ",MAIN.OUTKA_PLAN_DATE                                                                               " & vbNewLine _
                                             & "--,MAIN.OUTKA_NO_L                                                                                  " & vbNewLine _
                                             & ",MAIN.SHITEN_TEL_560_1                                                                              " & vbNewLine _
                                             & ",MAIN.SHITEN_NM_560_1                                                                               " & vbNewLine _
                                             & ",MAIN.ARR_PLAN_DATE                                                                                 " & vbNewLine _
                                             & ",MAIN.ARR_PLAN_TIME                                                                                 " & vbNewLine _
                                             & ",MAIN.DEST_TEL                                                                                      " & vbNewLine _
                                             & ",MAIN.CUST_TEL                                                                                      " & vbNewLine _
                                             & ",MAIN.CUST_AD_1                                                                                     " & vbNewLine _
                                             & ",MAIN.CUST_AD_2                                                                                     " & vbNewLine _
                                             & ",MAIN.DEST_AD_1                                                                                     " & vbNewLine _
                                             & ",MAIN.CUST_AD_3                                                                                     " & vbNewLine _
                                             & ",MAIN.DEST_AD_2                                                                                     " & vbNewLine _
                                             & ",MAIN.DEST_AD_3                                                                                     " & vbNewLine _
                                             & ",MAIN.BETU_WT                                                                                       " & vbNewLine _
                                             & ",MAIN.DEST_NM_1                                                                                     " & vbNewLine _
                                             & ",MAIN.CUST_NM_L                                                                                     " & vbNewLine _
                                             & ",MAIN.DEST_ZIP                                                                                      " & vbNewLine _
                                             & ",MAIN.UNSO_WT                                                                                       " & vbNewLine _
                                             & ",MAIN.UNSO_PKG_NB                                                                                   " & vbNewLine _
                                             & ",MAIN.CUST_NM_M                                                                                     " & vbNewLine _
                                             & ",MAIN.NRS_BR_NM                                                                                     " & vbNewLine _
                                             & "--,MAIN.DEST_HOSOKU                                                                                 " & vbNewLine _
                                             & ",MAIN.NRS_AD_1                                                                                      " & vbNewLine _
                                             & ",MAIN.NRS_AD_2                                                                                      " & vbNewLine _
                                             & ",MAIN.NRS_TEL                                                                                       " & vbNewLine _
                                             & ",MAIN.CUST_CD_L                                                                                     " & vbNewLine _
                                             & "--,MAIN.UNSO_L_REMARK                                                                               " & vbNewLine _
                                             & "--,MAIN.OUTKA_L_REMARK                                                                              " & vbNewLine _
                                             & "--,MAIN.GOODS_NM_1                                                                                  " & vbNewLine _
                                             & ",MAIN.OUTKA_ATT                                                                                     " & vbNewLine _
                                             & ",MAIN.BUYER_ORD_NO                                                                                  " & vbNewLine _
                                             & ",MAIN.YELLOW_NO                                                                                     " & vbNewLine _
                                             & ",MAIN.SHIHARAI_SHITEN_NM_563_1                                                                      " & vbNewLine _
                                             & ",MAIN.SHIHARAI_SHITEN_CD_563_1                                                                      " & vbNewLine _
                                             & ",MAIN.SHIHARAI_SHITEN_TEL_563_1                                                                     " & vbNewLine _
                                             & ",MAIN.SHITEN_TEL_1_564_1                                                                            " & vbNewLine _
                                             & ",MAIN.SHITEN_NM_564_1                                                                               " & vbNewLine _
                                             & ",MAIN.SHITEN_TEL_2_564_1                                                                            " & vbNewLine _
                                             & ",MAIN.NRS_BR_AD_1                                                                                   " & vbNewLine _
                                             & ",MAIN.NRS_BR_AD_2                                                                                   " & vbNewLine _
                                             & ",MAIN.NRS_BR_NM_1                                                                                   " & vbNewLine _
                                             & ",MAIN.DEST_NM                                                                                       " & vbNewLine _
                                             & ",MAIN.AD_1                                                                                          " & vbNewLine _
                                             & ",MAIN.AD_2                                                                                          " & vbNewLine _
                                             & ",MAIN.AD_3                                                                                          " & vbNewLine _
                                             & ",MAIN.TEL                                                                                           " & vbNewLine _
                                             & ",MAIN.DEST_CD                                                                                       " & vbNewLine _
                                             & ",MAIN.SHIP_CD_L                                                                                     " & vbNewLine _
                                             & ",MAIN.SHIHARAI_CD_565_1                                                                             " & vbNewLine _
                                             & ",MAIN.SHIHARAI_CD_565_2                                                                             " & vbNewLine _
                                             & ",MAIN.NRS_FAX                                                                                       " & vbNewLine _
                                             & ",MAIN.NRS_AD_3                                                                                      " & vbNewLine _
                                             & "--,MAIN.CUST_ORD_NO                                                                                 " & vbNewLine _
                                             & ",MAIN.SHOBO_CD                                                                                      " & vbNewLine _
                                             & ",MAIN.CUST_CD_L_568_1                                                                               " & vbNewLine _
                                             & ",MAIN.CUST_CD_L_568_2                                                                               " & vbNewLine _
                                             & ",MAIN.NRS_BR_ZIP                                                                                    " & vbNewLine _
                                             & ",MAIN.NRS_BR_TEL                                                                                    " & vbNewLine _
                                             & ",MAIN.KOTEI_1                                                                                       " & vbNewLine _
                                             & ",MAIN.KOTEI_2                                                                                       " & vbNewLine _
                                             & ",MAIN.KOTEI_3                                                                                       " & vbNewLine _
                                             & ",MAIN.NB_UT                                                                                         " & vbNewLine _
                                             & ",MAIN.DENPYO_NM                                                                                     " & vbNewLine _
                                             & ",MAIN.SHITEN_NM_570_1                                                                               " & vbNewLine _
                                             & ",MAIN.SHITEN_TEL_570_1                                                                              " & vbNewLine _
                                             & ",MAIN.SHITEN_NM_570_2                                                                               " & vbNewLine _
                                             & ",MAIN.SHITEN_TEL_570_2                                                                              " & vbNewLine _
                                             & ",MAIN.OUTKA_PKG_NB                                                                                  " & vbNewLine _
                                             & ",MAIN.IRIME                                                                                         " & vbNewLine _
                                             & ",MAIN.IRIME_UT                                                                                      " & vbNewLine _
                                             & ",MAIN.ALCTD_NB                                                                                      " & vbNewLine _
                                             & "--,MAIN.LOT_NO                                                                                      " & vbNewLine _
                                             & ",MAIN.SHIP_NM_L                                                                                     " & vbNewLine _
                                             & ",MAIN.UNSO_CUST_CD                                                                                  " & vbNewLine _
                                             & ",MAIN.SHIHARAI_CD_575_1                                                                             " & vbNewLine _
                                             & ",MAIN.SHIHARAI_CD_575_2                                                                             " & vbNewLine _
                                             & ",MAIN.KBN_CUST_ZIP                                                                                  " & vbNewLine _
                                             & ",MAIN.KBN_CUST_AD                                                                                   " & vbNewLine _
                                             & ",MAIN.KBN_CUST_TEL                                                                                  " & vbNewLine _
                                             & ",MAIN.KBN_CUST_NM                                                                                   " & vbNewLine _
                                             & ",MAIN.OUTKO_DATE                                                                                    " & vbNewLine _
                                             & ",MAIN.ALCTD_WT                                                                                      " & vbNewLine _
                                             & ",MAIN.BUKA_CD                                                                                       " & vbNewLine _
                                             & ",MAIN.ATSUKAISYA_NM                                                                                 " & vbNewLine _
                                             & "--,MAIN.GOODS_CD_CUST                                                                               " & vbNewLine _
                                             & ",MAIN.PREF_CD                                                                                       " & vbNewLine _
                                             & ",MAIN.TORI_UNSOCO_NM                                                                                " & vbNewLine _
                                             & ",MAIN.SAI_SHIHARAI_CD                                                                               " & vbNewLine _
                                             & ",MAIN.SET_NM_L                                                                                      " & vbNewLine _
                                             & ",MAIN.NAIYO1                                                                                        " & vbNewLine _
                                             & ",MAIN.NAIYO2                                                                                        " & vbNewLine _
                                             & ",MAIN.NAIYO3                                                                                        " & vbNewLine _
                                             & ",MAIN.NAIYO_CUST_NM                                                                                 " & vbNewLine _
                                             & "--,MAIN.CUST_ORD_NO_DTL                                                                             " & vbNewLine _
                                             & ",MAIN.REMARK_DEST                                                                                   " & vbNewLine _
                                             & "--要望番号1383 [LMC664] --- START ---                                                               " & vbNewLine _
                                             & ",MAIN.GOODS_NM_2                                                                                      " & vbNewLine _
                                             & ",MAIN.QT_UT_NM                                                                                      " & vbNewLine _
                                             & ",MAIN.OKURIJO_IRAI                                                                                      " & vbNewLine _
                                             & ",MAIN.OUTKA_TTL_NB_M                                                                                      " & vbNewLine _
                                             & ",MAIN.CASE_IRISU                                                                 " & vbNewLine _
                                             & ",MAIN.OUTKA_NO_M                                                                 " & vbNewLine _
                                             & "--要望番号1383 [LMC664] --- END ---                                                                 " & vbNewLine

    ''' <summary>
    ''' まとめ送り状ORDER BY(九州・丸和バイオ)
    ''' </summary>
    ''' <remarks></remarks>
    Private Const SQL_MARUWA_ORDER_BY_MATOME As String = "--SQL_ORDER_BY_MATOME                                                                      " & vbNewLine _
                                         & "     ORDER BY                                                                                     " & vbNewLine _
                                         & "     MAIN.NRS_BR_CD                                                                               " & vbNewLine _
                                         & "    ,MAIN.OUTKA_NO_L                                                                 " & vbNewLine _
                                         & "    ,MAIN.OUTKA_NO_M                                                                 " & vbNewLine





#End Region


#End Region

#Region "セミEDI出荷指示取込時の商品名"  'ADD Start 2022/12/28 アフトン別名出荷対応

    ''' <summary>
    ''' セミEDI出荷指示取込時の商品名取得（出荷）
    ''' </summary>
    Private Const SQL_SELECT_OUTKAEDI_GOODSNM_OUTKA As String =
                      " SELECT                                                                                                   " & vbNewLine _
                    & "  MCD.NRS_BR_CD           AS NRS_BR_CD                                                                    " & vbNewLine _
                    & " ,COL.OUTKA_NO_L          AS OUTKA_NO_L                                                                   " & vbNewLine _
                    & " ,ISNULL(HOM.FREE_C02,'') AS GOODS_NM                                                                     " & vbNewLine _
                    & " FROM $LM_MST$..M_CUST_DETAILS MCD                                                                        " & vbNewLine _
                    & " LEFT JOIN $LM_TRN$..C_OUTKA_L COL                                                                        " & vbNewLine _
                    & "   ON COL.NRS_BR_CD   = MCD.NRS_BR_CD                                                                     " & vbNewLine _
                    & "  AND COL.CUST_CD_L   = MCD.CUST_CD                                                                       " & vbNewLine _
                    & "  AND COL.SYS_DEL_FLG = '0'                                                                               " & vbNewLine _
                    & " LEFT JOIN                                                                                                " & vbNewLine _
                    & " (SELECT *                                                                                                " & vbNewLine _
                    & "  FROM                                                                                                    " & vbNewLine _
                    & "  (SELECT                                                                                                 " & vbNewLine _
                    & "    NRS_BR_CD                                                                                             " & vbNewLine _
                    & "   ,OUTKA_CTL_NO                                                                                          " & vbNewLine _
                    & "   ,ROW_NUMBER() OVER (PARTITION BY NRS_BR_CD,OUTKA_CTL_NO ORDER BY OUTKA_CTL_NO,OUTKA_CTL_NO_CHU) AS NUM " & vbNewLine _
                    & "   ,FREE_C02                                                                                              " & vbNewLine _
                    & "   FROM $LM_TRN$..H_OUTKAEDI_M                                                                            " & vbNewLine _
                    & "   WHERE NRS_BR_CD   = @NRS_BR_CD                                                                         " & vbNewLine _
                    & "     AND SYS_DEL_FLG = '0'                                                                                " & vbNewLine _
                    & "  ) BASE                                                                                                  " & vbNewLine _
                    & "  WHERE BASE.NUM = 1                                                                                      " & vbNewLine _
                    & " ) HOM                                                                                                    " & vbNewLine _
                    & "   ON HOM.NRS_BR_CD    = COL.NRS_BR_CD                                                                    " & vbNewLine _
                    & "  AND HOM.OUTKA_CTL_NO = COL.OUTKA_NO_L                                                                   " & vbNewLine _
                    & " WHERE MCD.NRS_BR_CD   = @NRS_BR_CD                                                                       " & vbNewLine _
                    & "   AND MCD.SET_NAIYO   = @SET_NAIYO                                                                       " & vbNewLine _
                    & "   AND MCD.SUB_KB      = @SUB_KB                                                                          " & vbNewLine _
                    & "   AND MCD.SYS_DEL_FLG = '0'                                                                              " & vbNewLine

    ''' <summary>
    ''' セミEDI出荷指示取込時の商品名取得（運送）
    ''' </summary>
    Private Const SQL_SELECT_OUTKAEDI_GOODSNM_UNSO As String =
                      " SELECT                                                                                                   " & vbNewLine _
                    & "  MCD.NRS_BR_CD           AS NRS_BR_CD                                                                    " & vbNewLine _
                    & " ,FUL.UNSO_NO_L           AS OUTKA_NO_L                                                                   " & vbNewLine _
                    & " ,ISNULL(HOM.FREE_C02,'') AS GOODS_NM                                                                     " & vbNewLine _
                    & " FROM $LM_MST$..M_CUST_DETAILS MCD                                                                        " & vbNewLine _
                    & " LEFT JOIN $LM_TRN$..F_UNSO_L FUL                                                                         " & vbNewLine _
                    & "   ON FUL.NRS_BR_CD   = MCD.NRS_BR_CD                                                                     " & vbNewLine _
                    & "  AND FUL.CUST_CD_L   = MCD.CUST_CD                                                                       " & vbNewLine _
                    & "  AND FUL.SYS_DEL_FLG = '0'                                                                               " & vbNewLine _
                    & " LEFT JOIN                                                                                                " & vbNewLine _
                    & " (SELECT *                                                                                                " & vbNewLine _
                    & "  FROM                                                                                                    " & vbNewLine _
                    & "  (SELECT                                                                                                 " & vbNewLine _
                    & "    NRS_BR_CD                                                                                             " & vbNewLine _
                    & "   ,OUTKA_CTL_NO                                                                                          " & vbNewLine _
                    & "   ,ROW_NUMBER() OVER (PARTITION BY NRS_BR_CD,OUTKA_CTL_NO ORDER BY OUTKA_CTL_NO,OUTKA_CTL_NO_CHU) AS NUM " & vbNewLine _
                    & "   ,FREE_C02                                                                                              " & vbNewLine _
                    & "   FROM $LM_TRN$..H_OUTKAEDI_M                                                                            " & vbNewLine _
                    & "   WHERE NRS_BR_CD   = @NRS_BR_CD                                                                         " & vbNewLine _
                    & "     AND SYS_DEL_FLG = '0'                                                                                " & vbNewLine _
                    & "  ) BASE                                                                                                  " & vbNewLine _
                    & "  WHERE BASE.NUM = 1                                                                                      " & vbNewLine _
                    & " ) HOM                                                                                                    " & vbNewLine _
                    & "   ON HOM.NRS_BR_CD    = FUL.NRS_BR_CD                                                                    " & vbNewLine _
                    & "  AND HOM.OUTKA_CTL_NO = FUL.INOUTKA_NO_L                                                                 " & vbNewLine _
                    & " WHERE MCD.NRS_BR_CD   = @NRS_BR_CD                                                                       " & vbNewLine _
                    & "   AND MCD.SET_NAIYO   = @SET_NAIYO                                                                       " & vbNewLine _
                    & "   AND MCD.SUB_KB      = @SUB_KB                                                                          " & vbNewLine _
                    & "   AND MCD.SYS_DEL_FLG = '0'                                                                              " & vbNewLine

#End Region 'ADD End   2022/12/28 アフトン別名出荷対応

#End Region

#End Region

#Region "Field"

    ''' <summary>
    ''' 千葉日医工　OUTKA_NO_L
    ''' </summary>
    ''' <remarks></remarks>
    Private _OUTKA_NO_L As String
#End Region

#Region "Field"

    ''' <summary>
    ''' 検索条件設定用
    ''' </summary>
    ''' <remarks></remarks>
    Private _Row As Data.DataRow

    ''' <summary>
    ''' 検索条件設定用(纏め送り状用)
    ''' </summary>
    ''' <remarks>@(2012.06.06) 纏め送り状対応</remarks>
    Private _MRow As Data.DataRow

    ''' <summary>
    ''' 発行SQL作成用
    ''' </summary>
    ''' <remarks></remarks>
    Private _StrSql As StringBuilder

    ''' <summary>
    ''' パラメータ設定用
    ''' </summary>
    ''' <remarks></remarks>
    Private _SqlPrmList As ArrayList

#End Region

#Region "Method"

#Region "検索処理"

    ''' <summary>
    '''出力対象帳票パターン取得処理(☆作業用コメント：SQL作成からパラメータ反映までが怪しいかもよ？LMB参照のこと。)
    ''' </summary>
    ''' <param name="ds">DataSet</param>
    ''' <returns>DataSet</returns>
    ''' <remarks>出力対象帳票パターン取得SQLの構築・発行</remarks>
    Private Function SelectMPrt(ByVal ds As DataSet) As DataSet

        '***20120723メモ　群馬通過対象見込み***

        'DataSetのIN情報を取得
        Dim inTbl As DataTable = ds.Tables("LMC560IN")

        'INTableの条件rowの格納
        Me._Row = inTbl.Rows(0)

        'SQLパラメータ初期化
        Me._SqlPrmList = New ArrayList()

        'SQL格納変数の初期化
        Me._StrSql = New StringBuilder()

        'SQL作成(フラグ = '1'の場合、運送データ)
        If LMConst.FLG.ON.Equals(Me._Row.Item("PTN_FLAG").ToString()) = True Then
            Me._StrSql.Append(LMC560DAC.SQL_SELECT_MPRT_UNSO)
            Me._StrSql.Append(LMC560DAC.SQL_FROM_UNSO_PRT)
            Me._StrSql.Append(LMC560DAC.SQL_WHERE_UNSO_DATA)

        Else
            Me._StrSql.Append(LMC560DAC.SQL_SELECT_MPrt)    'SQL構築(帳票種別用Select句)
            Me._StrSql.Append(LMC560DAC.SQL_FROM)           'SQL構築(データ抽出用From句)　群馬

            'If Me._Row.Item("MATOME_FLG").Equals("1") = True Then '2012/06/15 notes1160 まとめフラグが1なら、まとめ印刷
            '    Me._StrSql.Append(LMC560DAC.SQL_WHERE_MATOME)     'SQL構築(データ抽出用WHERE句まとめ用)
            'Else
            Me._StrSql.Append(LMC560DAC.SQL_WHERE)         'SQL構築(データ抽出用WHERE句)
            'End If
        End If

        'スキーマ名設定
        Dim sql As String = Me.SetSchemaNm(Me._StrSql.ToString(), Me._Row.Item("NRS_BR_CD").ToString())

        'SQL文のコンパイル
        Dim cmd As SqlCommand = MyBase.CreateSqlCommand(sql)

        'パラメータ設定
        Call Me.SetOutkaParameter(inTbl, Me._SqlPrmList)

        '(2012.08.29) 要望番号1383 [LMC664] --- START ---
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@RPT_ID", "", DBDataType.CHAR))
        '(2012.08.29) 要望番号1383 [LMC664] --- END ---

        'パラメータの反映
        For Each obj As Object In Me._SqlPrmList
            cmd.Parameters.Add(obj)
        Next

        MyBase.Logger.WriteSQLLog("LMC560DAC", "SelectMPrt", cmd)

        'SQLの発行
        Dim reader As SqlDataReader = MyBase.GetSelectResult(cmd)

        Dim map As Hashtable = New Hashtable()

        '取得データの格納先をマッピング
        map.Add("NRS_BR_CD", "NRS_BR_CD")
        map.Add("PTN_ID", "PTN_ID")
        map.Add("PTN_CD", "PTN_CD")
        map.Add("RPT_ID", "RPT_ID")

        ds = MyBase.SetSelectResultToDataSet(map, ds, reader, "M_RPT")

        Return ds

    End Function

    ''' <summary>
    ''' 送り状データ検索(☆作業用コメント：SQL作成からパラメータ反映までが怪しいかもよ？LMB参照のこと。マッピング修正済)
    ''' </summary>
    ''' <param name="ds">DataSet</param>
    ''' <returns>DataSet</returns>
    ''' <remarks>送り状データ取得SQLの構築・発行</remarks>
    Private Function SelectPrintData(ByVal ds As DataSet) As DataSet

        'DataSetのIN情報を取得
        Dim inTbl As DataTable = ds.Tables("LMC560IN")

        'DataSetのM_RPT情報を取得(岩槻浮間対応)
        Dim mrptTbl As DataTable = ds.Tables("M_RPT")

        '帳票ID用(岩槻浮間対応)
        Dim mrptRow As Data.DataRow

        'INTableの条件rowの格納
        Me._Row = inTbl.Rows(0)

        'M_RPTTableの条件rowの格納(岩槻浮間対応)
        mrptRow = mrptTbl.Rows(0)

        'SQLパラメータ初期化
        Me._SqlPrmList = New ArrayList()


        'SQL格納変数の初期化
        Me._StrSql = New StringBuilder()

        'SQL作成(フラグ = '1'の場合、運送データ)
        If LMConst.FLG.ON.Equals(Me._Row.Item("PTN_FLAG").ToString()) = True Then

            'SQL構築(データ抽出用From句)
            Select Case mrptRow.Item("RPT_ID").ToString
                '20121214暫定コメントアウト開始
                ''(埼玉BP：名鉄、オカケン、第一貨物、札幌、武蔵貨物、松岡満運輸、近物レックス、新潟運輸、王子運送)
                Case "LMC701", "LMC702", "LMC703", "LMC704", "LMC705", "LMC706", "LMC708", "LMC716", "LMC717"
                    Me._StrSql.Append(LMC560DAC.SQL_SELECT_UNSO_DATA_BPC)  '20120724 群馬丸和対応
                    Me._StrSql.Append(LMC560DAC.SQL_FROM_UNSO_PRT_BPC)
                    Me._StrSql.Append(LMC560DAC.SQL_WHERE_UNSO_DATA_BPC)
                    '(2012.12.10)要望番号1685 --- START ---
                    Me._StrSql.Append(LMC560DAC.SQL_GROUP_UNSO_DATA_BPC)

                    '2012.12.26 大阪用 ━━━━━━START━━━━━━ ADD 2017/09/28 , "LMC853"追加
                Case "LMC707", "LMC853"
                    Me._StrSql.Append(LMC560DAC.SQL_SELECT_UNSO_DATA_707)
                    Me._StrSql.Append(LMC560DAC.SQL_FROM_UNSO_PRT_707)
                    Me._StrSql.Append(LMC560DAC.SQL_WHERE_UNSO_DATA_707)
                    Me._StrSql.Append(LMC560DAC.SQL_GROUP_UNSO_DATA_707)
                    '2012.12.26 大阪用 ━━━━━━ EDN ━━━━━━

                    '
                Case "LMC806"
                    Me._StrSql.Append(LMC560DAC.SQL_SELECT_UNSO_DATA_MARUWA)
                    Me._StrSql.Append(LMC560DAC.SQL_FROM_UNSO_PRT_MARUWA)
                    Me._StrSql.Append(LMC560DAC.SQL_WHERE_UNSO_DATA_MARUWA)
                    Me._StrSql.Append(LMC560DAC.SQL_GROUP_UNSO_DATA_MARUWA)
                    Me._StrSql.Append(LMC560DAC.SQL_ORDER_UNSO_DATA_MARUWA)

#If True Then   'ADD 2018/11/07 依頼番号 : 002535   【LMS】トール_運送画面から送状印刷できるように変更
                Case "LMC683"

                    Me._StrSql.Append(LMC560DAC.SQL_SELECT_UNSO_DATA_683)  '20120724 群馬丸和対応
                    Me._StrSql.Append(LMC560DAC.SQL_FROM_UNSO_PRT)
                    Me._StrSql.Append(LMC560DAC.SQL_WHERE_UNSO_DATA)
                    Me._StrSql.Append(LMC560DAC.SQL_GROUP_UNSO_DATA)
#End If
                    '20150731 maruwa

#If True Then   'ADD 2020/01/16 009792【LMS】RD帳票作成_アンファー:送り状・納品書亜種

                Case "LMC825"
                    Me._StrSql.Append(LMC560DAC.SQL_SELECT_UNSO_DATA_ANF)
                    Me._StrSql.Append(LMC560DAC.SQL_FROM_UNSO_ANF)
                    Me._StrSql.Append(LMC560DAC.SQL_WHERE_UNSO_DATA)
                    Me._StrSql.Append(LMC560DAC.SQL_GROUP_UNSO_DATA)
                    Me._StrSql.Append(LMC560DAC.SQL_GROUP_UNSO_ANF)

#End If
                Case Else

                    '***20120723メモ　群馬通過対象***
                    Me._StrSql.Append(LMC560DAC.SQL_SELECT_UNSO_DATA)  '20120724 群馬丸和対応
                    Me._StrSql.Append(LMC560DAC.SQL_FROM_UNSO_PRT)
                    Me._StrSql.Append(LMC560DAC.SQL_WHERE_UNSO_DATA)
                    '(2012.12.10)要望番号1685 --- START ---
                    Me._StrSql.Append(LMC560DAC.SQL_GROUP_UNSO_DATA)
                    '(2012.12.10)要望番号1685 ---  END  ---
            End Select

        Else
            'SQL構築(データ抽出用Select句)
            'Me._StrSql.Append(LMC560DAC.SQL_SELECT_DATA)

            'SQL構築(データ抽出用From句)
            Select Case mrptRow.Item("RPT_ID").ToString
                '20121214暫定コメントアウト開始
                ''(埼玉BP：名鉄、オカケン、第一貨物、札幌、武蔵貨物、松岡満運輸、近物レックス、新潟運輸、王子運送)
                Case "LMC701", "LMC702", "LMC703", "LMC704", "LMC705", "LMC706", "LMC708", "LMC716", "LMC717"
                    'If Me._Row.Item("MATOME_FLG").Equals("1") = True Then '(まとめ用)
                    '    Me._StrSql.Append(LMC560DAC.SQL_SELECT_DATA_BPC)
                    '    Me._StrSql.Append(LMC560DAC.SQL_FROM_BPC)
                    '    Me._StrSql.Append(LMC560DAC.SQL_WHERE_BPC)
                    '    Me._StrSql.Append(LMC560DAC.SQL_GROUP_BPC)

                    'Else
                    '(2013.04.12)要望番号2015 SELECT句をBP送り状用　追加START(EDIテーブルを見ない)
                    'Me._StrSql.Append(LMC560DAC.SQL_SELECT_DATA) '(通常用)'SQL構築(データ抽出用Select句) 群馬
                    Me._StrSql.Append(LMC560DAC.SQL_SELECT_DATA_BPCEDIT) '(通常用)'SQL構築(データ抽出用Select句) BPC
                    '(2013.04.12)要望番号2015 SELECT句をBP送り状用　追加END(EDIテーブルを見ない)
                    Me._StrSql.Append(LMC560DAC.SQL_SELECT_DATA_CUST_CD_M) '(通常用)'SQL構築(データ抽出用Select句) 群馬
                    '(2013.04.12)要望番号2015 SELECT句をBP送り状用　追加START(EDIテーブルを見ない)
                    'Me._StrSql.Append(LMC560DAC.SQL_FROM)
                    Me._StrSql.Append(LMC560DAC.SQL_FROM_BPCEDIT)
                    '(2013.04.12)要望番号2015 SELECT句をBP送り状用　追加END(EDIテーブルを見ない)
                    Me._StrSql.Append(LMC560DAC.SQL_WHERE)
                    Me._StrSql.Append(LMC560DAC.SQL_ORDER_BY_NOMAL) 'SQL構築(データ抽出用OrderBy句)

                    'End If

                Case "LMC666", "LMC667", "LMC668", "LMC670" '(埼玉浮間：新潟、名鉄、トナミ　埼玉：斉藤運輸)
                    Me._StrSql.Append(LMC560DAC.SQL_SELECT_DATA) 'SQL構築(データ抽出用Select句)　群馬
                    If Me._Row.Item("MATOME_FLG").Equals("1") = True Then
                        'SQL構築(データ抽出用Select句)
                        Me._StrSql.Append(LMC560DAC.SQL_FROM_UKIMA_MATOME) '群馬
                        Me._StrSql.Append(LMC560DAC.SQL_WHERE_MATOME)
                        Me._StrSql.Append(LMC560DAC.SQL_ORDER_BY) 'SQL構築(データ抽出用OrderBy句)
                    Else
                        'SQL構築(データ抽出用Select句)
                        Me._StrSql.Append(LMC560DAC.SQL_FROM_UKIMA) '群馬
                        Me._StrSql.Append(LMC560DAC.SQL_WHERE)
                        Me._StrSql.Append(LMC560DAC.SQL_ORDER_BY) 'SQL構築(データ抽出用OrderBy句)

                    End If

                    '2012.12.26 大阪用 ━━━━━━START━━━━━━　ADD 2017/09/28 , "LMC853"
                Case "LMC707", "LMC853"
                    If Me._Row.Item("MATOME_FLG").Equals("1") = True Then '(まとめ用)
                        'Me._StrSql.Append(LMC560DAC.SQL_SELECT_DATA_MATOME_707) '大阪
                        'Me._StrSql.Append(LMC560DAC.SQL_SELECT_DATA_707) '大阪
                        'Me._StrSql.Append(LMC560DAC.SQL_FROM_MATOME_707)
                        'Me._StrSql.Append(LMC560DAC.SQL_GOURP_MATOME_707) '群馬
                        'Me._StrSql.Append(LMC560DAC.SQL_ORDER_BY_MATOME_707) 'SQL構築(データ抽出用OrderBy句)
                        Me._StrSql.Append(LMC560DAC.SQL_SELECT_DATA_MATOME_707) 'SQL構築(データ抽出用Select句)
                        Me._StrSql.Append(LMC560DAC.SQL_FROM_NIKKO_MATOME_707)
                        Me._StrSql.Append(LMC560DAC.SQL_WHERE_MATOME_707)
                        Me._StrSql.Append(LMC560DAC.SQL_ORDER_BY_MATOME_707) 'SQL構築(データ抽出用OrderBy句)

                    Else
                        Me._StrSql.Append(LMC560DAC.SQL_SELECT_DATA_707) '大阪
                        Me._StrSql.Append(LMC560DAC.SQL_FROM_707)
                        Me._StrSql.Append(LMC560DAC.SQL_WHERE_707)
                        Me._StrSql.Append(LMC560DAC.SQL_ORDER_BY_NOMAL_707) 'SQL構築(データ抽出用OrderBy句)

                    End If
                    '2012.12.26 大阪用 ━━━━━━ EDN ━━━━━━

                Case "LMC806", "LMC878"
                    If Me._Row.Item("MATOME_FLG").Equals("1") = True Then 'まとめの場合
                        Me._StrSql.Append(LMC560DAC.SQL_MARUWA_SELECT_DATA_MATOME)
                        Me._StrSql.Append(LMC560DAC.SQL_MARUWA_SELECT_DATA)
                        Me._StrSql.Append(LMC560DAC.SQL_MARUWA_FROM_MATOME)
                        Me._StrSql.Append(LMC560DAC.SQL_MARUWA_GOURP_MATOME)
                        Me._StrSql.Append(LMC560DAC.SQL_MARUWA_ORDER_BY_MATOME)
                    Else
                        Me._StrSql.Append(LMC560DAC.SQL_MARUWA_SELECT_DATA) 'SQL構築(データ抽出用Select句) 
                        Me._StrSql.Append(LMC560DAC.SQL_MARUWA_FROM)
                        Me._StrSql.Append(LMC560DAC.SQL_MARUWA_WHERE)
                        Me._StrSql.Append(LMC560DAC.SQL_MARUWA_ORDER_BY_NOMAL) 'SQL構築(データ抽出用OrderBy句)

                    End If

                Case "LMC828"
#If False Then  'UPD 2018/12/05 依頼番号 : 002772   【LMS】LMC828千葉日医工まとめ送状_出荷検索画面から「送状」印刷でエラー発
                    'ADD 2016/08/29 要望番号:2615
                    Me._StrSql.Append(LMC560DAC.SQL_SELECT_DATA_MATOME)
                    Me._StrSql.Append(LMC560DAC.SQL_SELECT_DATA)
                    Me._StrSql.Append(LMC560DAC.SQL_FROM_MATOME)
                    Me._StrSql.Append(LMC560DAC.SQL_GOURP_MATOME)
                    Me._StrSql.Append(LMC560DAC.SQL_ORDER_BY_MATOME)

#Else
                    If Me._Row.Item("MATOME_FLG").Equals("1") = True Then 'まとめの場合
                        Me._StrSql.Append(LMC560DAC.SQL_SELECT_DATA_MATOME)
                        Me._StrSql.Append(LMC560DAC.SQL_SELECT_DATA)
                        Me._StrSql.Append(LMC560DAC.SQL_FROM_MATOME)
                        Me._StrSql.Append(LMC560DAC.SQL_GOURP_MATOME)
                        Me._StrSql.Append(LMC560DAC.SQL_ORDER_BY_MATOME)
                    Else
                        Me._StrSql.Append(LMC560DAC.SQL_SELECT_DATA)    'SQL構築(データ抽出用Select句)
                        Me._StrSql.Append(LMC560DAC.SQL_FROM)
                        Me._StrSql.Append(LMC560DAC.SQL_WHERE)
                        Me._StrSql.Append(LMC560DAC.SQL_ORDER_BY_NOMAL) 'SQL構築(データ抽出用OrderBy句)

                    End If
#End If


                Case "LMC719", "LMC826", "LMC833", "LMC837"
                    ' FFEM用送状(西濃[LMC719]/西濃着払[LMC833]/第一貨物[LMC826])
                    Me._StrSql.Append(LMC560DAC.SQL_SELECT_DATA) 'SQL構築(データ抽出用Select句) 
                    Me._StrSql.Append(LMC560DAC.SQL_SELECT_DATA_ADD_FJF) 'SQL構築(データ抽出用Select句) 
                    Me._StrSql.Append(LMC560DAC.SQL_FROM)
                    Me._StrSql.Append(LMC560DAC.SQL_FROM_ADD_FJF)
                    Me._StrSql.Append(LMC560DAC.SQL_WHERE)
                    Me._StrSql.Append(LMC560DAC.SQL_ORDER_BY_NOMAL) 'SQL構築(データ抽出用OrderBy句)

                Case "LMC560", "LMC562", "LMC591"
                    '西濃、久留米、ヤマト印刷時（サクラ省略商品名対応）
                    Me._StrSql.Append(LMC560DAC.SQL_SELECT_INVOICE_DATA) 'SQL構築(データ抽出用Select句) 
                    Me._StrSql.Append(LMC560DAC.SQL_INVOICEFROM)
                    Me._StrSql.Append(LMC560DAC.SQL_WHERE)
                    Me._StrSql.Append(LMC560DAC.SQL_ORDER_BY_NOMAL) 'SQL構築(データ抽出用OrderBy句)

                Case Else
#If FALE Then       'upd 2018/10/18 依頼番号 : 002601   【LMS】日医工_まとめ送状(選択)_送り状番号更新 ＋ オーダー番号最小の個数のみ送り状表示(千葉BC柴田) 
                    '***20120723メモ　群馬通過対象見込み***
                    If Me._Row.Item("MATOME_FLG").Equals("1") = True Then 'まとめの場合
                        Me._StrSql.Append(LMC560DAC.SQL_SELECT_DATA_MATOME) '群馬
                        Me._StrSql.Append(LMC560DAC.SQL_SELECT_DATA) '群馬
                        Me._StrSql.Append(LMC560DAC.SQL_FROM_MATOME) '群馬
                        Me._StrSql.Append(LMC560DAC.SQL_GOURP_MATOME) '群馬
                        Me._StrSql.Append(LMC560DAC.SQL_ORDER_BY_MATOME)
                    Else
                        Me._StrSql.Append(LMC560DAC.SQL_SELECT_DATA) 'SQL構築(データ抽出用Select句) 群馬
                        Me._StrSql.Append(LMC560DAC.SQL_FROM) '群馬
                        Me._StrSql.Append(LMC560DAC.SQL_WHERE)
                        Me._StrSql.Append(LMC560DAC.SQL_ORDER_BY_NOMAL) 'SQL構築(データ抽出用OrderBy句)

                    End If

#Else
                    If Me._Row.Item("MATOME_SELECT_FLG").Equals("1") = True Then 'まとめ送り状（選択）の場合
                        Me._StrSql.Append(LMC560DAC.SQL_SELECT_DATA_MATOME) '共通群馬 使用
                        Me._StrSql.Append(LMC560DAC.SQL_SELECT_DATA)        '共通群馬使用
                        Me._StrSql.Append(LMC560DAC.SQL_FROM_MATOME_SELECT)     '新

                        '纏め送り状（選択時）

                        '選択出荷管理番号設定(LMC560IN_SELECT_ALLより設定)
                        Dim sOutkaLNo As String = String.Empty

                        If ds.Tables("LMC560IN_SELECT_ALL").Rows.Count > 0 Then

                            For i As Integer = 0 To ds.Tables("LMC560IN_SELECT_ALL").Rows.Count - 1
                                If String.Empty.Equals(sOutkaLNo) = True Then

                                    sOutkaLNo = String.Concat("'", ds.Tables("LMC560IN_SELECT_ALL").Rows(i).Item("OUTKA_NO_L").ToString.Trim, "'")
                                Else

                                    sOutkaLNo = String.Concat(sOutkaLNo, ",'", ds.Tables("LMC560IN_SELECT_ALL").Rows(i).Item("OUTKA_NO_L").ToString.Trim, "'")
                                End If

                            Next
                        End If

                        Me._StrSql.Append(String.Concat("   AND OUTL.OUTKA_NO_L IN (", sOutkaLNo, ")"))


                        Me._StrSql.Append(LMC560DAC.SQL_FROM_MATOME_SELECT2)    '新
                        Me._StrSql.Append(LMC560DAC.SQL_GOURP_MATOME)       '共通群馬使用
                        Me._StrSql.Append(LMC560DAC.SQL_ORDER_BY_MATOME)    '共通

                    Else
                        If Me._Row.Item("MATOME_FLG").Equals("1") = True Then 'まとめの場合
                            Me._StrSql.Append(LMC560DAC.SQL_SELECT_DATA_MATOME) '群馬
                            Me._StrSql.Append(LMC560DAC.SQL_SELECT_DATA) '群馬
                            Me._StrSql.Append(LMC560DAC.SQL_FROM_MATOME) '群馬
                            Me._StrSql.Append(LMC560DAC.SQL_GOURP_MATOME) '群馬
                            Me._StrSql.Append(LMC560DAC.SQL_ORDER_BY_MATOME)
                        Else
                            'UPD 2020/01/15 009792 Me._StrSql.Append(LMC560DAC.SQL_SELECT_DATA) 'SQL構築(データ抽出用Select句) 群馬
                            Me._StrSql.Append(LMC560DAC.SQL_SELECT_DATA2) 'SQL構築(データ抽出用Select句) 
                            Me._StrSql.Append(LMC560DAC.SQL_FROM) '群馬
                            Me._StrSql.Append(LMC560DAC.SQL_FROM_ADD)   'ADD 2020/01/15 009792【LMS】RD帳票作成_アンファー:送り状・納品書亜種
                            Me._StrSql.Append(LMC560DAC.SQL_WHERE)
                            Me._StrSql.Append(LMC560DAC.SQL_ORDER_BY_NOMAL) 'SQL構築(データ抽出用OrderBy句)

                        End If

                    End If
#End If
            End Select

            'SQL構築(データ抽出用Where句)
            'If Me._Row.Item("MATOME_FLG").Equals("1") = True Then '2012/06/15 notes1160 まとめフラグが1なら、まとめ印刷
            'If Me._Row.Item("MATOME_FLG").Equals("0") = True Then '2012/06/17 通常印刷の場合。
            '    Me._StrSql.Append(LMC560DAC.SQL_WHERE)
            '    Me._StrSql.Append(LMC560DAC.SQL_ORDER_BY_NOMAL) 'SQL構築(データ抽出用OrderBy句)
            'Else
            'End If

            'Me._StrSql.Append(LMC560DAC.SQL_ORDER_BY) 'SQL構築(データ抽出用OrderBy句)

        End If

        'スキーマ名設定
        Dim sql As String = Me.SetSchemaNm(Me._StrSql.ToString(), Me._Row.Item("NRS_BR_CD").ToString())

        'SQL文のコンパイル
        Dim cmd As SqlCommand = MyBase.CreateSqlCommand(sql)

        'パラメータ設定
        'Call Me.SetOutkaParameter(inTbl, Me._SqlPrmList)

        If Me._Row.Item("MATOME_FLG").Equals("1") = True Then '2012/06/15 notes1160 まとめフラグが1なら、まとめ印刷
            Select Case mrptRow.Item("RPT_ID").ToString
                ''(埼玉BP：名鉄、オカケン、第一貨物、札幌、武蔵貨物、松岡満運輸、近物レックス、新潟運輸、王子運送)
                Case "LMC701", "LMC702", "LMC703", "LMC704", "LMC705", "LMC706", "LMC708", "LMC716", "LMC717", "LMC806", "LMC878"
                    Call Me.SetOutkaParameter(inTbl, Me._SqlPrmList)
                    'Call Me.SetOutkaParameterMatomeMeisai(inTbl, Me._SqlPrmList)
#If False Then   'ADD 2018/08/02 千葉　日医工対応　依頼番号 001572 
                Case "LMC774"
                    Call Me.SetOutkaParameterNichiiko(ds, Me._SqlPrmList)
#End If
                Case Else
                    Call Me.SetOutkaParameterMatomeMeisai(inTbl, Me._SqlPrmList) 'BPC以外なら行う。
            End Select
        Else
            'If LMConst.FLG.ON.Equals(Me._Row.Item("PTN_FLAG").ToString()) = True Then '(フラグ = '1'の場合、運送データ)
            '        Select mrptRow.Item("RPT_ID").ToString
            '        Case "LMC707"                                                   '運送のLMC707(大阪・日興産業)なら
            '            Call Me.SetOutkaParameterMatomeMeisai(inTbl, Me._SqlPrmList) '纏め明細と同じパラメータを渡す
            '    End Select
            'End If
            Call Me.SetOutkaParameter(inTbl, Me._SqlPrmList)             '出荷系は基本、こちらへ。
        End If

        '(2012.08.29) 要望番号1383 [LMC664] --- START ---
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@RPT_ID", mrptRow.Item("RPT_ID").ToString, DBDataType.CHAR))
        '(2012.08.29) 要望番号1383 [LMC664] --- END ---

        'パラメータの反映()
        For Each obj As Object In Me._SqlPrmList
            cmd.Parameters.Add(obj)
        Next

        MyBase.Logger.WriteSQLLog("LMC560DAC", "SelectPrintData", cmd)

        'SQLの発行
        Dim reader As SqlDataReader = MyBase.GetSelectResult(cmd)

        'DataReader→DataTableへの転記
        Dim map As Hashtable = New Hashtable()

        '取得データの格納先をマッピング
        map.Add("RPT_ID", "RPT_ID")
        map.Add("NRS_BR_CD", "NRS_BR_CD")
        map.Add("OUTKA_PLAN_DATE", "OUTKA_PLAN_DATE")
        map.Add("OUTKA_NO_L", "OUTKA_NO_L")
        map.Add("SHITEN_TEL_560_1", "SHITEN_TEL_560_1")
        map.Add("SHITEN_NM_560_1", "SHITEN_NM_560_1")
        map.Add("ARR_PLAN_DATE", "ARR_PLAN_DATE")
        map.Add("ARR_PLAN_TIME", "ARR_PLAN_TIME")
        map.Add("DEST_TEL", "DEST_TEL")
        map.Add("CUST_TEL", "CUST_TEL")
        map.Add("CUST_AD_1", "CUST_AD_1")
        map.Add("CUST_AD_2", "CUST_AD_2")
        map.Add("DEST_AD_1", "DEST_AD_1")
        map.Add("CUST_AD_3", "CUST_AD_3")
        map.Add("DEST_AD_2", "DEST_AD_2")
        map.Add("DEST_AD_3", "DEST_AD_3")
        map.Add("BETU_WT", "BETU_WT")
        map.Add("DEST_NM_1", "DEST_NM_1")
        map.Add("CUST_NM_L", "CUST_NM_L")
        map.Add("DEST_ZIP", "DEST_ZIP")
        map.Add("UNSO_WT", "UNSO_WT")
        map.Add("UNSO_PKG_NB", "UNSO_PKG_NB")
        map.Add("CUST_NM_M", "CUST_NM_M")
        map.Add("NRS_BR_NM", "NRS_BR_NM")
        map.Add("DEST_HOSOKU", "DEST_HOSOKU")
        map.Add("NRS_AD_1", "NRS_AD_1")
        map.Add("NRS_AD_2", "NRS_AD_2")
        map.Add("NRS_TEL", "NRS_TEL")
        map.Add("CUST_CD_L", "CUST_CD_L")
        map.Add("UNSO_L_REMARK", "UNSO_L_REMARK")
        map.Add("OUTKA_L_REMARK", "OUTKA_L_REMARK")
        map.Add("GOODS_NM_1", "GOODS_NM_1")
        map.Add("OUTKA_ATT", "OUTKA_ATT")
        map.Add("BUYER_ORD_NO", "BUYER_ORD_NO")
        map.Add("YELLOW_NO", "YELLOW_NO")
        map.Add("SHIHARAI_SHITEN_NM_563_1", "SHIHARAI_SHITEN_NM_563_1")
        map.Add("SHIHARAI_SHITEN_TEL_563_1", "SHIHARAI_SHITEN_TEL_563_1")
        map.Add("SHITEN_TEL_1_564_1", "SHITEN_TEL_1_564_1")
        map.Add("SHITEN_NM_564_1", "SHITEN_NM_564_1")
        map.Add("SHITEN_TEL_2_564_1", "SHITEN_TEL_2_564_1")
        map.Add("NRS_BR_AD_1", "NRS_BR_AD_1")
        map.Add("NRS_BR_AD_2", "NRS_BR_AD_2")
        map.Add("NRS_BR_NM_1", "NRS_BR_NM_1")
        map.Add("DEST_NM", "DEST_NM")
        map.Add("AD_1", "AD_1")
        map.Add("AD_2", "AD_2")
        map.Add("AD_3", "AD_3")
        map.Add("TEL", "TEL")
        map.Add("DEST_CD", "DEST_CD")
        map.Add("SHIP_CD_L", "SHIP_CD_L")
        map.Add("SHIHARAI_CD_565_1", "SHIHARAI_CD_565_1")
        map.Add("SHIHARAI_CD_565_2", "SHIHARAI_CD_565_2")
        map.Add("NRS_FAX", "NRS_FAX")
        map.Add("NRS_AD_3", "NRS_AD_3")
        map.Add("CUST_ORD_NO", "CUST_ORD_NO")
        map.Add("SHOBO_CD", "SHOBO_CD")
        map.Add("CUST_CD_L_568_1", "CUST_CD_L_568_1")
        map.Add("CUST_CD_L_568_2", "CUST_CD_L_568_2")
        map.Add("NRS_BR_ZIP", "NRS_BR_ZIP")
        map.Add("NRS_BR_TEL", "NRS_BR_TEL")
        map.Add("KOTEI_1", "KOTEI_1")
        map.Add("KOTEI_2", "KOTEI_2")
        map.Add("KOTEI_3", "KOTEI_3")
        map.Add("NB_UT", "NB_UT")
        map.Add("DENPYO_NM", "DENPYO_NM")
        map.Add("SHITEN_NM_570_1", "SHITEN_NM_570_1")
        map.Add("SHITEN_TEL_570_1", "SHITEN_TEL_570_1")
        map.Add("OUTKA_PKG_NB", "OUTKA_PKG_NB")
        map.Add("IRIME", "IRIME")
        map.Add("IRIME_UT", "IRIME_UT")
        map.Add("ALCTD_NB", "ALCTD_NB")
        map.Add("LOT_NO", "LOT_NO")
        map.Add("SHITEN_NM_570_2", "SHITEN_NM_570_2")
        map.Add("SHITEN_TEL_570_2", "SHITEN_TEL_570_2")
        map.Add("SHIHARAI_SHITEN_CD_563_1", "SHIHARAI_SHITEN_CD_563_1")
        map.Add("SHIP_NM_L", "SHIP_NM_L")
        map.Add("UNSO_CUST_CD", "UNSO_CUST_CD")
        '2012.01.24 追加 大阪物流センター対応
        map.Add("SHIHARAI_CD_575_1", "SHIHARAI_CD_575_1")
        map.Add("SHIHARAI_CD_575_2", "SHIHARAI_CD_575_2")
        map.Add("ATSUKAISYA_NM", "ATSUKAISYA_NM")
        '2012.05.25 追加　埼玉対応
        map.Add("GOODS_CD_CUST", "GOODS_CD_CUST")
        map.Add("PREF_CD", "PREF_CD")
        map.Add("TORI_UNSOCO_NM", "TORI_UNSOCO_NM")
        map.Add("SAI_SHIHARAI_CD", "SAI_SHIHARAI_CD")
        '2012.05.25 追加　埼玉(ｵｶｹﾝ)対応
        map.Add("SET_NM_L", "SET_NM_L")
        '2012.06.01 追加　埼玉(日本ファインコーティング)対応
        map.Add("NAIYO1", "NAIYO1")
        map.Add("NAIYO2", "NAIYO2")
        map.Add("NAIYO3", "NAIYO3")
        '2012.06.04 埼玉 名鉄・西濃対応
        map.Add("NAIYO_CUST_NM", "NAIYO_CUST_NM")
        map.Add("CUST_ORD_NO_DTL", "CUST_ORD_NO_DTL")
        '2012.06.13 斉藤運輸倉庫対応
        map.Add("KBN_CUST_ZIP", "KBN_CUST_ZIP")
        map.Add("KBN_CUST_AD", "KBN_CUST_AD")
        map.Add("KBN_CUST_TEL", "KBN_CUST_TEL")
        map.Add("KBN_CUST_NM", "KBN_CUST_NM")
        map.Add("OUTKO_DATE", "OUTKO_DATE")
        map.Add("ALCTD_WT", "ALCTD_WT")
        map.Add("BUKA_CD", "BUKA_CD")
        '2012.07.24 群馬　丸和運輸対応
        map.Add("REMARK_DEST", "REMARK_DEST")
        '(2012.08.29) 要望番号1383 [LMC664] --- START ---
        map.Add("CUST_FLG", "CUST_FLG")
        '(2012.08.29) 要望番号1383 [LMC664] --- END ---



        Select Case mrptRow.Item("RPT_ID").ToString
            '    '(埼玉BP：名鉄、オカケン、第一貨物、札幌、武蔵貨物、松岡満運輸、近物レックス、新潟運輸、王子運送)
            Case "LMC701", "LMC702", "LMC703", "LMC704", "LMC705", "LMC706", "LMC708", "LMC716", "LMC717"
                If Me._Row.Item("MATOME_FLG").Equals("1") = True Then
                    map.Add("CUST_CD_M", "CUST_CD_M")
                    '要望番号1961　修正START 纏め条件を届先CD⇒顧客運賃纏めコードに変更
                    map.Add("CUST_DEST_CD", "CUST_DEST_CD")
                    '要望番号1961　修正END 纏め条件を届先CD⇒顧客運賃纏めコードに変更
                    '            map.Add("CUST_ORD_NO_1", "CUST_ORD_NO_1")
                    '            map.Add("CUST_ORD_NO_2", "CUST_ORD_NO_2")
                    '            map.Add("CUST_ORD_NO_3", "CUST_ORD_NO_3")
                    '            map.Add("CUST_ORD_NO_4", "CUST_ORD_NO_4")
                    '            map.Add("CUST_ORD_NO_5", "CUST_ORD_NO_5")
                    '            map.Add("CUST_ORD_NO_6", "CUST_ORD_NO_6")
                    '            map.Add("CUST_ORD_NO_7", "CUST_ORD_NO_7")
                End If
               

                '2012.12.26 大阪用 ━━━━━━START━━━━━━ADD 2017/09/28 , "LMC853"
            Case "LMC707", "LMC853"
                map.Add("REC_NO", "REC_NO")
                If LMConst.FLG.ON.Equals(Me._Row.Item("PTN_FLAG").ToString()) = False Then '出荷のみ、通す。
                    If Me._Row.Item("MATOME_FLG").Equals("1") = False Then 'なおかつ「まとめフラグ」がON(1)の場合のみ
                        map.Add("CUST_ORD_NO_1", "CUST_ORD_NO_1")          'これらを設定する。
                        map.Add("CUST_ORD_NO_2", "CUST_ORD_NO_2")
                        map.Add("CUST_ORD_NO_3", "CUST_ORD_NO_3")
                        map.Add("CUST_ORD_NO_4", "CUST_ORD_NO_4")
                        map.Add("CUST_ORD_NO_5", "CUST_ORD_NO_5")
                        map.Add("CUST_ORD_NO_6", "CUST_ORD_NO_6")
                        map.Add("CUST_ORD_NO_7", "CUST_ORD_NO_7")
                    End If
                End If
                '2012.12.26 大阪用 ━━━━━━ END ━━━━━━

                'ADD 2017/09/28 トール日興V2 Start
                If mrptRow.Item("RPT_ID").ToString.Equals("LMC853") = True Then
                    map.Add("AUTO_DENP_KBN", "AUTO_DENP_KBN")
                    map.Add("AUTO_DENP_NO", "AUTO_DENP_NO")
                End If
                'ADD 2017/09/28 トール日興V2 End

            Case "LMC806", "LMC878"
                '2015/7/29 adachi
                map.Add("GOODS_NM_2", "GOODS_NM_2")
                map.Add("QT_UT_NM", "QT_UT_NM")
                map.Add("OKURIJO_IRAI", "OKURIJO_IRAI")
                map.Add("OUTKA_TTL_NB_M", "OUTKA_TTL_NB_M")
                map.Add("CASE_IRISU", "CASE_IRISU")
                '20150801 OUT_NO_Mを追加しているが、SELECTには必要なし

                '2018/01/25 LMS_大阪トール_まとめ送状・荷札導入対応 Annen upd start
            Case "LMC828", "LMC664", "LMC851", "LMC683", "LMC647", "LMC724"
                'Case "LMC828", "LMC664"
                '2018/01/25 LMS_大阪トール_まとめ送状・荷札導入対応 Annen upd end
                'ADD 2016/08/29 要望番号:2615
                map.Add("AUTO_DENP_NO", "AUTO_DENP_NO")


            Case "LMC719", "LMC826", "LMC833", "LMC837"
                ' FFEM用送状(西濃[LMC719]/西濃着払[LMC833]/第一貨物[LMC826])
                map.Add("DEST_AD_4", "DEST_AD_4")
                map.Add("DEST_AD_5", "DEST_AD_5")

                If Me._Row.Item("MATOME_FLG").Equals("1") = False Then 'まとめの以外
                    map.Add("AUTO_DENP_KBN", "AUTO_DENP_KBN")
                    map.Add("AUTO_DENP_NO", "AUTO_DENP_NO")
                End If

            Case "LMC560", "LMC562", "LMC591"
                '西濃、久留米、ヤマト印刷時（サクラ省略商品名対応
                map.Add("AUTO_DENP_KBN", "AUTO_DENP_KBN")
                map.Add("AUTO_DENP_NO", "AUTO_DENP_NO")
                '2012.08.15 省略商品名対応
                If LMConst.FLG.ON.Equals(Me._Row.Item("PTN_FLAG").ToString()) = False Then
                    map.Add("SIMPLE_GOODS_NM", "SIMPLE_GOODS_NM")

                End If
            Case Else
                If Me._Row.Item("MATOME_FLG").Equals("1") = False Then 'まとめの以外
                    '2016.07.23 ADD --STT
                    map.Add("AUTO_DENP_KBN", "AUTO_DENP_KBN")
                    map.Add("AUTO_DENP_NO", "AUTO_DENP_NO")
                    '2016.07.23 ADD --END
                End If
        End Select
        ds = MyBase.SetSelectResultToDataSet(map, ds, reader, "LMC560OUT")

        Return ds

    End Function

    '@(2012.06.06) 纏め送り状対応 --- START ---
    ''' <summary>
    ''' 纏め条件の取得処理
    ''' </summary>
    ''' <param name="ds">DataSet</param>
    ''' <returns>DataSet</returns>
    ''' <remarks></remarks>
    Private Function SelectMatomeIN(ByVal ds As DataSet) As DataSet

        'DataSetのIN情報を取得
        Dim inTbl As DataTable = ds.Tables("LMC560IN")

        'INTableの条件rowの格納
        Me._Row = inTbl.Rows(0)

        'SQLパラメータ初期化
        Me._SqlPrmList = New ArrayList()

        'SQL格納変数の初期化
        Me._StrSql = New StringBuilder()

        Me._StrSql.Append(LMC560DAC.SQL_SELECT_MATOME_IN)
        Me._StrSql.Append(LMC560DAC.SQL_FROM_MATOME_IN)

        'スキーマ名設定
        Dim sql As String = Me.SetSchemaNm(Me._StrSql.ToString(), Me._Row.Item("NRS_BR_CD").ToString())

        'SQL文のコンパイル
        Dim cmd As SqlCommand = MyBase.CreateSqlCommand(sql)

        'パラメータ設定
        Call Me.SetOutkaParameter(inTbl, Me._SqlPrmList)

        'パラメータの反映
        For Each obj As Object In Me._SqlPrmList
            cmd.Parameters.Add(obj)
        Next

        MyBase.Logger.WriteSQLLog("LMC560DAC", "SelectMatomeIN", cmd)

        'SQLの発行
        Dim reader As SqlDataReader = MyBase.GetSelectResult(cmd)

        Dim map As Hashtable = New Hashtable()

        '取得データの格納先をマッピング
        map.Add("NRS_BR_CD", "NRS_BR_CD")
        map.Add("CUST_CD_L", "CUST_CD_L")
        map.Add("CUST_CD_M", "CUST_CD_M")
        map.Add("OUTKA_PLAN_DATE", "OUTKA_PLAN_DATE")
        map.Add("ARR_PLAN_DATE", "ARR_PLAN_DATE")
        map.Add("UNSO_CD", "UNSO_CD")
        map.Add("UNSO_BR_CD", "UNSO_BR_CD")
        map.Add("DEST_CD", "DEST_CD")

        ds = MyBase.SetSelectResultToDataSet(map, ds, reader, "LMC560IN_MATOME")

        Return ds

    End Function
    ''' <summary>
    ''' 纏めデータ取得処理
    ''' </summary>
    ''' <param name="ds">DataSet</param>
    ''' <returns>DataSet</returns>
    ''' <remarks></remarks>
    Private Function SelectMatomeORDER(ByVal ds As DataSet) As DataSet

        'DataSetのIN情報を取得
        Dim inTbl As DataTable = ds.Tables("LMC560IN_MATOME")

        'INTableの条件rowの格納
        Me._MRow = inTbl.Rows(0)

        'SQLパラメータ初期化
        Me._SqlPrmList = New ArrayList()

        'SQL格納変数の初期化
        Me._StrSql = New StringBuilder()

        Me._StrSql.Append(LMC560DAC.SQL_SELECT_MATOME_ORDER2)
        Me._StrSql.Append(LMC560DAC.SQL_SELECT_MATOME_ORDER)

#If False Then      'UPD v2018/08/07 依頼番号 : 001572  
        Me._StrSql.Append(LMC560DAC.SQL_FROM_MATOME_ORDER)

#Else
        If ("1").Equals(ds.Tables("LMC560IN").Rows(0).Item("MATOME_SELECT_FLG").ToString.Trim) Then

            '纏め送状(選択)
            Dim outkal_SelectAll As String = SetOutka_No_LNichiiko(ds)

            Me._StrSql.Append("  FROM $LM_TRN$..C_OUTKA_L OUTL                                                                  " & vbNewLine)
            Me._StrSql.Append("       --F運送L                                                                                  " & vbNewLine)
            Me._StrSql.Append("       LEFT JOIN $LM_TRN$..F_UNSO_L FL                                                           " & vbNewLine)
            Me._StrSql.Append("              ON FL.MOTO_DATA_KB = '20'                                                          " & vbNewLine)
            Me._StrSql.Append("             AND FL.NRS_BR_CD    = OUTL.NRS_BR_CD                                                " & vbNewLine)
            Me._StrSql.Append("             AND FL.INOUTKA_NO_L = OUTL.OUTKA_NO_L                                               " & vbNewLine)
            Me._StrSql.Append("             AND FL.SYS_DEL_FLG  = '0'                                                           " & vbNewLine)
            Me._StrSql.Append(" --  LEFT JOIN $LM_TRN$..C_OUTKA_M OUTM                    --DEL 2018/09/25     依頼番号 : 002487                                        " & vbNewLine)
            Me._StrSql.Append(" --         ON OUTL.NRS_BR_CD  = OUTM.NRS_BR_CD                                                    " & vbNewLine)
            Me._StrSql.Append(" --        AND OUTL.OUTKA_NO_L = OUTM.OUTKA_NO_L                                                   " & vbNewLine)
            Me._StrSql.Append(" --        AND OUTM.SYS_DEL_FLG  = '0'                                                             " & vbNewLine)
            Me._StrSql.Append(" --  LEFT JOIN $LM_TRN$..C_OUTKA_S OUTS                                                            " & vbNewLine)
            Me._StrSql.Append(" --         ON OUTM.NRS_BR_CD  = OUTS.NRS_BR_CD                                                    " & vbNewLine)
            Me._StrSql.Append(" --        AND OUTM.OUTKA_NO_L = OUTS.OUTKA_NO_L                                                   " & vbNewLine)
            Me._StrSql.Append(" --        AND OUTM.OUTKA_NO_M = OUTS.OUTKA_NO_M                                                   " & vbNewLine)
            Me._StrSql.Append(" --        AND OUTS.SYS_DEL_FLG  = '0'                                                             " & vbNewLine)
            Me._StrSql.Append("	--  LEFT JOIN $LM_MST$..M_GOODS MG                                                                " & vbNewLine)
            Me._StrSql.Append("	--         ON OUTM.NRS_BR_CD     = MG.NRS_BR_CD                                                   " & vbNewLine)
            Me._StrSql.Append("	--        AND OUTM.GOODS_CD_NRS  = MG.GOODS_CD_NRS                                                " & vbNewLine)
            Me._StrSql.Append(" WHERE OUTL.SYS_DEL_FLG     = '0'                                                                " & vbNewLine)
            Me._StrSql.Append("   AND OUTL.NRS_BR_CD       = @NRS_BR_CD                                                         " & vbNewLine)
            Me._StrSql.Append("   AND OUTL.CUST_CD_L       = @CUST_CD_L                                                         " & vbNewLine)
            Me._StrSql.Append("   AND OUTL.CUST_CD_M       = @CUST_CD_M                                                         " & vbNewLine)
            Me._StrSql.Append("   AND OUTL.OUTKA_PLAN_DATE = @OUTKA_PLAN_DATE                                                   " & vbNewLine)
            Me._StrSql.Append("   AND OUTL.ARR_PLAN_DATE   = @ARR_PLAN_DATE                                                     " & vbNewLine)
            Me._StrSql.Append("   AND FL.UNSO_CD           = @UNSO_CD                                                           " & vbNewLine)
            Me._StrSql.Append("   AND FL.UNSO_BR_CD        = @UNSO_BR_CD                                                        " & vbNewLine)
            Me._StrSql.Append("   AND OUTL.DEST_CD         = @DEST_CD                                                           " & vbNewLine)
            Me._StrSql.Append("   AND OUTL.OUTKA_NO_L  IN(" & outkal_SelectAll & ")                                             " & vbNewLine)

        Else
            Me._StrSql.Append(LMC560DAC.SQL_FROM_MATOME_ORDER)
        End If

#End If

#If False Then      ' UPD 2018/09/25     依頼番号 : 002487
        Me._StrSql.Append(LMC560DAC.SQL_GROUP_BY_MATOME_ORDER)
        Me._StrSql.Append(LMC560DAC.SQL_GROUP_BY_MATOME_ORDER2)
#Else
        Me._StrSql.Append("   ) BASE                        " & vbNewLine)
#End If

        'スキーマ名設定
        Dim sql As String = Me.SetSchemaNm(Me._StrSql.ToString(), Me._Row.Item("NRS_BR_CD").ToString())

        'SQL文のコンパイル
        Dim cmd As SqlCommand = MyBase.CreateSqlCommand(sql)

        'パラメータ設定
        Call Me.SetOutkaParameterMatome(inTbl, Me._SqlPrmList)

        'パラメータの反映
        For Each obj As Object In Me._SqlPrmList
            cmd.Parameters.Add(obj)
        Next

        MyBase.Logger.WriteSQLLog("LMC560DAC", "SelectMatomeORDER", cmd)

        'SQLの発行
        Dim reader As SqlDataReader = MyBase.GetSelectResult(cmd)

        Dim map As Hashtable = New Hashtable()

        '取得データの格納先をマッピング
        map.Add("NRS_BR_CD", "NRS_BR_CD")
        map.Add("CUST_CD_L", "CUST_CD_L")
        map.Add("CUST_CD_M", "CUST_CD_M")
        map.Add("OUTKA_PLAN_DATE", "OUTKA_PLAN_DATE")
        map.Add("ARR_PLAN_DATE", "ARR_PLAN_DATE")
        map.Add("UNSO_CD", "UNSO_CD")
        map.Add("UNSO_BR_CD", "UNSO_BR_CD")
        map.Add("DEST_CD", "DEST_CD")
        map.Add("CUST_ORD_NO", "CUST_ORD_NO")
        map.Add("OUTKA_NO_L", "OUTKA_NO_L")             'ADD 2018/09/25     依頼番号 : 002487 
        'map.Add("BETU_WT", "BETU_WT")
        'map.Add("UNSO_WT", "UNSO_WT")
        'map.Add("UNSO_PKG_NB", "UNSO_PKG_NB")
        'map.Add("OUTKA_PKG_NB", "OUTKA_PKG_NB")

        ds = MyBase.SetSelectResultToDataSet(map, ds, reader, "LMC560OUT_MATOME_ORD")

        Return ds

    End Function
    ''' <summary>
    ''' 纏めデータ取得処理
    ''' </summary>
    ''' <param name="ds">DataSet</param>
    ''' <returns>DataSet</returns>
    ''' <remarks></remarks>
    Private Function SelectMatomeOUT(ByVal ds As DataSet) As DataSet

        'DataSetのIN情報を取得
        Dim inTbl As DataTable = ds.Tables("LMC560IN_MATOME")

        'INTableの条件rowの格納
        Me._MRow = inTbl.Rows(0)

        'SQLパラメータ初期化
        Me._SqlPrmList = New ArrayList()

        'SQL格納変数の初期化
        Me._StrSql = New StringBuilder()

        Me._StrSql.Append(LMC560DAC.SQL_SELECT_MATOME_OUT2)
        Me._StrSql.Append(LMC560DAC.SQL_SELECT_MATOME_OUT)

#If False Then      'UPD v2018/08/07 依頼番号 : 001572  
        Me._StrSql.Append(LMC560DAC.SQL_FROM_MATOME_OUT)
#Else
        If ("1").Equals(ds.Tables("LMC560IN").Rows(0).Item("MATOME_SELECT_FLG").ToString.Trim) Then

            '纏め送状(選択)
            Dim outkal_SelectAll As String = SetOutka_No_LNichiiko(ds)

            Me._StrSql.Append("  FROM $LM_TRN$..C_OUTKA_L OUTL                                                                  " & vbNewLine)
            Me._StrSql.Append("       --F運送L                                                                                  " & vbNewLine)
            Me._StrSql.Append("       LEFT JOIN $LM_TRN$..F_UNSO_L FL                                                           " & vbNewLine)
            Me._StrSql.Append("              ON FL.MOTO_DATA_KB = '20'                                                          " & vbNewLine)
            Me._StrSql.Append("             AND FL.NRS_BR_CD    = OUTL.NRS_BR_CD                                                " & vbNewLine)
            Me._StrSql.Append("             AND FL.INOUTKA_NO_L = OUTL.OUTKA_NO_L                                               " & vbNewLine)
            Me._StrSql.Append("             AND FL.SYS_DEL_FLG  = '0'                                                           " & vbNewLine)
            Me._StrSql.Append("   LEFT JOIN $LM_TRN$..C_OUTKA_M OUTM                                                            " & vbNewLine)
            Me._StrSql.Append("          ON OUTL.NRS_BR_CD  = OUTM.NRS_BR_CD                                                    " & vbNewLine)
            Me._StrSql.Append("         AND OUTL.OUTKA_NO_L = OUTM.OUTKA_NO_L                                                   " & vbNewLine)
            Me._StrSql.Append("         AND OUTM.SYS_DEL_FLG  = '0'                                                             " & vbNewLine)
            Me._StrSql.Append("   LEFT JOIN $LM_TRN$..C_OUTKA_S OUTS                                                            " & vbNewLine)
            Me._StrSql.Append("          ON OUTM.NRS_BR_CD  = OUTS.NRS_BR_CD                                                    " & vbNewLine)
            Me._StrSql.Append("         AND OUTM.OUTKA_NO_L = OUTS.OUTKA_NO_L                                                   " & vbNewLine)
            Me._StrSql.Append("         AND OUTM.OUTKA_NO_M = OUTS.OUTKA_NO_M                                                   " & vbNewLine)
            Me._StrSql.Append("         AND OUTS.SYS_DEL_FLG  = '0'                                                             " & vbNewLine)
            Me._StrSql.Append("	  LEFT JOIN $LM_MST$..M_GOODS MG                                                             " & vbNewLine)
            Me._StrSql.Append("	         ON OUTM.NRS_BR_CD     = MG.NRS_BR_CD                                                " & vbNewLine)
            Me._StrSql.Append("	        AND OUTM.GOODS_CD_NRS  = MG.GOODS_CD_NRS                                             " & vbNewLine)
            Me._StrSql.Append(" WHERE OUTL.SYS_DEL_FLG     = '0'                                                                " & vbNewLine)
            Me._StrSql.Append("   AND OUTL.NRS_BR_CD       = @NRS_BR_CD                                                         " & vbNewLine)
            Me._StrSql.Append("   AND OUTL.CUST_CD_L       = @CUST_CD_L                                                         " & vbNewLine)
            Me._StrSql.Append("   AND OUTL.CUST_CD_M       = @CUST_CD_M                                                         " & vbNewLine)
            Me._StrSql.Append("   AND OUTL.OUTKA_PLAN_DATE = @OUTKA_PLAN_DATE                                                   " & vbNewLine)
            Me._StrSql.Append("   AND OUTL.ARR_PLAN_DATE   = @ARR_PLAN_DATE                                                     " & vbNewLine)
            Me._StrSql.Append("   AND FL.UNSO_CD           = @UNSO_CD                                                           " & vbNewLine)
            Me._StrSql.Append("   AND FL.UNSO_BR_CD        = @UNSO_BR_CD                                                        " & vbNewLine)
            Me._StrSql.Append("   AND OUTL.DEST_CD         = @DEST_CD                                                           " & vbNewLine)
            Me._StrSql.Append("   AND OUTL.OUTKA_NO_L  IN(" & outkal_SelectAll & ")                                             " & vbNewLine)

        Else
            Me._StrSql.Append(LMC560DAC.SQL_FROM_MATOME_OUT)
        End If

#End If

        Me._StrSql.Append(LMC560DAC.SQL_GROUP_BY_MATOME_OUT)
        Me._StrSql.Append(LMC560DAC.SQL_GROUP_BY_MATOME_OUT2)

        'スキーマ名設定
        Dim sql As String = Me.SetSchemaNm(Me._StrSql.ToString(), Me._Row.Item("NRS_BR_CD").ToString())

        'SQL文のコンパイル
        Dim cmd As SqlCommand = MyBase.CreateSqlCommand(sql)

        'パラメータ設定
        Call Me.SetOutkaParameterMatome(inTbl, Me._SqlPrmList)

        'パラメータの反映
        For Each obj As Object In Me._SqlPrmList
            cmd.Parameters.Add(obj)
        Next

        MyBase.Logger.WriteSQLLog("LMC560DAC", "SelectMatomeOUT", cmd)

        'SQLの発行
        Dim reader As SqlDataReader = MyBase.GetSelectResult(cmd)

        Dim map As Hashtable = New Hashtable()

        '取得データの格納先をマッピング
        map.Add("NRS_BR_CD", "NRS_BR_CD")
        map.Add("OUTKA_NO_L", "OUTKA_NO_L") '--2018/08/07    依頼番号 : 001572
        map.Add("CUST_CD_L", "CUST_CD_L")
        map.Add("CUST_CD_M", "CUST_CD_M")
        map.Add("OUTKA_PLAN_DATE", "OUTKA_PLAN_DATE")
        map.Add("ARR_PLAN_DATE", "ARR_PLAN_DATE")
        map.Add("UNSO_CD", "UNSO_CD")
        map.Add("UNSO_BR_CD", "UNSO_BR_CD")
        map.Add("DEST_CD", "DEST_CD")
        map.Add("BETU_WT", "BETU_WT")
        map.Add("UNSO_WT", "UNSO_WT")
        map.Add("UNSO_PKG_NB", "UNSO_PKG_NB")
        map.Add("OUTKA_PKG_NB", "OUTKA_PKG_NB")

        ds = MyBase.SetSelectResultToDataSet(map, ds, reader, "LMC560OUT_MATOME")

        Return ds

    End Function

    '@(2012.06.06) 纏め送り状対応 ---  END ---

    ''' <summary>
    ''' 在庫データのチェックデータ取得パラメータ設定(☆作業用コメント：このまま転用)
    ''' </summary>
    ''' <param name="conditiontbl">DataTable</param>
    ''' <param name="prmList">パラメータ</param>
    ''' <remarks></remarks>
    Private Sub SetOutkaParameter(ByVal conditiontbl As DataTable, ByVal prmList As ArrayList)

        With conditiontbl

            '出荷管理番号(大)はWHERE句にてINを使用しているため、結合処理を行った後に設定
            Dim max As Integer = conditiontbl.Rows.Count - 1
            Dim outkaNoL As String = String.Empty

            For i As Integer = 0 To max
                If String.IsNullOrEmpty(outkaNoL) = False Then
                    outkaNoL = String.Concat(outkaNoL, ",")
                End If
                outkaNoL = String.Concat(outkaNoL, conditiontbl.Rows(0).Item("OUTKA_NO_L").ToString())

            Next
            prmList.Add(MyBase.GetSqlParameter("@OUTKA_NO_L", outkaNoL, DBDataType.CHAR))

        End With

        Dim whereStr As String = String.Empty
        '営業所
        whereStr = Me._Row.Item("NRS_BR_CD").ToString()
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@NRS_BR_CD", whereStr, DBDataType.CHAR))

    End Sub

    '@(2012.06.05) 纏め送り状対応 --- START ---
    ''' <summary>
    ''' 帳票種別取得条件文・パラメータ設定モジュール
    ''' </summary>
    ''' <remarks></remarks>
    Private Sub SetOutkaParameterMatome(ByVal conditiontbl As DataTable, ByVal prmList As ArrayList)

        '検索条件部に入力された条件とパラメータ設定
        Dim whereStr As String = String.Empty
        With Me._MRow

            '営業所
            whereStr = .Item("NRS_BR_CD").ToString()
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@NRS_BR_CD", whereStr, DBDataType.CHAR))

            '荷主コード(大)
            whereStr = .Item("CUST_CD_L").ToString()
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@CUST_CD_L", whereStr, DBDataType.CHAR))

            '荷主コード(中)
            whereStr = .Item("CUST_CD_M").ToString()
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@CUST_CD_M", whereStr, DBDataType.CHAR))

            '出荷日
            whereStr = .Item("OUTKA_PLAN_DATE").ToString()
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@OUTKA_PLAN_DATE", whereStr, DBDataType.CHAR))

            '納入日
            whereStr = .Item("ARR_PLAN_DATE").ToString()
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@ARR_PLAN_DATE", whereStr, DBDataType.CHAR))

            '運送会社コード
            whereStr = .Item("UNSO_CD").ToString()
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@UNSO_CD", whereStr, DBDataType.NVARCHAR))

            '運送会社支店コード
            whereStr = .Item("UNSO_BR_CD").ToString()
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@UNSO_BR_CD", whereStr, DBDataType.NVARCHAR))

            '届先コード
            whereStr = .Item("DEST_CD").ToString()
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@DEST_CD", whereStr, DBDataType.NVARCHAR))

        End With

    End Sub
    '@(2012.06.05) 纏め送り状対応 ---  END  ---

#If True Then   'ADD 2018/08/02 千葉　日医工対応　依頼番号 001572 

    ''' <summary>
    ''' 帳票種別取得条件文・パラメータ設定モジュール(2012/06/15 notes 1160まとめ用)
    ''' </summary>
    ''' <remarks></remarks>
    Private Function SetOutka_No_LNichiiko(ByVal ds As DataSet) As String

        Dim conditiontbl As DataTable = ds.Tables("LMC560IN_SELECT_ALL")

        Dim outkaNoL As String = String.Empty


        With conditiontbl

            '出荷管理番号(大)はWHERE句にてINを使用しているため、結合処理を行った後に設定
            Dim max As Integer = conditiontbl.Rows.Count - 1

            For i As Integer = 0 To max
                If String.IsNullOrEmpty(outkaNoL) = False Then

                    If (i).Equals(0) = False Then
                        outkaNoL = String.Concat(outkaNoL, "' , '")
                    End If

                End If
                outkaNoL = String.Concat(outkaNoL, conditiontbl.Rows(i).Item("OUTKA_NO_L").ToString())

            Next
            'IN での　GetSqlParameterが有効にならないので
            'prmList.Add(MyBase.GetSqlParameter("@OUTKA_NO_L", outkaNoL, DBDataType.VARCHAR))


            outkaNoL = String.Concat("'" & outkaNoL & "'")
        End With

        Return outkaNoL

    End Function

    ''' <summary>
    ''' 帳票種別取得条件文・パラメータ設定モジュール(2012/06/15 notes 1160まとめ用)
    ''' </summary>
    ''' <remarks></remarks>
    Private Sub SetOutkaParameterNichiiko(ByVal ds As DataSet, ByVal prmList As ArrayList)

        ''Dim conditiontbl As DataTable = ds.Tables("LMC560IN_SELECT_ALL")

        ''With conditiontbl

        ''    '出荷管理番号(大)はWHERE句にてINを使用しているため、結合処理を行った後に設定
        ''    Dim max As Integer = conditiontbl.Rows.Count - 1
        ''    Dim outkaNoL As String = String.Empty

        ''    For i As Integer = 0 To max
        ''        If String.IsNullOrEmpty(outkaNoL) = False Then

        ''            If (i).Equals(0) = False Then
        ''                outkaNoL = String.Concat(outkaNoL, "','")
        ''            End If

        ''        End If
        ''        outkaNoL = String.Concat(outkaNoL, conditiontbl.Rows(i).Item("OUTKA_NO_L").ToString())

        ''    Next
        ''    'IN での　GetSqlParameterが有効にならないので
        ''    'prmList.Add(MyBase.GetSqlParameter("@OUTKA_NO_L", outkaNoL, DBDataType.VARCHAR))
        ''    _OUTKA_NO_L = outkaNoL
        ''End With

        Dim whereStr As String = String.Empty

        '検索条件部に入力された条件とパラメータ設定
        With Me._MRow

            '営業所
            whereStr = .Item("NRS_BR_CD").ToString()
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@NRS_BR_CD", whereStr, DBDataType.CHAR))

            '荷主コード(大)
            whereStr = .Item("CUST_CD_L").ToString()
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@CUST_CD_L", whereStr, DBDataType.CHAR))

            '荷主コード(中)
            whereStr = .Item("CUST_CD_M").ToString()
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@CUST_CD_M", whereStr, DBDataType.CHAR))

            '出荷日
            whereStr = .Item("OUTKA_PLAN_DATE").ToString()
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@OUTKA_PLAN_DATE", whereStr, DBDataType.CHAR))

            '納入日
            whereStr = .Item("ARR_PLAN_DATE").ToString()
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@ARR_PLAN_DATE", whereStr, DBDataType.CHAR))

            '運送会社コード
            whereStr = .Item("UNSO_CD").ToString()
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@UNSO_CD", whereStr, DBDataType.NVARCHAR))

            '運送会社支店コード
            whereStr = .Item("UNSO_BR_CD").ToString()
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@UNSO_BR_CD", whereStr, DBDataType.NVARCHAR))

            '届先コード
            whereStr = .Item("DEST_CD").ToString()
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@DEST_CD", whereStr, DBDataType.NVARCHAR))

        End With

    End Sub
#End If

    ''' <summary>
    ''' 帳票種別取得条件文・パラメータ設定モジュール(2012/06/15 notes 1160まとめ用)
    ''' </summary>
    ''' <remarks></remarks>
    Private Sub SetOutkaParameterMatomeMeisai(ByVal conditiontbl As DataTable, ByVal prmList As ArrayList)


        With conditiontbl

            '出荷管理番号(大)はWHERE句にてINを使用しているため、結合処理を行った後に設定
            Dim max As Integer = conditiontbl.Rows.Count - 1
            Dim outkaNoL As String = String.Empty

            For i As Integer = 0 To max
                If String.IsNullOrEmpty(outkaNoL) = False Then
                    outkaNoL = String.Concat(outkaNoL, ",")
                End If
                outkaNoL = String.Concat(outkaNoL, conditiontbl.Rows(0).Item("OUTKA_NO_L").ToString())

            Next
            prmList.Add(MyBase.GetSqlParameter("@OUTKA_NO_L", outkaNoL, DBDataType.CHAR))

        End With

        Dim whereStr As String = String.Empty

        '検索条件部に入力された条件とパラメータ設定
        With Me._MRow

            '営業所
            whereStr = .Item("NRS_BR_CD").ToString()
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@NRS_BR_CD", whereStr, DBDataType.CHAR))

            '荷主コード(大)
            whereStr = .Item("CUST_CD_L").ToString()
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@CUST_CD_L", whereStr, DBDataType.CHAR))

            '荷主コード(中)
            whereStr = .Item("CUST_CD_M").ToString()
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@CUST_CD_M", whereStr, DBDataType.CHAR))

            '出荷日
            whereStr = .Item("OUTKA_PLAN_DATE").ToString()
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@OUTKA_PLAN_DATE", whereStr, DBDataType.CHAR))

            '納入日
            whereStr = .Item("ARR_PLAN_DATE").ToString()
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@ARR_PLAN_DATE", whereStr, DBDataType.CHAR))

            '運送会社コード
            whereStr = .Item("UNSO_CD").ToString()
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@UNSO_CD", whereStr, DBDataType.NVARCHAR))

            '運送会社支店コード
            whereStr = .Item("UNSO_BR_CD").ToString()
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@UNSO_BR_CD", whereStr, DBDataType.NVARCHAR))

            '届先コード
            whereStr = .Item("DEST_CD").ToString()
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@DEST_CD", whereStr, DBDataType.NVARCHAR))

        End With

    End Sub


    ''' <summary>
    ''' 帳票種別取得条件文・パラメータ設定モジュール(2012/06/15 notes 1160まとめ用)
    ''' </summary>
    ''' <remarks></remarks>
    Private Sub SetOutkaParameter_Unso_707(ByVal conditiontbl As DataTable, ByVal prmList As ArrayList)


        With conditiontbl

            '出荷管理番号(大)はWHERE句にてINを使用しているため、結合処理を行った後に設定
            Dim max As Integer = conditiontbl.Rows.Count - 1
            Dim outkaNoL As String = String.Empty

            For i As Integer = 0 To max
                If String.IsNullOrEmpty(outkaNoL) = False Then
                    outkaNoL = String.Concat(outkaNoL, ",")
                End If
                outkaNoL = String.Concat(outkaNoL, conditiontbl.Rows(0).Item("OUTKA_NO_L").ToString())

            Next
            prmList.Add(MyBase.GetSqlParameter("@OUTKA_NO_L", outkaNoL, DBDataType.CHAR))

        End With

        Dim whereStr As String = String.Empty

        '検索条件部に入力された条件とパラメータ設定
        With Me._MRow

            '営業所
            whereStr = .Item("NRS_BR_CD").ToString()
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@NRS_BR_CD", whereStr, DBDataType.CHAR))

            '荷主コード(大)
            whereStr = .Item("CUST_CD_L").ToString()
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@CUST_CD_L", whereStr, DBDataType.CHAR))

            '荷主コード(中)
            whereStr = .Item("CUST_CD_M").ToString()
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@CUST_CD_M", whereStr, DBDataType.CHAR))

            '出荷日
            whereStr = .Item("OUTKA_PLAN_DATE").ToString()
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@OUTKA_PLAN_DATE", whereStr, DBDataType.CHAR))

            '納入日
            whereStr = .Item("ARR_PLAN_DATE").ToString()
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@ARR_PLAN_DATE", whereStr, DBDataType.CHAR))

            '運送会社コード
            whereStr = .Item("UNSO_CD").ToString()
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@UNSO_CD", whereStr, DBDataType.NVARCHAR))

            '運送会社支店コード
            whereStr = .Item("UNSO_BR_CD").ToString()
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@UNSO_BR_CD", whereStr, DBDataType.NVARCHAR))

            '届先コード 
            whereStr = .Item("DEST_CD").ToString()
            Me._SqlPrmList.Add(MyBase.GetSqlParameter("@DEST_CD", whereStr, DBDataType.NVARCHAR))

        End With

    End Sub

    'ADD Start 2022/12/28 アフトン別名出荷対応
    ''' <summary>
    '''セミEDI出荷指示取込時の商品名取得処理
    ''' </summary>
    ''' <param name="ds">DataSet</param>
    ''' <returns>DataSet</returns>
    Private Function SelectOutkaediGoodsnm(ByVal ds As DataSet) As DataSet

        'DataSetのIN情報を取得
        Dim inTbl As DataTable = ds.Tables("LMC560IN")

        'INTableの条件rowの格納
        Me._Row = inTbl.Rows(0)

        'SQLパラメータ初期化
        Me._SqlPrmList = New ArrayList()

        'SQL格納変数の初期化
        Me._StrSql = New StringBuilder()

        '出荷管理番号の設定
        Dim outkaNoL As String = SetOutkaNoLOutkaediGoodsnm(inTbl)

        'SQL作成(フラグ = '1'の場合、運送データ)
        If LMConst.FLG.ON.Equals(Me._Row.Item("PTN_FLAG").ToString()) = True Then
            Me._StrSql.Append(LMC560DAC.SQL_SELECT_OUTKAEDI_GOODSNM_UNSO)
            Me._StrSql.Append("   AND FUL.UNSO_NO_L IN (" & outkaNoL & ") " & vbNewLine)

        Else
            Me._StrSql.Append(LMC560DAC.SQL_SELECT_OUTKAEDI_GOODSNM_OUTKA)
            Me._StrSql.Append("   AND COL.OUTKA_NO_L IN (" & outkaNoL & ") " & vbNewLine)

        End If

        'スキーマ名設定
        Dim sql As String = Me.SetSchemaNm(Me._StrSql.ToString(), Me._Row.Item("NRS_BR_CD").ToString())

        'SQL文のコンパイル
        Dim cmd As SqlCommand = MyBase.CreateSqlCommand(sql)

        'パラメータ設定
        Call Me.SetOutkaediGoodsnmParameter(Me._SqlPrmList)

        'パラメータの反映
        For Each obj As Object In Me._SqlPrmList
            cmd.Parameters.Add(obj)
        Next

        MyBase.Logger.WriteSQLLog("LMC560DAC", "SelectOutkaediGoodsnm", cmd)

        'SQLの発行
        Dim reader As SqlDataReader = MyBase.GetSelectResult(cmd)

        Dim map As Hashtable = New Hashtable()

        '取得データの格納先をマッピング
        map.Add("NRS_BR_CD", "NRS_BR_CD")
        map.Add("OUTKA_NO_L", "OUTKA_NO_L")
        map.Add("GOODS_NM", "GOODS_NM")

        ds = MyBase.SetSelectResultToDataSet(map, ds, reader, "LMC560OUT_OUTKAEDI_GOODSNM")

        Return ds

    End Function
    'ADD End   2022/12/28 アフトン別名出荷対応

    'ADD Start 2022/12/28 アフトン別名出荷対応
    ''' <summary>
    ''' セミEDI出荷指示取込時の商品名取得パラメータ設定モジュール（出荷管理番号）
    ''' </summary>
    ''' <param name="conditiontbl">DataTable</param>
    ''' <remarks></remarks>
    Private Function SetOutkaNoLOutkaediGoodsnm(ByVal conditiontbl As DataTable) As String

        '出荷管理番号(大)はWHERE句にてINを使用しているため、結合処理を行った後に設定
        Dim max As Integer = conditiontbl.Rows.Count - 1
        Dim outkaNoL As String = String.Empty

        For i As Integer = 0 To max
            If String.IsNullOrEmpty(outkaNoL) = False Then
                outkaNoL = String.Concat(outkaNoL, "' , '")
            End If
            outkaNoL = String.Concat(outkaNoL, conditiontbl.Rows(i).Item("OUTKA_NO_L").ToString())
        Next

        outkaNoL = String.Concat("'", outkaNoL, "'")

        Return outkaNoL

    End Function
    'ADD End   2022/12/28 アフトン別名出荷対応

    'ADD Start 2022/12/28 アフトン別名出荷対応
    ''' <summary>
    ''' セミEDI出荷指示取込時の商品名取得パラメータ設定
    ''' </summary>
    ''' <param name="prmList">パラメータ</param>
    ''' <remarks></remarks>
    Private Sub SetOutkaediGoodsnmParameter(ByVal prmList As ArrayList)

        'B2：セミEDI出荷指示取込データの商品名表示フラグ
        Const SubKb As String = "B2"

        Dim whereStr As String = String.Empty
        '営業所
        whereStr = Me._Row.Item("NRS_BR_CD").ToString()
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@NRS_BR_CD", whereStr, DBDataType.CHAR))

        '設定値
        whereStr = LMConst.FLG.ON
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@SET_NAIYO", whereStr, DBDataType.CHAR))

        '用途区分
        whereStr = SubKb
        Me._SqlPrmList.Add(MyBase.GetSqlParameter("@SUB_KB", whereStr, DBDataType.CHAR))

    End Sub
    'ADD End   2022/12/28 アフトン別名出荷対応

#End Region

#Region "設定処理"

#Region "SQL"

    ''' <summary>
    ''' スキーマ名称設定
    ''' </summary>
    ''' <remarks></remarks>
    Private Function SetSchemaNm(ByVal sql As String, ByVal brCd As String) As String

        'トラン系スキーマ名設定
        sql = sql.Replace("$LM_TRN$", MyBase.GetDatabaseName(brCd, DBKbn.TRN))

        'マスタ系スキーマ名設定
        sql = sql.Replace("$LM_MST$", MyBase.GetDatabaseName(brCd, DBKbn.MST))

        Return sql

    End Function

#End Region

#End Region

#End Region

End Class
