' ==========================================================================
'  システム名       :  LM
'  サブシステム名   :  LMC       : 出荷管理
'  プログラムID     :  LMC500    : 納品書印刷（定数定義のみ）
'  作  成  者       :  [SAGAWA]
' ==========================================================================
'  LMC500DACのファイル肥大化によりVSが落ちるので対策としてある程度分割
' ==========================================================================

''' <summary>
''' LMC500DAC_Constクラス
''' </summary>
''' <remarks></remarks>
Public Class LMC500DAC_Const1

#Region "Const"

#Region "検索処理 SQL"

#Region "SELECT句(MPrt)"
    ''' <summary>
    ''' 帳票種別取得用(出荷テーブル参照)
    ''' </summary>
    ''' <remarks></remarks>
    Friend Const SQL_SELECT_MPrt_OUTKA As String = "SELECT DISTINCT                                                           " & vbNewLine _
                                                  & " OUTL.NRS_BR_CD                                           AS NRS_BR_CD    " & vbNewLine _
                                                  & ",'04'                                                     AS PTN_ID       " & vbNewLine _
                                                  & "---,CASE WHEN @IKKATU_FLG = '1' AND MR4.PTN_CD IS NOT NULL THEN MR4.PTN_CD   " & vbNewLine _
                                                  & ",CASE    WHEN MR2.PTN_CD IS NOT NULL THEN MR2.PTN_CD                      " & vbNewLine _
                                                  & "         WHEN @IKKATU_FLG = '1' AND MR4.PTN_CD IS NOT NULL THEN MR4.PTN_CD   " & vbNewLine _
                                                  & "		  When MR1.PTN_CD Is Not NULL Then MR1.PTN_CD                      " & vbNewLine _
                                                  & "	 	  Else MR3.PTN_CD End                              As PTN_CD       " & vbNewLine _
                                                  & "--,Case When @IKKATU_FLG = '1' AND MR4.PTN_CD IS NOT NULL THEN MR4.RPT_ID   " & vbNewLine _
                                                  & ",CASE    WHEN MR2.PTN_CD IS NOT NULL THEN MR2.RPT_ID                        " & vbNewLine _
                                                  & "         WHEN @IKKATU_FLG = '1' AND MR4.PTN_CD IS NOT NULL THEN MR4.RPT_ID  " & vbNewLine _
                                                  & "  		  WHEN MR1.PTN_CD IS NOT NULL THEN MR1.RPT_ID                      " & vbNewLine _
                                                  & "		  ELSE MR3.RPT_ID END                              AS RPT_ID       " & vbNewLine

    ''' <summary>
    ''' 帳票種別取得用(運送テーブル参照)
    ''' </summary>
    ''' <remarks></remarks>
    Friend Const SQL_SELECT_MPrt_UNSO As String = "SELECT DISTINCT                                                            " & vbNewLine _
                                                 & " UNSOL.NRS_BR_CD                                           AS NRS_BR_CD    " & vbNewLine _
                                                 & ",'04'                                                      AS PTN_ID       " & vbNewLine _
                                                 & ",CASE WHEN MR2.PTN_CD IS NOT NULL THEN MR2.PTN_CD                          " & vbNewLine _
                                                 & "		  WHEN MR1.PTN_CD IS NOT NULL THEN MR1.PTN_CD                      " & vbNewLine _
                                                 & "	 	  ELSE MR3.PTN_CD END                              AS PTN_CD       " & vbNewLine _
                                                 & ",CASE WHEN MR2.PTN_CD IS NOT NULL THEN MR2.RPT_ID                          " & vbNewLine _
                                                 & "  		  WHEN MR1.PTN_CD IS NOT NULL THEN MR1.RPT_ID                      " & vbNewLine _
                                                 & "		  ELSE MR3.RPT_ID END                              AS RPT_ID       " & vbNewLine


    ''' <summary>
    ''' 帳票種別取得用(出荷テーブル参照)
    ''' </summary>
    ''' <remarks></remarks>
    Friend Const SQL_FROM_MPrt_OUTKA As String = "FROM                                                               " & vbNewLine _
                                                & "--出荷L                                                            " & vbNewLine _
                                                & "$LM_TRN$..C_OUTKA_L OUTL                                           " & vbNewLine _
                                                & "--出荷M                                                            " & vbNewLine _
                                                & "LEFT JOIN $LM_TRN$..C_OUTKA_M OUTM                                 " & vbNewLine _
                                                & "ON  OUTM.SYS_DEL_FLG = '0'                                         " & vbNewLine _
                                                & "AND OUTM.NRS_BR_CD = OUTL.NRS_BR_CD                                " & vbNewLine _
                                                & "AND OUTM.OUTKA_NO_L = OUTL.OUTKA_NO_L                              " & vbNewLine _
                                                & "--商品M                                                            " & vbNewLine _
                                                & "LEFT JOIN $LM_MST$..M_GOODS MG                                     " & vbNewLine _
                                                & "ON  MG.SYS_DEL_FLG = '0'                                           " & vbNewLine _
                                                & "AND MG.NRS_BR_CD = OUTM.NRS_BR_CD                                  " & vbNewLine _
                                                & "AND MG.GOODS_CD_NRS = OUTM.GOODS_CD_NRS                            " & vbNewLine _
                                                & "--出荷Lでの荷主帳票パターン取得                                    " & vbNewLine _
                                                & "LEFT JOIN $LM_MST$..M_CUST_RPT MCR1                                " & vbNewLine _
                                                & "ON  OUTL.NRS_BR_CD = MCR1.NRS_BR_CD                                " & vbNewLine _
                                                & "AND OUTL.CUST_CD_L = MCR1.CUST_CD_L                                " & vbNewLine _
                                                & "AND OUTL.CUST_CD_M = MCR1.CUST_CD_M                                " & vbNewLine _
                                                & "AND '00' = MCR1.CUST_CD_S                                          " & vbNewLine _
                                                & "AND MCR1.PTN_ID = '04'                                             " & vbNewLine _
                                                & "--帳票パターン取得                                                 " & vbNewLine _
                                                & "LEFT JOIN $LM_MST$..M_RPT MR1                                      " & vbNewLine _
                                                & "ON  MR1.NRS_BR_CD = MCR1.NRS_BR_CD                                 " & vbNewLine _
                                                & "AND MR1.PTN_ID = MCR1.PTN_ID                                       " & vbNewLine _
                                                & "AND MR1.PTN_CD = MCR1.PTN_CD                                       " & vbNewLine _
                                                & "AND MR1.SYS_DEL_FLG = '0'                                          " & vbNewLine _
                                                & "--商品Mの荷主での荷主帳票パターン取得                              " & vbNewLine _
                                                & "LEFT JOIN $LM_MST$..M_CUST_RPT MCR2                                " & vbNewLine _
                                                & "ON  MG.NRS_BR_CD = MCR2.NRS_BR_CD                                  " & vbNewLine _
                                                & "AND MG.CUST_CD_L = MCR2.CUST_CD_L                                  " & vbNewLine _
                                                & "AND MG.CUST_CD_M = MCR2.CUST_CD_M                                  " & vbNewLine _
                                                & "AND MG.CUST_CD_S = MCR2.CUST_CD_S                                  " & vbNewLine _
                                                & "AND MCR2.PTN_ID = '04'                                             " & vbNewLine _
                                                & "--帳票パターン取得                                                 " & vbNewLine _
                                                & "LEFT JOIN $LM_MST$..M_RPT MR2                                      " & vbNewLine _
                                                & "ON  MR2.NRS_BR_CD = MCR2.NRS_BR_CD                                 " & vbNewLine _
                                                & "AND MR2.PTN_ID = MCR2.PTN_ID                                       " & vbNewLine _
                                                & "AND MR2.PTN_CD = MCR2.PTN_CD                                       " & vbNewLine _
                                                & "AND MR2.SYS_DEL_FLG = '0'                                          " & vbNewLine _
                                                & "--存在しない場合の帳票パターン取得                                 " & vbNewLine _
                                                & "LEFT JOIN $LM_MST$..M_RPT MR3                                      " & vbNewLine _
                                                & "ON  MR3.NRS_BR_CD = OUTL.NRS_BR_CD                                 " & vbNewLine _
                                                & "AND MR3.PTN_ID = '04'                                              " & vbNewLine _
                                                & "AND MR3.STANDARD_FLAG = '01'                                       " & vbNewLine _
                                                & "AND MR3.SYS_DEL_FLG = '0'                                          " & vbNewLine _
                                                & "--千葉一括時の納品書取得　帳票パターン取得 ADD　2022/04/26　028723 " & vbNewLine _
                                                & "LEFT JOIN $LM_MST$..M_RPT MR4                                      " & vbNewLine _
                                                & "ON MR4.NRS_BR_CD = OUTL.NRS_BR_CD                                  " & vbNewLine _
                                                & "AND MR4.PTN_ID = '04'                                              " & vbNewLine _
                                                & "AND MR4.PTN_CD = '52'                                              " & vbNewLine _
                                                & "AND MR4.SYS_DEL_FLG = '0'                                          " & vbNewLine _
                                                & "WHERE                                                              " & vbNewLine _
                                                & "    OUTL.SYS_DEL_FLG = '0'                                         " & vbNewLine

    ''' <summary>
    ''' 帳票種別取得用(運送テーブル参照)
    ''' </summary>
    ''' <remarks></remarks>
    Friend Const SQL_FROM_MPrt_UNSO As String = "FROM                                                               " & vbNewLine _
                                               & "--運送L                                                            " & vbNewLine _
                                               & "$LM_TRN$..F_UNSO_L UNSOL                                           " & vbNewLine _
                                               & "--運送M                                                            " & vbNewLine _
                                               & "LEFT JOIN $LM_TRN$..F_UNSO_M UNSOM                                 " & vbNewLine _
                                               & "ON  UNSOM.SYS_DEL_FLG = '0'                                        " & vbNewLine _
                                               & "AND UNSOM.NRS_BR_CD = UNSOL.NRS_BR_CD                              " & vbNewLine _
                                               & "AND UNSOM.UNSO_NO_L = UNSOL.UNSO_NO_L                              " & vbNewLine _
                                               & "--商品M                                                            " & vbNewLine _
                                               & "LEFT JOIN $LM_MST$..M_GOODS MG                                     " & vbNewLine _
                                               & "ON  MG.SYS_DEL_FLG = '0'                                           " & vbNewLine _
                                               & "AND MG.NRS_BR_CD = UNSOM.NRS_BR_CD                                 " & vbNewLine _
                                               & "AND MG.GOODS_CD_NRS = UNSOM.GOODS_CD_NRS                           " & vbNewLine _
                                               & "--運送Lでの荷主帳票パターン取得                                    " & vbNewLine _
                                               & "LEFT JOIN $LM_MST$..M_CUST_RPT MCR1                                " & vbNewLine _
                                               & "ON  UNSOL.NRS_BR_CD = MCR1.NRS_BR_CD                               " & vbNewLine _
                                               & "AND UNSOL.CUST_CD_L = MCR1.CUST_CD_L                               " & vbNewLine _
                                               & "AND UNSOL.CUST_CD_M = MCR1.CUST_CD_M                               " & vbNewLine _
                                               & "AND '00' = MCR1.CUST_CD_S                                          " & vbNewLine _
                                               & "AND MCR1.PTN_ID = '04'                                             " & vbNewLine _
                                               & "--帳票パターン取得                                                 " & vbNewLine _
                                               & "LEFT JOIN $LM_MST$..M_RPT MR1                                      " & vbNewLine _
                                               & "ON  MR1.NRS_BR_CD = MCR1.NRS_BR_CD                                 " & vbNewLine _
                                               & "AND MR1.PTN_ID = MCR1.PTN_ID                                       " & vbNewLine _
                                               & "AND MR1.PTN_CD = MCR1.PTN_CD                                       " & vbNewLine _
                                               & "AND MR1.SYS_DEL_FLG = '0'                                          " & vbNewLine _
                                               & "--商品Mの荷主での荷主帳票パターン取得                              " & vbNewLine _
                                               & "LEFT JOIN $LM_MST$..M_CUST_RPT MCR2                                " & vbNewLine _
                                               & "ON  MG.NRS_BR_CD = MCR2.NRS_BR_CD                                  " & vbNewLine _
                                               & "AND MG.CUST_CD_L = MCR2.CUST_CD_L                                  " & vbNewLine _
                                               & "AND MG.CUST_CD_M = MCR2.CUST_CD_M                                  " & vbNewLine _
                                               & "AND MG.CUST_CD_S = MCR2.CUST_CD_S                                  " & vbNewLine _
                                               & "AND MCR2.PTN_ID = '04'                                             " & vbNewLine _
                                               & "--帳票パターン取得                                                 " & vbNewLine _
                                               & "LEFT JOIN $LM_MST$..M_RPT MR2                                      " & vbNewLine _
                                               & "ON  MR2.NRS_BR_CD = MCR2.NRS_BR_CD                                 " & vbNewLine _
                                               & "AND MR2.PTN_ID = MCR2.PTN_ID                                       " & vbNewLine _
                                               & "AND MR2.PTN_CD = MCR2.PTN_CD                                       " & vbNewLine _
                                               & "AND MR2.SYS_DEL_FLG = '0'                                          " & vbNewLine _
                                               & "--存在しない場合の帳票パターン取得                                 " & vbNewLine _
                                               & "LEFT JOIN $LM_MST$..M_RPT MR3                                      " & vbNewLine _
                                               & "ON  MR3.NRS_BR_CD = UNSOL.NRS_BR_CD                                " & vbNewLine _
                                               & "AND MR3.PTN_ID = '04'                                              " & vbNewLine _
                                               & "AND MR3.STANDARD_FLAG = '01'                                       " & vbNewLine _
                                               & "AND MR3.SYS_DEL_FLG = '0'                                          " & vbNewLine _
                                               & "WHERE                                                              " & vbNewLine _
                                               & "    UNSOL.SYS_DEL_FLG = '0'                                        " & vbNewLine

#End Region

#Region "SELECT句(印刷データ：MAIN)"

    ''' <summary>
    ''' 印刷データ抽出用
    ''' </summary>
    ''' <remarks></remarks>
    Friend Const SQL_SELECT_MAIN1 As String = " --SQL_SELECT_MAIN1                                               " & vbNewLine _
                                            & " SELECT                                                            " & vbNewLine _
                                            & " RPT_ID                                                            " & vbNewLine _
                                            & ",NRS_BR_CD                                                         " & vbNewLine _
                                            & ",PRINT_SORT                                                        " & vbNewLine _
                                            & ",DEST_CD                                                           " & vbNewLine _
                                            & ",DEST_NM                                                           " & vbNewLine _
                                            & ",DEST_AD_1                                                         " & vbNewLine _
                                            & ",DEST_AD_2                                                         " & vbNewLine _
                                            & ",DEST_AD_3                                                         " & vbNewLine _
                                            & ",DEST_TEL                                                          " & vbNewLine _
                                            & ",OUTKA_PLAN_DATE                                                   " & vbNewLine _
                                            & ",CUST_ORD_NO                                                       " & vbNewLine _
                                            & ",BUYER_ORD_NO                                                      " & vbNewLine _
                                            & ",UNSOCO_NM                                                         " & vbNewLine _
                                            & ",ARR_PLAN_DATE                                                     " & vbNewLine _
                                            & ",ARR_PLAN_TIME                                                     " & vbNewLine _
                                            & ",OUTKA_NO_L                                                        " & vbNewLine _
                                            & ",URIG_NM                                                           " & vbNewLine _
                                            & ",CUST_NM_L                                                         " & vbNewLine _
                                            & "--(2012.06.15) 要望番号1155 -- START --                            " & vbNewLine _
                                            & ",CUST_NM_M                                                         " & vbNewLine _
                                            & ",DENPYO_NM                                                         " & vbNewLine _
                                            & "--(2012.06.15) 要望番号1155 --  END  --                            " & vbNewLine _
                                            & ",CASE WHEN DEST_SALES_CD <> ''                                     " & vbNewLine _
                                            & "           AND DEST_SALES_CD IS NOT NULL THEN DEST_SALES_AD_1      " & vbNewLine _
                                            & "      ELSE CUST_AD_1 END CUST_AD_1                                 " & vbNewLine _
                                            & ",CASE WHEN DEST_SALES_CD <> ''                                     " & vbNewLine _
                                            & "           AND DEST_SALES_CD IS NOT NULL THEN DEST_SALES_AD_2      " & vbNewLine _
                                            & "      ELSE CUST_AD_2 END CUST_AD_2                                 " & vbNewLine _
                                            & ",CASE WHEN DEST_SALES_CD <> ''                                     " & vbNewLine _
                                            & "           AND DEST_SALES_CD IS NOT NULL THEN DEST_SALES_TEL       " & vbNewLine _
                                            & "      ELSE CUST_TEL END CUST_TEL                                 " & vbNewLine _
                                            & ",NRS_BR_NM                                                         " & vbNewLine _
                                            & ",NRS_BR_AD1                                                        " & vbNewLine _
                                            & ",NRS_BR_AD2                                                        " & vbNewLine _
                                            & ",NRS_BR_TEL                                                        " & vbNewLine _
                                            & ",NRS_BR_FAX                                                        " & vbNewLine _
                                            & ",PIC                                                               " & vbNewLine _
                                            & ",OUTKA_NO_M                                                        " & vbNewLine _
                                            & ",MIN(OUTKA_NO_S)          AS OUTKA_NO_S                            " & vbNewLine _
                                            & ",INKA_DATE                                                         " & vbNewLine _
                                            & ",REMARK_OUT                                                        " & vbNewLine _
                                            & ",GOODS_NM_1                                                        " & vbNewLine _
                                            & ",LOT_NO                                                            " & vbNewLine _
                                            & ",SERIAL_NO                                                         " & vbNewLine _
                                            & ",IRIME                                                             " & vbNewLine _
                                            & ",PKG_NB                                                            " & vbNewLine _
                                            & ",SUM(ALCTD_NB) / PKG_NB   AS KONSU                                 " & vbNewLine _
                                            & ",SUM(ALCTD_NB) % PKG_NB   AS HASU                                  " & vbNewLine _
                                            & ",SUM(ALCTD_NB)            AS ALCTD_NB                              " & vbNewLine _
                                            & ",PKG_UT                                                            " & vbNewLine _
                                            & ",PKG_UT_NM                                                         " & vbNewLine _
                                            & ",SUM(ALCTD_QT)            AS ALCTD_QT                              " & vbNewLine _
                                            & ",IRIME_UT                                                          " & vbNewLine _
                                            & ",WT                       AS WT                                    " & vbNewLine _
                                            & ",UNSO_WT                                                           " & vbNewLine _
                                            & ",TOU_NO                                                            " & vbNewLine _
                                            & ",SITU_NO                                                           " & vbNewLine _
                                            & ",ZONE_CD                                                           " & vbNewLine _
                                            & ",LOCA                                                              " & vbNewLine _
                                            & ",MIN(ZAN_KONSU)           AS ZAN_KONSU                             " & vbNewLine _
                                            & "--(2012.09.06)要望番号1411 残端数不具合対応 -- START --            " & vbNewLine _
                                            & "--,MIN(ZAN_HASU)          AS ZAN_HASU                              " & vbNewLine _
                                            & ",MIN(ALCTD_CAN_NB) % PKG_NB AS ZAN_HASU                            " & vbNewLine _
                                            & "--(2012.09.06)要望番号1411 残端数不具合対応 --  END  --            " & vbNewLine _
                                            & ",GOODS_CD_CUST                                                     " & vbNewLine _
                                            & ",REMARK_M                                                          " & vbNewLine _
                                            & ",CUST_NM_S                                                         " & vbNewLine _
                                            & ",CUST_NM_S_H                                                       " & vbNewLine _
                                            & ",CUST_ORD_NO_DTL                                                   " & vbNewLine _
                                            & ",OUTKA_REMARK                                                      " & vbNewLine _
                                            & ",HAISOU_REMARK                                                     " & vbNewLine _
                                            & ",NHS_REMARK                                                        " & vbNewLine _
                                            & ",KYORI                                                             " & vbNewLine _
                                            & ",OUTKA_PKG_NB_L                                                    " & vbNewLine _
                                            & ",SOKO_NM                                                           " & vbNewLine _
                                            & ",BUSHO_NM                                                          " & vbNewLine _
                                            & ",NRS_BR_NM_NICHI                                                   " & vbNewLine _
                                            & ",MIN(ALCTD_CAN_QT)        AS ALCTD_CAN_QT                          " & vbNewLine _
                                            & ",ALCTD_KB                                                          " & vbNewLine _
                                            & ",PTN_FLAG                                                          " & vbNewLine _
                                            & ",CUST_CD_L                                                         " & vbNewLine _
                                            & ",ORDER_TYPE                       AS ORDER_TYPE                    " & vbNewLine _
                                            & ",CASE WHEN URIG_NM <> ''                                           " & vbNewLine _
                                            & "           AND URIG_NM IS NOT NULL THEN URIG_NM                    " & vbNewLine _
                                            & "--【要望番号1122】埼玉対応 --- START ---                           " & vbNewLine _
                                            & "      WHEN DEST_SALES_NM   <> ''                                   " & vbNewLine _
                                            & "           AND DEST_SALES_NM IS NOT NULL THEN DEST_SALES_NM        " & vbNewLine _
                                            & "--【要望番号1122】埼玉対応 ---  END  ---                           " & vbNewLine _
                                            & "      WHEN DENPYO_NM   <> ''                                       " & vbNewLine _
                                            & "           AND DENPYO_NM IS NOT NULL   THEN DENPYO_NM              " & vbNewLine _
                                            & "      ELSE CUST_NM_L                                               " & vbNewLine _
                                            & " END                         AS ATSUKAISYA_NM                      " & vbNewLine _
                                            & "--【要望番号995】　2012/04/17　元着払い区分　START                 " & vbNewLine _
                                            & ",PC_KB_NM                                                          " & vbNewLine _
                                            & "--【要望番号995】　2012/04/17　元着払い区分　 END                  " & vbNewLine _
                                            & "--【要望番号1017】 2012/04/24　注文番号明細  START                 " & vbNewLine _
                                            & ",BUYER_ORD_NO_DTL                                                  " & vbNewLine _
                                            & "--【要望番号1017】　2012/04/17 注文番号明細　 END                  " & vbNewLine _
                                            & "--日医工対策開始                                                   " & vbNewLine _
                                            & ",TORI_KB   --20120802 群馬篠崎運送でも利用。(FREE_C01)             " & vbNewLine _
                                            & "--★追加開始2012/05/11                                             " & vbNewLine _
                                            & ",SHIP_CD_L                                                         " & vbNewLine _
                                            & "--★追加終了2012/05/11                                             " & vbNewLine _
                                            & "--★削除開始2012/05/11                                             " & vbNewLine _
                                            & "--,CHOKUSO_NM                                                      " & vbNewLine _
                                            & "--,CHOKUSO_CD                                                      " & vbNewLine _
                                            & "--,HAKKO_DATE                                                      " & vbNewLine _
                                            & "--★削除終了2012/05/11                                             " & vbNewLine _
                                            & ",SET_NAIYO_4                                                       " & vbNewLine _
                                            & ",SET_NAIYO_5                                                       " & vbNewLine _
                                            & ",SET_NAIYO_6                                                       " & vbNewLine _
                                            & ",GOODS_NM_2                                                        " & vbNewLine _
                                            & ",KICHO_KB                                                          " & vbNewLine _
                                            & ",SEI_YURAI_KB                                                      " & vbNewLine _
                                            & ",REMARK_UPPER                                                      " & vbNewLine _
                                            & ",REMARK_LOWER                                                      " & vbNewLine _
                                            & ",GOODS_SYUBETU                                                     " & vbNewLine _
                                            & ",YUKOU_KIGEN                                                       " & vbNewLine _
                                            & ",GOODS_NM_3    --2012/05/23                                        " & vbNewLine _
                                            & ",EDISHIP_CD    --2012/05/23                                        " & vbNewLine _
                                            & ",EDIDEST_CD    --2012/05/23                                        " & vbNewLine _
                                            & "--日医工対策終了                                                   " & vbNewLine _
                                            & "--(2012.06.01)日本ファイン対応 --- START ---                       " & vbNewLine _
                                            & ",SET_NAIYO_FROM1                                                   " & vbNewLine _
                                            & ",SET_NAIYO_FROM2                                                   " & vbNewLine _
                                            & ",SET_NAIYO_FROM3                                                   " & vbNewLine _
                                            & "--(2012.06.01)日本ファイン対応 ---  END  ---                       " & vbNewLine _
                                            & "--【要望番号1122】埼玉対応 --- START ---                           " & vbNewLine _
                                            & ",CASE WHEN DEST_SALES_CD <> ''                                     " & vbNewLine _
                                            & "           AND DEST_SALES_CD IS NOT NULL THEN DEST_SALES_AD_3      " & vbNewLine _
                                            & "      ELSE CUST_AD_3 END CUST_AD_3                                 " & vbNewLine _
                                            & ",DEST_REMARK                                                       " & vbNewLine _
                                            & ",DEST_SALES_CD                                                     " & vbNewLine _
                                            & ",DEST_SALES_NM                                                     " & vbNewLine _
                                            & ",DEST_SALES_AD_1                                                   " & vbNewLine _
                                            & ",DEST_SALES_AD_2                                                   " & vbNewLine _
                                            & ",DEST_SALES_AD_3                                                   " & vbNewLine _
                                            & ",DEST_SALES_TEL                                                    " & vbNewLine _
                                            & "--【要望番号1122】埼玉対応 ---  END  ---                           " & vbNewLine _
                                            & "--群馬(合算)端数行分割版向け対応(作業略称) 開始20120731            " & vbNewLine _
                                            & ",SAGYO_RYAK_1                                                      " & vbNewLine _
                                            & ",SAGYO_RYAK_2                                                      " & vbNewLine _
                                            & ",SAGYO_RYAK_3                                                      " & vbNewLine _
                                            & ",SAGYO_RYAK_4                                                      " & vbNewLine _
                                            & ",SAGYO_RYAK_5                                                      " & vbNewLine _
                                            & ",DEST_SAGYO_RYAK_1                                                 " & vbNewLine _
                                            & ",DEST_SAGYO_RYAK_2                                                 " & vbNewLine _
                                            & "--群馬篠崎運送向け自由項目対応　開始　                             " & vbNewLine _
                                            & ",SZ01_YUSO                                                         " & vbNewLine _
                                            & ",SZ01_UNSO                                                         " & vbNewLine _
                                            & "--群馬篠崎運送向け自由項目対応　終了　                             " & vbNewLine _
                                            & "--群馬(合算)端数行分割版向け対応(作業略称) 終了20120731            " & vbNewLine _
                                            & ",SHOBO_CD                                                          " & vbNewLine _
                                            & "FROM                                                               " & vbNewLine _
                                            & "(                                                                  " & vbNewLine

    ''' <summary>
    '''  印刷データ抽出用2(大阪物流センター用：作業項目有り)
    ''' </summary>
    ''' <remarks></remarks>
    Friend Const SQL_SELECT_MAIN2 As String = "SELECT                                                            " & vbNewLine _
                                            & " RPT_ID                                                            " & vbNewLine _
                                            & ",NRS_BR_CD                                                         " & vbNewLine _
                                            & ",PRINT_SORT                                                        " & vbNewLine _
                                            & ",DEST_CD                                                           " & vbNewLine _
                                            & ",DEST_NM                                                           " & vbNewLine _
                                            & ",DEST_AD_1                                                         " & vbNewLine _
                                            & ",DEST_AD_2                                                         " & vbNewLine _
                                            & ",DEST_AD_3                                                         " & vbNewLine _
                                            & ",DEST_TEL                                                          " & vbNewLine _
                                            & ",OUTKA_PLAN_DATE                                                   " & vbNewLine _
                                            & ",CUST_ORD_NO                                                       " & vbNewLine _
                                            & ",BUYER_ORD_NO                                                      " & vbNewLine _
                                            & ",UNSOCO_NM                                                         " & vbNewLine _
                                            & ",ARR_PLAN_DATE                                                     " & vbNewLine _
                                            & ",ARR_PLAN_TIME                                                     " & vbNewLine _
                                            & ",OUTKA_NO_L                                                        " & vbNewLine _
                                            & ",URIG_NM                                                           " & vbNewLine _
                                            & ",CUST_NM_L                                                         " & vbNewLine _
                                            & "--(2012.06.15) 要望番号1155 -- START --                            " & vbNewLine _
                                            & ",CUST_NM_M                                                         " & vbNewLine _
                                            & "--(2012.06.15) 要望番号1155 --  END  --                            " & vbNewLine _
                                            & ",CASE WHEN DEST_SALES_CD <> ''                                     " & vbNewLine _
                                            & "           AND DEST_SALES_CD IS NOT NULL THEN DEST_SALES_AD_1      " & vbNewLine _
                                            & "      ELSE CUST_AD_1 END CUST_AD_1                                 " & vbNewLine _
                                            & ",CASE WHEN DEST_SALES_CD <> ''                                     " & vbNewLine _
                                            & "           AND DEST_SALES_CD IS NOT NULL THEN DEST_SALES_AD_2      " & vbNewLine _
                                            & "      ELSE CUST_AD_2 END CUST_AD_2                                 " & vbNewLine _
                                            & ",CASE WHEN DEST_SALES_CD <> ''                                     " & vbNewLine _
                                            & "           AND DEST_SALES_CD IS NOT NULL THEN DEST_SALES_TEL       " & vbNewLine _
                                            & "      ELSE CUST_TEL END CUST_TEL                                 " & vbNewLine _
                                            & ",DENPYO_NM                                                         " & vbNewLine _
                                            & ",NRS_BR_NM                                                         " & vbNewLine _
                                            & ",NRS_BR_AD1                                                        " & vbNewLine _
                                            & ",NRS_BR_AD2                                                        " & vbNewLine _
                                            & ",NRS_BR_TEL                                                        " & vbNewLine _
                                            & ",NRS_BR_FAX                                                        " & vbNewLine _
                                            & ",PIC                                                               " & vbNewLine _
                                            & ",OUTKA_NO_M                                                        " & vbNewLine _
                                            & ",MIN(OUTKA_NO_S)          AS OUTKA_NO_S                            " & vbNewLine _
                                            & ",INKA_DATE                                                         " & vbNewLine _
                                            & ",REMARK_OUT                                                        " & vbNewLine _
                                            & ",GOODS_NM_1                                                        " & vbNewLine _
                                            & ",LOT_NO                                                            " & vbNewLine _
                                            & ",SERIAL_NO                                                         " & vbNewLine _
                                            & ",IRIME                                                             " & vbNewLine _
                                            & ",PKG_NB                                                            " & vbNewLine _
                                            & ",SUM(ALCTD_NB) / PKG_NB   AS KONSU                                 " & vbNewLine _
                                            & ",SUM(ALCTD_NB) % PKG_NB   AS HASU                                  " & vbNewLine _
                                            & ",SUM(ALCTD_NB)            AS ALCTD_NB                              " & vbNewLine _
                                            & ",PKG_UT                                                            " & vbNewLine _
                                            & ",PKG_UT_NM                                                         " & vbNewLine _
                                            & ",SUM(ALCTD_QT)            AS ALCTD_QT                              " & vbNewLine _
                                            & ",IRIME_UT                                                          " & vbNewLine _
                                            & ",WT                       AS WT                                    " & vbNewLine _
                                            & ",UNSO_WT                                                           " & vbNewLine _
                                            & ",TOU_NO                                                            " & vbNewLine _
                                            & ",SITU_NO                                                           " & vbNewLine _
                                            & ",ZONE_CD                                                           " & vbNewLine _
                                            & ",LOCA                                                              " & vbNewLine _
                                            & ",MIN(ZAN_KONSU)           AS ZAN_KONSU                             " & vbNewLine _
                                            & "--(2012.09.06)要望番号1411 残端数不具合対応 -- START --            " & vbNewLine _
                                            & "--,MIN(ZAN_HASU)          AS ZAN_HASU                              " & vbNewLine _
                                            & ",MIN(ALCTD_CAN_NB) % PKG_NB AS ZAN_HASU                            " & vbNewLine _
                                            & "--(2012.09.06)要望番号1411 残端数不具合対応 --  END  --            " & vbNewLine _
                                            & ",GOODS_CD_CUST                                                     " & vbNewLine _
                                            & ",REMARK_M                                                          " & vbNewLine _
                                            & ",CUST_NM_S                                                         " & vbNewLine _
                                            & ",CUST_NM_S_H                                                       " & vbNewLine _
                                            & ",CUST_ORD_NO_DTL                                                   " & vbNewLine _
                                            & ",OUTKA_REMARK                                                      " & vbNewLine _
                                            & ",HAISOU_REMARK                                                     " & vbNewLine _
                                            & ",NHS_REMARK                                                        " & vbNewLine _
                                            & ",KYORI                                                             " & vbNewLine _
                                            & ",OUTKA_PKG_NB_L                                                    " & vbNewLine _
                                            & ",SOKO_NM                                                           " & vbNewLine _
                                            & ",BUSHO_NM                                                          " & vbNewLine _
                                            & ",NRS_BR_NM_NICHI                                                   " & vbNewLine _
                                            & ",MIN(ALCTD_CAN_QT)        AS ALCTD_CAN_QT                          " & vbNewLine _
                                            & ",ALCTD_KB                                                          " & vbNewLine _
                                            & ",PTN_FLAG                                                          " & vbNewLine _
                                            & ",CUST_CD_L                                                         " & vbNewLine _
                                            & ",ORDER_TYPE                AS ORDER_TYPE                           " & vbNewLine _
                                            & ",LT_DATE                                                           " & vbNewLine _
                                            & ",BUYER_ORD_NO_DTL                                                  " & vbNewLine _
                                            & ",GOODS_COND_CD                                                     " & vbNewLine _
                                            & ",GOODS_COND_NM --☆                                                " & vbNewLine _
                                            & ",REMARK_ZAI                                                        " & vbNewLine _
                                            & ",TITLE_SMPL                                                        " & vbNewLine _
                                            & ",MIN(ALCTD_CAN_NB)        AS ALCTD_CAN_NB                          " & vbNewLine _
                                            & ",BACKLOG_QT                                                        " & vbNewLine _
                                            & ",DOKU_NM                                                           " & vbNewLine _
                                            & ",CASE WHEN URIG_NM <> ''                                           " & vbNewLine _
                                            & "           AND URIG_NM IS NOT NULL THEN URIG_NM                    " & vbNewLine _
                                            & "--【要望番号1122】埼玉対応 --- START ---                           " & vbNewLine _
                                            & "      WHEN DEST_SALES_NM   <> ''                                   " & vbNewLine _
                                            & "           AND DEST_SALES_NM IS NOT NULL THEN DEST_SALES_NM        " & vbNewLine _
                                            & "--【要望番号1122】埼玉対応 ---  END  ---                           " & vbNewLine _
                                            & "      WHEN DENPYO_NM   <> ''                                       " & vbNewLine _
                                            & "           AND DENPYO_NM IS NOT NULL   THEN DENPYO_NM              " & vbNewLine _
                                            & "      ELSE CUST_NM_L                                               " & vbNewLine _
                                            & " END                         AS ATSUKAISYA_NM                      " & vbNewLine _
                                            & "--【Notes】№728 作業項目1～5を表示(大阪のみ) START                " & vbNewLine _
                                            & ",SAGYO_MEI_REC_NO_1                                                " & vbNewLine _
                                            & ",SAGYO_MEI_CD_1                                                    " & vbNewLine _
                                            & ",SAGYO_MEI_NM_1                                                    " & vbNewLine _
                                            & ",SAGYO_MEI_REC_NO_2                                                " & vbNewLine _
                                            & ",SAGYO_MEI_CD_2                                                    " & vbNewLine _
                                            & ",SAGYO_MEI_NM_2                                                    " & vbNewLine _
                                            & ",SAGYO_MEI_REC_NO_3                                                " & vbNewLine _
                                            & ",SAGYO_MEI_CD_3                                                    " & vbNewLine _
                                            & ",SAGYO_MEI_NM_3                                                    " & vbNewLine _
                                            & ",SAGYO_MEI_REC_NO_4                                                " & vbNewLine _
                                            & ",SAGYO_MEI_CD_4                                                    " & vbNewLine _
                                            & ",SAGYO_MEI_NM_4                                                    " & vbNewLine _
                                            & ",SAGYO_MEI_REC_NO_5                                                " & vbNewLine _
                                            & ",SAGYO_MEI_CD_5                                                    " & vbNewLine _
                                            & ",SAGYO_MEI_NM_5                                                    " & vbNewLine _
                                            & "--【Notes】№728 作業項目1～5を表示(大阪のみ) END                  " & vbNewLine _
                                            & "--2012/03/12対応開始                                               " & vbNewLine _
                                            & ",TOU_SITU_NM                                                       " & vbNewLine _
                                            & ",JISYATASYA_KB                                                     " & vbNewLine _
                                            & "--2012/03/12対応終了                                               " & vbNewLine _
                                            & "--【要望番号995】　2012/04/20　元着払い区分　START                 " & vbNewLine _
                                            & ",PC_KB_NM                                                          " & vbNewLine _
                                            & "--【要望番号995】　2012/04/20　元着払い区分　 END                  " & vbNewLine _
                                            & "--日医工対策開始                                                   " & vbNewLine _
                                            & ",TORI_KB                                                           " & vbNewLine _
                                            & "--★追加開始2012/05/11                                             " & vbNewLine _
                                            & ",SHIP_CD_L                                                         " & vbNewLine _
                                            & "--★追加終了2012/05/11                                             " & vbNewLine _
                                            & "--★削除開始2012/05/11                                             " & vbNewLine _
                                            & "--,CHOKUSO_NM1                                                     " & vbNewLine _
                                            & "--,CHOKUSO_CD                                                      " & vbNewLine _
                                            & "--,HAKKO_DATE                                                      " & vbNewLine _
                                            & "--★削除終了2012/05/11                                             " & vbNewLine _
                                            & ",SET_NAIYO_4                                                       " & vbNewLine _
                                            & ",SET_NAIYO_5                                                       " & vbNewLine _
                                            & ",SET_NAIYO_6                                                       " & vbNewLine _
                                            & ",GOODS_NM_2                                                        " & vbNewLine _
                                            & ",KICHO_KB                                                          " & vbNewLine _
                                            & ",SEI_YURAI_KB                                                      " & vbNewLine _
                                            & ",REMARK_UPPER                                                      " & vbNewLine _
                                            & ",REMARK_LOWER                                                      " & vbNewLine _
                                            & ",GOODS_SYUBETU                                                     " & vbNewLine _
                                            & ",YUKOU_KIGEN                                                       " & vbNewLine _
                                            & ",GOODS_NM_3 --2012/05/23                                           " & vbNewLine _
                                            & ",EDISHIP_CD --2012/05/23                                           " & vbNewLine _
                                            & ",EDIDEST_CD --2012/05/23                                           " & vbNewLine _
                                            & "--日医工対策終了                                                   " & vbNewLine _
                                            & "--(2012.06.01)日本ファイン対応 --- START ---                       " & vbNewLine _
                                            & ",SET_NAIYO_FROM1                                                   " & vbNewLine _
                                            & ",SET_NAIYO_FROM2                                                   " & vbNewLine _
                                            & ",SET_NAIYO_FROM3                                                   " & vbNewLine _
                                            & "--(2012.06.01)日本ファイン対応 ---  END  ---                       " & vbNewLine _
                                            & "--【要望番号1122】埼玉対応 --- START ---                           " & vbNewLine _
                                            & ",CASE WHEN DEST_SALES_CD <> ''                                     " & vbNewLine _
                                            & "           AND DEST_SALES_CD IS NOT NULL THEN DEST_SALES_AD_3      " & vbNewLine _
                                            & "      ELSE CUST_AD_3 END CUST_AD_3                                 " & vbNewLine _
                                            & ",DEST_REMARK                                                       " & vbNewLine _
                                            & ",DEST_SALES_CD                                                     " & vbNewLine _
                                            & ",DEST_SALES_NM                                                     " & vbNewLine _
                                            & ",DEST_SALES_AD_1                                                   " & vbNewLine _
                                            & ",DEST_SALES_AD_2                                                   " & vbNewLine _
                                            & ",DEST_SALES_AD_3                                                   " & vbNewLine _
                                            & ",DEST_SALES_TEL                                                    " & vbNewLine _
                                            & "--【要望番号1122】埼玉対応 ---  END  ---                           " & vbNewLine _
                                            & "--Notes1331  群馬対応  ---START---                                 " & vbNewLine _
                                            & ",SAGYO_RYAK_1                                                      " & vbNewLine _
                                            & ",SAGYO_RYAK_2                                                      " & vbNewLine _
                                            & ",SAGYO_RYAK_3                                                      " & vbNewLine _
                                            & ",SAGYO_RYAK_4                                                      " & vbNewLine _
                                            & ",SAGYO_RYAK_5                                                      " & vbNewLine _
                                            & ",DEST_SAGYO_RYAK_1                                                 " & vbNewLine _
                                            & ",DEST_SAGYO_RYAK_2                                                 " & vbNewLine _
                                            & ",SZ01_YUSO                                                         " & vbNewLine _
                                            & ",SZ01_UNSO                                                         " & vbNewLine _
                                            & "--Notes1331  群馬対応  ---END---                                   " & vbNewLine _
                                            & ",WH_SIJI_REMARK                                                    " & vbNewLine _
                                            & "FROM                                                               " & vbNewLine _
                                            & "(                                                                  " & vbNewLine

    ''' <summary>
    ''' 印刷データ抽出用2(大阪物流センター用：作業項目有り)
    ''' </summary>
    ''' <remarks></remarks>
    Friend Const SQL_SELECT_MAIN_3 As String = "SELECT                                                             " & vbNewLine _
                                            & " RPT_ID                                                            " & vbNewLine _
                                            & ",NRS_BR_CD                                                         " & vbNewLine _
                                            & ",PRINT_SORT                                                        " & vbNewLine _
                                            & ",DEST_CD                                                           " & vbNewLine _
                                            & ",DEST_NM                                                           " & vbNewLine _
                                            & ",DEST_AD_1                                                         " & vbNewLine _
                                            & ",DEST_AD_2                                                         " & vbNewLine _
                                            & ",DEST_AD_3                                                         " & vbNewLine _
                                            & ",DEST_TEL                                                          " & vbNewLine _
                                            & ",OUTKA_PLAN_DATE                                                   " & vbNewLine _
                                            & ",CUST_ORD_NO                                                       " & vbNewLine _
                                            & ",BUYER_ORD_NO                                                      " & vbNewLine _
                                            & ",UNSOCO_NM                                                         " & vbNewLine _
                                            & ",ARR_PLAN_DATE                                                     " & vbNewLine _
                                            & ",ARR_PLAN_TIME                                                     " & vbNewLine _
                                            & ",OUTKA_NO_L                                                        " & vbNewLine _
                                            & ",URIG_NM                                                           " & vbNewLine _
                                            & ",CUST_NM_L                                                         " & vbNewLine _
                                            & "--(2012.06.15) 要望番号1155 -- START --                            " & vbNewLine _
                                            & ",CUST_NM_M                                                         " & vbNewLine _
                                            & "--(2012.06.15) 要望番号1155 --  END  --                            " & vbNewLine _
                                            & ",CASE WHEN DEST_SALES_CD <> ''                                     " & vbNewLine _
                                            & "           AND DEST_SALES_CD IS NOT NULL THEN DEST_SALES_AD_1      " & vbNewLine _
                                            & "      ELSE CUST_AD_1 END CUST_AD_1                                 " & vbNewLine _
                                            & ",CASE WHEN DEST_SALES_CD <> ''                                     " & vbNewLine _
                                            & "           AND DEST_SALES_CD IS NOT NULL THEN DEST_SALES_AD_2      " & vbNewLine _
                                            & "      ELSE CUST_AD_2 END CUST_AD_2                                 " & vbNewLine _
                                            & ",CASE WHEN DEST_SALES_CD <> ''                                     " & vbNewLine _
                                            & "           AND DEST_SALES_CD IS NOT NULL THEN DEST_SALES_TEL       " & vbNewLine _
                                            & "      ELSE CUST_TEL END CUST_TEL                                 " & vbNewLine _
                                            & ",DENPYO_NM                                                         " & vbNewLine _
                                            & ",NRS_BR_NM                                                         " & vbNewLine _
                                            & ",NRS_BR_AD1                                                        " & vbNewLine _
                                            & ",NRS_BR_AD2                                                        " & vbNewLine _
                                            & ",NRS_BR_TEL                                                        " & vbNewLine _
                                            & ",NRS_BR_FAX                                                        " & vbNewLine _
                                            & ",PIC                                                               " & vbNewLine _
                                            & ",OUTKA_NO_M                                                        " & vbNewLine _
                                            & ",MIN(OUTKA_NO_S)          AS OUTKA_NO_S                            " & vbNewLine _
                                            & ",INKA_DATE                                                         " & vbNewLine _
                                            & ",REMARK_OUT                                                        " & vbNewLine _
                                            & ",GOODS_NM_1                                                        " & vbNewLine _
                                            & ",LOT_NO                                                            " & vbNewLine _
                                            & ",SERIAL_NO                                                         " & vbNewLine _
                                            & ",IRIME                                                             " & vbNewLine _
                                            & ",PKG_NB                                                            " & vbNewLine _
                                            & ",SUM(ALCTD_NB) / PKG_NB   AS KONSU                                 " & vbNewLine _
                                            & ",SUM(ALCTD_NB) % PKG_NB   AS HASU                                  " & vbNewLine _
                                            & ",SUM(ALCTD_NB)            AS ALCTD_NB                              " & vbNewLine _
                                            & ",PKG_UT                                                            " & vbNewLine _
                                            & ",PKG_UT_NM                                                         " & vbNewLine _
                                            & ",SUM(ALCTD_QT)            AS ALCTD_QT                              " & vbNewLine _
                                            & ",IRIME_UT                                                          " & vbNewLine _
                                            & ",WT                       AS WT                                    " & vbNewLine _
                                            & ",UNSO_WT                                                           " & vbNewLine _
                                            & ",TOU_NO                                                            " & vbNewLine _
                                            & ",SITU_NO                                                           " & vbNewLine _
                                            & ",ZONE_CD                                                           " & vbNewLine _
                                            & ",LOCA                                                              " & vbNewLine _
                                            & ",MIN(ZAN_KONSU)           AS ZAN_KONSU                             " & vbNewLine _
                                            & "--(2012.09.06)要望番号1411 残端数不具合対応 -- START --            " & vbNewLine _
                                            & "--,MIN(ZAN_HASU)          AS ZAN_HASU                              " & vbNewLine _
                                            & ",MIN(ALCTD_CAN_NB) % PKG_NB AS ZAN_HASU                            " & vbNewLine _
                                            & "--(2012.09.06)要望番号1411 残端数不具合対応 --  END  --            " & vbNewLine _
                                            & ",GOODS_CD_CUST                                                     " & vbNewLine _
                                            & ",REMARK_M                                                          " & vbNewLine _
                                            & ",CUST_NM_S                                                         " & vbNewLine _
                                            & ",CUST_NM_S_H                                                       " & vbNewLine _
                                            & ",CUST_ORD_NO_DTL                                                   " & vbNewLine _
                                            & ",OUTKA_REMARK                                                      " & vbNewLine _
                                            & ",HAISOU_REMARK                                                     " & vbNewLine _
                                            & ",NHS_REMARK                                                        " & vbNewLine _
                                            & ",KYORI                                                             " & vbNewLine _
                                            & ",OUTKA_PKG_NB_L                                                    " & vbNewLine _
                                            & ",SOKO_NM                                                           " & vbNewLine _
                                            & ",BUSHO_NM                                                          " & vbNewLine _
                                            & ",NRS_BR_NM_NICHI                                                   " & vbNewLine _
                                            & ",MIN(ALCTD_CAN_QT)        AS ALCTD_CAN_QT                          " & vbNewLine _
                                            & ",ALCTD_KB                                                          " & vbNewLine _
                                            & ",PTN_FLAG                                                          " & vbNewLine _
                                            & ",CUST_CD_L                                                         " & vbNewLine _
                                            & ",ORDER_TYPE                AS ORDER_TYPE                           " & vbNewLine _
                                            & ",LT_DATE                                                           " & vbNewLine _
                                            & ",BUYER_ORD_NO_DTL                                                  " & vbNewLine _
                                            & ",GOODS_COND_CD                                                     " & vbNewLine _
                                            & ",GOODS_COND_NM  --☆                                               " & vbNewLine _
                                            & ",REMARK_ZAI                                                        " & vbNewLine _
                                            & ",TITLE_SMPL                                                        " & vbNewLine _
                                            & ",MIN(ALCTD_CAN_NB)        AS ALCTD_CAN_NB                          " & vbNewLine _
                                            & ",BACKLOG_QT                                                        " & vbNewLine _
                                            & ",DOKU_NM                                                           " & vbNewLine _
                                            & ",CASE WHEN URIG_NM <> ''                                           " & vbNewLine _
                                            & "           AND URIG_NM IS NOT NULL THEN URIG_NM                    " & vbNewLine _
                                            & "--【要望番号1122】埼玉対応 --- START ---                           " & vbNewLine _
                                            & "      WHEN DEST_SALES_NM   <> ''                                   " & vbNewLine _
                                            & "           AND DEST_SALES_NM IS NOT NULL THEN DEST_SALES_NM        " & vbNewLine _
                                            & "--【要望番号1122】埼玉対応 ---  END  ---                           " & vbNewLine _
                                            & "      WHEN DENPYO_NM   <> ''                                       " & vbNewLine _
                                            & "           AND DENPYO_NM IS NOT NULL   THEN DENPYO_NM              " & vbNewLine _
                                            & "      ELSE CUST_NM_L                                               " & vbNewLine _
                                            & " END                         AS ATSUKAISYA_NM                      " & vbNewLine _
                                            & "--【Notes】№728 作業項目1～5を表示(大阪のみ) START                " & vbNewLine _
                                            & ",SAGYO_MEI_REC_NO_1                                                " & vbNewLine _
                                            & ",SAGYO_MEI_CD_1                                                    " & vbNewLine _
                                            & ",SAGYO_MEI_NM_1                                                    " & vbNewLine _
                                            & ",SAGYO_MEI_REC_NO_2                                                " & vbNewLine _
                                            & ",SAGYO_MEI_CD_2                                                    " & vbNewLine _
                                            & ",SAGYO_MEI_NM_2                                                    " & vbNewLine _
                                            & ",SAGYO_MEI_REC_NO_3                                                " & vbNewLine _
                                            & ",SAGYO_MEI_CD_3                                                    " & vbNewLine _
                                            & ",SAGYO_MEI_NM_3                                                    " & vbNewLine _
                                            & ",SAGYO_MEI_REC_NO_4                                                " & vbNewLine _
                                            & ",SAGYO_MEI_CD_4                                                    " & vbNewLine _
                                            & ",SAGYO_MEI_NM_4                                                    " & vbNewLine _
                                            & ",SAGYO_MEI_REC_NO_5                                                " & vbNewLine _
                                            & ",SAGYO_MEI_CD_5                                                    " & vbNewLine _
                                            & ",SAGYO_MEI_NM_5                                                    " & vbNewLine _
                                            & "--【Notes】№728 作業項目1～5を表示(大阪のみ) END                  " & vbNewLine _
                                            & " ,MCD_SET_NAIYO    AS MCD_SET_NAIYO                                " & vbNewLine _
                                            & " ,MCD_SET_NAIYO_2  AS MCD_SET_NAIYO_2                              " & vbNewLine _
                                            & " ,MCD_SET_NAIYO_3  AS MCD_SET_NAIYO_3                              " & vbNewLine _
                                            & "--2012/03/14対応開始★★★                                         " & vbNewLine _
                                            & ",TOU_SITU_NM                                                       " & vbNewLine _
                                            & ",JISYATASYA_KB                                                     " & vbNewLine _
                                            & "--2012/03/14対応終了★★★                                         " & vbNewLine _
                                            & "--【要望番号995】　2012/04/20　元着払い区分　START                 " & vbNewLine _
                                            & ",PC_KB_NM                                                          " & vbNewLine _
                                            & "--【要望番号995】　2012/04/20　元着払い区分　 END                  " & vbNewLine _
                                            & "--日医工対策開始                                                   " & vbNewLine _
                                            & ",TORI_KB                                                           " & vbNewLine _
                                            & "--★追加開始2012/05/11                                             " & vbNewLine _
                                            & ",SHIP_CD_L                                                         " & vbNewLine _
                                            & "--★追加終了2012/05/11                                             " & vbNewLine _
                                            & "--★削除開始2012/05/11                                             " & vbNewLine _
                                            & "--,CHOKUSO_NM1                                                     " & vbNewLine _
                                            & "--,CHOKUSO_CD                                                      " & vbNewLine _
                                            & "--,HAKKO_DATE                                                      " & vbNewLine _
                                            & "--★削除終了2012/05/11                                             " & vbNewLine _
                                            & ",SET_NAIYO_4                                                       " & vbNewLine _
                                            & ",SET_NAIYO_5                                                       " & vbNewLine _
                                            & ",SET_NAIYO_6                                                       " & vbNewLine _
                                            & ",GOODS_NM_2                                                        " & vbNewLine _
                                            & ",KICHO_KB                                                          " & vbNewLine _
                                            & ",SEI_YURAI_KB                                                      " & vbNewLine _
                                            & ",REMARK_UPPER                                                      " & vbNewLine _
                                            & ",REMARK_LOWER                                                      " & vbNewLine _
                                            & ",GOODS_SYUBETU                                                     " & vbNewLine _
                                            & ",YUKOU_KIGEN                                                       " & vbNewLine _
                                            & ",GOODS_NM_3    --2012/05/23                                        " & vbNewLine _
                                            & ",EDISHIP_CD --2012/05/23                                           " & vbNewLine _
                                            & ",EDIDEST_CD --2012/05/23                                           " & vbNewLine _
                                            & "--日医工対策終了                                                   " & vbNewLine _
                                            & "--(2012.06.01)日本ファイン対応 --- START ---                       " & vbNewLine _
                                            & ",SET_NAIYO_FROM1                                                   " & vbNewLine _
                                            & ",SET_NAIYO_FROM2                                                   " & vbNewLine _
                                            & ",SET_NAIYO_FROM3                                                   " & vbNewLine _
                                            & "--(2012.06.01)日本ファイン対応 ---  END  ---                       " & vbNewLine _
                                            & "--【要望番号1122】埼玉対応 --- START ---                           " & vbNewLine _
                                            & ",CASE WHEN DEST_SALES_CD <> ''                                     " & vbNewLine _
                                            & "           AND DEST_SALES_CD IS NOT NULL THEN DEST_SALES_AD_3      " & vbNewLine _
                                            & "      ELSE CUST_AD_3 END CUST_AD_3                                 " & vbNewLine _
                                            & ",DEST_REMARK                                                       " & vbNewLine _
                                            & ",DEST_SALES_CD                                                     " & vbNewLine _
                                            & ",DEST_SALES_NM                                                     " & vbNewLine _
                                            & ",DEST_SALES_AD_1                                                   " & vbNewLine _
                                            & ",DEST_SALES_AD_2                                                   " & vbNewLine _
                                            & ",DEST_SALES_AD_3                                                   " & vbNewLine _
                                            & ",DEST_SALES_TEL                                                    " & vbNewLine _
                                            & "--【要望番号1122】埼玉対応 ---  END  ---                           " & vbNewLine _
                                            & "--Notes1331  群馬対応 ---START---                                  " & vbNewLine _
                                            & ",SAGYO_RYAK_1                                                      " & vbNewLine _
                                            & ",SAGYO_RYAK_2                                                      " & vbNewLine _
                                            & ",SAGYO_RYAK_3                                                      " & vbNewLine _
                                            & ",SAGYO_RYAK_4                                                      " & vbNewLine _
                                            & ",SAGYO_RYAK_5                                                      " & vbNewLine _
                                            & ",DEST_SAGYO_RYAK_1                                                 " & vbNewLine _
                                            & ",DEST_SAGYO_RYAK_2                                                 " & vbNewLine _
                                            & ",SZ01_YUSO                                                         " & vbNewLine _
                                            & ",SZ01_UNSO                                                         " & vbNewLine _
                                            & "--Notes1331  群馬対応 ---END---                                    " & vbNewLine _
                                            & "FROM                                                               " & vbNewLine _
                                            & "(                                                                  " & vbNewLine



    ''' <summary>
    ''' 印刷データ抽出用(日本合成用SELECT句)
    ''' </summary>
    ''' <remarks></remarks>
    Friend Const SQL_SELECT_MAIN_NITIGO As String = "-- ★★★SQL_SELECT_MAIN_NITIGO★★★                       " & vbNewLine _
                                            & " SELECT                                                            " & vbNewLine _
                                            & " RPT_ID                                                            " & vbNewLine _
                                            & ",NRS_BR_CD                                                         " & vbNewLine _
                                            & ",PRINT_SORT                                                        " & vbNewLine _
                                            & ",DEST_CD                                                           " & vbNewLine _
                                            & ",DEST_NM                                                           " & vbNewLine _
                                            & ",DEST_AD_1                                                         " & vbNewLine _
                                            & ",DEST_AD_2                                                         " & vbNewLine _
                                            & ",DEST_AD_3                                                         " & vbNewLine _
                                            & ",DEST_TEL                                                          " & vbNewLine _
                                            & ",OUTKA_PLAN_DATE                                                   " & vbNewLine _
                                            & ",CUST_ORD_NO                                                       " & vbNewLine _
                                            & ",BUYER_ORD_NO                                                      " & vbNewLine _
                                            & ",UNSOCO_NM                                                         " & vbNewLine _
                                            & ",ARR_PLAN_DATE                                                     " & vbNewLine _
                                            & ",''                       AS ARR_PLAN_TIME                         " & vbNewLine _
                                            & ",OUTKA_NO_L                                                        " & vbNewLine _
                                            & ",URIG_NM                                                           " & vbNewLine _
                                            & ",''                       AS CUST_NM_L                             " & vbNewLine _
                                            & "--(2012.06.15) 要望番号1155 -- START --                            " & vbNewLine _
                                            & ",''                       AS CUST_NM_M                             " & vbNewLine _
                                            & "--(2012.06.15) 要望番号1155 --  END  --                            " & vbNewLine _
                                            & ",''                       AS CUST_AD_1                             " & vbNewLine _
                                            & ",''                       AS CUST_AD_2                             " & vbNewLine _
                                            & ",''                       AS CUST_TEL                              " & vbNewLine _
                                            & ",''                       AS DENPYO_NM                             " & vbNewLine _
                                            & ",NRS_BR_NM                                                         " & vbNewLine _
                                            & ",NRS_BR_AD1                                                        " & vbNewLine _
                                            & ",NRS_BR_AD2                                                        " & vbNewLine _
                                            & ",NRS_BR_TEL                                                        " & vbNewLine _
                                            & ",NRS_BR_FAX                                                        " & vbNewLine _
                                            & ",''                       AS PIC                                   " & vbNewLine _
                                            & ",''                       AS OUTKA_NO_M                            " & vbNewLine _
                                            & ",''                       AS OUTKA_NO_S                            " & vbNewLine _
                                            & ",''                       AS INKA_DATE                             " & vbNewLine _
                                            & ",''                       AS REMARK_OUT                            " & vbNewLine _
                                            & ",GOODS_NM_1                                                        " & vbNewLine _
                                            & ",LOT_NO                                                            " & vbNewLine _
                                            & ",''                       AS SERIAL_NO                             " & vbNewLine _
                                            & ",IRIME                                                             " & vbNewLine _
                                            & ",0                        AS PKG_NB                                " & vbNewLine _
                                            & ",0                        AS KONSU                                 " & vbNewLine _
                                            & ",0                        AS HASU                                  " & vbNewLine _
                                            & ",SUM(ALCTD_NB)            AS ALCTD_NB                              " & vbNewLine _
                                            & ",PKG_UT                                                            " & vbNewLine _
                                            & ",PKG_UT_NM                                                         " & vbNewLine _
                                            & ",SUM(ALCTD_QT)            AS ALCTD_QT                              " & vbNewLine _
                                            & ",''                       AS IRIME_UT                              " & vbNewLine _
                                            & ",WT                       AS WT                                    " & vbNewLine _
                                            & ",0                        AS UNSO_WT                               " & vbNewLine _
                                            & ",''                       AS TOU_NO                                " & vbNewLine _
                                            & ",''                       AS SITU_NO                               " & vbNewLine _
                                            & ",''                       AS ZONE_CD                               " & vbNewLine _
                                            & ",''                       AS LOCA                                  " & vbNewLine _
                                            & ",0                        AS ZAN_KONSU                             " & vbNewLine _
                                            & ",0                        AS ZAN_HASU                              " & vbNewLine _
                                            & ",GOODS_CD_CUST                                                     " & vbNewLine _
                                            & ",''                       AS REMARK_M                              " & vbNewLine _
                                            & ",''                       AS CUST_NM_S                             " & vbNewLine _
                                            & ",''                       AS CUST_NM_S_H                           " & vbNewLine _
                                            & ",''                       AS CUST_ORD_NO_DTL                       " & vbNewLine _
                                            & ",OUTKA_REMARK                                                      " & vbNewLine _
                                            & ",HAISOU_REMARK                                                     " & vbNewLine _
                                            & ",NHS_REMARK                                                        " & vbNewLine _
                                            & ",0                        AS KYORI                                 " & vbNewLine _
                                            & ",0                        AS OUTKA_PKG_NB_L                        " & vbNewLine _
                                            & ",SOKO_NM                                                           " & vbNewLine _
                                            & ",BUSHO_NM                                                          " & vbNewLine _
                                            & ",NRS_BR_NM_NICHI                                                   " & vbNewLine _
                                            & ",0                        AS ALCTD_CAN_QT                          " & vbNewLine _
                                            & ",''                       AS ALCTD_KB                              " & vbNewLine _
                                            & ",PTN_FLAG                                                          " & vbNewLine _
                                            & ",''                       AS CUST_CD_L                             " & vbNewLine _
                                            & ",''                       AS ORDER_TYPE                            " & vbNewLine _
                                            & ",''                       AS ATSUKAISYA_NM                         " & vbNewLine _
                                            & "--【要望番号995】　2012/04/17　元着払い区分　START                 " & vbNewLine _
                                            & ",PC_KB_NM                                                          " & vbNewLine _
                                            & "--【要望番号995】　2012/04/17　元着払い区分　 END                  " & vbNewLine _
                                            & "--【要望番号1017】 2012/04/24　注文番号明細  START                 " & vbNewLine _
                                            & ",BUYER_ORD_NO_DTL                                                  " & vbNewLine _
                                            & "--【要望番号1017】　2012/04/17 注文番号明細　 END                  " & vbNewLine _
                                            & "--日医工対策開始                                                   " & vbNewLine _
                                            & ",''                       AS TORI_KB                               " & vbNewLine _
                                            & "--★追加開始2012/05/11                                             " & vbNewLine _
                                            & ",''                       AS SHIP_CD_L                             " & vbNewLine _
                                            & "--★追加終了2012/05/11                                             " & vbNewLine _
                                            & "--★削除開始2012/05/11                                             " & vbNewLine _
                                            & "--,''                       AS CHOKUSO_NM1                         " & vbNewLine _
                                            & "--,''                       AS CHOKUSO_CD                          " & vbNewLine _
                                            & "--,''                       AS HAKKO_DATE                          " & vbNewLine _
                                            & "--★削除終了2012/05/11                                             " & vbNewLine _
                                            & ",''                       AS SET_NAIYO_4                           " & vbNewLine _
                                            & ",''                       AS SET_NAIYO_5                           " & vbNewLine _
                                            & ",''                       AS SET_NAIYO_6                           " & vbNewLine _
                                            & ",''                       AS GOODS_NM_2                            " & vbNewLine _
                                            & ",''                       AS KICHO_KB                              " & vbNewLine _
                                            & ",''                       AS SEI_YURAI_KB                          " & vbNewLine _
                                            & ",''                       AS REMARK_UPPER                          " & vbNewLine _
                                            & ",''                       AS REMARK_LOWER                          " & vbNewLine _
                                            & ",''                       AS GOODS_SYUBETU                         " & vbNewLine _
                                            & ",''                       AS YUKOU_KIGEN                           " & vbNewLine _
                                            & ",''                       AS GOODS_NM_3    --2012/05/23            " & vbNewLine _
                                            & ",''                       AS EDISHIP_CD    --2012/05/23            " & vbNewLine _
                                            & ",''                       AS EDIDEST_CD    --2012/05/23            " & vbNewLine _
                                            & "--(2012.06.01)日本ファイン対応 --- START ---                       " & vbNewLine _
                                            & ",''                       AS SET_NAIYO_FROM1                       " & vbNewLine _
                                            & ",''                       AS SET_NAIYO_FROM2                       " & vbNewLine _
                                            & ",''                       AS SET_NAIYO_FROM3                       " & vbNewLine _
                                            & "--(2012.06.01)日本ファイン対応 ---  END  ---                       " & vbNewLine _
                                            & "--【要望番号1122】埼玉対応 --- START ---                           " & vbNewLine _
                                            & ",''                       AS CUST_AD_3                             " & vbNewLine _
                                            & ",''                       AS DEST_REMARK                           " & vbNewLine _
                                            & ",''                       AS DEST_SALES_CD                         " & vbNewLine _
                                            & ",''                       AS DEST_SALES_NM                         " & vbNewLine _
                                            & ",''                       AS DEST_SALES_AD_1                       " & vbNewLine _
                                            & ",''                       AS DEST_SALES_AD_2                       " & vbNewLine _
                                            & ",''                       AS DEST_SALES_AD_3                       " & vbNewLine _
                                            & ",''                       AS DEST_SALES_TEL                        " & vbNewLine _
                                            & "--【要望番号1122】埼玉対応 ---  END  ---                           " & vbNewLine _
                                            & "--群馬(合算)端数行分割版向け対応(作業略称) 開始 20120731           " & vbNewLine _
                                            & ",''                       AS SAGYO_RYAK_1                          " & vbNewLine _
                                            & ",''                       AS SAGYO_RYAK_2                          " & vbNewLine _
                                            & ",''                       AS SAGYO_RYAK_3                          " & vbNewLine _
                                            & ",''                       AS SAGYO_RYAK_4                          " & vbNewLine _
                                            & ",''                       AS SAGYO_RYAK_5                          " & vbNewLine _
                                            & ",''                       AS DEST_SAGYO_RYAK_1                     " & vbNewLine _
                                            & ",''                       AS DEST_SAGYO_RYAK_2                     " & vbNewLine _
                                            & "--群馬(合算)端数行分割版向け対応(作業略称) 終了 20120731           " & vbNewLine _
                                            & "--群馬篠崎運送向け自由項目対応　開始　                             " & vbNewLine _
                                            & ",''                       AS SZ01_YUSO                             " & vbNewLine _
                                            & ",''                       AS SZ01_UNSO                             " & vbNewLine _
                                            & "--群馬篠崎運送向け自由項目対応　終了　                             " & vbNewLine _
                                            & "--日医工対策終了                                                   " & vbNewLine _
                                            & ",''                       AS SHOBO_CD                              " & vbNewLine _
                                            & "FROM                                                               " & vbNewLine _
                                            & "(                                                                  " & vbNewLine

    ''' <summary>
    ''' 印刷データ抽出用(名古屋標準SELECT句)
    ''' </summary>
    ''' <remarks></remarks>
    Friend Const SQL_SELECT_MAIN_NAGOYA As String = "SELECT                                                                       " & vbNewLine _
                                                   & " RPT_ID                                                                      " & vbNewLine _
                                                   & ",NRS_BR_CD                                                                   " & vbNewLine _
                                                   & ",PRINT_SORT                                                                  " & vbNewLine _
                                                   & ",DEST_CD                                                                     " & vbNewLine _
                                                   & ",DEST_NM                                                                     " & vbNewLine _
                                                   & ",DEST_AD_1                                                                   " & vbNewLine _
                                                   & ",DEST_AD_2                                                                   " & vbNewLine _
                                                   & ",DEST_AD_3                                                                   " & vbNewLine _
                                                   & ",DEST_TEL                                                                    " & vbNewLine _
                                                   & ",OUTKA_PLAN_DATE                                                             " & vbNewLine _
                                                   & ",CUST_ORD_NO                                                                 " & vbNewLine _
                                                   & ",BUYER_ORD_NO                                                                " & vbNewLine _
                                                   & ",UNSOCO_NM                                                                   " & vbNewLine _
                                                   & ",ARR_PLAN_DATE                                                               " & vbNewLine _
                                                   & ",ARR_PLAN_TIME                                                               " & vbNewLine _
                                                   & ",OUTKA_NO_L                                                                  " & vbNewLine _
                                                   & ",URIG_NM                                                                     " & vbNewLine _
                                                   & ",CUST_NM_L                                                                   " & vbNewLine _
                                                   & "--(2012.06.15) 要望番号1155 -- START --                            " & vbNewLine _
                                                   & ",CUST_NM_M                                                         " & vbNewLine _
                                                   & "--(2012.06.15) 要望番号1155 --  END  --                            " & vbNewLine _
                                                   & ",CASE WHEN DEST_SALES_CD <> ''                                     " & vbNewLine _
                                                   & "           AND DEST_SALES_CD IS NOT NULL THEN DEST_SALES_AD_1      " & vbNewLine _
                                                   & "      ELSE CUST_AD_1 END CUST_AD_1                                 " & vbNewLine _
                                                   & ",CASE WHEN DEST_SALES_CD <> ''                                     " & vbNewLine _
                                                   & "           AND DEST_SALES_CD IS NOT NULL THEN DEST_SALES_AD_2      " & vbNewLine _
                                                   & "      ELSE CUST_AD_2 END CUST_AD_2                                 " & vbNewLine _
                                                   & ",CASE WHEN DEST_SALES_CD <> ''                                     " & vbNewLine _
                                                   & "           AND DEST_SALES_CD IS NOT NULL THEN DEST_SALES_TEL       " & vbNewLine _
                                                   & "      ELSE CUST_TEL END CUST_TEL                                 " & vbNewLine _
                                                   & ",DENPYO_NM                                                                   " & vbNewLine _
                                                   & ",NRS_BR_NM                                                                   " & vbNewLine _
                                                   & ",NRS_BR_AD1                                                                  " & vbNewLine _
                                                   & ",NRS_BR_AD2                                                                  " & vbNewLine _
                                                   & ",NRS_BR_TEL                                                                  " & vbNewLine _
                                                   & ",NRS_BR_FAX                                                                  " & vbNewLine _
                                                   & ",PIC                                                                         " & vbNewLine _
                                                   & ",MAX(OUTKA_NO_M)          AS OUTKA_NO_M                                      " & vbNewLine _
                                                   & ",MAX(OUTKA_NO_S)          AS OUTKA_NO_S                                      " & vbNewLine _
                                                   & ",MAX(INKA_DATE)           AS INKA_DATE                                       " & vbNewLine _
                                                   & ",MAX(REMARK_OUT)          AS REMARK_OUT                                      " & vbNewLine _
                                                   & ",GOODS_NM_1                                                                  " & vbNewLine _
                                                   & ",LOT_NO                                                                      " & vbNewLine _
                                                   & ",SERIAL_NO                                                                   " & vbNewLine _
                                                   & ",IRIME                                                                       " & vbNewLine _
                                                   & ",PKG_NB                                                                      " & vbNewLine _
                                                   & ",SUM(ALCTD_NB) / PKG_NB   AS KONSU                                           " & vbNewLine _
                                                   & ",SUM(ALCTD_NB) % PKG_NB   AS HASU                                            " & vbNewLine _
                                                   & ",SUM(ALCTD_NB)            AS ALCTD_NB                                        " & vbNewLine _
                                                   & ",PKG_UT                                                                      " & vbNewLine _
                                                   & ",PKG_UT_NM                                                                   " & vbNewLine _
                                                   & ",SUM(ALCTD_QT)            AS ALCTD_QT                                        " & vbNewLine _
                                                   & ",IRIME_UT                                                                    " & vbNewLine _
                                                   & ",WT                       AS WT                                              " & vbNewLine _
                                                   & ",UNSO_WT                                                                     " & vbNewLine _
                                                   & ",''                       AS TOU_NO                                          " & vbNewLine _
                                                   & ",''                       AS SITU_NO                                         " & vbNewLine _
                                                   & ",''                       AS ZONE_CD                                         " & vbNewLine _
                                                   & ",''                       AS LOCA                                            " & vbNewLine _
                                                   & ",MIN(ZAN_KONSU)           AS ZAN_KONSU                                       " & vbNewLine _
                                                   & "--(2012.09.06)要望番号1411 残端数不具合対応 -- START --                      " & vbNewLine _
                                                   & "--,MIN(ZAN_HASU)          AS ZAN_HASU                                        " & vbNewLine _
                                                   & ",MIN(ALCTD_CAN_NB) % PKG_NB AS ZAN_HASU                                      " & vbNewLine _
                                                   & "--(2012.09.06)要望番号1411 残端数不具合対応 --  END  --                      " & vbNewLine _
                                                   & ",GOODS_CD_CUST                                                               " & vbNewLine _
                                                   & ",MAX(REMARK_M)            AS REMARK_M                                        " & vbNewLine _
                                                   & ",''                       AS CUST_NM_S                                       " & vbNewLine _
                                                   & ",''                       AS CUST_NM_S_H                                     " & vbNewLine _
                                                   & ",MAX(CUST_ORD_NO_DTL)     AS CUST_ORD_NO_DTL                                 " & vbNewLine _
                                                   & ",OUTKA_REMARK                                                                " & vbNewLine _
                                                   & ",HAISOU_REMARK                                                               " & vbNewLine _
                                                   & ",NHS_REMARK                                                                  " & vbNewLine _
                                                   & ",KYORI                                                                       " & vbNewLine _
                                                   & ",OUTKA_PKG_NB_L                                                              " & vbNewLine _
                                                   & ",''                       AS SOKO_NM                                         " & vbNewLine _
                                                   & ",''                       AS BUSHO_NM                                        " & vbNewLine _
                                                   & ",''                       AS NRS_BR_NM_NICHI                                 " & vbNewLine _
                                                   & ",MIN(ALCTD_CAN_QT)        AS ALCTD_CAN_QT                                    " & vbNewLine _
                                                   & ",ALCTD_KB                                                                    " & vbNewLine _
                                                   & ",PTN_FLAG                                                                    " & vbNewLine _
                                                   & ",CUST_CD_L                                                                   " & vbNewLine _
                                                   & ",''                       AS ORDER_TYPE                                      " & vbNewLine _
                                                   & ",CASE WHEN URIG_NM <> ''                                                     " & vbNewLine _
                                                   & "           AND URIG_NM IS NOT NULL THEN URIG_NM                              " & vbNewLine _
                                                   & "--【要望番号1122】埼玉対応 --- START ---                                     " & vbNewLine _
                                                   & "      WHEN DEST_SALES_NM   <> ''                                             " & vbNewLine _
                                                   & "           AND DEST_SALES_NM IS NOT NULL THEN DEST_SALES_NM                  " & vbNewLine _
                                                   & "--【要望番号1122】埼玉対応 ---  END  ---                                     " & vbNewLine _
                                                   & "      WHEN DENPYO_NM   <> ''                                                 " & vbNewLine _
                                                   & "           AND DENPYO_NM IS NOT NULL   THEN DENPYO_NM                        " & vbNewLine _
                                                   & "      ELSE CUST_NM_L                                                         " & vbNewLine _
                                                   & " END                         AS ATSUKAISYA_NM                                " & vbNewLine _
                                                   & "--【要望番号995】　2012/04/17　元着払い区分　START                           " & vbNewLine _
                                                   & ",PC_KB_NM                                                                    " & vbNewLine _
                                                   & "--【要望番号995】　2012/04/17　元着払い区分　 END                            " & vbNewLine _
                                                   & "--【要望番号1017】 2012/04/24　注文番号明細  START                           " & vbNewLine _
                                                   & ",BUYER_ORD_NO_DTL                                                            " & vbNewLine _
                                                   & "--【要望番号1017】　2012/04/17 注文番号明細　 END                            " & vbNewLine _
                                                   & "--日医工対策開始                                                             " & vbNewLine _
                                                   & ",''                       AS TORI_KB                                         " & vbNewLine _
                                                   & "--★追加開始2012/05/11                                                       " & vbNewLine _
                                                   & ",''                       AS SHIP_CD_L                                       " & vbNewLine _
                                                   & "--★追加終了2012/05/11                                                       " & vbNewLine _
                                                   & "--★削除開始2012/05/11                                                       " & vbNewLine _
                                                   & ",''                       AS CHOKUSO_NM1                                     " & vbNewLine _
                                                   & ",''                       AS CHOKUSO_CD                                      " & vbNewLine _
                                                   & ",''                       AS HAKKO_DATE                                      " & vbNewLine _
                                                   & "--★削除終了2012/05/11                                                       " & vbNewLine _
                                                   & ",''                       AS SET_NAIYO_4                                     " & vbNewLine _
                                                   & ",''                       AS SET_NAIYO_5                                     " & vbNewLine _
                                                   & ",''                       AS SET_NAIYO_6                                     " & vbNewLine _
                                                   & ",''                       AS GOODS_NM_2                                      " & vbNewLine _
                                                   & ",''                       AS KICHO_KB                                        " & vbNewLine _
                                                   & ",''                       AS SEI_YURAI_KB                                    " & vbNewLine _
                                                   & ",''                       AS REMARK_UPPER                                    " & vbNewLine _
                                                   & ",''                       AS REMARK_LOWER                                    " & vbNewLine _
                                                   & ",''                       AS GOODS_SYUBETU                                   " & vbNewLine _
                                                   & ",''                       AS YUKOU_KIGEN                                     " & vbNewLine _
                                                   & ",''                       AS GOODS_NM_3    --2012/05/23                      " & vbNewLine _
                                                   & ",''                       AS EDISHIP_CD    --2012/05/23                      " & vbNewLine _
                                                   & ",''                       AS EDIDEST_CD    --2012/05/23                      " & vbNewLine _
                                                   & "--日医工対策終了                                                             " & vbNewLine _
                                                   & "--(2012.06.01)日本ファイン対応 --- START ---                                 " & vbNewLine _
                                                   & ",''                       AS SET_NAIYO_FROM1                                 " & vbNewLine _
                                                   & ",''                       AS SET_NAIYO_FROM2                                 " & vbNewLine _
                                                   & ",''                       AS SET_NAIYO_FROM3                                 " & vbNewLine _
                                                   & "--(2012.06.01)日本ファイン対応 ---  END  ---                                 " & vbNewLine _
                                                   & "--【要望番号1122】埼玉対応 --- START ---                                     " & vbNewLine _
                                                   & ",''                       AS CUST_AD_3                                       " & vbNewLine _
                                                   & ",''                       AS DEST_REMARK                                     " & vbNewLine _
                                                   & ",''                       AS DEST_SALES_CD                                   " & vbNewLine _
                                                   & ",''                       AS DEST_SALES_NM                                   " & vbNewLine _
                                                   & ",''                       AS DEST_SALES_AD_1                                 " & vbNewLine _
                                                   & ",''                       AS DEST_SALES_AD_2                                 " & vbNewLine _
                                                   & ",''                       AS DEST_SALES_AD_3                                 " & vbNewLine _
                                                   & ",''                       AS DEST_SALES_TEL                                  " & vbNewLine _
                                                   & "--【要望番号1122】埼玉対応 ---  END  ---                                     " & vbNewLine _
                                                   & "--群馬(合算)端数行分割版向け対応(作業略称) 開始 20120731                     " & vbNewLine _
                                                   & ",''                       AS SAGYO_RYAK_1                                    " & vbNewLine _
                                                   & ",''                       AS SAGYO_RYAK_2                                    " & vbNewLine _
                                                   & ",''                       AS SAGYO_RYAK_3                                    " & vbNewLine _
                                                   & ",''                       AS SAGYO_RYAK_4                                    " & vbNewLine _
                                                   & ",''                       AS SAGYO_RYAK_5                                    " & vbNewLine _
                                                   & ",''                       AS DEST_SAGYO_RYAK_1                               " & vbNewLine _
                                                   & ",''                       AS DEST_SAGYO_RYAK_2                               " & vbNewLine _
                                                   & "--群馬(合算)端数行分割版向け対応(作業略称) 終了 20120731                     " & vbNewLine _
                                                   & "--群馬篠崎運送向け自由項目対応　開始　                                       " & vbNewLine _
                                                   & ",''                       AS SZ01_YUSO                                       " & vbNewLine _
                                                   & ",''                       AS SZ01_UNSO                                       " & vbNewLine _
                                                   & "--群馬篠崎運送向け自由項目対応　終了　                                       " & vbNewLine _
                                                   & ",''                       AS SHOBO_CD                                        " & vbNewLine _
                                                   & "FROM                                                                         " & vbNewLine _
                                                   & "(                                                                            " & vbNewLine


    ''' <summary>
    ''' 印刷データ抽出用
    ''' </summary>
    ''' <remarks></remarks>
    Friend Const SQL_SELECT_NIK As String = " --SQL_SELECT_NIK                                                   " & vbNewLine _
                                            & " SELECT                                                            " & vbNewLine _
                                            & " RPT_ID                                                            " & vbNewLine _
                                            & ",NRS_BR_CD                                                         " & vbNewLine _
                                            & ",PRINT_SORT                                                        " & vbNewLine _
                                            & ",DEST_CD                                                           " & vbNewLine _
                                            & ",DEST_NM                                                           " & vbNewLine _
                                            & ",DEST_AD_1                                                         " & vbNewLine _
                                            & ",DEST_AD_2                                                         " & vbNewLine _
                                            & ",DEST_AD_3                                                         " & vbNewLine _
                                            & ",DEST_TEL                                                          " & vbNewLine _
                                            & ",OUTKA_PLAN_DATE                                                   " & vbNewLine _
                                            & ",CUST_ORD_NO                                                       " & vbNewLine _
                                            & ",BUYER_ORD_NO                                                      " & vbNewLine _
                                            & ",UNSOCO_NM                                                         " & vbNewLine _
                                            & ",ARR_PLAN_DATE                                                     " & vbNewLine _
                                            & ",ARR_PLAN_TIME                                                     " & vbNewLine _
                                            & ",OUTKA_NO_L                                                        " & vbNewLine _
                                            & ",URIG_NM                                                           " & vbNewLine _
                                            & ",CUST_NM_L                                                         " & vbNewLine _
                                            & "--(2012.06.15) 要望番号1155 -- START --                            " & vbNewLine _
                                            & ",CUST_NM_M                                                         " & vbNewLine _
                                            & ",DENPYO_NM                                                         " & vbNewLine _
                                            & "--(2012.06.15) 要望番号1155 --  END  --                            " & vbNewLine _
                                            & ",CASE WHEN DEST_SALES_CD <> ''                                     " & vbNewLine _
                                            & "           AND DEST_SALES_CD IS NOT NULL THEN DEST_SALES_AD_1      " & vbNewLine _
                                            & "      ELSE CUST_AD_1 END CUST_AD_1                                 " & vbNewLine _
                                            & ",CASE WHEN DEST_SALES_CD <> ''                                     " & vbNewLine _
                                            & "           AND DEST_SALES_CD IS NOT NULL THEN DEST_SALES_AD_2      " & vbNewLine _
                                            & "      ELSE CUST_AD_2 END CUST_AD_2                                 " & vbNewLine _
                                            & ",CASE WHEN DEST_SALES_CD <> ''                                     " & vbNewLine _
                                            & "           AND DEST_SALES_CD IS NOT NULL THEN DEST_SALES_TEL       " & vbNewLine _
                                            & "      ELSE CUST_TEL END CUST_TEL                                   " & vbNewLine _
                                            & ",NRS_BR_NM                                                         " & vbNewLine _
                                            & ",NRS_BR_AD1                                                        " & vbNewLine _
                                            & ",NRS_BR_AD2                                                        " & vbNewLine _
                                            & ",NRS_BR_TEL                                                        " & vbNewLine _
                                            & ",NRS_BR_FAX                                                        " & vbNewLine _
                                            & ",PIC                                                               " & vbNewLine _
                                            & ",OUTKA_NO_M                                                        " & vbNewLine _
                                            & ",MIN(OUTKA_NO_S)          AS OUTKA_NO_S                            " & vbNewLine _
                                            & ",MIN(INKA_DATE)           AS INKA_DATE                             " & vbNewLine _
                                            & ",MAX(REMARK_OUT)          AS REMARK_OUT                            " & vbNewLine _
                                            & ",GOODS_NM_1                                                        " & vbNewLine _
                                            & ",LOT_NO                                                            " & vbNewLine _
                                            & ",SERIAL_NO                                                         " & vbNewLine _
                                            & ",IRIME                                                             " & vbNewLine _
                                            & ",PKG_NB                                                            " & vbNewLine _
                                            & ",SUM(ALCTD_NB) / PKG_NB   AS KONSU                                 " & vbNewLine _
                                            & ",SUM(ALCTD_NB) % PKG_NB   AS HASU                                  " & vbNewLine _
                                            & ",SUM(ALCTD_NB)            AS ALCTD_NB                              " & vbNewLine _
                                            & ",PKG_UT                                                            " & vbNewLine _
                                            & ",PKG_UT_NM                                                         " & vbNewLine _
                                            & ",SUM(ALCTD_QT)            AS ALCTD_QT                              " & vbNewLine _
                                            & ",IRIME_UT                                                          " & vbNewLine _
                                            & ",WT                       AS WT                                    " & vbNewLine _
                                            & ",UNSO_WT                                                           " & vbNewLine _
                                            & ",'' AS TOU_NO                                                      " & vbNewLine _
                                            & ",'' AS SITU_NO                                                     " & vbNewLine _
                                            & ",'' AS ZONE_CD                                                     " & vbNewLine _
                                            & ",'' AS LOCA                                                        " & vbNewLine _
                                            & ",MIN(ZAN_KONSU)           AS ZAN_KONSU                             " & vbNewLine _
                                            & "--(2012.09.06)要望番号1411 残端数不具合対応 -- START --            " & vbNewLine _
                                            & "--,MIN(ZAN_HASU)          AS ZAN_HASU                              " & vbNewLine _
                                            & ",MIN(ALCTD_CAN_NB) % PKG_NB AS ZAN_HASU                            " & vbNewLine _
                                            & "--(2012.09.06)要望番号1411 残端数不具合対応 --  END  --            " & vbNewLine _
                                            & ",GOODS_CD_CUST                                                     " & vbNewLine _
                                            & ",REMARK_M                                                          " & vbNewLine _
                                            & ",CUST_NM_S                                                         " & vbNewLine _
                                            & ",CUST_NM_S_H                                                       " & vbNewLine _
                                            & ",CUST_ORD_NO_DTL                                                   " & vbNewLine _
                                            & ",OUTKA_REMARK                                                      " & vbNewLine _
                                            & ",HAISOU_REMARK                                                     " & vbNewLine _
                                            & ",NHS_REMARK                                                        " & vbNewLine _
                                            & ",KYORI                                                             " & vbNewLine _
                                            & ",OUTKA_PKG_NB_L                                                    " & vbNewLine _
                                            & ",SOKO_NM                                                           " & vbNewLine _
                                            & ",BUSHO_NM                                                          " & vbNewLine _
                                            & ",NRS_BR_NM_NICHI                                                   " & vbNewLine _
                                            & ",MIN(ALCTD_CAN_QT)        AS ALCTD_CAN_QT                          " & vbNewLine _
                                            & ",ALCTD_KB                                                          " & vbNewLine _
                                            & ",PTN_FLAG                                                          " & vbNewLine _
                                            & ",CUST_CD_L                                                         " & vbNewLine _
                                            & ",ORDER_TYPE                       AS ORDER_TYPE                    " & vbNewLine _
                                            & ",CASE WHEN URIG_NM <> ''                                           " & vbNewLine _
                                            & "           AND URIG_NM IS NOT NULL THEN URIG_NM                    " & vbNewLine _
                                            & "--【要望番号1122】埼玉対応 --- START ---                           " & vbNewLine _
                                            & "      WHEN DEST_SALES_NM   <> ''                                   " & vbNewLine _
                                            & "           AND DEST_SALES_NM IS NOT NULL THEN DEST_SALES_NM        " & vbNewLine _
                                            & "--【要望番号1122】埼玉対応 ---  END  ---                           " & vbNewLine _
                                            & "      WHEN DENPYO_NM   <> ''                                       " & vbNewLine _
                                            & "           AND DENPYO_NM IS NOT NULL   THEN DENPYO_NM              " & vbNewLine _
                                            & "      ELSE CUST_NM_L                                               " & vbNewLine _
                                            & " END                         AS ATSUKAISYA_NM                      " & vbNewLine _
                                            & "--【要望番号995】　2012/04/17　元着払い区分　START                 " & vbNewLine _
                                            & ",PC_KB_NM                                                          " & vbNewLine _
                                            & "--【要望番号995】　2012/04/17　元着払い区分　 END                  " & vbNewLine _
                                            & "--【要望番号1017】 2012/04/24　注文番号明細  START                 " & vbNewLine _
                                            & ",BUYER_ORD_NO_DTL                                                  " & vbNewLine _
                                            & "--【要望番号1017】　2012/04/17 注文番号明細　 END                  " & vbNewLine _
                                            & "--日医工対策開始                                                   " & vbNewLine _
                                            & ",TORI_KB                                                           " & vbNewLine _
                                            & "--★追加開始2012/05/11                                             " & vbNewLine _
                                            & ",SHIP_CD_L                                                         " & vbNewLine _
                                            & "--★追加終了2012/05/11                                             " & vbNewLine _
                                            & "--★削除開始2012/05/11                                             " & vbNewLine _
                                            & "--,CHOKUSO_NM                                                      " & vbNewLine _
                                            & "--,CHOKUSO_CD                                                      " & vbNewLine _
                                            & "--,HAKKO_DATE                                                      " & vbNewLine _
                                            & "--★削除終了2012/05/11                                             " & vbNewLine _
                                            & ",SET_NAIYO_4                                                       " & vbNewLine _
                                            & ",SET_NAIYO_5                                                       " & vbNewLine _
                                            & ",SET_NAIYO_6                                                       " & vbNewLine _
                                            & ",GOODS_NM_2                                                        " & vbNewLine _
                                            & ",KICHO_KB                                                          " & vbNewLine _
                                            & ",SEI_YURAI_KB                                                      " & vbNewLine _
                                            & ",REMARK_UPPER                                                      " & vbNewLine _
                                            & ",REMARK_LOWER                                                      " & vbNewLine _
                                            & ",GOODS_SYUBETU                                                     " & vbNewLine _
                                            & ",YUKOU_KIGEN                                                       " & vbNewLine _
                                            & ",GOODS_NM_3    --2012/05/23                                        " & vbNewLine _
                                            & ",EDISHIP_CD    --2012/05/23                                        " & vbNewLine _
                                            & ",EDIDEST_CD    --2012/05/23                                        " & vbNewLine _
                                            & "--日医工対策終了                                                   " & vbNewLine _
                                            & "--(2012.06.01)日本ファイン対応 --- START ---                       " & vbNewLine _
                                            & ",''                       AS SET_NAIYO_FROM1                       " & vbNewLine _
                                            & ",''                       AS SET_NAIYO_FROM2                       " & vbNewLine _
                                            & ",''                       AS SET_NAIYO_FROM3                       " & vbNewLine _
                                            & "--(2012.06.01)日本ファイン対応 ---  END  ---                       " & vbNewLine _
                                            & "--【要望番号1122】埼玉対応 --- START ---                           " & vbNewLine _
                                            & ",''                       AS CUST_AD_3                             " & vbNewLine _
                                            & ",''                       AS DEST_REMARK                           " & vbNewLine _
                                            & ",''                       AS DEST_SALES_CD                         " & vbNewLine _
                                            & ",''                       AS DEST_SALES_NM                         " & vbNewLine _
                                            & ",''                       AS DEST_SALES_AD_1                       " & vbNewLine _
                                            & ",''                       AS DEST_SALES_AD_2                       " & vbNewLine _
                                            & ",''                       AS DEST_SALES_AD_3                       " & vbNewLine _
                                            & ",''                       AS DEST_SALES_TEL                        " & vbNewLine _
                                            & "--【要望番号1122】埼玉対応 ---  END  ---                           " & vbNewLine _
                                            & "--群馬(合算)端数行分割版向け対応(作業略称) 開始 20120731           " & vbNewLine _
                                            & ",''                       AS SAGYO_RYAK_1                          " & vbNewLine _
                                            & ",''                       AS SAGYO_RYAK_2                          " & vbNewLine _
                                            & ",''                       AS SAGYO_RYAK_3                          " & vbNewLine _
                                            & ",''                       AS SAGYO_RYAK_4                          " & vbNewLine _
                                            & ",''                       AS SAGYO_RYAK_5                          " & vbNewLine _
                                            & ",''                       AS DEST_SAGYO_RYAK_1                     " & vbNewLine _
                                            & ",''                       AS DEST_SAGYO_RYAK_2                     " & vbNewLine _
                                            & "--群馬(合算)端数行分割版向け対応(作業略称) 終了 20120731           " & vbNewLine _
                                            & "--群馬篠崎運送向け自由項目対応　開始　                             " & vbNewLine _
                                            & ",''                       AS SZ01_YUSO                             " & vbNewLine _
                                            & ",''                       AS SZ01_UNSO                             " & vbNewLine _
                                            & "--群馬篠崎運送向け自由項目対応　終了　                             " & vbNewLine _
                                            & ",''                       AS SHOBO_CD                              " & vbNewLine _
                                            & "FROM                                                               " & vbNewLine _
                                            & "(                                                                  " & vbNewLine

    ''' <summary>
    ''' 印刷データ抽出用
    ''' </summary>
    ''' <remarks></remarks>
    Friend Const SQL_SELECT_622 As String = " SELECT                                                             " & vbNewLine _
                                           & "        RPT_ID                                                      " & vbNewLine _
                                           & "      , NRS_BR_CD                                                   " & vbNewLine _
                                           & "      , PRINT_SORT                                                  " & vbNewLine _
                                           & "      , DEST_CD                                                     " & vbNewLine _
                                           & "      , DEST_NM                                                     " & vbNewLine _
                                           & "      , DEST_AD_1                                                   " & vbNewLine _
                                           & "      , DEST_AD_2                                                   " & vbNewLine _
                                           & "      , DEST_AD_3                                                   " & vbNewLine _
                                           & "      , DEST_TEL                                                    " & vbNewLine _
                                           & "      , OUTKA_PLAN_DATE                                             " & vbNewLine _
                                           & "      , CUST_ORD_NO                                                 " & vbNewLine _
                                           & "      , BUYER_ORD_NO                                                " & vbNewLine _
                                           & "      , UNSOCO_NM                                                   " & vbNewLine _
                                           & "      , ARR_PLAN_DATE                                               " & vbNewLine _
                                           & "      , ARR_PLAN_TIME                                               " & vbNewLine _
                                           & "      , OUTKA_NO_L                                                  " & vbNewLine _
                                           & "      , MIN(OUTKA_NO_M)          AS OUTKA_NO_M                      " & vbNewLine _
                                           & "      , URIG_NM                                                     " & vbNewLine _
                                           & "      , CUST_NM_L                                                   " & vbNewLine _
                                           & "      , CUST_NM_M                                                   " & vbNewLine _
                                           & "      , DENPYO_NM                                                   " & vbNewLine _
                                           & "      , CASE WHEN DEST_SALES_CD <> ''                               " & vbNewLine _
                                           & "              AND DEST_SALES_CD IS NOT NULL THEN DEST_SALES_AD_1    " & vbNewLine _
                                           & "        ELSE CUST_AD_1 END CUST_AD_1                                " & vbNewLine _
                                           & "      , CASE WHEN DEST_SALES_CD <> ''                               " & vbNewLine _
                                           & "              AND DEST_SALES_CD IS NOT NULL THEN DEST_SALES_AD_2    " & vbNewLine _
                                           & "        ELSE CUST_AD_2 END CUST_AD_2                                " & vbNewLine _
                                           & "      , CASE WHEN DEST_SALES_CD <> ''                               " & vbNewLine _
                                           & "              AND DEST_SALES_CD IS NOT NULL THEN DEST_SALES_TEL     " & vbNewLine _
                                           & "        ELSE CUST_TEL END CUST_TEL                                  " & vbNewLine _
                                           & "      , NRS_BR_NM                                                   " & vbNewLine _
                                           & "      , NRS_BR_AD1                                                  " & vbNewLine _
                                           & "      , NRS_BR_AD2                                                  " & vbNewLine _
                                           & "      , NRS_BR_TEL                                                  " & vbNewLine _
                                           & "      , NRS_BR_FAX                                                  " & vbNewLine _
                                           & "      , PIC                                                         " & vbNewLine _
                                           & "      , MIN(OUTKA_NO_S)          AS OUTKA_NO_S                      " & vbNewLine _
                                           & "      , REMARK_OUT                                                  " & vbNewLine _
                                           & "      , GOODS_NM_1                                                  " & vbNewLine _
                                           & "      , LOT_NO                                                      " & vbNewLine _
                                           & "      , SERIAL_NO                                                   " & vbNewLine _
                                           & "      , IRIME                                                       " & vbNewLine _
                                           & "      , PKG_NB                                                      " & vbNewLine _
                                           & "      , SUM(ALCTD_NB) / PKG_NB   AS KONSU                           " & vbNewLine _
                                           & "      , SUM(ALCTD_NB) % PKG_NB   AS HASU                            " & vbNewLine _
                                           & "      , SUM(ALCTD_NB)            AS ALCTD_NB                        " & vbNewLine _
                                           & "      , PKG_UT                                                      " & vbNewLine _
                                           & "      , PKG_UT_NM                                                   " & vbNewLine _
                                           & "      , SUM(ALCTD_QT)            AS ALCTD_QT                        " & vbNewLine _
                                           & "      , IRIME_UT                                                    " & vbNewLine _
                                           & "      , WT                       AS WT                              " & vbNewLine _
                                           & "      , UNSO_WT                                                     " & vbNewLine _
                                           & "      , TOU_NO                                                      " & vbNewLine _
                                           & "      , SITU_NO                                                     " & vbNewLine _
                                           & "      , ZONE_CD                                                     " & vbNewLine _
                                           & "      , LOCA                                                        " & vbNewLine _
                                           & " --(2012.10.30)要望番号1545 -- START --                             " & vbNewLine _
                                           & "      , MIN(ZAN_KONSU)           AS ZAN_KONSU                       " & vbNewLine _
                                           & " --(2012.10.30)要望番号1545 --  END  --                             " & vbNewLine _
                                           & "      , MIN(ALCTD_CAN_NB) % PKG_NB      AS ZAN_HASU                 " & vbNewLine _
                                           & "      , GOODS_CD_CUST                                               " & vbNewLine _
                                           & "      , REMARK_M                                                    " & vbNewLine _
                                           & "      , CUST_NM_S                                                   " & vbNewLine _
                                           & "      , CUST_NM_S_H                                                 " & vbNewLine _
                                           & "      , OUTKA_REMARK                                                " & vbNewLine _
                                           & "      , HAISOU_REMARK                                               " & vbNewLine _
                                           & "      , NHS_REMARK                                                  " & vbNewLine _
                                           & "      , KYORI                                                       " & vbNewLine _
                                           & "      , OUTKA_PKG_NB_L                                              " & vbNewLine _
                                           & "      , SOKO_NM                                                     " & vbNewLine _
                                           & "      , BUSHO_NM                                                    " & vbNewLine _
                                           & "      , NRS_BR_NM_NICHI                                             " & vbNewLine _
                                           & "      , MIN(ALCTD_CAN_QT)        AS ALCTD_CAN_QT                    " & vbNewLine _
                                           & "      , ALCTD_KB                                                    " & vbNewLine _
                                           & "      , PTN_FLAG                                                    " & vbNewLine _
                                           & "      , CUST_CD_L                                                   " & vbNewLine _
                                           & "      , ORDER_TYPE               AS ORDER_TYPE                      " & vbNewLine _
                                           & "      , CASE WHEN URIG_NM <> ''                                     " & vbNewLine _
                                           & "              AND URIG_NM IS NOT NULL THEN URIG_NM                  " & vbNewLine _
                                           & "             WHEN DEST_SALES_NM   <> ''                             " & vbNewLine _
                                           & "              AND DEST_SALES_NM IS NOT NULL THEN DEST_SALES_NM      " & vbNewLine _
                                           & "             WHEN DENPYO_NM   <> ''                                 " & vbNewLine _
                                           & "              AND DENPYO_NM IS NOT NULL   THEN DENPYO_NM            " & vbNewLine _
                                           & "        ELSE CUST_NM_L                                              " & vbNewLine _
                                           & "        END                      AS ATSUKAISYA_NM                   " & vbNewLine _
                                           & "      , PC_KB_NM                                                    " & vbNewLine _
                                           & "      , TORI_KB                                                     " & vbNewLine _
                                           & "      , SHIP_CD_L                                                   " & vbNewLine _
                                           & "      , SET_NAIYO_4                                                 " & vbNewLine _
                                           & "      , SET_NAIYO_5                                                 " & vbNewLine _
                                           & "      , SET_NAIYO_6                                                 " & vbNewLine _
                                           & "      , GOODS_NM_2                                                  " & vbNewLine _
                                           & "      , '' AS SEI_YURAI_KB                                                " & vbNewLine _
                                           & "      , '' AS REMARK_UPPER                                                " & vbNewLine _
                                           & "      , '' AS REMARK_LOWER                                                " & vbNewLine _
                                           & "      , '' AS GOODS_SYUBETU                                               " & vbNewLine _
                                           & "      , GOODS_NM_3                                                  " & vbNewLine _
                                           & "      , EDISHIP_CD                                                  " & vbNewLine _
                                           & "      , EDIDEST_CD                                                  " & vbNewLine _
                                           & "      , SET_NAIYO_FROM1                                             " & vbNewLine _
                                           & "      , SET_NAIYO_FROM2                                             " & vbNewLine _
                                           & "      , SET_NAIYO_FROM3                                             " & vbNewLine _
                                           & "      , CASE WHEN DEST_SALES_CD <> ''                               " & vbNewLine _
                                           & "              AND DEST_SALES_CD IS NOT NULL THEN DEST_SALES_AD_3    " & vbNewLine _
                                           & "        ELSE CUST_AD_3                                              " & vbNewLine _
                                           & "        END                     AS CUST_AD_3                        " & vbNewLine _
                                           & "      , DEST_REMARK                                                 " & vbNewLine _
                                           & "      , DEST_SALES_CD                                               " & vbNewLine _
                                           & "      , DEST_SALES_NM                                               " & vbNewLine _
                                           & "      , DEST_SALES_AD_1                                             " & vbNewLine _
                                           & "      , DEST_SALES_AD_2                                             " & vbNewLine _
                                           & "      , DEST_SALES_AD_3                                             " & vbNewLine _
                                           & "      , DEST_SALES_TEL                                              " & vbNewLine _
                                           & "      , SAGYO_RYAK_1                                                " & vbNewLine _
                                           & "      , SAGYO_RYAK_2                                                " & vbNewLine _
                                           & "      , SAGYO_RYAK_3                                                " & vbNewLine _
                                           & "      , SAGYO_RYAK_4                                                " & vbNewLine _
                                           & "      , SAGYO_RYAK_5                                                " & vbNewLine _
                                           & "      , DEST_SAGYO_RYAK_1                                           " & vbNewLine _
                                           & "      , DEST_SAGYO_RYAK_2                                           " & vbNewLine _
                                           & "--2013.08.23 要望番号2096 修正START                                              " & vbNewLine _
                                           & "      , INKA_DATE               AS INKA_DATE                        " & vbNewLine _
                                           & "--      , MIN(INKA_DATE)          AS INKA_DATE                        " & vbNewLine _
                                           & "--2013.08.23 要望番号2096 修正END                                                " & vbNewLine _
                                           & "      , ''                      AS CUST_ORD_NO_DTL                  " & vbNewLine _
                                           & "      , ''                      AS YUKOU_KIGEN                      " & vbNewLine _
                                           & "      , ''                      AS BUYER_ORD_NO_DTL                 " & vbNewLine _
                                           & "      , ''                      AS KICHO_KB                         " & vbNewLine _
                                           & "      , ''                      AS SZ01_YUSO                        " & vbNewLine _
                                           & "      , ''                      AS SZ01_UNSO                        " & vbNewLine _
                                           & "      , ''                      AS SHOBO_CD                         " & vbNewLine _
                                           & "   FROM                                                             " & vbNewLine _
                                           & "        (                                                           " & vbNewLine


    ''' <summary>
    ''' 印刷データ抽出用
    ''' </summary>
    ''' <remarks>出荷管理番号(中)をMINで抽出</remarks>
    Friend Const SQL_SELECT_MAIN_621 As String = " --SQL_SELECT_MAIN_621                                            " & vbNewLine _
                                                & " SELECT                                                           " & vbNewLine _
                                                & "        RPT_ID                                                    " & vbNewLine _
                                                & "      , NRS_BR_CD                                                 " & vbNewLine _
                                                & "      , PRINT_SORT                                                " & vbNewLine _
                                                & "      , DEST_CD                                                   " & vbNewLine _
                                                & "      , DEST_NM                                                   " & vbNewLine _
                                                & "      , DEST_AD_1                                                 " & vbNewLine _
                                                & "      , DEST_AD_2                                                 " & vbNewLine _
                                                & "      , DEST_AD_3                                                 " & vbNewLine _
                                                & "      , DEST_TEL                                                  " & vbNewLine _
                                                & "      , OUTKA_PLAN_DATE                                           " & vbNewLine _
                                                & "      , CUST_ORD_NO                                               " & vbNewLine _
                                                & "      , BUYER_ORD_NO                                              " & vbNewLine _
                                                & "      , UNSOCO_NM                                                 " & vbNewLine _
                                                & "      , ARR_PLAN_DATE                                             " & vbNewLine _
                                                & "      , ARR_PLAN_TIME                                             " & vbNewLine _
                                                & "      , OUTKA_NO_L                                                " & vbNewLine _
                                                & "      , URIG_NM                                                   " & vbNewLine _
                                                & "      , CUST_NM_L                                                 " & vbNewLine _
                                                & "      , CUST_NM_M                                                 " & vbNewLine _
                                                & "      , DENPYO_NM                                                 " & vbNewLine _
                                                & "      , CASE WHEN DEST_SALES_CD <> ''                             " & vbNewLine _
                                                & "              AND DEST_SALES_CD IS NOT NULL THEN DEST_SALES_AD_1  " & vbNewLine _
                                                & "             ELSE CUST_AD_1 END CUST_AD_1                         " & vbNewLine _
                                                & "      , CASE WHEN DEST_SALES_CD <> ''                             " & vbNewLine _
                                                & "              AND DEST_SALES_CD IS NOT NULL THEN DEST_SALES_AD_2  " & vbNewLine _
                                                & "             ELSE CUST_AD_2 END CUST_AD_2                         " & vbNewLine _
                                                & "      , CASE WHEN DEST_SALES_CD <> ''                             " & vbNewLine _
                                                & "              AND DEST_SALES_CD IS NOT NULL THEN DEST_SALES_TEL   " & vbNewLine _
                                                & "        ELSE CUST_TEL                                             " & vbNewLine _
                                                & "        END                        AS CUST_TEL                    " & vbNewLine _
                                                & "      , NRS_BR_NM                                                 " & vbNewLine _
                                                & "      , NRS_BR_AD1                                                " & vbNewLine _
                                                & "      , NRS_BR_AD2                                                " & vbNewLine _
                                                & "      , NRS_BR_TEL                                                " & vbNewLine _
                                                & "      , NRS_BR_FAX                                                " & vbNewLine _
                                                & "      , PIC                                                       " & vbNewLine _
                                                & "--(2012.11.01)要望番号1560 -- START --                            " & vbNewLine _
                                                & "   -- , MIN(OUTKA_NO_M)            AS OUTKA_NO_M                  " & vbNewLine _
                                                & "      , OUTKA_NO_M                 AS OUTKA_NO_M                  " & vbNewLine _
                                                & "--(2012.11.01)要望番号1560 -- END --                              " & vbNewLine _
                                                & "      , MIN(OUTKA_NO_S)            AS OUTKA_NO_S                  " & vbNewLine _
                                                & "      , INKA_DATE                                                 " & vbNewLine _
                                                & "      , REMARK_OUT                                                " & vbNewLine _
                                                & "      , GOODS_NM_1                                                " & vbNewLine _
                                                & "      , LOT_NO                                                    " & vbNewLine _
                                                & "      , SERIAL_NO                                                 " & vbNewLine _
                                                & "      , IRIME                                                     " & vbNewLine _
                                                & "      , PKG_NB                                                    " & vbNewLine _
                                                & "      , SUM(ALCTD_NB) / PKG_NB     AS KONSU                       " & vbNewLine _
                                                & "      , SUM(ALCTD_NB) % PKG_NB     AS HASU                        " & vbNewLine _
                                                & "      , SUM(ALCTD_NB)              AS ALCTD_NB                    " & vbNewLine _
                                                & "      , PKG_UT                                                    " & vbNewLine _
                                                & "      , PKG_UT_NM                                                 " & vbNewLine _
                                                & "      , SUM(ALCTD_QT)              AS ALCTD_QT                    " & vbNewLine _
                                                & "      , IRIME_UT                                                  " & vbNewLine _
                                                & "      , WT                         AS WT                          " & vbNewLine _
                                                & "      , UNSO_WT                                                   " & vbNewLine _
                                                & "--(2012.11.21)要望番号1615 -- START --                            " & vbNewLine _
                                                & "      , SUM(ALCTD_NB) * PKG_WT     AS PKG_WT                      " & vbNewLine _
                                                & "--(2012.11.21)要望番号1615 --  END  --                            " & vbNewLine _
                                                & "      , TOU_NO                                                    " & vbNewLine _
                                                & "      , SITU_NO                                                   " & vbNewLine _
                                                & "      , ZONE_CD                                                   " & vbNewLine _
                                                & "      , LOCA                                                      " & vbNewLine _
                                                & "      , MIN(ZAN_KONSU)             AS ZAN_KONSU                   " & vbNewLine _
                                                & "      , MIN(ALCTD_CAN_NB) % PKG_NB AS ZAN_HASU                    " & vbNewLine _
                                                & "      , GOODS_CD_CUST                                             " & vbNewLine _
                                                & "      , REMARK_M                                                  " & vbNewLine _
                                                & "      , CUST_NM_S                                                 " & vbNewLine _
                                                & "      , CUST_NM_S_H                                               " & vbNewLine _
                                                & "      , CUST_ORD_NO_DTL                                           " & vbNewLine _
                                                & "      , OUTKA_REMARK                                              " & vbNewLine _
                                                & "      , HAISOU_REMARK                                             " & vbNewLine _
                                                & "      , NHS_REMARK                                                " & vbNewLine _
                                                & "      , KYORI                                                     " & vbNewLine _
                                                & "      , OUTKA_PKG_NB_L                                            " & vbNewLine _
                                                & "      , SOKO_NM                                                   " & vbNewLine _
                                                & "      , BUSHO_NM                                                  " & vbNewLine _
                                                & "      , NRS_BR_NM_NICHI                                           " & vbNewLine _
                                                & "      , MIN(ALCTD_CAN_QT)          AS ALCTD_CAN_QT                " & vbNewLine _
                                                & "      , ALCTD_KB                                                  " & vbNewLine _
                                                & "      , PTN_FLAG                                                  " & vbNewLine _
                                                & "      , CUST_CD_L                                                 " & vbNewLine _
                                                & "      , ORDER_TYPE                 AS ORDER_TYPE                  " & vbNewLine _
                                                & "      , CASE WHEN URIG_NM <> ''                                   " & vbNewLine _
                                                & "              AND URIG_NM IS NOT NULL THEN URIG_NM                " & vbNewLine _
                                                & "             WHEN DEST_SALES_NM   <> ''                           " & vbNewLine _
                                                & "              AND DEST_SALES_NM IS NOT NULL THEN DEST_SALES_NM    " & vbNewLine _
                                                & "             WHEN DENPYO_NM   <> ''                               " & vbNewLine _
                                                & "              AND DENPYO_NM IS NOT NULL   THEN DENPYO_NM          " & vbNewLine _
                                                & "        ELSE CUST_NM_L + CASE WHEN RPT_ID = 'LMC637' THEN ' ' + CUST_NM_S ELSE '' END                                           " & vbNewLine _
                                                & "        END                        AS ATSUKAISYA_NM               " & vbNewLine _
                                                & "      , MCD_SET_NAIYO                                             " & vbNewLine _
                                                & "      , MCD_SET_NAIYO_2                                           " & vbNewLine _
                                                & "      , MCD_SET_NAIYO_3                                           " & vbNewLine _
                                                & "      , PC_KB_NM                                                  " & vbNewLine _
                                                & "      , BUYER_ORD_NO_DTL                                          " & vbNewLine _
                                                & "      , TORI_KB                    --FREE_C01                     " & vbNewLine _
                                                & "      , SHIP_CD_L                                                 " & vbNewLine _
                                                & "      , SET_NAIYO_4                                               " & vbNewLine _
                                                & "      , SET_NAIYO_5                                               " & vbNewLine _
                                                & "      , SET_NAIYO_6                                               " & vbNewLine _
                                                & "      , GOODS_NM_2                                                " & vbNewLine _
                                                & "      , KICHO_KB                                                  " & vbNewLine _
                                                & "      , SEI_YURAI_KB                                              " & vbNewLine _
                                                & "      , REMARK_UPPER                                              " & vbNewLine _
                                                & "      , REMARK_LOWER                                              " & vbNewLine _
                                                & "      , GOODS_SYUBETU                                             " & vbNewLine _
                                                & "      , YUKOU_KIGEN                                               " & vbNewLine _
                                                & "      , GOODS_NM_3                                                " & vbNewLine _
                                                & "      , EDISHIP_CD                                                " & vbNewLine _
                                                & "      , EDIDEST_CD                                                " & vbNewLine _
                                                & "      , SET_NAIYO_FROM1                                           " & vbNewLine _
                                                & "      , SET_NAIYO_FROM2                                           " & vbNewLine _
                                                & "      , SET_NAIYO_FROM3                                           " & vbNewLine _
                                                & "      , CASE WHEN DEST_SALES_CD <> ''                             " & vbNewLine _
                                                & "              AND DEST_SALES_CD IS NOT NULL THEN DEST_SALES_AD_3  " & vbNewLine _
                                                & "        ELSE CUST_AD_3                                            " & vbNewLine _
                                                & "        END                        AS CUST_AD_3                   " & vbNewLine _
                                                & "      , DEST_REMARK                                               " & vbNewLine _
                                                & "      , DEST_SALES_CD                                             " & vbNewLine _
                                                & "      , DEST_SALES_NM                                             " & vbNewLine _
                                                & "      , DEST_SALES_AD_1                                           " & vbNewLine _
                                                & "      , DEST_SALES_AD_2                                           " & vbNewLine _
                                                & "      , DEST_SALES_AD_3                                           " & vbNewLine _
                                                & "      , DEST_SALES_TEL                                            " & vbNewLine _
                                                & "      , SAGYO_RYAK_1                                              " & vbNewLine _
                                                & "      , SAGYO_RYAK_2                                              " & vbNewLine _
                                                & "      , SAGYO_RYAK_3                                              " & vbNewLine _
                                                & "      , SAGYO_RYAK_4                                              " & vbNewLine _
                                                & "      , SAGYO_RYAK_5                                              " & vbNewLine _
                                                & "      , DEST_SAGYO_RYAK_1                                         " & vbNewLine _
                                                & "      , DEST_SAGYO_RYAK_2                                         " & vbNewLine _
                                                & "      , SZ01_YUSO                                                 " & vbNewLine _
                                                & "      , SZ01_UNSO                                                 " & vbNewLine _
                                                & "--(2012.10.19)要望番号1289 -- START --                            " & vbNewLine _
                                                & "      , GOODS_COND_CD_1                                           " & vbNewLine _
                                                & "      , GOODS_COND_CD                                             " & vbNewLine _
                                                & "      , GOODS_COND_CD_3                                           " & vbNewLine _
                                                & "      , REMARK_ZAI                                                " & vbNewLine _
                                                & "      , LT_DATE                                                   " & vbNewLine _
                                                & "      , CASE WHEN SET_NAIYO = '1'  THEN  '1'                      " & vbNewLine _
                                                & "        ELSE ''                                                   " & vbNewLine _
                                                & "        END  AS SET_NAIYO                                         " & vbNewLine _
                                                & "      , SYS_UPD_PGID                                              " & vbNewLine _
                                                & "--(2012.10.19)要望番号1289 --  END  --                            " & vbNewLine _
                                                & "      , SHOBO_KBN_NM                                              " & vbNewLine _
                                                & "      , HINMEI                                                    " & vbNewLine _
                                                & "--(2012.11.28) LMC637対応 -- START --                             " & vbNewLine _
                                                & "      , CUST_CD_M                                                 " & vbNewLine _
                                                & "      , CUST_CD_S                                                 " & vbNewLine _
                                                & "      , CUST_COST_CD2                                             " & vbNewLine _
                                                & "--(2012.11.28) LMC637対応 --  END  --                             " & vbNewLine _
                                                & "   FROM                                                           " & vbNewLine _
                                                & "        (                                                         " & vbNewLine


    ''' <summary>
    ''' 印刷データ抽出用
    ''' </summary>
    ''' <remarks>
    ''' 出荷管理番号(中)をMINで抽出
    ''' (SQL_SELECT_MAIN_621から分岐 20160722)
    ''' </remarks>
    Friend Const SQL_SELECT_MAIN_629 As String = " --SQL_SELECT_MAIN_629                                            " & vbNewLine _
                                                & " SELECT                                                           " & vbNewLine _
                                                & "        RPT_ID                                                    " & vbNewLine _
                                                & "      , NRS_BR_CD                                                 " & vbNewLine _
                                                & "      , PRINT_SORT                                                " & vbNewLine _
                                                & "      , DEST_CD                                                   " & vbNewLine _
                                                & "      , DEST_NM                                                   " & vbNewLine _
                                                & "      , DEST_AD_1                                                 " & vbNewLine _
                                                & "      , DEST_AD_2                                                 " & vbNewLine _
                                                & "      , DEST_AD_3                                                 " & vbNewLine _
                                                & "      , DEST_TEL                                                  " & vbNewLine _
                                                & "      , OUTKA_PLAN_DATE                                           " & vbNewLine _
                                                & "      , CUST_ORD_NO                                               " & vbNewLine _
                                                & "      , BUYER_ORD_NO                                              " & vbNewLine _
                                                & "      , UNSOCO_NM                                                 " & vbNewLine _
                                                & "      , ARR_PLAN_DATE                                             " & vbNewLine _
                                                & "      , ARR_PLAN_TIME                                             " & vbNewLine _
                                                & "      , OUTKA_NO_L                                                " & vbNewLine _
                                                & "      , URIG_NM                                                   " & vbNewLine _
                                                & "      , CUST_NM_L                                                 " & vbNewLine _
                                                & "      , CUST_NM_M                                                 " & vbNewLine _
                                                & "      , DENPYO_NM                                                 " & vbNewLine _
                                                & "      , CASE WHEN DEST_SALES_CD <> ''                             " & vbNewLine _
                                                & "              AND DEST_SALES_CD IS NOT NULL THEN DEST_SALES_AD_1  " & vbNewLine _
                                                & "             ELSE CUST_AD_1 END CUST_AD_1                         " & vbNewLine _
                                                & "      , CASE WHEN DEST_SALES_CD <> ''                             " & vbNewLine _
                                                & "              AND DEST_SALES_CD IS NOT NULL THEN DEST_SALES_AD_2  " & vbNewLine _
                                                & "             ELSE CUST_AD_2 END CUST_AD_2                         " & vbNewLine _
                                                & "      , CASE WHEN DEST_SALES_CD <> ''                             " & vbNewLine _
                                                & "              AND DEST_SALES_CD IS NOT NULL THEN DEST_SALES_TEL   " & vbNewLine _
                                                & "        ELSE CUST_TEL                                             " & vbNewLine _
                                                & "        END                        AS CUST_TEL                    " & vbNewLine _
                                                & "      , NRS_BR_NM                                                 " & vbNewLine _
                                                & "      , NRS_BR_AD1                                                " & vbNewLine _
                                                & "      , NRS_BR_AD2                                                " & vbNewLine _
                                                & "      , NRS_BR_TEL                                                " & vbNewLine _
                                                & "      , NRS_BR_FAX                                                " & vbNewLine _
                                                & "      , PIC                                                       " & vbNewLine _
                                                & "--(2012.11.01)要望番号1560 -- START --                            " & vbNewLine _
                                                & "   -- , MIN(OUTKA_NO_M)            AS OUTKA_NO_M                  " & vbNewLine _
                                                & "      , OUTKA_NO_M                 AS OUTKA_NO_M                  " & vbNewLine _
                                                & "--(2012.11.01)要望番号1560 -- END --                              " & vbNewLine _
                                                & "      , MIN(OUTKA_NO_S)            AS OUTKA_NO_S                  " & vbNewLine _
                                                & "      , INKA_DATE                                                 " & vbNewLine _
                                                & "      , REMARK_OUT                                                " & vbNewLine _
                                                & "      , GOODS_NM_1                                                " & vbNewLine _
                                                & "      , LOT_NO                                                    " & vbNewLine _
                                                & "      , SERIAL_NO                                                 " & vbNewLine _
                                                & "      , IRIME                                                     " & vbNewLine _
                                                & "      , PKG_NB                                                    " & vbNewLine _
                                                & "      , SUM(ALCTD_NB) / PKG_NB     AS KONSU                       " & vbNewLine _
                                                & "      , SUM(ALCTD_NB) % PKG_NB     AS HASU                        " & vbNewLine _
                                                & "      , SUM(ALCTD_NB)              AS ALCTD_NB                    " & vbNewLine _
                                                & "      , PKG_UT                                                    " & vbNewLine _
                                                & "      , PKG_UT_NM                                                 " & vbNewLine _
                                                & "      , SUM(ALCTD_QT)              AS ALCTD_QT                    " & vbNewLine _
                                                & "      , IRIME_UT                                                  " & vbNewLine _
                                                & "      , WT                         AS WT                          " & vbNewLine _
                                                & "      , UNSO_WT                                                   " & vbNewLine _
                                                & "--(2012.11.21)要望番号1615 -- START --                            " & vbNewLine _
                                                & "      , SUM(ALCTD_NB) * PKG_WT     AS PKG_WT                      " & vbNewLine _
                                                & "--(2012.11.21)要望番号1615 --  END  --                            " & vbNewLine _
                                                & "      , TOU_NO                                                    " & vbNewLine _
                                                & "      , SITU_NO                                                   " & vbNewLine _
                                                & "      , ZONE_CD                                                   " & vbNewLine _
                                                & "      , LOCA                                                      " & vbNewLine _
                                                & "      , MIN(ZAN_KONSU)             AS ZAN_KONSU                   " & vbNewLine _
                                                & "      , MIN(ALCTD_CAN_NB) % PKG_NB AS ZAN_HASU                    " & vbNewLine _
                                                & "      , GOODS_CD_CUST                                             " & vbNewLine _
                                                & "      , REMARK_M                                                  " & vbNewLine _
                                                & "      , CUST_NM_S                                                 " & vbNewLine _
                                                & "      , CUST_NM_S_H                                               " & vbNewLine _
                                                & "      , CUST_ORD_NO_DTL                                           " & vbNewLine _
                                                & "      , OUTKA_REMARK                                              " & vbNewLine _
                                                & "      , HAISOU_REMARK                                             " & vbNewLine _
                                                & "      , NHS_REMARK                                                " & vbNewLine _
                                                & "      , KYORI                                                     " & vbNewLine _
                                                & "      , OUTKA_PKG_NB_L                                            " & vbNewLine _
                                                & "      , SOKO_NM                                                   " & vbNewLine _
                                                & "      , BUSHO_NM                                                  " & vbNewLine _
                                                & "      , NRS_BR_NM_NICHI                                           " & vbNewLine _
                                                & "      , MIN(ALCTD_CAN_QT)          AS ALCTD_CAN_QT                " & vbNewLine _
                                                & "      , ALCTD_KB                                                  " & vbNewLine _
                                                & "      , PTN_FLAG                                                  " & vbNewLine _
                                                & "      , CUST_CD_L                                                 " & vbNewLine _
                                                & "      , ORDER_TYPE                 AS ORDER_TYPE                  " & vbNewLine _
                                                & "      , CASE WHEN URIG_NM <> ''                                   " & vbNewLine _
                                                & "              AND URIG_NM IS NOT NULL THEN URIG_NM                " & vbNewLine _
                                                & "             WHEN DEST_SALES_NM   <> ''                           " & vbNewLine _
                                                & "              AND DEST_SALES_NM IS NOT NULL THEN DEST_SALES_NM    " & vbNewLine _
                                                & "             WHEN DENPYO_NM   <> ''                               " & vbNewLine _
                                                & "              AND DENPYO_NM IS NOT NULL   THEN DENPYO_NM          " & vbNewLine _
                                                & "        ELSE CUST_NM_L + CASE WHEN RPT_ID = 'LMC637' THEN ' ' + CUST_NM_S ELSE '' END                                           " & vbNewLine _
                                                & "        END                        AS ATSUKAISYA_NM               " & vbNewLine _
                                                & "      , MCD_SET_NAIYO                                             " & vbNewLine _
                                                & "      , MCD_SET_NAIYO_2                                           " & vbNewLine _
                                                & "      , MCD_SET_NAIYO_3                                           " & vbNewLine _
                                                & "      , PC_KB_NM                                                  " & vbNewLine _
                                                & "      , BUYER_ORD_NO_DTL                                          " & vbNewLine _
                                                & "      , TORI_KB                    --FREE_C01                     " & vbNewLine _
                                                & "      , SHIP_CD_L                                                 " & vbNewLine _
                                                & "      , SET_NAIYO_4                                               " & vbNewLine _
                                                & "      , SET_NAIYO_5                                               " & vbNewLine _
                                                & "      , SET_NAIYO_6                                               " & vbNewLine _
                                                & "      , GOODS_NM_2                                                " & vbNewLine _
                                                & "      , KICHO_KB                                                  " & vbNewLine _
                                                & "      , SEI_YURAI_KB                                              " & vbNewLine _
                                                & "      , REMARK_UPPER                                              " & vbNewLine _
                                                & "      , REMARK_LOWER                                              " & vbNewLine _
                                                & "      , GOODS_SYUBETU                                             " & vbNewLine _
                                                & "      , YUKOU_KIGEN                                               " & vbNewLine _
                                                & "      , GOODS_NM_3                                                " & vbNewLine _
                                                & "      , EDISHIP_CD                                                " & vbNewLine _
                                                & "      , EDIDEST_CD                                                " & vbNewLine _
                                                & "      , SET_NAIYO_FROM1                                           " & vbNewLine _
                                                & "      , SET_NAIYO_FROM2                                           " & vbNewLine _
                                                & "      , SET_NAIYO_FROM3                                           " & vbNewLine _
                                                & "      , CASE WHEN DEST_SALES_CD <> ''                             " & vbNewLine _
                                                & "              AND DEST_SALES_CD IS NOT NULL THEN DEST_SALES_AD_3  " & vbNewLine _
                                                & "        ELSE CUST_AD_3                                            " & vbNewLine _
                                                & "        END                        AS CUST_AD_3                   " & vbNewLine _
                                                & "      , DEST_REMARK                                               " & vbNewLine _
                                                & "      , DEST_SALES_CD                                             " & vbNewLine _
                                                & "      , DEST_SALES_NM                                             " & vbNewLine _
                                                & "      , DEST_SALES_AD_1                                           " & vbNewLine _
                                                & "      , DEST_SALES_AD_2                                           " & vbNewLine _
                                                & "      , DEST_SALES_AD_3                                           " & vbNewLine _
                                                & "      , DEST_SALES_TEL                                            " & vbNewLine _
                                                & "      , SAGYO_RYAK_1                                              " & vbNewLine _
                                                & "      , SAGYO_RYAK_2                                              " & vbNewLine _
                                                & "      , SAGYO_RYAK_3                                              " & vbNewLine _
                                                & "      , SAGYO_RYAK_4                                              " & vbNewLine _
                                                & "      , SAGYO_RYAK_5                                              " & vbNewLine _
                                                & "      , DEST_SAGYO_RYAK_1                                         " & vbNewLine _
                                                & "      , DEST_SAGYO_RYAK_2                                         " & vbNewLine _
                                                & "      , SZ01_YUSO                                                 " & vbNewLine _
                                                & "      , SZ01_UNSO                                                 " & vbNewLine _
                                                & "--(2012.10.19)要望番号1289 -- START --                            " & vbNewLine _
                                                & "      , GOODS_COND_CD_1                                           " & vbNewLine _
                                                & "      , GOODS_COND_CD                                             " & vbNewLine _
                                                & "      , GOODS_COND_CD_3                                           " & vbNewLine _
                                                & "      , REMARK_ZAI                                                " & vbNewLine _
                                                & "      , LT_DATE                                                   " & vbNewLine _
                                                & "      , CASE WHEN SET_NAIYO = '1'  THEN  '1'                      " & vbNewLine _
                                                & "        ELSE ''                                                   " & vbNewLine _
                                                & "        END  AS SET_NAIYO                                         " & vbNewLine _
                                                & "      , SYS_UPD_PGID                                              " & vbNewLine _
                                                & "--(2012.10.19)要望番号1289 --  END  --                            " & vbNewLine _
                                                & "      , SHOBO_KBN_NM                                              " & vbNewLine _
                                                & "      , HINMEI                                                    " & vbNewLine _
                                                & "--(2012.11.28) LMC637対応 -- START --                             " & vbNewLine _
                                                & "      , CUST_CD_M                                                 " & vbNewLine _
                                                & "      , CUST_CD_S                                                 " & vbNewLine _
                                                & "      , CUST_COST_CD2                                             " & vbNewLine _
                                                & "--(2012.11.28) LMC637対応 --  END  --                             " & vbNewLine _
                                                & "--(2016.7.13) LMC629:製造日表示 -- START --                       " & vbNewLine _
                                                & "      , GOODS_CRT_DATE                                            " & vbNewLine _
                                                & "--(2016.7.13) LMC629:製造日表示 --  END  --                       " & vbNewLine _
                                                & "   FROM                                                           " & vbNewLine _
                                                & "        (                                                         " & vbNewLine


    Friend Const SQL_SELECT_MAIN_753 As String = " --SQL_SELECT_MAIN_753                                            " & vbNewLine _
                                                & " SELECT                                                           " & vbNewLine _
                                                & "        RPT_ID                                                    " & vbNewLine _
                                                & "      , NRS_BR_CD                                                 " & vbNewLine _
                                                & "      , PRINT_SORT                                                " & vbNewLine _
                                                & "      , DEST_CD                                                   " & vbNewLine _
                                                & "      , DEST_NM                                                   " & vbNewLine _
                                                & "      , DEST_AD_1                                                 " & vbNewLine _
                                                & "      , DEST_AD_2                                                 " & vbNewLine _
                                                & "      , DEST_AD_3                                                 " & vbNewLine _
                                                & "      , DEST_TEL                                                  " & vbNewLine _
                                                & "      , OUTKA_PLAN_DATE                                           " & vbNewLine _
                                                & "      , CUST_ORD_NO                                               " & vbNewLine _
                                                & "      , BUYER_ORD_NO                                              " & vbNewLine _
                                                & "      , UNSOCO_NM                                                 " & vbNewLine _
                                                & "      , ARR_PLAN_DATE                                             " & vbNewLine _
                                                & "      , ARR_PLAN_TIME                                             " & vbNewLine _
                                                & "      , OUTKA_NO_L                                                " & vbNewLine _
                                                & "      , URIG_NM                                                   " & vbNewLine _
                                                & "      , CUST_NM_L                                                 " & vbNewLine _
                                                & "      , CUST_NM_M                                                 " & vbNewLine _
                                                & "      , DENPYO_NM                                                 " & vbNewLine _
                                                & "      , CASE WHEN DEST_SALES_CD <> ''                             " & vbNewLine _
                                                & "              AND DEST_SALES_CD IS NOT NULL THEN DEST_SALES_AD_1  " & vbNewLine _
                                                & "             ELSE CUST_AD_1 END CUST_AD_1                         " & vbNewLine _
                                                & "      , CASE WHEN DEST_SALES_CD <> ''                             " & vbNewLine _
                                                & "              AND DEST_SALES_CD IS NOT NULL THEN DEST_SALES_AD_2  " & vbNewLine _
                                                & "             ELSE CUST_AD_2 END CUST_AD_2                         " & vbNewLine _
                                                & "      , CASE WHEN DEST_SALES_CD <> ''                             " & vbNewLine _
                                                & "              AND DEST_SALES_CD IS NOT NULL THEN DEST_SALES_TEL   " & vbNewLine _
                                                & "        ELSE CUST_TEL                                             " & vbNewLine _
                                                & "        END                        AS CUST_TEL                    " & vbNewLine _
                                                & "      , NRS_BR_NM                                                 " & vbNewLine _
                                                & "      , NRS_BR_AD1                                                " & vbNewLine _
                                                & "      , NRS_BR_AD2                                                " & vbNewLine _
                                                & "      , NRS_BR_TEL                                                " & vbNewLine _
                                                & "      , NRS_BR_FAX                                                " & vbNewLine _
                                                & "      , PIC                                                       " & vbNewLine _
                                                & "--(2012.11.01)要望番号1560 -- START --                            " & vbNewLine _
                                                & "   -- , MIN(OUTKA_NO_M)            AS OUTKA_NO_M                  " & vbNewLine _
                                                & "      , OUTKA_NO_M                 AS OUTKA_NO_M                  " & vbNewLine _
                                                & "--(2012.11.01)要望番号1560 -- END --                              " & vbNewLine _
                                                & "      , MIN(OUTKA_NO_S)            AS OUTKA_NO_S                  " & vbNewLine _
                                                & "      , INKA_DATE                                                 " & vbNewLine _
                                                & "      , REMARK_OUT                                                " & vbNewLine _
                                                & "      , GOODS_NM_1                                                " & vbNewLine _
                                                & "      , LOT_NO                                                    " & vbNewLine _
                                                & "      , SERIAL_NO                                                 " & vbNewLine _
                                                & "      , IRIME                                                     " & vbNewLine _
                                                & "      , PKG_NB                                                    " & vbNewLine _
                                                & "      , SUM(ALCTD_NB) / PKG_NB     AS KONSU                       " & vbNewLine _
                                                & "      , SUM(ALCTD_NB) % PKG_NB     AS HASU                        " & vbNewLine _
                                                & "      , SUM(ALCTD_NB)              AS ALCTD_NB                    " & vbNewLine _
                                                & "      , PKG_UT                                                    " & vbNewLine _
                                                & "      , PKG_UT_NM                                                 " & vbNewLine _
                                                & "      , SUM(ALCTD_QT)              AS ALCTD_QT                    " & vbNewLine _
                                                & "      , IRIME_UT                                                  " & vbNewLine _
                                                & "      , WT                         AS WT                          " & vbNewLine _
                                                & "      , UNSO_WT                                                   " & vbNewLine _
                                                & "--(2012.11.21)要望番号1615 -- START --                            " & vbNewLine _
                                                & "      , SUM(ALCTD_NB) * PKG_WT     AS PKG_WT                      " & vbNewLine _
                                                & "--(2012.11.21)要望番号1615 --  END  --                            " & vbNewLine _
                                                & "      , TOU_NO                                                    " & vbNewLine _
                                                & "      , SITU_NO                                                   " & vbNewLine _
                                                & "      , ZONE_CD                                                   " & vbNewLine _
                                                & "      , LOCA                                                      " & vbNewLine _
                                                & "      , MIN(ZAN_KONSU)             AS ZAN_KONSU                   " & vbNewLine _
                                                & "      , MIN(ALCTD_CAN_NB) % PKG_NB AS ZAN_HASU                    " & vbNewLine _
                                                & "      , GOODS_CD_CUST                                             " & vbNewLine _
                                                & "      , REMARK_M                                                  " & vbNewLine _
                                                & "      , CUST_NM_S                                                 " & vbNewLine _
                                                & "      , CUST_NM_S_H                                               " & vbNewLine _
                                                & "      , CUST_ORD_NO_DTL                                           " & vbNewLine _
                                                & "      , OUTKA_REMARK                                              " & vbNewLine _
                                                & "      , HAISOU_REMARK                                             " & vbNewLine _
                                                & "      , NHS_REMARK                                                " & vbNewLine _
                                                & "      , KYORI                                                     " & vbNewLine _
                                                & "      , OUTKA_PKG_NB_L                                            " & vbNewLine _
                                                & "      , SOKO_NM                                                   " & vbNewLine _
                                                & "      , BUSHO_NM                                                  " & vbNewLine _
                                                & "      , NRS_BR_NM_NICHI                                           " & vbNewLine _
                                                & "      , MIN(ALCTD_CAN_QT)          AS ALCTD_CAN_QT                " & vbNewLine _
                                                & "      , ALCTD_KB                                                  " & vbNewLine _
                                                & "      , PTN_FLAG                                                  " & vbNewLine _
                                                & "      , CUST_CD_L                                                 " & vbNewLine _
                                                & "      , ORDER_TYPE                 AS ORDER_TYPE                  " & vbNewLine _
                                                & "      , CASE WHEN URIG_NM <> ''                                   " & vbNewLine _
                                                & "              AND URIG_NM IS NOT NULL THEN URIG_NM                " & vbNewLine _
                                                & "             WHEN DEST_SALES_NM   <> ''                           " & vbNewLine _
                                                & "              AND DEST_SALES_NM IS NOT NULL THEN DEST_SALES_NM    " & vbNewLine _
                                                & "             WHEN DENPYO_NM   <> ''                               " & vbNewLine _
                                                & "              AND DENPYO_NM IS NOT NULL   THEN DENPYO_NM          " & vbNewLine _
                                                & "        ELSE CUST_NM_L + CASE WHEN RPT_ID = 'LMC637' THEN ' ' + CUST_NM_S ELSE '' END                                           " & vbNewLine _
                                                & "        END                        AS ATSUKAISYA_NM               " & vbNewLine _
                                                & "      , MCD_SET_NAIYO                                             " & vbNewLine _
                                                & "      , MCD_SET_NAIYO_2                                           " & vbNewLine _
                                                & "      , MCD_SET_NAIYO_3                                           " & vbNewLine _
                                                & "      , PC_KB_NM                                                  " & vbNewLine _
                                                & "      , BUYER_ORD_NO_DTL                                          " & vbNewLine _
                                                & "      , TORI_KB                    --FREE_C01                     " & vbNewLine _
                                                & "      , SHIP_CD_L                                                 " & vbNewLine _
                                                & "      , SET_NAIYO_4                                               " & vbNewLine _
                                                & "      , SET_NAIYO_5                                               " & vbNewLine _
                                                & "      , SET_NAIYO_6                                               " & vbNewLine _
                                                & "      , GOODS_NM_2                                                " & vbNewLine _
                                                & "      , KICHO_KB                                                  " & vbNewLine _
                                                & "      , SEI_YURAI_KB                                              " & vbNewLine _
                                                & "      , REMARK_UPPER                                              " & vbNewLine _
                                                & "      , REMARK_LOWER                                              " & vbNewLine _
                                                & "      , GOODS_SYUBETU                                             " & vbNewLine _
                                                & "      , YUKOU_KIGEN                                               " & vbNewLine _
                                                & "      , GOODS_NM_3                                                " & vbNewLine _
                                                & "      , EDISHIP_CD                                                " & vbNewLine _
                                                & "      , EDIDEST_CD                                                " & vbNewLine _
                                                & "      , SET_NAIYO_FROM1                                           " & vbNewLine _
                                                & "      , SET_NAIYO_FROM2                                           " & vbNewLine _
                                                & "      , SET_NAIYO_FROM3                                           " & vbNewLine _
                                                & "      , CASE WHEN DEST_SALES_CD <> ''                             " & vbNewLine _
                                                & "              AND DEST_SALES_CD IS NOT NULL THEN DEST_SALES_AD_3  " & vbNewLine _
                                                & "        ELSE CUST_AD_3                                            " & vbNewLine _
                                                & "        END                        AS CUST_AD_3                   " & vbNewLine _
                                                & "      , DEST_REMARK                                               " & vbNewLine _
                                                & "      , DEST_SALES_CD                                             " & vbNewLine _
                                                & "      , DEST_SALES_NM                                             " & vbNewLine _
                                                & "      , DEST_SALES_AD_1                                           " & vbNewLine _
                                                & "      , DEST_SALES_AD_2                                           " & vbNewLine _
                                                & "      , DEST_SALES_AD_3                                           " & vbNewLine _
                                                & "      , DEST_SALES_TEL                                            " & vbNewLine _
                                                & "      , SAGYO_RYAK_1                                              " & vbNewLine _
                                                & "      , SAGYO_RYAK_2                                              " & vbNewLine _
                                                & "      , SAGYO_RYAK_3                                              " & vbNewLine _
                                                & "      , SAGYO_RYAK_4                                              " & vbNewLine _
                                                & "      , SAGYO_RYAK_5                                              " & vbNewLine _
                                                & "      , DEST_SAGYO_RYAK_1                                         " & vbNewLine _
                                                & "      , DEST_SAGYO_RYAK_2                                         " & vbNewLine _
                                                & "      , SZ01_YUSO                                                 " & vbNewLine _
                                                & "      , SZ01_UNSO                                                 " & vbNewLine _
                                                & "--(2012.10.19)要望番号1289 -- START --                            " & vbNewLine _
                                                & "      , GOODS_COND_CD_1                                           " & vbNewLine _
                                                & "      , GOODS_COND_CD                                             " & vbNewLine _
                                                & "      , GOODS_COND_CD_3                                           " & vbNewLine _
                                                & "--(2014.05.29)要望番号2193 -- START --                            " & vbNewLine _
                                                & "      , GOODS_COND_NM                                             " & vbNewLine _
                                                & "--(2012.05.29)要望番号2193 --  END  --                            " & vbNewLine _
                                                & "      , REMARK_ZAI                                                " & vbNewLine _
                                                & "      , LT_DATE                                                   " & vbNewLine _
                                                & "      , CASE WHEN SET_NAIYO = '1'  THEN  '1'                      " & vbNewLine _
                                                & "        ELSE ''                                                   " & vbNewLine _
                                                & "        END  AS SET_NAIYO                                         " & vbNewLine _
                                                & "      , SYS_UPD_PGID                                              " & vbNewLine _
                                                & "--(2012.10.19)要望番号1289 --  END  --                            " & vbNewLine _
                                                & "      , SHOBO_KBN_NM                                              " & vbNewLine _
                                                & "      , HINMEI                                                    " & vbNewLine _
                                                & "--(2012.11.28) LMC637対応 -- START --                             " & vbNewLine _
                                                & "      , CUST_CD_M                                                 " & vbNewLine _
                                                & "      , CUST_CD_S                                                 " & vbNewLine _
                                                & "      , CUST_COST_CD2                                             " & vbNewLine _
                                                & "--(2012.11.28) LMC637対応 --  END  --                             " & vbNewLine _
                                                & "   FROM                                                           " & vbNewLine _
                                                & "        (                                                         " & vbNewLine

    '(2012.10.30) 納品書(千葉・富士フィルム用) -- START --
    ''' <summary>
    ''' 印刷データ抽出用
    ''' </summary>
    ''' <remarks>出荷管理番号(中)をMINで抽出、商品明細マスタのSET_NAIYOを取得</remarks>
    Friend Const SQL_SELECT_MAIN_631 As String = " --SQL_SELECT_MAIN_631                                            " & vbNewLine _
                                                & " SELECT                                                           " & vbNewLine _
                                                & "        RPT_ID                                                    " & vbNewLine _
                                                & "      , NRS_BR_CD                                                 " & vbNewLine _
                                                & "      , PRINT_SORT                                                " & vbNewLine _
                                                & "      , DEST_CD                                                   " & vbNewLine _
                                                & "      , DEST_NM                                                   " & vbNewLine _
                                                & "      , DEST_AD_1                                                 " & vbNewLine _
                                                & "      , DEST_AD_2                                                 " & vbNewLine _
                                                & "      , DEST_AD_3                                                 " & vbNewLine _
                                                & "      , DEST_TEL                                                  " & vbNewLine _
                                                & "      , OUTKA_PLAN_DATE                                           " & vbNewLine _
                                                & "      , CUST_ORD_NO                                               " & vbNewLine _
                                                & "      , BUYER_ORD_NO                                              " & vbNewLine _
                                                & "      , UNSOCO_NM                                                 " & vbNewLine _
                                                & "      , ARR_PLAN_DATE                                             " & vbNewLine _
                                                & "      , ARR_PLAN_TIME                                             " & vbNewLine _
                                                & "      , OUTKA_NO_L                                                " & vbNewLine _
                                                & "      , URIG_NM                                                   " & vbNewLine _
                                                & "      , CUST_NM_L                                                 " & vbNewLine _
                                                & "      , CUST_NM_M                                                 " & vbNewLine _
                                                & "      , DENPYO_NM                                                 " & vbNewLine _
                                                & "      , CASE WHEN DEST_SALES_CD <> ''                             " & vbNewLine _
                                                & "              AND DEST_SALES_CD IS NOT NULL THEN DEST_SALES_AD_1  " & vbNewLine _
                                                & "             ELSE CUST_AD_1 END CUST_AD_1                         " & vbNewLine _
                                                & "      , CASE WHEN DEST_SALES_CD <> ''                             " & vbNewLine _
                                                & "              AND DEST_SALES_CD IS NOT NULL THEN DEST_SALES_AD_2  " & vbNewLine _
                                                & "             ELSE CUST_AD_2 END CUST_AD_2                         " & vbNewLine _
                                                & "      , CASE WHEN DEST_SALES_CD <> ''                             " & vbNewLine _
                                                & "              AND DEST_SALES_CD IS NOT NULL THEN DEST_SALES_TEL   " & vbNewLine _
                                                & "        ELSE CUST_TEL                                             " & vbNewLine _
                                                & "        END                        AS CUST_TEL                    " & vbNewLine _
                                                & "      , NRS_BR_NM                                                 " & vbNewLine _
                                                & "      , NRS_BR_AD1                                                " & vbNewLine _
                                                & "      , NRS_BR_AD2                                                " & vbNewLine _
                                                & "      , NRS_BR_TEL                                                " & vbNewLine _
                                                & "      , NRS_BR_FAX                                                " & vbNewLine _
                                                & "      , PIC                                                       " & vbNewLine _
                                                & "--(2012.11.01)要望番号1560 -- START --                            " & vbNewLine _
                                                & "  --  , MIN(OUTKA_NO_M)            AS OUTKA_NO_M                  " & vbNewLine _
                                                & "      , OUTKA_NO_M                 AS OUTKA_NO_M                  " & vbNewLine _
                                                & "--(2012.11.01)要望番号1560 -- END --                              " & vbNewLine _
                                                & "      , MIN(OUTKA_NO_S)            AS OUTKA_NO_S                  " & vbNewLine _
                                                & "      , INKA_DATE                                                 " & vbNewLine _
                                                & "      , REMARK_OUT                                                " & vbNewLine _
                                                & "      , GOODS_NM_1                                                " & vbNewLine _
                                                & "      , LOT_NO                                                    " & vbNewLine _
                                                & "      , SERIAL_NO                                                 " & vbNewLine _
                                                & "      , IRIME                                                     " & vbNewLine _
                                                & "      , PKG_NB                                                    " & vbNewLine _
                                                & "      , SUM(ALCTD_NB) / PKG_NB     AS KONSU                       " & vbNewLine _
                                                & "      , SUM(ALCTD_NB) % PKG_NB     AS HASU                        " & vbNewLine _
                                                & "      , SUM(ALCTD_NB)              AS ALCTD_NB                    " & vbNewLine _
                                                & "      , PKG_UT                                                    " & vbNewLine _
                                                & "      , PKG_UT_NM                                                 " & vbNewLine _
                                                & "      , SUM(ALCTD_QT)              AS ALCTD_QT                    " & vbNewLine _
                                                & "      , IRIME_UT                                                  " & vbNewLine _
                                                & "      , WT                         AS WT                          " & vbNewLine _
                                                & "      , UNSO_WT                                                   " & vbNewLine _
                                                & "      , TOU_NO                                                    " & vbNewLine _
                                                & "      , SITU_NO                                                   " & vbNewLine _
                                                & "      , ZONE_CD                                                   " & vbNewLine _
                                                & "      , LOCA                                                      " & vbNewLine _
                                                & "      , MIN(ZAN_KONSU)             AS ZAN_KONSU                   " & vbNewLine _
                                                & "      , MIN(ALCTD_CAN_NB) % PKG_NB AS ZAN_HASU                    " & vbNewLine _
                                                & "      , GOODS_CD_CUST                                             " & vbNewLine _
                                                & "      , REMARK_M                                                  " & vbNewLine _
                                                & "      , CUST_NM_S                                                 " & vbNewLine _
                                                & "      , CUST_NM_S_H                                               " & vbNewLine _
                                                & "--(2012.10.30) 富士フィルム対応  --- START ---                                " & vbNewLine _
                                                & "    --, CUST_ORD_NO_DTL                                                       " & vbNewLine _
                                                & "      , CASE WHEN FJF_SET_NAIYO <> '' AND NRS_BR_CD = @NRS_BR_CD THEN FJF_SET_NAIYO --UPD 2020/06/16 '10'固定対応　013118" & vbNewLine _
                                                & "             ELSE CUST_ORD_NO_DTL                                             " & vbNewLine _
                                                & "        END                       AS CUST_ORD_NO_DTL                          " & vbNewLine _
                                                & "--(2012.10.30) 富士フィルム対応  ---  END  ---                                " & vbNewLine _
                                                & "      , OUTKA_REMARK                                              " & vbNewLine _
                                                & "      , HAISOU_REMARK                                             " & vbNewLine _
                                                & "      , NHS_REMARK                                                " & vbNewLine _
                                                & "      , KYORI                                                     " & vbNewLine _
                                                & "      , OUTKA_PKG_NB_L                                            " & vbNewLine _
                                                & "      , SOKO_NM                                                   " & vbNewLine _
                                                & "      , BUSHO_NM                                                  " & vbNewLine _
                                                & "      , NRS_BR_NM_NICHI                                           " & vbNewLine _
                                                & "      , MIN(ALCTD_CAN_QT)          AS ALCTD_CAN_QT                " & vbNewLine _
                                                & "      , ALCTD_KB                                                  " & vbNewLine _
                                                & "      , PTN_FLAG                                                  " & vbNewLine _
                                                & "      , CUST_CD_L                                                 " & vbNewLine _
                                                & "      , ORDER_TYPE                 AS ORDER_TYPE                  " & vbNewLine _
                                                & "      , CASE WHEN URIG_NM <> ''                                   " & vbNewLine _
                                                & "              AND URIG_NM IS NOT NULL THEN URIG_NM                " & vbNewLine _
                                                & "             WHEN DEST_SALES_NM   <> ''                           " & vbNewLine _
                                                & "              AND DEST_SALES_NM IS NOT NULL THEN DEST_SALES_NM    " & vbNewLine _
                                                & "             WHEN DENPYO_NM   <> ''                               " & vbNewLine _
                                                & "              AND DENPYO_NM IS NOT NULL   THEN DENPYO_NM          " & vbNewLine _
                                                & "        ELSE CUST_NM_L                                            " & vbNewLine _
                                                & "        END                        AS ATSUKAISYA_NM               " & vbNewLine _
                                                & "      , MCD_SET_NAIYO                                             " & vbNewLine _
                                                & "      , MCD_SET_NAIYO_2                                           " & vbNewLine _
                                                & "      , MCD_SET_NAIYO_3                                           " & vbNewLine _
                                                & "      , PC_KB_NM                                                  " & vbNewLine _
                                                & "      , BUYER_ORD_NO_DTL                                          " & vbNewLine _
                                                & "      , TORI_KB                    --FREE_C01                     " & vbNewLine _
                                                & "      , SHIP_CD_L                                                 " & vbNewLine _
                                                & "      , SET_NAIYO_4                                               " & vbNewLine _
                                                & "      , SET_NAIYO_5                                               " & vbNewLine _
                                                & "      , SET_NAIYO_6                                               " & vbNewLine _
                                                & "      , GOODS_NM_2                                                " & vbNewLine _
                                                & "      , KICHO_KB                                                  " & vbNewLine _
                                                & "      , SEI_YURAI_KB                                              " & vbNewLine _
                                                & "      , REMARK_UPPER                                              " & vbNewLine _
                                                & "      , REMARK_LOWER                                              " & vbNewLine _
                                                & "      , GOODS_SYUBETU                                             " & vbNewLine _
                                                & "      , YUKOU_KIGEN                                               " & vbNewLine _
                                                & "      , GOODS_NM_3                                                " & vbNewLine _
                                                & "      , EDISHIP_CD                                                " & vbNewLine _
                                                & "      , EDIDEST_CD                                                " & vbNewLine _
                                                & "      , SET_NAIYO_FROM1                                           " & vbNewLine _
                                                & "      , SET_NAIYO_FROM2                                           " & vbNewLine _
                                                & "      , SET_NAIYO_FROM3                                           " & vbNewLine _
                                                & "      , CASE WHEN DEST_SALES_CD <> ''                             " & vbNewLine _
                                                & "              AND DEST_SALES_CD IS NOT NULL THEN DEST_SALES_AD_3  " & vbNewLine _
                                                & "        ELSE CUST_AD_3                                            " & vbNewLine _
                                                & "        END                        AS CUST_AD_3                   " & vbNewLine _
                                                & "      , DEST_REMARK                                               " & vbNewLine _
                                                & "      , DEST_SALES_CD                                             " & vbNewLine _
                                                & "      , DEST_SALES_NM                                             " & vbNewLine _
                                                & "      , DEST_SALES_AD_1                                           " & vbNewLine _
                                                & "      , DEST_SALES_AD_2                                           " & vbNewLine _
                                                & "      , DEST_SALES_AD_3                                           " & vbNewLine _
                                                & "      , DEST_SALES_TEL                                            " & vbNewLine _
                                                & "      , SAGYO_RYAK_1                                              " & vbNewLine _
                                                & "      , SAGYO_RYAK_2                                              " & vbNewLine _
                                                & "      , SAGYO_RYAK_3                                              " & vbNewLine _
                                                & "      , SAGYO_RYAK_4                                              " & vbNewLine _
                                                & "      , SAGYO_RYAK_5                                              " & vbNewLine _
                                                & "      , DEST_SAGYO_RYAK_1                                         " & vbNewLine _
                                                & "      , DEST_SAGYO_RYAK_2                                         " & vbNewLine _
                                                & "      , SZ01_YUSO                                                 " & vbNewLine _
                                                & "      , SZ01_UNSO                                                 " & vbNewLine _
                                                & "--(2012.10.19)要望番号1289 -- START --                            " & vbNewLine _
                                                & "      , GOODS_COND_CD_1                                           " & vbNewLine _
                                                & "      , GOODS_COND_CD                                             " & vbNewLine _
                                                & "      , GOODS_COND_CD_3                                           " & vbNewLine _
                                                & "      , REMARK_ZAI                                                " & vbNewLine _
                                                & "      , LT_DATE                                                   " & vbNewLine _
                                                & "      , CASE WHEN SET_NAIYO = '1'  THEN  '1'                      " & vbNewLine _
                                                & "        ELSE ''                                                   " & vbNewLine _
                                                & "        END  AS SET_NAIYO                                         " & vbNewLine _
                                                & "      , SYS_UPD_PGID                                              " & vbNewLine _
                                                & "--(2012.10.19)要望番号1289 --  END  --                            " & vbNewLine _
                                                & "      , SHOBO_KBN_NM                                              " & vbNewLine _
                                                & "      , HINMEI                                                    " & vbNewLine _
                                                & "   FROM                                                           " & vbNewLine _
                                                & "        (                                                         " & vbNewLine

    '(2012.10.30) 納品書(千葉・富士フィルム用) --  END  --

    ''' <summary>
    ''' 印刷データ抽出用
    ''' </summary>
    ''' <remarks>出荷管理番号(中)をMINで抽出</remarks>
    Friend Const SQL_SELECT_MAIN_731 As String = " --SQL_SELECT_MAIN_731                                            " & vbNewLine _
                                                & " SELECT                                                           " & vbNewLine _
                                                & "        RPT_ID                                                    " & vbNewLine _
                                                & "      , NRS_BR_CD                                                 " & vbNewLine _
                                                & "      , PRINT_SORT                                                " & vbNewLine _
                                                & "      , DEST_CD                                                   " & vbNewLine _
                                                & "      , DEST_NM                                                   " & vbNewLine _
                                                & "      , DEST_AD_1                                                 " & vbNewLine _
                                                & "      , DEST_AD_2                                                 " & vbNewLine _
                                                & "      , DEST_AD_3                                                 " & vbNewLine _
                                                & "      , DEST_TEL                                                  " & vbNewLine _
                                                & "      , OUTKA_PLAN_DATE                                           " & vbNewLine _
                                                & "      , CUST_ORD_NO                                               " & vbNewLine _
                                                & "      , BUYER_ORD_NO                                              " & vbNewLine _
                                                & "      , UNSOCO_NM                                                 " & vbNewLine _
                                                & "      , ARR_PLAN_DATE                                             " & vbNewLine _
                                                & "      , ARR_PLAN_TIME                                             " & vbNewLine _
                                                & "      , OUTKA_NO_L                                                " & vbNewLine _
                                                & "      , URIG_NM                                                   " & vbNewLine _
                                                & "      , CUST_NM_L                                                 " & vbNewLine _
                                                & "      , CUST_NM_M                                                 " & vbNewLine _
                                                & "      , DENPYO_NM                                                 " & vbNewLine _
                                                & "      , CASE WHEN DEST_SALES_CD <> ''                             " & vbNewLine _
                                                & "              AND DEST_SALES_CD IS NOT NULL THEN DEST_SALES_AD_1  " & vbNewLine _
                                                & "             ELSE CUST_AD_1 END CUST_AD_1                         " & vbNewLine _
                                                & "      , CASE WHEN DEST_SALES_CD <> ''                             " & vbNewLine _
                                                & "              AND DEST_SALES_CD IS NOT NULL THEN DEST_SALES_AD_2  " & vbNewLine _
                                                & "             ELSE CUST_AD_2 END CUST_AD_2                         " & vbNewLine _
                                                & "      , CASE WHEN DEST_SALES_CD <> ''                             " & vbNewLine _
                                                & "              AND DEST_SALES_CD IS NOT NULL THEN DEST_SALES_TEL   " & vbNewLine _
                                                & "        ELSE CUST_TEL                                             " & vbNewLine _
                                                & "        END                        AS CUST_TEL                    " & vbNewLine _
                                                & "      , NRS_BR_NM                                                 " & vbNewLine _
                                                & "      , NRS_BR_AD1                                                " & vbNewLine _
                                                & "      , NRS_BR_AD2                                                " & vbNewLine _
                                                & "      , NRS_BR_TEL                                                " & vbNewLine _
                                                & "      , NRS_BR_FAX                                                " & vbNewLine _
                                                & "      , PIC                                                       " & vbNewLine _
                                                & "--(2012.11.01)要望番号1560 -- START --                            " & vbNewLine _
                                                & "   -- , MIN(OUTKA_NO_M)            AS OUTKA_NO_M                  " & vbNewLine _
                                                & "      , OUTKA_NO_M                 AS OUTKA_NO_M                  " & vbNewLine _
                                                & "--(2012.11.01)要望番号1560 -- END --                              " & vbNewLine _
                                                & "      , MIN(OUTKA_NO_S)            AS OUTKA_NO_S                  " & vbNewLine _
                                                & "      , INKA_DATE                                                 " & vbNewLine _
                                                & "      , REMARK_OUT                                                " & vbNewLine _
                                                & "      , GOODS_NM_1                                                " & vbNewLine _
                                                & "      , LOT_NO                                                    " & vbNewLine _
                                                & "      , SERIAL_NO                                                 " & vbNewLine _
                                                & "      , IRIME                                                     " & vbNewLine _
                                                & "      , PKG_NB                                                    " & vbNewLine _
                                                & "      , SUM(ALCTD_NB) / PKG_NB     AS KONSU                       " & vbNewLine _
                                                & "      , SUM(ALCTD_NB) % PKG_NB     AS HASU                        " & vbNewLine _
                                                & "      , SUM(ALCTD_NB)              AS ALCTD_NB                    " & vbNewLine _
                                                & "      , PKG_UT                                                    " & vbNewLine _
                                                & "      , PKG_UT_NM                                                 " & vbNewLine _
                                                & "      , SUM(ALCTD_QT)              AS ALCTD_QT                    " & vbNewLine _
                                                & "      , IRIME_UT                                                  " & vbNewLine _
                                                & "      , WT                         AS WT                          " & vbNewLine _
                                                & "      , UNSO_WT                                                   " & vbNewLine _
                                                & "--(2012.11.21)要望番号1615 -- START --                            " & vbNewLine _
                                                & "      , SUM(ALCTD_NB) * PKG_WT     AS PKG_WT                      " & vbNewLine _
                                                & "--(2012.11.21)要望番号1615 --  END  --                            " & vbNewLine _
                                                & "      , TOU_NO                                                    " & vbNewLine _
                                                & "      , SITU_NO                                                   " & vbNewLine _
                                                & "      , ZONE_CD                                                   " & vbNewLine _
                                                & "      , LOCA                                                      " & vbNewLine _
                                                & "      , MIN(ZAN_KONSU)             AS ZAN_KONSU                   " & vbNewLine _
                                                & "      , MIN(ALCTD_CAN_NB) % PKG_NB AS ZAN_HASU                    " & vbNewLine _
                                                & "      , GOODS_CD_CUST                                             " & vbNewLine _
                                                & "      , REMARK_M                                                  " & vbNewLine _
                                                & "      , CUST_NM_S                                                 " & vbNewLine _
                                                & "      , CUST_NM_S_H                                               " & vbNewLine _
                                                & "      , CUST_ORD_NO_DTL                                           " & vbNewLine _
                                                & "      , OUTKA_REMARK                                              " & vbNewLine _
                                                & "      , HAISOU_REMARK                                             " & vbNewLine _
                                                & "      , NHS_REMARK                                                " & vbNewLine _
                                                & "      , KYORI                                                     " & vbNewLine _
                                                & "      , OUTKA_PKG_NB_L                                            " & vbNewLine _
                                                & "      , SOKO_NM                                                   " & vbNewLine _
                                                & "      , BUSHO_NM                                                  " & vbNewLine _
                                                & "      , NRS_BR_NM_NICHI                                           " & vbNewLine _
                                                & "      , MIN(ALCTD_CAN_QT)          AS ALCTD_CAN_QT                " & vbNewLine _
                                                & "      , ALCTD_KB                                                  " & vbNewLine _
                                                & "      , PTN_FLAG                                                  " & vbNewLine _
                                                & "      , CUST_CD_L                                                 " & vbNewLine _
                                                & "      , ORDER_TYPE                 AS ORDER_TYPE                  " & vbNewLine _
                                                & "      , CASE WHEN URIG_NM <> ''                                   " & vbNewLine _
                                                & "              AND URIG_NM IS NOT NULL THEN URIG_NM                " & vbNewLine _
                                                & "             WHEN DEST_SALES_NM   <> ''                           " & vbNewLine _
                                                & "              AND DEST_SALES_NM IS NOT NULL THEN DEST_SALES_NM    " & vbNewLine _
                                                & "             WHEN DENPYO_NM   <> ''                               " & vbNewLine _
                                                & "              AND DENPYO_NM IS NOT NULL   THEN DENPYO_NM          " & vbNewLine _
                                                & "        ELSE CUST_NM_L + CASE WHEN RPT_ID = 'LMC637' THEN ' ' + CUST_NM_S ELSE '' END                                           " & vbNewLine _
                                                & "        END                        AS ATSUKAISYA_NM               " & vbNewLine _
                                                & "      , MCD_SET_NAIYO                                             " & vbNewLine _
                                                & "      , MCD_SET_NAIYO_2                                           " & vbNewLine _
                                                & "      , MCD_SET_NAIYO_3                                           " & vbNewLine _
                                                & "      , PC_KB_NM                                                  " & vbNewLine _
                                                & "      , BUYER_ORD_NO_DTL                                          " & vbNewLine _
                                                & "      , TORI_KB                    --FREE_C01                     " & vbNewLine _
                                                & "      , SHIP_CD_L                                                 " & vbNewLine _
                                                & "      , SET_NAIYO_4                                               " & vbNewLine _
                                                & "      , SET_NAIYO_5                                               " & vbNewLine _
                                                & "      , SET_NAIYO_6                                               " & vbNewLine _
                                                & "      , GOODS_NM_2                                                " & vbNewLine _
                                                & "      , KICHO_KB                                                  " & vbNewLine _
                                                & "      , SEI_YURAI_KB                                              " & vbNewLine _
                                                & "      , REMARK_UPPER                                              " & vbNewLine _
                                                & "      , REMARK_LOWER                                              " & vbNewLine _
                                                & "      , GOODS_SYUBETU                                             " & vbNewLine _
                                                & "      , YUKOU_KIGEN                                               " & vbNewLine _
                                                & "      , GOODS_NM_3                                                " & vbNewLine _
                                                & "      , EDISHIP_CD                                                " & vbNewLine _
                                                & "      , EDIDEST_CD                                                " & vbNewLine _
                                                & "      , SET_NAIYO_FROM1                                           " & vbNewLine _
                                                & "      , SET_NAIYO_FROM2                                           " & vbNewLine _
                                                & "      , SET_NAIYO_FROM3                                           " & vbNewLine _
                                                & "      , CASE WHEN DEST_SALES_CD <> ''                             " & vbNewLine _
                                                & "              AND DEST_SALES_CD IS NOT NULL THEN DEST_SALES_AD_3  " & vbNewLine _
                                                & "        ELSE CUST_AD_3                                            " & vbNewLine _
                                                & "        END                        AS CUST_AD_3                   " & vbNewLine _
                                                & "      , DEST_REMARK                                               " & vbNewLine _
                                                & "      , DEST_SALES_CD                                             " & vbNewLine _
                                                & "      , DEST_SALES_NM                                             " & vbNewLine _
                                                & "      , DEST_SALES_AD_1                                           " & vbNewLine _
                                                & "      , DEST_SALES_AD_2                                           " & vbNewLine _
                                                & "      , DEST_SALES_AD_3                                           " & vbNewLine _
                                                & "      , DEST_SALES_TEL                                            " & vbNewLine _
                                                & "      , SAGYO_RYAK_1                                              " & vbNewLine _
                                                & "      , SAGYO_RYAK_2                                              " & vbNewLine _
                                                & "      , SAGYO_RYAK_3                                              " & vbNewLine _
                                                & "      , SAGYO_RYAK_4                                              " & vbNewLine _
                                                & "      , SAGYO_RYAK_5                                              " & vbNewLine _
                                                & "      , DEST_SAGYO_RYAK_1                                         " & vbNewLine _
                                                & "      , DEST_SAGYO_RYAK_2                                         " & vbNewLine _
                                                & "      , SZ01_YUSO                                                 " & vbNewLine _
                                                & "      , SZ01_UNSO                                                 " & vbNewLine _
                                                & "--(2012.10.19)要望番号1289 -- START --                            " & vbNewLine _
                                                & "      , GOODS_COND_CD_1                                           " & vbNewLine _
                                                & "      , GOODS_COND_CD                                             " & vbNewLine _
                                                & "      , GOODS_COND_CD_3                                           " & vbNewLine _
                                                & "      , REMARK_ZAI                                                " & vbNewLine _
                                                & "      , LT_DATE                                                   " & vbNewLine _
                                                & "      , CASE WHEN SET_NAIYO = '1'  THEN  '1'                      " & vbNewLine _
                                                & "        ELSE ''                                                   " & vbNewLine _
                                                & "        END  AS SET_NAIYO                                         " & vbNewLine _
                                                & "      , SYS_UPD_PGID                                              " & vbNewLine _
                                                & "--(2012.10.19)要望番号1289 --  END  --                            " & vbNewLine _
                                                & "      , SHOBO_KBN_NM                                              " & vbNewLine _
                                                & "      , HINMEI                                                    " & vbNewLine _
                                                & "--(2012.11.28) LMC637対応 -- START --                             " & vbNewLine _
                                                & "      , CUST_CD_M                                                 " & vbNewLine _
                                                & "      , CUST_CD_S                                                 " & vbNewLine _
                                                & "      , CUST_COST_CD2                                             " & vbNewLine _
                                                & "--(2012.11.28) LMC637対応 --  END  --                             " & vbNewLine _
                                                & "--(2012.12.17) LMC731対応 -- START --                             " & vbNewLine _
                                                & "      , SEARCH_KEY_2                                              " & vbNewLine _
                                                & "--(2012.12.17) LMC731対応 --  END  --                             " & vbNewLine _
                                                & "   FROM                                                           " & vbNewLine _
                                                & "        (                                                         " & vbNewLine


#End Region

    ''' <summary>
    ''' 印刷データ抽出用
    ''' </summary>
    ''' <remarks></remarks>
    Friend Const SQL_SELECT_MAIN_TEFLON As String = " --SQL_SELECT_MAIN_TEFLON                                               " & vbNewLine _
                                            & " SELECT                                                            " & vbNewLine _
                                            & " RPT_ID                                                            " & vbNewLine _
                                            & ",NRS_BR_CD                                                         " & vbNewLine _
                                            & ",PRINT_SORT                                                        " & vbNewLine _
                                            & ",DEST_CD                                                           " & vbNewLine _
                                            & ",DEST_NM                                                           " & vbNewLine _
                                            & ",DEST_AD_1                                                         " & vbNewLine _
                                            & ",DEST_AD_2                                                         " & vbNewLine _
                                            & ",DEST_AD_3                                                         " & vbNewLine _
                                            & ",DEST_TEL                                                          " & vbNewLine _
                                            & ",OUTKA_PLAN_DATE                                                   " & vbNewLine _
                                            & ",CUST_ORD_NO                                                       " & vbNewLine _
                                            & ",BUYER_ORD_NO                                                      " & vbNewLine _
                                            & ",UNSOCO_NM                                                         " & vbNewLine _
                                            & ",ARR_PLAN_DATE                                                     " & vbNewLine _
                                            & ",ARR_PLAN_TIME                                                     " & vbNewLine _
                                            & ",OUTKA_NO_L                                                        " & vbNewLine _
                                            & ",URIG_NM                                                           " & vbNewLine _
                                            & ",CUST_NM_L                                                         " & vbNewLine _
                                            & "--(2012.06.15) 要望番号1155 -- START --                            " & vbNewLine _
                                            & ",CUST_NM_M                                                         " & vbNewLine _
                                            & ",DENPYO_NM                                                         " & vbNewLine _
                                            & "--(2012.06.15) 要望番号1155 --  END  --                            " & vbNewLine _
                                            & ",CASE WHEN DEST_SALES_CD <> ''                                     " & vbNewLine _
                                            & "           AND DEST_SALES_CD IS NOT NULL THEN DEST_SALES_AD_1      " & vbNewLine _
                                            & "      ELSE CUST_AD_1 END CUST_AD_1                                 " & vbNewLine _
                                            & ",CASE WHEN DEST_SALES_CD <> ''                                     " & vbNewLine _
                                            & "           AND DEST_SALES_CD IS NOT NULL THEN DEST_SALES_AD_2      " & vbNewLine _
                                            & "      ELSE CUST_AD_2 END CUST_AD_2                                 " & vbNewLine _
                                            & ",CASE WHEN DEST_SALES_CD <> ''                                     " & vbNewLine _
                                            & "           AND DEST_SALES_CD IS NOT NULL THEN DEST_SALES_TEL       " & vbNewLine _
                                            & "      ELSE CUST_TEL END CUST_TEL                                 " & vbNewLine _
                                            & ",NRS_BR_NM                                                         " & vbNewLine _
                                            & ",NRS_BR_AD1                                                        " & vbNewLine _
                                            & ",NRS_BR_AD2                                                        " & vbNewLine _
                                            & ",NRS_BR_TEL                                                        " & vbNewLine _
                                            & ",NRS_BR_FAX                                                        " & vbNewLine _
                                            & ",PIC                                                               " & vbNewLine _
                                            & ",OUTKA_NO_M                                                        " & vbNewLine _
                                            & ",MIN(OUTKA_NO_S)          AS OUTKA_NO_S                            " & vbNewLine _
                                            & ",INKA_DATE                                                         " & vbNewLine _
                                            & ",REMARK_OUT                                                        " & vbNewLine _
                                            & ",GOODS_NM_1                                                        " & vbNewLine _
                                            & ",LOT_NO                                                            " & vbNewLine _
                                            & ",SERIAL_NO                                                         " & vbNewLine _
                                            & ",IRIME                                                             " & vbNewLine _
                                            & ",PKG_NB                                                            " & vbNewLine _
                                            & ",SUM(ALCTD_NB) / PKG_NB   AS KONSU                                 " & vbNewLine _
                                            & ",SUM(ALCTD_NB) % PKG_NB   AS HASU                                  " & vbNewLine _
                                            & ",SUM(ALCTD_NB)            AS ALCTD_NB                              " & vbNewLine _
                                            & ",PKG_UT                                                            " & vbNewLine _
                                            & ",PKG_UT_NM                                                         " & vbNewLine _
                                            & ",SUM(ALCTD_QT)            AS ALCTD_QT                              " & vbNewLine _
                                            & ",IRIME_UT                                                          " & vbNewLine _
                                            & ",WT                       AS WT                                    " & vbNewLine _
                                            & ",UNSO_WT                                                           " & vbNewLine _
                                            & ",TOU_NO                                                            " & vbNewLine _
                                            & ",SITU_NO                                                           " & vbNewLine _
                                            & ",ZONE_CD                                                           " & vbNewLine _
                                            & ",LOCA                                                              " & vbNewLine _
                                            & ",MIN(ZAN_KONSU)           AS ZAN_KONSU                             " & vbNewLine _
                                            & "--(2012.09.06)要望番号1411 残端数不具合対応 -- START --            " & vbNewLine _
                                            & "--,MIN(ZAN_HASU)          AS ZAN_HASU                              " & vbNewLine _
                                            & ",MIN(ALCTD_CAN_NB) % PKG_NB AS ZAN_HASU                            " & vbNewLine _
                                            & "--(2012.09.06)要望番号1411 残端数不具合対応 --  END  --            " & vbNewLine _
                                            & ",GOODS_CD_CUST                                                     " & vbNewLine _
                                            & ",REMARK_M                                                          " & vbNewLine _
                                            & ",CUST_NM_S                                                         " & vbNewLine _
                                            & ",CUST_NM_S_H                                                       " & vbNewLine _
                                            & ",CUST_ORD_NO_DTL                                                   " & vbNewLine _
                                            & ",OUTKA_REMARK                                                      " & vbNewLine _
                                            & ",HAISOU_REMARK                                                     " & vbNewLine _
                                            & ",NHS_REMARK                                                        " & vbNewLine _
                                            & ",KYORI                                                             " & vbNewLine _
                                            & ",OUTKA_PKG_NB_L                                                    " & vbNewLine _
                                            & ",SOKO_NM                                                           " & vbNewLine _
                                            & ",BUSHO_NM                                                          " & vbNewLine _
                                            & ",NRS_BR_NM_NICHI                                                   " & vbNewLine _
                                            & ",MIN(ALCTD_CAN_QT)        AS ALCTD_CAN_QT                          " & vbNewLine _
                                            & ",ALCTD_KB                                                          " & vbNewLine _
                                            & ",PTN_FLAG                                                          " & vbNewLine _
                                            & ",CUST_CD_L                                                         " & vbNewLine _
                                            & ",ORDER_TYPE                       AS ORDER_TYPE                    " & vbNewLine _
                                            & ",CASE WHEN URIG_NM <> ''                                           " & vbNewLine _
                                            & "           AND URIG_NM IS NOT NULL THEN URIG_NM                    " & vbNewLine _
                                            & "--【要望番号1122】埼玉対応 --- START ---                           " & vbNewLine _
                                            & "      WHEN DEST_SALES_NM   <> ''                                   " & vbNewLine _
                                            & "           AND DEST_SALES_NM IS NOT NULL THEN DEST_SALES_NM        " & vbNewLine _
                                            & "--【要望番号1122】埼玉対応 ---  END  ---                           " & vbNewLine _
                                            & "      WHEN DENPYO_NM   <> ''                                       " & vbNewLine _
                                            & "           AND DENPYO_NM IS NOT NULL   THEN DENPYO_NM              " & vbNewLine _
                                            & "      ELSE CUST_NM_L                                               " & vbNewLine _
                                            & " END                         AS ATSUKAISYA_NM                      " & vbNewLine _
                                            & "--【要望番号995】　2012/04/17　元着払い区分　START                 " & vbNewLine _
                                            & ",PC_KB_NM                                                          " & vbNewLine _
                                            & "--【要望番号995】　2012/04/17　元着払い区分　 END                  " & vbNewLine _
                                            & "--【要望番号1017】 2012/04/24　注文番号明細  START                 " & vbNewLine _
                                            & ",BUYER_ORD_NO_DTL                                                  " & vbNewLine _
                                            & "--【要望番号1017】　2012/04/17 注文番号明細　 END                  " & vbNewLine _
                                            & "--日医工対策開始                                                   " & vbNewLine _
                                            & ",TORI_KB   --20120802 群馬篠崎運送でも利用。(FREE_C01)             " & vbNewLine _
                                            & "--★追加開始2012/05/11                                             " & vbNewLine _
                                            & ",SHIP_CD_L                                                         " & vbNewLine _
                                            & "--★追加終了2012/05/11                                             " & vbNewLine _
                                            & "--★削除開始2012/05/11                                             " & vbNewLine _
                                            & "--,CHOKUSO_NM                                                      " & vbNewLine _
                                            & "--,CHOKUSO_CD                                                      " & vbNewLine _
                                            & "--,HAKKO_DATE                                                      " & vbNewLine _
                                            & "--★削除終了2012/05/11                                             " & vbNewLine _
                                            & ",SET_NAIYO_4                                                       " & vbNewLine _
                                            & ",SET_NAIYO_5                                                       " & vbNewLine _
                                            & ",SET_NAIYO_6                                                       " & vbNewLine _
                                            & ",GOODS_NM_2                                                        " & vbNewLine _
                                            & ",KICHO_KB                                                          " & vbNewLine _
                                            & ",SEI_YURAI_KB                                                      " & vbNewLine _
                                            & ",REMARK_UPPER                                                      " & vbNewLine _
                                            & ",REMARK_LOWER                                                      " & vbNewLine _
                                            & ",GOODS_SYUBETU                                                     " & vbNewLine _
                                            & ",YUKOU_KIGEN                                                       " & vbNewLine _
                                            & ",GOODS_NM_3    --2012/05/23                                        " & vbNewLine _
                                            & ",EDISHIP_CD    --2012/05/23                                        " & vbNewLine _
                                            & ",EDIDEST_CD    --2012/05/23                                        " & vbNewLine _
                                            & "--日医工対策終了                                                   " & vbNewLine _
                                            & "--(2012.06.01)日本ファイン対応 --- START ---                       " & vbNewLine _
                                            & ",SET_NAIYO_FROM1                                                   " & vbNewLine _
                                            & ",SET_NAIYO_FROM2                                                   " & vbNewLine _
                                            & ",SET_NAIYO_FROM3                                                   " & vbNewLine _
                                            & "--(2012.06.01)日本ファイン対応 ---  END  ---                       " & vbNewLine _
                                            & "--【要望番号1122】埼玉対応 --- START ---                           " & vbNewLine _
                                            & ",CASE WHEN DEST_SALES_CD <> ''                                     " & vbNewLine _
                                            & "           AND DEST_SALES_CD IS NOT NULL THEN DEST_SALES_AD_3      " & vbNewLine _
                                            & "      ELSE CUST_AD_3 END CUST_AD_3                                 " & vbNewLine _
                                            & ",DEST_REMARK                                                       " & vbNewLine _
                                            & ",DEST_SALES_CD                                                     " & vbNewLine _
                                            & ",DEST_SALES_NM                                                     " & vbNewLine _
                                            & ",DEST_SALES_AD_1                                                   " & vbNewLine _
                                            & ",DEST_SALES_AD_2                                                   " & vbNewLine _
                                            & ",DEST_SALES_AD_3                                                   " & vbNewLine _
                                            & ",DEST_SALES_TEL                                                    " & vbNewLine _
                                            & "--【要望番号1122】埼玉対応 ---  END  ---                           " & vbNewLine _
                                            & "--群馬(合算)端数行分割版向け対応(作業略称) 開始20120731            " & vbNewLine _
                                            & ",SAGYO_RYAK_1                                                      " & vbNewLine _
                                            & ",SAGYO_RYAK_2                                                      " & vbNewLine _
                                            & ",SAGYO_RYAK_3                                                      " & vbNewLine _
                                            & ",SAGYO_RYAK_4                                                      " & vbNewLine _
                                            & ",SAGYO_RYAK_5                                                      " & vbNewLine _
                                            & ",DEST_SAGYO_RYAK_1                                                 " & vbNewLine _
                                            & ",DEST_SAGYO_RYAK_2                                                 " & vbNewLine _
                                            & "--群馬篠崎運送向け自由項目対応　開始　                             " & vbNewLine _
                                            & ",SZ01_YUSO                                                         " & vbNewLine _
                                            & ",SZ01_UNSO                                                         " & vbNewLine _
                                            & "--群馬篠崎運送向け自由項目対応　終了　                             " & vbNewLine _
                                            & "--群馬(合算)端数行分割版向け対応(作業略称) 終了20120731            " & vbNewLine _
                                            & "--【要望番号2068】デュポンテフロン対応 --- START ---               " & vbNewLine _
                                            & ",RUIJI_GOODS_FLG                                                   " & vbNewLine _
                                            & ",DUPONT_YORYO                                                      " & vbNewLine _
                                            & "--【要望番号2068】デュポンテフロン対応 ---  END  ---               " & vbNewLine _
                                            & "FROM                                                               " & vbNewLine _
                                            & "(                                                                  " & vbNewLine

    'アクサルタ納品書　注文番号（M単位）の表示対応 2017/10/04 Annen START
    ''' <summary>
    ''' 印刷データ抽出用(古川用)
    ''' </summary>
    ''' <remarks></remarks>
    Friend Const SQL_SELECT_MAIN_TEFLON_FURUKAWA As String = " --SQL_SELECT_MAIN_TEFLON                      " & vbNewLine _
                                        & " SELECT                                                            " & vbNewLine _
                                        & " RPT_ID                                                            " & vbNewLine _
                                        & ",NRS_BR_CD                                                         " & vbNewLine _
                                        & ",PRINT_SORT                                                        " & vbNewLine _
                                        & ",DEST_CD                                                           " & vbNewLine _
                                        & ",DEST_NM                                                           " & vbNewLine _
                                        & ",DEST_AD_1                                                         " & vbNewLine _
                                        & ",DEST_AD_2                                                         " & vbNewLine _
                                        & ",DEST_AD_3                                                         " & vbNewLine _
                                        & ",DEST_TEL                                                          " & vbNewLine _
                                        & ",OUTKA_PLAN_DATE                                                   " & vbNewLine _
                                        & ",CUST_ORD_NO                                                       " & vbNewLine _
                                        & ",BUYER_ORD_NO                                                      " & vbNewLine _
                                        & ",UNSOCO_NM                                                         " & vbNewLine _
                                        & ",ARR_PLAN_DATE                                                     " & vbNewLine _
                                        & ",ARR_PLAN_TIME                                                     " & vbNewLine _
                                        & ",OUTKA_NO_L                                                        " & vbNewLine _
                                        & ",URIG_NM                                                           " & vbNewLine _
                                        & ",CUST_NM_L                                                         " & vbNewLine _
                                        & ",CUST_NM_M                                                         " & vbNewLine _
                                        & ",DENPYO_NM                                                         " & vbNewLine _
                                        & ",CASE WHEN DEST_SALES_CD <> ''                                     " & vbNewLine _
                                        & "           AND DEST_SALES_CD IS NOT NULL THEN DEST_SALES_AD_1      " & vbNewLine _
                                        & "      ELSE CUST_AD_1 END CUST_AD_1                                 " & vbNewLine _
                                        & ",CASE WHEN DEST_SALES_CD <> ''                                     " & vbNewLine _
                                        & "           AND DEST_SALES_CD IS NOT NULL THEN DEST_SALES_AD_2      " & vbNewLine _
                                        & "      ELSE CUST_AD_2 END CUST_AD_2                                 " & vbNewLine _
                                        & ",CASE WHEN DEST_SALES_CD <> ''                                     " & vbNewLine _
                                        & "           AND DEST_SALES_CD IS NOT NULL THEN DEST_SALES_TEL       " & vbNewLine _
                                        & "      ELSE CUST_TEL END CUST_TEL                                 　" & vbNewLine _
                                        & ",NRS_BR_NM                                                         " & vbNewLine _
                                        & ",NRS_BR_AD1                                                        " & vbNewLine _
                                        & ",NRS_BR_AD2                                                        " & vbNewLine _
                                        & ",NRS_BR_TEL                                                        " & vbNewLine _
                                        & ",NRS_BR_FAX                                                        " & vbNewLine _
                                        & ",PIC                                                               " & vbNewLine _
                                        & ",OUTKA_NO_M                                                        " & vbNewLine _
                                        & ",MIN(OUTKA_NO_S)          AS OUTKA_NO_S                            " & vbNewLine _
                                        & ",INKA_DATE                                                         " & vbNewLine _
                                        & ",REMARK_OUT                                                        " & vbNewLine _
                                        & ",GOODS_NM_1                                                        " & vbNewLine _
                                        & ",LOT_NO                                                            " & vbNewLine _
                                        & ",SERIAL_NO                                                         " & vbNewLine _
                                        & ",IRIME                                                             " & vbNewLine _
                                        & ",PKG_NB                                                            " & vbNewLine _
                                        & ",SUM(ALCTD_NB) / PKG_NB   AS KONSU                                 " & vbNewLine _
                                        & ",SUM(ALCTD_NB) % PKG_NB   AS HASU                                  " & vbNewLine _
                                        & ",SUM(ALCTD_NB)            AS ALCTD_NB                              " & vbNewLine _
                                        & ",PKG_UT                                                            " & vbNewLine _
                                        & ",PKG_UT_NM                                                         " & vbNewLine _
                                        & ",SUM(ALCTD_QT)            AS ALCTD_QT                              " & vbNewLine _
                                        & ",IRIME_UT                                                          " & vbNewLine _
                                        & ",WT                       AS WT                                    " & vbNewLine _
                                        & ",UNSO_WT                                                           " & vbNewLine _
                                        & ",TOU_NO                                                            " & vbNewLine _
                                        & ",SITU_NO                                                           " & vbNewLine _
                                        & ",ZONE_CD                                                           " & vbNewLine _
                                        & ",LOCA                                                              " & vbNewLine _
                                        & ",MIN(ZAN_KONSU)           AS ZAN_KONSU                             " & vbNewLine _
                                        & ",MIN(ALCTD_CAN_NB) % PKG_NB AS ZAN_HASU                            " & vbNewLine _
                                        & ",GOODS_CD_CUST                                                     " & vbNewLine _
                                        & ",REMARK_M                                                          " & vbNewLine _
                                        & ",CUST_NM_S                                                         " & vbNewLine _
                                        & ",CUST_NM_S_H                                                       " & vbNewLine _
                                        & ",CUST_ORD_NO_DTL                                                   " & vbNewLine _
                                        & ",OUTKA_REMARK                                                      " & vbNewLine _
                                        & ",HAISOU_REMARK                                                     " & vbNewLine _
                                        & ",NHS_REMARK                                                        " & vbNewLine _
                                        & ",KYORI                                                             " & vbNewLine _
                                        & ",OUTKA_PKG_NB_L                                                    " & vbNewLine _
                                        & ",SOKO_NM                                                           " & vbNewLine _
                                        & ",BUSHO_NM                                                          " & vbNewLine _
                                        & ",NRS_BR_NM_NICHI                                                   " & vbNewLine _
                                        & ",MIN(ALCTD_CAN_QT)        AS ALCTD_CAN_QT                          " & vbNewLine _
                                        & ",ALCTD_KB                                                          " & vbNewLine _
                                        & ",PTN_FLAG                                                          " & vbNewLine _
                                        & ",CUST_CD_L                                                         " & vbNewLine _
                                        & ",ORDER_TYPE                       AS ORDER_TYPE                    " & vbNewLine _
                                        & ",CASE WHEN URIG_NM <> ''                                           " & vbNewLine _
                                        & "           AND URIG_NM IS NOT NULL THEN URIG_NM                    " & vbNewLine _
                                        & "      WHEN DEST_SALES_NM   <> ''                                   " & vbNewLine _
                                        & "           AND DEST_SALES_NM IS NOT NULL THEN DEST_SALES_NM        " & vbNewLine _
                                        & "      WHEN DENPYO_NM   <> ''                                       " & vbNewLine _
                                        & "           AND DENPYO_NM IS NOT NULL   THEN DENPYO_NM              " & vbNewLine _
                                        & "      ELSE CUST_NM_L                                               " & vbNewLine _
                                        & " END                         AS ATSUKAISYA_NM                      " & vbNewLine _
                                        & ",PC_KB_NM                                                          " & vbNewLine _
                                        & ",BUYER_ORD_NO_DTL                                                  " & vbNewLine _
                                        & ",TORI_KB   --20120802 群馬篠崎運送でも利用。(FREE_C01)             " & vbNewLine _
                                        & ",SHIP_CD_L                                                         " & vbNewLine _
                                        & ",SET_NAIYO_4                                                       " & vbNewLine _
                                        & ",SET_NAIYO_5                                                       " & vbNewLine _
                                        & ",SET_NAIYO_6                                                       " & vbNewLine _
                                        & ",GOODS_NM_2                                                        " & vbNewLine _
                                        & ",KICHO_KB                                                          " & vbNewLine _
                                        & ",SEI_YURAI_KB                                                      " & vbNewLine _
                                        & ",REMARK_UPPER                                                      " & vbNewLine _
                                        & ",REMARK_LOWER                                                      " & vbNewLine _
                                        & ",GOODS_SYUBETU                                                     " & vbNewLine _
                                        & ",YUKOU_KIGEN                                                       " & vbNewLine _
                                        & ",GOODS_NM_3    --2012/05/23                                        " & vbNewLine _
                                        & ",EDISHIP_CD    --2012/05/23                                        " & vbNewLine _
                                        & ",EDIDEST_CD    --2012/05/23                                        " & vbNewLine _
                                        & ",SET_NAIYO_FROM1                                                   " & vbNewLine _
                                        & ",SET_NAIYO_FROM2                                                   " & vbNewLine _
                                        & ",SET_NAIYO_FROM3                                                   " & vbNewLine _
                                        & ",CASE WHEN DEST_SALES_CD <> ''                                     " & vbNewLine _
                                        & "           AND DEST_SALES_CD IS NOT NULL THEN DEST_SALES_AD_3      " & vbNewLine _
                                        & "      ELSE CUST_AD_3 END CUST_AD_3                                 " & vbNewLine _
                                        & ",DEST_REMARK                                                       " & vbNewLine _
                                        & ",DEST_SALES_CD                                                     " & vbNewLine _
                                        & ",DEST_SALES_NM                                                     " & vbNewLine _
                                        & ",DEST_SALES_AD_1                                                   " & vbNewLine _
                                        & ",DEST_SALES_AD_2                                                   " & vbNewLine _
                                        & ",DEST_SALES_AD_3                                                   " & vbNewLine _
                                        & ",DEST_SALES_TEL                                                    " & vbNewLine _
                                        & ",SAGYO_RYAK_1                                                      " & vbNewLine _
                                        & ",SAGYO_RYAK_2                                                      " & vbNewLine _
                                        & ",SAGYO_RYAK_3                                                      " & vbNewLine _
                                        & ",SAGYO_RYAK_4                                                      " & vbNewLine _
                                        & ",SAGYO_RYAK_5                                                      " & vbNewLine _
                                        & ",DEST_SAGYO_RYAK_1                                                 " & vbNewLine _
                                        & ",DEST_SAGYO_RYAK_2                                                 " & vbNewLine _
                                        & ",SZ01_YUSO                                                         " & vbNewLine _
                                        & ",SZ01_UNSO                                                         " & vbNewLine _
                                        & ",RUIJI_GOODS_FLG                                                   " & vbNewLine _
                                        & ",DUPONT_YORYO                                                      " & vbNewLine _
                                        & "--アクサルタ納品書　注文番号（M単位）の表示対応 ↓                 " & vbNewLine _
                                        & ",BUYER_ORD_NO_DTL                                                  " & vbNewLine _
                                        & "--アクサルタ納品書　注文番号（M単位）の表示対応 ↑                 " & vbNewLine _
                                        & "FROM                                                               " & vbNewLine _
                                        & "(                                                                  " & vbNewLine
    'アクサルタ納品書　注文番号（M単位）の表示対応 2017/10/04 Annen END

    ''' <summary>
    ''' 印刷データ抽出用
    ''' </summary>
    ''' <remarks>LMC500DAC.SQL_SELECT_MAIN1 Copy 2017/09/04</remarks>
    Friend Const SQL_SELECT_MAIN_854 As String = " --SQL_SELECT_MAIN_854                                               " & vbNewLine _
                                            & " SELECT                                                            " & vbNewLine _
                                            & " RPT_ID                                                            " & vbNewLine _
                                            & ",NRS_BR_CD                                                         " & vbNewLine _
                                            & ",PRINT_SORT                                                        " & vbNewLine _
                                            & ",DEST_CD                                                           " & vbNewLine _
                                            & ",DEST_NM                                                           " & vbNewLine _
                                            & ",DEST_AD_1                                                         " & vbNewLine _
                                            & ",DEST_AD_2                                                         " & vbNewLine _
                                            & ",DEST_AD_3                                                         " & vbNewLine _
                                            & ",DEST_TEL                                                          " & vbNewLine _
                                            & ",OUTKA_PLAN_DATE                                                   " & vbNewLine _
                                            & ",CUST_ORD_NO                                                       " & vbNewLine _
                                            & ",BUYER_ORD_NO                                                      " & vbNewLine _
                                            & ",UNSOCO_NM                                                         " & vbNewLine _
                                            & ",ARR_PLAN_DATE                                                     " & vbNewLine _
                                            & ",ARR_PLAN_TIME                                                     " & vbNewLine _
                                            & ",OUTKA_NO_L                                                        " & vbNewLine _
                                            & ",URIG_NM                                                           " & vbNewLine _
                                            & ",CUST_NM_L                                                         " & vbNewLine _
                                            & ",CUST_NM_M                                                         " & vbNewLine _
                                            & ",DENPYO_NM                                                         " & vbNewLine _
                                            & ",CASE WHEN DEST_SALES_CD <> ''                                     " & vbNewLine _
                                            & "           AND DEST_SALES_CD IS NOT NULL THEN DEST_SALES_AD_1      " & vbNewLine _
                                            & "      ELSE CUST_AD_1 END CUST_AD_1                                 " & vbNewLine _
                                            & ",CASE WHEN DEST_SALES_CD <> ''                                     " & vbNewLine _
                                            & "           AND DEST_SALES_CD IS NOT NULL THEN DEST_SALES_AD_2      " & vbNewLine _
                                            & "      ELSE CUST_AD_2 END CUST_AD_2                                 " & vbNewLine _
                                            & ",CASE WHEN DEST_SALES_CD <> ''                                     " & vbNewLine _
                                            & "           AND DEST_SALES_CD IS NOT NULL THEN DEST_SALES_TEL       " & vbNewLine _
                                            & "      ELSE CUST_TEL END CUST_TEL                                 " & vbNewLine _
                                            & ",NRS_BR_NM                                                         " & vbNewLine _
                                            & ",NRS_BR_AD1                                                        " & vbNewLine _
                                            & ",NRS_BR_AD2                                                        " & vbNewLine _
                                            & ",NRS_BR_TEL                                                        " & vbNewLine _
                                            & ",NRS_BR_FAX                                                        " & vbNewLine _
                                            & ",PIC                                                               " & vbNewLine _
                                            & ",OUTKA_NO_M                                                        " & vbNewLine _
                                            & ",MIN(OUTKA_NO_S)          AS OUTKA_NO_S                            " & vbNewLine _
                                            & ",INKA_DATE                                                         " & vbNewLine _
                                            & ",REMARK_OUT                                                        " & vbNewLine _
                                            & ",GOODS_NM_1                                                        " & vbNewLine _
                                            & ",LOT_NO                                                            " & vbNewLine _
                                            & ",SERIAL_NO                                                         " & vbNewLine _
                                            & ",IRIME                                                             " & vbNewLine _
                                            & ",PKG_NB                                                            " & vbNewLine _
                                            & ",SUM(ALCTD_NB) / PKG_NB   AS KONSU                                 " & vbNewLine _
                                            & ",SUM(ALCTD_NB) % PKG_NB   AS HASU                                  " & vbNewLine _
                                            & ",SUM(ALCTD_NB)            AS ALCTD_NB                              " & vbNewLine _
                                            & ",PKG_UT                                                            " & vbNewLine _
                                            & ",PKG_UT_NM                                                         " & vbNewLine _
                                            & ",SUM(ALCTD_QT)            AS ALCTD_QT                              " & vbNewLine _
                                            & ",IRIME_UT                                                          " & vbNewLine _
                                            & ",WT                       AS WT                                    " & vbNewLine _
                                            & ",UNSO_WT                                                           " & vbNewLine _
                                            & ",TOU_NO                                                            " & vbNewLine _
                                            & ",SITU_NO                                                           " & vbNewLine _
                                            & ",ZONE_CD                                                           " & vbNewLine _
                                            & ",LOCA                                                              " & vbNewLine _
                                            & ",MIN(ZAN_KONSU)           AS ZAN_KONSU                             " & vbNewLine _
                                            & "--(2012.09.06)要望番号1411 残端数不具合対応 -- START --            " & vbNewLine _
                                            & "--,MIN(ZAN_HASU)          AS ZAN_HASU                              " & vbNewLine _
                                            & ",MIN(ALCTD_CAN_NB) % PKG_NB AS ZAN_HASU                            " & vbNewLine _
                                            & "--(2012.09.06)要望番号1411 残端数不具合対応 --  END  --            " & vbNewLine _
                                            & ",GOODS_CD_CUST                                                     " & vbNewLine _
                                            & ",REMARK_M                                                          " & vbNewLine _
                                            & ",CUST_NM_S                                                         " & vbNewLine _
                                            & ",CUST_NM_S_H                                                       " & vbNewLine _
                                            & ",CUST_ORD_NO_DTL                                                   " & vbNewLine _
                                            & ",OUTKA_REMARK                                                      " & vbNewLine _
                                            & ",HAISOU_REMARK                                                     " & vbNewLine _
                                            & ",NHS_REMARK                                                        " & vbNewLine _
                                            & ",KYORI                                                             " & vbNewLine _
                                            & ",OUTKA_PKG_NB_L                                                    " & vbNewLine _
                                            & ",SOKO_NM                                                           " & vbNewLine _
                                            & ",BUSHO_NM                                                          " & vbNewLine _
                                            & ",NRS_BR_NM_NICHI                                                   " & vbNewLine _
                                            & ",MIN(ALCTD_CAN_QT)        AS ALCTD_CAN_QT                          " & vbNewLine _
                                            & ",ALCTD_KB                                                          " & vbNewLine _
                                            & ",PTN_FLAG                                                          " & vbNewLine _
                                            & ",CUST_CD_L                                                         " & vbNewLine _
                                            & ",ORDER_TYPE                       AS ORDER_TYPE                    " & vbNewLine _
                                            & ",CASE WHEN URIG_NM <> ''                                           " & vbNewLine _
                                            & "           AND URIG_NM IS NOT NULL THEN URIG_NM                    " & vbNewLine _
                                            & "      WHEN DEST_SALES_NM   <> ''                                   " & vbNewLine _
                                            & "           AND DEST_SALES_NM IS NOT NULL THEN DEST_SALES_NM        " & vbNewLine _
                                            & "      WHEN DENPYO_NM   <> ''                                       " & vbNewLine _
                                            & "           AND DENPYO_NM IS NOT NULL   THEN DENPYO_NM              " & vbNewLine _
                                            & "      ELSE CUST_NM_L                                               " & vbNewLine _
                                            & " END                         AS ATSUKAISYA_NM                      " & vbNewLine _
                                            & ",PC_KB_NM                                                          " & vbNewLine _
                                            & ",BUYER_ORD_NO_DTL                                                  " & vbNewLine _
                                            & ",TORI_KB                                                           " & vbNewLine _
                                            & ",SHIP_CD_L                                                         " & vbNewLine _
                                            & "--,CHOKUSO_NM                                                      " & vbNewLine _
                                            & "--,CHOKUSO_CD                                                      " & vbNewLine _
                                            & "--,HAKKO_DATE                                                      " & vbNewLine _
                                            & ",SET_NAIYO_4                                                       " & vbNewLine _
                                            & ",SET_NAIYO_5                                                       " & vbNewLine _
                                            & ",SET_NAIYO_6                                                       " & vbNewLine _
                                            & ",GOODS_NM_2                                                        " & vbNewLine _
                                            & ",KICHO_KB                                                          " & vbNewLine _
                                            & ",SEI_YURAI_KB                                                      " & vbNewLine _
                                            & ",REMARK_UPPER                                                      " & vbNewLine _
                                            & ",REMARK_LOWER                                                      " & vbNewLine _
                                            & ",GOODS_SYUBETU                                                     " & vbNewLine _
                                            & ",YUKOU_KIGEN                                                       " & vbNewLine _
                                            & ",GOODS_NM_3    --2012/05/23                                        " & vbNewLine _
                                            & ",EDISHIP_CD    --2012/05/23                                        " & vbNewLine _
                                            & ",EDIDEST_CD    --2012/05/23                                        " & vbNewLine _
                                            & ",SET_NAIYO_FROM1                                                   " & vbNewLine _
                                            & ",SET_NAIYO_FROM2                                                   " & vbNewLine _
                                            & ",SET_NAIYO_FROM3                                                   " & vbNewLine _
                                            & ",CASE WHEN DEST_SALES_CD <> ''                                     " & vbNewLine _
                                            & "           AND DEST_SALES_CD IS NOT NULL THEN DEST_SALES_AD_3      " & vbNewLine _
                                            & "      ELSE CUST_AD_3 END CUST_AD_3                                 " & vbNewLine _
                                            & ",DEST_REMARK                                                       " & vbNewLine _
                                            & ",DEST_SALES_CD                                                     " & vbNewLine _
                                            & ",DEST_SALES_NM                                                     " & vbNewLine _
                                            & ",DEST_SALES_AD_1                                                   " & vbNewLine _
                                            & ",DEST_SALES_AD_2                                                   " & vbNewLine _
                                            & ",DEST_SALES_AD_3                                                   " & vbNewLine _
                                            & ",DEST_SALES_TEL                                                    " & vbNewLine _
                                            & ",SAGYO_RYAK_1                                                      " & vbNewLine _
                                            & ",SAGYO_RYAK_2                                                      " & vbNewLine _
                                            & ",SAGYO_RYAK_3                                                      " & vbNewLine _
                                            & ",SAGYO_RYAK_4                                                      " & vbNewLine _
                                            & ",SAGYO_RYAK_5                                                      " & vbNewLine _
                                            & ",DEST_SAGYO_RYAK_1                                                 " & vbNewLine _
                                            & ",DEST_SAGYO_RYAK_2                                                 " & vbNewLine _
                                            & ",SZ01_YUSO                                                         " & vbNewLine _
                                            & ",SZ01_UNSO                                                         " & vbNewLine _
                                            & ",LT_DATE                                                           " & vbNewLine _
                                            & ",'' AS SHOBO_CD                                                    " & vbNewLine _
                                            & "FROM                                                               " & vbNewLine _
                                            & "(                                                                  " & vbNewLine

    ''' <summary>
    ''' 印刷データ抽出用（中部物流センター）
    ''' </summary>
    ''' <remarks>SERIAL_NO,LOCAをグループ化キーから外したのでその対策</remarks>
    Friend Const SQL_SELECT_MAIN_WH600 As String = " --SQL_SELECT_MAIN_WH600                                      " & vbNewLine _
                                            & " SELECT                                                            " & vbNewLine _
                                            & " RPT_ID                                                            " & vbNewLine _
                                            & ",NRS_BR_CD                                                         " & vbNewLine _
                                            & ",PRINT_SORT                                                        " & vbNewLine _
                                            & ",DEST_CD                                                           " & vbNewLine _
                                            & ",DEST_NM                                                           " & vbNewLine _
                                            & ",DEST_AD_1                                                         " & vbNewLine _
                                            & ",DEST_AD_2                                                         " & vbNewLine _
                                            & ",DEST_AD_3                                                         " & vbNewLine _
                                            & ",DEST_TEL                                                          " & vbNewLine _
                                            & ",OUTKA_PLAN_DATE                                                   " & vbNewLine _
                                            & ",CUST_ORD_NO                                                       " & vbNewLine _
                                            & ",BUYER_ORD_NO                                                      " & vbNewLine _
                                            & ",UNSOCO_NM                                                         " & vbNewLine _
                                            & ",ARR_PLAN_DATE                                                     " & vbNewLine _
                                            & ",ARR_PLAN_TIME                                                     " & vbNewLine _
                                            & ",OUTKA_NO_L                                                        " & vbNewLine _
                                            & ",URIG_NM                                                           " & vbNewLine _
                                            & ",CUST_NM_L                                                         " & vbNewLine _
                                            & "--(2012.06.15) 要望番号1155 -- START --                            " & vbNewLine _
                                            & ",CUST_NM_M                                                         " & vbNewLine _
                                            & ",DENPYO_NM                                                         " & vbNewLine _
                                            & "--(2012.06.15) 要望番号1155 --  END  --                            " & vbNewLine _
                                            & ",CASE WHEN DEST_SALES_CD <> ''                                     " & vbNewLine _
                                            & "           AND DEST_SALES_CD IS NOT NULL THEN DEST_SALES_AD_1      " & vbNewLine _
                                            & "      ELSE CUST_AD_1 END CUST_AD_1                                 " & vbNewLine _
                                            & ",CASE WHEN DEST_SALES_CD <> ''                                     " & vbNewLine _
                                            & "           AND DEST_SALES_CD IS NOT NULL THEN DEST_SALES_AD_2      " & vbNewLine _
                                            & "      ELSE CUST_AD_2 END CUST_AD_2                                 " & vbNewLine _
                                            & ",CASE WHEN DEST_SALES_CD <> ''                                     " & vbNewLine _
                                            & "           AND DEST_SALES_CD IS NOT NULL THEN DEST_SALES_TEL       " & vbNewLine _
                                            & "      ELSE CUST_TEL END CUST_TEL                                 " & vbNewLine _
                                            & ",NRS_BR_NM                                                         " & vbNewLine _
                                            & ",NRS_BR_AD1                                                        " & vbNewLine _
                                            & ",NRS_BR_AD2                                                        " & vbNewLine _
                                            & ",NRS_BR_TEL                                                        " & vbNewLine _
                                            & ",NRS_BR_FAX                                                        " & vbNewLine _
                                            & ",PIC                                                               " & vbNewLine _
                                            & ",OUTKA_NO_M                                                        " & vbNewLine _
                                            & ",MIN(OUTKA_NO_S)          AS OUTKA_NO_S                            " & vbNewLine _
                                            & ",INKA_DATE                                                         " & vbNewLine _
                                            & ",REMARK_OUT                                                        " & vbNewLine _
                                            & ",GOODS_NM_1                                                        " & vbNewLine _
                                            & ",LOT_NO                                                            " & vbNewLine _
                                            & ",'' AS SERIAL_NO                                                   " & vbNewLine _
                                            & ",IRIME                                                             " & vbNewLine _
                                            & ",PKG_NB                                                            " & vbNewLine _
                                            & ",SUM(ALCTD_NB) / PKG_NB   AS KONSU                                 " & vbNewLine _
                                            & ",SUM(ALCTD_NB) % PKG_NB   AS HASU                                  " & vbNewLine _
                                            & ",SUM(ALCTD_NB)            AS ALCTD_NB                              " & vbNewLine _
                                            & ",PKG_UT                                                            " & vbNewLine _
                                            & ",PKG_UT_NM                                                         " & vbNewLine _
                                            & ",SUM(ALCTD_QT)            AS ALCTD_QT                              " & vbNewLine _
                                            & ",IRIME_UT                                                          " & vbNewLine _
                                            & ",WT                       AS WT                                    " & vbNewLine _
                                            & ",UNSO_WT                                                           " & vbNewLine _
                                            & ",TOU_NO                                                            " & vbNewLine _
                                            & ",SITU_NO                                                           " & vbNewLine _
                                            & ",ZONE_CD                                                           " & vbNewLine _
                                            & ",'' AS LOCA                                                        " & vbNewLine _
                                            & ",MIN(ZAN_KONSU)           AS ZAN_KONSU                             " & vbNewLine _
                                            & "--(2012.09.06)要望番号1411 残端数不具合対応 -- START --            " & vbNewLine _
                                            & "--,MIN(ZAN_HASU)          AS ZAN_HASU                              " & vbNewLine _
                                            & ",MIN(ALCTD_CAN_NB) % PKG_NB AS ZAN_HASU                            " & vbNewLine _
                                            & "--(2012.09.06)要望番号1411 残端数不具合対応 --  END  --            " & vbNewLine _
                                            & ",GOODS_CD_CUST                                                     " & vbNewLine _
                                            & ",REMARK_M                                                          " & vbNewLine _
                                            & ",CUST_NM_S                                                         " & vbNewLine _
                                            & ",CUST_NM_S_H                                                       " & vbNewLine _
                                            & ",CUST_ORD_NO_DTL                                                   " & vbNewLine _
                                            & ",OUTKA_REMARK                                                      " & vbNewLine _
                                            & ",HAISOU_REMARK                                                     " & vbNewLine _
                                            & ",NHS_REMARK                                                        " & vbNewLine _
                                            & ",KYORI                                                             " & vbNewLine _
                                            & ",OUTKA_PKG_NB_L                                                    " & vbNewLine _
                                            & ",SOKO_NM                                                           " & vbNewLine _
                                            & ",BUSHO_NM                                                          " & vbNewLine _
                                            & ",NRS_BR_NM_NICHI                                                   " & vbNewLine _
                                            & ",MIN(ALCTD_CAN_QT)        AS ALCTD_CAN_QT                          " & vbNewLine _
                                            & ",ALCTD_KB                                                          " & vbNewLine _
                                            & ",PTN_FLAG                                                          " & vbNewLine _
                                            & ",CUST_CD_L                                                         " & vbNewLine _
                                            & ",ORDER_TYPE                       AS ORDER_TYPE                    " & vbNewLine _
                                            & ",CASE WHEN URIG_NM <> ''                                           " & vbNewLine _
                                            & "           AND URIG_NM IS NOT NULL THEN URIG_NM                    " & vbNewLine _
                                            & "--【要望番号1122】埼玉対応 --- START ---                           " & vbNewLine _
                                            & "      WHEN DEST_SALES_NM   <> ''                                   " & vbNewLine _
                                            & "           AND DEST_SALES_NM IS NOT NULL THEN DEST_SALES_NM        " & vbNewLine _
                                            & "--【要望番号1122】埼玉対応 ---  END  ---                           " & vbNewLine _
                                            & "      WHEN DENPYO_NM   <> ''                                       " & vbNewLine _
                                            & "           AND DENPYO_NM IS NOT NULL   THEN DENPYO_NM              " & vbNewLine _
                                            & "      ELSE CUST_NM_L                                               " & vbNewLine _
                                            & " END                         AS ATSUKAISYA_NM                      " & vbNewLine _
                                            & "--【要望番号995】　2012/04/17　元着払い区分　START                 " & vbNewLine _
                                            & ",PC_KB_NM                                                          " & vbNewLine _
                                            & "--【要望番号995】　2012/04/17　元着払い区分　 END                  " & vbNewLine _
                                            & "--【要望番号1017】 2012/04/24　注文番号明細  START                 " & vbNewLine _
                                            & ",BUYER_ORD_NO_DTL                                                  " & vbNewLine _
                                            & "--【要望番号1017】　2012/04/17 注文番号明細　 END                  " & vbNewLine _
                                            & "--日医工対策開始                                                   " & vbNewLine _
                                            & ",TORI_KB   --20120802 群馬篠崎運送でも利用。(FREE_C01)             " & vbNewLine _
                                            & "--★追加開始2012/05/11                                             " & vbNewLine _
                                            & ",SHIP_CD_L                                                         " & vbNewLine _
                                            & "--★追加終了2012/05/11                                             " & vbNewLine _
                                            & "--★削除開始2012/05/11                                             " & vbNewLine _
                                            & "--,CHOKUSO_NM                                                      " & vbNewLine _
                                            & "--,CHOKUSO_CD                                                      " & vbNewLine _
                                            & "--,HAKKO_DATE                                                      " & vbNewLine _
                                            & "--★削除終了2012/05/11                                             " & vbNewLine _
                                            & ",SET_NAIYO_4                                                       " & vbNewLine _
                                            & ",SET_NAIYO_5                                                       " & vbNewLine _
                                            & ",SET_NAIYO_6                                                       " & vbNewLine _
                                            & ",GOODS_NM_2                                                        " & vbNewLine _
                                            & ",KICHO_KB                                                          " & vbNewLine _
                                            & ",SEI_YURAI_KB                                                      " & vbNewLine _
                                            & ",REMARK_UPPER                                                      " & vbNewLine _
                                            & ",REMARK_LOWER                                                      " & vbNewLine _
                                            & ",GOODS_SYUBETU                                                     " & vbNewLine _
                                            & ",YUKOU_KIGEN                                                       " & vbNewLine _
                                            & ",GOODS_NM_3    --2012/05/23                                        " & vbNewLine _
                                            & ",EDISHIP_CD    --2012/05/23                                        " & vbNewLine _
                                            & ",EDIDEST_CD    --2012/05/23                                        " & vbNewLine _
                                            & "--日医工対策終了                                                   " & vbNewLine _
                                            & "--(2012.06.01)日本ファイン対応 --- START ---                       " & vbNewLine _
                                            & ",SET_NAIYO_FROM1                                                   " & vbNewLine _
                                            & ",SET_NAIYO_FROM2                                                   " & vbNewLine _
                                            & ",SET_NAIYO_FROM3                                                   " & vbNewLine _
                                            & "--(2012.06.01)日本ファイン対応 ---  END  ---                       " & vbNewLine _
                                            & "--【要望番号1122】埼玉対応 --- START ---                           " & vbNewLine _
                                            & ",CASE WHEN DEST_SALES_CD <> ''                                     " & vbNewLine _
                                            & "           AND DEST_SALES_CD IS NOT NULL THEN DEST_SALES_AD_3      " & vbNewLine _
                                            & "      ELSE CUST_AD_3 END CUST_AD_3                                 " & vbNewLine _
                                            & ",DEST_REMARK                                                       " & vbNewLine _
                                            & ",DEST_SALES_CD                                                     " & vbNewLine _
                                            & ",DEST_SALES_NM                                                     " & vbNewLine _
                                            & ",DEST_SALES_AD_1                                                   " & vbNewLine _
                                            & ",DEST_SALES_AD_2                                                   " & vbNewLine _
                                            & ",DEST_SALES_AD_3                                                   " & vbNewLine _
                                            & ",DEST_SALES_TEL                                                    " & vbNewLine _
                                            & "--【要望番号1122】埼玉対応 ---  END  ---                           " & vbNewLine _
                                            & "--群馬(合算)端数行分割版向け対応(作業略称) 開始20120731            " & vbNewLine _
                                            & ",SAGYO_RYAK_1                                                      " & vbNewLine _
                                            & ",SAGYO_RYAK_2                                                      " & vbNewLine _
                                            & ",SAGYO_RYAK_3                                                      " & vbNewLine _
                                            & ",SAGYO_RYAK_4                                                      " & vbNewLine _
                                            & ",SAGYO_RYAK_5                                                      " & vbNewLine _
                                            & ",DEST_SAGYO_RYAK_1                                                 " & vbNewLine _
                                            & ",DEST_SAGYO_RYAK_2                                                 " & vbNewLine _
                                            & "--群馬篠崎運送向け自由項目対応　開始　                             " & vbNewLine _
                                            & ",SZ01_YUSO                                                         " & vbNewLine _
                                            & ",SZ01_UNSO                                                         " & vbNewLine _
                                            & "--群馬篠崎運送向け自由項目対応　終了　                             " & vbNewLine _
                                            & "--群馬(合算)端数行分割版向け対応(作業略称) 終了20120731            " & vbNewLine _
                                            & ",SHOBO_CD                                                          " & vbNewLine _
                                            & "FROM                                                               " & vbNewLine _
                                            & "(                                                                  " & vbNewLine

#End Region

#Region "SELECT句(印刷データ:出荷)"

    ''' <summary>
    ''' 印刷データ抽出用(出荷テーブル)
    ''' </summary>
    ''' <remarks></remarks>
    Friend Const SQL_SELECT_OUTKA As String = "--★★★SQL_SELECT_OUTKA★★★  出荷テーブル                                                                                                                 " & vbNewLine _
                                             & "SELECT                                                                                                                         " & vbNewLine _
                                             & "--UPD 2022/04/26 028723  CASE WHEN MR2.PTN_CD IS NOT NULL THEN MR2.RPT_ID                                                      " & vbNewLine _
                                             & "--CASE WHEN @IKKATU_FLG = '1' AND MR4.PTN_CD IS NOT NULL THEN MR4.RPT_ID                                                         " & vbNewLine _
                                             & " CASE WHEN MR2.PTN_CD IS NOT NULL THEN MR2.RPT_ID                                                                              " & vbNewLine _
                                             & "      WHEN @IKKATU_FLG = '1' AND MR4.PTN_CD IS NOT NULL THEN MR4.RPT_ID                                                        " & vbNewLine _
                                             & "      WHEN MR1.PTN_CD IS NOT NULL THEN MR1.RPT_ID                                                                              " & vbNewLine _
                                             & "      ELSE MR3.RPT_ID                                                                                                          " & vbNewLine _
                                             & " END              AS RPT_ID                                                                                                    " & vbNewLine _
                                             & ",OUTL.NRS_BR_CD   AS NRS_BR_CD                                                                                                 " & vbNewLine _
                                             & ",OUTM.PRINT_SORT  AS PRINT_SORT                                                                                                " & vbNewLine _
                                             & ",CASE WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_CD                                                                     " & vbNewLine _
                                             & "      ELSE OUTL.DEST_CD                                                                                                        " & vbNewLine _
                                             & " END              AS DEST_CD                                                                                                   " & vbNewLine _
                                             & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_NM                                                                               " & vbNewLine _
                                             & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_NM                                                                     " & vbNewLine _
                                             & "      ELSE MDOUT.DEST_NM                                                                                                       " & vbNewLine _
                                             & " END              AS DEST_NM                                                                                                   " & vbNewLine _
                                             & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_AD_1                                                                             " & vbNewLine _
                                             & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_AD_1                                                                   " & vbNewLine _
                                             & "      ELSE MDOUT.AD_1                                                                                                          " & vbNewLine _
                                             & " END              AS DEST_AD_1                                                                                                 " & vbNewLine _
                                             & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_AD_2                                                                             " & vbNewLine _
                                             & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_AD_2                                                                   " & vbNewLine _
                                             & "      ELSE MDOUT.AD_2                                                                                                          " & vbNewLine _
                                             & " END              AS DEST_AD_2                                                                                                 " & vbNewLine _
                                             & ",OUTL.DEST_AD_3   AS DEST_AD_3                                                                                                 " & vbNewLine _
                                             & ",OUTL.DEST_TEL    AS DEST_TEL                                                                                                  " & vbNewLine _
                                             & ",OUTL.OUTKA_PLAN_DATE   AS OUTKA_PLAN_DATE                                                                                     " & vbNewLine _
                                             & ",OUTL.CUST_ORD_NO       AS CUST_ORD_NO                                                                                         " & vbNewLine _
                                             & ",OUTL.BUYER_ORD_NO      AS BUYER_ORD_NO                                                                                        " & vbNewLine _
                                             & ",MUCO.UNSOCO_NM         AS UNSOCO_NM                                                                                           " & vbNewLine _
                                             & ",OUTL.ARR_PLAN_DATE     AS ARR_PLAN_DATE                                                                                       " & vbNewLine _
                                             & ",KBN1.KBN_NM1           AS ARR_PLAN_TIME                                                                                       " & vbNewLine _
                                             & ",OUTL.OUTKA_NO_L        AS OUTKA_NO_L                                                                                          " & vbNewLine _
                                             & "--20150709                                                                                             " & vbNewLine _
                                             & ",CASE WHEN MDOUTU.DEST_NM IS NULL THEN MDTOKUI.DEST_NM                                                                                             " & vbNewLine _
                                             & " ELSE MDOUTU.DEST_NM    END     AS URIG_NM                                                                                            " & vbNewLine _
                                             & "                                                                                          " & vbNewLine _
                                             & "--20150709                                                                                          " & vbNewLine _
                                             & ",MC.CUST_NM_L           AS CUST_NM_L                                                                                           " & vbNewLine _
                                             & "--(2012.06.15) 要望番号1155 -- START --                                                                                        " & vbNewLine _
                                             & ",MC.CUST_NM_M           AS CUST_NM_M                                                                                           " & vbNewLine _
                                             & "--(2012.06.15) 要望番号1155 --  END  --                                                                                        " & vbNewLine _
                                             & ",MC.AD_1                AS CUST_AD_1                                                                                           " & vbNewLine _
                                             & ",MC.AD_2                AS CUST_AD_2                                                                                           " & vbNewLine _
                                             & ",MC.TEL                 AS CUST_TEL                                                                                            " & vbNewLine _
                                             & ",MC.DENPYO_NM           AS DENPYO_NM                                                                                            " & vbNewLine _
                                             & ",MNRS.NRS_BR_NM         AS NRS_BR_NM                                                                                           " & vbNewLine _
                                             & ",CASE WHEN MSO.WH_KB = '01' THEN MSO.AD_1                                                                             " & vbNewLine _
                                             & "      ELSE MNRS.AD_1                                                                                                          " & vbNewLine _
                                             & " END              AS NRS_BR_AD1                                                                                                 " & vbNewLine _
                                             & ",CASE WHEN MSO.WH_KB = '01' THEN MSO.AD_2                                                                             " & vbNewLine _
                                             & "      ELSE MNRS.AD_2                                                                                                          " & vbNewLine _
                                             & " END              AS NRS_BR_AD2                                                                                                 " & vbNewLine _
                                             & ",CASE WHEN MSO.WH_KB = '01' THEN MSO.TEL                                                                             " & vbNewLine _
                                             & "      ELSE MNRS.TEL                                                                                                          " & vbNewLine _
                                             & " END              AS NRS_BR_TEL                                                                                                 " & vbNewLine _
                                             & ",CASE WHEN MSO.WH_KB = '01' THEN MSO.FAX                                                                             " & vbNewLine _
                                             & "      ELSE MNRS.FAX                                                                                                          " & vbNewLine _
                                             & " END              AS NRS_BR_FAX                                                                                                 " & vbNewLine _
                                             & ",MUSER.USER_NM          AS PIC                                                                                                 " & vbNewLine _
                                             & ",OUTM.OUTKA_NO_M        AS OUTKA_NO_M                                                                                          " & vbNewLine _
                                             & ",OUTS.OUTKA_NO_S        AS OUTKA_NO_S                                                                                          " & vbNewLine _
                                             & ",CASE WHEN MGD.SET_NAIYO = '1' THEN ''                                                                                         " & vbNewLine _
                                             & "      WHEN INL.INKA_STATE_KB < '50' THEN INL.INKA_DATE                                                                         " & vbNewLine _
                                             & "      WHEN INL.INKA_STATE_KB >= '50' THEN ZAI.INKO_DATE                                                                        " & vbNewLine _
                                             & "      ELSE ''                                                                                                                  " & vbNewLine _
                                             & " END                    AS INKA_DATE                                                                                           " & vbNewLine _
                                             & ",ZAI.REMARK_OUT         AS REMARK_OUT                                                                                          " & vbNewLine _
                                             & ",CASE WHEN (MDGE.GOODS_NM IS NOT NULL AND MDGE.GOODS_NM <> '' AND EDIL.OUTKA_CTL_NO IS NOT NULL) THEN MDGE.GOODS_NM            " & vbNewLine _
                                             & "      WHEN (MDGL.GOODS_NM IS NOT NULL AND MDGL.GOODS_NM <> '' AND EDIL.OUTKA_CTL_NO IS NULL) THEN MDGL.GOODS_NM                " & vbNewLine _
                                             & "      ELSE MG.GOODS_NM_1                                                                                                       " & vbNewLine _
                                             & " END                    AS GOODS_NM_1                                                                                          " & vbNewLine _
                                             & ",OUTS.LOT_NO            AS LOT_NO                                                                                              " & vbNewLine _
                                             & ",OUTS.SERIAL_NO         AS SERIAL_NO                                                                                           " & vbNewLine _
                                             & ",OUTS.IRIME             AS IRIME                                                                                               " & vbNewLine _
                                             & ",MG.PKG_NB              AS PKG_NB                                                                                              " & vbNewLine _
                                             & ",OUTS.ALCTD_NB / MG.PKG_NB     AS KONSU                                                                                        " & vbNewLine _
                                             & ",OUTS.ALCTD_NB % MG.PKG_NB     AS HASU                                                                                         " & vbNewLine _
                                             & ",OUTS.ALCTD_NB          AS ALCTD_NB                                                                                            " & vbNewLine _
                                             & ",MG.PKG_UT              AS PKG_UT                                                                                              " & vbNewLine _
                                             & ",KBN5.KBN_NM1           AS PKG_UT_NM                                                                                           " & vbNewLine _
                                             & ",OUTS.ALCTD_QT          AS ALCTD_QT                                                                                            " & vbNewLine _
                                             & ",MG.STD_IRIME_UT        AS IRIME_UT                                                                                            " & vbNewLine _
                                             & "--(2012.10.01)要望番号1445 -- START --                                                                                         " & vbNewLine _
                                             & ",UL.UNSO_WT             AS WT                                                                                                  " & vbNewLine _
                                             & "--,OUTS.BETU_WT * OUTS.ALCTD_NB  AS WT                                                                                         " & vbNewLine _
                                             & "--(2012.10.01)要望番号1445 --  END  --                                                                                         " & vbNewLine _
                                             & ",0                      AS UNSO_WT                                                                                             " & vbNewLine _
                                             & ",OUTS.TOU_NO            AS TOU_NO                                                                                              " & vbNewLine _
                                             & ",OUTS.SITU_NO           AS SITU_NO                                                                                             " & vbNewLine _
                                             & ",RTRIM(OUTS.ZONE_CD)     AS ZONE_CD                                                                                             " & vbNewLine _
                                             & ",OUTS.LOCA              AS LOCA                                                                                                " & vbNewLine _
                                             & ",OUTS.ALCTD_CAN_NB / MG.PKG_NB   AS ZAN_KONSU                                                                                  " & vbNewLine _
                                             & ",OUTS.ALCTD_CAN_NB % MG.PKG_NB   AS ZAN_HASU                                                                                   " & vbNewLine _
                                             & ",MG.GOODS_CD_CUST       AS GOODS_CD_CUST                                                                                       " & vbNewLine _
                                             & ",OUTM.REMARK            AS REMARK_M                                                                                            " & vbNewLine _
                                             & "--★★★変更開始--------------------------------                                                                                     " & vbNewLine _
                                             & "--(2015.09.11)エクシング対応START                                                                                     " & vbNewLine _
                                             & ",UL.UNSO_NO_L   AS CUST_NM_S                                                                                           " & vbNewLine _
                                             & "--,''   AS CUST_NM_S                                                                                           " & vbNewLine _
                                             & "--(2015.09.11)エクシング対応END                                                                                     " & vbNewLine _
                                             & ",''   AS CUST_NM_S_H                                                                                           " & vbNewLine _
                                             & "--★★★変更終了--------------------------------                                                                                     " & vbNewLine _
                                             & ",OUTM.CUST_ORD_NO_DTL   AS CUST_ORD_NO_DTL                                                                                     " & vbNewLine _
                                             & ",OUTL.REMARK            AS OUTKA_REMARK                                                                                        " & vbNewLine _
                                             & ",UL.REMARK              AS HAISOU_REMARK                                                                                       " & vbNewLine _
                                             & ",OUTL.NHS_REMARK        AS NHS_REMARK                                                                                          " & vbNewLine _
                                             & "--(2012.08.06) 発JIS、着JISが共に同じJISでも、必ず0㎞になるのを修正  --- START ---                                             " & vbNewLine _
                                             & "--,CASE WHEN (OUTL.DEST_KB = '02' AND MDEDI.KYORI > 0) THEN MDEDI.KYORI                                                        " & vbNewLine _
                                             & "--      WHEN (OUTL.DEST_KB = '02' AND MDEDI.KYORI = 0 AND EDIL.DEST_JIS_CD < MSO.JIS_CD) THEN MKY3.KYORI                       " & vbNewLine _
                                             & "--      WHEN (OUTL.DEST_KB = '02' AND MDEDI.KYORI = 0 AND MSO.JIS_CD < EDIL.DEST_JIS_CD) THEN MKY4.KYORI                       " & vbNewLine _
                                             & "--      WHEN (OUTL.DEST_KB <> '02' AND MDOUT.KYORI > 0) THEN MDOUT.KYORI                                                       " & vbNewLine _
                                             & "--      WHEN (OUTL.DEST_KB <> '02' AND MDOUT.KYORI = 0 AND MDOUT.JIS < MSO.JIS_CD) THEN MKY1.KYORI                             " & vbNewLine _
                                             & "--      WHEN (OUTL.DEST_KB <> '02' AND MDOUT.KYORI = 0 AND MSO.JIS_CD < MDOUT.JIS) THEN MKY2.KYORI                             " & vbNewLine _
                                             & "--      ELSE 0                                                                                                                 " & vbNewLine _
                                             & "-- END                  AS KYORI                                                                                               " & vbNewLine _
                                             & ",CASE WHEN (OUTL.DEST_KB = '02' AND MDEDI.KYORI > 0) THEN MDEDI.KYORI                                                          " & vbNewLine _
                                             & "      WHEN (OUTL.DEST_KB = '02' AND MDEDI.KYORI = 0 AND EDIL.DEST_JIS_CD <= MSO.JIS_CD) THEN MKY3.KYORI                        " & vbNewLine _
                                             & "      WHEN (OUTL.DEST_KB = '02' AND MDEDI.KYORI = 0 AND MSO.JIS_CD <= EDIL.DEST_JIS_CD) THEN MKY4.KYORI                        " & vbNewLine _
                                             & "      WHEN (OUTL.DEST_KB <> '02' AND MDOUT.KYORI > 0) THEN MDOUT.KYORI                                                         " & vbNewLine _
                                             & "      WHEN (OUTL.DEST_KB <> '02' AND MDOUT.KYORI = 0 AND MDOUT.JIS <= MSO.JIS_CD) THEN MKY1.KYORI                              " & vbNewLine _
                                             & "      WHEN (OUTL.DEST_KB <> '02' AND MDOUT.KYORI = 0 AND MSO.JIS_CD <= MDOUT.JIS) THEN MKY2.KYORI                              " & vbNewLine _
                                             & "      ELSE 0                                                                                                                   " & vbNewLine _
                                             & " END                    AS KYORI                                                                                               " & vbNewLine _
                                             & "--(2012.08.06) 発JIS、着JISが共に同じJISでも、必ず0㎞になるのを修正  ---  END  ---                                             " & vbNewLine _
                                             & ",OUTL.OUTKA_PKG_NB      AS OUTKA_PKG_NB_L                                                                                      " & vbNewLine _
                                             & ",KBN2.KBN_NM1           AS SOKO_NM                                                                                             " & vbNewLine _
                                             & ",KBN3.KBN_NM1           AS BUSHO_NM                                                                                            " & vbNewLine _
                                             & ",KBN4.KBN_NM1           AS NRS_BR_NM_NICHI                                                                                     " & vbNewLine _
                                             & ",OUTS.ALCTD_CAN_QT      AS ALCTD_CAN_QT                                                                                        " & vbNewLine _
                                             & ",OUTM.ALCTD_KB          AS ALCTD_KB                                                                                            " & vbNewLine _
                                             & ",'0'                    AS PTN_FLAG                                                                                            " & vbNewLine _
                                             & ",OUTL.CUST_CD_L         AS CUST_CD_L                                                                                           " & vbNewLine _
                                             & ",OUTL.ORDER_TYPE        AS ORDER_TYPE                                                                                          " & vbNewLine _
                                             & ",ZAI.LT_DATE                                                                                                                   " & vbNewLine _
                                             & ",OUTM.BUYER_ORD_NO_DTL AS BUYER_ORD_NO_DTL                                                                                     " & vbNewLine _
                                             & ",ZAI.GOODS_COND_KB_2 AS GOODS_COND_CD                                                                                          " & vbNewLine _
                                             & ",ZAI.REMARK AS REMARK_ZAI                                                                                                      " & vbNewLine _
                                             & ",KBN6.KBN_NM2 AS TITLE_SMPL                                                                                                    " & vbNewLine _
                                             & ",OUTS.ALCTD_CAN_NB AS ALCTD_CAN_NB                                                                                             " & vbNewLine _
                                             & ",OUTM.BACKLOG_QT                                                                                                               " & vbNewLine _
                                             & ",KBN7.KBN_NM2 AS DOKU_NM                                                                                                       " & vbNewLine _
                                             & "--【要望番号995】　2012/04/17　元着払い区分　START                                                                             " & vbNewLine _
                                             & ",KBN9.KBN_NM2 AS PC_KB_NM                                                                                                      " & vbNewLine _
                                             & "--【要望番号995】　2012/04/17　元着払い区分　 END                                                                              " & vbNewLine _
                                             & "--日医工対策開始                                                                                                               " & vbNewLine _
                                             & ",EDIL.FREE_C01           AS TORI_KB                                                                                            " & vbNewLine _
                                             & "--★追加開始20150709                                                                                                         " & vbNewLine _
                                             & "    ,CASE WHEN OUTL.SHIP_CD_L IS NULL THEN MDTOKUI.DEST_CD                                                                                     " & vbNewLine _
                                             & "   ELSE OUTL.SHIP_CD_L END AS SHIP_CD_L                                                                                      " & vbNewLine _
                                             & "--★追加終了20150709                                                                                                         " & vbNewLine _
                                             & "--★削除開始2012/05/11                                                                                                         " & vbNewLine _
                                             & "--,EDIL.SHIP_NM_L          AS CHOKUSO_NM1                                                                                      " & vbNewLine _
                                             & "--,EDIL.FREE_C11           AS CHOKUSO_CD                                                                                       " & vbNewLine _
                                             & "--,EDIL.FREE_C08           AS HAKKO_DATE                                                                                       " & vbNewLine _
                                             & "--★削除終了2012/05/11                                                                                                         " & vbNewLine _
                                             & ",MCD_N.SET_NAIYO         AS SET_NAIYO_4                                                                                        " & vbNewLine _
                                             & ",MCD_N.SET_NAIYO_2       AS SET_NAIYO_5                                                                                        " & vbNewLine _
                                             & ",MCD_N.SET_NAIYO_3       AS SET_NAIYO_6                                                                                        " & vbNewLine _
                                             & ",MG.GOODS_NM_2           AS GOODS_NM_2                                                                                         " & vbNewLine _
                                             & ",EDIM.FREE_C02           AS KICHO_KB                                                                                           " & vbNewLine _
                                             & ",EDIM.FREE_C03           AS SEI_YURAI_KB                                                                                       " & vbNewLine _
                                             & ",EDIM.FREE_C04           AS REMARK_UPPER      --群馬篠崎運送利用                                                               " & vbNewLine _
                                             & ",EDIM.FREE_C05           AS REMARK_LOWER                                                                                       " & vbNewLine _
                                             & ",EDIM.FREE_C06           AS GOODS_SYUBETU     --群馬篠崎運送利用                                                               " & vbNewLine _
                                             & ",EDIM.FREE_C01           AS YUKOU_KIGEN                                                                                        " & vbNewLine _
                                             & ",MG.GOODS_NM_3           AS GOODS_NM_3         --2012/05/23                                                                    " & vbNewLine _
                                             & ",MDOUTU.EDI_CD           AS EDISHIP_CD         --2012/05/23                                                                    " & vbNewLine _
                                             & ",MDOUT.EDI_CD            AS EDIDEST_CD         --2012/05/23                                                                    " & vbNewLine _
                                             & "--日医工対策終了                                                                                                               " & vbNewLine _
                                             & "--(2012.06.01) 日本ﾌｧｲﾝ対応  --- START ---                                                                                     " & vbNewLine _
                                             & ",MCD_F.SET_NAIYO         AS SET_NAIYO_FROM1                                                                                    " & vbNewLine _
                                             & ",MCD_F.SET_NAIYO_2       AS SET_NAIYO_FROM2                                                                                    " & vbNewLine _
                                             & ",MCD_F.SET_NAIYO_3       AS SET_NAIYO_FROM3                                                                                    " & vbNewLine _
                                             & "--(2012.06.01) 日本ﾌｧｲﾝ対応  --- START ---                                                                                     " & vbNewLine _
                                             & "--【要望番号1122】埼玉対応 --- START ---                                                                                       " & vbNewLine _
                                             & ",MC.AD_3                 AS CUST_AD_3                                                                                          " & vbNewLine _
                                             & ",MDOUT.REMARK            AS DEST_REMARK                                                                                        " & vbNewLine _
                                             & ",MDOUT.SALES_CD          AS DEST_SALES_CD                                                                                      " & vbNewLine _
                                             & ",MC_SALES.CUST_NM_L      AS DEST_SALES_NM                                                                                      " & vbNewLine _
                                             & ",MC_SALES.AD_1           AS DEST_SALES_AD_1                                                                                    " & vbNewLine _
                                             & ",MC_SALES.AD_2           AS DEST_SALES_AD_2                                                                                    " & vbNewLine _
                                             & ",MC_SALES.AD_3           AS DEST_SALES_AD_3                                                                                    " & vbNewLine _
                                             & ",MC_SALES.TEL            AS DEST_SALES_TEL                                                                                     " & vbNewLine _
                                             & "--【要望番号1122】埼玉対応 ---  END  ---                                                                                       " & vbNewLine _
                                             & "--群馬篠崎運送向け自由項目対応　開始　                                                                                         " & vbNewLine _
                                             & ",EDIM.FREE_C07           AS SZ01_YUSO --篠崎                                                                                   " & vbNewLine _
                                             & ",EDIM.FREE_C09           AS SZ01_UNSO --篠崎                                                                                   " & vbNewLine _
                                             & "--群馬篠崎運送向け自由項目対応　終了                                                                                         　" & vbNewLine _
                                             & ",ISNULL(MG.SHOBO_CD,'')  AS SHOBO_CD                                                                                           " & vbNewLine

#If True Then   'ADD 2020/01/15 009792【LMS】RD帳票作成_アンファー:送り状・納品書亜種
    ''' <summary>
    ''' 印刷データ抽出用(出荷テーブル)
    ''' </summary>
    ''' <remarks></remarks>
    Friend Const SQL_SELECT_OUTKA_854 As String = "--★★★SQL_SELECT_OUTKA★★★  出荷テーブル                                                                                                                 " & vbNewLine _
                                             & "SELECT                                                                                                                         " & vbNewLine _
                                             & " CASE WHEN MR2.PTN_CD IS NOT NULL THEN MR2.RPT_ID                                                                              " & vbNewLine _
                                             & "      WHEN MR1.PTN_CD IS NOT NULL THEN MR1.RPT_ID                                                                              " & vbNewLine _
                                             & "      ELSE MR3.RPT_ID                                                                                                          " & vbNewLine _
                                             & " END              AS RPT_ID                                                                                                    " & vbNewLine _
                                             & ",OUTL.NRS_BR_CD   AS NRS_BR_CD                                                                                                 " & vbNewLine _
                                             & ",OUTM.PRINT_SORT  AS PRINT_SORT                                                                                                " & vbNewLine _
                                             & ",CASE WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_CD                                                                     " & vbNewLine _
                                             & "      ELSE OUTL.DEST_CD                                                                                                        " & vbNewLine _
                                             & " END              AS DEST_CD                                                                                                   " & vbNewLine _
                                             & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_NM                                                                               " & vbNewLine _
                                             & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_NM                                                                     " & vbNewLine _
                                             & "      ELSE MDOUT.DEST_NM                                                                                                       " & vbNewLine _
                                             & " END              AS DEST_NM                                                                                                   " & vbNewLine _
                                             & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_AD_1                                                                             " & vbNewLine _
                                             & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_AD_1                                                                   " & vbNewLine _
                                             & "      ELSE MDOUT.AD_1                                                                                                          " & vbNewLine _
                                             & " END              AS DEST_AD_1                                                                                                 " & vbNewLine _
                                             & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_AD_2                                                                             " & vbNewLine _
                                             & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_AD_2                                                                   " & vbNewLine _
                                             & "      ELSE MDOUT.AD_2                                                                                                          " & vbNewLine _
                                             & " END              AS DEST_AD_2                                                                                                 " & vbNewLine _
                                             & ",OUTL.DEST_AD_3   AS DEST_AD_3                                                                                                 " & vbNewLine _
                                             & ",OUTL.DEST_TEL    AS DEST_TEL                                                                                                  " & vbNewLine _
                                             & ",OUTL.OUTKA_PLAN_DATE   AS OUTKA_PLAN_DATE                                                                                     " & vbNewLine _
                                             & ",OUTL.CUST_ORD_NO       AS CUST_ORD_NO                                                                                         " & vbNewLine _
                                             & ",OUTL.BUYER_ORD_NO      AS BUYER_ORD_NO                                                                                        " & vbNewLine _
                                             & ",MUCO.UNSOCO_NM         AS UNSOCO_NM                                                                                           " & vbNewLine _
                                             & ",OUTL.ARR_PLAN_DATE     AS ARR_PLAN_DATE                                                                                       " & vbNewLine _
                                             & ",KBN1.KBN_NM1           AS ARR_PLAN_TIME                                                                                       " & vbNewLine _
                                             & ",OUTL.OUTKA_NO_L        AS OUTKA_NO_L                                                                                          " & vbNewLine _
                                             & ",CASE WHEN MDOUTU.DEST_NM IS NULL THEN MDTOKUI.DEST_NM                                                                                             " & vbNewLine _
                                             & " ELSE MDOUTU.DEST_NM    END     AS URIG_NM                                                                                            " & vbNewLine _
                                             & ",CASE WHEN MGD2.GOODS_CD_NRS IS NULL                                                                                           " & vbNewLine _
                                             & "       THEN MC.CUST_NM_L                                                                                                       " & vbNewLine _
                                             & "	   ELSE MGD2.SET_NAIYO                                                                                                     " & vbNewLine _
                                             & " END AS           CUST_NM_L                                                                                                    " & vbNewLine _
                                             & ",CASE WHEN MGD2.GOODS_CD_NRS IS NULL                                                                                           " & vbNewLine _
                                             & "       THEN MC.CUST_NM_M                                                                                                       " & vbNewLine _
                                             & "	   ELSE ''                                                                                                                 " & vbNewLine _
                                             & " END AS           CUST_NM_M                                                                                                    " & vbNewLine _
                                             & ",MC.AD_1                AS CUST_AD_1                                                                                           " & vbNewLine _
                                             & ",MC.AD_2                AS CUST_AD_2                                                                                           " & vbNewLine _
                                             & ",CASE WHEN MGD2.GOODS_CD_NRS IS NULL                                                                                           " & vbNewLine _
                                             & "       THEN MC.TEL                                                                                                             " & vbNewLine _
                                             & "       ELSE MGD2.REMARK                                                                                                        " & vbNewLine _
                                             & " END AS           CUST_TEL                                                                                                     " & vbNewLine _
                                             & ",MC.DENPYO_NM           AS DENPYO_NM                                                                                            " & vbNewLine _
                                             & ",MNRS.NRS_BR_NM         AS NRS_BR_NM                                                                                           " & vbNewLine _
                                             & ",CASE WHEN MSO.WH_KB = '01' THEN MSO.AD_1                                                                             " & vbNewLine _
                                             & "      ELSE MNRS.AD_1                                                                                                          " & vbNewLine _
                                             & " END              AS NRS_BR_AD1                                                                                                 " & vbNewLine _
                                             & ",CASE WHEN MSO.WH_KB = '01' THEN MSO.AD_2                                                                             " & vbNewLine _
                                             & "      ELSE MNRS.AD_2                                                                                                          " & vbNewLine _
                                             & " END              AS NRS_BR_AD2                                                                                                 " & vbNewLine _
                                             & ",CASE WHEN MSO.WH_KB = '01' THEN MSO.TEL                                                                             " & vbNewLine _
                                             & "      ELSE MNRS.TEL                                                                                                          " & vbNewLine _
                                             & " END              AS NRS_BR_TEL                                                                                                 " & vbNewLine _
                                             & ",CASE WHEN MSO.WH_KB = '01' THEN MSO.FAX                                                                             " & vbNewLine _
                                             & "      ELSE MNRS.FAX                                                                                                          " & vbNewLine _
                                             & " END              AS NRS_BR_FAX                                                                                                 " & vbNewLine _
                                             & ",MUSER.USER_NM          AS PIC                                                                                                 " & vbNewLine _
                                             & ",OUTM.OUTKA_NO_M        AS OUTKA_NO_M                                                                                          " & vbNewLine _
                                             & ",OUTS.OUTKA_NO_S        AS OUTKA_NO_S                                                                                          " & vbNewLine _
                                             & ",CASE WHEN MGD.SET_NAIYO = '1' THEN ''                                                                                         " & vbNewLine _
                                             & "      WHEN INL.INKA_STATE_KB < '50' THEN INL.INKA_DATE                                                                         " & vbNewLine _
                                             & "      WHEN INL.INKA_STATE_KB >= '50' THEN ZAI.INKO_DATE                                                                        " & vbNewLine _
                                             & "      ELSE ''                                                                                                                  " & vbNewLine _
                                             & " END                    AS INKA_DATE                                                                                           " & vbNewLine _
                                             & ",ZAI.REMARK_OUT         AS REMARK_OUT                                                                                          " & vbNewLine _
                                             & ",CASE WHEN (MDGE.GOODS_NM IS NOT NULL AND MDGE.GOODS_NM <> '' AND EDIL.OUTKA_CTL_NO IS NOT NULL) THEN MDGE.GOODS_NM            " & vbNewLine _
                                             & "      WHEN (MDGL.GOODS_NM IS NOT NULL AND MDGL.GOODS_NM <> '' AND EDIL.OUTKA_CTL_NO IS NULL) THEN MDGL.GOODS_NM                " & vbNewLine _
                                             & "      ELSE MG.GOODS_NM_1                                                                                                       " & vbNewLine _
                                             & " END                    AS GOODS_NM_1                                                                                          " & vbNewLine _
                                             & ",OUTS.LOT_NO            AS LOT_NO                                                                                              " & vbNewLine _
                                             & ",OUTS.SERIAL_NO         AS SERIAL_NO                                                                                           " & vbNewLine _
                                             & ",OUTS.IRIME             AS IRIME                                                                                               " & vbNewLine _
                                             & ",MG.PKG_NB              AS PKG_NB                                                                                              " & vbNewLine _
                                             & ",OUTS.ALCTD_NB / MG.PKG_NB     AS KONSU                                                                                        " & vbNewLine _
                                             & ",OUTS.ALCTD_NB % MG.PKG_NB     AS HASU                                                                                         " & vbNewLine _
                                             & ",OUTS.ALCTD_NB          AS ALCTD_NB                                                                                            " & vbNewLine _
                                             & ",MG.PKG_UT              AS PKG_UT                                                                                              " & vbNewLine _
                                             & ",KBN5.KBN_NM1           AS PKG_UT_NM                                                                                           " & vbNewLine _
                                             & ",OUTS.ALCTD_QT          AS ALCTD_QT                                                                                            " & vbNewLine _
                                             & ",MG.STD_IRIME_UT        AS IRIME_UT                                                                                            " & vbNewLine _
                                             & ",UL.UNSO_WT             AS WT                                                                                                  " & vbNewLine _
                                             & ",0                      AS UNSO_WT                                                                                             " & vbNewLine _
                                             & ",OUTS.TOU_NO            AS TOU_NO                                                                                              " & vbNewLine _
                                             & ",OUTS.SITU_NO           AS SITU_NO                                                                                             " & vbNewLine _
                                             & ",RTRIM(OUTS.ZONE_CD)     AS ZONE_CD                                                                                             " & vbNewLine _
                                             & ",OUTS.LOCA              AS LOCA                                                                                                " & vbNewLine _
                                             & ",OUTS.ALCTD_CAN_NB / MG.PKG_NB   AS ZAN_KONSU                                                                                  " & vbNewLine _
                                             & ",OUTS.ALCTD_CAN_NB % MG.PKG_NB   AS ZAN_HASU                                                                                   " & vbNewLine _
                                             & ",MG.GOODS_CD_CUST       AS GOODS_CD_CUST                                                                                       " & vbNewLine _
                                             & ",OUTM.REMARK            AS REMARK_M                                                                                            " & vbNewLine _
                                             & ",UL.UNSO_NO_L   AS CUST_NM_S                                                                                           " & vbNewLine _
                                             & ",''   AS CUST_NM_S_H                                                                                           " & vbNewLine _
                                             & ",OUTM.CUST_ORD_NO_DTL   AS CUST_ORD_NO_DTL                                                                                     " & vbNewLine _
                                             & ",OUTL.REMARK            AS OUTKA_REMARK                                                                                        " & vbNewLine _
                                             & ",UL.REMARK              AS HAISOU_REMARK                                                                                       " & vbNewLine _
                                             & ",OUTL.NHS_REMARK        AS NHS_REMARK                                                                                          " & vbNewLine _
                                             & ",CASE WHEN (OUTL.DEST_KB = '02' AND MDEDI.KYORI > 0) THEN MDEDI.KYORI                                                          " & vbNewLine _
                                             & "      WHEN (OUTL.DEST_KB = '02' AND MDEDI.KYORI = 0 AND EDIL.DEST_JIS_CD <= MSO.JIS_CD) THEN MKY3.KYORI                        " & vbNewLine _
                                             & "      WHEN (OUTL.DEST_KB = '02' AND MDEDI.KYORI = 0 AND MSO.JIS_CD <= EDIL.DEST_JIS_CD) THEN MKY4.KYORI                        " & vbNewLine _
                                             & "      WHEN (OUTL.DEST_KB <> '02' AND MDOUT.KYORI > 0) THEN MDOUT.KYORI                                                         " & vbNewLine _
                                             & "      WHEN (OUTL.DEST_KB <> '02' AND MDOUT.KYORI = 0 AND MDOUT.JIS <= MSO.JIS_CD) THEN MKY1.KYORI                              " & vbNewLine _
                                             & "      WHEN (OUTL.DEST_KB <> '02' AND MDOUT.KYORI = 0 AND MSO.JIS_CD <= MDOUT.JIS) THEN MKY2.KYORI                              " & vbNewLine _
                                             & "      ELSE 0                                                                                                                   " & vbNewLine _
                                             & " END                    AS KYORI                                                                                               " & vbNewLine _
                                             & ",OUTL.OUTKA_PKG_NB      AS OUTKA_PKG_NB_L                                                                                      " & vbNewLine _
                                             & ",KBN2.KBN_NM1           AS SOKO_NM                                                                                             " & vbNewLine _
                                             & ",KBN3.KBN_NM1           AS BUSHO_NM                                                                                            " & vbNewLine _
                                             & ",KBN4.KBN_NM1           AS NRS_BR_NM_NICHI                                                                                     " & vbNewLine _
                                             & ",OUTS.ALCTD_CAN_QT      AS ALCTD_CAN_QT                                                                                        " & vbNewLine _
                                             & ",OUTM.ALCTD_KB          AS ALCTD_KB                                                                                            " & vbNewLine _
                                             & ",'0'                    AS PTN_FLAG                                                                                            " & vbNewLine _
                                             & ",OUTL.CUST_CD_L         AS CUST_CD_L                                                                                           " & vbNewLine _
                                             & ",OUTL.ORDER_TYPE        AS ORDER_TYPE                                                                                          " & vbNewLine _
                                             & ",ZAI.LT_DATE                                                                                                                   " & vbNewLine _
                                             & ",OUTM.BUYER_ORD_NO_DTL AS BUYER_ORD_NO_DTL                                                                                     " & vbNewLine _
                                             & ",ZAI.GOODS_COND_KB_2 AS GOODS_COND_CD                                                                                          " & vbNewLine _
                                             & ",ZAI.REMARK AS REMARK_ZAI                                                                                                      " & vbNewLine _
                                             & ",KBN6.KBN_NM2 AS TITLE_SMPL                                                                                                    " & vbNewLine _
                                             & ",OUTS.ALCTD_CAN_NB AS ALCTD_CAN_NB                                                                                             " & vbNewLine _
                                             & ",OUTM.BACKLOG_QT                                                                                                               " & vbNewLine _
                                             & ",KBN7.KBN_NM2 AS DOKU_NM                                                                                                       " & vbNewLine _
                                             & ",KBN9.KBN_NM2 AS PC_KB_NM                                                                                                      " & vbNewLine _
                                             & ",EDIL.FREE_C01           AS TORI_KB                                                                                            " & vbNewLine _
                                             & "    ,CASE WHEN OUTL.SHIP_CD_L IS NULL THEN MDTOKUI.DEST_CD                                                                                     " & vbNewLine _
                                             & "   ELSE OUTL.SHIP_CD_L END AS SHIP_CD_L                                                                                      " & vbNewLine _
                                             & ",MCD_N.SET_NAIYO         AS SET_NAIYO_4                                                                                        " & vbNewLine _
                                             & ",MCD_N.SET_NAIYO_2       AS SET_NAIYO_5                                                                                        " & vbNewLine _
                                             & ",MCD_N.SET_NAIYO_3       AS SET_NAIYO_6                                                                                        " & vbNewLine _
                                             & ",MG.GOODS_NM_2           AS GOODS_NM_2                                                                                         " & vbNewLine _
                                             & ",EDIM.FREE_C02           AS KICHO_KB                                                                                           " & vbNewLine _
                                             & ",EDIM.FREE_C03           AS SEI_YURAI_KB                                                                                       " & vbNewLine _
                                             & ",EDIM.FREE_C04           AS REMARK_UPPER      --群馬篠崎運送利用                                                               " & vbNewLine _
                                             & ",EDIM.FREE_C05           AS REMARK_LOWER                                                                                       " & vbNewLine _
                                             & ",EDIM.FREE_C06           AS GOODS_SYUBETU     --群馬篠崎運送利用                                                               " & vbNewLine _
                                             & ",EDIM.FREE_C01           AS YUKOU_KIGEN                                                                                        " & vbNewLine _
                                             & ",MG.GOODS_NM_3           AS GOODS_NM_3         --2012/05/23                                                                    " & vbNewLine _
                                             & ",MDOUTU.EDI_CD           AS EDISHIP_CD         --2012/05/23                                                                    " & vbNewLine _
                                             & ",MDOUT.EDI_CD            AS EDIDEST_CD         --2012/05/23                                                                    " & vbNewLine _
                                             & ",MCD_F.SET_NAIYO         AS SET_NAIYO_FROM1                                                                                    " & vbNewLine _
                                             & ",MCD_F.SET_NAIYO_2       AS SET_NAIYO_FROM2                                                                                    " & vbNewLine _
                                             & ",MCD_F.SET_NAIYO_3       AS SET_NAIYO_FROM3                                                                                    " & vbNewLine _
                                             & ",MC.AD_3                 AS CUST_AD_3                                                                                          " & vbNewLine _
                                             & ",MDOUT.REMARK            AS DEST_REMARK                                                                                        " & vbNewLine _
                                             & ",MDOUT.SALES_CD          AS DEST_SALES_CD                                                                                      " & vbNewLine _
                                             & ",MC_SALES.CUST_NM_L      AS DEST_SALES_NM                                                                                      " & vbNewLine _
                                             & ",MC_SALES.AD_1           AS DEST_SALES_AD_1                                                                                    " & vbNewLine _
                                             & ",MC_SALES.AD_2           AS DEST_SALES_AD_2                                                                                    " & vbNewLine _
                                             & ",MC_SALES.AD_3           AS DEST_SALES_AD_3                                                                                    " & vbNewLine _
                                             & ",MC_SALES.TEL            AS DEST_SALES_TEL                                                                                     " & vbNewLine _
                                             & ",EDIM.FREE_C07           AS SZ01_YUSO --篠崎                                                                                   " & vbNewLine _
                                             & ",EDIM.FREE_C09           AS SZ01_UNSO --篠崎                                                                                   " & vbNewLine _
                                             & ",ISNULL(MG.SHOBO_CD,'')  AS SHOBO_CD                                                                                           " & vbNewLine

#End If
    ''' <summary>
    ''' 印刷データ抽出用(出荷テーブル:FROM句)
    ''' </summary>
    ''' <remarks></remarks>
    Friend Const SQL_FROM_OUTKA As String = "--出荷L                                                                                                                        " & vbNewLine _
                                             & "FROM                                                                                                                           " & vbNewLine _
                                             & "$LM_TRN$..C_OUTKA_L OUTL                                                                                                       " & vbNewLine _
                                             & "--トランザクションテーブル                                                                                                     " & vbNewLine _
                                             & "--出荷M                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..C_OUTKA_M OUTM                                                                                             " & vbNewLine _
                                             & "ON  OUTM.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "AND OUTM.OUTKA_NO_L = OUTL.OUTKA_NO_L                                                                                          " & vbNewLine _
                                             & "AND OUTM.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--★★★追加開始--------------------------------                                                                               " & vbNewLine _
                                             & "--出荷M(中MIN)                                                                                                                 " & vbNewLine _
                                             & "LEFT OUTER JOIN                                                                                                                " & vbNewLine _
                                             & "       (SELECT                                                                                                                 " & vbNewLine _
                                             & "           NRS_BR_CD                                                                                                           " & vbNewLine _
                                             & "           ,OUTKA_NO_L                                                                                                         " & vbNewLine _
                                             & "           ,MIN(OUTKA_NO_M) AS  OUTKA_NO_M                                                                                     " & vbNewLine _
                                             & "       FROM $LM_TRN$..C_OUTKA_M WHERE SYS_DEL_FLG ='0'                                                                         " & vbNewLine _
                                             & "        AND NRS_BR_CD = @NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "        AND OUTKA_NO_L = @KANRI_NO_L                                                                                           " & vbNewLine _
                                             & "       GROUP BY NRS_BR_CD,OUTKA_NO_L) OUTM_MIN                                                                                 " & vbNewLine _
                                             & "       ON OUTM_MIN.NRS_BR_CD        = OUTL.NRS_BR_CD                                                                           " & vbNewLine _
                                             & "       AND OUTM_MIN.OUTKA_NO_L      = OUTL.OUTKA_NO_L                                                                          " & vbNewLine _
                                             & "--出荷M(中MIN)                                                                                                                 " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..C_OUTKA_M OUTM2                                                                                            " & vbNewLine _
                                             & "ON  OUTM2.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                           " & vbNewLine _
                                             & "AND OUTM2.OUTKA_NO_L = OUTL.OUTKA_NO_L                                                                                         " & vbNewLine _
                                             & "AND OUTM2.OUTKA_NO_M = OUTM_MIN.OUTKA_NO_M                                                                                     " & vbNewLine _
                                             & "AND OUTM2.SYS_DEL_FLG = '0'                                                                                                    " & vbNewLine _
                                             & "--★★★追加終了--------------------------------                                                                               " & vbNewLine _
                                             & "--出荷S                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..C_OUTKA_S OUTS                                                                                             " & vbNewLine _
                                             & "ON  OUTS.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "AND OUTS.OUTKA_NO_L = OUTL.OUTKA_NO_L                                                                                          " & vbNewLine _
                                             & "AND OUTS.OUTKA_NO_M = OUTM.OUTKA_NO_M                                                                                          " & vbNewLine _
                                             & "AND OUTS.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--出荷EDIL                                                                                                                     " & vbNewLine _
                                             & "--(2012.09.06)要望番号1412対応  --- START ---                                                                                  " & vbNewLine _
                                             & "--LEFT JOIN                                                                                                                    " & vbNewLine _
                                             & "--(                                                                                                                            " & vbNewLine _
                                             & "--SELECT                                                                                                                       " & vbNewLine _
                                             & "-- --20120730 MIN化　開始(20120803取りやめ)                                                                                    " & vbNewLine _
                                             & "-- --MIN(NRS_BR_CD)    AS NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "-- --,MIN(OUTKA_CTL_NO) AS OUTKA_CTL_NO                                                                                        " & vbNewLine _
                                             & "-- --,MIN(CUST_CD_L)    AS CUST_CD_L                                                                                           " & vbNewLine _
                                             & "-- NRS_BR_CD                                                                                                                   " & vbNewLine _
                                             & "--,OUTKA_CTL_NO                                                                                                                " & vbNewLine _
                                             & "--,CUST_CD_L                                                                                                                   " & vbNewLine _
                                             & "-- --20120730 MIN化　終了                                                                                                      " & vbNewLine _
                                             & "----★削除開始2012/05/11                                                                                                       " & vbNewLine _
                                             & "----,SHIP_NM_L                                                                                                                 " & vbNewLine _
                                             & "----★削除終了2012/05/11                                                                                                       " & vbNewLine _
                                             & "--,MIN(DEST_CD)     AS DEST_CD                                                                                                 " & vbNewLine _
                                             & "--,MIN(DEST_NM)     AS DEST_NM                                                                                                 " & vbNewLine _
                                             & "--,MIN(DEST_AD_1)   AS DEST_AD_1                                                                                               " & vbNewLine _
                                             & "--,MIN(DEST_AD_2)   AS DEST_AD_2                                                                                               " & vbNewLine _
                                             & "----(2012.04.11)【Notes】№923  DEST_JIS_CDはMINで抽出 -- START --                                                             " & vbNewLine _
                                             & "----,DEST_JIS_CD                                                                                                               " & vbNewLine _
                                             & "--,MIN(DEST_JIS_CD) AS DEST_JIS_CD                                                                                             " & vbNewLine _
                                             & "----(2012.04.11)【Notes】№923  DEST_JIS_CDはMINで抽出 --  END  --                                                             " & vbNewLine _
                                             & "-- --20120730 MIN化　開始                                                                                                      " & vbNewLine _
                                             & "--,MIN(FREE_C01)   AS FREE_C01                                                                                                 " & vbNewLine _
                                             & "--,MIN(FREE_C08)   AS FREE_C08                                                                                                 " & vbNewLine _
                                             & "--,MIN(FREE_C11)   AS FREE_C11                                                                                                 " & vbNewLine _
                                             & "-- --20120730 MIN化　終了                                                                                                      " & vbNewLine _
                                             & "--,SYS_DEL_FLG                                                                                                                 " & vbNewLine _
                                             & "--FROM                                                                                                                         " & vbNewLine _
                                             & "--$LM_TRN$..H_OUTKAEDI_L                                                                                                       " & vbNewLine _
                                             & "--GROUP BY                                                                                                                     " & vbNewLine _
                                             & "-- --20120730 MIN化によるコメントアウト　開始 (20120803取りやめ)                                                               " & vbNewLine _
                                             & "-- NRS_BR_CD                                                                                                                   " & vbNewLine _
                                             & "--,OUTKA_CTL_NO                                                                                                                " & vbNewLine _
                                             & "--,CUST_CD_L                                                                                                                   " & vbNewLine _
                                             & "-- --20120730 MIN化によるコメントアウト　終了                                                                                  " & vbNewLine _
                                             & "----★削除開始2012/05/11                                                                                                       " & vbNewLine _
                                             & "----,SHIP_NM_L                                                                                                                 " & vbNewLine _
                                             & "----★削除開始2012/05/11                                                                                                       " & vbNewLine _
                                             & "----(2012.04.11) Notes№923  DEST_JIS_CDはMINで抽出のためコメント -- START --                                                  " & vbNewLine _
                                             & "----,DEST_JIS_CD                                                                                                               " & vbNewLine _
                                             & "----(2012.04.11) Notes№923  DEST_JIS_CDはMINで抽出のためコメント --  END  --                                                  " & vbNewLine _
                                             & "-- --20120730 MIN化によるコメントアウト　開始                                                                                  " & vbNewLine _
                                             & "----,FREE_C01                                                                                                                  " & vbNewLine _
                                             & "----,FREE_C08                                                                                                                  " & vbNewLine _
                                             & "----,FREE_C11                                                                                                                  " & vbNewLine _
                                             & "-- --20120730 MIN化によるコメントアウト　終了 ↓SYS_DEL_FLGのカンマ除去↓                                                      " & vbNewLine _
                                             & "--,SYS_DEL_FLG                                                                                                                 " & vbNewLine _
                                             & "--) EDIL                                                                                                                       " & vbNewLine _
                                             & "--ON  EDIL.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                          " & vbNewLine _
                                             & "--下記の内容に変更                                                                                                             " & vbNewLine _
                                             & " LEFT JOIN (                                                                                                                   " & vbNewLine _
                                             & "            SELECT                                                                                                             " & vbNewLine _
                                             & "                   NRS_BR_CD                                                                                                   " & vbNewLine _
                                             & "                 , EDI_CTL_NO                                                                                                  " & vbNewLine _
                                             & "                 , OUTKA_CTL_NO                                                                                                " & vbNewLine _
                                             & "             FROM (                                                                                                            " & vbNewLine _
                                             & "                    SELECT                                                                                                     " & vbNewLine _
                                             & "                           EDIOUTL.NRS_BR_CD                                                                                   " & vbNewLine _
                                             & "                         , EDIOUTL.EDI_CTL_NO                                                                                  " & vbNewLine _
                                             & "                         , EDIOUTL.OUTKA_CTL_NO                                                                                " & vbNewLine _
                                             & "                         , CASE WHEN EDIOUTL.OUTKA_CTL_NO = '' THEN 1                                                          " & vbNewLine _
                                             & "                           ELSE ROW_NUMBER() OVER (PARTITION BY EDIOUTL.NRS_BR_CD                                              " & vbNewLine _
                                             & "                                                              , EDIOUTL.OUTKA_CTL_NO                                           " & vbNewLine _
                                             & "                                                       ORDER BY EDIOUTL.NRS_BR_CD                                              " & vbNewLine _
                                             & "                                                              , EDIOUTL.EDI_CTL_NO                                             " & vbNewLine _
                                             & "                                                  )                                                                            " & vbNewLine _
                                             & "                           END AS IDX                                                                                          " & vbNewLine _
                                             & "                     FROM $LM_TRN$..H_OUTKAEDI_L EDIOUTL                                                                       " & vbNewLine _
                                             & "                    WHERE EDIOUTL.SYS_DEL_FLG  = '0'                                                                           " & vbNewLine _
                                             & "                      AND EDIOUTL.NRS_BR_CD    = @NRS_BR_CD                                                                    " & vbNewLine _
                                             & "                      AND EDIOUTL.OUTKA_CTL_NO = @KANRI_NO_L                                                                   " & vbNewLine _
                                             & "                  ) EBASE                                                                                                      " & vbNewLine _
                                             & "            WHERE EBASE.IDX = 1                                                                                                " & vbNewLine _
                                             & "            ) TOPEDI                                                                                                           " & vbNewLine _
                                             & "        ON TOPEDI.NRS_BR_CD    = OUTL.NRS_BR_CD                                                                                " & vbNewLine _
                                             & "       AND TOPEDI.OUTKA_CTL_NO = OUTL.OUTKA_NO_L                                                                               " & vbNewLine _
                                             & " LEFT JOIN $LM_TRN$..H_OUTKAEDI_L EDIL                                                                                         " & vbNewLine _
                                             & "        ON EDIL.NRS_BR_CD  = TOPEDI.NRS_BR_CD                                                                                  " & vbNewLine _
                                             & "       AND EDIL.EDI_CTL_NO = TOPEDI.EDI_CTL_NO                                                                                 " & vbNewLine _
                                             & "--(2012.09.06)要望番号1412対応  ---  END  ---                                                                                  " & vbNewLine _
                                             & "--入荷L                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..B_INKA_L INL                                                                                               " & vbNewLine _
                                             & "ON  INL.NRS_BR_CD = OUTS.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "AND INL.INKA_NO_L = OUTS.INKA_NO_L                                                                                             " & vbNewLine _
                                             & "AND INL.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--入荷S                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..B_INKA_S INS                                                                                               " & vbNewLine _
                                             & "ON  INS.NRS_BR_CD = OUTS.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "AND INS.INKA_NO_L = OUTS.INKA_NO_L                                                                                             " & vbNewLine _
                                             & "AND INS.INKA_NO_M = OUTS.INKA_NO_M                                                                                             " & vbNewLine _
                                             & "AND INS.INKA_NO_S = OUTS.INKA_NO_S                                                                                             " & vbNewLine _
                                             & "AND INS.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--運送L                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..F_UNSO_L UL                                                                                                " & vbNewLine _
                                             & "ON  UL.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                              " & vbNewLine _
                                             & "AND UL.INOUTKA_NO_L = OUTL.OUTKA_NO_L                                                                                          " & vbNewLine _
                                             & "AND UL.MOTO_DATA_KB = '20'                                                                                                     " & vbNewLine _
                                             & "AND UL.SYS_DEL_FLG = '0'                                                                                                       " & vbNewLine _
                                             & "--在庫テーブル                                                                                                                 " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..D_ZAI_TRS ZAI                                                                                              " & vbNewLine _
                                             & "ON  ZAI.NRS_BR_CD = OUTS.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "AND ZAI.ZAI_REC_NO = OUTS.ZAI_REC_NO                                                                                           " & vbNewLine _
                                             & "AND ZAI.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--マスタテーブル                                                                                                               " & vbNewLine _
                                             & "--営業所M                                                                                                                      " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_NRS_BR MNRS                                                                                              " & vbNewLine _
                                             & "ON MNRS.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "--商品M                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_GOODS MG                                                                                                 " & vbNewLine _
                                             & "ON  MG.NRS_BR_CD = OUTM.NRS_BR_CD                                                                                              " & vbNewLine _
                                             & "AND MG.GOODS_CD_NRS = OUTM.GOODS_CD_NRS                                                                                        " & vbNewLine _
                                             & "--★★★追加開始--------------------------------                                                                                     " & vbNewLine _
                                             & "--商品M(MIN)                                                                                                                   " & vbNewLine _
                                             & "LEFT OUTER JOIN $LM_MST$..M_GOODS M_GOODS_MIN                                                                                  " & vbNewLine _
                                             & "ON M_GOODS_MIN.NRS_BR_CD      = OUTL.NRS_BR_CD                                                                                 " & vbNewLine _
                                             & "AND M_GOODS_MIN.GOODS_CD_NRS   = OUTM2.GOODS_CD_NRS                                                                            " & vbNewLine _
                                             & "--★★★追加終了--------------------------------                                                                                     " & vbNewLine _
                                             & "--荷主M(商品M経由)                                                                                                             " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST MC                                                                                                  " & vbNewLine _
                                             & "ON  MC.NRS_BR_CD = MG.NRS_BR_CD                                                                                                " & vbNewLine _
                                             & "AND MC.CUST_CD_L = MG.CUST_CD_L                                                                                                " & vbNewLine _
                                             & "AND MC.CUST_CD_M = MG.CUST_CD_M                                                                                                " & vbNewLine _
                                             & "AND MC.CUST_CD_S = MG.CUST_CD_S                                                                                                " & vbNewLine _
                                             & "AND MC.CUST_CD_SS = MG.CUST_CD_SS                                                                                              " & vbNewLine _
                                             & "--★★★追加開始--------------------------------                                                                               " & vbNewLine _
                                             & "--荷主M(商品M経由) 最小の出荷(中)で抽出                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST MC2                                                                                                 " & vbNewLine _
                                             & "ON  MC2.NRS_BR_CD = M_GOODS_MIN.NRS_BR_CD                                                                                      " & vbNewLine _
                                             & "AND MC2.CUST_CD_L = M_GOODS_MIN.CUST_CD_L                                                                                      " & vbNewLine _
                                             & "AND MC2.CUST_CD_M = M_GOODS_MIN.CUST_CD_M                                                                                      " & vbNewLine _
                                             & "AND MC2.CUST_CD_S = M_GOODS_MIN.CUST_CD_S                                                                                      " & vbNewLine _
                                             & "AND MC2.CUST_CD_SS = M_GOODS_MIN.CUST_CD_SS                                                                                    " & vbNewLine _
                                             & "AND MC2.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--★★★追加終了--------------------------------                                                                               " & vbNewLine _
                                             & "--届先M(届先取得)(出荷L参照)                                                                                                   " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_DEST MDOUT                                                                                               " & vbNewLine _
                                             & "ON  MDOUT.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                           " & vbNewLine _
                                             & "AND MDOUT.CUST_CD_L = OUTL.CUST_CD_L                                                                                           " & vbNewLine _
                                             & "AND MDOUT.DEST_CD = OUTL.DEST_CD                                                                                               " & vbNewLine _
                                             & "--20150709 NIK JOIN                                                                                                                     " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_DEST MDTOKUI                                                                                                " & vbNewLine _
                                             & "ON MDTOKUI.NRS_BR_CD = EDIL.NRS_BR_CD                                                                                           " & vbNewLine _
                                             & "AND MDTOKUI.CUST_CD_L = EDIL.CUST_CD_L                                                                                                  " & vbNewLine _
                                             & "AND MDTOKUI.DEST_CD = EDIL.FREE_C10                                                                                                    " & vbNewLine _
                                             & "AND MDTOKUI.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--届先M(売上先取得)(出荷L参照)                                                                                                 " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_DEST MDOUTU                                                                                              " & vbNewLine _
                                             & "ON  MDOUTU.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                          " & vbNewLine _
                                             & "AND MDOUTU.CUST_CD_L = OUTL.CUST_CD_L                                                                                          " & vbNewLine _
                                             & "AND MDOUTU.DEST_CD = OUTL.SHIP_CD_L                                                                                            " & vbNewLine _
                                             & "--届先M(届先取得)(出荷EDIL参照)                                                                                                " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_DEST MDEDI                                                                                               " & vbNewLine _
                                             & "ON  MDEDI.NRS_BR_CD = EDIL.NRS_BR_CD                                                                                           " & vbNewLine _
                                             & "AND MDEDI.CUST_CD_L = EDIL.CUST_CD_L                                                                                           " & vbNewLine _
                                             & "AND MDEDI.DEST_CD = EDIL.DEST_CD                                                                                               " & vbNewLine _
                                             & "--【要望番号1122】埼玉対応 --- START ---                                                                                       " & vbNewLine _
                                             & "--届先M(納品書荷主名義名取得)(届先M参照)                                                                                       " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST MC_SALES                                                                                            " & vbNewLine _
                                             & "       ON MC_SALES.NRS_BR_CD  = MDOUT.NRS_BR_CD                                                                                " & vbNewLine _
                                             & "      AND MC_SALES.CUST_CD_L  = MDOUT.SALES_CD                                                                                 " & vbNewLine _
                                             & "      AND MC_SALES.CUST_CD_M  = '00'                                                                                           " & vbNewLine _
                                             & "      AND MC_SALES.CUST_CD_S  = '00'                                                                                           " & vbNewLine _
                                             & "      AND MC_SALES.CUST_CD_SS = '00'                                                                                           " & vbNewLine _
                                             & "--【要望番号1122】埼玉対応 ---  END  ---                                                                                       " & vbNewLine _
                                             & "--運送会社M                                                                                                                    " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_UNSOCO MUCO                                                                                              " & vbNewLine _
                                             & "ON  MUCO.NRS_BR_CD = UL.NRS_BR_CD                                                                                              " & vbNewLine _
                                             & "AND MUCO.UNSOCO_CD = UL.UNSO_CD                                                                                                " & vbNewLine _
                                             & "AND MUCO.UNSOCO_BR_CD = UL.UNSO_BR_CD                                                                                          " & vbNewLine _
                                             & "--倉庫M                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_SOKO MSO                                                                                                 " & vbNewLine _
                                             & "ON  MSO.NRS_BR_CD = OUTL.NRS_BR_CD  --追加                                                                                     " & vbNewLine _
                                             & "AND MSO.WH_CD     = OUTL.WH_CD                                                                                                 " & vbNewLine _
                                             & "--距離程M(M_DEST.JIS < M_SOKO.JIS_CD)(出荷L参照)                                                                               " & vbNewLine _
                                             & "--2014/5/16Start s.kobayashi NotesNo.2183                                                                                      " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN11                                                                                                " & vbNewLine _
                                             & "ON  KBN11.KBN_GROUP_CD = 'U028'  --追加                                                                                        " & vbNewLine _
                                             & "AND UL.SEIQ_TARIFF_CD = KBN11.KBN_NM1                                                                                          " & vbNewLine _
                                             & "--2014/5/16End s.kobayashi NotesNo.2183                                                                                       " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_KYORI MKY1                                                                                               " & vbNewLine _
                                             & "ON  MKY1.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "--AND MKY1.KYORI_CD = MC.BETU_KYORI_CD                                                                                         " & vbNewLine _
                                             & "AND MKY1.KYORI_CD = (CASE ISNULL(KBN11.KBN_NM2,'') WHEN '' THEN MC.BETU_KYORI_CD ELSE KBN11.KBN_NM2 END)                       " & vbNewLine _
                                             & "AND MKY1.ORIG_JIS_CD = MDOUT.JIS                                                                                               " & vbNewLine _
                                             & "AND MKY1.DEST_JIS_CD = MSO.JIS_CD                                                                                              " & vbNewLine _
                                             & "--距離程M(M_SOKO.JIS_CD < M_DEST.JIS)(出荷L参照)                                                                               " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_KYORI MKY2                                                                                               " & vbNewLine _
                                             & "ON  MKY2.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "--AND MKY2.KYORI_CD = MC.BETU_KYORI_CD                                                                                           " & vbNewLine _
                                             & "AND MKY2.KYORI_CD = (CASE ISNULL(KBN11.KBN_NM2,'') WHEN '' THEN MC.BETU_KYORI_CD ELSE KBN11.KBN_NM2 END)                       " & vbNewLine _
                                             & "AND MKY2.ORIG_JIS_CD = MSO.JIS_CD                                                                                              " & vbNewLine _
                                             & "AND MKY2.DEST_JIS_CD = MDOUT.JIS                                                                                               " & vbNewLine _
                                             & "--距離程M(H_OUTKAEDI_L.DEST_JIS_CD < M_SOKO.JIS_CD)(出荷EDIL参照)                                                              " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_KYORI MKY3                                                                                               " & vbNewLine _
                                             & "ON  MKY3.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "--AND MKY3.KYORI_CD = MC.BETU_KYORI_CD                                                                                           " & vbNewLine _
                                             & "AND MKY3.KYORI_CD = (CASE ISNULL(KBN11.KBN_NM2,'') WHEN '' THEN MC.BETU_KYORI_CD ELSE KBN11.KBN_NM2 END)                       " & vbNewLine _
                                             & "AND MKY3.ORIG_JIS_CD = EDIL.DEST_JIS_CD                                                                                        " & vbNewLine _
                                             & "AND MKY3.DEST_JIS_CD = MSO.JIS_CD                                                                                              " & vbNewLine _
                                             & "--距離程M(M_SOKO.JIS_CD < H_OUTKAEDI_L.DEST_JIS_CD)(出荷EDIL参照)                                                              " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_KYORI MKY4                                                                                               " & vbNewLine _
                                             & "ON  MKY4.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "--AND MKY4.KYORI_CD = MC.BETU_KYORI_CD                                                                                           " & vbNewLine _
                                             & "AND MKY4.KYORI_CD = (CASE ISNULL(KBN11.KBN_NM2,'') WHEN '' THEN MC.BETU_KYORI_CD ELSE KBN11.KBN_NM2 END)                       " & vbNewLine _
                                             & "AND MKY4.ORIG_JIS_CD = MSO.JIS_CD                                                                                              " & vbNewLine _
                                             & "AND MKY4.DEST_JIS_CD = EDIL.DEST_JIS_CD                                                                                        " & vbNewLine _
                                             & "--届先商品M(出荷L参照)                                                                                                         " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_DESTGOODS MDGL                                                                                           " & vbNewLine _
                                             & "ON  MDGL.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "AND MDGL.CUST_CD_L = OUTL.CUST_CD_L                                                                                            " & vbNewLine _
                                             & "AND MDGL.CUST_CD_M = OUTL.CUST_CD_M                                                                                            " & vbNewLine _
                                             & "AND MDGL.CD = OUTL.DEST_CD                                                                                                     " & vbNewLine _
                                             & "AND MDGL.GOODS_CD_NRS = MG.GOODS_CD_NRS                                                                                        " & vbNewLine _
                                             & "AND MDGL.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--届先商品M(出荷EDI参照)                                                                                                       " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_DESTGOODS MDGE                                                                                           " & vbNewLine _
                                             & "ON  MDGE.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "AND MDGE.CUST_CD_L = OUTL.CUST_CD_L                                                                                            " & vbNewLine _
                                             & "AND MDGE.CUST_CD_M = OUTL.CUST_CD_M                                                                                            " & vbNewLine _
                                             & "AND MDGE.CD = EDIL.DEST_CD                                                                                                     " & vbNewLine _
                                             & "AND MDGE.GOODS_CD_NRS = MG.GOODS_CD_NRS                                                                                        " & vbNewLine _
                                             & "AND MDGE.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--区分M(納入予定区分)                                                                                                          " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN1                                                                                                 " & vbNewLine _
                                             & "ON  KBN1.KBN_GROUP_CD = 'N010'                                                                                                 " & vbNewLine _
                                             & "AND KBN1.KBN_CD = OUTL.ARR_PLAN_TIME                                                                                           " & vbNewLine _
                                             & "AND KBN1.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--区分M(日本合成用倉庫名)                                                                                                      " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN2                                                                                                 " & vbNewLine _
                                             & "ON  KBN2.KBN_GROUP_CD = 'P005'                                                                                                 " & vbNewLine _
                                             & "AND KBN2.KBN_CD = '00'                                                                                                         " & vbNewLine _
                                             & "AND KBN2.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--区分M(日本合成用部署名)                                                                                                      " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN3                                                                                                 " & vbNewLine _
                                             & "ON  KBN3.KBN_GROUP_CD = 'P005'                                                                                                 " & vbNewLine _
                                             & "AND KBN3.KBN_CD = '01'                                                                                                         " & vbNewLine _
                                             & "AND KBN3.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--区分M(日本合成用営業署名)                                                                                                    " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN4                                                                                                 " & vbNewLine _
                                             & "ON  KBN4.KBN_GROUP_CD = 'P005'                                                                                                 " & vbNewLine _
                                             & "AND KBN4.KBN_CD = '02'                                                                                                         " & vbNewLine _
                                             & "AND KBN4.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--区分M(荷姿)                                                                                                                  " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN5                                                                                                 " & vbNewLine _
                                             & "ON  KBN5.KBN_GROUP_CD = 'N001'                                                                                                 " & vbNewLine _
                                             & "AND KBN5.KBN_CD = MG.PKG_UT                                                                                                    " & vbNewLine _
                                             & "AND KBN5.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--明細タイトル（小分け）                                                                                                       " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN6                                                                                                 " & vbNewLine _
                                             & "ON  KBN6.KBN_GROUP_CD = 'S041'                                                                                                 " & vbNewLine _
                                             & "AND KBN6.KBN_CD = OUTM.ALCTD_KB                                                                                                " & vbNewLine _
                                             & "AND KBN6.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--区分M(毒劇区分名称)                                                                                                           " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN7                                                                                                  " & vbNewLine _
                                             & "ON  KBN7.KBN_GROUP_CD = 'G001'                                                                                                  " & vbNewLine _
                                             & "AND KBN7.KBN_CD = MG.DOKU_KB                                                                                                    " & vbNewLine _
                                             & "AND KBN7.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--【要望番号995】　2012/04/17　元着払い区分　START                                                                             " & vbNewLine _
                                             & "--区分M(元着払区分名称)                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN9                                                                                                 " & vbNewLine _
                                             & "ON  KBN9.KBN_GROUP_CD = 'M001'                                                                                                 " & vbNewLine _
                                             & "AND KBN9.KBN_CD = OUTL.PC_KB                                                                                                   " & vbNewLine _
                                             & "AND KBN9.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--【要望番号995】　2012/04/17　元着払い区分　 END                                                                              " & vbNewLine _
                                             & "--日医工対策開始                                                                                                               " & vbNewLine _
                                             & "--★出荷EDI M(日医工)                                                                                                          " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..H_OUTKAEDI_M EDIM                                                                                            " & vbNewLine _
                                             & "ON  EDIM.NRS_BR_CD        = OUTM.NRS_BR_CD                                                                                     " & vbNewLine _
                                             & "AND EDIM.OUTKA_CTL_NO     = OUTM.OUTKA_NO_L                                                                                    " & vbNewLine _
                                             & "AND EDIM.OUTKA_CTL_NO_CHU = OUTM.OUTKA_NO_M                                                                                    " & vbNewLine _
                                             & "AND EDIM.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--日医工_出荷指示EDIデータ                                                                                                     " & vbNewLine _
                                             & "--LEFT JOIN $LM_TRN$..H_OUTKAEDI_DTL_NIK EDIN                                                                                    " & vbNewLine _
                                             & "--ON   OUTL.NRS_BR_CD      = EDIN.NRS_BR_CD                                                                                      " & vbNewLine _
                                             & "--AND  EDIL.EDI_CTL_NO     = EDIN.EDI_CTL_NO                                                                                     " & vbNewLine _
                                             & "--AND  EDIM.EDI_CTL_NO_CHU = EDIN.EDI_CTL_NO_CHU                                                                                 " & vbNewLine _
                                             & "--AND  EDIN.SYS_DEL_FLG    = '0'                                                                                                 " & vbNewLine _
                                             & "                                                                                                                               " & vbNewLine _
                                             & "--荷主明細M ★                                                                                                                 " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST_DETAILS MCD_N                                                                                       " & vbNewLine _
                                             & "ON  MCD_N.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                           " & vbNewLine _
                                             & "AND MCD_N.CUST_CD   = OUTL.CUST_CD_L                                                                                           " & vbNewLine _
                                             & "AND MCD_N.SUB_KB = '26'                                                                                                        " & vbNewLine _
                                             & "--日医工対策終了                                                                                                               " & vbNewLine _
                                             & "--(2012.06.01) 日本ﾌｧｲﾝ対応  --- START ----                                                                                    " & vbNewLine _
                                             & "--荷主明細M                                                                                                                    " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST_DETAILS MCD_F                                                                                       " & vbNewLine _
                                             & "ON  MCD_F.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                           " & vbNewLine _
                                             & "AND MCD_F.CUST_CD   = OUTL.CUST_CD_L                                                                                           " & vbNewLine _
                                             & "AND MCD_F.SUB_KB = '29'                                                                                                        " & vbNewLine _
                                             & "--(2012.06.01) 日本ﾌｧｲﾝ対応  ---  END  ----                                                                                    " & vbNewLine _
                                             & "--出荷Lでの荷主帳票パターン取得                                                                                                " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST_RPT MCR1                                                                                            " & vbNewLine _
                                             & "ON  OUTL.NRS_BR_CD = MCR1.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "AND OUTL.CUST_CD_L = MCR1.CUST_CD_L                                                                                            " & vbNewLine _
                                             & "AND OUTL.CUST_CD_M = MCR1.CUST_CD_M                                                                                            " & vbNewLine _
                                             & "AND '00' = MCR1.CUST_CD_S                                                                                                      " & vbNewLine _
                                             & "AND MCR1.PTN_ID = '04'                                                                                                         " & vbNewLine _
                                             & "--帳票パターン取得                                                                                                             " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_RPT MR1                                                                                                  " & vbNewLine _
                                             & "ON  MR1.NRS_BR_CD = MCR1.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "AND MR1.PTN_ID = MCR1.PTN_ID                                                                                                   " & vbNewLine _
                                             & "AND MR1.PTN_CD = MCR1.PTN_CD                                                                                                   " & vbNewLine _
                                             & "AND MR1.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--商品Mの荷主での荷主帳票パターン取得                                                                                          " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST_RPT MCR2                                                                                            " & vbNewLine _
                                             & "ON  MG.NRS_BR_CD = MCR2.NRS_BR_CD                                                                                              " & vbNewLine _
                                             & "AND MG.CUST_CD_L = MCR2.CUST_CD_L                                                                                              " & vbNewLine _
                                             & "AND MG.CUST_CD_M = MCR2.CUST_CD_M                                                                                              " & vbNewLine _
                                             & "AND MG.CUST_CD_S = MCR2.CUST_CD_S                                                                                              " & vbNewLine _
                                             & "AND MCR2.PTN_ID = '04'                                                                                                         " & vbNewLine _
                                             & "--帳票パターン取得                                                                                                             " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_RPT MR2                                                                                                  " & vbNewLine _
                                             & "ON  MR2.NRS_BR_CD = MCR2.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "AND MR2.PTN_ID = MCR2.PTN_ID                                                                                                   " & vbNewLine _
                                             & "AND MR2.PTN_CD = MCR2.PTN_CD                                                                                                   " & vbNewLine _
                                             & "AND MR2.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--存在しない場合の帳票パターン取得                                                                                             " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_RPT MR3                                                                                                  " & vbNewLine _
                                             & "ON  MR3.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "AND MR3.PTN_ID = '04'                                                                                                          " & vbNewLine _
                                             & "AND MR3.STANDARD_FLAG = '01'                                                                                                   " & vbNewLine _
                                             & "AND MR3.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--千葉一括時の納品書取得　帳票パターン取得 ADD　2022/04/26　028723                                                             " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_RPT MR4                                                                                                  " & vbNewLine _
                                             & "ON MR4.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                              " & vbNewLine _
                                             & "AND MR4.PTN_ID = '04'                                                                                                          " & vbNewLine _
                                             & "AND MR4.PTN_CD = '52'                                                                                                          " & vbNewLine _
                                             & "AND MR4.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--ユーザM                                                                                                                      " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..S_USER MUSER                                                                                               " & vbNewLine _
                                             & "ON MUSER.USER_CD = OUTL.SYS_ENT_USER                                                                                           " & vbNewLine _
                                             & "AND MUSER.SYS_DEL_FLG = '0'                                                                                                    " & vbNewLine _
                                             & "--商品明細M                                                                                                                    " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_GOODS_DETAILS MGD                                                                                        " & vbNewLine _
                                             & "ON  MGD.NRS_BR_CD = MG.NRS_BR_CD                                                                                               " & vbNewLine _
                                             & "AND MGD.GOODS_CD_NRS = MG.GOODS_CD_NRS                                                                                         " & vbNewLine _
                                             & "AND MGD.SUB_KB = '09'                                                                                                          " & vbNewLine _
                                             & "AND MGD.SYS_DEL_FLG = '0'       --ADD 2019/02/07 依頼番号 : 004605   【LMS】納品書がの梱包個数が2倍になるバグ修正              " & vbNewLine

#If True Then   'ADD 2020/01/15 009792【LMS】RD帳票作成_アンファー:送り状・納品書亜種
    ''' <summary>
    ''' 印刷データ抽出用(出荷テーブル:FROM句)
    ''' </summary>
    ''' <remarks></remarks>
    Friend Const SQL_FROM_OUTKA_854 As String = "--出荷L                                                                                                                        " & vbNewLine _
                                             & "FROM                                                                                                                           " & vbNewLine _
                                             & "$LM_TRN$..C_OUTKA_L OUTL                                                                                                       " & vbNewLine _
                                             & "--トランザクションテーブル                                                                                                     " & vbNewLine _
                                             & "--出荷M                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..C_OUTKA_M OUTM                                                                                             " & vbNewLine _
                                             & "ON  OUTM.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "AND OUTM.OUTKA_NO_L = OUTL.OUTKA_NO_L                                                                                          " & vbNewLine _
                                             & "AND OUTM.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--★★★追加開始--------------------------------                                                                               " & vbNewLine _
                                             & "--出荷M(中MIN)                                                                                                                 " & vbNewLine _
                                             & "LEFT OUTER JOIN                                                                                                                " & vbNewLine _
                                             & "       (SELECT                                                                                                                 " & vbNewLine _
                                             & "           NRS_BR_CD                                                                                                           " & vbNewLine _
                                             & "           ,OUTKA_NO_L                                                                                                         " & vbNewLine _
                                             & "           ,MIN(OUTKA_NO_M) AS  OUTKA_NO_M                                                                                     " & vbNewLine _
                                             & "       FROM $LM_TRN$..C_OUTKA_M WHERE SYS_DEL_FLG ='0'                                                                         " & vbNewLine _
                                             & "        AND NRS_BR_CD = @NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "        AND OUTKA_NO_L = @KANRI_NO_L                                                                                           " & vbNewLine _
                                             & "       GROUP BY NRS_BR_CD,OUTKA_NO_L) OUTM_MIN                                                                                 " & vbNewLine _
                                             & "       ON OUTM_MIN.NRS_BR_CD        = OUTL.NRS_BR_CD                                                                           " & vbNewLine _
                                             & "       AND OUTM_MIN.OUTKA_NO_L      = OUTL.OUTKA_NO_L                                                                          " & vbNewLine _
                                             & "--出荷M(中MIN)                                                                                                                 " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..C_OUTKA_M OUTM2                                                                                            " & vbNewLine _
                                             & "ON  OUTM2.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                           " & vbNewLine _
                                             & "AND OUTM2.OUTKA_NO_L = OUTL.OUTKA_NO_L                                                                                         " & vbNewLine _
                                             & "AND OUTM2.OUTKA_NO_M = OUTM_MIN.OUTKA_NO_M                                                                                     " & vbNewLine _
                                             & "AND OUTM2.SYS_DEL_FLG = '0'                                                                                                    " & vbNewLine _
                                             & "--★★★追加終了--------------------------------                                                                               " & vbNewLine _
                                             & "--出荷S                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..C_OUTKA_S OUTS                                                                                             " & vbNewLine _
                                             & "ON  OUTS.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "AND OUTS.OUTKA_NO_L = OUTL.OUTKA_NO_L                                                                                          " & vbNewLine _
                                             & "AND OUTS.OUTKA_NO_M = OUTM.OUTKA_NO_M                                                                                          " & vbNewLine _
                                             & "AND OUTS.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--出荷EDIL                                                                                                                     " & vbNewLine _
                                             & "--(2012.09.06)要望番号1412対応  --- START ---                                                                                  " & vbNewLine _
                                             & "--LEFT JOIN                                                                                                                    " & vbNewLine _
                                             & "--(                                                                                                                            " & vbNewLine _
                                             & "--SELECT                                                                                                                       " & vbNewLine _
                                             & "-- --20120730 MIN化　開始(20120803取りやめ)                                                                                    " & vbNewLine _
                                             & "-- --MIN(NRS_BR_CD)    AS NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "-- --,MIN(OUTKA_CTL_NO) AS OUTKA_CTL_NO                                                                                        " & vbNewLine _
                                             & "-- --,MIN(CUST_CD_L)    AS CUST_CD_L                                                                                           " & vbNewLine _
                                             & "-- NRS_BR_CD                                                                                                                   " & vbNewLine _
                                             & "--,OUTKA_CTL_NO                                                                                                                " & vbNewLine _
                                             & "--,CUST_CD_L                                                                                                                   " & vbNewLine _
                                             & "-- --20120730 MIN化　終了                                                                                                      " & vbNewLine _
                                             & "----★削除開始2012/05/11                                                                                                       " & vbNewLine _
                                             & "----,SHIP_NM_L                                                                                                                 " & vbNewLine _
                                             & "----★削除終了2012/05/11                                                                                                       " & vbNewLine _
                                             & "--,MIN(DEST_CD)     AS DEST_CD                                                                                                 " & vbNewLine _
                                             & "--,MIN(DEST_NM)     AS DEST_NM                                                                                                 " & vbNewLine _
                                             & "--,MIN(DEST_AD_1)   AS DEST_AD_1                                                                                               " & vbNewLine _
                                             & "--,MIN(DEST_AD_2)   AS DEST_AD_2                                                                                               " & vbNewLine _
                                             & "----(2012.04.11)【Notes】№923  DEST_JIS_CDはMINで抽出 -- START --                                                             " & vbNewLine _
                                             & "----,DEST_JIS_CD                                                                                                               " & vbNewLine _
                                             & "--,MIN(DEST_JIS_CD) AS DEST_JIS_CD                                                                                             " & vbNewLine _
                                             & "----(2012.04.11)【Notes】№923  DEST_JIS_CDはMINで抽出 --  END  --                                                             " & vbNewLine _
                                             & "-- --20120730 MIN化　開始                                                                                                      " & vbNewLine _
                                             & "--,MIN(FREE_C01)   AS FREE_C01                                                                                                 " & vbNewLine _
                                             & "--,MIN(FREE_C08)   AS FREE_C08                                                                                                 " & vbNewLine _
                                             & "--,MIN(FREE_C11)   AS FREE_C11                                                                                                 " & vbNewLine _
                                             & "-- --20120730 MIN化　終了                                                                                                      " & vbNewLine _
                                             & "--,SYS_DEL_FLG                                                                                                                 " & vbNewLine _
                                             & "--FROM                                                                                                                         " & vbNewLine _
                                             & "--$LM_TRN$..H_OUTKAEDI_L                                                                                                       " & vbNewLine _
                                             & "--GROUP BY                                                                                                                     " & vbNewLine _
                                             & "-- --20120730 MIN化によるコメントアウト　開始 (20120803取りやめ)                                                               " & vbNewLine _
                                             & "-- NRS_BR_CD                                                                                                                   " & vbNewLine _
                                             & "--,OUTKA_CTL_NO                                                                                                                " & vbNewLine _
                                             & "--,CUST_CD_L                                                                                                                   " & vbNewLine _
                                             & "-- --20120730 MIN化によるコメントアウト　終了                                                                                  " & vbNewLine _
                                             & "----★削除開始2012/05/11                                                                                                       " & vbNewLine _
                                             & "----,SHIP_NM_L                                                                                                                 " & vbNewLine _
                                             & "----★削除開始2012/05/11                                                                                                       " & vbNewLine _
                                             & "----(2012.04.11) Notes№923  DEST_JIS_CDはMINで抽出のためコメント -- START --                                                  " & vbNewLine _
                                             & "----,DEST_JIS_CD                                                                                                               " & vbNewLine _
                                             & "----(2012.04.11) Notes№923  DEST_JIS_CDはMINで抽出のためコメント --  END  --                                                  " & vbNewLine _
                                             & "-- --20120730 MIN化によるコメントアウト　開始                                                                                  " & vbNewLine _
                                             & "----,FREE_C01                                                                                                                  " & vbNewLine _
                                             & "----,FREE_C08                                                                                                                  " & vbNewLine _
                                             & "----,FREE_C11                                                                                                                  " & vbNewLine _
                                             & "-- --20120730 MIN化によるコメントアウト　終了 ↓SYS_DEL_FLGのカンマ除去↓                                                      " & vbNewLine _
                                             & "--,SYS_DEL_FLG                                                                                                                 " & vbNewLine _
                                             & "--) EDIL                                                                                                                       " & vbNewLine _
                                             & "--ON  EDIL.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                          " & vbNewLine _
                                             & "--下記の内容に変更                                                                                                             " & vbNewLine _
                                             & " LEFT JOIN (                                                                                                                   " & vbNewLine _
                                             & "            SELECT                                                                                                             " & vbNewLine _
                                             & "                   NRS_BR_CD                                                                                                   " & vbNewLine _
                                             & "                 , EDI_CTL_NO                                                                                                  " & vbNewLine _
                                             & "                 , OUTKA_CTL_NO                                                                                                " & vbNewLine _
                                             & "             FROM (                                                                                                            " & vbNewLine _
                                             & "                    SELECT                                                                                                     " & vbNewLine _
                                             & "                           EDIOUTL.NRS_BR_CD                                                                                   " & vbNewLine _
                                             & "                         , EDIOUTL.EDI_CTL_NO                                                                                  " & vbNewLine _
                                             & "                         , EDIOUTL.OUTKA_CTL_NO                                                                                " & vbNewLine _
                                             & "                         , CASE WHEN EDIOUTL.OUTKA_CTL_NO = '' THEN 1                                                          " & vbNewLine _
                                             & "                           ELSE ROW_NUMBER() OVER (PARTITION BY EDIOUTL.NRS_BR_CD                                              " & vbNewLine _
                                             & "                                                              , EDIOUTL.OUTKA_CTL_NO                                           " & vbNewLine _
                                             & "                                                       ORDER BY EDIOUTL.NRS_BR_CD                                              " & vbNewLine _
                                             & "                                                              , EDIOUTL.EDI_CTL_NO                                             " & vbNewLine _
                                             & "                                                  )                                                                            " & vbNewLine _
                                             & "                           END AS IDX                                                                                          " & vbNewLine _
                                             & "                     FROM $LM_TRN$..H_OUTKAEDI_L EDIOUTL                                                                       " & vbNewLine _
                                             & "                    WHERE EDIOUTL.SYS_DEL_FLG  = '0'                                                                           " & vbNewLine _
                                             & "                      AND EDIOUTL.NRS_BR_CD    = @NRS_BR_CD                                                                    " & vbNewLine _
                                             & "                      AND EDIOUTL.OUTKA_CTL_NO = @KANRI_NO_L                                                                   " & vbNewLine _
                                             & "                  ) EBASE                                                                                                      " & vbNewLine _
                                             & "            WHERE EBASE.IDX = 1                                                                                                " & vbNewLine _
                                             & "            ) TOPEDI                                                                                                           " & vbNewLine _
                                             & "        ON TOPEDI.NRS_BR_CD    = OUTL.NRS_BR_CD                                                                                " & vbNewLine _
                                             & "       AND TOPEDI.OUTKA_CTL_NO = OUTL.OUTKA_NO_L                                                                               " & vbNewLine _
                                             & " LEFT JOIN $LM_TRN$..H_OUTKAEDI_L EDIL                                                                                         " & vbNewLine _
                                             & "        ON EDIL.NRS_BR_CD  = TOPEDI.NRS_BR_CD                                                                                  " & vbNewLine _
                                             & "       AND EDIL.EDI_CTL_NO = TOPEDI.EDI_CTL_NO                                                                                 " & vbNewLine _
                                             & "--(2012.09.06)要望番号1412対応  ---  END  ---                                                                                  " & vbNewLine _
                                             & "--入荷L                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..B_INKA_L INL                                                                                               " & vbNewLine _
                                             & "ON  INL.NRS_BR_CD = OUTS.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "AND INL.INKA_NO_L = OUTS.INKA_NO_L                                                                                             " & vbNewLine _
                                             & "AND INL.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--入荷S                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..B_INKA_S INS                                                                                               " & vbNewLine _
                                             & "ON  INS.NRS_BR_CD = OUTS.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "AND INS.INKA_NO_L = OUTS.INKA_NO_L                                                                                             " & vbNewLine _
                                             & "AND INS.INKA_NO_M = OUTS.INKA_NO_M                                                                                             " & vbNewLine _
                                             & "AND INS.INKA_NO_S = OUTS.INKA_NO_S                                                                                             " & vbNewLine _
                                             & "AND INS.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--運送L                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..F_UNSO_L UL                                                                                                " & vbNewLine _
                                             & "ON  UL.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                              " & vbNewLine _
                                             & "AND UL.INOUTKA_NO_L = OUTL.OUTKA_NO_L                                                                                          " & vbNewLine _
                                             & "AND UL.MOTO_DATA_KB = '20'                                                                                                     " & vbNewLine _
                                             & "AND UL.SYS_DEL_FLG = '0'                                                                                                       " & vbNewLine _
                                             & "--在庫テーブル                                                                                                                 " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..D_ZAI_TRS ZAI                                                                                              " & vbNewLine _
                                             & "ON  ZAI.NRS_BR_CD = OUTS.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "AND ZAI.ZAI_REC_NO = OUTS.ZAI_REC_NO                                                                                           " & vbNewLine _
                                             & "AND ZAI.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--マスタテーブル                                                                                                               " & vbNewLine _
                                             & "--営業所M                                                                                                                      " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_NRS_BR MNRS                                                                                              " & vbNewLine _
                                             & "ON MNRS.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "--商品M                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_GOODS MG                                                                                                 " & vbNewLine _
                                             & "ON  MG.NRS_BR_CD = OUTM.NRS_BR_CD                                                                                              " & vbNewLine _
                                             & "AND MG.GOODS_CD_NRS = OUTM.GOODS_CD_NRS                                                                                        " & vbNewLine _
                                             & "--★★★追加開始--------------------------------                                                                                     " & vbNewLine _
                                             & "--商品M(MIN)                                                                                                                   " & vbNewLine _
                                             & "LEFT OUTER JOIN $LM_MST$..M_GOODS M_GOODS_MIN                                                                                  " & vbNewLine _
                                             & "ON M_GOODS_MIN.NRS_BR_CD      = OUTL.NRS_BR_CD                                                                                 " & vbNewLine _
                                             & "AND M_GOODS_MIN.GOODS_CD_NRS   = OUTM2.GOODS_CD_NRS                                                                            " & vbNewLine _
                                             & "--★★★追加終了--------------------------------                                                                                     " & vbNewLine _
                                             & "--荷主M(商品M経由)                                                                                                             " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST MC                                                                                                  " & vbNewLine _
                                             & "ON  MC.NRS_BR_CD = MG.NRS_BR_CD                                                                                                " & vbNewLine _
                                             & "AND MC.CUST_CD_L = MG.CUST_CD_L                                                                                                " & vbNewLine _
                                             & "AND MC.CUST_CD_M = MG.CUST_CD_M                                                                                                " & vbNewLine _
                                             & "AND MC.CUST_CD_S = MG.CUST_CD_S                                                                                                " & vbNewLine _
                                             & "AND MC.CUST_CD_SS = MG.CUST_CD_SS                                                                                              " & vbNewLine _
                                             & "--★★★追加開始--------------------------------                                                                               " & vbNewLine _
                                             & "--荷主M(商品M経由) 最小の出荷(中)で抽出                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST MC2                                                                                                 " & vbNewLine _
                                             & "ON  MC2.NRS_BR_CD = M_GOODS_MIN.NRS_BR_CD                                                                                      " & vbNewLine _
                                             & "AND MC2.CUST_CD_L = M_GOODS_MIN.CUST_CD_L                                                                                      " & vbNewLine _
                                             & "AND MC2.CUST_CD_M = M_GOODS_MIN.CUST_CD_M                                                                                      " & vbNewLine _
                                             & "AND MC2.CUST_CD_S = M_GOODS_MIN.CUST_CD_S                                                                                      " & vbNewLine _
                                             & "AND MC2.CUST_CD_SS = M_GOODS_MIN.CUST_CD_SS                                                                                    " & vbNewLine _
                                             & "AND MC2.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--★★★追加終了--------------------------------                                                                               " & vbNewLine _
                                             & "--届先M(届先取得)(出荷L参照)                                                                                                   " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_DEST MDOUT                                                                                               " & vbNewLine _
                                             & "ON  MDOUT.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                           " & vbNewLine _
                                             & "AND MDOUT.CUST_CD_L = OUTL.CUST_CD_L                                                                                           " & vbNewLine _
                                             & "AND MDOUT.DEST_CD = OUTL.DEST_CD                                                                                               " & vbNewLine _
                                             & "--20150709 NIK JOIN                                                                                                                     " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_DEST MDTOKUI                                                                                                " & vbNewLine _
                                             & "ON MDTOKUI.NRS_BR_CD = EDIL.NRS_BR_CD                                                                                           " & vbNewLine _
                                             & "AND MDTOKUI.CUST_CD_L = EDIL.CUST_CD_L                                                                                                  " & vbNewLine _
                                             & "AND MDTOKUI.DEST_CD = EDIL.FREE_C10                                                                                                    " & vbNewLine _
                                             & "AND MDTOKUI.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--届先M(売上先取得)(出荷L参照)                                                                                                 " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_DEST MDOUTU                                                                                              " & vbNewLine _
                                             & "ON  MDOUTU.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                          " & vbNewLine _
                                             & "AND MDOUTU.CUST_CD_L = OUTL.CUST_CD_L                                                                                          " & vbNewLine _
                                             & "AND MDOUTU.DEST_CD = OUTL.SHIP_CD_L                                                                                            " & vbNewLine _
                                             & "--届先M(届先取得)(出荷EDIL参照)                                                                                                " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_DEST MDEDI                                                                                               " & vbNewLine _
                                             & "ON  MDEDI.NRS_BR_CD = EDIL.NRS_BR_CD                                                                                           " & vbNewLine _
                                             & "AND MDEDI.CUST_CD_L = EDIL.CUST_CD_L                                                                                           " & vbNewLine _
                                             & "AND MDEDI.DEST_CD = EDIL.DEST_CD                                                                                               " & vbNewLine _
                                             & "--【要望番号1122】埼玉対応 --- START ---                                                                                       " & vbNewLine _
                                             & "--届先M(納品書荷主名義名取得)(届先M参照)                                                                                       " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST MC_SALES                                                                                            " & vbNewLine _
                                             & "       ON MC_SALES.NRS_BR_CD  = MDOUT.NRS_BR_CD                                                                                " & vbNewLine _
                                             & "      AND MC_SALES.CUST_CD_L  = MDOUT.SALES_CD                                                                                 " & vbNewLine _
                                             & "      AND MC_SALES.CUST_CD_M  = '00'                                                                                           " & vbNewLine _
                                             & "      AND MC_SALES.CUST_CD_S  = '00'                                                                                           " & vbNewLine _
                                             & "      AND MC_SALES.CUST_CD_SS = '00'                                                                                           " & vbNewLine _
                                             & "--【要望番号1122】埼玉対応 ---  END  ---                                                                                       " & vbNewLine _
                                             & "--運送会社M                                                                                                                    " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_UNSOCO MUCO                                                                                              " & vbNewLine _
                                             & "ON  MUCO.NRS_BR_CD = UL.NRS_BR_CD                                                                                              " & vbNewLine _
                                             & "AND MUCO.UNSOCO_CD = UL.UNSO_CD                                                                                                " & vbNewLine _
                                             & "AND MUCO.UNSOCO_BR_CD = UL.UNSO_BR_CD                                                                                          " & vbNewLine _
                                             & "--倉庫M                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_SOKO MSO                                                                                                 " & vbNewLine _
                                             & "ON  MSO.NRS_BR_CD = OUTL.NRS_BR_CD  --追加                                                                                     " & vbNewLine _
                                             & "AND MSO.WH_CD     = OUTL.WH_CD                                                                                                 " & vbNewLine _
                                             & "--距離程M(M_DEST.JIS < M_SOKO.JIS_CD)(出荷L参照)                                                                               " & vbNewLine _
                                             & "--2014/5/16Start s.kobayashi NotesNo.2183                                                                                      " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN11                                                                                                " & vbNewLine _
                                             & "ON  KBN11.KBN_GROUP_CD = 'U028'  --追加                                                                                        " & vbNewLine _
                                             & "AND UL.SEIQ_TARIFF_CD = KBN11.KBN_NM1                                                                                          " & vbNewLine _
                                             & "--2014/5/16End s.kobayashi NotesNo.2183                                                                                       " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_KYORI MKY1                                                                                               " & vbNewLine _
                                             & "ON  MKY1.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "--AND MKY1.KYORI_CD = MC.BETU_KYORI_CD                                                                                         " & vbNewLine _
                                             & "AND MKY1.KYORI_CD = (CASE ISNULL(KBN11.KBN_NM2,'') WHEN '' THEN MC.BETU_KYORI_CD ELSE KBN11.KBN_NM2 END)                       " & vbNewLine _
                                             & "AND MKY1.ORIG_JIS_CD = MDOUT.JIS                                                                                               " & vbNewLine _
                                             & "AND MKY1.DEST_JIS_CD = MSO.JIS_CD                                                                                              " & vbNewLine _
                                             & "--距離程M(M_SOKO.JIS_CD < M_DEST.JIS)(出荷L参照)                                                                               " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_KYORI MKY2                                                                                               " & vbNewLine _
                                             & "ON  MKY2.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "--AND MKY2.KYORI_CD = MC.BETU_KYORI_CD                                                                                           " & vbNewLine _
                                             & "AND MKY2.KYORI_CD = (CASE ISNULL(KBN11.KBN_NM2,'') WHEN '' THEN MC.BETU_KYORI_CD ELSE KBN11.KBN_NM2 END)                       " & vbNewLine _
                                             & "AND MKY2.ORIG_JIS_CD = MSO.JIS_CD                                                                                              " & vbNewLine _
                                             & "AND MKY2.DEST_JIS_CD = MDOUT.JIS                                                                                               " & vbNewLine _
                                             & "--距離程M(H_OUTKAEDI_L.DEST_JIS_CD < M_SOKO.JIS_CD)(出荷EDIL参照)                                                              " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_KYORI MKY3                                                                                               " & vbNewLine _
                                             & "ON  MKY3.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "--AND MKY3.KYORI_CD = MC.BETU_KYORI_CD                                                                                           " & vbNewLine _
                                             & "AND MKY3.KYORI_CD = (CASE ISNULL(KBN11.KBN_NM2,'') WHEN '' THEN MC.BETU_KYORI_CD ELSE KBN11.KBN_NM2 END)                       " & vbNewLine _
                                             & "AND MKY3.ORIG_JIS_CD = EDIL.DEST_JIS_CD                                                                                        " & vbNewLine _
                                             & "AND MKY3.DEST_JIS_CD = MSO.JIS_CD                                                                                              " & vbNewLine _
                                             & "--距離程M(M_SOKO.JIS_CD < H_OUTKAEDI_L.DEST_JIS_CD)(出荷EDIL参照)                                                              " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_KYORI MKY4                                                                                               " & vbNewLine _
                                             & "ON  MKY4.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "--AND MKY4.KYORI_CD = MC.BETU_KYORI_CD                                                                                           " & vbNewLine _
                                             & "AND MKY4.KYORI_CD = (CASE ISNULL(KBN11.KBN_NM2,'') WHEN '' THEN MC.BETU_KYORI_CD ELSE KBN11.KBN_NM2 END)                       " & vbNewLine _
                                             & "AND MKY4.ORIG_JIS_CD = MSO.JIS_CD                                                                                              " & vbNewLine _
                                             & "AND MKY4.DEST_JIS_CD = EDIL.DEST_JIS_CD                                                                                        " & vbNewLine _
                                             & "--届先商品M(出荷L参照)                                                                                                         " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_DESTGOODS MDGL                                                                                           " & vbNewLine _
                                             & "ON  MDGL.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "AND MDGL.CUST_CD_L = OUTL.CUST_CD_L                                                                                            " & vbNewLine _
                                             & "AND MDGL.CUST_CD_M = OUTL.CUST_CD_M                                                                                            " & vbNewLine _
                                             & "AND MDGL.CD = OUTL.DEST_CD                                                                                                     " & vbNewLine _
                                             & "AND MDGL.GOODS_CD_NRS = MG.GOODS_CD_NRS                                                                                        " & vbNewLine _
                                             & "AND MDGL.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--届先商品M(出荷EDI参照)                                                                                                       " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_DESTGOODS MDGE                                                                                           " & vbNewLine _
                                             & "ON  MDGE.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "AND MDGE.CUST_CD_L = OUTL.CUST_CD_L                                                                                            " & vbNewLine _
                                             & "AND MDGE.CUST_CD_M = OUTL.CUST_CD_M                                                                                            " & vbNewLine _
                                             & "AND MDGE.CD = EDIL.DEST_CD                                                                                                     " & vbNewLine _
                                             & "AND MDGE.GOODS_CD_NRS = MG.GOODS_CD_NRS                                                                                        " & vbNewLine _
                                             & "AND MDGE.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--区分M(納入予定区分)                                                                                                          " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN1                                                                                                 " & vbNewLine _
                                             & "ON  KBN1.KBN_GROUP_CD = 'N010'                                                                                                 " & vbNewLine _
                                             & "AND KBN1.KBN_CD = OUTL.ARR_PLAN_TIME                                                                                           " & vbNewLine _
                                             & "AND KBN1.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--区分M(日本合成用倉庫名)                                                                                                      " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN2                                                                                                 " & vbNewLine _
                                             & "ON  KBN2.KBN_GROUP_CD = 'P005'                                                                                                 " & vbNewLine _
                                             & "AND KBN2.KBN_CD = '00'                                                                                                         " & vbNewLine _
                                             & "AND KBN2.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--区分M(日本合成用部署名)                                                                                                      " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN3                                                                                                 " & vbNewLine _
                                             & "ON  KBN3.KBN_GROUP_CD = 'P005'                                                                                                 " & vbNewLine _
                                             & "AND KBN3.KBN_CD = '01'                                                                                                         " & vbNewLine _
                                             & "AND KBN3.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--区分M(日本合成用営業署名)                                                                                                    " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN4                                                                                                 " & vbNewLine _
                                             & "ON  KBN4.KBN_GROUP_CD = 'P005'                                                                                                 " & vbNewLine _
                                             & "AND KBN4.KBN_CD = '02'                                                                                                         " & vbNewLine _
                                             & "AND KBN4.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--区分M(荷姿)                                                                                                                  " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN5                                                                                                 " & vbNewLine _
                                             & "ON  KBN5.KBN_GROUP_CD = 'N001'                                                                                                 " & vbNewLine _
                                             & "AND KBN5.KBN_CD = MG.PKG_UT                                                                                                    " & vbNewLine _
                                             & "AND KBN5.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--明細タイトル（小分け）                                                                                                       " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN6                                                                                                 " & vbNewLine _
                                             & "ON  KBN6.KBN_GROUP_CD = 'S041'                                                                                                 " & vbNewLine _
                                             & "AND KBN6.KBN_CD = OUTM.ALCTD_KB                                                                                                " & vbNewLine _
                                             & "AND KBN6.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--区分M(毒劇区分名称)                                                                                                           " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN7                                                                                                  " & vbNewLine _
                                             & "ON  KBN7.KBN_GROUP_CD = 'G001'                                                                                                  " & vbNewLine _
                                             & "AND KBN7.KBN_CD = MG.DOKU_KB                                                                                                    " & vbNewLine _
                                             & "AND KBN7.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--【要望番号995】　2012/04/17　元着払い区分　START                                                                             " & vbNewLine _
                                             & "--区分M(元着払区分名称)                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN9                                                                                                 " & vbNewLine _
                                             & "ON  KBN9.KBN_GROUP_CD = 'M001'                                                                                                 " & vbNewLine _
                                             & "AND KBN9.KBN_CD = OUTL.PC_KB                                                                                                   " & vbNewLine _
                                             & "AND KBN9.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--【要望番号995】　2012/04/17　元着払い区分　 END                                                                              " & vbNewLine _
                                             & "--日医工対策開始                                                                                                               " & vbNewLine _
                                             & "--★出荷EDI M(日医工)                                                                                                          " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..H_OUTKAEDI_M EDIM                                                                                            " & vbNewLine _
                                             & "ON  EDIM.NRS_BR_CD        = OUTM.NRS_BR_CD                                                                                     " & vbNewLine _
                                             & "AND EDIM.OUTKA_CTL_NO     = OUTM.OUTKA_NO_L                                                                                    " & vbNewLine _
                                             & "AND EDIM.OUTKA_CTL_NO_CHU = OUTM.OUTKA_NO_M                                                                                    " & vbNewLine _
                                             & "AND EDIM.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--日医工_出荷指示EDIデータ                                                                                                     " & vbNewLine _
                                             & "--LEFT JOIN $LM_TRN$..H_OUTKAEDI_DTL_NIK EDIN                                                                                    " & vbNewLine _
                                             & "--ON   OUTL.NRS_BR_CD      = EDIN.NRS_BR_CD                                                                                      " & vbNewLine _
                                             & "--AND  EDIL.EDI_CTL_NO     = EDIN.EDI_CTL_NO                                                                                     " & vbNewLine _
                                             & "--AND  EDIM.EDI_CTL_NO_CHU = EDIN.EDI_CTL_NO_CHU                                                                                 " & vbNewLine _
                                             & "--AND  EDIN.SYS_DEL_FLG    = '0'                                                                                                 " & vbNewLine _
                                             & "                                                                                                                               " & vbNewLine _
                                             & "--荷主明細M ★                                                                                                                 " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST_DETAILS MCD_N                                                                                       " & vbNewLine _
                                             & "ON  MCD_N.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                           " & vbNewLine _
                                             & "AND MCD_N.CUST_CD   = OUTL.CUST_CD_L                                                                                           " & vbNewLine _
                                             & "AND MCD_N.SUB_KB = '26'                                                                                                        " & vbNewLine _
                                             & "--日医工対策終了                                                                                                               " & vbNewLine _
                                             & "--(2012.06.01) 日本ﾌｧｲﾝ対応  --- START ----                                                                                    " & vbNewLine _
                                             & "--荷主明細M                                                                                                                    " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST_DETAILS MCD_F                                                                                       " & vbNewLine _
                                             & "ON  MCD_F.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                           " & vbNewLine _
                                             & "AND MCD_F.CUST_CD   = OUTL.CUST_CD_L                                                                                           " & vbNewLine _
                                             & "AND MCD_F.SUB_KB = '29'                                                                                                        " & vbNewLine _
                                             & "--(2012.06.01) 日本ﾌｧｲﾝ対応  ---  END  ----                                                                                    " & vbNewLine _
                                             & "--出荷Lでの荷主帳票パターン取得                                                                                                " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST_RPT MCR1                                                                                            " & vbNewLine _
                                             & "ON  OUTL.NRS_BR_CD = MCR1.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "AND OUTL.CUST_CD_L = MCR1.CUST_CD_L                                                                                            " & vbNewLine _
                                             & "AND OUTL.CUST_CD_M = MCR1.CUST_CD_M                                                                                            " & vbNewLine _
                                             & "AND '00' = MCR1.CUST_CD_S                                                                                                      " & vbNewLine _
                                             & "AND MCR1.PTN_ID = '04'                                                                                                         " & vbNewLine _
                                             & "--帳票パターン取得                                                                                                             " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_RPT MR1                                                                                                  " & vbNewLine _
                                             & "ON  MR1.NRS_BR_CD = MCR1.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "AND MR1.PTN_ID = MCR1.PTN_ID                                                                                                   " & vbNewLine _
                                             & "AND MR1.PTN_CD = MCR1.PTN_CD                                                                                                   " & vbNewLine _
                                             & "AND MR1.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--商品Mの荷主での荷主帳票パターン取得                                                                                          " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST_RPT MCR2                                                                                            " & vbNewLine _
                                             & "ON  MG.NRS_BR_CD = MCR2.NRS_BR_CD                                                                                              " & vbNewLine _
                                             & "AND MG.CUST_CD_L = MCR2.CUST_CD_L                                                                                              " & vbNewLine _
                                             & "AND MG.CUST_CD_M = MCR2.CUST_CD_M                                                                                              " & vbNewLine _
                                             & "AND MG.CUST_CD_S = MCR2.CUST_CD_S                                                                                              " & vbNewLine _
                                             & "AND MCR2.PTN_ID = '04'                                                                                                         " & vbNewLine _
                                             & "--帳票パターン取得                                                                                                             " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_RPT MR2                                                                                                  " & vbNewLine _
                                             & "ON  MR2.NRS_BR_CD = MCR2.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "AND MR2.PTN_ID = MCR2.PTN_ID                                                                                                   " & vbNewLine _
                                             & "AND MR2.PTN_CD = MCR2.PTN_CD                                                                                                   " & vbNewLine _
                                             & "AND MR2.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--存在しない場合の帳票パターン取得                                                                                             " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_RPT MR3                                                                                                  " & vbNewLine _
                                             & "ON  MR3.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "AND MR3.PTN_ID = '04'                                                                                                          " & vbNewLine _
                                             & "AND MR3.STANDARD_FLAG = '01'                                                                                                   " & vbNewLine _
                                             & "AND MR3.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--ユーザM                                                                                                                      " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..S_USER MUSER                                                                                               " & vbNewLine _
                                             & "ON MUSER.USER_CD = OUTL.SYS_ENT_USER                                                                                           " & vbNewLine _
                                             & "AND MUSER.SYS_DEL_FLG = '0'                                                                                                    " & vbNewLine _
                                             & "--商品明細M                                                                                                                    " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_GOODS_DETAILS MGD                                                                                        " & vbNewLine _
                                             & "ON  MGD.NRS_BR_CD = MG.NRS_BR_CD                                                                                               " & vbNewLine _
                                             & "AND MGD.GOODS_CD_NRS = MG.GOODS_CD_NRS                                                                                         " & vbNewLine _
                                             & "AND MGD.SUB_KB = '09'                                                                                                          " & vbNewLine _
                                             & "AND MGD.SYS_DEL_FLG = '0'       --ADD 2019/02/07 依頼番号 : 004605   【LMS】納品書がの梱包個数が2倍になるバグ修正              " & vbNewLine _
                                             & "LEFT JOIN  $LM_MST$..M_GOODS_DETAILS  MGD2                                                                                     " & vbNewLine _
                                             & "     ON MGD2.SUB_KB = '73'                                                                                                     " & vbNewLine _
                                             & "	AND MGD2.SYS_DEL_FLG  = '0'                                                                                                " & vbNewLine _
                                             & "	AND MGD2.NRS_BR_CD    = OUTM2.NRS_BR_CD                                                                                    " & vbNewLine _
                                             & "    AND MGD2.GOODS_CD_NRS = OUTM2.GOODS_CD_NRS                                                                                 " & vbNewLine
#End If

    ''' <summary>
    ''' 印刷データ抽出用(出荷テーブル:WHERE句)
    ''' </summary>
    ''' <remarks></remarks>
    Friend Const SQL_WHERE_OUTKA As String _
        = " WHERE                                                                                                                         " & vbNewLine _
        & "       OUTL.SYS_DEL_FLG = '0'                                                                                                  " & vbNewLine _
        & "   AND OUTL.NRS_BR_CD   = @NRS_BR_CD                                                                                           " & vbNewLine _
        & "   AND OUTL.OUTKA_NO_L  = @KANRI_NO_L                                                                                          " & vbNewLine







    'END YANAI 要望番号1478 一括印刷が遅い
    Friend Const SQL_SELECT_OUTKA_NIK As String = "--★★★SQL_SELECT_OUTKA★★★  出荷テーブル                                                                                                                 " & vbNewLine _
                                          & "SELECT                                                                                                                         " & vbNewLine _
                                          & " CASE WHEN MR2.PTN_CD IS NOT NULL THEN MR2.RPT_ID                                                                              " & vbNewLine _
                                          & "      WHEN MR1.PTN_CD IS NOT NULL THEN MR1.RPT_ID                                                                              " & vbNewLine _
                                          & "      ELSE MR3.RPT_ID                                                                                                          " & vbNewLine _
                                          & " END              AS RPT_ID                                                                                                    " & vbNewLine _
                                          & ",OUTL.NRS_BR_CD   AS NRS_BR_CD                                                                                                 " & vbNewLine _
                                          & ",OUTM.PRINT_SORT  AS PRINT_SORT                                                                                                " & vbNewLine _
                                          & ",CASE WHEN OUTL.DEST_KB = '02' THEN " & vbNewLine _
                                          & " CASE WHEN EDIN.TOKUI_CD <> EDIN.CHOKUSO_CD THEN MDTOKUI.DEST_CD " & vbNewLine _
                                          & " WHEN EDIN.TOKUI_CD <> EDIN.SUNDRY_CD  THEN  MDTOKUI.DEST_CD  " & vbNewLine _
                                          & " ELSE EDIL.DEST_CD END     " & vbNewLine _
                                          & " ELSE   " & vbNewLine _
                                          & " CASE WHEN EDIN.TOKUI_CD <> EDIN.CHOKUSO_CD THEN MDTOKUI.DEST_CD  " & vbNewLine _
                                          & " WHEN EDIN.TOKUI_CD <> EDIN.SUNDRY_CD  THEN  MDTOKUI.DEST_CD  " & vbNewLine _
                                          & " ELSE OUTL.DEST_CD END  " & vbNewLine _
                                          & " END              AS DEST_CD                                                                                                       " & vbNewLine _
                                          & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_NM                                                                               " & vbNewLine _
                                          & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_NM                                                                     " & vbNewLine _
                                          & "      ELSE MDOUT.DEST_NM                                                                                                       " & vbNewLine _
                                          & " END              AS DEST_NM                                                                                                   " & vbNewLine _
                                          & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_AD_1                                                                             " & vbNewLine _
                                          & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_AD_1                                                                   " & vbNewLine _
                                          & "      ELSE MDOUT.AD_1                                                                                                          " & vbNewLine _
                                          & " END              AS DEST_AD_1                                                                                                 " & vbNewLine _
                                          & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_AD_2                                                                             " & vbNewLine _
                                          & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_AD_2                                                                   " & vbNewLine _
                                          & "      ELSE MDOUT.AD_2                                                                                                          " & vbNewLine _
                                          & " END              AS DEST_AD_2                                                                                                 " & vbNewLine _
                                          & ",OUTL.DEST_AD_3   AS DEST_AD_3                                                                                                 " & vbNewLine _
                                          & ",OUTL.DEST_TEL    AS DEST_TEL                                                                                                  " & vbNewLine _
                                          & ",OUTL.OUTKA_PLAN_DATE   AS OUTKA_PLAN_DATE                                                                                     " & vbNewLine _
                                          & ",OUTL.CUST_ORD_NO       AS CUST_ORD_NO                                                                                         " & vbNewLine _
                                          & ",OUTL.BUYER_ORD_NO      AS BUYER_ORD_NO                                                                                        " & vbNewLine _
                                          & ",MUCO.UNSOCO_NM         AS UNSOCO_NM                                                                                           " & vbNewLine _
                                          & ",OUTL.ARR_PLAN_DATE     AS ARR_PLAN_DATE                                                                                       " & vbNewLine _
                                          & ",KBN1.KBN_NM1           AS ARR_PLAN_TIME                                                                                       " & vbNewLine _
                                          & ",OUTL.OUTKA_NO_L        AS OUTKA_NO_L                                                                                          " & vbNewLine _
                                          & "--20150709                                                                                             " & vbNewLine _
                                          & ",CASE WHEN EDIN.TOKUI_CD <> EDIN.CHOKUSO_CD THEN  MDTOKUI.DEST_NM          " & vbNewLine _
                                          & "WHEN EDIN.TOKUI_CD <> EDIN.SUNDRY_CD  THEN  MDTOKUI.DEST_NM           " & vbNewLine _
                                          & "ELSE EDIL.DEST_NM END       AS URIG_NM          " & vbNewLine _
                                          & "                                                                                          " & vbNewLine _
                                          & "--20150709                                                                                          " & vbNewLine _
                                          & ",MC.CUST_NM_L           AS CUST_NM_L                                                                                           " & vbNewLine _
                                          & "--(2012.06.15) 要望番号1155 -- START --                                                                                        " & vbNewLine _
                                          & ",MC.CUST_NM_M           AS CUST_NM_M                                                                                           " & vbNewLine _
                                          & "--(2012.06.15) 要望番号1155 --  END  --                                                                                        " & vbNewLine _
                                          & ",MC.AD_1                AS CUST_AD_1                                                                                           " & vbNewLine _
                                          & ",MC.AD_2                AS CUST_AD_2                                                                                           " & vbNewLine _
                                          & ",MC.TEL                 AS CUST_TEL                                                                                            " & vbNewLine _
                                          & ",MC.DENPYO_NM           AS DENPYO_NM                                                                                            " & vbNewLine _
                                          & ",MNRS.NRS_BR_NM         AS NRS_BR_NM                                                                                           " & vbNewLine _
                                          & ",CASE WHEN MSO.WH_KB = '01' THEN MSO.AD_1                                                                             " & vbNewLine _
                                          & "      ELSE MNRS.AD_1                                                                                                          " & vbNewLine _
                                          & " END              AS NRS_BR_AD1                                                                                                 " & vbNewLine _
                                          & ",CASE WHEN MSO.WH_KB = '01' THEN MSO.AD_2                                                                             " & vbNewLine _
                                          & "      ELSE MNRS.AD_2                                                                                                          " & vbNewLine _
                                          & " END              AS NRS_BR_AD2                                                                                                 " & vbNewLine _
                                          & ",CASE WHEN MSO.WH_KB = '01' THEN MSO.TEL                                                                             " & vbNewLine _
                                          & "      ELSE MNRS.TEL                                                                                                          " & vbNewLine _
                                          & " END              AS NRS_BR_TEL                                                                                                 " & vbNewLine _
                                          & ",CASE WHEN MSO.WH_KB = '01' THEN MSO.FAX                                                                             " & vbNewLine _
                                          & "      ELSE MNRS.FAX                                                                                                          " & vbNewLine _
                                          & " END              AS NRS_BR_FAX                                                                                                 " & vbNewLine _
                                          & ",MUSER.USER_NM          AS PIC                                                                                                 " & vbNewLine _
                                          & ",OUTM.OUTKA_NO_M        AS OUTKA_NO_M                                                                                          " & vbNewLine _
                                          & ",OUTS.OUTKA_NO_S        AS OUTKA_NO_S                                                                                          " & vbNewLine _
                                          & ",CASE WHEN MGD.SET_NAIYO = '1' THEN ''                                                                                         " & vbNewLine _
                                          & "      WHEN INL.INKA_STATE_KB < '50' THEN INL.INKA_DATE                                                                         " & vbNewLine _
                                          & "      WHEN INL.INKA_STATE_KB >= '50' THEN ZAI.INKO_DATE                                                                        " & vbNewLine _
                                          & "      ELSE ''                                                                                                                  " & vbNewLine _
                                          & " END                    AS INKA_DATE                                                                                           " & vbNewLine _
                                          & ",ZAI.REMARK_OUT         AS REMARK_OUT                                                                                          " & vbNewLine _
                                          & ",CASE WHEN (MDGE.GOODS_NM IS NOT NULL AND MDGE.GOODS_NM <> '' AND EDIL.OUTKA_CTL_NO IS NOT NULL) THEN MDGE.GOODS_NM            " & vbNewLine _
                                          & "      WHEN (MDGL.GOODS_NM IS NOT NULL AND MDGL.GOODS_NM <> '' AND EDIL.OUTKA_CTL_NO IS NULL) THEN MDGL.GOODS_NM                " & vbNewLine _
                                          & "      ELSE MG.GOODS_NM_1                                                                                                       " & vbNewLine _
                                          & " END                    AS GOODS_NM_1                                                                                          " & vbNewLine _
                                          & ",OUTS.LOT_NO            AS LOT_NO                                                                                              " & vbNewLine _
                                          & ",OUTS.SERIAL_NO         AS SERIAL_NO                                                                                           " & vbNewLine _
                                          & ",OUTS.IRIME             AS IRIME                                                                                               " & vbNewLine _
                                          & ",MG.PKG_NB              AS PKG_NB                                                                                              " & vbNewLine _
                                          & ",OUTS.ALCTD_NB / MG.PKG_NB     AS KONSU                                                                                        " & vbNewLine _
                                          & ",OUTS.ALCTD_NB % MG.PKG_NB     AS HASU                                                                                         " & vbNewLine _
                                          & ",OUTS.ALCTD_NB          AS ALCTD_NB                                                                                            " & vbNewLine _
                                          & ",MG.PKG_UT              AS PKG_UT                                                                                              " & vbNewLine _
                                          & ",KBN5.KBN_NM1           AS PKG_UT_NM                                                                                           " & vbNewLine _
                                          & ",OUTS.ALCTD_QT          AS ALCTD_QT                                                                                            " & vbNewLine _
                                          & ",MG.STD_IRIME_UT        AS IRIME_UT                                                                                            " & vbNewLine _
                                          & "--(2012.10.01)要望番号1445 -- START --                                                                                         " & vbNewLine _
                                          & ",UL.UNSO_WT             AS WT                                                                                                  " & vbNewLine _
                                          & "--,OUTS.BETU_WT * OUTS.ALCTD_NB  AS WT                                                                                         " & vbNewLine _
                                          & "--(2012.10.01)要望番号1445 --  END  --                                                                                         " & vbNewLine _
                                          & ",0                      AS UNSO_WT                                                                                             " & vbNewLine _
                                          & ",OUTS.TOU_NO            AS TOU_NO                                                                                              " & vbNewLine _
                                          & ",OUTS.SITU_NO           AS SITU_NO                                                                                             " & vbNewLine _
                                          & ",RTRIM(OUTS.ZONE_CD)     AS ZONE_CD                                                                                             " & vbNewLine _
                                          & ",OUTS.LOCA              AS LOCA                                                                                                " & vbNewLine _
                                          & ",OUTS.ALCTD_CAN_NB / MG.PKG_NB   AS ZAN_KONSU                                                                                  " & vbNewLine _
                                          & ",OUTS.ALCTD_CAN_NB % MG.PKG_NB   AS ZAN_HASU                                                                                   " & vbNewLine _
                                          & ",MG.GOODS_CD_CUST       AS GOODS_CD_CUST                                                                                       " & vbNewLine _
                                          & ",OUTM.REMARK            AS REMARK_M                                                                                            " & vbNewLine _
                                          & "--★★★変更開始--------------------------------                                                                                     " & vbNewLine _
                                          & ",''   AS CUST_NM_S                                                                                           " & vbNewLine _
                                          & ",''   AS CUST_NM_S_H                                                                                           " & vbNewLine _
                                          & "--★★★変更終了--------------------------------                                                                                     " & vbNewLine _
                                          & ",OUTM.CUST_ORD_NO_DTL   AS CUST_ORD_NO_DTL                                                                                     " & vbNewLine _
                                          & ",EDIL2.REMARK            AS OUTKA_REMARK                                                                                        " & vbNewLine _
                                          & ",UL.REMARK              AS HAISOU_REMARK                                                                                       " & vbNewLine _
                                          & ",OUTL.NHS_REMARK        AS NHS_REMARK                                                                                          " & vbNewLine _
                                          & "--(2012.08.06) 発JIS、着JISが共に同じJISでも、必ず0㎞になるのを修正  --- START ---                                             " & vbNewLine _
                                          & "--,CASE WHEN (OUTL.DEST_KB = '02' AND MDEDI.KYORI > 0) THEN MDEDI.KYORI                                                        " & vbNewLine _
                                          & "--      WHEN (OUTL.DEST_KB = '02' AND MDEDI.KYORI = 0 AND EDIL.DEST_JIS_CD < MSO.JIS_CD) THEN MKY3.KYORI                       " & vbNewLine _
                                          & "--      WHEN (OUTL.DEST_KB = '02' AND MDEDI.KYORI = 0 AND MSO.JIS_CD < EDIL.DEST_JIS_CD) THEN MKY4.KYORI                       " & vbNewLine _
                                          & "--      WHEN (OUTL.DEST_KB <> '02' AND MDOUT.KYORI > 0) THEN MDOUT.KYORI                                                       " & vbNewLine _
                                          & "--      WHEN (OUTL.DEST_KB <> '02' AND MDOUT.KYORI = 0 AND MDOUT.JIS < MSO.JIS_CD) THEN MKY1.KYORI                             " & vbNewLine _
                                          & "--      WHEN (OUTL.DEST_KB <> '02' AND MDOUT.KYORI = 0 AND MSO.JIS_CD < MDOUT.JIS) THEN MKY2.KYORI                             " & vbNewLine _
                                          & "--      ELSE 0                                                                                                                 " & vbNewLine _
                                          & "-- END                  AS KYORI                                                                                               " & vbNewLine _
                                          & ",CASE WHEN (OUTL.DEST_KB = '02' AND MDEDI.KYORI > 0) THEN MDEDI.KYORI                                                          " & vbNewLine _
                                          & "      WHEN (OUTL.DEST_KB = '02' AND MDEDI.KYORI = 0 AND EDIL.DEST_JIS_CD <= MSO.JIS_CD) THEN MKY3.KYORI                        " & vbNewLine _
                                          & "      WHEN (OUTL.DEST_KB = '02' AND MDEDI.KYORI = 0 AND MSO.JIS_CD <= EDIL.DEST_JIS_CD) THEN MKY4.KYORI                        " & vbNewLine _
                                          & "      WHEN (OUTL.DEST_KB <> '02' AND MDOUT.KYORI > 0) THEN MDOUT.KYORI                                                         " & vbNewLine _
                                          & "      WHEN (OUTL.DEST_KB <> '02' AND MDOUT.KYORI = 0 AND MDOUT.JIS <= MSO.JIS_CD) THEN MKY1.KYORI                              " & vbNewLine _
                                          & "      WHEN (OUTL.DEST_KB <> '02' AND MDOUT.KYORI = 0 AND MSO.JIS_CD <= MDOUT.JIS) THEN MKY2.KYORI                              " & vbNewLine _
                                          & "      ELSE 0                                                                                                                   " & vbNewLine _
                                          & " END                    AS KYORI                                                                                               " & vbNewLine _
                                          & "--(2012.08.06) 発JIS、着JISが共に同じJISでも、必ず0㎞になるのを修正  ---  END  ---                                             " & vbNewLine _
                                          & ",OUTL.OUTKA_PKG_NB      AS OUTKA_PKG_NB_L                                                                                      " & vbNewLine _
                                          & ",KBN2.KBN_NM1           AS SOKO_NM                                                                                             " & vbNewLine _
                                          & ",KBN3.KBN_NM1           AS BUSHO_NM                                                                                            " & vbNewLine _
                                          & ",KBN4.KBN_NM1           AS NRS_BR_NM_NICHI                                                                                     " & vbNewLine _
                                          & ",OUTS.ALCTD_CAN_QT      AS ALCTD_CAN_QT                                                                                        " & vbNewLine _
                                          & ",OUTM.ALCTD_KB          AS ALCTD_KB                                                                                            " & vbNewLine _
                                          & ",'0'                    AS PTN_FLAG                                                                                            " & vbNewLine _
                                          & ",OUTL.CUST_CD_L         AS CUST_CD_L                                                                                           " & vbNewLine _
                                          & ",OUTL.ORDER_TYPE        AS ORDER_TYPE                                                                                          " & vbNewLine _
                                          & ",ZAI.LT_DATE                                                                                                                   " & vbNewLine _
                                          & ",OUTM.BUYER_ORD_NO_DTL AS BUYER_ORD_NO_DTL                                                                                     " & vbNewLine _
                                          & ",ZAI.GOODS_COND_KB_2 AS GOODS_COND_CD                                                                                          " & vbNewLine _
                                          & ",ZAI.REMARK AS REMARK_ZAI                                                                                                      " & vbNewLine _
                                          & ",KBN6.KBN_NM2 AS TITLE_SMPL                                                                                                    " & vbNewLine _
                                          & ",OUTS.ALCTD_CAN_NB AS ALCTD_CAN_NB                                                                                             " & vbNewLine _
                                          & ",OUTM.BACKLOG_QT                                                                                                               " & vbNewLine _
                                          & ",KBN7.KBN_NM2 AS DOKU_NM                                                                                                       " & vbNewLine _
                                          & "--【要望番号995】　2012/04/17　元着払い区分　START                                                                             " & vbNewLine _
                                          & ",KBN9.KBN_NM2 AS PC_KB_NM                                                                                                      " & vbNewLine _
                                          & "--【要望番号995】　2012/04/17　元着払い区分　 END                                                                              " & vbNewLine _
                                          & "--日医工対策開始                                                                                                               " & vbNewLine _
                                          & ",EDIL.FREE_C01           AS TORI_KB                                                                                            " & vbNewLine _
                                          & ",CASE WHEN ISNULL(EDIL.SHIP_CD_L,'') <>'' THEN EDIL.EDI_DEST_CD                                                                                                                   " & vbNewLine _
                                          & " ELSE '' END AS SHIP_CD_L " & vbNewLine _
                                          & "--★削除開始2012/05/11                                                                                                         " & vbNewLine _
                                             & "--,EDIL.SHIP_NM_L          AS CHOKUSO_NM1                                                                                      " & vbNewLine _
                                             & "--,EDIL.FREE_C11           AS CHOKUSO_CD                                                                                       " & vbNewLine _
                                             & "--,EDIL.FREE_C08           AS HAKKO_DATE                                                                                       " & vbNewLine _
                                             & "--★削除終了2012/05/11                                                                                                         " & vbNewLine _
                                             & ",MCD_N.SET_NAIYO         AS SET_NAIYO_4                                                                                        " & vbNewLine _
                                             & ",MCD_N.SET_NAIYO_2       AS SET_NAIYO_5                                                                                        " & vbNewLine _
                                             & ",MCD_N.SET_NAIYO_3       AS SET_NAIYO_6                                                                                        " & vbNewLine _
                                             & ",MG.GOODS_NM_2           AS GOODS_NM_2                                                                                         " & vbNewLine _
                                             & ",EDIM.FREE_C02           AS KICHO_KB                                                                                           " & vbNewLine _
                                             & ",EDIM.FREE_C03           AS SEI_YURAI_KB                                                                                       " & vbNewLine _
                                             & ",EDIM.FREE_C04           AS REMARK_UPPER      --群馬篠崎運送利用                                                               " & vbNewLine _
                                             & ",EDIM.FREE_C05           AS REMARK_LOWER                                                                                       " & vbNewLine _
                                             & ",EDIM.FREE_C06           AS GOODS_SYUBETU     --群馬篠崎運送利用                                                               " & vbNewLine _
                                             & ",EDIM.FREE_C01           AS YUKOU_KIGEN                                                                                        " & vbNewLine _
                                             & ",MG.GOODS_NM_3           AS GOODS_NM_3         --2012/05/23                                                                    " & vbNewLine _
                                             & ",MDOUTU.EDI_CD           AS EDISHIP_CD         --2012/05/23                                                                    " & vbNewLine _
                                             & ",MDOUT.EDI_CD            AS EDIDEST_CD         --2012/05/23                                                                    " & vbNewLine _
                                             & "--日医工対策終了                                                                                                               " & vbNewLine _
                                             & "--(2012.06.01) 日本ﾌｧｲﾝ対応  --- START ---                                                                                     " & vbNewLine _
                                             & ",MCD_F.SET_NAIYO         AS SET_NAIYO_FROM1                                                                                    " & vbNewLine _
                                             & ",MCD_F.SET_NAIYO_2       AS SET_NAIYO_FROM2                                                                                    " & vbNewLine _
                                             & ",MCD_F.SET_NAIYO_3       AS SET_NAIYO_FROM3                                                                                    " & vbNewLine _
                                             & "--(2012.06.01) 日本ﾌｧｲﾝ対応  --- START ---                                                                                     " & vbNewLine _
                                             & "--【要望番号1122】埼玉対応 --- START ---                                                                                       " & vbNewLine _
                                             & ",MC.AD_3                 AS CUST_AD_3                                                                                          " & vbNewLine _
                                             & ",MDOUT.REMARK            AS DEST_REMARK                                                                                        " & vbNewLine _
                                             & ",MDOUT.SALES_CD          AS DEST_SALES_CD                                                                                      " & vbNewLine _
                                             & ",MC_SALES.CUST_NM_L      AS DEST_SALES_NM                                                                                      " & vbNewLine _
                                             & ",MC_SALES.AD_1           AS DEST_SALES_AD_1                                                                                    " & vbNewLine _
                                             & ",MC_SALES.AD_2           AS DEST_SALES_AD_2                                                                                    " & vbNewLine _
                                             & ",MC_SALES.AD_3           AS DEST_SALES_AD_3                                                                                    " & vbNewLine _
                                             & ",MC_SALES.TEL            AS DEST_SALES_TEL                                                                                     " & vbNewLine _
                                             & "--【要望番号1122】埼玉対応 ---  END  ---                                                                                       " & vbNewLine _
                                             & "--群馬篠崎運送向け自由項目対応　開始　                                                                                         " & vbNewLine _
                                             & ",EDIM.FREE_C07           AS SZ01_YUSO --篠崎                                                                                   " & vbNewLine _
                                             & ",EDIM.FREE_C09           AS SZ01_UNSO --篠崎                                                                                   " & vbNewLine _
                                             & "--群馬篠崎運送向け自由項目対応　終了                                                                                         　" & vbNewLine _
                                             & ",ISNULL(MG.SHOBO_CD,'')  AS SHOBO_CD                                                                                           " & vbNewLine


    Friend Const SQL_FROM_OUTKA_NIK As String = "--出荷L                                                                                                                      " & vbNewLine _
                                             & "FROM                                                                                                                           " & vbNewLine _
                                             & "$LM_TRN$..C_OUTKA_L OUTL                                                                                                       " & vbNewLine _
                                             & "--トランザクションテーブル                                                                                                     " & vbNewLine _
                                             & "--出荷M                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..C_OUTKA_M OUTM                                                                                             " & vbNewLine _
                                             & "ON  OUTM.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "AND OUTM.OUTKA_NO_L = OUTL.OUTKA_NO_L                                                                                          " & vbNewLine _
                                             & "AND OUTM.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--★★★追加開始--------------------------------                                                                               " & vbNewLine _
                                             & "--出荷M(中MIN)                                                                                                                 " & vbNewLine _
                                             & "LEFT OUTER JOIN                                                                                                                " & vbNewLine _
                                             & "       (SELECT                                                                                                                 " & vbNewLine _
                                             & "           NRS_BR_CD                                                                                                           " & vbNewLine _
                                             & "           ,OUTKA_NO_L                                                                                                         " & vbNewLine _
                                             & "           ,MIN(OUTKA_NO_M) AS  OUTKA_NO_M                                                                                     " & vbNewLine _
                                             & "       FROM $LM_TRN$..C_OUTKA_M WHERE SYS_DEL_FLG ='0'                                                                         " & vbNewLine _
                                             & "        AND NRS_BR_CD = @NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "        AND OUTKA_NO_L = @KANRI_NO_L                                                                                           " & vbNewLine _
                                             & "       GROUP BY NRS_BR_CD,OUTKA_NO_L) OUTM_MIN                                                                                 " & vbNewLine _
                                             & "       ON OUTM_MIN.NRS_BR_CD        = OUTL.NRS_BR_CD                                                                           " & vbNewLine _
                                             & "       AND OUTM_MIN.OUTKA_NO_L      = OUTL.OUTKA_NO_L                                                                          " & vbNewLine _
                                             & "--出荷M(中MIN)                                                                                                                 " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..C_OUTKA_M OUTM2                                                                                            " & vbNewLine _
                                             & "ON  OUTM2.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                           " & vbNewLine _
                                             & "AND OUTM2.OUTKA_NO_L = OUTL.OUTKA_NO_L                                                                                         " & vbNewLine _
                                             & "AND OUTM2.OUTKA_NO_M = OUTM_MIN.OUTKA_NO_M                                                                                     " & vbNewLine _
                                             & "AND OUTM2.SYS_DEL_FLG = '0'                                                                                                    " & vbNewLine _
                                             & "--★★★追加終了--------------------------------                                                                               " & vbNewLine _
                                             & "--出荷S                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..C_OUTKA_S OUTS                                                                                             " & vbNewLine _
                                             & "ON  OUTS.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "AND OUTS.OUTKA_NO_L = OUTL.OUTKA_NO_L                                                                                          " & vbNewLine _
                                             & "AND OUTS.OUTKA_NO_M = OUTM.OUTKA_NO_M                                                                                          " & vbNewLine _
                                             & "AND OUTS.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & " LEFT JOIN (                                                                                                                   " & vbNewLine _
                                             & "            SELECT                                                                                                             " & vbNewLine _
                                             & "                   NRS_BR_CD                                                                                                   " & vbNewLine _
                                             & "                 , EDI_CTL_NO                                                                                                  " & vbNewLine _
                                             & "                 , OUTKA_CTL_NO                                                                                                " & vbNewLine _
                                             & "             FROM (                                                                                                            " & vbNewLine _
                                             & "                    SELECT                                                                                                     " & vbNewLine _
                                             & "                           EDIOUTL.NRS_BR_CD                                                                                   " & vbNewLine _
                                             & "                         , EDIOUTL.EDI_CTL_NO                                                                                  " & vbNewLine _
                                             & "                         , EDIOUTL.OUTKA_CTL_NO                                                                                " & vbNewLine _
                                             & "                         , CASE WHEN EDIOUTL.OUTKA_CTL_NO = '' THEN 1                                                          " & vbNewLine _
                                             & "                           ELSE ROW_NUMBER() OVER (PARTITION BY EDIOUTL.NRS_BR_CD                                              " & vbNewLine _
                                             & "                                                              , EDIOUTL.OUTKA_CTL_NO                                           " & vbNewLine _
                                             & "                                                       ORDER BY EDIOUTL.NRS_BR_CD                                              " & vbNewLine _
                                             & "                                                              , EDIOUTL.EDI_CTL_NO                                             " & vbNewLine _
                                             & "                                                  )                                                                            " & vbNewLine _
                                             & "                           END AS IDX                                                                                          " & vbNewLine _
                                             & "                     FROM $LM_TRN$..H_OUTKAEDI_L EDIOUTL                                                                       " & vbNewLine _
                                             & "                    WHERE EDIOUTL.SYS_DEL_FLG  = '0'                                                                           " & vbNewLine _
                                             & "                      AND EDIOUTL.NRS_BR_CD    = @NRS_BR_CD                                                                    " & vbNewLine _
                                             & "                      AND EDIOUTL.OUTKA_CTL_NO = @KANRI_NO_L                                                                   " & vbNewLine _
                                             & "                  ) EBASE                                                                                                      " & vbNewLine _
                                             & "            WHERE EBASE.IDX = 1                                                                                                " & vbNewLine _
                                             & "            ) TOPEDI                                                                                                           " & vbNewLine _
                                             & "        ON TOPEDI.NRS_BR_CD    = OUTL.NRS_BR_CD                                                                                " & vbNewLine _
                                             & "       AND TOPEDI.OUTKA_CTL_NO = OUTL.OUTKA_NO_L                                                                               " & vbNewLine _
                                             & " LEFT JOIN $LM_TRN$..H_OUTKAEDI_L EDIL                                                                                         " & vbNewLine _
                                             & "        ON EDIL.NRS_BR_CD  = TOPEDI.NRS_BR_CD                                                                                  " & vbNewLine _
                                             & "       AND EDIL.EDI_CTL_NO = TOPEDI.EDI_CTL_NO                                                                                 " & vbNewLine _
                                             & "--(2012.09.06)要望番号1412対応  ---  END  ---                                                                                  " & vbNewLine _
                                             & "--入荷L                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..B_INKA_L INL                                                                                               " & vbNewLine _
                                             & "ON  INL.NRS_BR_CD = OUTS.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "AND INL.INKA_NO_L = OUTS.INKA_NO_L                                                                                             " & vbNewLine _
                                             & "AND INL.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--入荷S                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..B_INKA_S INS                                                                                               " & vbNewLine _
                                             & "ON  INS.NRS_BR_CD = OUTS.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "AND INS.INKA_NO_L = OUTS.INKA_NO_L                                                                                             " & vbNewLine _
                                             & "AND INS.INKA_NO_M = OUTS.INKA_NO_M                                                                                             " & vbNewLine _
                                             & "AND INS.INKA_NO_S = OUTS.INKA_NO_S                                                                                             " & vbNewLine _
                                             & "AND INS.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--運送L                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..F_UNSO_L UL                                                                                                " & vbNewLine _
                                             & "ON  UL.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                              " & vbNewLine _
                                             & "AND UL.INOUTKA_NO_L = OUTL.OUTKA_NO_L                                                                                          " & vbNewLine _
                                             & "AND UL.MOTO_DATA_KB = '20'                                                                                                     " & vbNewLine _
                                             & "AND UL.SYS_DEL_FLG = '0'                                                                                                       " & vbNewLine _
                                             & "--在庫テーブル                                                                                                                 " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..D_ZAI_TRS ZAI                                                                                              " & vbNewLine _
                                             & "ON  ZAI.NRS_BR_CD = OUTS.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "AND ZAI.ZAI_REC_NO = OUTS.ZAI_REC_NO                                                                                           " & vbNewLine _
                                             & "AND ZAI.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--マスタテーブル                                                                                                               " & vbNewLine _
                                             & "--営業所M                                                                                                                      " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_NRS_BR MNRS                                                                                              " & vbNewLine _
                                             & "ON MNRS.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "--商品M                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_GOODS MG                                                                                                 " & vbNewLine _
                                             & "ON  MG.NRS_BR_CD = OUTM.NRS_BR_CD                                                                                              " & vbNewLine _
                                             & "AND MG.GOODS_CD_NRS = OUTM.GOODS_CD_NRS                                                                                        " & vbNewLine _
                                             & "--★★★追加開始--------------------------------                                                                                     " & vbNewLine _
                                             & "--商品M(MIN)                                                                                                                   " & vbNewLine _
                                             & "LEFT OUTER JOIN $LM_MST$..M_GOODS M_GOODS_MIN                                                                                  " & vbNewLine _
                                             & "ON M_GOODS_MIN.NRS_BR_CD      = OUTL.NRS_BR_CD                                                                                 " & vbNewLine _
                                             & "AND M_GOODS_MIN.GOODS_CD_NRS   = OUTM2.GOODS_CD_NRS                                                                            " & vbNewLine _
                                             & "--★★★追加終了--------------------------------                                                                                     " & vbNewLine _
                                             & "--荷主M(商品M経由)                                                                                                             " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST MC                                                                                                  " & vbNewLine _
                                             & "ON  MC.NRS_BR_CD = MG.NRS_BR_CD                                                                                                " & vbNewLine _
                                             & "AND MC.CUST_CD_L = MG.CUST_CD_L                                                                                                " & vbNewLine _
                                             & "AND MC.CUST_CD_M = MG.CUST_CD_M                                                                                                " & vbNewLine _
                                             & "AND MC.CUST_CD_S = MG.CUST_CD_S                                                                                                " & vbNewLine _
                                             & "AND MC.CUST_CD_SS = MG.CUST_CD_SS                                                                                              " & vbNewLine _
                                             & "--★★★追加開始--------------------------------                                                                               " & vbNewLine _
                                             & "--荷主M(商品M経由) 最小の出荷(中)で抽出                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST MC2                                                                                                 " & vbNewLine _
                                             & "ON  MC2.NRS_BR_CD = M_GOODS_MIN.NRS_BR_CD                                                                                      " & vbNewLine _
                                             & "AND MC2.CUST_CD_L = M_GOODS_MIN.CUST_CD_L                                                                                      " & vbNewLine _
                                             & "AND MC2.CUST_CD_M = M_GOODS_MIN.CUST_CD_M                                                                                      " & vbNewLine _
                                             & "AND MC2.CUST_CD_S = M_GOODS_MIN.CUST_CD_S                                                                                      " & vbNewLine _
                                             & "AND MC2.CUST_CD_SS = M_GOODS_MIN.CUST_CD_SS                                                                                    " & vbNewLine _
                                             & "AND MC2.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--★★★追加終了--------------------------------                                                                               " & vbNewLine _
                                             & "--届先M(届先取得)(出荷L参照)                                                                                                   " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_DEST MDOUT                                                                                               " & vbNewLine _
                                             & "ON  MDOUT.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                           " & vbNewLine _
                                             & "AND MDOUT.CUST_CD_L = OUTL.CUST_CD_L                                                                                           " & vbNewLine _
                                             & "AND MDOUT.DEST_CD = OUTL.DEST_CD                                                                                               " & vbNewLine _
                                             & "--20150709 NIK JOIN                                                                                                                     " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_DEST MDTOKUI                                                                                                " & vbNewLine _
                                             & "ON MDTOKUI.NRS_BR_CD = EDIL.NRS_BR_CD                                                                                           " & vbNewLine _
                                             & "AND MDTOKUI.CUST_CD_L = EDIL.CUST_CD_L                                                                                                  " & vbNewLine _
                                             & "AND MDTOKUI.DEST_CD = EDIL.FREE_C10                                                                                                    " & vbNewLine _
                                             & "AND MDTOKUI.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--届先M(売上先取得)(出荷L参照)                                                                                                 " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_DEST MDOUTU                                                                                              " & vbNewLine _
                                             & "ON  MDOUTU.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                          " & vbNewLine _
                                             & "AND MDOUTU.CUST_CD_L = OUTL.CUST_CD_L                                                                                          " & vbNewLine _
                                             & "AND MDOUTU.DEST_CD = OUTL.SHIP_CD_L                                                                                            " & vbNewLine _
                                             & "--届先M(届先取得)(出荷EDIL参照)                                                                                                " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_DEST MDEDI                                                                                               " & vbNewLine _
                                             & "ON  MDEDI.NRS_BR_CD = EDIL.NRS_BR_CD                                                                                           " & vbNewLine _
                                             & "AND MDEDI.CUST_CD_L = EDIL.CUST_CD_L                                                                                           " & vbNewLine _
                                             & "AND MDEDI.DEST_CD = EDIL.DEST_CD                                                                                               " & vbNewLine _
                                             & "--【要望番号1122】埼玉対応 --- START ---                                                                                       " & vbNewLine _
                                             & "--届先M(納品書荷主名義名取得)(届先M参照)                                                                                       " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST MC_SALES                                                                                            " & vbNewLine _
                                             & "       ON MC_SALES.NRS_BR_CD  = MDOUT.NRS_BR_CD                                                                                " & vbNewLine _
                                             & "      AND MC_SALES.CUST_CD_L  = MDOUT.SALES_CD                                                                                 " & vbNewLine _
                                             & "      AND MC_SALES.CUST_CD_M  = '00'                                                                                           " & vbNewLine _
                                             & "      AND MC_SALES.CUST_CD_S  = '00'                                                                                           " & vbNewLine _
                                             & "      AND MC_SALES.CUST_CD_SS = '00'                                                                                           " & vbNewLine _
                                             & "--【要望番号1122】埼玉対応 ---  END  ---                                                                                       " & vbNewLine _
                                             & "--運送会社M                                                                                                                    " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_UNSOCO MUCO                                                                                              " & vbNewLine _
                                             & "ON  MUCO.NRS_BR_CD = UL.NRS_BR_CD                                                                                              " & vbNewLine _
                                             & "AND MUCO.UNSOCO_CD = UL.UNSO_CD                                                                                                " & vbNewLine _
                                             & "AND MUCO.UNSOCO_BR_CD = UL.UNSO_BR_CD                                                                                          " & vbNewLine _
                                             & "--倉庫M                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_SOKO MSO                                                                                                 " & vbNewLine _
                                             & "ON  MSO.NRS_BR_CD = OUTL.NRS_BR_CD  --追加                                                                                     " & vbNewLine _
                                             & "AND MSO.WH_CD     = OUTL.WH_CD                                                                                                 " & vbNewLine _
                                             & "--距離程M(M_DEST.JIS < M_SOKO.JIS_CD)(出荷L参照)                                                                               " & vbNewLine _
                                             & "--2014/5/16Start s.kobayashi NotesNo.2183                                                                                      " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN11                                                                                                " & vbNewLine _
                                             & "ON  KBN11.KBN_GROUP_CD = 'U028'  --追加                                                                                        " & vbNewLine _
                                             & "AND UL.SEIQ_TARIFF_CD = KBN11.KBN_NM1                                                                                          " & vbNewLine _
                                             & "--2014/5/16End s.kobayashi NotesNo.2183                                                                                       " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_KYORI MKY1                                                                                               " & vbNewLine _
                                             & "ON  MKY1.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "--AND MKY1.KYORI_CD = MC.BETU_KYORI_CD                                                                                         " & vbNewLine _
                                             & "AND MKY1.KYORI_CD = (CASE ISNULL(KBN11.KBN_NM2,'') WHEN '' THEN MC.BETU_KYORI_CD ELSE KBN11.KBN_NM2 END)                       " & vbNewLine _
                                             & "AND MKY1.ORIG_JIS_CD = MDOUT.JIS                                                                                               " & vbNewLine _
                                             & "AND MKY1.DEST_JIS_CD = MSO.JIS_CD                                                                                              " & vbNewLine _
                                             & "--距離程M(M_SOKO.JIS_CD < M_DEST.JIS)(出荷L参照)                                                                               " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_KYORI MKY2                                                                                               " & vbNewLine _
                                             & "ON  MKY2.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "--AND MKY2.KYORI_CD = MC.BETU_KYORI_CD                                                                                           " & vbNewLine _
                                             & "AND MKY2.KYORI_CD = (CASE ISNULL(KBN11.KBN_NM2,'') WHEN '' THEN MC.BETU_KYORI_CD ELSE KBN11.KBN_NM2 END)                       " & vbNewLine _
                                             & "AND MKY2.ORIG_JIS_CD = MSO.JIS_CD                                                                                              " & vbNewLine _
                                             & "AND MKY2.DEST_JIS_CD = MDOUT.JIS                                                                                               " & vbNewLine _
                                             & "--距離程M(H_OUTKAEDI_L.DEST_JIS_CD < M_SOKO.JIS_CD)(出荷EDIL参照)                                                              " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_KYORI MKY3                                                                                               " & vbNewLine _
                                             & "ON  MKY3.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "--AND MKY3.KYORI_CD = MC.BETU_KYORI_CD                                                                                           " & vbNewLine _
                                             & "AND MKY3.KYORI_CD = (CASE ISNULL(KBN11.KBN_NM2,'') WHEN '' THEN MC.BETU_KYORI_CD ELSE KBN11.KBN_NM2 END)                       " & vbNewLine _
                                             & "AND MKY3.ORIG_JIS_CD = EDIL.DEST_JIS_CD                                                                                        " & vbNewLine _
                                             & "AND MKY3.DEST_JIS_CD = MSO.JIS_CD                                                                                              " & vbNewLine _
                                             & "--距離程M(M_SOKO.JIS_CD < H_OUTKAEDI_L.DEST_JIS_CD)(出荷EDIL参照)                                                              " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_KYORI MKY4                                                                                               " & vbNewLine _
                                             & "ON  MKY4.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "--AND MKY4.KYORI_CD = MC.BETU_KYORI_CD                                                                                           " & vbNewLine _
                                             & "AND MKY4.KYORI_CD = (CASE ISNULL(KBN11.KBN_NM2,'') WHEN '' THEN MC.BETU_KYORI_CD ELSE KBN11.KBN_NM2 END)                       " & vbNewLine _
                                             & "AND MKY4.ORIG_JIS_CD = MSO.JIS_CD                                                                                              " & vbNewLine _
                                             & "AND MKY4.DEST_JIS_CD = EDIL.DEST_JIS_CD                                                                                        " & vbNewLine _
                                             & "--届先商品M(出荷L参照)                                                                                                         " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_DESTGOODS MDGL                                                                                           " & vbNewLine _
                                             & "ON  MDGL.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "AND MDGL.CUST_CD_L = OUTL.CUST_CD_L                                                                                            " & vbNewLine _
                                             & "AND MDGL.CUST_CD_M = OUTL.CUST_CD_M                                                                                            " & vbNewLine _
                                             & "AND MDGL.CD = OUTL.DEST_CD                                                                                                     " & vbNewLine _
                                             & "AND MDGL.GOODS_CD_NRS = MG.GOODS_CD_NRS                                                                                        " & vbNewLine _
                                             & "AND MDGL.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--届先商品M(出荷EDI参照)                                                                                                       " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_DESTGOODS MDGE                                                                                           " & vbNewLine _
                                             & "ON  MDGE.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "AND MDGE.CUST_CD_L = OUTL.CUST_CD_L                                                                                            " & vbNewLine _
                                             & "AND MDGE.CUST_CD_M = OUTL.CUST_CD_M                                                                                            " & vbNewLine _
                                             & "AND MDGE.CD = EDIL.DEST_CD                                                                                                     " & vbNewLine _
                                             & "AND MDGE.GOODS_CD_NRS = MG.GOODS_CD_NRS                                                                                        " & vbNewLine _
                                             & "AND MDGE.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--区分M(納入予定区分)                                                                                                          " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN1                                                                                                 " & vbNewLine _
                                             & "ON  KBN1.KBN_GROUP_CD = 'N010'                                                                                                 " & vbNewLine _
                                             & "AND KBN1.KBN_CD = OUTL.ARR_PLAN_TIME                                                                                           " & vbNewLine _
                                             & "AND KBN1.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--区分M(日本合成用倉庫名)                                                                                                      " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN2                                                                                                 " & vbNewLine _
                                             & "ON  KBN2.KBN_GROUP_CD = 'P005'                                                                                                 " & vbNewLine _
                                             & "AND KBN2.KBN_CD = '00'                                                                                                         " & vbNewLine _
                                             & "AND KBN2.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--区分M(日本合成用部署名)                                                                                                      " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN3                                                                                                 " & vbNewLine _
                                             & "ON  KBN3.KBN_GROUP_CD = 'P005'                                                                                                 " & vbNewLine _
                                             & "AND KBN3.KBN_CD = '01'                                                                                                         " & vbNewLine _
                                             & "AND KBN3.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--区分M(日本合成用営業署名)                                                                                                    " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN4                                                                                                 " & vbNewLine _
                                             & "ON  KBN4.KBN_GROUP_CD = 'P005'                                                                                                 " & vbNewLine _
                                             & "AND KBN4.KBN_CD = '02'                                                                                                         " & vbNewLine _
                                             & "AND KBN4.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--区分M(荷姿)                                                                                                                  " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN5                                                                                                 " & vbNewLine _
                                             & "ON  KBN5.KBN_GROUP_CD = 'N001'                                                                                                 " & vbNewLine _
                                             & "AND KBN5.KBN_CD = MG.PKG_UT                                                                                                    " & vbNewLine _
                                             & "AND KBN5.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--明細タイトル（小分け）                                                                                                       " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN6                                                                                                 " & vbNewLine _
                                             & "ON  KBN6.KBN_GROUP_CD = 'S041'                                                                                                 " & vbNewLine _
                                             & "AND KBN6.KBN_CD = OUTM.ALCTD_KB                                                                                                " & vbNewLine _
                                             & "AND KBN6.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--区分M(毒劇区分名称)                                                                                                           " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN7                                                                                                  " & vbNewLine _
                                             & "ON  KBN7.KBN_GROUP_CD = 'G001'                                                                                                  " & vbNewLine _
                                             & "AND KBN7.KBN_CD = MG.DOKU_KB                                                                                                    " & vbNewLine _
                                             & "AND KBN7.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--【要望番号995】　2012/04/17　元着払い区分　START                                                                             " & vbNewLine _
                                             & "--区分M(元着払区分名称)                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN9                                                                                                 " & vbNewLine _
                                             & "ON  KBN9.KBN_GROUP_CD = 'M001'                                                                                                 " & vbNewLine _
                                             & "AND KBN9.KBN_CD = OUTL.PC_KB                                                                                                   " & vbNewLine _
                                             & "AND KBN9.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--【要望番号995】　2012/04/17　元着払い区分　 END                                                                              " & vbNewLine _
                                             & "--日医工対策開始                                                                                                               " & vbNewLine _
                                             & "--★出荷EDI M(日医工)                                                                                                          " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..H_OUTKAEDI_M EDIM                                                                                            " & vbNewLine _
                                             & "ON  EDIM.NRS_BR_CD        = OUTM.NRS_BR_CD                                                                                     " & vbNewLine _
                                             & "AND EDIM.OUTKA_CTL_NO     = OUTM.OUTKA_NO_L                                                                                    " & vbNewLine _
                                             & "AND EDIM.OUTKA_CTL_NO_CHU = OUTM.OUTKA_NO_M                                                                                    " & vbNewLine _
                                             & "AND EDIM.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--日医工_出荷指示EDIデータ                                                                                                     " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..H_OUTKAEDI_DTL_NIK EDIN                                                                                    " & vbNewLine _
                                             & "ON   OUTL.NRS_BR_CD      = EDIN.NRS_BR_CD                                                                                      " & vbNewLine _
                                             & "AND  EDIL.EDI_CTL_NO     = EDIN.EDI_CTL_NO                                                                                     " & vbNewLine _
                                             & "AND  EDIM.EDI_CTL_NO_CHU = EDIN.EDI_CTL_NO_CHU                                                                                 " & vbNewLine _
                                             & "AND  EDIN.SYS_DEL_FLG    = '0'                                                                                                 " & vbNewLine _
                                             & "                                                                                                                               " & vbNewLine _
                                             & "--荷主明細M ★                                                                                                                 " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST_DETAILS MCD_N                                                                                       " & vbNewLine _
                                             & "ON  MCD_N.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                           " & vbNewLine _
                                             & "AND MCD_N.CUST_CD   = OUTL.CUST_CD_L                                                                                           " & vbNewLine _
                                             & "AND MCD_N.SUB_KB = '26'                                                                                                        " & vbNewLine _
                                             & "--日医工対策終了                                                                                                               " & vbNewLine _
                                             & "--(2012.06.01) 日本ﾌｧｲﾝ対応  --- START ----                                                                                    " & vbNewLine _
                                             & "--荷主明細M                                                                                                                    " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST_DETAILS MCD_F                                                                                       " & vbNewLine _
                                             & "ON  MCD_F.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                           " & vbNewLine _
                                             & "AND MCD_F.CUST_CD   = OUTL.CUST_CD_L                                                                                           " & vbNewLine _
                                             & "AND MCD_F.SUB_KB = '29'                                                                                                        " & vbNewLine _
                                             & "--(2012.06.01) 日本ﾌｧｲﾝ対応  ---  END  ----                                                                                    " & vbNewLine _
                                             & "--出荷Lでの荷主帳票パターン取得                                                                                                " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST_RPT MCR1                                                                                            " & vbNewLine _
                                             & "ON  OUTL.NRS_BR_CD = MCR1.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "AND OUTL.CUST_CD_L = MCR1.CUST_CD_L                                                                                            " & vbNewLine _
                                             & "AND OUTL.CUST_CD_M = MCR1.CUST_CD_M                                                                                            " & vbNewLine _
                                             & "AND '00' = MCR1.CUST_CD_S                                                                                                      " & vbNewLine _
                                             & "AND MCR1.PTN_ID = '04'                                                                                                         " & vbNewLine _
                                             & "--帳票パターン取得                                                                                                             " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_RPT MR1                                                                                                  " & vbNewLine _
                                             & "ON  MR1.NRS_BR_CD = MCR1.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "AND MR1.PTN_ID = MCR1.PTN_ID                                                                                                   " & vbNewLine _
                                             & "AND MR1.PTN_CD = MCR1.PTN_CD                                                                                                   " & vbNewLine _
                                             & "AND MR1.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--商品Mの荷主での荷主帳票パターン取得                                                                                          " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST_RPT MCR2                                                                                            " & vbNewLine _
                                             & "ON  MG.NRS_BR_CD = MCR2.NRS_BR_CD                                                                                              " & vbNewLine _
                                             & "AND MG.CUST_CD_L = MCR2.CUST_CD_L                                                                                              " & vbNewLine _
                                             & "AND MG.CUST_CD_M = MCR2.CUST_CD_M                                                                                              " & vbNewLine _
                                             & "AND MG.CUST_CD_S = MCR2.CUST_CD_S                                                                                              " & vbNewLine _
                                             & "AND MCR2.PTN_ID = '04'                                                                                                         " & vbNewLine _
                                             & "--帳票パターン取得                                                                                                             " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_RPT MR2                                                                                                  " & vbNewLine _
                                             & "ON  MR2.NRS_BR_CD = MCR2.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "AND MR2.PTN_ID = MCR2.PTN_ID                                                                                                   " & vbNewLine _
                                             & "AND MR2.PTN_CD = MCR2.PTN_CD                                                                                                   " & vbNewLine _
                                             & "AND MR2.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--存在しない場合の帳票パターン取得                                                                                             " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_RPT MR3                                                                                                  " & vbNewLine _
                                             & "ON  MR3.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "AND MR3.PTN_ID = '04'                                                                                                          " & vbNewLine _
                                             & "AND MR3.STANDARD_FLAG = '01'                                                                                                   " & vbNewLine _
                                             & "AND MR3.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--ユーザM                                                                                                                      " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..S_USER MUSER                                                                                               " & vbNewLine _
                                             & "ON MUSER.USER_CD = OUTL.SYS_ENT_USER                                                                                           " & vbNewLine _
                                             & "AND MUSER.SYS_DEL_FLG = '0'                                                                                                    " & vbNewLine _
                                             & "--商品明細M                                                                                                                    " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_GOODS_DETAILS MGD                                                                                        " & vbNewLine _
                                             & "ON  MGD.NRS_BR_CD = MG.NRS_BR_CD                                                                                               " & vbNewLine _
                                             & "AND MGD.GOODS_CD_NRS = MG.GOODS_CD_NRS                                                                                         " & vbNewLine _
                                             & "AND MGD.SUB_KB = '09'                                                                                                          " & vbNewLine _
                                             & "AND MGD.SYS_DEL_FLG = '0'       --ADD 2019/02/07 依頼番号 : 004605   【LMS】納品書がの梱包個数が2倍になるバグ修正              " & vbNewLine _
                                             & "LEFT JOIN (                                                                                                                        " & vbNewLine _
                                             & "  	SELECT EDIL.REMARK,EDIL.CUST_ORD_NO FROM  $LM_TRN$..C_OUTKA_L OUTL                                                                                                                        " & vbNewLine _
                                             & "  	LEFT JOIN  $LM_TRN$..H_OUTKAEDI_L EDIL                                                                                                                        " & vbNewLine _
                                             & "  	ON EDIL.OUTKA_CTL_NO = OUTL.OUTKA_NO_L                                                                                                                        " & vbNewLine _
                                             & "  	WHERE                                                                                                                        " & vbNewLine _
                                             & "  		EDIL.SYS_DEL_FLG = '0'                                                                                                                        " & vbNewLine _
                                             & "  		AND OUTL.NRS_BR_CD = @NRS_BR_CD                                                                                                                                               " & vbNewLine _
                                             & "  		AND OUTL.OUTKA_NO_L = @KANRI_NO_L                                                                                                                                       " & vbNewLine _
                                             & "  )EDIL2                                                                                                                        " & vbNewLine _
                                             & "ON OUTM.CUST_ORD_NO_DTL = EDIL2.CUST_ORD_NO                                                                                                                             " & vbNewLine

    '(2014.03.31) 追加START
    ''' <summary>
    ''' 印刷データ抽出用
    ''' </summary>
    ''' <remarks>出荷管理番号(中)をMINで抽出</remarks>
    Friend Const SQL_SELECT_MAIN_740 As String = " --SQL_SELECT_MAIN_740                                            " & vbNewLine _
                                                & " SELECT                                                           " & vbNewLine _
                                                & "        RPT_ID                                                    " & vbNewLine _
                                                & "      , NRS_BR_CD                                                 " & vbNewLine _
                                                & "      , PRINT_SORT                                                " & vbNewLine _
                                                & "      , DEST_CD                                                   " & vbNewLine _
                                                & "      , DEST_NM                                                   " & vbNewLine _
                                                & "      , DEST_AD_1                                                 " & vbNewLine _
                                                & "      , DEST_AD_2                                                 " & vbNewLine _
                                                & "      , DEST_AD_3                                                 " & vbNewLine _
                                                & "      , DEST_TEL                                                  " & vbNewLine _
                                                & "      , OUTKA_PLAN_DATE                                           " & vbNewLine _
                                                & "      , CUST_ORD_NO                                               " & vbNewLine _
                                                & "      , BUYER_ORD_NO                                              " & vbNewLine _
                                                & "      , UNSOCO_NM                                                 " & vbNewLine _
                                                & "      , ARR_PLAN_DATE                                             " & vbNewLine _
                                                & "      , ARR_PLAN_TIME                                             " & vbNewLine _
                                                & "      , OUTKA_NO_L                                                " & vbNewLine _
                                                & "      , URIG_NM                                                   " & vbNewLine _
                                                & "      , CUST_NM_L                                                 " & vbNewLine _
                                                & "      , CUST_NM_M                                                 " & vbNewLine _
                                                & "      , DENPYO_NM                                                 " & vbNewLine _
                                                & "      , CASE WHEN DEST_SALES_CD <> ''                             " & vbNewLine _
                                                & "              AND DEST_SALES_CD IS NOT NULL THEN DEST_SALES_AD_1  " & vbNewLine _
                                                & "             ELSE CUST_AD_1 END CUST_AD_1                         " & vbNewLine _
                                                & "      , CASE WHEN DEST_SALES_CD <> ''                             " & vbNewLine _
                                                & "              AND DEST_SALES_CD IS NOT NULL THEN DEST_SALES_AD_2  " & vbNewLine _
                                                & "             ELSE CUST_AD_2 END CUST_AD_2                         " & vbNewLine _
                                                & "      , CASE WHEN DEST_SALES_CD <> ''                             " & vbNewLine _
                                                & "              AND DEST_SALES_CD IS NOT NULL THEN DEST_SALES_TEL   " & vbNewLine _
                                                & "        ELSE CUST_TEL                                             " & vbNewLine _
                                                & "        END                        AS CUST_TEL                    " & vbNewLine _
                                                & "      , NRS_BR_NM                                                 " & vbNewLine _
                                                & "      , NRS_BR_AD1                                                " & vbNewLine _
                                                & "      , NRS_BR_AD2                                                " & vbNewLine _
                                                & "      , NRS_BR_TEL                                                " & vbNewLine _
                                                & "      , NRS_BR_FAX                                                " & vbNewLine _
                                                & "      , PIC                                                       " & vbNewLine _
                                                & "      , OUTKA_NO_M                 AS OUTKA_NO_M                  " & vbNewLine _
                                                & "      , ''                         AS OUTKA_NO_S                  " & vbNewLine _
                                                & "      , INKA_DATE                                                 " & vbNewLine _
                                                & "      , REMARK_OUT                                                " & vbNewLine _
                                                & "      , GOODS_NM_1                                                " & vbNewLine _
                                                & "      , LOT_NO                                                    " & vbNewLine _
                                                & "      , SERIAL_NO                                                 " & vbNewLine _
                                                & "      , IRIME                                                     " & vbNewLine _
                                                & "      , PKG_NB                                                    " & vbNewLine _
                                                & "      , SUM(ALCTD_NB) / PKG_NB     AS KONSU                       " & vbNewLine _
                                                & "      , SUM(ALCTD_NB) % PKG_NB     AS HASU                        " & vbNewLine _
                                                & "      , SUM(ALCTD_NB)              AS ALCTD_NB                    " & vbNewLine _
                                                & "      , PKG_UT                                                    " & vbNewLine _
                                                & "      , PKG_UT_NM                                                 " & vbNewLine _
                                                & "      , SUM(ALCTD_QT)              AS ALCTD_QT                    " & vbNewLine _
                                                & "      , IRIME_UT                                                  " & vbNewLine _
                                                & "      , WT                         AS WT                          " & vbNewLine _
                                                & "      , UNSO_WT                                                   " & vbNewLine _
                                                & "      , SUM(ALCTD_NB) * PKG_WT     AS PKG_WT                      " & vbNewLine _
                                                & "      , TOU_NO                                                    " & vbNewLine _
                                                & "      , SITU_NO                                                   " & vbNewLine _
                                                & "      , ZONE_CD                                                   " & vbNewLine _
                                                & "      , LOCA                                                      " & vbNewLine _
                                                & "      , MIN(ZAN_KONSU)             AS ZAN_KONSU                   " & vbNewLine _
                                                & "      , MIN(ALCTD_CAN_NB) % PKG_NB AS ZAN_HASU                    " & vbNewLine _
                                                & "      , GOODS_CD_CUST                                             " & vbNewLine _
                                                & "      , REMARK_M                                                  " & vbNewLine _
                                                & "      , CUST_NM_S                                                 " & vbNewLine _
                                                & "      , CUST_NM_S_H                                               " & vbNewLine _
                                                & "      , CUST_ORD_NO_DTL                                           " & vbNewLine _
                                                & "      , OUTKA_REMARK                                              " & vbNewLine _
                                                & "      , HAISOU_REMARK                                             " & vbNewLine _
                                                & "      , NHS_REMARK                                                " & vbNewLine _
                                                & "      , KYORI                                                     " & vbNewLine _
                                                & "      , OUTKA_PKG_NB_L                                            " & vbNewLine _
                                                & "      , SOKO_NM                                                   " & vbNewLine _
                                                & "      , BUSHO_NM                                                  " & vbNewLine _
                                                & "      , NRS_BR_NM_NICHI                                           " & vbNewLine _
                                                & "      , MIN(ALCTD_CAN_QT)          AS ALCTD_CAN_QT                " & vbNewLine _
                                                & "      , ALCTD_KB                                                  " & vbNewLine _
                                                & "      , PTN_FLAG                                                  " & vbNewLine _
                                                & "      , CUST_CD_L                                                 " & vbNewLine _
                                                & "      , ORDER_TYPE                 AS ORDER_TYPE                  " & vbNewLine _
                                                & "      , CASE WHEN URIG_NM <> ''                                   " & vbNewLine _
                                                & "              AND URIG_NM IS NOT NULL THEN URIG_NM                " & vbNewLine _
                                                & "             WHEN DEST_SALES_NM   <> ''                           " & vbNewLine _
                                                & "              AND DEST_SALES_NM IS NOT NULL THEN DEST_SALES_NM    " & vbNewLine _
                                                & "             WHEN DENPYO_NM   <> ''                               " & vbNewLine _
                                                & "              AND DENPYO_NM IS NOT NULL   THEN DENPYO_NM          " & vbNewLine _
                                                & "        ELSE CUST_NM_L + CASE WHEN RPT_ID = 'LMC637' THEN ' ' + CUST_NM_S ELSE '' END                                           " & vbNewLine _
                                                & "        END                        AS ATSUKAISYA_NM               " & vbNewLine _
                                                & "      , MCD_SET_NAIYO                                             " & vbNewLine _
                                                & "      , MCD_SET_NAIYO_2                                           " & vbNewLine _
                                                & "      , MCD_SET_NAIYO_3                                           " & vbNewLine _
                                                & "      , PC_KB_NM                                                  " & vbNewLine _
                                                & "      , BUYER_ORD_NO_DTL                                          " & vbNewLine _
                                                & "      , TORI_KB                    --FREE_C01                     " & vbNewLine _
                                                & "      , SHIP_CD_L                                                 " & vbNewLine _
                                                & "      , SET_NAIYO_4                                               " & vbNewLine _
                                                & "      , SET_NAIYO_5                                               " & vbNewLine _
                                                & "      , SET_NAIYO_6                                               " & vbNewLine _
                                                & "      , GOODS_NM_2                                                " & vbNewLine _
                                                & "      , KICHO_KB                                                  " & vbNewLine _
                                                & "      , SEI_YURAI_KB                                              " & vbNewLine _
                                                & "      , REMARK_UPPER                                              " & vbNewLine _
                                                & "      , REMARK_LOWER                                              " & vbNewLine _
                                                & "      , GOODS_SYUBETU                                             " & vbNewLine _
                                                & "      , YUKOU_KIGEN                                               " & vbNewLine _
                                                & "      , GOODS_NM_3                                                " & vbNewLine _
                                                & "      , EDISHIP_CD                                                " & vbNewLine _
                                                & "      , EDIDEST_CD                                                " & vbNewLine _
                                                & "      , SET_NAIYO_FROM1                                           " & vbNewLine _
                                                & "      , SET_NAIYO_FROM2                                           " & vbNewLine _
                                                & "      , SET_NAIYO_FROM3                                           " & vbNewLine _
                                                & "      , CASE WHEN DEST_SALES_CD <> ''                             " & vbNewLine _
                                                & "              AND DEST_SALES_CD IS NOT NULL THEN DEST_SALES_AD_3  " & vbNewLine _
                                                & "        ELSE CUST_AD_3                                            " & vbNewLine _
                                                & "        END                        AS CUST_AD_3                   " & vbNewLine _
                                                & "      , DEST_REMARK                                               " & vbNewLine _
                                                & "      , DEST_SALES_CD                                             " & vbNewLine _
                                                & "      , DEST_SALES_NM                                             " & vbNewLine _
                                                & "      , DEST_SALES_AD_1                                           " & vbNewLine _
                                                & "      , DEST_SALES_AD_2                                           " & vbNewLine _
                                                & "      , DEST_SALES_AD_3                                           " & vbNewLine _
                                                & "      , DEST_SALES_TEL                                            " & vbNewLine _
                                                & "      , SAGYO_RYAK_1                                              " & vbNewLine _
                                                & "      , SAGYO_RYAK_2                                              " & vbNewLine _
                                                & "      , SAGYO_RYAK_3                                              " & vbNewLine _
                                                & "      , SAGYO_RYAK_4                                              " & vbNewLine _
                                                & "      , SAGYO_RYAK_5                                              " & vbNewLine _
                                                & "      , DEST_SAGYO_RYAK_1                                         " & vbNewLine _
                                                & "      , DEST_SAGYO_RYAK_2                                         " & vbNewLine _
                                                & "      , SZ01_YUSO                                                 " & vbNewLine _
                                                & "      , SZ01_UNSO                                                 " & vbNewLine _
                                                & "      , GOODS_COND_CD_1                                           " & vbNewLine _
                                                & "      , GOODS_COND_CD                                             " & vbNewLine _
                                                & "      , GOODS_COND_CD_3                                           " & vbNewLine _
                                                & "      , REMARK_ZAI                                                " & vbNewLine _
                                                & "      , LT_DATE                                                   " & vbNewLine _
                                                & "      , CASE WHEN SET_NAIYO = '1'  THEN  '1'                      " & vbNewLine _
                                                & "        ELSE ''                                                   " & vbNewLine _
                                                & "        END  AS SET_NAIYO                                         " & vbNewLine _
                                                & "      , SYS_UPD_PGID                                              " & vbNewLine _
                                                & "      , SHOBO_KBN_NM                                              " & vbNewLine _
                                                & "      , HINMEI                                                    " & vbNewLine _
                                                & "      , CUST_CD_M                                                 " & vbNewLine _
                                                & "      , CUST_CD_S                                                 " & vbNewLine _
                                                & "      , CUST_COST_CD2                                             " & vbNewLine _
                                                & "   FROM                                                           " & vbNewLine _
                                                & "        (                                                         " & vbNewLine

    '(2014.03.31) 追加END

    '(2014.03.31) 追加START
    ''' <summary>
    ''' 印刷データ抽出用(出荷テーブル)
    ''' </summary>
    ''' <remarks></remarks>
    Friend Const SQL_SELECT_OUTKA_740 As String = "--★★★SQL_SELECT_OUTKA_740★★★  出荷テーブル                                                                           " & vbNewLine _
                                             & "SELECT                                                                                                                         " & vbNewLine _
                                             & " CASE WHEN MR2.PTN_CD IS NOT NULL THEN MR2.RPT_ID                                                                              " & vbNewLine _
                                             & "      WHEN MR1.PTN_CD IS NOT NULL THEN MR1.RPT_ID                                                                              " & vbNewLine _
                                             & "      ELSE MR3.RPT_ID                                                                                                          " & vbNewLine _
                                             & " END              AS RPT_ID                                                                                                    " & vbNewLine _
                                             & ",OUTL.NRS_BR_CD   AS NRS_BR_CD                                                                                                 " & vbNewLine _
                                             & ",OUTM.PRINT_SORT  AS PRINT_SORT                                                                                                " & vbNewLine _
                                             & ",CASE WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_CD                                                                     " & vbNewLine _
                                             & "      ELSE OUTL.DEST_CD                                                                                                        " & vbNewLine _
                                             & " END              AS DEST_CD                                                                                                   " & vbNewLine _
                                             & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_NM                                                                               " & vbNewLine _
                                             & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_NM                                                                     " & vbNewLine _
                                             & "      ELSE MDOUT.DEST_NM                                                                                                       " & vbNewLine _
                                             & " END              AS DEST_NM                                                                                                   " & vbNewLine _
                                             & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_AD_1                                                                             " & vbNewLine _
                                             & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_AD_1                                                                   " & vbNewLine _
                                             & "      ELSE MDOUT.AD_1                                                                                                          " & vbNewLine _
                                             & " END              AS DEST_AD_1                                                                                                 " & vbNewLine _
                                             & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_AD_2                                                                             " & vbNewLine _
                                             & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_AD_2                                                                   " & vbNewLine _
                                             & "      ELSE MDOUT.AD_2                                                                                                          " & vbNewLine _
                                             & " END              AS DEST_AD_2                                                                                                 " & vbNewLine _
                                             & ",OUTL.DEST_AD_3   AS DEST_AD_3                                                                                                 " & vbNewLine _
                                             & ",OUTL.DEST_TEL    AS DEST_TEL                                                                                                  " & vbNewLine _
                                             & ",OUTL.OUTKA_PLAN_DATE   AS OUTKA_PLAN_DATE                                                                                     " & vbNewLine _
                                             & ",OUTL.CUST_ORD_NO       AS CUST_ORD_NO                                                                                         " & vbNewLine _
                                             & ",OUTL.BUYER_ORD_NO      AS BUYER_ORD_NO                                                                                        " & vbNewLine _
                                             & ",MUCO.UNSOCO_NM         AS UNSOCO_NM                                                                                           " & vbNewLine _
                                             & ",OUTL.ARR_PLAN_DATE     AS ARR_PLAN_DATE                                                                                       " & vbNewLine _
                                             & ",KBN1.KBN_NM1           AS ARR_PLAN_TIME                                                                                       " & vbNewLine _
                                             & ",OUTL.OUTKA_NO_L        AS OUTKA_NO_L                                                                                          " & vbNewLine _
                                             & ",MDOUTU.DEST_NM         AS URIG_NM                                                                                             " & vbNewLine _
                                             & ",MC.CUST_NM_L           AS CUST_NM_L                                                                                           " & vbNewLine _
                                             & ",MC.CUST_NM_M           AS CUST_NM_M                                                                                           " & vbNewLine _
                                             & ",MC.AD_1                AS CUST_AD_1                                                                                           " & vbNewLine _
                                             & ",MC.AD_2                AS CUST_AD_2                                                                                           " & vbNewLine _
                                             & ",MC.TEL                 AS CUST_TEL                                                                                            " & vbNewLine _
                                             & ",MC.DENPYO_NM           AS DENPYO_NM                                                                                            " & vbNewLine _
                                             & ",MNRS.NRS_BR_NM         AS NRS_BR_NM                                                                                           " & vbNewLine _
                                             & ",CASE WHEN MSO.WH_KB = '01' THEN MSO.AD_1                                                                             " & vbNewLine _
                                             & "      ELSE MNRS.AD_1                                                                                                          " & vbNewLine _
                                             & " END              AS NRS_BR_AD1                                                                                                 " & vbNewLine _
                                             & ",CASE WHEN MSO.WH_KB = '01' THEN MSO.AD_2                                                                             " & vbNewLine _
                                             & "      ELSE MNRS.AD_2                                                                                                          " & vbNewLine _
                                             & " END              AS NRS_BR_AD2                                                                                                 " & vbNewLine _
                                             & ",CASE WHEN MSO.WH_KB = '01' THEN MSO.TEL                                                                             " & vbNewLine _
                                             & "      ELSE MNRS.TEL                                                                                                          " & vbNewLine _
                                             & " END              AS NRS_BR_TEL                                                                                                 " & vbNewLine _
                                             & ",CASE WHEN MSO.WH_KB = '01' THEN MSO.FAX                                                                             " & vbNewLine _
                                             & "      ELSE MNRS.FAX                                                                                                          " & vbNewLine _
                                             & " END              AS NRS_BR_FAX                                                                                                 " & vbNewLine _
                                             & ",MUSER.USER_NM          AS PIC                                                                                                 " & vbNewLine _
                                             & ",OUTM.OUTKA_NO_M        AS OUTKA_NO_M                                                                                          " & vbNewLine _
                                             & ",''                     AS OUTKA_NO_S                                                                                          " & vbNewLine _
                                             & "--,CASE WHEN INL.INKA_STATE_KB < '50' THEN INL.INKA_DATE                                                                         " & vbNewLine _
                                             & "--      ELSE ZAI.INKO_DATE                                                                                                       " & vbNewLine _
                                             & "-- END                    AS INKA_DATE                                                                                           " & vbNewLine _
                                             & ",''                     AS INKA_DATE                                                                                           " & vbNewLine _
                                             & ",ZAI.REMARK_OUT         AS REMARK_OUT                                                                                          " & vbNewLine _
                                             & ",CASE WHEN (MDGE.GOODS_NM IS NOT NULL AND MDGE.GOODS_NM <> '' AND EDIL.OUTKA_CTL_NO IS NOT NULL) THEN MDGE.GOODS_NM            " & vbNewLine _
                                             & "      WHEN (MDGL.GOODS_NM IS NOT NULL AND MDGL.GOODS_NM <> '' AND EDIL.OUTKA_CTL_NO IS NULL) THEN MDGL.GOODS_NM                " & vbNewLine _
                                             & "      ELSE MG.GOODS_NM_1                                                                                                       " & vbNewLine _
                                             & " END                    AS GOODS_NM_1                                                                                          " & vbNewLine _
                                             & ",''                     AS LOT_NO                                                                                              " & vbNewLine _
                                             & ",''                     AS SERIAL_NO                                                                                           " & vbNewLine _
                                             & ",OUTS.IRIME             AS IRIME                                                                                               " & vbNewLine _
                                             & ",MG.PKG_NB              AS PKG_NB                                                                                              " & vbNewLine _
                                             & ",OUTS.ALCTD_NB / MG.PKG_NB     AS KONSU                                                                                        " & vbNewLine _
                                             & ",OUTS.ALCTD_NB % MG.PKG_NB     AS HASU                                                                                         " & vbNewLine _
                                             & ",OUTS.ALCTD_NB          AS ALCTD_NB                                                                                            " & vbNewLine _
                                             & ",MG.PKG_UT              AS PKG_UT                                                                                              " & vbNewLine _
                                             & ",KBN5.KBN_NM1           AS PKG_UT_NM                                                                                           " & vbNewLine _
                                             & ",OUTS.ALCTD_QT          AS ALCTD_QT                                                                                            " & vbNewLine _
                                             & ",MG.STD_IRIME_UT        AS IRIME_UT                                                                                            " & vbNewLine _
                                             & ",UL.UNSO_WT             AS WT                                                                                                  " & vbNewLine _
                                             & ",0                      AS UNSO_WT                                                                                             " & vbNewLine _
                                             & ",CASE WHEN ISNUMERIC(MGD16.SET_NAIYO) = 1 THEN CONVERT(NUMERIC(12,3),MGD16.SET_NAIYO)                                          " & vbNewLine _
                                             & "      ELSE 0                                                                                                                   " & vbNewLine _
                                             & " END                    AS PKG_WT                                                                                              " & vbNewLine _
                                             & ",''                     AS TOU_NO                                                                                              " & vbNewLine _
                                             & ",''                     AS SITU_NO                                                                                             " & vbNewLine _
                                             & ",''                     AS ZONE_CD                                                                                             " & vbNewLine _
                                             & ",''                     AS LOCA                                                                                                " & vbNewLine _
                                             & ",OUTS.ALCTD_CAN_NB / MG.PKG_NB   AS ZAN_KONSU                                                                                  " & vbNewLine _
                                             & ",OUTS.ALCTD_CAN_NB % MG.PKG_NB   AS ZAN_HASU                                                                                   " & vbNewLine _
                                             & ",MG.GOODS_CD_CUST       AS GOODS_CD_CUST                                                                                       " & vbNewLine _
                                             & ",OUTM.REMARK            AS REMARK_M                                                                                            " & vbNewLine _
                                             & ",MC.CUST_NM_S  AS CUST_NM_S                                                                                           " & vbNewLine _
                                             & ",MC2.CUST_NM_S   AS CUST_NM_S_H                                                                                           " & vbNewLine _
                                             & ",OUTM.CUST_ORD_NO_DTL   AS CUST_ORD_NO_DTL                                                                                     " & vbNewLine _
                                             & ",OUTL.REMARK            AS OUTKA_REMARK                                                                                        " & vbNewLine _
                                             & ",UL.REMARK              AS HAISOU_REMARK                                                                                       " & vbNewLine _
                                             & ",OUTL.NHS_REMARK        AS NHS_REMARK                                                                                          " & vbNewLine _
                                             & ",CASE WHEN (OUTL.DEST_KB = '02' AND MDEDI.KYORI > 0) THEN MDEDI.KYORI                                                          " & vbNewLine _
                                             & "      WHEN (OUTL.DEST_KB = '02' AND MDEDI.KYORI = 0 AND EDIL.DEST_JIS_CD <= MSO.JIS_CD) THEN MKY3.KYORI                        " & vbNewLine _
                                             & "      WHEN (OUTL.DEST_KB = '02' AND MDEDI.KYORI = 0 AND MSO.JIS_CD <= EDIL.DEST_JIS_CD) THEN MKY4.KYORI                        " & vbNewLine _
                                             & "      WHEN (OUTL.DEST_KB <> '02' AND MDOUT.KYORI > 0) THEN MDOUT.KYORI                                                         " & vbNewLine _
                                             & "      WHEN (OUTL.DEST_KB <> '02' AND MDOUT.KYORI = 0 AND MDOUT.JIS <= MSO.JIS_CD) THEN MKY1.KYORI                              " & vbNewLine _
                                             & "      WHEN (OUTL.DEST_KB <> '02' AND MDOUT.KYORI = 0 AND MSO.JIS_CD <= MDOUT.JIS) THEN MKY2.KYORI                              " & vbNewLine _
                                             & "      ELSE 0                                                                                                                   " & vbNewLine _
                                             & " END                    AS KYORI                                                                                               " & vbNewLine _
                                             & ",OUTL.OUTKA_PKG_NB      AS OUTKA_PKG_NB_L                                                                                      " & vbNewLine _
                                             & ",KBN2.KBN_NM1           AS SOKO_NM                                                                                             " & vbNewLine _
                                             & ",KBN3.KBN_NM1           AS BUSHO_NM                                                                                            " & vbNewLine _
                                             & ",KBN4.KBN_NM1           AS NRS_BR_NM_NICHI                                                                                     " & vbNewLine _
                                             & ",OUTS.ALCTD_CAN_QT      AS ALCTD_CAN_QT                                                                                        " & vbNewLine _
                                             & ",OUTM.ALCTD_KB          AS ALCTD_KB                                                                                            " & vbNewLine _
                                             & ",'0'                    AS PTN_FLAG                                                                                            " & vbNewLine _
                                             & ",OUTL.CUST_CD_L         AS CUST_CD_L                                                                                           " & vbNewLine _
                                             & ",OUTL.ORDER_TYPE        AS ORDER_TYPE                                                                                          " & vbNewLine _
                                             & ",OUTL.SYS_UPD_PGID      AS SYS_UPD_PGID                                                                                        " & vbNewLine _
                                             & ",ZAI.LT_DATE                                                                                                                   " & vbNewLine _
                                             & ",OUTM.BUYER_ORD_NO_DTL AS BUYER_ORD_NO_DTL                                                                                     " & vbNewLine _
                                             & ",ZAI.GOODS_COND_KB_1 AS GOODS_COND_CD_1                                                                                        " & vbNewLine _
                                             & ",ZAI.GOODS_COND_KB_2 AS GOODS_COND_CD                                                                                          " & vbNewLine _
                                             & ",ZAI.GOODS_COND_KB_3 AS GOODS_COND_CD_3                                                                                        " & vbNewLine _
                                             & ",ZAI.REMARK AS REMARK_ZAI                                                                                                      " & vbNewLine _
                                             & ",KBN6.KBN_NM2 AS TITLE_SMPL                                                                                                    " & vbNewLine _
                                             & ",OUTS.ALCTD_CAN_NB AS ALCTD_CAN_NB                                                                                             " & vbNewLine _
                                             & ",OUTM.BACKLOG_QT                                                                                                               " & vbNewLine _
                                             & ",KBN7.KBN_NM2 AS DOKU_NM                                                                                                       " & vbNewLine _
                                             & " ,MCD.SET_NAIYO    AS MCD_SET_NAIYO                                                                                            " & vbNewLine _
                                             & " ,MCD.SET_NAIYO_2  AS MCD_SET_NAIYO_2                                                                                          " & vbNewLine _
                                             & " ,MCD.SET_NAIYO_3  AS MCD_SET_NAIYO_3                                                                                          " & vbNewLine _
                                             & ",KBN9.KBN_NM2 AS PC_KB_NM                                                                                                      " & vbNewLine _
                                             & ",EDIL.FREE_C01           AS TORI_KB                                                                                            " & vbNewLine _
                                             & ",OUTL.SHIP_CD_L          AS SHIP_CD_L                                                                                          " & vbNewLine _
                                             & ",MCD_N.SET_NAIYO         AS SET_NAIYO_4                                                                                        " & vbNewLine _
                                             & ",MCD_N.SET_NAIYO_2       AS SET_NAIYO_5                                                                                        " & vbNewLine _
                                             & ",MCD_N.SET_NAIYO_3       AS SET_NAIYO_6                                                                                        " & vbNewLine _
                                             & ",MG.GOODS_NM_2           AS GOODS_NM_2                                                                                         " & vbNewLine _
                                             & ",EDIM.FREE_C02           AS KICHO_KB                                                                                           " & vbNewLine _
                                             & ",EDIM.FREE_C03           AS SEI_YURAI_KB                                                                                       " & vbNewLine _
                                             & ",EDIM.FREE_C04           AS REMARK_UPPER      --群馬篠崎運送利用                                                               " & vbNewLine _
                                             & ",EDIM.FREE_C05           AS REMARK_LOWER                                                                                       " & vbNewLine _
                                             & ",EDIM.FREE_C06           AS GOODS_SYUBETU     --群馬篠崎運送利用                                                               " & vbNewLine _
                                             & ",CASE WHEN OUTL.NRS_BR_CD = '10' AND OUTL.CUST_CD_L = '00266' THEN OUTL.DENP_NO                                                " & vbNewLine _
                                             & "      ELSE EDIM.FREE_C01 END YUKOU_KIGEN                                                                                          " & vbNewLine _
                                             & ",MG.GOODS_NM_3           AS GOODS_NM_3         --2012/05/23                                                                    " & vbNewLine _
                                             & ",MDOUTU.EDI_CD           AS EDISHIP_CD         --2012/05/23                                                                    " & vbNewLine _
                                             & ",MDOUT.EDI_CD            AS EDIDEST_CD         --2012/05/23                                                                    " & vbNewLine _
                                             & "--日医工対策終了                                                                                                               " & vbNewLine _
                                             & ",MCD_F.SET_NAIYO         AS SET_NAIYO_FROM1                                                                                    " & vbNewLine _
                                             & ",MCD_F.SET_NAIYO_2       AS SET_NAIYO_FROM2                                                                                    " & vbNewLine _
                                             & ",MCD_F.SET_NAIYO_3       AS SET_NAIYO_FROM3                                                                                    " & vbNewLine _
                                             & ",MC.AD_3                 AS CUST_AD_3                                                                                          " & vbNewLine _
                                             & ",MDOUT.REMARK            AS DEST_REMARK                                                                                        " & vbNewLine _
                                             & ",MDOUT.SALES_CD          AS DEST_SALES_CD                                                                                      " & vbNewLine _
                                             & ",MC_SALES.CUST_NM_L      AS DEST_SALES_NM                                                                                      " & vbNewLine _
                                             & ",MC_SALES.AD_1           AS DEST_SALES_AD_1                                                                                    " & vbNewLine _
                                             & ",MC_SALES.AD_2           AS DEST_SALES_AD_2                                                                                    " & vbNewLine _
                                             & ",MC_SALES.AD_3           AS DEST_SALES_AD_3                                                                                    " & vbNewLine _
                                             & ",MC_SALES.TEL            AS DEST_SALES_TEL                                                                                     " & vbNewLine _
                                             & "--1ここから                                                                                                                    " & vbNewLine _
                                             & ",ISNULL((SELECT BASE.SAGYO_RYAK                                                                                                " & vbNewLine _
                                             & "FROM                                                                                                                           " & vbNewLine _
                                             & "(SELECT                                                                                                                        " & vbNewLine _
                                             & "M_SAGYO.SAGYO_RYAK AS SAGYO_RYAK                                                                                               " & vbNewLine _
                                             & ",ROW_NUMBER() OVER (PARTITION BY INOUTKA_NO_LM ORDER BY INOUTKA_NO_LM) AS NUM                                                  " & vbNewLine _
                                             & "FROM $LM_TRN$..E_SAGYO E                                                                                                       " & vbNewLine _
                                             & "       JOIN $LM_MST$..M_SAGYO M_SAGYO                                                                                          " & vbNewLine _
                                             & "         ON M_SAGYO.NRS_BR_CD = E.NRS_BR_CD                                                                                    " & vbNewLine _
                                             & "        AND M_SAGYO.SAGYO_CD  = E.SAGYO_CD                                                                                     " & vbNewLine _
                                             & "WHERE E.NRS_BR_CD = OUTL.NRS_BR_CD AND E.INOUTKA_NO_LM = (OUTM.OUTKA_NO_L + OUTM.OUTKA_NO_M) AND E.IOZS_KB = '21'              " & vbNewLine _
                                             & ") AS BASE                                                                                                                      " & vbNewLine _
                                             & "WHERE BASE.NUM = 1),'') AS SAGYO_RYAK_1                                                                                        " & vbNewLine _
                                             & "--1ここまで                                                                                                                    " & vbNewLine _
                                             & "--2ここから                                                                                                                    " & vbNewLine _
                                             & ",ISNULL((SELECT BASE.SAGYO_RYAK                                                                                                " & vbNewLine _
                                             & "FROM                                                                                                                           " & vbNewLine _
                                             & "(SELECT                                                                                                                        " & vbNewLine _
                                             & "M_SAGYO.SAGYO_RYAK AS SAGYO_RYAK                                                                                               " & vbNewLine _
                                             & ",ROW_NUMBER() OVER (PARTITION BY INOUTKA_NO_LM ORDER BY INOUTKA_NO_LM) AS NUM                                                  " & vbNewLine _
                                             & "FROM $LM_TRN$..E_SAGYO E                                                                                                       " & vbNewLine _
                                             & "       JOIN $LM_MST$..M_SAGYO M_SAGYO                                                                                          " & vbNewLine _
                                             & "         ON M_SAGYO.NRS_BR_CD = E.NRS_BR_CD                                                                                    " & vbNewLine _
                                             & "        AND M_SAGYO.SAGYO_CD  = E.SAGYO_CD                                                                                     " & vbNewLine _
                                             & "WHERE E.NRS_BR_CD = OUTL.NRS_BR_CD AND E.INOUTKA_NO_LM = (OUTM.OUTKA_NO_L + OUTM.OUTKA_NO_M) AND E.IOZS_KB = '21'              " & vbNewLine _
                                             & ") AS BASE                                                                                                                      " & vbNewLine _
                                             & "WHERE BASE.NUM = 2),'') AS SAGYO_RYAK_2                                                                                        " & vbNewLine _
                                             & "--2ここまで                                                                                                                    " & vbNewLine _
                                             & "--3ここから                                                                                                                    " & vbNewLine _
                                             & ",ISNULL((SELECT BASE.SAGYO_RYAK                                                                                                " & vbNewLine _
                                             & "FROM                                                                                                                           " & vbNewLine _
                                             & "(SELECT                                                                                                                        " & vbNewLine _
                                             & "M_SAGYO.SAGYO_RYAK AS SAGYO_RYAK                                                                                               " & vbNewLine _
                                             & ",ROW_NUMBER() OVER (PARTITION BY INOUTKA_NO_LM ORDER BY INOUTKA_NO_LM) AS NUM                                                  " & vbNewLine _
                                             & "FROM $LM_TRN$..E_SAGYO E                                                                                                       " & vbNewLine _
                                             & "       JOIN $LM_MST$..M_SAGYO M_SAGYO                                                                                          " & vbNewLine _
                                             & "         ON M_SAGYO.NRS_BR_CD = E.NRS_BR_CD                                                                                    " & vbNewLine _
                                             & "        AND M_SAGYO.SAGYO_CD  = E.SAGYO_CD                                                                                     " & vbNewLine _
                                             & "WHERE E.NRS_BR_CD = OUTL.NRS_BR_CD AND E.INOUTKA_NO_LM = (OUTM.OUTKA_NO_L + OUTM.OUTKA_NO_M) AND E.IOZS_KB = '21'              " & vbNewLine _
                                             & ") AS BASE                                                                                                                      " & vbNewLine _
                                             & "WHERE BASE.NUM = 3),'') AS SAGYO_RYAK_3                                                                                        " & vbNewLine _
                                             & "--3ここまで                                                                                                                    " & vbNewLine _
                                             & "--4ここから                                                                                                                    " & vbNewLine _
                                             & ",ISNULL((SELECT BASE.SAGYO_RYAK                                                                                                " & vbNewLine _
                                             & "FROM                                                                                                                           " & vbNewLine _
                                             & "(SELECT                                                                                                                        " & vbNewLine _
                                             & "M_SAGYO.SAGYO_RYAK AS SAGYO_RYAK                                                                                               " & vbNewLine _
                                             & ",ROW_NUMBER() OVER (PARTITION BY INOUTKA_NO_LM ORDER BY INOUTKA_NO_LM) AS NUM                                                  " & vbNewLine _
                                             & "FROM $LM_TRN$..E_SAGYO E                                                                                                       " & vbNewLine _
                                             & "       JOIN $LM_MST$..M_SAGYO M_SAGYO                                                                                          " & vbNewLine _
                                             & "         ON M_SAGYO.NRS_BR_CD = E.NRS_BR_CD                                                                                    " & vbNewLine _
                                             & "        AND M_SAGYO.SAGYO_CD  = E.SAGYO_CD                                                                                     " & vbNewLine _
                                             & "WHERE E.NRS_BR_CD = OUTL.NRS_BR_CD AND E.INOUTKA_NO_LM = (OUTM.OUTKA_NO_L + OUTM.OUTKA_NO_M) AND E.IOZS_KB = '21'              " & vbNewLine _
                                             & ") AS BASE                                                                                                                      " & vbNewLine _
                                             & "WHERE BASE.NUM = 4),'') AS SAGYO_RYAK_4                                                                                        " & vbNewLine _
                                             & "--4ここまで                                                                                                                    " & vbNewLine _
                                             & "--5ここから                                                                                                                    " & vbNewLine _
                                             & ",ISNULL((SELECT BASE.SAGYO_RYAK                                                                                                " & vbNewLine _
                                             & "FROM                                                                                                                           " & vbNewLine _
                                             & "(SELECT                                                                                                                        " & vbNewLine _
                                             & "M_SAGYO.SAGYO_RYAK AS SAGYO_RYAK                                                                                               " & vbNewLine _
                                             & ",ROW_NUMBER() OVER (PARTITION BY INOUTKA_NO_LM ORDER BY INOUTKA_NO_LM) AS NUM                                                  " & vbNewLine _
                                             & "FROM $LM_TRN$..E_SAGYO E                                                                                                       " & vbNewLine _
                                             & "       JOIN $LM_MST$..M_SAGYO M_SAGYO                                                                                          " & vbNewLine _
                                             & "         ON M_SAGYO.NRS_BR_CD = E.NRS_BR_CD                                                                                    " & vbNewLine _
                                             & "        AND M_SAGYO.SAGYO_CD  = E.SAGYO_CD                                                                                     " & vbNewLine _
                                             & "WHERE E.NRS_BR_CD = OUTL.NRS_BR_CD AND E.INOUTKA_NO_LM = (OUTM.OUTKA_NO_L + OUTM.OUTKA_NO_M) AND E.IOZS_KB = '21'              " & vbNewLine _
                                             & ") AS BASE                                                                                                                      " & vbNewLine _
                                             & "WHERE BASE.NUM = 5),'') AS SAGYO_RYAK_5                                                                                        " & vbNewLine _
                                             & "--5ここまで                                                                                                                    " & vbNewLine _
                                             & "--届け先1ここから                                                                                                              " & vbNewLine _
                                             & ",ISNULL((SELECT BASE.SAGYO_RYAK                                                                                                " & vbNewLine _
                                             & "FROM                                                                                                                           " & vbNewLine _
                                             & "(SELECT                                                                                                                        " & vbNewLine _
                                             & "M_SAGYO.SAGYO_RYAK AS SAGYO_RYAK                                                                                               " & vbNewLine _
                                             & ",ROW_NUMBER() OVER (PARTITION BY INOUTKA_NO_LM ORDER BY INOUTKA_NO_LM) AS NUM                                                  " & vbNewLine _
                                             & "FROM $LM_TRN$..E_SAGYO E                                                                                                       " & vbNewLine _
                                             & "       JOIN $LM_MST$..M_SAGYO M_SAGYO                                                                                          " & vbNewLine _
                                             & "         ON M_SAGYO.NRS_BR_CD = E.NRS_BR_CD                                                                                    " & vbNewLine _
                                             & "        AND M_SAGYO.SAGYO_CD  = E.SAGYO_CD                                                                                     " & vbNewLine _
                                             & "WHERE E.NRS_BR_CD = OUTL.NRS_BR_CD AND E.INOUTKA_NO_LM = (OUTM.OUTKA_NO_L + OUTM.OUTKA_NO_M) AND E.IOZS_KB = '21'              " & vbNewLine _
                                             & ") AS BASE                                                                                                                      " & vbNewLine _
                                             & "WHERE BASE.NUM = 6),'') AS DEST_SAGYO_RYAK_1                                                                                   " & vbNewLine _
                                             & "--届け先1ここまで                                                                                                              " & vbNewLine _
                                             & "--届け先2ここから                                                                                                              " & vbNewLine _
                                             & ",ISNULL((SELECT BASE.SAGYO_RYAK                                                                                                " & vbNewLine _
                                             & "FROM                                                                                                                           " & vbNewLine _
                                             & "(SELECT                                                                                                                        " & vbNewLine _
                                             & "M_SAGYO.SAGYO_RYAK AS SAGYO_RYAK                                                                                               " & vbNewLine _
                                             & ",ROW_NUMBER() OVER (PARTITION BY INOUTKA_NO_LM ORDER BY INOUTKA_NO_LM) AS NUM                                                  " & vbNewLine _
                                             & "FROM $LM_TRN$..E_SAGYO E                                                                                                       " & vbNewLine _
                                             & "       JOIN $LM_MST$..M_SAGYO M_SAGYO                                                                                          " & vbNewLine _
                                             & "         ON M_SAGYO.NRS_BR_CD = E.NRS_BR_CD                                                                                    " & vbNewLine _
                                             & "        AND M_SAGYO.SAGYO_CD  = E.SAGYO_CD                                                                                     " & vbNewLine _
                                             & "WHERE E.NRS_BR_CD = OUTL.NRS_BR_CD AND E.INOUTKA_NO_LM = (OUTM.OUTKA_NO_L + OUTM.OUTKA_NO_M) AND E.IOZS_KB = '21'              " & vbNewLine _
                                             & ") AS BASE                                                                                                                      " & vbNewLine _
                                             & "WHERE BASE.NUM = 7),'') AS DEST_SAGYO_RYAK_2                                                                                   " & vbNewLine _
                                             & "--届け先ここまで                                                                                                               " & vbNewLine _
                                             & ",EDIM.FREE_C07           AS SZ01_YUSO --篠崎                                                                                   " & vbNewLine _
                                             & ",EDIM.FREE_C09           AS SZ01_UNSO --篠崎                                                                                   " & vbNewLine _
                                             & "--群馬篠崎運送向け自由項目対応　終了                                                                                         　" & vbNewLine _
                                             & "      ,MGD.SET_NAIYO                      AS  SET_NAIYO                                                                        " & vbNewLine _
                                             & ",KBN10.KBN_NM1            AS SHOBO_KBN_NM                                                                                      " & vbNewLine _
                                             & ",MSHOBO.HINMEI            AS HINMEI                                                                                            " & vbNewLine _
                                             & ",MG.CUST_CD_M             AS CUST_CD_M                                                                                         " & vbNewLine _
                                             & ",MG.CUST_CD_S             AS CUST_CD_S                                                                                         " & vbNewLine _
                                             & ",MG.CUST_COST_CD2         AS CUST_COST_CD2                                                                                     " & vbNewLine _
                                             & "--出荷L                                                                                                                        " & vbNewLine _
                                             & "FROM                                                                                                                           " & vbNewLine _
                                             & "$LM_TRN$..C_OUTKA_L OUTL                                                                                                       " & vbNewLine _
                                             & "--トランザクションテーブル                                                                                                     " & vbNewLine _
                                             & "--出荷M                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..C_OUTKA_M OUTM                                                                                             " & vbNewLine _
                                             & "ON  OUTM.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "AND OUTM.OUTKA_NO_L = OUTL.OUTKA_NO_L                                                                                          " & vbNewLine _
                                             & "AND OUTM.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--出荷M(中MIN)                                                                                                                 " & vbNewLine _
                                             & "LEFT OUTER JOIN                                                                                                                " & vbNewLine _
                                             & "       (SELECT                                                                                                                 " & vbNewLine _
                                             & "           NRS_BR_CD                                                                                                           " & vbNewLine _
                                             & "           ,OUTKA_NO_L                                                                                                         " & vbNewLine _
                                             & "           ,MIN(OUTKA_NO_M) AS  OUTKA_NO_M                                                                                     " & vbNewLine _
                                             & "       FROM $LM_TRN$..C_OUTKA_M WHERE SYS_DEL_FLG ='0'                                                                         " & vbNewLine _
                                             & "        AND NRS_BR_CD = @NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "        AND OUTKA_NO_L = @KANRI_NO_L                                                                                           " & vbNewLine _
                                             & "       GROUP BY NRS_BR_CD,OUTKA_NO_L) OUTM_MIN                                                                                 " & vbNewLine _
                                             & "       ON OUTM_MIN.NRS_BR_CD        = OUTL.NRS_BR_CD                                                                           " & vbNewLine _
                                             & "       AND OUTM_MIN.OUTKA_NO_L      = OUTL.OUTKA_NO_L                                                                          " & vbNewLine _
                                             & "--出荷M(中MIN)                                                                                                                 " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..C_OUTKA_M OUTM2                                                                                            " & vbNewLine _
                                             & "ON  OUTM2.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                           " & vbNewLine _
                                             & "AND OUTM2.OUTKA_NO_L = OUTL.OUTKA_NO_L                                                                                         " & vbNewLine _
                                             & "AND OUTM2.OUTKA_NO_M = OUTM_MIN.OUTKA_NO_M                                                                                     " & vbNewLine _
                                             & "AND OUTM2.SYS_DEL_FLG = '0'                                                                                                    " & vbNewLine _
                                             & "--出荷S                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..C_OUTKA_S OUTS                                                                                             " & vbNewLine _
                                             & "ON  OUTS.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "AND OUTS.OUTKA_NO_L = OUTL.OUTKA_NO_L                                                                                          " & vbNewLine _
                                             & "AND OUTS.OUTKA_NO_M = OUTM.OUTKA_NO_M                                                                                          " & vbNewLine _
                                             & "AND OUTS.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & " LEFT JOIN (                                                                                                                   " & vbNewLine _
                                             & "            SELECT                                                                                                             " & vbNewLine _
                                             & "                   NRS_BR_CD                                                                                                   " & vbNewLine _
                                             & "                 , EDI_CTL_NO                                                                                                  " & vbNewLine _
                                             & "                 , OUTKA_CTL_NO                                                                                                " & vbNewLine _
                                             & "             FROM (                                                                                                            " & vbNewLine _
                                             & "                    SELECT                                                                                                     " & vbNewLine _
                                             & "                           EDIOUTL.NRS_BR_CD                                                                                   " & vbNewLine _
                                             & "                         , EDIOUTL.EDI_CTL_NO                                                                                  " & vbNewLine _
                                             & "                         , EDIOUTL.OUTKA_CTL_NO                                                                                " & vbNewLine _
                                             & "                         , CASE WHEN EDIOUTL.OUTKA_CTL_NO = '' THEN 1                                                          " & vbNewLine _
                                             & "                           ELSE ROW_NUMBER() OVER (PARTITION BY EDIOUTL.NRS_BR_CD                                              " & vbNewLine _
                                             & "                                                              , EDIOUTL.OUTKA_CTL_NO                                           " & vbNewLine _
                                             & "                                                       ORDER BY EDIOUTL.NRS_BR_CD                                              " & vbNewLine _
                                             & "                                                              , EDIOUTL.EDI_CTL_NO                                             " & vbNewLine _
                                             & "                                                  )                                                                            " & vbNewLine _
                                             & "                           END AS IDX                                                                                          " & vbNewLine _
                                             & "                     FROM $LM_TRN$..H_OUTKAEDI_L EDIOUTL                                                                       " & vbNewLine _
                                             & "                    WHERE EDIOUTL.SYS_DEL_FLG  = '0'                                                                           " & vbNewLine _
                                             & "                      AND EDIOUTL.NRS_BR_CD    = @NRS_BR_CD                                                                    " & vbNewLine _
                                             & "                      AND EDIOUTL.OUTKA_CTL_NO = @KANRI_NO_L                                                                   " & vbNewLine _
                                             & "                  ) EBASE                                                                                                      " & vbNewLine _
                                             & "            WHERE EBASE.IDX = 1                                                                                                " & vbNewLine _
                                             & "            ) TOPEDI                                                                                                           " & vbNewLine _
                                             & "        ON TOPEDI.NRS_BR_CD    = OUTL.NRS_BR_CD                                                                                " & vbNewLine _
                                             & "       AND TOPEDI.OUTKA_CTL_NO = OUTL.OUTKA_NO_L                                                                               " & vbNewLine _
                                             & " LEFT JOIN $LM_TRN$..H_OUTKAEDI_L EDIL                                                                                         " & vbNewLine _
                                             & "        ON EDIL.NRS_BR_CD  = TOPEDI.NRS_BR_CD                                                                                  " & vbNewLine _
                                             & "       AND EDIL.EDI_CTL_NO = TOPEDI.EDI_CTL_NO                                                                                 " & vbNewLine _
                                             & "--入荷L                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..B_INKA_L INL                                                                                               " & vbNewLine _
                                             & "ON  INL.NRS_BR_CD = OUTS.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "AND INL.INKA_NO_L = OUTS.INKA_NO_L                                                                                             " & vbNewLine _
                                             & "AND INL.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--入荷S                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..B_INKA_S INS                                                                                               " & vbNewLine _
                                             & "ON  INS.NRS_BR_CD = OUTS.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "AND INS.INKA_NO_L = OUTS.INKA_NO_L                                                                                             " & vbNewLine _
                                             & "AND INS.INKA_NO_M = OUTS.INKA_NO_M                                                                                             " & vbNewLine _
                                             & "AND INS.INKA_NO_S = OUTS.INKA_NO_S                                                                                             " & vbNewLine _
                                             & "AND INS.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--運送L                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..F_UNSO_L UL                                                                                                " & vbNewLine _
                                             & "ON  UL.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                              " & vbNewLine _
                                             & "AND UL.INOUTKA_NO_L = OUTL.OUTKA_NO_L                                                                                          " & vbNewLine _
                                             & "AND UL.MOTO_DATA_KB = '20'                                                                                                     " & vbNewLine _
                                             & "AND UL.SYS_DEL_FLG = '0'                                                                                                       " & vbNewLine _
                                             & "--在庫テーブル                                                                                                                 " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..D_ZAI_TRS ZAI                                                                                              " & vbNewLine _
                                             & "ON  ZAI.NRS_BR_CD = OUTS.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "AND ZAI.ZAI_REC_NO = OUTS.ZAI_REC_NO                                                                                           " & vbNewLine _
                                             & "AND ZAI.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--マスタテーブル                                                                                                               " & vbNewLine _
                                             & "--営業所M                                                                                                                      " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_NRS_BR MNRS                                                                                              " & vbNewLine _
                                             & "ON MNRS.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "--商品M                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_GOODS MG                                                                                                 " & vbNewLine _
                                             & "ON  MG.NRS_BR_CD = OUTM.NRS_BR_CD                                                                                              " & vbNewLine _
                                             & "AND MG.GOODS_CD_NRS = OUTM.GOODS_CD_NRS                                                                                        " & vbNewLine _
                                             & "--商品M(MIN)                                                                                                                   " & vbNewLine _
                                             & "LEFT OUTER JOIN $LM_MST$..M_GOODS M_GOODS_MIN                                                                                  " & vbNewLine _
                                             & "ON M_GOODS_MIN.NRS_BR_CD      = OUTL.NRS_BR_CD                                                                                 " & vbNewLine _
                                             & "AND M_GOODS_MIN.GOODS_CD_NRS   = OUTM2.GOODS_CD_NRS                                                                            " & vbNewLine _
                                             & "--荷主M(商品M経由)                                                                                                             " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST MC                                                                                                  " & vbNewLine _
                                             & "ON  MC.NRS_BR_CD = MG.NRS_BR_CD                                                                                                " & vbNewLine _
                                             & "AND MC.CUST_CD_L = MG.CUST_CD_L                                                                                                " & vbNewLine _
                                             & "AND MC.CUST_CD_M = MG.CUST_CD_M                                                                                                " & vbNewLine _
                                             & "AND MC.CUST_CD_S = MG.CUST_CD_S                                                                                                " & vbNewLine _
                                             & "AND MC.CUST_CD_SS = MG.CUST_CD_SS                                                                                              " & vbNewLine _
                                             & "--荷主M(商品M経由) 最小の出荷(中)で抽出                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST MC2                                                                                                 " & vbNewLine _
                                             & "ON  MC2.NRS_BR_CD = M_GOODS_MIN.NRS_BR_CD                                                                                      " & vbNewLine _
                                             & "AND MC2.CUST_CD_L = M_GOODS_MIN.CUST_CD_L                                                                                      " & vbNewLine _
                                             & "AND MC2.CUST_CD_M = M_GOODS_MIN.CUST_CD_M                                                                                      " & vbNewLine _
                                             & "AND MC2.CUST_CD_S = M_GOODS_MIN.CUST_CD_S                                                                                      " & vbNewLine _
                                             & "AND MC2.CUST_CD_SS = M_GOODS_MIN.CUST_CD_SS                                                                                    " & vbNewLine _
                                             & "AND MC2.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--届先M(届先取得)(出荷L参照)                                                                                                   " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_DEST MDOUT                                                                                               " & vbNewLine _
                                             & "ON  MDOUT.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                           " & vbNewLine _
                                             & "AND MDOUT.CUST_CD_L = OUTL.CUST_CD_L                                                                                           " & vbNewLine _
                                             & "AND MDOUT.DEST_CD = OUTL.DEST_CD                                                                                               " & vbNewLine _
                                             & "--届先M(売上先取得)(出荷L参照)                                                                                                 " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_DEST MDOUTU                                                                                              " & vbNewLine _
                                             & "ON  MDOUTU.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                          " & vbNewLine _
                                             & "AND MDOUTU.CUST_CD_L = OUTL.CUST_CD_L                                                                                          " & vbNewLine _
                                             & "AND MDOUTU.DEST_CD = OUTL.SHIP_CD_L                                                                                            " & vbNewLine _
                                             & "--届先M(届先取得)(出荷EDIL参照)                                                                                                " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_DEST MDEDI                                                                                               " & vbNewLine _
                                             & "ON  MDEDI.NRS_BR_CD = EDIL.NRS_BR_CD                                                                                           " & vbNewLine _
                                             & "AND MDEDI.CUST_CD_L = EDIL.CUST_CD_L                                                                                           " & vbNewLine _
                                             & "AND MDEDI.DEST_CD = EDIL.DEST_CD                                                                                               " & vbNewLine _
                                             & "--届先M(納品書荷主名義名取得)(届先M参照)                                                                                       " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST MC_SALES                                                                                            " & vbNewLine _
                                             & "       ON MC_SALES.NRS_BR_CD  = MDOUT.NRS_BR_CD                                                                                " & vbNewLine _
                                             & "      AND MC_SALES.CUST_CD_L  = MDOUT.SALES_CD                                                                                 " & vbNewLine _
                                             & "      AND MC_SALES.CUST_CD_M  = '00'                                                                                           " & vbNewLine _
                                             & "      AND MC_SALES.CUST_CD_S  = '00'                                                                                           " & vbNewLine _
                                             & "      AND MC_SALES.CUST_CD_SS = '00'                                                                                           " & vbNewLine _
                                             & "--運送会社M                                                                                                                    " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_UNSOCO MUCO                                                                                              " & vbNewLine _
                                             & "ON  MUCO.NRS_BR_CD = UL.NRS_BR_CD                                                                                              " & vbNewLine _
                                             & "AND MUCO.UNSOCO_CD = UL.UNSO_CD                                                                                                " & vbNewLine _
                                             & "AND MUCO.UNSOCO_BR_CD = UL.UNSO_BR_CD                                                                                          " & vbNewLine _
                                             & "--倉庫M                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_SOKO MSO                                                                                                 " & vbNewLine _
                                             & "ON  MSO.NRS_BR_CD = OUTL.NRS_BR_CD  --追加                                                                                     " & vbNewLine _
                                             & "AND MSO.WH_CD     = OUTL.WH_CD                                                                                                 " & vbNewLine _
                                             & "--2014/5/16Start s.kobayashi NotesNo.2183                                                                                      " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN11                                                                                                  " & vbNewLine _
                                             & "ON  KBN11.KBN_GROUP_CD = 'U028'  --追加                                                                                        " & vbNewLine _
                                             & "AND UL.SEIQ_TARIFF_CD = KBN11.KBN_NM1                                                                                          " & vbNewLine _
                                             & "--2014/5/16End s.kobayashi NotesNo.2183                                                                                       " & vbNewLine _
                                             & "--距離程M(M_DEST.JIS < M_SOKO.JIS_CD)(出荷L参照)                                                                               " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_KYORI MKY1                                                                                               " & vbNewLine _
                                             & "ON  MKY1.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "--AND MKY1.KYORI_CD = MC.BETU_KYORI_CD                                                                                           " & vbNewLine _
                                             & "AND MKY1.KYORI_CD = (CASE ISNULL(KBN11.KBN_NM2,'') WHEN '' THEN MC.BETU_KYORI_CD ELSE KBN11.KBN_NM2 END)                       " & vbNewLine _
                                             & "AND MKY1.ORIG_JIS_CD = MDOUT.JIS                                                                                               " & vbNewLine _
                                             & "AND MKY1.DEST_JIS_CD = MSO.JIS_CD                                                                                              " & vbNewLine _
                                             & "--距離程M(M_SOKO.JIS_CD < M_DEST.JIS)(出荷L参照)                                                                               " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_KYORI MKY2                                                                                               " & vbNewLine _
                                             & "ON  MKY2.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "--AND MKY2.KYORI_CD = MC.BETU_KYORI_CD                                                                                           " & vbNewLine _
                                             & "AND MKY2.KYORI_CD = (CASE ISNULL(KBN11.KBN_NM2,'') WHEN '' THEN MC.BETU_KYORI_CD ELSE KBN11.KBN_NM2 END)                       " & vbNewLine _
                                             & "AND MKY2.ORIG_JIS_CD = MSO.JIS_CD                                                                                              " & vbNewLine _
                                             & "AND MKY2.DEST_JIS_CD = MDOUT.JIS                                                                                               " & vbNewLine _
                                             & "--距離程M(H_OUTKAEDI_L.DEST_JIS_CD < M_SOKO.JIS_CD)(出荷EDIL参照)                                                              " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_KYORI MKY3                                                                                               " & vbNewLine _
                                             & "ON  MKY3.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "--AND MKY3.KYORI_CD = MC.BETU_KYORI_CD                                                                                           " & vbNewLine _
                                             & "AND MKY3.KYORI_CD = (CASE ISNULL(KBN11.KBN_NM2,'') WHEN '' THEN MC.BETU_KYORI_CD ELSE KBN11.KBN_NM2 END)                       " & vbNewLine _
                                             & "AND MKY3.ORIG_JIS_CD = EDIL.DEST_JIS_CD                                                                                        " & vbNewLine _
                                             & "AND MKY3.DEST_JIS_CD = MSO.JIS_CD                                                                                              " & vbNewLine _
                                             & "--距離程M(M_SOKO.JIS_CD < H_OUTKAEDI_L.DEST_JIS_CD)(出荷EDIL参照)                                                              " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_KYORI MKY4                                                                                               " & vbNewLine _
                                             & "ON  MKY4.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "--AND MKY4.KYORI_CD = MC.BETU_KYORI_CD                                                                                           " & vbNewLine _
                                             & "AND MKY4.KYORI_CD = (CASE ISNULL(KBN11.KBN_NM2,'') WHEN '' THEN MC.BETU_KYORI_CD ELSE KBN11.KBN_NM2 END)                       " & vbNewLine _
                                             & "AND MKY4.ORIG_JIS_CD = MSO.JIS_CD                                                                                              " & vbNewLine _
                                             & "AND MKY4.DEST_JIS_CD = EDIL.DEST_JIS_CD                                                                                        " & vbNewLine _
                                             & "--届先商品M(出荷L参照)                                                                                                         " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_DESTGOODS MDGL                                                                                           " & vbNewLine _
                                             & "ON  MDGL.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "AND MDGL.CUST_CD_L = OUTL.CUST_CD_L                                                                                            " & vbNewLine _
                                             & "AND MDGL.CUST_CD_M = OUTL.CUST_CD_M                                                                                            " & vbNewLine _
                                             & "AND MDGL.CD = OUTL.DEST_CD                                                                                                     " & vbNewLine _
                                             & "AND MDGL.GOODS_CD_NRS = MG.GOODS_CD_NRS                                                                                        " & vbNewLine _
                                             & "AND MDGL.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--届先商品M(出荷EDI参照)                                                                                                       " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_DESTGOODS MDGE                                                                                           " & vbNewLine _
                                             & "ON  MDGE.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "AND MDGE.CUST_CD_L = OUTL.CUST_CD_L                                                                                            " & vbNewLine _
                                             & "AND MDGE.CUST_CD_M = OUTL.CUST_CD_M                                                                                            " & vbNewLine _
                                             & "AND MDGE.CD = EDIL.DEST_CD                                                                                                     " & vbNewLine _
                                             & "AND MDGE.GOODS_CD_NRS = MG.GOODS_CD_NRS                                                                                        " & vbNewLine _
                                             & "AND MDGE.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--消防M★                                                                                                      " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_SHOBO MSHOBO                                                                                           " & vbNewLine _
                                             & "ON  MSHOBO.SHOBO_CD = MG.SHOBO_CD                                                                                            " & vbNewLine _
                                             & "AND MSHOBO.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--区分M(納入予定区分)                                                                                                          " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN1                                                                                                 " & vbNewLine _
                                             & "ON  KBN1.KBN_GROUP_CD = 'N010'                                                                                                 " & vbNewLine _
                                             & "AND KBN1.KBN_CD = OUTL.ARR_PLAN_TIME                                                                                           " & vbNewLine _
                                             & "AND KBN1.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--区分M(日本合成用倉庫名)                                                                                                      " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN2                                                                                                 " & vbNewLine _
                                             & "ON  KBN2.KBN_GROUP_CD = 'P005'                                                                                                 " & vbNewLine _
                                             & "AND KBN2.KBN_CD = '00'                                                                                                         " & vbNewLine _
                                             & "AND KBN2.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--区分M(日本合成用部署名)                                                                                                      " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN3                                                                                                 " & vbNewLine _
                                             & "ON  KBN3.KBN_GROUP_CD = 'P005'                                                                                                 " & vbNewLine _
                                             & "AND KBN3.KBN_CD = '01'                                                                                                         " & vbNewLine _
                                             & "AND KBN3.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--区分M(日本合成用営業署名)                                                                                                    " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN4                                                                                                 " & vbNewLine _
                                             & "ON  KBN4.KBN_GROUP_CD = 'P005'                                                                                                 " & vbNewLine _
                                             & "AND KBN4.KBN_CD = '02'                                                                                                         " & vbNewLine _
                                             & "AND KBN4.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--区分M(荷姿)                                                                                                                  " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN5                                                                                                 " & vbNewLine _
                                             & "ON  KBN5.KBN_GROUP_CD = 'N001'                                                                                                 " & vbNewLine _
                                             & "AND KBN5.KBN_CD = MG.PKG_UT                                                                                                    " & vbNewLine _
                                             & "AND KBN5.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--明細タイトル（小分け）                                                                                                       " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN6                                                                                                 " & vbNewLine _
                                             & "ON  KBN6.KBN_GROUP_CD = 'S041'                                                                                                 " & vbNewLine _
                                             & "AND KBN6.KBN_CD = OUTM.ALCTD_KB                                                                                                " & vbNewLine _
                                             & "AND KBN6.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--区分M(毒劇区分名称)                                                                                                           " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN7                                                                                                  " & vbNewLine _
                                             & "ON  KBN7.KBN_GROUP_CD = 'G001'                                                                                                  " & vbNewLine _
                                             & "AND KBN7.KBN_CD = MG.DOKU_KB                                                                                                    " & vbNewLine _
                                             & "AND KBN7.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--区分M(元着払区分名称)                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN9                                                                                                 " & vbNewLine _
                                             & "ON  KBN9.KBN_GROUP_CD = 'M001'                                                                                                 " & vbNewLine _
                                             & "AND KBN9.KBN_CD = OUTL.PC_KB                                                                                                   " & vbNewLine _
                                             & "AND KBN9.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--区分M(消防区分名称)★                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN10                                                                                                " & vbNewLine _
                                             & "ON  KBN10.KBN_GROUP_CD = 'S004'                                                                                                " & vbNewLine _
                                             & "AND KBN10.KBN_CD = MSHOBO.RUI                                                                                                  " & vbNewLine _
                                             & "AND KBN10.SYS_DEL_FLG = '0'                                                                                                    " & vbNewLine _
                                             & "--★出荷EDI M(日医工)                                                                                                          " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..H_OUTKAEDI_M EDIM                                                                                            " & vbNewLine _
                                             & "ON  EDIM.NRS_BR_CD        = OUTM.NRS_BR_CD                                                                                     " & vbNewLine _
                                             & "AND EDIM.OUTKA_CTL_NO     = OUTM.OUTKA_NO_L                                                                                    " & vbNewLine _
                                             & "AND EDIM.OUTKA_CTL_NO_CHU = OUTM.OUTKA_NO_M                                                                                    " & vbNewLine _
                                             & "AND EDIM.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--荷主明細M ★                                                                                                                 " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST_DETAILS MCD_N                                                                                       " & vbNewLine _
                                             & "ON  MCD_N.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                           " & vbNewLine _
                                             & "AND MCD_N.CUST_CD   = OUTL.CUST_CD_L                                                                                           " & vbNewLine _
                                             & "AND MCD_N.SUB_KB = '26'                                                                                                        " & vbNewLine _
                                             & "--荷主明細M                                                                                                                    " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST_DETAILS MCD_F                                                                                       " & vbNewLine _
                                             & "ON  MCD_F.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                           " & vbNewLine _
                                             & "AND MCD_F.CUST_CD   = OUTL.CUST_CD_L                                                                                           " & vbNewLine _
                                             & "AND MCD_F.SUB_KB = '29'                                                                                                        " & vbNewLine _
                                             & "--荷主明細M ★                                                                                                                 " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST_DETAILS MCD                                                                                         " & vbNewLine _
                                             & "ON  MCD.NRS_BR_CD = MG.NRS_BR_CD                                                                                               " & vbNewLine _
                                             & "AND MCD.CUST_CD   = MG.CUST_CD_L                                                                                               " & vbNewLine _
                                             & "AND MCD.SUB_KB = '20'                                                                                                          " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_GOODS_DETAILS MGD16                                                                                        " & vbNewLine _
                                             & "       ON MGD16.NRS_BR_CD = MG.NRS_BR_CD                                                                                       " & vbNewLine _
                                             & "      AND MGD16.GOODS_CD_NRS = MG.GOODS_CD_NRS                                                                                 " & vbNewLine _
                                             & "      AND MGD16.SUB_KB = '16'                                                                                                  " & vbNewLine _
                                             & "      AND MGD16.SYS_DEL_FLG = '0'                                                                                              " & vbNewLine _
                                             & "--出荷Lでの荷主帳票パターン取得                                                                                                " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST_RPT MCR1                                                                                            " & vbNewLine _
                                             & "ON  OUTL.NRS_BR_CD = MCR1.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "AND OUTL.CUST_CD_L = MCR1.CUST_CD_L                                                                                            " & vbNewLine _
                                             & "AND OUTL.CUST_CD_M = MCR1.CUST_CD_M                                                                                            " & vbNewLine _
                                             & "AND '00' = MCR1.CUST_CD_S                                                                                                      " & vbNewLine _
                                             & "AND MCR1.PTN_ID = '04'                                                                                                         " & vbNewLine _
                                             & "--帳票パターン取得                                                                                                             " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_RPT MR1                                                                                                  " & vbNewLine _
                                             & "ON  MR1.NRS_BR_CD = MCR1.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "AND MR1.PTN_ID = MCR1.PTN_ID                                                                                                   " & vbNewLine _
                                             & "AND MR1.PTN_CD = MCR1.PTN_CD                                                                                                   " & vbNewLine _
                                             & "AND MR1.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--商品Mの荷主での荷主帳票パターン取得                                                                                          " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST_RPT MCR2                                                                                            " & vbNewLine _
                                             & "ON  MG.NRS_BR_CD = MCR2.NRS_BR_CD                                                                                              " & vbNewLine _
                                             & "AND MG.CUST_CD_L = MCR2.CUST_CD_L                                                                                              " & vbNewLine _
                                             & "AND MG.CUST_CD_M = MCR2.CUST_CD_M                                                                                              " & vbNewLine _
                                             & "AND MG.CUST_CD_S = MCR2.CUST_CD_S                                                                                              " & vbNewLine _
                                             & "AND MCR2.PTN_ID = '04'                                                                                                         " & vbNewLine _
                                             & "--帳票パターン取得                                                                                                             " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_RPT MR2                                                                                                  " & vbNewLine _
                                             & "ON  MR2.NRS_BR_CD = MCR2.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "AND MR2.PTN_ID = MCR2.PTN_ID                                                                                                   " & vbNewLine _
                                             & "AND MR2.PTN_CD = MCR2.PTN_CD                                                                                                   " & vbNewLine _
                                             & "AND MR2.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--存在しない場合の帳票パターン取得                                                                                             " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_RPT MR3                                                                                                  " & vbNewLine _
                                             & "ON  MR3.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "AND MR3.PTN_ID = '04'                                                                                                          " & vbNewLine _
                                             & "AND MR3.STANDARD_FLAG = '01'                                                                                                   " & vbNewLine _
                                             & "AND MR3.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--ユーザM                                                                                                                      " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..S_USER MUSER                                                                                               " & vbNewLine _
                                             & "ON MUSER.USER_CD = OUTL.SYS_ENT_USER                                                                                           " & vbNewLine _
                                             & "AND MUSER.SYS_DEL_FLG = '0'                                                                                                    " & vbNewLine _
                                             & "--商品明細M                                                                                                                    " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_GOODS_DETAILS MGD                                                                                        " & vbNewLine _
                                             & "ON  MGD.NRS_BR_CD = MG.NRS_BR_CD                                                                                               " & vbNewLine _
                                             & "AND MGD.GOODS_CD_NRS = MG.GOODS_CD_NRS                                                                                         " & vbNewLine _
                                             & "AND MGD.SUB_KB = '09'                                                                                                          " & vbNewLine _
                                             & "AND MGD.SYS_DEL_FLG = '0'       --ADD 2019/02/07 依頼番号 : 004605   【LMS】納品書がの梱包個数が2倍になるバグ修正              " & vbNewLine _
                                             & "WHERE                                                                                                                          " & vbNewLine _
                                             & "    OUTL.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "AND OUTL.NRS_BR_CD = @NRS_BR_CD                                                                                                " & vbNewLine _
                                             & "AND OUTL.OUTKA_NO_L = @KANRI_NO_L                                                                                              " & vbNewLine
    '(2014.03.31) 追加END

    '(2014.03.31) 追加START
    ''' <summary>
    ''' 印刷データ抽出用
    ''' </summary>
    ''' <remarks>出荷管理番号(中)をMINで抽出</remarks>
    Friend Const SQL_SELECT_MAIN_737 As String = " --SQL_SELECT_MAIN_740                                            " & vbNewLine _
                                                & " SELECT                                                           " & vbNewLine _
                                                & "        RPT_ID                                                    " & vbNewLine _
                                                & "      , NRS_BR_CD                                                 " & vbNewLine _
                                                & "      , PRINT_SORT                                                " & vbNewLine _
                                                & "      , DEST_CD                                                   " & vbNewLine _
                                                & "      , DEST_NM                                                   " & vbNewLine _
                                                & "      , DEST_AD_1                                                 " & vbNewLine _
                                                & "      , DEST_AD_2                                                 " & vbNewLine _
                                                & "      , DEST_AD_3                                                 " & vbNewLine _
                                                & "      , DEST_TEL                                                  " & vbNewLine _
                                                & "      , OUTKA_PLAN_DATE                                           " & vbNewLine _
                                                & "      , CUST_ORD_NO                                               " & vbNewLine _
                                                & "      , BUYER_ORD_NO                                              " & vbNewLine _
                                                & "      , UNSOCO_NM                                                 " & vbNewLine _
                                                & "      , ARR_PLAN_DATE                                             " & vbNewLine _
                                                & "      , ARR_PLAN_TIME                                             " & vbNewLine _
                                                & "      , OUTKA_NO_L                                                " & vbNewLine _
                                                & "      , URIG_NM                                                   " & vbNewLine _
                                                & "      , CUST_NM_L                                                 " & vbNewLine _
                                                & "      , CUST_NM_M                                                 " & vbNewLine _
                                                & "      , DENPYO_NM                                                 " & vbNewLine _
                                                & "      , CASE WHEN DEST_SALES_CD <> ''                             " & vbNewLine _
                                                & "              AND DEST_SALES_CD IS NOT NULL THEN DEST_SALES_AD_1  " & vbNewLine _
                                                & "             ELSE CUST_AD_1 END CUST_AD_1                         " & vbNewLine _
                                                & "      , CASE WHEN DEST_SALES_CD <> ''                             " & vbNewLine _
                                                & "              AND DEST_SALES_CD IS NOT NULL THEN DEST_SALES_AD_2  " & vbNewLine _
                                                & "             ELSE CUST_AD_2 END CUST_AD_2                         " & vbNewLine _
                                                & "      , CASE WHEN DEST_SALES_CD <> ''                             " & vbNewLine _
                                                & "              AND DEST_SALES_CD IS NOT NULL THEN DEST_SALES_TEL   " & vbNewLine _
                                                & "        ELSE CUST_TEL                                             " & vbNewLine _
                                                & "        END                        AS CUST_TEL                    " & vbNewLine _
                                                & "      , NRS_BR_NM                                                 " & vbNewLine _
                                                & "      , NRS_BR_AD1                                                " & vbNewLine _
                                                & "      , NRS_BR_AD2                                                " & vbNewLine _
                                                & "      , NRS_BR_TEL                                                " & vbNewLine _
                                                & "      , NRS_BR_FAX                                                " & vbNewLine _
                                                & "      , PIC                                                       " & vbNewLine _
                                                & "      , OUTKA_NO_M                 AS OUTKA_NO_M                  " & vbNewLine _
                                                & "      , ''                         AS OUTKA_NO_S                  " & vbNewLine _
                                                & "      , INKA_DATE                                                 " & vbNewLine _
                                                & "      , '' AS REMARK_OUT --REMARK_OUT                                                " & vbNewLine _
                                                & "      , GOODS_NM_1                                                " & vbNewLine _
                                                & "      , LOT_NO                                                    " & vbNewLine _
                                                & "      , SERIAL_NO                                                 " & vbNewLine _
                                                & "      , IRIME                                                     " & vbNewLine _
                                                & "      , PKG_NB                                                    " & vbNewLine _
                                                & "      , SUM(ALCTD_NB) / PKG_NB     AS KONSU                       " & vbNewLine _
                                                & "      , SUM(ALCTD_NB) % PKG_NB     AS HASU                        " & vbNewLine _
                                                & "      , SUM(ALCTD_NB)              AS ALCTD_NB                    " & vbNewLine _
                                                & "      , PKG_UT                                                    " & vbNewLine _
                                                & "      , PKG_UT_NM                                                 " & vbNewLine _
                                                & "      , SUM(ALCTD_QT)              AS ALCTD_QT                    " & vbNewLine _
                                                & "      , IRIME_UT                                                  " & vbNewLine _
                                                & "      , WT                         AS WT                          " & vbNewLine _
                                                & "      , UNSO_WT                                                   " & vbNewLine _
                                                & "      , SUM(ALCTD_NB) * PKG_WT     AS PKG_WT                      " & vbNewLine _
                                                & "      , TOU_NO                                                    " & vbNewLine _
                                                & "      , SITU_NO                                                   " & vbNewLine _
                                                & "      , ZONE_CD                                                   " & vbNewLine _
                                                & "      , LOCA                                                      " & vbNewLine _
                                                & "      , MIN(ZAN_KONSU)             AS ZAN_KONSU                   " & vbNewLine _
                                                & "      , MIN(ALCTD_CAN_NB) % PKG_NB AS ZAN_HASU                    " & vbNewLine _
                                                & "      , GOODS_CD_CUST                                             " & vbNewLine _
                                                & "      , REMARK_M                                                  " & vbNewLine _
                                                & "      , CUST_NM_S                                                 " & vbNewLine _
                                                & "      , CUST_NM_S_H                                               " & vbNewLine _
                                                & "      , CUST_ORD_NO_DTL                                           " & vbNewLine _
                                                & "      , OUTKA_REMARK                                              " & vbNewLine _
                                                & "      , HAISOU_REMARK                                             " & vbNewLine _
                                                & "      , NHS_REMARK                                                " & vbNewLine _
                                                & "      , KYORI                                                     " & vbNewLine _
                                                & "      , OUTKA_PKG_NB_L                                            " & vbNewLine _
                                                & "      , SOKO_NM                                                   " & vbNewLine _
                                                & "      , BUSHO_NM                                                  " & vbNewLine _
                                                & "      , NRS_BR_NM_NICHI                                           " & vbNewLine _
                                                & "      , MIN(ALCTD_CAN_QT)          AS ALCTD_CAN_QT                " & vbNewLine _
                                                & "      , ALCTD_KB                                                  " & vbNewLine _
                                                & "      , PTN_FLAG                                                  " & vbNewLine _
                                                & "      , CUST_CD_L                                                 " & vbNewLine _
                                                & "      , ORDER_TYPE                 AS ORDER_TYPE                  " & vbNewLine _
                                                & "      , CASE WHEN URIG_NM <> ''                                   " & vbNewLine _
                                                & "              AND URIG_NM IS NOT NULL THEN URIG_NM                " & vbNewLine _
                                                & "             WHEN DEST_SALES_NM   <> ''                           " & vbNewLine _
                                                & "              AND DEST_SALES_NM IS NOT NULL THEN DEST_SALES_NM    " & vbNewLine _
                                                & "             WHEN DENPYO_NM   <> ''                               " & vbNewLine _
                                                & "              AND DENPYO_NM IS NOT NULL   THEN DENPYO_NM          " & vbNewLine _
                                                & "        ELSE CUST_NM_L + CASE WHEN RPT_ID = 'LMC637' THEN ' ' + CUST_NM_S ELSE '' END                                           " & vbNewLine _
                                                & "        END                        AS ATSUKAISYA_NM               " & vbNewLine _
                                                & "      , MCD_SET_NAIYO                                             " & vbNewLine _
                                                & "      , MCD_SET_NAIYO_2                                           " & vbNewLine _
                                                & "      , MCD_SET_NAIYO_3                                           " & vbNewLine _
                                                & "      , PC_KB_NM                                                  " & vbNewLine _
                                                & "      , BUYER_ORD_NO_DTL                                          " & vbNewLine _
                                                & "      , TORI_KB                    --FREE_C01                     " & vbNewLine _
                                                & "      , SHIP_CD_L                                                 " & vbNewLine _
                                                & "      , SET_NAIYO_4                                               " & vbNewLine _
                                                & "      , SET_NAIYO_5                                               " & vbNewLine _
                                                & "      , SET_NAIYO_6                                               " & vbNewLine _
                                                & "      , GOODS_NM_2                                                " & vbNewLine _
                                                & "      , KICHO_KB                                                  " & vbNewLine _
                                                & "      , SEI_YURAI_KB                                              " & vbNewLine _
                                                & "      , REMARK_UPPER                                              " & vbNewLine _
                                                & "      , REMARK_LOWER                                              " & vbNewLine _
                                                & "      , GOODS_SYUBETU                                             " & vbNewLine _
                                                & "      , YUKOU_KIGEN                                               " & vbNewLine _
                                                & "      , GOODS_NM_3                                                " & vbNewLine _
                                                & "      , EDISHIP_CD                                                " & vbNewLine _
                                                & "      , EDIDEST_CD                                                " & vbNewLine _
                                                & "      , SET_NAIYO_FROM1                                           " & vbNewLine _
                                                & "      , SET_NAIYO_FROM2                                           " & vbNewLine _
                                                & "      , SET_NAIYO_FROM3                                           " & vbNewLine _
                                                & "      , CASE WHEN DEST_SALES_CD <> ''                             " & vbNewLine _
                                                & "              AND DEST_SALES_CD IS NOT NULL THEN DEST_SALES_AD_3  " & vbNewLine _
                                                & "        ELSE CUST_AD_3                                            " & vbNewLine _
                                                & "        END                        AS CUST_AD_3                   " & vbNewLine _
                                                & "      , DEST_REMARK                                               " & vbNewLine _
                                                & "      , DEST_SALES_CD                                             " & vbNewLine _
                                                & "      , DEST_SALES_NM                                             " & vbNewLine _
                                                & "      , DEST_SALES_AD_1                                           " & vbNewLine _
                                                & "      , DEST_SALES_AD_2                                           " & vbNewLine _
                                                & "      , DEST_SALES_AD_3                                           " & vbNewLine _
                                                & "      , DEST_SALES_TEL                                            " & vbNewLine _
                                                & "      , SAGYO_RYAK_1                                              " & vbNewLine _
                                                & "      , SAGYO_RYAK_2                                              " & vbNewLine _
                                                & "      , SAGYO_RYAK_3                                              " & vbNewLine _
                                                & "      , SAGYO_RYAK_4                                              " & vbNewLine _
                                                & "      , SAGYO_RYAK_5                                              " & vbNewLine _
                                                & "      , DEST_SAGYO_RYAK_1                                         " & vbNewLine _
                                                & "      , DEST_SAGYO_RYAK_2                                         " & vbNewLine _
                                                & "      , SZ01_YUSO                                                 " & vbNewLine _
                                                & "      , SZ01_UNSO                                                 " & vbNewLine _
                                                & "      , '' AS GOODS_COND_CD_1 --GOODS_COND_CD_1                                           " & vbNewLine _
                                                & "      , '' AS GOODS_COND_CD --GOODS_COND_CD                                             " & vbNewLine _
                                                & "      , '' AS GOODS_COND_CD_3 --GOODS_COND_CD_3                                           " & vbNewLine _
                                                & "      , REMARK_ZAI                                                " & vbNewLine _
                                                & "      , LT_DATE                                                   " & vbNewLine _
                                                & "      , CASE WHEN SET_NAIYO = '1'  THEN  '1'                      " & vbNewLine _
                                                & "        ELSE ''                                                   " & vbNewLine _
                                                & "        END  AS SET_NAIYO                                         " & vbNewLine _
                                                & "      , SYS_UPD_PGID                                              " & vbNewLine _
                                                & "      , SHOBO_KBN_NM                                              " & vbNewLine _
                                                & "      , HINMEI                                                    " & vbNewLine _
                                                & "      , CUST_CD_M                                                 " & vbNewLine _
                                                & "      , CUST_CD_S                                                 " & vbNewLine _
                                                & "      , CUST_COST_CD2                                             " & vbNewLine _
                                                & "   FROM                                                           " & vbNewLine _
                                                & "        (                                                         " & vbNewLine

    '(2014.06.10) 追加START
    ''' <summary>
    ''' 印刷データ抽出用(出荷テーブル)
    ''' </summary>
    ''' <remarks></remarks>
    Friend Const SQL_SELECT_OUTKA_737 As String = "--★★★SQL_SELECT_OUTKA_737★★★  出荷テーブル                                                                           " & vbNewLine _
                                             & "SELECT                                                                                                                         " & vbNewLine _
                                             & " CASE WHEN MR2.PTN_CD IS NOT NULL THEN MR2.RPT_ID                                                                              " & vbNewLine _
                                             & "      WHEN MR1.PTN_CD IS NOT NULL THEN MR1.RPT_ID                                                                              " & vbNewLine _
                                             & "      ELSE MR3.RPT_ID                                                                                                          " & vbNewLine _
                                             & " END              AS RPT_ID                                                                                                    " & vbNewLine _
                                             & ",OUTL.NRS_BR_CD   AS NRS_BR_CD                                                                                                 " & vbNewLine _
                                             & ",OUTM.PRINT_SORT  AS PRINT_SORT                                                                                                " & vbNewLine _
                                             & ",CASE WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_CD                                                                     " & vbNewLine _
                                             & "      ELSE OUTL.DEST_CD                                                                                                        " & vbNewLine _
                                             & " END              AS DEST_CD                                                                                                   " & vbNewLine _
                                             & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_NM                                                                               " & vbNewLine _
                                             & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_NM                                                                     " & vbNewLine _
                                             & "      ELSE MDOUT.DEST_NM                                                                                                       " & vbNewLine _
                                             & " END              AS DEST_NM                                                                                                   " & vbNewLine _
                                             & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_AD_1                                                                             " & vbNewLine _
                                             & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_AD_1                                                                   " & vbNewLine _
                                             & "      ELSE MDOUT.AD_1                                                                                                          " & vbNewLine _
                                             & " END              AS DEST_AD_1                                                                                                 " & vbNewLine _
                                             & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_AD_2                                                                             " & vbNewLine _
                                             & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_AD_2                                                                   " & vbNewLine _
                                             & "      ELSE MDOUT.AD_2                                                                                                          " & vbNewLine _
                                             & " END              AS DEST_AD_2                                                                                                 " & vbNewLine _
                                             & ",OUTL.DEST_AD_3   AS DEST_AD_3                                                                                                 " & vbNewLine _
                                             & ",OUTL.DEST_TEL    AS DEST_TEL                                                                                                  " & vbNewLine _
                                             & ",OUTL.OUTKA_PLAN_DATE   AS OUTKA_PLAN_DATE                                                                                     " & vbNewLine _
                                             & ",OUTL.CUST_ORD_NO       AS CUST_ORD_NO                                                                                         " & vbNewLine _
                                             & ",OUTL.BUYER_ORD_NO      AS BUYER_ORD_NO                                                                                        " & vbNewLine _
                                             & ",MUCO.UNSOCO_NM         AS UNSOCO_NM                                                                                           " & vbNewLine _
                                             & ",OUTL.ARR_PLAN_DATE     AS ARR_PLAN_DATE                                                                                       " & vbNewLine _
                                             & ",KBN1.KBN_NM1           AS ARR_PLAN_TIME                                                                                       " & vbNewLine _
                                             & ",OUTL.OUTKA_NO_L        AS OUTKA_NO_L                                                                                          " & vbNewLine _
                                             & ",MDOUTU.DEST_NM         AS URIG_NM                                                                                             " & vbNewLine _
                                             & ",MC.CUST_NM_L           AS CUST_NM_L                                                                                           " & vbNewLine _
                                             & ",MC.CUST_NM_M           AS CUST_NM_M                                                                                           " & vbNewLine _
                                             & ",MC.AD_1                AS CUST_AD_1                                                                                           " & vbNewLine _
                                             & ",MC.AD_2                AS CUST_AD_2                                                                                           " & vbNewLine _
                                             & ",MC.TEL                 AS CUST_TEL                                                                                            " & vbNewLine _
                                             & ",MC.DENPYO_NM           AS DENPYO_NM                                                                                            " & vbNewLine _
                                             & ",MNRS.NRS_BR_NM         AS NRS_BR_NM                                                                                           " & vbNewLine _
                                             & ",CASE WHEN MSO.WH_KB = '01' THEN MSO.AD_1                                                                             " & vbNewLine _
                                             & "      ELSE MNRS.AD_1                                                                                                          " & vbNewLine _
                                             & " END              AS NRS_BR_AD1                                                                                                 " & vbNewLine _
                                             & ",CASE WHEN MSO.WH_KB = '01' THEN MSO.AD_2                                                                             " & vbNewLine _
                                             & "      ELSE MNRS.AD_2                                                                                                          " & vbNewLine _
                                             & " END              AS NRS_BR_AD2                                                                                                 " & vbNewLine _
                                             & ",CASE WHEN MSO.WH_KB = '01' THEN MSO.TEL                                                                             " & vbNewLine _
                                             & "      ELSE MNRS.TEL                                                                                                          " & vbNewLine _
                                             & " END              AS NRS_BR_TEL                                                                                                 " & vbNewLine _
                                             & ",CASE WHEN MSO.WH_KB = '01' THEN MSO.FAX                                                                             " & vbNewLine _
                                             & "      ELSE MNRS.FAX                                                                                                          " & vbNewLine _
                                             & " END              AS NRS_BR_FAX                                                                                                 " & vbNewLine _
                                             & ",MUSER.USER_NM          AS PIC                                                                                                 " & vbNewLine _
                                             & ",OUTM.OUTKA_NO_M        AS OUTKA_NO_M                                                                                          " & vbNewLine _
                                             & ",''                     AS OUTKA_NO_S                                                                                          " & vbNewLine _
                                             & "--,CASE WHEN INL.INKA_STATE_KB < '50' THEN INL.INKA_DATE                                                                         " & vbNewLine _
                                             & "--      ELSE ZAI.INKO_DATE                                                                                                       " & vbNewLine _
                                             & "-- END                    AS INKA_DATE                                                                                           " & vbNewLine _
                                             & ",''                     AS INKA_DATE                                                                                           " & vbNewLine _
                                             & ",ZAI.REMARK_OUT         AS REMARK_OUT                                                                                          " & vbNewLine _
                                             & ",CASE WHEN (MDGE.GOODS_NM IS NOT NULL AND MDGE.GOODS_NM <> '' AND EDIL.OUTKA_CTL_NO IS NOT NULL) THEN MDGE.GOODS_NM            " & vbNewLine _
                                             & "      WHEN (MDGL.GOODS_NM IS NOT NULL AND MDGL.GOODS_NM <> '' AND EDIL.OUTKA_CTL_NO IS NULL) THEN MDGL.GOODS_NM                " & vbNewLine _
                                             & "      ELSE MG.GOODS_NM_1                                                                                                       " & vbNewLine _
                                             & " END                    AS GOODS_NM_1                                                                                          " & vbNewLine _
                                             & "--,''                     AS LOT_NO                                                                                              " & vbNewLine _
                                             & ",OUTS.LOT_NO            AS LOT_NO                                                                                              " & vbNewLine _
                                             & ",''                     AS SERIAL_NO                                                                                           " & vbNewLine _
                                             & ",OUTS.IRIME             AS IRIME                                                                                               " & vbNewLine _
                                             & ",MG.PKG_NB              AS PKG_NB                                                                                              " & vbNewLine _
                                             & ",OUTS.ALCTD_NB / MG.PKG_NB     AS KONSU                                                                                        " & vbNewLine _
                                             & ",OUTS.ALCTD_NB % MG.PKG_NB     AS HASU                                                                                         " & vbNewLine _
                                             & ",OUTS.ALCTD_NB          AS ALCTD_NB                                                                                            " & vbNewLine _
                                             & ",MG.PKG_UT              AS PKG_UT                                                                                              " & vbNewLine _
                                             & ",KBN5.KBN_NM1           AS PKG_UT_NM                                                                                           " & vbNewLine _
                                             & ",OUTS.ALCTD_QT          AS ALCTD_QT                                                                                            " & vbNewLine _
                                             & ",MG.STD_IRIME_UT        AS IRIME_UT                                                                                            " & vbNewLine _
                                             & ",UL.UNSO_WT             AS WT                                                                                                  " & vbNewLine _
                                             & ",0                      AS UNSO_WT                                                                                             " & vbNewLine _
                                             & ",CASE WHEN ISNUMERIC(MGD16.SET_NAIYO) = 1 THEN CONVERT(NUMERIC(12,3),MGD16.SET_NAIYO)                                          " & vbNewLine _
                                             & "      ELSE 0                                                                                                                   " & vbNewLine _
                                             & " END                    AS PKG_WT                                                                                              " & vbNewLine _
                                             & ",''                     AS TOU_NO                                                                                              " & vbNewLine _
                                             & ",''                     AS SITU_NO                                                                                             " & vbNewLine _
                                             & ",''                     AS ZONE_CD                                                                                             " & vbNewLine _
                                             & ",''                     AS LOCA                                                                                                " & vbNewLine _
                                             & ",OUTS.ALCTD_CAN_NB / MG.PKG_NB   AS ZAN_KONSU                                                                                  " & vbNewLine _
                                             & ",OUTS.ALCTD_CAN_NB % MG.PKG_NB   AS ZAN_HASU                                                                                   " & vbNewLine _
                                             & ",MG.GOODS_CD_CUST       AS GOODS_CD_CUST                                                                                       " & vbNewLine _
                                             & ",OUTM.REMARK            AS REMARK_M                                                                                            " & vbNewLine _
                                             & ",MC.CUST_NM_S  AS CUST_NM_S                                                                                           " & vbNewLine _
                                             & ",MC2.CUST_NM_S   AS CUST_NM_S_H                                                                                           " & vbNewLine _
                                             & ",OUTM.CUST_ORD_NO_DTL   AS CUST_ORD_NO_DTL                                                                                     " & vbNewLine _
                                             & ",OUTL.REMARK            AS OUTKA_REMARK                                                                                        " & vbNewLine _
                                             & ",UL.REMARK              AS HAISOU_REMARK                                                                                       " & vbNewLine _
                                             & ",OUTL.NHS_REMARK        AS NHS_REMARK                                                                                          " & vbNewLine _
                                             & ",CASE WHEN (OUTL.DEST_KB = '02' AND MDEDI.KYORI > 0) THEN MDEDI.KYORI                                                          " & vbNewLine _
                                             & "      WHEN (OUTL.DEST_KB = '02' AND MDEDI.KYORI = 0 AND EDIL.DEST_JIS_CD <= MSO.JIS_CD) THEN MKY3.KYORI                        " & vbNewLine _
                                             & "      WHEN (OUTL.DEST_KB = '02' AND MDEDI.KYORI = 0 AND MSO.JIS_CD <= EDIL.DEST_JIS_CD) THEN MKY4.KYORI                        " & vbNewLine _
                                             & "      WHEN (OUTL.DEST_KB <> '02' AND MDOUT.KYORI > 0) THEN MDOUT.KYORI                                                         " & vbNewLine _
                                             & "      WHEN (OUTL.DEST_KB <> '02' AND MDOUT.KYORI = 0 AND MDOUT.JIS <= MSO.JIS_CD) THEN MKY1.KYORI                              " & vbNewLine _
                                             & "      WHEN (OUTL.DEST_KB <> '02' AND MDOUT.KYORI = 0 AND MSO.JIS_CD <= MDOUT.JIS) THEN MKY2.KYORI                              " & vbNewLine _
                                             & "      ELSE 0                                                                                                                   " & vbNewLine _
                                             & " END                    AS KYORI                                                                                               " & vbNewLine _
                                             & ",OUTL.OUTKA_PKG_NB      AS OUTKA_PKG_NB_L                                                                                      " & vbNewLine _
                                             & ",KBN2.KBN_NM1           AS SOKO_NM                                                                                             " & vbNewLine _
                                             & ",KBN3.KBN_NM1           AS BUSHO_NM                                                                                            " & vbNewLine _
                                             & ",KBN4.KBN_NM1           AS NRS_BR_NM_NICHI                                                                                     " & vbNewLine _
                                             & ",OUTS.ALCTD_CAN_QT      AS ALCTD_CAN_QT                                                                                        " & vbNewLine _
                                             & ",OUTM.ALCTD_KB          AS ALCTD_KB                                                                                            " & vbNewLine _
                                             & ",'0'                    AS PTN_FLAG                                                                                            " & vbNewLine _
                                             & ",OUTL.CUST_CD_L         AS CUST_CD_L                                                                                           " & vbNewLine _
                                             & ",OUTL.ORDER_TYPE        AS ORDER_TYPE                                                                                          " & vbNewLine _
                                             & ",OUTL.SYS_UPD_PGID      AS SYS_UPD_PGID                                                                                        " & vbNewLine _
                                             & ",ZAI.LT_DATE                                                                                                                   " & vbNewLine _
                                             & ",OUTM.BUYER_ORD_NO_DTL AS BUYER_ORD_NO_DTL                                                                                     " & vbNewLine _
                                             & ",ZAI.GOODS_COND_KB_1 AS GOODS_COND_CD_1                                                                                        " & vbNewLine _
                                             & ",ZAI.GOODS_COND_KB_2 AS GOODS_COND_CD                                                                                          " & vbNewLine _
                                             & ",ZAI.GOODS_COND_KB_3 AS GOODS_COND_CD_3                                                                                        " & vbNewLine _
                                             & "--,ZAI.REMARK AS REMARK_ZAI                                                                                                      " & vbNewLine _
                                             & ",'' AS REMARK_ZAI                                                                                                              " & vbNewLine _
                                             & ",KBN6.KBN_NM2 AS TITLE_SMPL                                                                                                    " & vbNewLine _
                                             & ",OUTS.ALCTD_CAN_NB AS ALCTD_CAN_NB                                                                                             " & vbNewLine _
                                             & ",OUTM.BACKLOG_QT                                                                                                               " & vbNewLine _
                                             & ",KBN7.KBN_NM2 AS DOKU_NM                                                                                                       " & vbNewLine _
                                             & " ,MCD.SET_NAIYO    AS MCD_SET_NAIYO                                                                                            " & vbNewLine _
                                             & " ,MCD.SET_NAIYO_2  AS MCD_SET_NAIYO_2                                                                                          " & vbNewLine _
                                             & " ,MCD.SET_NAIYO_3  AS MCD_SET_NAIYO_3                                                                                          " & vbNewLine _
                                             & ",KBN9.KBN_NM2 AS PC_KB_NM                                                                                                      " & vbNewLine _
                                             & ",EDIL.FREE_C01           AS TORI_KB                                                                                            " & vbNewLine _
                                             & ",OUTL.SHIP_CD_L          AS SHIP_CD_L                                                                                          " & vbNewLine _
                                             & ",MCD_N.SET_NAIYO         AS SET_NAIYO_4                                                                                        " & vbNewLine _
                                             & ",MCD_N.SET_NAIYO_2       AS SET_NAIYO_5                                                                                        " & vbNewLine _
                                             & ",MCD_N.SET_NAIYO_3       AS SET_NAIYO_6                                                                                        " & vbNewLine _
                                             & ",MG.GOODS_NM_2           AS GOODS_NM_2                                                                                         " & vbNewLine _
                                             & ",EDIM.FREE_C02           AS KICHO_KB                                                                                           " & vbNewLine _
                                             & ",EDIM.FREE_C03           AS SEI_YURAI_KB                                                                                       " & vbNewLine _
                                             & ",EDIM.FREE_C04           AS REMARK_UPPER      --群馬篠崎運送利用                                                               " & vbNewLine _
                                             & ",EDIM.FREE_C05           AS REMARK_LOWER                                                                                       " & vbNewLine _
                                             & ",EDIM.FREE_C06           AS GOODS_SYUBETU     --群馬篠崎運送利用                                                               " & vbNewLine _
                                             & ",CASE WHEN OUTL.NRS_BR_CD = '10' AND OUTL.CUST_CD_L = '00266' THEN OUTL.DENP_NO                                                " & vbNewLine _
                                             & "      ELSE EDIM.FREE_C01 END YUKOU_KIGEN                                                                                          " & vbNewLine _
                                             & ",MG.GOODS_NM_3           AS GOODS_NM_3         --2012/05/23                                                                    " & vbNewLine _
                                             & ",MDOUTU.EDI_CD           AS EDISHIP_CD         --2012/05/23                                                                    " & vbNewLine _
                                             & ",MDOUT.EDI_CD            AS EDIDEST_CD         --2012/05/23                                                                    " & vbNewLine _
                                             & "--日医工対策終了                                                                                                               " & vbNewLine _
                                             & ",MCD_F.SET_NAIYO         AS SET_NAIYO_FROM1                                                                                    " & vbNewLine _
                                             & ",MCD_F.SET_NAIYO_2       AS SET_NAIYO_FROM2                                                                                    " & vbNewLine _
                                             & ",MCD_F.SET_NAIYO_3       AS SET_NAIYO_FROM3                                                                                    " & vbNewLine _
                                             & ",MC.AD_3                 AS CUST_AD_3                                                                                          " & vbNewLine _
                                             & ",MDOUT.REMARK            AS DEST_REMARK                                                                                        " & vbNewLine _
                                             & ",MDOUT.SALES_CD          AS DEST_SALES_CD                                                                                      " & vbNewLine _
                                             & ",MC_SALES.CUST_NM_L      AS DEST_SALES_NM                                                                                      " & vbNewLine _
                                             & ",MC_SALES.AD_1           AS DEST_SALES_AD_1                                                                                    " & vbNewLine _
                                             & ",MC_SALES.AD_2           AS DEST_SALES_AD_2                                                                                    " & vbNewLine _
                                             & ",MC_SALES.AD_3           AS DEST_SALES_AD_3                                                                                    " & vbNewLine _
                                             & ",MC_SALES.TEL            AS DEST_SALES_TEL                                                                                     " & vbNewLine _
                                             & "--1ここから                                                                                                                    " & vbNewLine _
                                             & ",ISNULL((SELECT BASE.SAGYO_RYAK                                                                                                " & vbNewLine _
                                             & "FROM                                                                                                                           " & vbNewLine _
                                             & "(SELECT                                                                                                                        " & vbNewLine _
                                             & "M_SAGYO.SAGYO_RYAK AS SAGYO_RYAK                                                                                               " & vbNewLine _
                                             & ",ROW_NUMBER() OVER (PARTITION BY INOUTKA_NO_LM ORDER BY INOUTKA_NO_LM) AS NUM                                                  " & vbNewLine _
                                             & "FROM $LM_TRN$..E_SAGYO E                                                                                                       " & vbNewLine _
                                             & "       JOIN $LM_MST$..M_SAGYO M_SAGYO                                                                                          " & vbNewLine _
                                             & "         ON M_SAGYO.NRS_BR_CD = E.NRS_BR_CD                                                                                    " & vbNewLine _
                                             & "        AND M_SAGYO.SAGYO_CD  = E.SAGYO_CD                                                                                     " & vbNewLine _
                                             & "WHERE E.NRS_BR_CD = OUTL.NRS_BR_CD AND E.INOUTKA_NO_LM = (OUTM.OUTKA_NO_L + OUTM.OUTKA_NO_M) AND E.IOZS_KB = '21'              " & vbNewLine _
                                             & ") AS BASE                                                                                                                      " & vbNewLine _
                                             & "WHERE BASE.NUM = 1),'') AS SAGYO_RYAK_1                                                                                        " & vbNewLine _
                                             & "--1ここまで                                                                                                                    " & vbNewLine _
                                             & "--2ここから                                                                                                                    " & vbNewLine _
                                             & ",ISNULL((SELECT BASE.SAGYO_RYAK                                                                                                " & vbNewLine _
                                             & "FROM                                                                                                                           " & vbNewLine _
                                             & "(SELECT                                                                                                                        " & vbNewLine _
                                             & "M_SAGYO.SAGYO_RYAK AS SAGYO_RYAK                                                                                               " & vbNewLine _
                                             & ",ROW_NUMBER() OVER (PARTITION BY INOUTKA_NO_LM ORDER BY INOUTKA_NO_LM) AS NUM                                                  " & vbNewLine _
                                             & "FROM $LM_TRN$..E_SAGYO E                                                                                                       " & vbNewLine _
                                             & "       JOIN $LM_MST$..M_SAGYO M_SAGYO                                                                                          " & vbNewLine _
                                             & "         ON M_SAGYO.NRS_BR_CD = E.NRS_BR_CD                                                                                    " & vbNewLine _
                                             & "        AND M_SAGYO.SAGYO_CD  = E.SAGYO_CD                                                                                     " & vbNewLine _
                                             & "WHERE E.NRS_BR_CD = OUTL.NRS_BR_CD AND E.INOUTKA_NO_LM = (OUTM.OUTKA_NO_L + OUTM.OUTKA_NO_M) AND E.IOZS_KB = '21'              " & vbNewLine _
                                             & ") AS BASE                                                                                                                      " & vbNewLine _
                                             & "WHERE BASE.NUM = 2),'') AS SAGYO_RYAK_2                                                                                        " & vbNewLine _
                                             & "--2ここまで                                                                                                                    " & vbNewLine _
                                             & "--3ここから                                                                                                                    " & vbNewLine _
                                             & ",ISNULL((SELECT BASE.SAGYO_RYAK                                                                                                " & vbNewLine _
                                             & "FROM                                                                                                                           " & vbNewLine _
                                             & "(SELECT                                                                                                                        " & vbNewLine _
                                             & "M_SAGYO.SAGYO_RYAK AS SAGYO_RYAK                                                                                               " & vbNewLine _
                                             & ",ROW_NUMBER() OVER (PARTITION BY INOUTKA_NO_LM ORDER BY INOUTKA_NO_LM) AS NUM                                                  " & vbNewLine _
                                             & "FROM $LM_TRN$..E_SAGYO E                                                                                                       " & vbNewLine _
                                             & "       JOIN $LM_MST$..M_SAGYO M_SAGYO                                                                                          " & vbNewLine _
                                             & "         ON M_SAGYO.NRS_BR_CD = E.NRS_BR_CD                                                                                    " & vbNewLine _
                                             & "        AND M_SAGYO.SAGYO_CD  = E.SAGYO_CD                                                                                     " & vbNewLine _
                                             & "WHERE E.NRS_BR_CD = OUTL.NRS_BR_CD AND E.INOUTKA_NO_LM = (OUTM.OUTKA_NO_L + OUTM.OUTKA_NO_M) AND E.IOZS_KB = '21'              " & vbNewLine _
                                             & ") AS BASE                                                                                                                      " & vbNewLine _
                                             & "WHERE BASE.NUM = 3),'') AS SAGYO_RYAK_3                                                                                        " & vbNewLine _
                                             & "--3ここまで                                                                                                                    " & vbNewLine _
                                             & "--4ここから                                                                                                                    " & vbNewLine _
                                             & ",ISNULL((SELECT BASE.SAGYO_RYAK                                                                                                " & vbNewLine _
                                             & "FROM                                                                                                                           " & vbNewLine _
                                             & "(SELECT                                                                                                                        " & vbNewLine _
                                             & "M_SAGYO.SAGYO_RYAK AS SAGYO_RYAK                                                                                               " & vbNewLine _
                                             & ",ROW_NUMBER() OVER (PARTITION BY INOUTKA_NO_LM ORDER BY INOUTKA_NO_LM) AS NUM                                                  " & vbNewLine _
                                             & "FROM $LM_TRN$..E_SAGYO E                                                                                                       " & vbNewLine _
                                             & "       JOIN $LM_MST$..M_SAGYO M_SAGYO                                                                                          " & vbNewLine _
                                             & "         ON M_SAGYO.NRS_BR_CD = E.NRS_BR_CD                                                                                    " & vbNewLine _
                                             & "        AND M_SAGYO.SAGYO_CD  = E.SAGYO_CD                                                                                     " & vbNewLine _
                                             & "WHERE E.NRS_BR_CD = OUTL.NRS_BR_CD AND E.INOUTKA_NO_LM = (OUTM.OUTKA_NO_L + OUTM.OUTKA_NO_M) AND E.IOZS_KB = '21'              " & vbNewLine _
                                             & ") AS BASE                                                                                                                      " & vbNewLine _
                                             & "WHERE BASE.NUM = 4),'') AS SAGYO_RYAK_4                                                                                        " & vbNewLine _
                                             & "--4ここまで                                                                                                                    " & vbNewLine _
                                             & "--5ここから                                                                                                                    " & vbNewLine _
                                             & ",ISNULL((SELECT BASE.SAGYO_RYAK                                                                                                " & vbNewLine _
                                             & "FROM                                                                                                                           " & vbNewLine _
                                             & "(SELECT                                                                                                                        " & vbNewLine _
                                             & "M_SAGYO.SAGYO_RYAK AS SAGYO_RYAK                                                                                               " & vbNewLine _
                                             & ",ROW_NUMBER() OVER (PARTITION BY INOUTKA_NO_LM ORDER BY INOUTKA_NO_LM) AS NUM                                                  " & vbNewLine _
                                             & "FROM $LM_TRN$..E_SAGYO E                                                                                                       " & vbNewLine _
                                             & "       JOIN $LM_MST$..M_SAGYO M_SAGYO                                                                                          " & vbNewLine _
                                             & "         ON M_SAGYO.NRS_BR_CD = E.NRS_BR_CD                                                                                    " & vbNewLine _
                                             & "        AND M_SAGYO.SAGYO_CD  = E.SAGYO_CD                                                                                     " & vbNewLine _
                                             & "WHERE E.NRS_BR_CD = OUTL.NRS_BR_CD AND E.INOUTKA_NO_LM = (OUTM.OUTKA_NO_L + OUTM.OUTKA_NO_M) AND E.IOZS_KB = '21'              " & vbNewLine _
                                             & ") AS BASE                                                                                                                      " & vbNewLine _
                                             & "WHERE BASE.NUM = 5),'') AS SAGYO_RYAK_5                                                                                        " & vbNewLine _
                                             & "--5ここまで                                                                                                                    " & vbNewLine _
                                             & "--届け先1ここから                                                                                                              " & vbNewLine _
                                             & ",ISNULL((SELECT BASE.SAGYO_RYAK                                                                                                " & vbNewLine _
                                             & "FROM                                                                                                                           " & vbNewLine _
                                             & "(SELECT                                                                                                                        " & vbNewLine _
                                             & "M_SAGYO.SAGYO_RYAK AS SAGYO_RYAK                                                                                               " & vbNewLine _
                                             & ",ROW_NUMBER() OVER (PARTITION BY INOUTKA_NO_LM ORDER BY INOUTKA_NO_LM) AS NUM                                                  " & vbNewLine _
                                             & "FROM $LM_TRN$..E_SAGYO E                                                                                                       " & vbNewLine _
                                             & "       JOIN $LM_MST$..M_SAGYO M_SAGYO                                                                                          " & vbNewLine _
                                             & "         ON M_SAGYO.NRS_BR_CD = E.NRS_BR_CD                                                                                    " & vbNewLine _
                                             & "        AND M_SAGYO.SAGYO_CD  = E.SAGYO_CD                                                                                     " & vbNewLine _
                                             & "WHERE E.NRS_BR_CD = OUTL.NRS_BR_CD AND E.INOUTKA_NO_LM = (OUTM.OUTKA_NO_L + OUTM.OUTKA_NO_M) AND E.IOZS_KB = '21'              " & vbNewLine _
                                             & ") AS BASE                                                                                                                      " & vbNewLine _
                                             & "WHERE BASE.NUM = 6),'') AS DEST_SAGYO_RYAK_1                                                                                   " & vbNewLine _
                                             & "--届け先1ここまで                                                                                                              " & vbNewLine _
                                             & "--届け先2ここから                                                                                                              " & vbNewLine _
                                             & ",ISNULL((SELECT BASE.SAGYO_RYAK                                                                                                " & vbNewLine _
                                             & "FROM                                                                                                                           " & vbNewLine _
                                             & "(SELECT                                                                                                                        " & vbNewLine _
                                             & "M_SAGYO.SAGYO_RYAK AS SAGYO_RYAK                                                                                               " & vbNewLine _
                                             & ",ROW_NUMBER() OVER (PARTITION BY INOUTKA_NO_LM ORDER BY INOUTKA_NO_LM) AS NUM                                                  " & vbNewLine _
                                             & "FROM $LM_TRN$..E_SAGYO E                                                                                                       " & vbNewLine _
                                             & "       JOIN $LM_MST$..M_SAGYO M_SAGYO                                                                                          " & vbNewLine _
                                             & "         ON M_SAGYO.NRS_BR_CD = E.NRS_BR_CD                                                                                    " & vbNewLine _
                                             & "        AND M_SAGYO.SAGYO_CD  = E.SAGYO_CD                                                                                     " & vbNewLine _
                                             & "WHERE E.NRS_BR_CD = OUTL.NRS_BR_CD AND E.INOUTKA_NO_LM = (OUTM.OUTKA_NO_L + OUTM.OUTKA_NO_M) AND E.IOZS_KB = '21'              " & vbNewLine _
                                             & ") AS BASE                                                                                                                      " & vbNewLine _
                                             & "WHERE BASE.NUM = 7),'') AS DEST_SAGYO_RYAK_2                                                                                   " & vbNewLine _
                                             & "--届け先ここまで                                                                                                               " & vbNewLine _
                                             & ",EDIM.FREE_C07           AS SZ01_YUSO --篠崎                                                                                   " & vbNewLine _
                                             & ",EDIM.FREE_C09           AS SZ01_UNSO --篠崎                                                                                   " & vbNewLine _
                                             & "--群馬篠崎運送向け自由項目対応　終了                                                                                         　" & vbNewLine _
                                             & "      ,MGD.SET_NAIYO                      AS  SET_NAIYO                                                                        " & vbNewLine _
                                             & ",KBN10.KBN_NM1            AS SHOBO_KBN_NM                                                                                      " & vbNewLine _
                                             & ",MSHOBO.HINMEI            AS HINMEI                                                                                            " & vbNewLine _
                                             & ",MG.CUST_CD_M             AS CUST_CD_M                                                                                         " & vbNewLine _
                                             & ",MG.CUST_CD_S             AS CUST_CD_S                                                                                         " & vbNewLine _
                                             & ",MG.CUST_COST_CD2         AS CUST_COST_CD2                                                                                     " & vbNewLine _
                                             & "--出荷L                                                                                                                        " & vbNewLine _
                                             & "FROM                                                                                                                           " & vbNewLine _
                                             & "$LM_TRN$..C_OUTKA_L OUTL                                                                                                       " & vbNewLine _
                                             & "--トランザクションテーブル                                                                                                     " & vbNewLine _
                                             & "--出荷M                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..C_OUTKA_M OUTM                                                                                             " & vbNewLine _
                                             & "ON  OUTM.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "AND OUTM.OUTKA_NO_L = OUTL.OUTKA_NO_L                                                                                          " & vbNewLine _
                                             & "AND OUTM.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--出荷M(中MIN)                                                                                                                 " & vbNewLine _
                                             & "LEFT OUTER JOIN                                                                                                                " & vbNewLine _
                                             & "       (SELECT                                                                                                                 " & vbNewLine _
                                             & "           NRS_BR_CD                                                                                                           " & vbNewLine _
                                             & "           ,OUTKA_NO_L                                                                                                         " & vbNewLine _
                                             & "           ,MIN(OUTKA_NO_M) AS  OUTKA_NO_M                                                                                     " & vbNewLine _
                                             & "       FROM $LM_TRN$..C_OUTKA_M WHERE SYS_DEL_FLG ='0'                                                                         " & vbNewLine _
                                             & "        AND NRS_BR_CD = @NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "        AND OUTKA_NO_L = @KANRI_NO_L                                                                                           " & vbNewLine _
                                             & "       GROUP BY NRS_BR_CD,OUTKA_NO_L) OUTM_MIN                                                                                 " & vbNewLine _
                                             & "       ON OUTM_MIN.NRS_BR_CD        = OUTL.NRS_BR_CD                                                                           " & vbNewLine _
                                             & "       AND OUTM_MIN.OUTKA_NO_L      = OUTL.OUTKA_NO_L                                                                          " & vbNewLine _
                                             & "--出荷M(中MIN)                                                                                                                 " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..C_OUTKA_M OUTM2                                                                                            " & vbNewLine _
                                             & "ON  OUTM2.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                           " & vbNewLine _
                                             & "AND OUTM2.OUTKA_NO_L = OUTL.OUTKA_NO_L                                                                                         " & vbNewLine _
                                             & "AND OUTM2.OUTKA_NO_M = OUTM_MIN.OUTKA_NO_M                                                                                     " & vbNewLine _
                                             & "AND OUTM2.SYS_DEL_FLG = '0'                                                                                                    " & vbNewLine _
                                             & "--出荷S                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..C_OUTKA_S OUTS                                                                                             " & vbNewLine _
                                             & "ON  OUTS.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "AND OUTS.OUTKA_NO_L = OUTL.OUTKA_NO_L                                                                                          " & vbNewLine _
                                             & "AND OUTS.OUTKA_NO_M = OUTM.OUTKA_NO_M                                                                                          " & vbNewLine _
                                             & "AND OUTS.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & " LEFT JOIN (                                                                                                                   " & vbNewLine _
                                             & "            SELECT                                                                                                             " & vbNewLine _
                                             & "                   NRS_BR_CD                                                                                                   " & vbNewLine _
                                             & "                 , EDI_CTL_NO                                                                                                  " & vbNewLine _
                                             & "                 , OUTKA_CTL_NO                                                                                                " & vbNewLine _
                                             & "             FROM (                                                                                                            " & vbNewLine _
                                             & "                    SELECT                                                                                                     " & vbNewLine _
                                             & "                           EDIOUTL.NRS_BR_CD                                                                                   " & vbNewLine _
                                             & "                         , EDIOUTL.EDI_CTL_NO                                                                                  " & vbNewLine _
                                             & "                         , EDIOUTL.OUTKA_CTL_NO                                                                                " & vbNewLine _
                                             & "                         , CASE WHEN EDIOUTL.OUTKA_CTL_NO = '' THEN 1                                                          " & vbNewLine _
                                             & "                           ELSE ROW_NUMBER() OVER (PARTITION BY EDIOUTL.NRS_BR_CD                                              " & vbNewLine _
                                             & "                                                              , EDIOUTL.OUTKA_CTL_NO                                           " & vbNewLine _
                                             & "                                                       ORDER BY EDIOUTL.NRS_BR_CD                                              " & vbNewLine _
                                             & "                                                              , EDIOUTL.EDI_CTL_NO                                             " & vbNewLine _
                                             & "                                                  )                                                                            " & vbNewLine _
                                             & "                           END AS IDX                                                                                          " & vbNewLine _
                                             & "                     FROM $LM_TRN$..H_OUTKAEDI_L EDIOUTL                                                                       " & vbNewLine _
                                             & "                    WHERE EDIOUTL.SYS_DEL_FLG  = '0'                                                                           " & vbNewLine _
                                             & "                      AND EDIOUTL.NRS_BR_CD    = @NRS_BR_CD                                                                    " & vbNewLine _
                                             & "                      AND EDIOUTL.OUTKA_CTL_NO = @KANRI_NO_L                                                                   " & vbNewLine _
                                             & "                  ) EBASE                                                                                                      " & vbNewLine _
                                             & "            WHERE EBASE.IDX = 1                                                                                                " & vbNewLine _
                                             & "            ) TOPEDI                                                                                                           " & vbNewLine _
                                             & "        ON TOPEDI.NRS_BR_CD    = OUTL.NRS_BR_CD                                                                                " & vbNewLine _
                                             & "       AND TOPEDI.OUTKA_CTL_NO = OUTL.OUTKA_NO_L                                                                               " & vbNewLine _
                                             & " LEFT JOIN $LM_TRN$..H_OUTKAEDI_L EDIL                                                                                         " & vbNewLine _
                                             & "        ON EDIL.NRS_BR_CD  = TOPEDI.NRS_BR_CD                                                                                  " & vbNewLine _
                                             & "       AND EDIL.EDI_CTL_NO = TOPEDI.EDI_CTL_NO                                                                                 " & vbNewLine _
                                             & "--入荷L                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..B_INKA_L INL                                                                                               " & vbNewLine _
                                             & "ON  INL.NRS_BR_CD = OUTS.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "AND INL.INKA_NO_L = OUTS.INKA_NO_L                                                                                             " & vbNewLine _
                                             & "AND INL.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--入荷S                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..B_INKA_S INS                                                                                               " & vbNewLine _
                                             & "ON  INS.NRS_BR_CD = OUTS.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "AND INS.INKA_NO_L = OUTS.INKA_NO_L                                                                                             " & vbNewLine _
                                             & "AND INS.INKA_NO_M = OUTS.INKA_NO_M                                                                                             " & vbNewLine _
                                             & "AND INS.INKA_NO_S = OUTS.INKA_NO_S                                                                                             " & vbNewLine _
                                             & "AND INS.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--運送L                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..F_UNSO_L UL                                                                                                " & vbNewLine _
                                             & "ON  UL.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                              " & vbNewLine _
                                             & "AND UL.INOUTKA_NO_L = OUTL.OUTKA_NO_L                                                                                          " & vbNewLine _
                                             & "AND UL.MOTO_DATA_KB = '20'                                                                                                     " & vbNewLine _
                                             & "AND UL.SYS_DEL_FLG = '0'                                                                                                       " & vbNewLine _
                                             & "--在庫テーブル                                                                                                                 " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..D_ZAI_TRS ZAI                                                                                              " & vbNewLine _
                                             & "ON  ZAI.NRS_BR_CD = OUTS.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "AND ZAI.ZAI_REC_NO = OUTS.ZAI_REC_NO                                                                                           " & vbNewLine _
                                             & "AND ZAI.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--マスタテーブル                                                                                                               " & vbNewLine _
                                             & "--営業所M                                                                                                                      " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_NRS_BR MNRS                                                                                              " & vbNewLine _
                                             & "ON MNRS.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "--商品M                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_GOODS MG                                                                                                 " & vbNewLine _
                                             & "ON  MG.NRS_BR_CD = OUTM.NRS_BR_CD                                                                                              " & vbNewLine _
                                             & "AND MG.GOODS_CD_NRS = OUTM.GOODS_CD_NRS                                                                                        " & vbNewLine _
                                             & "--商品M(MIN)                                                                                                                   " & vbNewLine _
                                             & "LEFT OUTER JOIN $LM_MST$..M_GOODS M_GOODS_MIN                                                                                  " & vbNewLine _
                                             & "ON M_GOODS_MIN.NRS_BR_CD      = OUTL.NRS_BR_CD                                                                                 " & vbNewLine _
                                             & "AND M_GOODS_MIN.GOODS_CD_NRS   = OUTM2.GOODS_CD_NRS                                                                            " & vbNewLine _
                                             & "--荷主M(商品M経由)                                                                                                             " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST MC                                                                                                  " & vbNewLine _
                                             & "ON  MC.NRS_BR_CD = MG.NRS_BR_CD                                                                                                " & vbNewLine _
                                             & "AND MC.CUST_CD_L = MG.CUST_CD_L                                                                                                " & vbNewLine _
                                             & "AND MC.CUST_CD_M = MG.CUST_CD_M                                                                                                " & vbNewLine _
                                             & "AND MC.CUST_CD_S = MG.CUST_CD_S                                                                                                " & vbNewLine _
                                             & "AND MC.CUST_CD_SS = MG.CUST_CD_SS                                                                                              " & vbNewLine _
                                             & "--荷主M(商品M経由) 最小の出荷(中)で抽出                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST MC2                                                                                                 " & vbNewLine _
                                             & "ON  MC2.NRS_BR_CD = M_GOODS_MIN.NRS_BR_CD                                                                                      " & vbNewLine _
                                             & "AND MC2.CUST_CD_L = M_GOODS_MIN.CUST_CD_L                                                                                      " & vbNewLine _
                                             & "AND MC2.CUST_CD_M = M_GOODS_MIN.CUST_CD_M                                                                                      " & vbNewLine _
                                             & "AND MC2.CUST_CD_S = M_GOODS_MIN.CUST_CD_S                                                                                      " & vbNewLine _
                                             & "AND MC2.CUST_CD_SS = M_GOODS_MIN.CUST_CD_SS                                                                                    " & vbNewLine _
                                             & "AND MC2.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--届先M(届先取得)(出荷L参照)                                                                                                   " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_DEST MDOUT                                                                                               " & vbNewLine _
                                             & "ON  MDOUT.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                           " & vbNewLine _
                                             & "AND MDOUT.CUST_CD_L = OUTL.CUST_CD_L                                                                                           " & vbNewLine _
                                             & "AND MDOUT.DEST_CD = OUTL.DEST_CD                                                                                               " & vbNewLine _
                                             & "--届先M(売上先取得)(出荷L参照)                                                                                                 " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_DEST MDOUTU                                                                                              " & vbNewLine _
                                             & "ON  MDOUTU.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                          " & vbNewLine _
                                             & "AND MDOUTU.CUST_CD_L = OUTL.CUST_CD_L                                                                                          " & vbNewLine _
                                             & "AND MDOUTU.DEST_CD = OUTL.SHIP_CD_L                                                                                            " & vbNewLine _
                                             & "--届先M(届先取得)(出荷EDIL参照)                                                                                                " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_DEST MDEDI                                                                                               " & vbNewLine _
                                             & "ON  MDEDI.NRS_BR_CD = EDIL.NRS_BR_CD                                                                                           " & vbNewLine _
                                             & "AND MDEDI.CUST_CD_L = EDIL.CUST_CD_L                                                                                           " & vbNewLine _
                                             & "AND MDEDI.DEST_CD = EDIL.DEST_CD                                                                                               " & vbNewLine _
                                             & "--届先M(納品書荷主名義名取得)(届先M参照)                                                                                       " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST MC_SALES                                                                                            " & vbNewLine _
                                             & "       ON MC_SALES.NRS_BR_CD  = MDOUT.NRS_BR_CD                                                                                " & vbNewLine _
                                             & "      AND MC_SALES.CUST_CD_L  = MDOUT.SALES_CD                                                                                 " & vbNewLine _
                                             & "      AND MC_SALES.CUST_CD_M  = '00'                                                                                           " & vbNewLine _
                                             & "      AND MC_SALES.CUST_CD_S  = '00'                                                                                           " & vbNewLine _
                                             & "      AND MC_SALES.CUST_CD_SS = '00'                                                                                           " & vbNewLine _
                                             & "--運送会社M                                                                                                                    " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_UNSOCO MUCO                                                                                              " & vbNewLine _
                                             & "ON  MUCO.NRS_BR_CD = UL.NRS_BR_CD                                                                                              " & vbNewLine _
                                             & "AND MUCO.UNSOCO_CD = UL.UNSO_CD                                                                                                " & vbNewLine _
                                             & "AND MUCO.UNSOCO_BR_CD = UL.UNSO_BR_CD                                                                                          " & vbNewLine _
                                             & "--倉庫M                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_SOKO MSO                                                                                                 " & vbNewLine _
                                             & "ON  MSO.NRS_BR_CD = OUTL.NRS_BR_CD  --追加                                                                                     " & vbNewLine _
                                             & "AND MSO.WH_CD     = OUTL.WH_CD                                                                                                 " & vbNewLine _
                                             & "--2014/5/16Start s.kobayashi NotesNo.2183                                                                                      " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN11                                                                                                  " & vbNewLine _
                                             & "ON  KBN11.KBN_GROUP_CD = 'U028'  --追加                                                                                        " & vbNewLine _
                                             & "AND UL.SEIQ_TARIFF_CD = KBN11.KBN_NM1                                                                                          " & vbNewLine _
                                             & "--2014/5/16End s.kobayashi NotesNo.2183                                                                                       " & vbNewLine _
                                             & "--距離程M(M_DEST.JIS < M_SOKO.JIS_CD)(出荷L参照)                                                                               " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_KYORI MKY1                                                                                               " & vbNewLine _
                                             & "ON  MKY1.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "--AND MKY1.KYORI_CD = MC.BETU_KYORI_CD                                                                                           " & vbNewLine _
                                             & "AND MKY1.KYORI_CD = (CASE ISNULL(KBN11.KBN_NM2,'') WHEN '' THEN MC.BETU_KYORI_CD ELSE KBN11.KBN_NM2 END)                       " & vbNewLine _
                                             & "AND MKY1.ORIG_JIS_CD = MDOUT.JIS                                                                                               " & vbNewLine _
                                             & "AND MKY1.DEST_JIS_CD = MSO.JIS_CD                                                                                              " & vbNewLine _
                                             & "--距離程M(M_SOKO.JIS_CD < M_DEST.JIS)(出荷L参照)                                                                               " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_KYORI MKY2                                                                                               " & vbNewLine _
                                             & "ON  MKY2.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "--AND MKY2.KYORI_CD = MC.BETU_KYORI_CD                                                                                           " & vbNewLine _
                                             & "AND MKY2.KYORI_CD = (CASE ISNULL(KBN11.KBN_NM2,'') WHEN '' THEN MC.BETU_KYORI_CD ELSE KBN11.KBN_NM2 END)                       " & vbNewLine _
                                             & "AND MKY2.ORIG_JIS_CD = MSO.JIS_CD                                                                                              " & vbNewLine _
                                             & "AND MKY2.DEST_JIS_CD = MDOUT.JIS                                                                                               " & vbNewLine _
                                             & "--距離程M(H_OUTKAEDI_L.DEST_JIS_CD < M_SOKO.JIS_CD)(出荷EDIL参照)                                                              " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_KYORI MKY3                                                                                               " & vbNewLine _
                                             & "ON  MKY3.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "--AND MKY3.KYORI_CD = MC.BETU_KYORI_CD                                                                                           " & vbNewLine _
                                             & "AND MKY3.KYORI_CD = (CASE ISNULL(KBN11.KBN_NM2,'') WHEN '' THEN MC.BETU_KYORI_CD ELSE KBN11.KBN_NM2 END)                       " & vbNewLine _
                                             & "AND MKY3.ORIG_JIS_CD = EDIL.DEST_JIS_CD                                                                                        " & vbNewLine _
                                             & "AND MKY3.DEST_JIS_CD = MSO.JIS_CD                                                                                              " & vbNewLine _
                                             & "--距離程M(M_SOKO.JIS_CD < H_OUTKAEDI_L.DEST_JIS_CD)(出荷EDIL参照)                                                              " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_KYORI MKY4                                                                                               " & vbNewLine _
                                             & "ON  MKY4.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "--AND MKY4.KYORI_CD = MC.BETU_KYORI_CD                                                                                           " & vbNewLine _
                                             & "AND MKY4.KYORI_CD = (CASE ISNULL(KBN11.KBN_NM2,'') WHEN '' THEN MC.BETU_KYORI_CD ELSE KBN11.KBN_NM2 END)                       " & vbNewLine _
                                             & "AND MKY4.ORIG_JIS_CD = MSO.JIS_CD                                                                                              " & vbNewLine _
                                             & "AND MKY4.DEST_JIS_CD = EDIL.DEST_JIS_CD                                                                                        " & vbNewLine _
                                             & "--届先商品M(出荷L参照)                                                                                                         " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_DESTGOODS MDGL                                                                                           " & vbNewLine _
                                             & "ON  MDGL.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "AND MDGL.CUST_CD_L = OUTL.CUST_CD_L                                                                                            " & vbNewLine _
                                             & "AND MDGL.CUST_CD_M = OUTL.CUST_CD_M                                                                                            " & vbNewLine _
                                             & "AND MDGL.CD = OUTL.DEST_CD                                                                                                     " & vbNewLine _
                                             & "AND MDGL.GOODS_CD_NRS = MG.GOODS_CD_NRS                                                                                        " & vbNewLine _
                                             & "AND MDGL.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--届先商品M(出荷EDI参照)                                                                                                       " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_DESTGOODS MDGE                                                                                           " & vbNewLine _
                                             & "ON  MDGE.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "AND MDGE.CUST_CD_L = OUTL.CUST_CD_L                                                                                            " & vbNewLine _
                                             & "AND MDGE.CUST_CD_M = OUTL.CUST_CD_M                                                                                            " & vbNewLine _
                                             & "AND MDGE.CD = EDIL.DEST_CD                                                                                                     " & vbNewLine _
                                             & "AND MDGE.GOODS_CD_NRS = MG.GOODS_CD_NRS                                                                                        " & vbNewLine _
                                             & "AND MDGE.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--消防M★                                                                                                      " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_SHOBO MSHOBO                                                                                           " & vbNewLine _
                                             & "ON  MSHOBO.SHOBO_CD = MG.SHOBO_CD                                                                                            " & vbNewLine _
                                             & "AND MSHOBO.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--区分M(納入予定区分)                                                                                                          " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN1                                                                                                 " & vbNewLine _
                                             & "ON  KBN1.KBN_GROUP_CD = 'N010'                                                                                                 " & vbNewLine _
                                             & "AND KBN1.KBN_CD = OUTL.ARR_PLAN_TIME                                                                                           " & vbNewLine _
                                             & "AND KBN1.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--区分M(日本合成用倉庫名)                                                                                                      " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN2                                                                                                 " & vbNewLine _
                                             & "ON  KBN2.KBN_GROUP_CD = 'P005'                                                                                                 " & vbNewLine _
                                             & "AND KBN2.KBN_CD = '00'                                                                                                         " & vbNewLine _
                                             & "AND KBN2.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--区分M(日本合成用部署名)                                                                                                      " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN3                                                                                                 " & vbNewLine _
                                             & "ON  KBN3.KBN_GROUP_CD = 'P005'                                                                                                 " & vbNewLine _
                                             & "AND KBN3.KBN_CD = '01'                                                                                                         " & vbNewLine _
                                             & "AND KBN3.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--区分M(日本合成用営業署名)                                                                                                    " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN4                                                                                                 " & vbNewLine _
                                             & "ON  KBN4.KBN_GROUP_CD = 'P005'                                                                                                 " & vbNewLine _
                                             & "AND KBN4.KBN_CD = '02'                                                                                                         " & vbNewLine _
                                             & "AND KBN4.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--区分M(荷姿)                                                                                                                  " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN5                                                                                                 " & vbNewLine _
                                             & "ON  KBN5.KBN_GROUP_CD = 'N001'                                                                                                 " & vbNewLine _
                                             & "AND KBN5.KBN_CD = MG.PKG_UT                                                                                                    " & vbNewLine _
                                             & "AND KBN5.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--明細タイトル（小分け）                                                                                                       " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN6                                                                                                 " & vbNewLine _
                                             & "ON  KBN6.KBN_GROUP_CD = 'S041'                                                                                                 " & vbNewLine _
                                             & "AND KBN6.KBN_CD = OUTM.ALCTD_KB                                                                                                " & vbNewLine _
                                             & "AND KBN6.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--区分M(毒劇区分名称)                                                                                                           " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN7                                                                                                  " & vbNewLine _
                                             & "ON  KBN7.KBN_GROUP_CD = 'G001'                                                                                                  " & vbNewLine _
                                             & "AND KBN7.KBN_CD = MG.DOKU_KB                                                                                                    " & vbNewLine _
                                             & "AND KBN7.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--区分M(元着払区分名称)                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN9                                                                                                 " & vbNewLine _
                                             & "ON  KBN9.KBN_GROUP_CD = 'M001'                                                                                                 " & vbNewLine _
                                             & "AND KBN9.KBN_CD = OUTL.PC_KB                                                                                                   " & vbNewLine _
                                             & "AND KBN9.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--区分M(消防区分名称)★                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN10                                                                                                " & vbNewLine _
                                             & "ON  KBN10.KBN_GROUP_CD = 'S004'                                                                                                " & vbNewLine _
                                             & "AND KBN10.KBN_CD = MSHOBO.RUI                                                                                                  " & vbNewLine _
                                             & "AND KBN10.SYS_DEL_FLG = '0'                                                                                                    " & vbNewLine _
                                             & "--★出荷EDI M(日医工)                                                                                                          " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..H_OUTKAEDI_M EDIM                                                                                            " & vbNewLine _
                                             & "ON  EDIM.NRS_BR_CD        = OUTM.NRS_BR_CD                                                                                     " & vbNewLine _
                                             & "AND EDIM.OUTKA_CTL_NO     = OUTM.OUTKA_NO_L                                                                                    " & vbNewLine _
                                             & "AND EDIM.OUTKA_CTL_NO_CHU = OUTM.OUTKA_NO_M                                                                                    " & vbNewLine _
                                             & "AND EDIM.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--荷主明細M ★                                                                                                                 " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST_DETAILS MCD_N                                                                                       " & vbNewLine _
                                             & "ON  MCD_N.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                           " & vbNewLine _
                                             & "AND MCD_N.CUST_CD   = OUTL.CUST_CD_L                                                                                           " & vbNewLine _
                                             & "AND MCD_N.SUB_KB = '26'                                                                                                        " & vbNewLine _
                                             & "--荷主明細M                                                                                                                    " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST_DETAILS MCD_F                                                                                       " & vbNewLine _
                                             & "ON  MCD_F.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                           " & vbNewLine _
                                             & "AND MCD_F.CUST_CD   = OUTL.CUST_CD_L                                                                                           " & vbNewLine _
                                             & "AND MCD_F.SUB_KB = '29'                                                                                                        " & vbNewLine _
                                             & "--荷主明細M ★                                                                                                                 " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST_DETAILS MCD                                                                                         " & vbNewLine _
                                             & "ON  MCD.NRS_BR_CD = MG.NRS_BR_CD                                                                                               " & vbNewLine _
                                             & "AND MCD.CUST_CD   = MG.CUST_CD_L                                                                                               " & vbNewLine _
                                             & "AND MCD.SUB_KB = '20'                                                                                                          " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_GOODS_DETAILS MGD16                                                                                        " & vbNewLine _
                                             & "       ON MGD16.NRS_BR_CD = MG.NRS_BR_CD                                                                                       " & vbNewLine _
                                             & "      AND MGD16.GOODS_CD_NRS = MG.GOODS_CD_NRS                                                                                 " & vbNewLine _
                                             & "      AND MGD16.SUB_KB = '16'                                                                                                  " & vbNewLine _
                                             & "      AND MGD16.SYS_DEL_FLG = '0'                                                                                              " & vbNewLine _
                                             & "--出荷Lでの荷主帳票パターン取得                                                                                                " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST_RPT MCR1                                                                                            " & vbNewLine _
                                             & "ON  OUTL.NRS_BR_CD = MCR1.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "AND OUTL.CUST_CD_L = MCR1.CUST_CD_L                                                                                            " & vbNewLine _
                                             & "AND OUTL.CUST_CD_M = MCR1.CUST_CD_M                                                                                            " & vbNewLine _
                                             & "AND '00' = MCR1.CUST_CD_S                                                                                                      " & vbNewLine _
                                             & "AND MCR1.PTN_ID = '04'                                                                                                         " & vbNewLine _
                                             & "--帳票パターン取得                                                                                                             " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_RPT MR1                                                                                                  " & vbNewLine _
                                             & "ON  MR1.NRS_BR_CD = MCR1.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "AND MR1.PTN_ID = MCR1.PTN_ID                                                                                                   " & vbNewLine _
                                             & "AND MR1.PTN_CD = MCR1.PTN_CD                                                                                                   " & vbNewLine _
                                             & "AND MR1.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--商品Mの荷主での荷主帳票パターン取得                                                                                          " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST_RPT MCR2                                                                                            " & vbNewLine _
                                             & "ON  MG.NRS_BR_CD = MCR2.NRS_BR_CD                                                                                              " & vbNewLine _
                                             & "AND MG.CUST_CD_L = MCR2.CUST_CD_L                                                                                              " & vbNewLine _
                                             & "AND MG.CUST_CD_M = MCR2.CUST_CD_M                                                                                              " & vbNewLine _
                                             & "AND MG.CUST_CD_S = MCR2.CUST_CD_S                                                                                              " & vbNewLine _
                                             & "AND MCR2.PTN_ID = '04'                                                                                                         " & vbNewLine _
                                             & "--帳票パターン取得                                                                                                             " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_RPT MR2                                                                                                  " & vbNewLine _
                                             & "ON  MR2.NRS_BR_CD = MCR2.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "AND MR2.PTN_ID = MCR2.PTN_ID                                                                                                   " & vbNewLine _
                                             & "AND MR2.PTN_CD = MCR2.PTN_CD                                                                                                   " & vbNewLine _
                                             & "AND MR2.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--存在しない場合の帳票パターン取得                                                                                             " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_RPT MR3                                                                                                  " & vbNewLine _
                                             & "ON  MR3.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "AND MR3.PTN_ID = '04'                                                                                                          " & vbNewLine _
                                             & "AND MR3.STANDARD_FLAG = '01'                                                                                                   " & vbNewLine _
                                             & "AND MR3.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--ユーザM                                                                                                                      " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..S_USER MUSER                                                                                               " & vbNewLine _
                                             & "ON MUSER.USER_CD = OUTL.SYS_ENT_USER                                                                                           " & vbNewLine _
                                             & "AND MUSER.SYS_DEL_FLG = '0'                                                                                                    " & vbNewLine _
                                             & "--商品明細M                                                                                                                    " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_GOODS_DETAILS MGD                                                                                        " & vbNewLine _
                                             & "ON  MGD.NRS_BR_CD = MG.NRS_BR_CD                                                                                               " & vbNewLine _
                                             & "AND MGD.GOODS_CD_NRS = MG.GOODS_CD_NRS                                                                                         " & vbNewLine _
                                             & "AND MGD.SUB_KB = '09'                                                                                                          " & vbNewLine _
                                             & "AND MGD.SYS_DEL_FLG = '0'       --ADD 2019/02/07 依頼番号 : 004605   【LMS】納品書がの梱包個数が2倍になるバグ修正              " & vbNewLine _
                                             & "WHERE                                                                                                                          " & vbNewLine _
                                             & "    OUTL.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "AND OUTL.NRS_BR_CD = @NRS_BR_CD                                                                                                " & vbNewLine _
                                             & "AND OUTL.OUTKA_NO_L = @KANRI_NO_L                                                                                              " & vbNewLine
    '(2014.06.10) 追加END

    ''' <summary>
    ''' 印刷データ抽出用(出荷テーブル)
    ''' </summary>
    ''' <remarks></remarks>
    Friend Const SQL_SELECT_OUTKA_TEFLON As String = "--★★★SQL_SELECT_OUTKA_TEFLON★★★  出荷テーブル                                                                                                                 " & vbNewLine _
                                             & "SELECT                                                                                                                         " & vbNewLine _
                                             & " CASE WHEN MR2.PTN_CD IS NOT NULL THEN MR2.RPT_ID                                                                              " & vbNewLine _
                                             & "      WHEN MR1.PTN_CD IS NOT NULL THEN MR1.RPT_ID                                                                              " & vbNewLine _
                                             & "      ELSE MR3.RPT_ID                                                                                                          " & vbNewLine _
                                             & " END              AS RPT_ID                                                                                                    " & vbNewLine _
                                             & ",OUTL.NRS_BR_CD   AS NRS_BR_CD                                                                                                 " & vbNewLine _
                                             & ",OUTM.PRINT_SORT  AS PRINT_SORT                                                                                                " & vbNewLine _
                                             & ",CASE WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_CD                                                                     " & vbNewLine _
                                             & "      ELSE OUTL.DEST_CD                                                                                                        " & vbNewLine _
                                             & " END              AS DEST_CD                                                                                                   " & vbNewLine _
                                             & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_NM                                                                               " & vbNewLine _
                                             & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_NM                                                                     " & vbNewLine _
                                             & "      ELSE MDOUT.DEST_NM                                                                                                       " & vbNewLine _
                                             & " END              AS DEST_NM                                                                                                   " & vbNewLine _
                                             & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_AD_1                                                                             " & vbNewLine _
                                             & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_AD_1                                                                   " & vbNewLine _
                                             & "      ELSE MDOUT.AD_1                                                                                                          " & vbNewLine _
                                             & " END              AS DEST_AD_1                                                                                                 " & vbNewLine _
                                             & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_AD_2                                                                             " & vbNewLine _
                                             & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_AD_2                                                                   " & vbNewLine _
                                             & "      ELSE MDOUT.AD_2                                                                                                          " & vbNewLine _
                                             & " END              AS DEST_AD_2                                                                                                 " & vbNewLine _
                                             & ",OUTL.DEST_AD_3   AS DEST_AD_3                                                                                                 " & vbNewLine _
                                             & ",OUTL.DEST_TEL    AS DEST_TEL                                                                                                  " & vbNewLine _
                                             & ",OUTL.OUTKA_PLAN_DATE   AS OUTKA_PLAN_DATE                                                                                     " & vbNewLine _
                                             & ",OUTL.CUST_ORD_NO       AS CUST_ORD_NO                                                                                         " & vbNewLine _
                                             & ",OUTL.BUYER_ORD_NO      AS BUYER_ORD_NO                                                                                        " & vbNewLine _
                                             & ",MUCO.UNSOCO_NM         AS UNSOCO_NM                                                                                           " & vbNewLine _
                                             & ",OUTL.ARR_PLAN_DATE     AS ARR_PLAN_DATE                                                                                       " & vbNewLine _
                                             & ",KBN1.KBN_NM1           AS ARR_PLAN_TIME                                                                                       " & vbNewLine _
                                             & ",OUTL.OUTKA_NO_L        AS OUTKA_NO_L                                                                                          " & vbNewLine _
                                             & ",MDOUTU.DEST_NM         AS URIG_NM                                                                                             " & vbNewLine _
                                             & ",MC.CUST_NM_L           AS CUST_NM_L                                                                                           " & vbNewLine _
                                             & "--(2012.06.15) 要望番号1155 -- START --                                                                                        " & vbNewLine _
                                             & ",MC.CUST_NM_M           AS CUST_NM_M                                                                                           " & vbNewLine _
                                             & "--(2012.06.15) 要望番号1155 --  END  --                                                                                        " & vbNewLine _
                                             & ",MC.AD_1                AS CUST_AD_1                                                                                           " & vbNewLine _
                                             & ",MC.AD_2                AS CUST_AD_2                                                                                           " & vbNewLine _
                                             & ",MC.TEL                 AS CUST_TEL                                                                                            " & vbNewLine _
                                             & ",MC.DENPYO_NM           AS DENPYO_NM                                                                                            " & vbNewLine _
                                             & ",MNRS.NRS_BR_NM         AS NRS_BR_NM                                                                                           " & vbNewLine _
                                             & ",CASE WHEN MSO.WH_KB = '01' THEN MSO.AD_1                                                                             " & vbNewLine _
                                             & "      ELSE MNRS.AD_1                                                                                                          " & vbNewLine _
                                             & " END              AS NRS_BR_AD1                                                                                                 " & vbNewLine _
                                             & ",CASE WHEN MSO.WH_KB = '01' THEN MSO.AD_2                                                                             " & vbNewLine _
                                             & "      ELSE MNRS.AD_2                                                                                                          " & vbNewLine _
                                             & " END              AS NRS_BR_AD2                                                                                                 " & vbNewLine _
                                             & ",CASE WHEN MSO.WH_KB = '01' THEN MSO.TEL                                                                             " & vbNewLine _
                                             & "      ELSE MNRS.TEL                                                                                                          " & vbNewLine _
                                             & " END              AS NRS_BR_TEL                                                                                                 " & vbNewLine _
                                             & ",CASE WHEN MSO.WH_KB = '01' THEN MSO.FAX                                                                             " & vbNewLine _
                                             & "      ELSE MNRS.FAX                                                                                                          " & vbNewLine _
                                             & " END              AS NRS_BR_FAX                                                                                                 " & vbNewLine _
                                             & ",MUSER.USER_NM          AS PIC                                                                                                 " & vbNewLine _
                                             & ",OUTM.OUTKA_NO_M        AS OUTKA_NO_M                                                                                          " & vbNewLine _
                                             & ",OUTS.OUTKA_NO_S        AS OUTKA_NO_S                                                                                          " & vbNewLine _
                                             & ",CASE WHEN MGD.SET_NAIYO = '1' THEN ''                                                                                         " & vbNewLine _
                                             & "      WHEN INL.INKA_STATE_KB < '50' THEN INL.INKA_DATE                                                                         " & vbNewLine _
                                             & "      WHEN INL.INKA_STATE_KB >= '50' THEN ZAI.INKO_DATE                                                                        " & vbNewLine _
                                             & "      ELSE ''                                                                                                                  " & vbNewLine _
                                             & " END                    AS INKA_DATE                                                                                           " & vbNewLine _
                                             & ",ZAI.REMARK_OUT         AS REMARK_OUT                                                                                          " & vbNewLine _
                                             & ",CASE WHEN (MDGE.GOODS_NM IS NOT NULL AND MDGE.GOODS_NM <> '' AND EDIL.OUTKA_CTL_NO IS NOT NULL) THEN MDGE.GOODS_NM            " & vbNewLine _
                                             & "      WHEN (MDGL.GOODS_NM IS NOT NULL AND MDGL.GOODS_NM <> '' AND EDIL.OUTKA_CTL_NO IS NULL) THEN MDGL.GOODS_NM                " & vbNewLine _
                                             & "      ELSE MG.GOODS_NM_1                                                                                                       " & vbNewLine _
                                             & " END                    AS GOODS_NM_1                                                                                          " & vbNewLine _
                                             & ",OUTS.LOT_NO            AS LOT_NO                                                                                              " & vbNewLine _
                                             & ",OUTS.SERIAL_NO         AS SERIAL_NO                                                                                           " & vbNewLine _
                                             & ",OUTS.IRIME             AS IRIME                                                                                               " & vbNewLine _
                                             & ",MG.PKG_NB              AS PKG_NB                                                                                              " & vbNewLine _
                                             & ",OUTS.ALCTD_NB / MG.PKG_NB     AS KONSU                                                                                        " & vbNewLine _
                                             & ",OUTS.ALCTD_NB % MG.PKG_NB     AS HASU                                                                                         " & vbNewLine _
                                             & ",OUTS.ALCTD_NB          AS ALCTD_NB                                                                                            " & vbNewLine _
                                             & ",MG.PKG_UT              AS PKG_UT                                                                                              " & vbNewLine _
                                             & ",KBN5.KBN_NM1           AS PKG_UT_NM                                                                                           " & vbNewLine _
                                             & ",OUTS.ALCTD_QT          AS ALCTD_QT                                                                                            " & vbNewLine _
                                             & ",MG.STD_IRIME_UT        AS IRIME_UT                                                                                            " & vbNewLine _
                                             & "--(2012.10.01)要望番号1445 -- START --                                                                                         " & vbNewLine _
                                             & ",UL.UNSO_WT             AS WT                                                                                                  " & vbNewLine _
                                             & "--,OUTS.BETU_WT * OUTS.ALCTD_NB  AS WT                                                                                         " & vbNewLine _
                                             & "--(2012.10.01)要望番号1445 --  END  --                                                                                         " & vbNewLine _
                                             & ",0                      AS UNSO_WT                                                                                             " & vbNewLine _
                                             & ",OUTS.TOU_NO            AS TOU_NO                                                                                              " & vbNewLine _
                                             & ",OUTS.SITU_NO           AS SITU_NO                                                                                             " & vbNewLine _
                                             & ",RTRIM(OUTS.ZONE_CD)     AS ZONE_CD                                                                                             " & vbNewLine _
                                             & ",OUTS.LOCA              AS LOCA                                                                                                " & vbNewLine _
                                             & ",OUTS.ALCTD_CAN_NB / MG.PKG_NB   AS ZAN_KONSU                                                                                  " & vbNewLine _
                                             & ",OUTS.ALCTD_CAN_NB % MG.PKG_NB   AS ZAN_HASU                                                                                   " & vbNewLine _
                                             & ",MG.GOODS_CD_CUST       AS GOODS_CD_CUST                                                                                       " & vbNewLine _
                                             & ",OUTM.REMARK            AS REMARK_M                                                                                            " & vbNewLine _
                                             & "--★★★変更開始--------------------------------                                                                                     " & vbNewLine _
                                             & ",''   AS CUST_NM_S                                                                                           " & vbNewLine _
                                             & ",''   AS CUST_NM_S_H                                                                                           " & vbNewLine _
                                             & "--★★★変更終了--------------------------------                                                                                     " & vbNewLine _
                                             & ",OUTM.CUST_ORD_NO_DTL   AS CUST_ORD_NO_DTL                                                                                     " & vbNewLine _
                                             & ",OUTL.REMARK            AS OUTKA_REMARK                                                                                        " & vbNewLine _
                                             & ",UL.REMARK              AS HAISOU_REMARK                                                                                       " & vbNewLine _
                                             & ",OUTL.NHS_REMARK        AS NHS_REMARK                                                                                          " & vbNewLine _
                                             & "--(2012.08.06) 発JIS、着JISが共に同じJISでも、必ず0㎞になるのを修正  --- START ---                                             " & vbNewLine _
                                             & "--,CASE WHEN (OUTL.DEST_KB = '02' AND MDEDI.KYORI > 0) THEN MDEDI.KYORI                                                        " & vbNewLine _
                                             & "--      WHEN (OUTL.DEST_KB = '02' AND MDEDI.KYORI = 0 AND EDIL.DEST_JIS_CD < MSO.JIS_CD) THEN MKY3.KYORI                       " & vbNewLine _
                                             & "--      WHEN (OUTL.DEST_KB = '02' AND MDEDI.KYORI = 0 AND MSO.JIS_CD < EDIL.DEST_JIS_CD) THEN MKY4.KYORI                       " & vbNewLine _
                                             & "--      WHEN (OUTL.DEST_KB <> '02' AND MDOUT.KYORI > 0) THEN MDOUT.KYORI                                                       " & vbNewLine _
                                             & "--      WHEN (OUTL.DEST_KB <> '02' AND MDOUT.KYORI = 0 AND MDOUT.JIS < MSO.JIS_CD) THEN MKY1.KYORI                             " & vbNewLine _
                                             & "--      WHEN (OUTL.DEST_KB <> '02' AND MDOUT.KYORI = 0 AND MSO.JIS_CD < MDOUT.JIS) THEN MKY2.KYORI                             " & vbNewLine _
                                             & "--      ELSE 0                                                                                                                 " & vbNewLine _
                                             & "-- END                  AS KYORI                                                                                               " & vbNewLine _
                                             & ",CASE WHEN (OUTL.DEST_KB = '02' AND MDEDI.KYORI > 0) THEN MDEDI.KYORI                                                          " & vbNewLine _
                                             & "      WHEN (OUTL.DEST_KB = '02' AND MDEDI.KYORI = 0 AND EDIL.DEST_JIS_CD <= MSO.JIS_CD) THEN MKY3.KYORI                        " & vbNewLine _
                                             & "      WHEN (OUTL.DEST_KB = '02' AND MDEDI.KYORI = 0 AND MSO.JIS_CD <= EDIL.DEST_JIS_CD) THEN MKY4.KYORI                        " & vbNewLine _
                                             & "      WHEN (OUTL.DEST_KB <> '02' AND MDOUT.KYORI > 0) THEN MDOUT.KYORI                                                         " & vbNewLine _
                                             & "      WHEN (OUTL.DEST_KB <> '02' AND MDOUT.KYORI = 0 AND MDOUT.JIS <= MSO.JIS_CD) THEN MKY1.KYORI                              " & vbNewLine _
                                             & "      WHEN (OUTL.DEST_KB <> '02' AND MDOUT.KYORI = 0 AND MSO.JIS_CD <= MDOUT.JIS) THEN MKY2.KYORI                              " & vbNewLine _
                                             & "      ELSE 0                                                                                                                   " & vbNewLine _
                                             & " END                    AS KYORI                                                                                               " & vbNewLine _
                                             & "--(2012.08.06) 発JIS、着JISが共に同じJISでも、必ず0㎞になるのを修正  ---  END  ---                                             " & vbNewLine _
                                             & ",OUTL.OUTKA_PKG_NB      AS OUTKA_PKG_NB_L                                                                                      " & vbNewLine _
                                             & ",KBN2.KBN_NM1           AS SOKO_NM                                                                                             " & vbNewLine _
                                             & ",KBN3.KBN_NM1           AS BUSHO_NM                                                                                            " & vbNewLine _
                                             & ",KBN4.KBN_NM1           AS NRS_BR_NM_NICHI                                                                                     " & vbNewLine _
                                             & ",OUTS.ALCTD_CAN_QT      AS ALCTD_CAN_QT                                                                                        " & vbNewLine _
                                             & ",OUTM.ALCTD_KB          AS ALCTD_KB                                                                                            " & vbNewLine _
                                             & ",'0'                    AS PTN_FLAG                                                                                            " & vbNewLine _
                                             & ",OUTL.CUST_CD_L         AS CUST_CD_L                                                                                           " & vbNewLine _
                                             & ",OUTL.ORDER_TYPE        AS ORDER_TYPE                                                                                          " & vbNewLine _
                                             & ",ZAI.LT_DATE                                                                                                                   " & vbNewLine _
                                             & ",OUTM.BUYER_ORD_NO_DTL AS BUYER_ORD_NO_DTL                                                                                     " & vbNewLine _
                                             & ",ZAI.GOODS_COND_KB_2 AS GOODS_COND_CD                                                                                          " & vbNewLine _
                                             & ",ZAI.REMARK AS REMARK_ZAI                                                                                                      " & vbNewLine _
                                             & ",KBN6.KBN_NM2 AS TITLE_SMPL                                                                                                    " & vbNewLine _
                                             & ",OUTS.ALCTD_CAN_NB AS ALCTD_CAN_NB                                                                                             " & vbNewLine _
                                             & ",OUTM.BACKLOG_QT                                                                                                               " & vbNewLine _
                                             & ",KBN7.KBN_NM2 AS DOKU_NM                                                                                                       " & vbNewLine _
                                             & "--【要望番号995】　2012/04/17　元着払い区分　START                                                                             " & vbNewLine _
                                             & ",KBN9.KBN_NM2 AS PC_KB_NM                                                                                                      " & vbNewLine _
                                             & "--【要望番号995】　2012/04/17　元着払い区分　 END                                                                              " & vbNewLine _
                                             & "--日医工対策開始                                                                                                               " & vbNewLine _
                                             & ",EDIL.FREE_C01           AS TORI_KB                                                                                            " & vbNewLine _
                                             & "--★追加開始2012/05/11                                                                                                         " & vbNewLine _
                                             & ",OUTL.SHIP_CD_L          AS SHIP_CD_L                                                                                          " & vbNewLine _
                                             & "--★追加終了2012/05/11                                                                                                         " & vbNewLine _
                                             & "--★削除開始2012/05/11                                                                                                         " & vbNewLine _
                                             & "--,EDIL.SHIP_NM_L          AS CHOKUSO_NM1                                                                                      " & vbNewLine _
                                             & "--,EDIL.FREE_C11           AS CHOKUSO_CD                                                                                       " & vbNewLine _
                                             & "--,EDIL.FREE_C08           AS HAKKO_DATE                                                                                       " & vbNewLine _
                                             & "--★削除終了2012/05/11                                                                                                         " & vbNewLine _
                                             & ",MCD_N.SET_NAIYO         AS SET_NAIYO_4                                                                                        " & vbNewLine _
                                             & ",MCD_N.SET_NAIYO_2       AS SET_NAIYO_5                                                                                        " & vbNewLine _
                                             & ",MCD_N.SET_NAIYO_3       AS SET_NAIYO_6                                                                                        " & vbNewLine _
                                             & ",MG.GOODS_NM_2           AS GOODS_NM_2                                                                                         " & vbNewLine _
                                             & ",EDIM.FREE_C02           AS KICHO_KB                                                                                           " & vbNewLine _
                                             & ",EDIM.FREE_C03           AS SEI_YURAI_KB                                                                                       " & vbNewLine _
                                             & ",EDIM.FREE_C04           AS REMARK_UPPER      --群馬篠崎運送利用                                                               " & vbNewLine _
                                             & ",EDIM.FREE_C05           AS REMARK_LOWER                                                                                       " & vbNewLine _
                                             & ",EDIM.FREE_C06           AS GOODS_SYUBETU     --群馬篠崎運送利用                                                               " & vbNewLine _
                                             & ",EDIM.FREE_C01           AS YUKOU_KIGEN                                                                                        " & vbNewLine _
                                             & ",MG.GOODS_NM_3           AS GOODS_NM_3         --2012/05/23                                                                    " & vbNewLine _
                                             & ",MDOUTU.EDI_CD           AS EDISHIP_CD         --2012/05/23                                                                    " & vbNewLine _
                                             & ",MDOUT.EDI_CD            AS EDIDEST_CD         --2012/05/23                                                                    " & vbNewLine _
                                             & "--日医工対策終了                                                                                                               " & vbNewLine _
                                             & "--(2012.06.01) 日本ﾌｧｲﾝ対応  --- START ---                                                                                     " & vbNewLine _
                                             & ",MCD_F.SET_NAIYO         AS SET_NAIYO_FROM1                                                                                    " & vbNewLine _
                                             & ",MCD_F.SET_NAIYO_2       AS SET_NAIYO_FROM2                                                                                    " & vbNewLine _
                                             & ",MCD_F.SET_NAIYO_3       AS SET_NAIYO_FROM3                                                                                    " & vbNewLine _
                                             & "--(2012.06.01) 日本ﾌｧｲﾝ対応  --- START ---                                                                                     " & vbNewLine _
                                             & "--【要望番号1122】埼玉対応 --- START ---                                                                                       " & vbNewLine _
                                             & ",MC.AD_3                 AS CUST_AD_3                                                                                          " & vbNewLine _
                                             & ",MDOUT.REMARK            AS DEST_REMARK                                                                                        " & vbNewLine _
                                             & ",MDOUT.SALES_CD          AS DEST_SALES_CD                                                                                      " & vbNewLine _
                                             & ",MC_SALES.CUST_NM_L      AS DEST_SALES_NM                                                                                      " & vbNewLine _
                                             & ",MC_SALES.AD_1           AS DEST_SALES_AD_1                                                                                    " & vbNewLine _
                                             & ",MC_SALES.AD_2           AS DEST_SALES_AD_2                                                                                    " & vbNewLine _
                                             & ",MC_SALES.AD_3           AS DEST_SALES_AD_3                                                                                    " & vbNewLine _
                                             & ",MC_SALES.TEL            AS DEST_SALES_TEL                                                                                     " & vbNewLine _
                                             & "--【要望番号1122】埼玉対応 ---  END  ---                                                                                       " & vbNewLine _
                                             & "--群馬(合算)端数行分割版向け対応(作業略称) 開始20120731                                                                        " & vbNewLine _
                                             & "--1ここから                                                                                                                    " & vbNewLine _
                                             & ",ISNULL((SELECT BASE.SAGYO_RYAK                                                                                                " & vbNewLine _
                                             & "FROM                                                                                                                           " & vbNewLine _
                                             & "(SELECT                                                                                                                        " & vbNewLine _
                                             & "M_SAGYO.SAGYO_RYAK AS SAGYO_RYAK                                                                                               " & vbNewLine _
                                             & ",ROW_NUMBER() OVER (PARTITION BY INOUTKA_NO_LM ORDER BY INOUTKA_NO_LM) AS NUM                                                  " & vbNewLine _
                                             & "FROM $LM_TRN$..E_SAGYO E                                                                                                       " & vbNewLine _
                                             & "       JOIN $LM_MST$..M_SAGYO M_SAGYO                                                                                          " & vbNewLine _
                                             & "         ON M_SAGYO.NRS_BR_CD = E.NRS_BR_CD                                                                                    " & vbNewLine _
                                             & "        AND M_SAGYO.SAGYO_CD  = E.SAGYO_CD                                                                                     " & vbNewLine _
                                             & "WHERE E.NRS_BR_CD = OUTL.NRS_BR_CD AND E.INOUTKA_NO_LM = (OUTM.OUTKA_NO_L + OUTM.OUTKA_NO_M) AND E.IOZS_KB = '21'              " & vbNewLine _
                                             & ") AS BASE                                                                                                                      " & vbNewLine _
                                             & "WHERE BASE.NUM = 1),'') AS SAGYO_RYAK_1                                                                                        " & vbNewLine _
                                             & "--1ここまで                                                                                                                    " & vbNewLine _
                                             & "--2ここから                                                                                                                    " & vbNewLine _
                                             & ",ISNULL((SELECT BASE.SAGYO_RYAK                                                                                                " & vbNewLine _
                                             & "FROM                                                                                                                           " & vbNewLine _
                                             & "(SELECT                                                                                                                        " & vbNewLine _
                                             & "M_SAGYO.SAGYO_RYAK AS SAGYO_RYAK                                                                                               " & vbNewLine _
                                             & ",ROW_NUMBER() OVER (PARTITION BY INOUTKA_NO_LM ORDER BY INOUTKA_NO_LM) AS NUM                                                  " & vbNewLine _
                                             & "FROM $LM_TRN$..E_SAGYO E                                                                                                       " & vbNewLine _
                                             & "       JOIN $LM_MST$..M_SAGYO M_SAGYO                                                                                          " & vbNewLine _
                                             & "         ON M_SAGYO.NRS_BR_CD = E.NRS_BR_CD                                                                                    " & vbNewLine _
                                             & "        AND M_SAGYO.SAGYO_CD  = E.SAGYO_CD                                                                                     " & vbNewLine _
                                             & "WHERE E.NRS_BR_CD = OUTL.NRS_BR_CD AND E.INOUTKA_NO_LM = (OUTM.OUTKA_NO_L + OUTM.OUTKA_NO_M) AND E.IOZS_KB = '21'              " & vbNewLine _
                                             & ") AS BASE                                                                                                                      " & vbNewLine _
                                             & "WHERE BASE.NUM = 2),'') AS SAGYO_RYAK_2                                                                                        " & vbNewLine _
                                             & "--2ここまで                                                                                                                    " & vbNewLine _
                                             & "--3ここから                                                                                                                    " & vbNewLine _
                                             & ",ISNULL((SELECT BASE.SAGYO_RYAK                                                                                                " & vbNewLine _
                                             & "FROM                                                                                                                           " & vbNewLine _
                                             & "(SELECT                                                                                                                        " & vbNewLine _
                                             & "M_SAGYO.SAGYO_RYAK AS SAGYO_RYAK                                                                                               " & vbNewLine _
                                             & ",ROW_NUMBER() OVER (PARTITION BY INOUTKA_NO_LM ORDER BY INOUTKA_NO_LM) AS NUM                                                  " & vbNewLine _
                                             & "FROM $LM_TRN$..E_SAGYO E                                                                                                       " & vbNewLine _
                                             & "       JOIN $LM_MST$..M_SAGYO M_SAGYO                                                                                          " & vbNewLine _
                                             & "         ON M_SAGYO.NRS_BR_CD = E.NRS_BR_CD                                                                                    " & vbNewLine _
                                             & "        AND M_SAGYO.SAGYO_CD  = E.SAGYO_CD                                                                                     " & vbNewLine _
                                             & "WHERE E.NRS_BR_CD = OUTL.NRS_BR_CD AND E.INOUTKA_NO_LM = (OUTM.OUTKA_NO_L + OUTM.OUTKA_NO_M) AND E.IOZS_KB = '21'              " & vbNewLine _
                                             & ") AS BASE                                                                                                                      " & vbNewLine _
                                             & "WHERE BASE.NUM = 3),'') AS SAGYO_RYAK_3                                                                                        " & vbNewLine _
                                             & "--3ここまで                                                                                                                    " & vbNewLine _
                                             & "--4ここから                                                                                                                    " & vbNewLine _
                                             & ",ISNULL((SELECT BASE.SAGYO_RYAK                                                                                                " & vbNewLine _
                                             & "FROM                                                                                                                           " & vbNewLine _
                                             & "(SELECT                                                                                                                        " & vbNewLine _
                                             & "M_SAGYO.SAGYO_RYAK AS SAGYO_RYAK                                                                                               " & vbNewLine _
                                             & ",ROW_NUMBER() OVER (PARTITION BY INOUTKA_NO_LM ORDER BY INOUTKA_NO_LM) AS NUM                                                  " & vbNewLine _
                                             & "FROM $LM_TRN$..E_SAGYO E                                                                                                       " & vbNewLine _
                                             & "       JOIN $LM_MST$..M_SAGYO M_SAGYO                                                                                          " & vbNewLine _
                                             & "         ON M_SAGYO.NRS_BR_CD = E.NRS_BR_CD                                                                                    " & vbNewLine _
                                             & "        AND M_SAGYO.SAGYO_CD  = E.SAGYO_CD                                                                                     " & vbNewLine _
                                             & "WHERE E.NRS_BR_CD = OUTL.NRS_BR_CD AND E.INOUTKA_NO_LM = (OUTM.OUTKA_NO_L + OUTM.OUTKA_NO_M) AND E.IOZS_KB = '21'              " & vbNewLine _
                                             & ") AS BASE                                                                                                                      " & vbNewLine _
                                             & "WHERE BASE.NUM = 4),'') AS SAGYO_RYAK_4                                                                                        " & vbNewLine _
                                             & "--4ここまで                                                                                                                    " & vbNewLine _
                                             & "--5ここから                                                                                                                    " & vbNewLine _
                                             & ",ISNULL((SELECT BASE.SAGYO_RYAK                                                                                                " & vbNewLine _
                                             & "FROM                                                                                                                           " & vbNewLine _
                                             & "(SELECT                                                                                                                        " & vbNewLine _
                                             & "M_SAGYO.SAGYO_RYAK AS SAGYO_RYAK                                                                                               " & vbNewLine _
                                             & ",ROW_NUMBER() OVER (PARTITION BY INOUTKA_NO_LM ORDER BY INOUTKA_NO_LM) AS NUM                                                  " & vbNewLine _
                                             & "FROM $LM_TRN$..E_SAGYO E                                                                                                       " & vbNewLine _
                                             & "       JOIN $LM_MST$..M_SAGYO M_SAGYO                                                                                          " & vbNewLine _
                                             & "         ON M_SAGYO.NRS_BR_CD = E.NRS_BR_CD                                                                                    " & vbNewLine _
                                             & "        AND M_SAGYO.SAGYO_CD  = E.SAGYO_CD                                                                                     " & vbNewLine _
                                             & "WHERE E.NRS_BR_CD = OUTL.NRS_BR_CD AND E.INOUTKA_NO_LM = (OUTM.OUTKA_NO_L + OUTM.OUTKA_NO_M) AND E.IOZS_KB = '21'              " & vbNewLine _
                                             & ") AS BASE                                                                                                                      " & vbNewLine _
                                             & "WHERE BASE.NUM = 5),'') AS SAGYO_RYAK_5                                                                                        " & vbNewLine _
                                             & "--5ここまで                                                                                                                    " & vbNewLine _
                                             & "--届け先1ここから                                                                                                              " & vbNewLine _
                                             & ",ISNULL((SELECT BASE.SAGYO_RYAK                                                                                                " & vbNewLine _
                                             & "FROM                                                                                                                           " & vbNewLine _
                                             & "(SELECT                                                                                                                        " & vbNewLine _
                                             & "M_SAGYO.SAGYO_RYAK AS SAGYO_RYAK                                                                                               " & vbNewLine _
                                             & ",ROW_NUMBER() OVER (PARTITION BY INOUTKA_NO_LM ORDER BY INOUTKA_NO_LM) AS NUM                                                  " & vbNewLine _
                                             & "FROM $LM_TRN$..E_SAGYO E                                                                                                       " & vbNewLine _
                                             & "       JOIN $LM_MST$..M_SAGYO M_SAGYO                                                                                          " & vbNewLine _
                                             & "         ON M_SAGYO.NRS_BR_CD = E.NRS_BR_CD                                                                                    " & vbNewLine _
                                             & "        AND M_SAGYO.SAGYO_CD  = E.SAGYO_CD                                                                                     " & vbNewLine _
                                             & "WHERE E.NRS_BR_CD = OUTL.NRS_BR_CD AND E.INOUTKA_NO_LM = (OUTM.OUTKA_NO_L + OUTM.OUTKA_NO_M) AND E.IOZS_KB = '21'              " & vbNewLine _
                                             & ") AS BASE                                                                                                                      " & vbNewLine _
                                             & "WHERE BASE.NUM = 6),'') AS DEST_SAGYO_RYAK_1                                                                                   " & vbNewLine _
                                             & "--届け先1ここまで                                                                                                              " & vbNewLine _
                                             & "--届け先2ここから                                                                                                              " & vbNewLine _
                                             & ",ISNULL((SELECT BASE.SAGYO_RYAK                                                                                                " & vbNewLine _
                                             & "FROM                                                                                                                           " & vbNewLine _
                                             & "(SELECT                                                                                                                        " & vbNewLine _
                                             & "M_SAGYO.SAGYO_RYAK AS SAGYO_RYAK                                                                                               " & vbNewLine _
                                             & ",ROW_NUMBER() OVER (PARTITION BY INOUTKA_NO_LM ORDER BY INOUTKA_NO_LM) AS NUM                                                  " & vbNewLine _
                                             & "FROM $LM_TRN$..E_SAGYO E                                                                                                       " & vbNewLine _
                                             & "       JOIN $LM_MST$..M_SAGYO M_SAGYO                                                                                          " & vbNewLine _
                                             & "         ON M_SAGYO.NRS_BR_CD = E.NRS_BR_CD                                                                                    " & vbNewLine _
                                             & "        AND M_SAGYO.SAGYO_CD  = E.SAGYO_CD                                                                                     " & vbNewLine _
                                             & "WHERE E.NRS_BR_CD = OUTL.NRS_BR_CD AND E.INOUTKA_NO_LM = (OUTM.OUTKA_NO_L + OUTM.OUTKA_NO_M) AND E.IOZS_KB = '21'              " & vbNewLine _
                                             & ") AS BASE                                                                                                                      " & vbNewLine _
                                             & "WHERE BASE.NUM = 7),'') AS DEST_SAGYO_RYAK_2                                                                                   " & vbNewLine _
                                             & "--届け先ここまで                                                                                                               " & vbNewLine _
                                             & "--群馬(合算)端数行分割版向け対応(作業略称) 終了20120731                                                                        " & vbNewLine _
                                             & "--群馬篠崎運送向け自由項目対応　開始　                                                                                         " & vbNewLine _
                                             & ",EDIM.FREE_C07           AS SZ01_YUSO --篠崎                                                                                   " & vbNewLine _
                                             & ",EDIM.FREE_C09           AS SZ01_UNSO --篠崎                                                                                   " & vbNewLine _
                                             & "--群馬篠崎運送向け自由項目対応　終了                                                                                         　" & vbNewLine _
                                             & "--【要望番号2068】デュポンテフロン対応 --- START ---                                                                           " & vbNewLine _
                                             & ",MGD2.SET_NAIYO                 AS RUIJI_GOODS_FLG                                                                             " & vbNewLine _
                                             & ",MGD3.SET_NAIYO                 AS DUPONT_YORYO                                                                                " & vbNewLine _
                                             & "--【要望番号2068】デュポンテフロン対応 ---  END  ---                                                                           " & vbNewLine _
                                             & "--出荷L                                                                                                                        " & vbNewLine _
                                             & "FROM                                                                                                                           " & vbNewLine _
                                             & "$LM_TRN$..C_OUTKA_L OUTL                                                                                                       " & vbNewLine _
                                             & "--トランザクションテーブル                                                                                                     " & vbNewLine _
                                             & "--出荷M                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..C_OUTKA_M OUTM                                                                                             " & vbNewLine _
                                             & "ON  OUTM.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "AND OUTM.OUTKA_NO_L = OUTL.OUTKA_NO_L                                                                                          " & vbNewLine _
                                             & "AND OUTM.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--★★★追加開始--------------------------------                                                                               " & vbNewLine _
                                             & "--出荷M(中MIN)                                                                                                                 " & vbNewLine _
                                             & "LEFT OUTER JOIN                                                                                                                " & vbNewLine _
                                             & "       (SELECT                                                                                                                 " & vbNewLine _
                                             & "           NRS_BR_CD                                                                                                           " & vbNewLine _
                                             & "           ,OUTKA_NO_L                                                                                                         " & vbNewLine _
                                             & "           ,MIN(OUTKA_NO_M) AS  OUTKA_NO_M                                                                                     " & vbNewLine _
                                             & "       FROM $LM_TRN$..C_OUTKA_M WHERE SYS_DEL_FLG ='0'                                                                         " & vbNewLine _
                                             & "        AND NRS_BR_CD = @NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "        AND OUTKA_NO_L = @KANRI_NO_L                                                                                           " & vbNewLine _
                                             & "       GROUP BY NRS_BR_CD,OUTKA_NO_L) OUTM_MIN                                                                                 " & vbNewLine _
                                             & "       ON OUTM_MIN.NRS_BR_CD        = OUTL.NRS_BR_CD                                                                           " & vbNewLine _
                                             & "       AND OUTM_MIN.OUTKA_NO_L      = OUTL.OUTKA_NO_L                                                                          " & vbNewLine _
                                             & "--出荷M(中MIN)                                                                                                                 " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..C_OUTKA_M OUTM2                                                                                            " & vbNewLine _
                                             & "ON  OUTM2.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                           " & vbNewLine _
                                             & "AND OUTM2.OUTKA_NO_L = OUTL.OUTKA_NO_L                                                                                         " & vbNewLine _
                                             & "AND OUTM2.OUTKA_NO_M = OUTM_MIN.OUTKA_NO_M                                                                                     " & vbNewLine _
                                             & "AND OUTM2.SYS_DEL_FLG = '0'                                                                                                    " & vbNewLine _
                                             & "--★★★追加終了--------------------------------                                                                               " & vbNewLine _
                                             & "--出荷S                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..C_OUTKA_S OUTS                                                                                             " & vbNewLine _
                                             & "ON  OUTS.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "AND OUTS.OUTKA_NO_L = OUTL.OUTKA_NO_L                                                                                          " & vbNewLine _
                                             & "AND OUTS.OUTKA_NO_M = OUTM.OUTKA_NO_M                                                                                          " & vbNewLine _
                                             & "AND OUTS.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--出荷EDIL                                                                                                                     " & vbNewLine _
                                             & "--(2012.09.06)要望番号1412対応  --- START ---                                                                                  " & vbNewLine _
                                             & "--LEFT JOIN                                                                                                                    " & vbNewLine _
                                             & "--(                                                                                                                            " & vbNewLine _
                                             & "--SELECT                                                                                                                       " & vbNewLine _
                                             & "-- --20120730 MIN化　開始(20120803取りやめ)                                                                                    " & vbNewLine _
                                             & "-- --MIN(NRS_BR_CD)    AS NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "-- --,MIN(OUTKA_CTL_NO) AS OUTKA_CTL_NO                                                                                        " & vbNewLine _
                                             & "-- --,MIN(CUST_CD_L)    AS CUST_CD_L                                                                                           " & vbNewLine _
                                             & "-- NRS_BR_CD                                                                                                                   " & vbNewLine _
                                             & "--,OUTKA_CTL_NO                                                                                                                " & vbNewLine _
                                             & "--,CUST_CD_L                                                                                                                   " & vbNewLine _
                                             & "-- --20120730 MIN化　終了                                                                                                      " & vbNewLine _
                                             & "----★削除開始2012/05/11                                                                                                       " & vbNewLine _
                                             & "----,SHIP_NM_L                                                                                                                 " & vbNewLine _
                                             & "----★削除終了2012/05/11                                                                                                       " & vbNewLine _
                                             & "--,MIN(DEST_CD)     AS DEST_CD                                                                                                 " & vbNewLine _
                                             & "--,MIN(DEST_NM)     AS DEST_NM                                                                                                 " & vbNewLine _
                                             & "--,MIN(DEST_AD_1)   AS DEST_AD_1                                                                                               " & vbNewLine _
                                             & "--,MIN(DEST_AD_2)   AS DEST_AD_2                                                                                               " & vbNewLine _
                                             & "----(2012.04.11)【Notes】№923  DEST_JIS_CDはMINで抽出 -- START --                                                             " & vbNewLine _
                                             & "----,DEST_JIS_CD                                                                                                               " & vbNewLine _
                                             & "--,MIN(DEST_JIS_CD) AS DEST_JIS_CD                                                                                             " & vbNewLine _
                                             & "----(2012.04.11)【Notes】№923  DEST_JIS_CDはMINで抽出 --  END  --                                                             " & vbNewLine _
                                             & "-- --20120730 MIN化　開始                                                                                                      " & vbNewLine _
                                             & "--,MIN(FREE_C01)   AS FREE_C01                                                                                                 " & vbNewLine _
                                             & "--,MIN(FREE_C08)   AS FREE_C08                                                                                                 " & vbNewLine _
                                             & "--,MIN(FREE_C11)   AS FREE_C11                                                                                                 " & vbNewLine _
                                             & "-- --20120730 MIN化　終了                                                                                                      " & vbNewLine _
                                             & "--,SYS_DEL_FLG                                                                                                                 " & vbNewLine _
                                             & "--FROM                                                                                                                         " & vbNewLine _
                                             & "--$LM_TRN$..H_OUTKAEDI_L                                                                                                       " & vbNewLine _
                                             & "--GROUP BY                                                                                                                     " & vbNewLine _
                                             & "-- --20120730 MIN化によるコメントアウト　開始 (20120803取りやめ)                                                               " & vbNewLine _
                                             & "-- NRS_BR_CD                                                                                                                   " & vbNewLine _
                                             & "--,OUTKA_CTL_NO                                                                                                                " & vbNewLine _
                                             & "--,CUST_CD_L                                                                                                                   " & vbNewLine _
                                             & "-- --20120730 MIN化によるコメントアウト　終了                                                                                  " & vbNewLine _
                                             & "----★削除開始2012/05/11                                                                                                       " & vbNewLine _
                                             & "----,SHIP_NM_L                                                                                                                 " & vbNewLine _
                                             & "----★削除開始2012/05/11                                                                                                       " & vbNewLine _
                                             & "----(2012.04.11) Notes№923  DEST_JIS_CDはMINで抽出のためコメント -- START --                                                  " & vbNewLine _
                                             & "----,DEST_JIS_CD                                                                                                               " & vbNewLine _
                                             & "----(2012.04.11) Notes№923  DEST_JIS_CDはMINで抽出のためコメント --  END  --                                                  " & vbNewLine _
                                             & "-- --20120730 MIN化によるコメントアウト　開始                                                                                  " & vbNewLine _
                                             & "----,FREE_C01                                                                                                                  " & vbNewLine _
                                             & "----,FREE_C08                                                                                                                  " & vbNewLine _
                                             & "----,FREE_C11                                                                                                                  " & vbNewLine _
                                             & "-- --20120730 MIN化によるコメントアウト　終了 ↓SYS_DEL_FLGのカンマ除去↓                                                      " & vbNewLine _
                                             & "--,SYS_DEL_FLG                                                                                                                 " & vbNewLine _
                                             & "--) EDIL                                                                                                                       " & vbNewLine _
                                             & "--ON  EDIL.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                          " & vbNewLine _
                                             & "--下記の内容に変更                                                                                                             " & vbNewLine _
                                             & " LEFT JOIN (                                                                                                                   " & vbNewLine _
                                             & "            SELECT                                                                                                             " & vbNewLine _
                                             & "                   NRS_BR_CD                                                                                                   " & vbNewLine _
                                             & "                 , EDI_CTL_NO                                                                                                  " & vbNewLine _
                                             & "                 , OUTKA_CTL_NO                                                                                                " & vbNewLine _
                                             & "             FROM (                                                                                                            " & vbNewLine _
                                             & "                    SELECT                                                                                                     " & vbNewLine _
                                             & "                           EDIOUTL.NRS_BR_CD                                                                                   " & vbNewLine _
                                             & "                         , EDIOUTL.EDI_CTL_NO                                                                                  " & vbNewLine _
                                             & "                         , EDIOUTL.OUTKA_CTL_NO                                                                                " & vbNewLine _
                                             & "                         , CASE WHEN EDIOUTL.OUTKA_CTL_NO = '' THEN 1                                                          " & vbNewLine _
                                             & "                           ELSE ROW_NUMBER() OVER (PARTITION BY EDIOUTL.NRS_BR_CD                                              " & vbNewLine _
                                             & "                                                              , EDIOUTL.OUTKA_CTL_NO                                           " & vbNewLine _
                                             & "                                                       ORDER BY EDIOUTL.NRS_BR_CD                                              " & vbNewLine _
                                             & "                                                              , EDIOUTL.EDI_CTL_NO                                             " & vbNewLine _
                                             & "                                                  )                                                                            " & vbNewLine _
                                             & "                           END AS IDX                                                                                          " & vbNewLine _
                                             & "                     FROM $LM_TRN$..H_OUTKAEDI_L EDIOUTL                                                                       " & vbNewLine _
                                             & "                    WHERE EDIOUTL.SYS_DEL_FLG  = '0'                                                                           " & vbNewLine _
                                             & "                      AND EDIOUTL.NRS_BR_CD    = @NRS_BR_CD                                                                    " & vbNewLine _
                                             & "                      AND EDIOUTL.OUTKA_CTL_NO = @KANRI_NO_L                                                                   " & vbNewLine _
                                             & "                  ) EBASE                                                                                                      " & vbNewLine _
                                             & "            WHERE EBASE.IDX = 1                                                                                                " & vbNewLine _
                                             & "            ) TOPEDI                                                                                                           " & vbNewLine _
                                             & "        ON TOPEDI.NRS_BR_CD    = OUTL.NRS_BR_CD                                                                                " & vbNewLine _
                                             & "       AND TOPEDI.OUTKA_CTL_NO = OUTL.OUTKA_NO_L                                                                               " & vbNewLine _
                                             & " LEFT JOIN $LM_TRN$..H_OUTKAEDI_L EDIL                                                                                         " & vbNewLine _
                                             & "        ON EDIL.NRS_BR_CD  = TOPEDI.NRS_BR_CD                                                                                  " & vbNewLine _
                                             & "       AND EDIL.EDI_CTL_NO = TOPEDI.EDI_CTL_NO                                                                                 " & vbNewLine _
                                             & "--(2012.09.06)要望番号1412対応  ---  END  ---                                                                                  " & vbNewLine _
                                             & "--入荷L                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..B_INKA_L INL                                                                                               " & vbNewLine _
                                             & "ON  INL.NRS_BR_CD = OUTS.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "AND INL.INKA_NO_L = OUTS.INKA_NO_L                                                                                             " & vbNewLine _
                                             & "AND INL.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--入荷S                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..B_INKA_S INS                                                                                               " & vbNewLine _
                                             & "ON  INS.NRS_BR_CD = OUTS.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "AND INS.INKA_NO_L = OUTS.INKA_NO_L                                                                                             " & vbNewLine _
                                             & "AND INS.INKA_NO_M = OUTS.INKA_NO_M                                                                                             " & vbNewLine _
                                             & "AND INS.INKA_NO_S = OUTS.INKA_NO_S                                                                                             " & vbNewLine _
                                             & "AND INS.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--運送L                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..F_UNSO_L UL                                                                                                " & vbNewLine _
                                             & "ON  UL.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                              " & vbNewLine _
                                             & "AND UL.INOUTKA_NO_L = OUTL.OUTKA_NO_L                                                                                          " & vbNewLine _
                                             & "AND UL.MOTO_DATA_KB = '20'                                                                                                     " & vbNewLine _
                                             & "AND UL.SYS_DEL_FLG = '0'                                                                                                       " & vbNewLine _
                                             & "--在庫テーブル                                                                                                                 " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..D_ZAI_TRS ZAI                                                                                              " & vbNewLine _
                                             & "ON  ZAI.NRS_BR_CD = OUTS.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "AND ZAI.ZAI_REC_NO = OUTS.ZAI_REC_NO                                                                                           " & vbNewLine _
                                             & "AND ZAI.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--マスタテーブル                                                                                                               " & vbNewLine _
                                             & "--営業所M                                                                                                                      " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_NRS_BR MNRS                                                                                              " & vbNewLine _
                                             & "ON MNRS.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "--商品M                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_GOODS MG                                                                                                 " & vbNewLine _
                                             & "ON  MG.NRS_BR_CD = OUTM.NRS_BR_CD                                                                                              " & vbNewLine _
                                             & "AND MG.GOODS_CD_NRS = OUTM.GOODS_CD_NRS                                                                                        " & vbNewLine _
                                             & "--★★★追加開始--------------------------------                                                                                     " & vbNewLine _
                                             & "--商品M(MIN)                                                                                                                   " & vbNewLine _
                                             & "LEFT OUTER JOIN $LM_MST$..M_GOODS M_GOODS_MIN                                                                                  " & vbNewLine _
                                             & "ON M_GOODS_MIN.NRS_BR_CD      = OUTL.NRS_BR_CD                                                                                 " & vbNewLine _
                                             & "AND M_GOODS_MIN.GOODS_CD_NRS   = OUTM2.GOODS_CD_NRS                                                                            " & vbNewLine _
                                             & "--★★★追加終了--------------------------------                                                                                     " & vbNewLine _
                                             & "--荷主M(商品M経由)                                                                                                             " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST MC                                                                                                  " & vbNewLine _
                                             & "ON  MC.NRS_BR_CD = MG.NRS_BR_CD                                                                                                " & vbNewLine _
                                             & "AND MC.CUST_CD_L = MG.CUST_CD_L                                                                                                " & vbNewLine _
                                             & "AND MC.CUST_CD_M = MG.CUST_CD_M                                                                                                " & vbNewLine _
                                             & "AND MC.CUST_CD_S = MG.CUST_CD_S                                                                                                " & vbNewLine _
                                             & "AND MC.CUST_CD_SS = MG.CUST_CD_SS                                                                                              " & vbNewLine _
                                             & "--★★★追加開始--------------------------------                                                                               " & vbNewLine _
                                             & "--荷主M(商品M経由) 最小の出荷(中)で抽出                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST MC2                                                                                                 " & vbNewLine _
                                             & "ON  MC2.NRS_BR_CD = M_GOODS_MIN.NRS_BR_CD                                                                                      " & vbNewLine _
                                             & "AND MC2.CUST_CD_L = M_GOODS_MIN.CUST_CD_L                                                                                      " & vbNewLine _
                                             & "AND MC2.CUST_CD_M = M_GOODS_MIN.CUST_CD_M                                                                                      " & vbNewLine _
                                             & "AND MC2.CUST_CD_S = M_GOODS_MIN.CUST_CD_S                                                                                      " & vbNewLine _
                                             & "AND MC2.CUST_CD_SS = M_GOODS_MIN.CUST_CD_SS                                                                                    " & vbNewLine _
                                             & "AND MC2.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--★★★追加終了--------------------------------                                                                               " & vbNewLine _
                                             & "--届先M(届先取得)(出荷L参照)                                                                                                   " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_DEST MDOUT                                                                                               " & vbNewLine _
                                             & "ON  MDOUT.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                           " & vbNewLine _
                                             & "AND MDOUT.CUST_CD_L = OUTL.CUST_CD_L                                                                                           " & vbNewLine _
                                             & "AND MDOUT.DEST_CD = OUTL.DEST_CD                                                                                               " & vbNewLine _
                                             & "--届先M(売上先取得)(出荷L参照)                                                                                                 " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_DEST MDOUTU                                                                                              " & vbNewLine _
                                             & "ON  MDOUTU.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                          " & vbNewLine _
                                             & "AND MDOUTU.CUST_CD_L = OUTL.CUST_CD_L                                                                                          " & vbNewLine _
                                             & "AND MDOUTU.DEST_CD = OUTL.SHIP_CD_L                                                                                            " & vbNewLine _
                                             & "--届先M(届先取得)(出荷EDIL参照)                                                                                                " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_DEST MDEDI                                                                                               " & vbNewLine _
                                             & "ON  MDEDI.NRS_BR_CD = EDIL.NRS_BR_CD                                                                                           " & vbNewLine _
                                             & "AND MDEDI.CUST_CD_L = EDIL.CUST_CD_L                                                                                           " & vbNewLine _
                                             & "AND MDEDI.DEST_CD = EDIL.DEST_CD                                                                                               " & vbNewLine _
                                             & "--【要望番号1122】埼玉対応 --- START ---                                                                                       " & vbNewLine _
                                             & "--届先M(納品書荷主名義名取得)(届先M参照)                                                                                       " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST MC_SALES                                                                                            " & vbNewLine _
                                             & "       ON MC_SALES.NRS_BR_CD  = MDOUT.NRS_BR_CD                                                                                " & vbNewLine _
                                             & "      AND MC_SALES.CUST_CD_L  = MDOUT.SALES_CD                                                                                 " & vbNewLine _
                                             & "      AND MC_SALES.CUST_CD_M  = '00'                                                                                           " & vbNewLine _
                                             & "      AND MC_SALES.CUST_CD_S  = '00'                                                                                           " & vbNewLine _
                                             & "      AND MC_SALES.CUST_CD_SS = '00'                                                                                           " & vbNewLine _
                                             & "--【要望番号1122】埼玉対応 ---  END  ---                                                                                       " & vbNewLine _
                                             & "--運送会社M                                                                                                                    " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_UNSOCO MUCO                                                                                              " & vbNewLine _
                                             & "ON  MUCO.NRS_BR_CD = UL.NRS_BR_CD                                                                                              " & vbNewLine _
                                             & "AND MUCO.UNSOCO_CD = UL.UNSO_CD                                                                                                " & vbNewLine _
                                             & "AND MUCO.UNSOCO_BR_CD = UL.UNSO_BR_CD                                                                                          " & vbNewLine _
                                             & "--倉庫M                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_SOKO MSO                                                                                                 " & vbNewLine _
                                             & "ON  MSO.NRS_BR_CD = OUTL.NRS_BR_CD  --追加                                                                                     " & vbNewLine _
                                             & "AND MSO.WH_CD     = OUTL.WH_CD                                                                                                 " & vbNewLine _
                                             & "--2014/5/16Start s.kobayashi NotesNo.2183                                                                                      " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN11                                                                                                " & vbNewLine _
                                             & "ON  KBN11.KBN_GROUP_CD = 'U028'  --追加                                                                                        " & vbNewLine _
                                             & "AND UL.SEIQ_TARIFF_CD = KBN11.KBN_NM1                                                                                          " & vbNewLine _
                                             & "--2014/5/16End s.kobayashi NotesNo.2183                                                                                       " & vbNewLine _
                                             & "--距離程M(M_DEST.JIS < M_SOKO.JIS_CD)(出荷L参照)                                                                               " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_KYORI MKY1                                                                                               " & vbNewLine _
                                             & "ON  MKY1.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "--AND MKY1.KYORI_CD = MC.BETU_KYORI_CD                                                                                           " & vbNewLine _
                                             & "AND MKY1.KYORI_CD = (CASE ISNULL(KBN11.KBN_NM2,'') WHEN '' THEN MC.BETU_KYORI_CD ELSE KBN11.KBN_NM2 END)                       " & vbNewLine _
                                             & "AND MKY1.ORIG_JIS_CD = MDOUT.JIS                                                                                               " & vbNewLine _
                                             & "AND MKY1.DEST_JIS_CD = MSO.JIS_CD                                                                                              " & vbNewLine _
                                             & "--距離程M(M_SOKO.JIS_CD < M_DEST.JIS)(出荷L参照)                                                                               " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_KYORI MKY2                                                                                               " & vbNewLine _
                                             & "ON  MKY2.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "--AND MKY2.KYORI_CD = MC.BETU_KYORI_CD                                                                                           " & vbNewLine _
                                             & "AND MKY2.KYORI_CD = (CASE ISNULL(KBN11.KBN_NM2,'') WHEN '' THEN MC.BETU_KYORI_CD ELSE KBN11.KBN_NM2 END)                       " & vbNewLine _
                                             & "AND MKY2.ORIG_JIS_CD = MSO.JIS_CD                                                                                              " & vbNewLine _
                                             & "AND MKY2.DEST_JIS_CD = MDOUT.JIS                                                                                               " & vbNewLine _
                                             & "--距離程M(H_OUTKAEDI_L.DEST_JIS_CD < M_SOKO.JIS_CD)(出荷EDIL参照)                                                              " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_KYORI MKY3                                                                                               " & vbNewLine _
                                             & "ON  MKY3.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "--AND MKY3.KYORI_CD = MC.BETU_KYORI_CD                                                                                           " & vbNewLine _
                                             & "AND MKY3.KYORI_CD = (CASE ISNULL(KBN11.KBN_NM2,'') WHEN '' THEN MC.BETU_KYORI_CD ELSE KBN11.KBN_NM2 END)                       " & vbNewLine _
                                             & "AND MKY3.ORIG_JIS_CD = EDIL.DEST_JIS_CD                                                                                        " & vbNewLine _
                                             & "AND MKY3.DEST_JIS_CD = MSO.JIS_CD                                                                                              " & vbNewLine _
                                             & "--距離程M(M_SOKO.JIS_CD < H_OUTKAEDI_L.DEST_JIS_CD)(出荷EDIL参照)                                                              " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_KYORI MKY4                                                                                               " & vbNewLine _
                                             & "ON  MKY4.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "--AND MKY4.KYORI_CD = MC.BETU_KYORI_CD                                                                                           " & vbNewLine _
                                             & "AND MKY4.KYORI_CD = (CASE ISNULL(KBN11.KBN_NM2,'') WHEN '' THEN MC.BETU_KYORI_CD ELSE KBN11.KBN_NM2 END)                       " & vbNewLine _
                                             & "AND MKY4.ORIG_JIS_CD = MSO.JIS_CD                                                                                              " & vbNewLine _
                                             & "AND MKY4.DEST_JIS_CD = EDIL.DEST_JIS_CD                                                                                        " & vbNewLine _
                                             & "--届先商品M(出荷L参照)                                                                                                         " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_DESTGOODS MDGL                                                                                           " & vbNewLine _
                                             & "ON  MDGL.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "AND MDGL.CUST_CD_L = OUTL.CUST_CD_L                                                                                            " & vbNewLine _
                                             & "AND MDGL.CUST_CD_M = OUTL.CUST_CD_M                                                                                            " & vbNewLine _
                                             & "AND MDGL.CD = OUTL.DEST_CD                                                                                                     " & vbNewLine _
                                             & "AND MDGL.GOODS_CD_NRS = MG.GOODS_CD_NRS                                                                                        " & vbNewLine _
                                             & "AND MDGL.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--届先商品M(出荷EDI参照)                                                                                                       " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_DESTGOODS MDGE                                                                                           " & vbNewLine _
                                             & "ON  MDGE.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "AND MDGE.CUST_CD_L = OUTL.CUST_CD_L                                                                                            " & vbNewLine _
                                             & "AND MDGE.CUST_CD_M = OUTL.CUST_CD_M                                                                                            " & vbNewLine _
                                             & "AND MDGE.CD = EDIL.DEST_CD                                                                                                     " & vbNewLine _
                                             & "AND MDGE.GOODS_CD_NRS = MG.GOODS_CD_NRS                                                                                        " & vbNewLine _
                                             & "AND MDGE.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--区分M(納入予定区分)                                                                                                          " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN1                                                                                                 " & vbNewLine _
                                             & "ON  KBN1.KBN_GROUP_CD = 'N010'                                                                                                 " & vbNewLine _
                                             & "AND KBN1.KBN_CD = OUTL.ARR_PLAN_TIME                                                                                           " & vbNewLine _
                                             & "AND KBN1.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--区分M(日本合成用倉庫名)                                                                                                      " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN2                                                                                                 " & vbNewLine _
                                             & "ON  KBN2.KBN_GROUP_CD = 'P005'                                                                                                 " & vbNewLine _
                                             & "AND KBN2.KBN_CD = '00'                                                                                                         " & vbNewLine _
                                             & "AND KBN2.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--区分M(日本合成用部署名)                                                                                                      " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN3                                                                                                 " & vbNewLine _
                                             & "ON  KBN3.KBN_GROUP_CD = 'P005'                                                                                                 " & vbNewLine _
                                             & "AND KBN3.KBN_CD = '01'                                                                                                         " & vbNewLine _
                                             & "AND KBN3.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--区分M(日本合成用営業署名)                                                                                                    " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN4                                                                                                 " & vbNewLine _
                                             & "ON  KBN4.KBN_GROUP_CD = 'P005'                                                                                                 " & vbNewLine _
                                             & "AND KBN4.KBN_CD = '02'                                                                                                         " & vbNewLine _
                                             & "AND KBN4.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--区分M(荷姿)                                                                                                                  " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN5                                                                                                 " & vbNewLine _
                                             & "ON  KBN5.KBN_GROUP_CD = 'N001'                                                                                                 " & vbNewLine _
                                             & "AND KBN5.KBN_CD = MG.PKG_UT                                                                                                    " & vbNewLine _
                                             & "AND KBN5.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--明細タイトル（小分け）                                                                                                       " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN6                                                                                                 " & vbNewLine _
                                             & "ON  KBN6.KBN_GROUP_CD = 'S041'                                                                                                 " & vbNewLine _
                                             & "AND KBN6.KBN_CD = OUTM.ALCTD_KB                                                                                                " & vbNewLine _
                                             & "AND KBN6.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--区分M(毒劇区分名称)                                                                                                           " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN7                                                                                                  " & vbNewLine _
                                             & "ON  KBN7.KBN_GROUP_CD = 'G001'                                                                                                  " & vbNewLine _
                                             & "AND KBN7.KBN_CD = MG.DOKU_KB                                                                                                    " & vbNewLine _
                                             & "AND KBN7.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--【要望番号995】　2012/04/17　元着払い区分　START                                                                             " & vbNewLine _
                                             & "--区分M(元着払区分名称)                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN9                                                                                                 " & vbNewLine _
                                             & "ON  KBN9.KBN_GROUP_CD = 'M001'                                                                                                 " & vbNewLine _
                                             & "AND KBN9.KBN_CD = OUTL.PC_KB                                                                                                   " & vbNewLine _
                                             & "AND KBN9.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--【要望番号995】　2012/04/17　元着払い区分　 END                                                                              " & vbNewLine _
                                             & "--日医工対策開始                                                                                                               " & vbNewLine _
                                             & "--★出荷EDI M(日医工)                                                                                                          " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..H_OUTKAEDI_M EDIM                                                                                            " & vbNewLine _
                                             & "ON  EDIM.NRS_BR_CD        = OUTM.NRS_BR_CD                                                                                     " & vbNewLine _
                                             & "AND EDIM.OUTKA_CTL_NO     = OUTM.OUTKA_NO_L                                                                                    " & vbNewLine _
                                             & "AND EDIM.OUTKA_CTL_NO_CHU = OUTM.OUTKA_NO_M                                                                                    " & vbNewLine _
                                             & "AND EDIM.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--日医工_出荷指示EDIデータ                                                                                                     " & vbNewLine _
                                             & "--LEFT JOIN $LM_TRN$..H_OUTKAEDI_DTL_NIK EDIN                                                                                    " & vbNewLine _
                                             & "--ON   OUTL.NRS_BR_CD      = EDIN.NRS_BR_CD                                                                                      " & vbNewLine _
                                             & "--AND  EDIL.EDI_CTL_NO     = EDIN.EDI_CTL_NO                                                                                     " & vbNewLine _
                                             & "--AND  EDIM.EDI_CTL_NO_CHU = EDIN.EDI_CTL_NO_CHU                                                                                 " & vbNewLine _
                                             & "--AND  EDIN.SYS_DEL_FLG    = '0'                                                                                                 " & vbNewLine _
                                             & "                                                                                                                               " & vbNewLine _
                                             & "--荷主明細M ★                                                                                                                 " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST_DETAILS MCD_N                                                                                       " & vbNewLine _
                                             & "ON  MCD_N.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                           " & vbNewLine _
                                             & "AND MCD_N.CUST_CD   = OUTL.CUST_CD_L                                                                                           " & vbNewLine _
                                             & "AND MCD_N.SUB_KB = '26'                                                                                                        " & vbNewLine _
                                             & "--日医工対策終了                                                                                                               " & vbNewLine _
                                             & "--(2012.06.01) 日本ﾌｧｲﾝ対応  --- START ----                                                                                    " & vbNewLine _
                                             & "--荷主明細M                                                                                                                    " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST_DETAILS MCD_F                                                                                       " & vbNewLine _
                                             & "ON  MCD_F.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                           " & vbNewLine _
                                             & "AND MCD_F.CUST_CD   = OUTL.CUST_CD_L                                                                                           " & vbNewLine _
                                             & "AND MCD_F.SUB_KB = '29'                                                                                                        " & vbNewLine _
                                             & "--(2012.06.01) 日本ﾌｧｲﾝ対応  ---  END  ----                                                                                    " & vbNewLine _
                                             & "--出荷Lでの荷主帳票パターン取得                                                                                                " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST_RPT MCR1                                                                                            " & vbNewLine _
                                             & "ON  OUTL.NRS_BR_CD = MCR1.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "AND OUTL.CUST_CD_L = MCR1.CUST_CD_L                                                                                            " & vbNewLine _
                                             & "AND OUTL.CUST_CD_M = MCR1.CUST_CD_M                                                                                            " & vbNewLine _
                                             & "AND '00' = MCR1.CUST_CD_S                                                                                                      " & vbNewLine _
                                             & "AND MCR1.PTN_ID = '04'                                                                                                         " & vbNewLine _
                                             & "--帳票パターン取得                                                                                                             " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_RPT MR1                                                                                                  " & vbNewLine _
                                             & "ON  MR1.NRS_BR_CD = MCR1.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "AND MR1.PTN_ID = MCR1.PTN_ID                                                                                                   " & vbNewLine _
                                             & "AND MR1.PTN_CD = MCR1.PTN_CD                                                                                                   " & vbNewLine _
                                             & "AND MR1.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--商品Mの荷主での荷主帳票パターン取得                                                                                          " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST_RPT MCR2                                                                                            " & vbNewLine _
                                             & "ON  MG.NRS_BR_CD = MCR2.NRS_BR_CD                                                                                              " & vbNewLine _
                                             & "AND MG.CUST_CD_L = MCR2.CUST_CD_L                                                                                              " & vbNewLine _
                                             & "AND MG.CUST_CD_M = MCR2.CUST_CD_M                                                                                              " & vbNewLine _
                                             & "AND MG.CUST_CD_S = MCR2.CUST_CD_S                                                                                              " & vbNewLine _
                                             & "AND MCR2.PTN_ID = '04'                                                                                                         " & vbNewLine _
                                             & "--帳票パターン取得                                                                                                             " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_RPT MR2                                                                                                  " & vbNewLine _
                                             & "ON  MR2.NRS_BR_CD = MCR2.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "AND MR2.PTN_ID = MCR2.PTN_ID                                                                                                   " & vbNewLine _
                                             & "AND MR2.PTN_CD = MCR2.PTN_CD                                                                                                   " & vbNewLine _
                                             & "AND MR2.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--存在しない場合の帳票パターン取得                                                                                             " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_RPT MR3                                                                                                  " & vbNewLine _
                                             & "ON  MR3.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "AND MR3.PTN_ID = '04'                                                                                                          " & vbNewLine _
                                             & "AND MR3.STANDARD_FLAG = '01'                                                                                                   " & vbNewLine _
                                             & "AND MR3.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--ユーザM                                                                                                                      " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..S_USER MUSER                                                                                               " & vbNewLine _
                                             & "ON MUSER.USER_CD = OUTL.SYS_ENT_USER                                                                                           " & vbNewLine _
                                             & "AND MUSER.SYS_DEL_FLG = '0'                                                                                                    " & vbNewLine _
                                             & "--商品明細M                                                                                                                    " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_GOODS_DETAILS MGD                                                                                        " & vbNewLine _
                                             & "ON  MGD.NRS_BR_CD = MG.NRS_BR_CD                                                                                               " & vbNewLine _
                                             & "AND MGD.GOODS_CD_NRS = MG.GOODS_CD_NRS                                                                                         " & vbNewLine _
                                             & "AND MGD.SUB_KB = '09'                                                                                                          " & vbNewLine _
                                             & "AND MGD.SYS_DEL_FLG = '0'       --ADD 2019/02/07 依頼番号 : 004605   【LMS】納品書がの梱包個数が2倍になるバグ修正              " & vbNewLine _
                                             & "--商品明細M2                                                                                                                    " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_GOODS_DETAILS MGD2                                                                                        " & vbNewLine _
                                             & "ON  MGD2.NRS_BR_CD = MG.NRS_BR_CD                                                                                               " & vbNewLine _
                                             & "AND MGD2.GOODS_CD_NRS = MG.GOODS_CD_NRS                                                                                         " & vbNewLine _
                                             & "AND MGD2.SUB_KB = '38'                                                                                                          " & vbNewLine _
                                             & "--商品明細M3                                                                                                                    " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_GOODS_DETAILS MGD3                                                                                        " & vbNewLine _
                                             & "ON  MGD3.NRS_BR_CD = MG.NRS_BR_CD                                                                                               " & vbNewLine _
                                             & "AND MGD3.GOODS_CD_NRS = MG.GOODS_CD_NRS                                                                                         " & vbNewLine _
                                             & "AND MGD3.SUB_KB = '39'                                                                                                          " & vbNewLine _
                                             & "WHERE                                                                                                                          " & vbNewLine _
                                             & "    OUTL.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "AND OUTL.NRS_BR_CD = @NRS_BR_CD                                                                                                " & vbNewLine _
                                             & "AND OUTL.OUTKA_NO_L = @KANRI_NO_L                                                                                              " & vbNewLine

    'Notes822:修正対象
    ''' <summary>
    ''' 印刷データ抽出用(出荷テーブル)(大阪物流センター用：作業項目有り)
    ''' </summary>
    ''' <remarks></remarks>
    Friend Const SQL_SELECT_OUTKA_SAGYO As String = "--出荷テーブル                                                                                                           " & vbNewLine _
                                             & "SELECT                                                                                                                         " & vbNewLine _
                                             & " CASE WHEN MR2.PTN_CD IS NOT NULL THEN MR2.RPT_ID                                                                              " & vbNewLine _
                                             & "      WHEN MR1.PTN_CD IS NOT NULL THEN MR1.RPT_ID                                                                              " & vbNewLine _
                                             & "      ELSE MR3.RPT_ID                                                                                                          " & vbNewLine _
                                             & " END              AS RPT_ID                                                                                                    " & vbNewLine _
                                             & ",OUTL.NRS_BR_CD   AS NRS_BR_CD                                                                                                 " & vbNewLine _
                                             & ",OUTM.PRINT_SORT  AS PRINT_SORT                                                                                                " & vbNewLine _
                                             & ",CASE WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_CD                                                                     " & vbNewLine _
                                             & "      ELSE OUTL.DEST_CD                                                                                                        " & vbNewLine _
                                             & " END              AS DEST_CD                                                                                                   " & vbNewLine _
                                             & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_NM                                                                               " & vbNewLine _
                                             & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_NM                                                                     " & vbNewLine _
                                             & "      ELSE MDOUT.DEST_NM                                                                                                       " & vbNewLine _
                                             & " END              AS DEST_NM                                                                                                   " & vbNewLine _
                                             & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_AD_1                                                                             " & vbNewLine _
                                             & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_AD_1                                                                   " & vbNewLine _
                                             & "      ELSE MDOUT.AD_1                                                                                                          " & vbNewLine _
                                             & " END              AS DEST_AD_1                                                                                                 " & vbNewLine _
                                             & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_AD_2                                                                             " & vbNewLine _
                                             & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_AD_2                                                                   " & vbNewLine _
                                             & "      ELSE MDOUT.AD_2                                                                                                          " & vbNewLine _
                                             & " END              AS DEST_AD_2                                                                                                 " & vbNewLine _
                                             & ",OUTL.DEST_AD_3   AS DEST_AD_3                                                                                                 " & vbNewLine _
                                             & ",OUTL.DEST_TEL    AS DEST_TEL                                                                                                  " & vbNewLine _
                                             & ",OUTL.OUTKA_PLAN_DATE   AS OUTKA_PLAN_DATE                                                                                     " & vbNewLine _
                                             & ",OUTL.CUST_ORD_NO       AS CUST_ORD_NO                                                                                         " & vbNewLine _
                                             & ",OUTL.BUYER_ORD_NO      AS BUYER_ORD_NO                                                                                        " & vbNewLine _
                                             & ",MUCO.UNSOCO_NM         AS UNSOCO_NM                                                                                           " & vbNewLine _
                                             & ",OUTL.ARR_PLAN_DATE     AS ARR_PLAN_DATE                                                                                       " & vbNewLine _
                                             & ",KBN1.KBN_NM1           AS ARR_PLAN_TIME                                                                                       " & vbNewLine _
                                             & ",OUTL.OUTKA_NO_L        AS OUTKA_NO_L                                                                                          " & vbNewLine _
                                             & ",MDOUTU.DEST_NM         AS URIG_NM                                                                                             " & vbNewLine _
                                             & ",MC.CUST_NM_L           AS CUST_NM_L                                                                                           " & vbNewLine _
                                             & "--(2012.06.15) 要望番号1155 -- START --                                                                                        " & vbNewLine _
                                             & ",MC.CUST_NM_M           AS CUST_NM_M                                                                                           " & vbNewLine _
                                             & "--(2012.06.15) 要望番号1155 --  END  --                                                                                        " & vbNewLine _
                                             & ",MC.AD_1                AS CUST_AD_1                                                                                           " & vbNewLine _
                                             & ",MC.AD_2                AS CUST_AD_2                                                                                           " & vbNewLine _
                                             & ",MC.TEL                 AS CUST_TEL                                                                                            " & vbNewLine _
                                             & ",MC.DENPYO_NM           AS DENPYO_NM                                                                                            " & vbNewLine _
                                             & ",MNRS.NRS_BR_NM         AS NRS_BR_NM                                                                                           " & vbNewLine _
                                             & ",CASE WHEN MSO.WH_KB = '01' THEN MSO.AD_1                                                                             " & vbNewLine _
                                             & "      ELSE MNRS.AD_1                                                                                                          " & vbNewLine _
                                             & " END              AS NRS_BR_AD1                                                                                                 " & vbNewLine _
                                             & ",CASE WHEN MSO.WH_KB = '01' THEN MSO.AD_2                                                                             " & vbNewLine _
                                             & "      ELSE MNRS.AD_2                                                                                                          " & vbNewLine _
                                             & " END              AS NRS_BR_AD2                                                                                                 " & vbNewLine _
                                             & ",CASE WHEN MSO.WH_KB = '01' THEN MSO.TEL                                                                             " & vbNewLine _
                                             & "      ELSE MNRS.TEL                                                                                                          " & vbNewLine _
                                             & " END              AS NRS_BR_TEL                                                                                                 " & vbNewLine _
                                             & ",CASE WHEN MSO.WH_KB = '01' THEN MSO.FAX                                                                             " & vbNewLine _
                                             & "      ELSE MNRS.FAX                                                                                                          " & vbNewLine _
                                             & " END              AS NRS_BR_FAX                                                                                                 " & vbNewLine _
                                             & ",MUSER.USER_NM          AS PIC                                                                                                 " & vbNewLine _
                                             & ",OUTM.OUTKA_NO_M        AS OUTKA_NO_M                                                                                          " & vbNewLine _
                                             & ",OUTS.OUTKA_NO_S        AS OUTKA_NO_S                                                                                          " & vbNewLine _
                                             & ",CASE WHEN MGD.SET_NAIYO = '1' THEN ''                                                                                         " & vbNewLine _
                                             & "      WHEN INL.INKA_STATE_KB < '50' THEN INL.INKA_DATE                                                                         " & vbNewLine _
                                             & "      WHEN INL.INKA_STATE_KB >= '50' THEN ZAI.INKO_DATE                                                                        " & vbNewLine _
                                             & "      ELSE ''                                                                                                                  " & vbNewLine _
                                             & " END                    AS INKA_DATE                                                                                           " & vbNewLine _
                                             & ",ZAI.REMARK_OUT         AS REMARK_OUT                                                                                          " & vbNewLine _
                                             & ",CASE WHEN (MDGE.GOODS_NM IS NOT NULL AND MDGE.GOODS_NM <> '' AND EDIL.OUTKA_CTL_NO IS NOT NULL) THEN MDGE.GOODS_NM            " & vbNewLine _
                                             & "      WHEN (MDGL.GOODS_NM IS NOT NULL AND MDGL.GOODS_NM <> '' AND EDIL.OUTKA_CTL_NO IS NULL) THEN MDGL.GOODS_NM                " & vbNewLine _
                                             & "      ELSE MG.GOODS_NM_1                                                                                                       " & vbNewLine _
                                             & " END                    AS GOODS_NM_1                                                                                          " & vbNewLine _
                                             & ",OUTS.LOT_NO            AS LOT_NO                                                                                              " & vbNewLine _
                                             & ",OUTS.SERIAL_NO         AS SERIAL_NO                                                                                           " & vbNewLine _
                                             & ",OUTS.IRIME             AS IRIME                                                                                               " & vbNewLine _
                                             & ",MG.PKG_NB              AS PKG_NB                                                                                              " & vbNewLine _
                                             & ",OUTS.ALCTD_NB / MG.PKG_NB     AS KONSU                                                                                        " & vbNewLine _
                                             & ",OUTS.ALCTD_NB % MG.PKG_NB     AS HASU                                                                                         " & vbNewLine _
                                             & ",OUTS.ALCTD_NB          AS ALCTD_NB                                                                                            " & vbNewLine _
                                             & ",MG.PKG_UT              AS PKG_UT                                                                                              " & vbNewLine _
                                             & ",KBN5.KBN_NM1           AS PKG_UT_NM                                                                                           " & vbNewLine _
                                             & ",OUTS.ALCTD_QT          AS ALCTD_QT                                                                                            " & vbNewLine _
                                             & ",MG.STD_IRIME_UT        AS IRIME_UT                                                                                            " & vbNewLine _
                                             & "--(2012.10.01)要望番号1445 -- START --                                                                                         " & vbNewLine _
                                             & ",UL.UNSO_WT             AS WT                                                                                                  " & vbNewLine _
                                             & "--,OUTS.BETU_WT * OUTS.ALCTD_NB  AS WT                                                                                         " & vbNewLine _
                                             & "--(2012.10.01)要望番号1445 --  END  --                                                                                         " & vbNewLine _
                                             & ",0                      AS UNSO_WT                                                                                             " & vbNewLine _
                                             & ",OUTS.TOU_NO            AS TOU_NO                                                                                              " & vbNewLine _
                                             & ",OUTS.SITU_NO           AS SITU_NO                                                                                             " & vbNewLine _
                                             & ",RTRIM(OUTS.ZONE_CD)     AS ZONE_CD                                                                                             " & vbNewLine _
                                             & ",OUTS.LOCA              AS LOCA                                                                                                " & vbNewLine _
                                             & ",OUTS.ALCTD_CAN_NB / MG.PKG_NB   AS ZAN_KONSU                                                                                  " & vbNewLine _
                                             & ",OUTS.ALCTD_CAN_NB % MG.PKG_NB   AS ZAN_HASU                                                                                   " & vbNewLine _
                                             & ",MG.GOODS_CD_CUST       AS GOODS_CD_CUST                                                                                       " & vbNewLine _
                                             & ",OUTM.REMARK            AS REMARK_M                                                                                            " & vbNewLine _
                                             & "--★★★変更開始--------------------------------                                                                                     " & vbNewLine _
                                             & "--(2016.02.04)エクシング対応START                                                                                     " & vbNewLine _                                             
                                             & ",UL.UNSO_NO_L   AS CUST_NM_S                                                                                           " & vbNewLine _                                             
                                             & "--,''   AS CUST_NM_S                                                                                           " & vbNewLine _
                                             & "--(2016.02.04)エクシング対応END                                                                                     " & vbNewLine _                                                                                          
                                             & ",''   AS CUST_NM_S_H                                                                                           " & vbNewLine _
                                             & "--★★★変更終了--------------------------------                                                                                     " & vbNewLine _
                                             & ",OUTM.CUST_ORD_NO_DTL   AS CUST_ORD_NO_DTL                                                                                     " & vbNewLine _
                                             & ",OUTL.REMARK            AS OUTKA_REMARK                                                                                        " & vbNewLine _
                                             & ",UL.REMARK              AS HAISOU_REMARK                                                                                       " & vbNewLine _
                                             & ",OUTL.NHS_REMARK        AS NHS_REMARK                                                                                          " & vbNewLine _
                                             & "--(2012.08.06) 発JIS、着JISが共に同じJISでも、必ず0㎞になるのを修正  --- START ---                                             " & vbNewLine _
                                             & "--,CASE WHEN (OUTL.DEST_KB = '02' AND MDEDI.KYORI > 0) THEN MDEDI.KYORI                                                        " & vbNewLine _
                                             & "--      WHEN (OUTL.DEST_KB = '02' AND MDEDI.KYORI = 0 AND EDIL.DEST_JIS_CD < MSO.JIS_CD) THEN MKY3.KYORI                       " & vbNewLine _
                                             & "--      WHEN (OUTL.DEST_KB = '02' AND MDEDI.KYORI = 0 AND MSO.JIS_CD < EDIL.DEST_JIS_CD) THEN MKY4.KYORI                       " & vbNewLine _
                                             & "--      WHEN (OUTL.DEST_KB <> '02' AND MDOUT.KYORI > 0) THEN MDOUT.KYORI                                                       " & vbNewLine _
                                             & "--      WHEN (OUTL.DEST_KB <> '02' AND MDOUT.KYORI = 0 AND MDOUT.JIS < MSO.JIS_CD) THEN MKY1.KYORI                             " & vbNewLine _
                                             & "--      WHEN (OUTL.DEST_KB <> '02' AND MDOUT.KYORI = 0 AND MSO.JIS_CD < MDOUT.JIS) THEN MKY2.KYORI                             " & vbNewLine _
                                             & "--      ELSE 0                                                                                                                 " & vbNewLine _
                                             & "-- END                  AS KYORI                                                                                               " & vbNewLine _
                                             & ",CASE WHEN (OUTL.DEST_KB = '02' AND MDEDI.KYORI > 0) THEN MDEDI.KYORI                                                          " & vbNewLine _
                                             & "      WHEN (OUTL.DEST_KB = '02' AND MDEDI.KYORI = 0 AND EDIL.DEST_JIS_CD <= MSO.JIS_CD) THEN MKY3.KYORI                        " & vbNewLine _
                                             & "      WHEN (OUTL.DEST_KB = '02' AND MDEDI.KYORI = 0 AND MSO.JIS_CD <= EDIL.DEST_JIS_CD) THEN MKY4.KYORI                        " & vbNewLine _
                                             & "      WHEN (OUTL.DEST_KB <> '02' AND MDOUT.KYORI > 0) THEN MDOUT.KYORI                                                         " & vbNewLine _
                                             & "      WHEN (OUTL.DEST_KB <> '02' AND MDOUT.KYORI = 0 AND MDOUT.JIS <= MSO.JIS_CD) THEN MKY1.KYORI                              " & vbNewLine _
                                             & "      WHEN (OUTL.DEST_KB <> '02' AND MDOUT.KYORI = 0 AND MSO.JIS_CD <= MDOUT.JIS) THEN MKY2.KYORI                              " & vbNewLine _
                                             & "      ELSE 0                                                                                                                   " & vbNewLine _
                                             & " END                    AS KYORI                                                                                               " & vbNewLine _
                                             & "--(2012.08.06) 発JIS、着JISが共に同じJISでも、必ず0㎞になるのを修正  ---  END  ---                                             " & vbNewLine _
                                             & ",OUTL.OUTKA_PKG_NB      AS OUTKA_PKG_NB_L                                                                                      " & vbNewLine _
                                             & ",KBN2.KBN_NM1           AS SOKO_NM                                                                                             " & vbNewLine _
                                             & ",KBN3.KBN_NM1           AS BUSHO_NM                                                                                            " & vbNewLine _
                                             & ",KBN4.KBN_NM1           AS NRS_BR_NM_NICHI                                                                                     " & vbNewLine _
                                             & ",OUTS.ALCTD_CAN_QT      AS ALCTD_CAN_QT                                                                                        " & vbNewLine _
                                             & ",OUTM.ALCTD_KB          AS ALCTD_KB                                                                                            " & vbNewLine _
                                             & ",'0'                    AS PTN_FLAG                                                                                            " & vbNewLine _
                                             & ",OUTL.CUST_CD_L         AS CUST_CD_L                                                                                           " & vbNewLine _
                                             & ",OUTL.ORDER_TYPE        AS ORDER_TYPE                                                                                          " & vbNewLine _
                                             & ",ZAI.LT_DATE                                                                                                                   " & vbNewLine _
                                             & ",OUTM.BUYER_ORD_NO_DTL AS BUYER_ORD_NO_DTL                                                                                     " & vbNewLine _
                                             & ",ZAI.GOODS_COND_KB_2 AS GOODS_COND_CD                                                                                          " & vbNewLine _
                                             & ",ISNULL(KBN8.KBN_NM1,'') AS GOODS_COND_NM  --☆                                                                                " & vbNewLine _
                                             & ",ZAI.REMARK AS REMARK_ZAI                                                                                                      " & vbNewLine _
                                             & ",KBN6.KBN_NM2 AS TITLE_SMPL                                                                                                    " & vbNewLine _
                                             & ",OUTS.ALCTD_CAN_NB AS ALCTD_CAN_NB                                                                                             " & vbNewLine _
                                             & ",OUTM.BACKLOG_QT                                                                                                               " & vbNewLine _
                                             & ",KBN7.KBN_NM2 AS DOKU_NM                                                                                                       " & vbNewLine _
                                             & "--【Notes】№728 作業項目1～5を表示(大阪のみ) START                                                                            " & vbNewLine _
                                             & ",CASE WHEN MDOUTU.DEST_NM <> ''                                     --★VB追加                                                 " & vbNewLine _
                                             & "           AND MDOUTU.DEST_NM IS NOT NULL THEN MDOUTU.DEST_NM                                                                  " & vbNewLine _
                                             & "      WHEN MC.DENPYO_NM   <> ''                                                                                                " & vbNewLine _
                                             & "           AND MC.DENPYO_NM IS NOT NULL   THEN MC.DENPYO_NM                                                                    " & vbNewLine _
                                             & "      ELSE MC.CUST_NM_L                                                                                                        " & vbNewLine _
                                             & " END                         AS ATSUKAISYA_NM                                                                                  " & vbNewLine _
                                             & "--822改変区間開始(空白挿入化)★Notes822                                                                                        " & vbNewLine _
                                             & ",'' AS SAGYO_MEI_REC_NO_1                                                                                                      " & vbNewLine _
                                             & ",'' AS SAGYO_MEI_CD_1                                                                                                          " & vbNewLine _
                                             & ",'' AS SAGYO_MEI_NM_1                                                                                                          " & vbNewLine _
                                             & ",'' AS SAGYO_MEI_REC_NO_2                                                                                                      " & vbNewLine _
                                             & ",'' AS SAGYO_MEI_CD_2                                                                                                          " & vbNewLine _
                                             & ",'' AS SAGYO_MEI_NM_2                                                                                                          " & vbNewLine _
                                             & ",'' AS SAGYO_MEI_REC_NO_3                                                                                                      " & vbNewLine _
                                             & ",'' AS SAGYO_MEI_CD_3                                                                                                          " & vbNewLine _
                                             & ",'' AS SAGYO_MEI_NM_3                                                                                                          " & vbNewLine _
                                             & ",'' AS SAGYO_MEI_REC_NO_4                                                                                                      " & vbNewLine _
                                             & ",'' AS SAGYO_MEI_CD_4                                                                                                          " & vbNewLine _
                                             & ",'' AS SAGYO_MEI_NM_4                                                                                                          " & vbNewLine _
                                             & ",'' AS SAGYO_MEI_REC_NO_5                                                                                                      " & vbNewLine _
                                             & ",'' AS SAGYO_MEI_CD_5                                                                                                          " & vbNewLine _
                                             & ",'' AS SAGYO_MEI_NM_5                                                                                                          " & vbNewLine _
                                             & "--【Notes】№728 作業項目1～5を表示(大阪のみ) END                                                                              " & vbNewLine _
                                             & "--822改変区間終了(空白挿入化)★Notes822                                                                                        " & vbNewLine _
                                             & "--2012/03/12対応開始                                                                                                           " & vbNewLine _
                                             & ",MTS.TOU_SITU_NM           AS TOU_SITU_NM                                                                                      " & vbNewLine _
                                             & ",MTS.JISYATASYA_KB         AS JISYATASYA_KB                                                                                    " & vbNewLine _
                                             & "--2012/03/12対応終了                                                                                                           " & vbNewLine _
                                             & "--出荷L                                                                                                                        " & vbNewLine _
                                             & "--【要望番号995】　2012/04/20　元着払い区分　START                                                                             " & vbNewLine _
                                             & ",KBN9.KBN_NM2 AS PC_KB_NM                                                                                                      " & vbNewLine _
                                             & "--【要望番号995】　2012/04/20　元着払い区分　 END                                                                              " & vbNewLine _
                                             & "--日医工対策開始★                                                                                                             " & vbNewLine _
                                             & ",''                       AS TORI_KB                                                                                           " & vbNewLine _
                                             & "--★追加開始2012/05/11                                                                                                         " & vbNewLine _
                                             & ",''                       AS SHIP_CD_L                                                                                         " & vbNewLine _
                                             & "--★追加終了2012/05/11                                                                                                         " & vbNewLine _
                                             & "--★削除開始2012/05/11                                                                                                         " & vbNewLine _
                                             & "--,''                       AS CHOKUSO_NM1                                                                                     " & vbNewLine _
                                             & "--,''                       AS CHOKUSO_CD                                                                                      " & vbNewLine _
                                             & "--,''                       AS HAKKO_DATE                                                                                      " & vbNewLine _
                                             & "--★削除終了2012/05/11                                                                                                         " & vbNewLine _
                                             & ",''                       AS SET_NAIYO_4                                                                                       " & vbNewLine _
                                             & ",''                       AS SET_NAIYO_5                                                                                       " & vbNewLine _
                                             & ",''                       AS SET_NAIYO_6                                                                                       " & vbNewLine _
                                             & ",''                       AS GOODS_NM_2                                                                                        " & vbNewLine _
                                             & ",''                       AS KICHO_KB                                                                                          " & vbNewLine _
                                             & ",''                       AS SEI_YURAI_KB                                                                                      " & vbNewLine _
                                             & ",''                       AS REMARK_UPPER                                                                                      " & vbNewLine _
                                             & ",''                       AS REMARK_LOWER                                                                                      " & vbNewLine _
                                             & ",''                       AS GOODS_SYUBETU                                                                                     " & vbNewLine _
                                             & ",''                       AS YUKOU_KIGEN                                                                                       " & vbNewLine _
                                             & ",''                       AS GOODS_NM_3         --2012/05/23                                                                   " & vbNewLine _
                                             & ",''                       AS EDISHIP_CD         --2012/05/23                                                                   " & vbNewLine _
                                             & ",''                       AS EDIDEST_CD         --2012/05/23                                                                   " & vbNewLine _
                                             & "--日医工対策終了★                                                                                                             " & vbNewLine _
                                             & "--(2012.06.01) 日本ﾌｧｲﾝ対応 --- START ---　                                                                                    " & vbNewLine _
                                             & ",''                       AS SET_NAIYO_FROM1                                                                                   " & vbNewLine _
                                             & ",''                       AS SET_NAIYO_FROM2                                                                                   " & vbNewLine _
                                             & ",''                       AS SET_NAIYO_FROM3                                                                                   " & vbNewLine _
                                             & "--(2012.06.01) 日本ﾌｧｲﾝ対応 ---  END  ---　                                                                                    " & vbNewLine _
                                             & "--【要望番号1122】埼玉対応 --- START ---                                                                                       " & vbNewLine _
                                             & ",''                       AS CUST_AD_3                                                                                         " & vbNewLine _
                                             & ",''                       AS DEST_REMARK                                                                                       " & vbNewLine _
                                             & ",''                       AS DEST_SALES_CD                                                                                     " & vbNewLine _
                                             & ",''                       AS DEST_SALES_NM                                                                                     " & vbNewLine _
                                             & ",''                       AS DEST_SALES_AD_1                                                                                   " & vbNewLine _
                                             & ",''                       AS DEST_SALES_AD_2                                                                                   " & vbNewLine _
                                             & ",''                       AS DEST_SALES_AD_3                                                                                   " & vbNewLine _
                                             & ",''                       AS DEST_SALES_TEL                                                                                    " & vbNewLine _
                                             & "--【要望番号1122】埼玉対応 ---  END  ---                                                                                       " & vbNewLine _
                                             & "--Notes1331  群馬対応  ---START---                                                                                             " & vbNewLine _
                                             & ",''                       AS SAGYO_RYAK_1                                                                                      " & vbNewLine _
                                             & ",''                       AS SAGYO_RYAK_2                                                                                      " & vbNewLine _
                                             & ",''                       AS SAGYO_RYAK_3                                                                                      " & vbNewLine _
                                             & ",''                       AS SAGYO_RYAK_4                                                                                      " & vbNewLine _
                                             & ",''                       AS SAGYO_RYAK_5                                                                                      " & vbNewLine _
                                             & ",''                       AS DEST_SAGYO_RYAK_1                                                                                 " & vbNewLine _
                                             & ",''                       AS DEST_SAGYO_RYAK_2                                                                                 " & vbNewLine _
                                             & ",''                       AS SZ01_YUSO                                                                                         " & vbNewLine _
                                             & ",''                       AS SZ01_UNSO                                                                                         " & vbNewLine _
                                             & ",OUTL.WH_SIJI_REMARK      AS WH_SIJI_REMARK                                                                                    " & vbNewLine _
                                             & "--Notes1331  群馬対応  --- END ---                                                                                             " & vbNewLine _
                                             & "FROM                                                                                                                           " & vbNewLine _
                                             & "$LM_TRN$..C_OUTKA_L OUTL                                                                                                       " & vbNewLine _
                                             & "--トランザクションテーブル                                                                                                     " & vbNewLine _
                                             & "--出荷M                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..C_OUTKA_M OUTM                                                                                             " & vbNewLine _
                                             & "ON  OUTM.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "AND OUTM.OUTKA_NO_L = OUTL.OUTKA_NO_L                                                                                          " & vbNewLine _
                                             & "AND OUTM.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--★★★追加開始--------------------------------                                                                                     " & vbNewLine _
                                             & "--出荷M(中MIN)                                                                                                                 " & vbNewLine _
                                             & "LEFT OUTER JOIN                                                                                                                " & vbNewLine _
                                             & "       (SELECT                                                                                                                 " & vbNewLine _
                                             & "           NRS_BR_CD                                                                                                           " & vbNewLine _
                                             & "           ,OUTKA_NO_L                                                                                                         " & vbNewLine _
                                             & "           ,MIN(OUTKA_NO_M) AS  OUTKA_NO_M                                                                                     " & vbNewLine _
                                             & "       FROM $LM_TRN$..C_OUTKA_M WHERE SYS_DEL_FLG ='0'                                                                         " & vbNewLine _
                                             & "       GROUP BY NRS_BR_CD,OUTKA_NO_L) OUTM_MIN                                                                                 " & vbNewLine _
                                             & "       ON OUTM_MIN.NRS_BR_CD        = OUTL.NRS_BR_CD                                                                           " & vbNewLine _
                                             & "       AND OUTM_MIN.OUTKA_NO_L      = OUTL.OUTKA_NO_L                                                                          " & vbNewLine _
                                             & "--出荷M(中MIN)                                                                                                                 " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..C_OUTKA_M OUTM2                                                                                            " & vbNewLine _
                                             & "ON  OUTM2.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                           " & vbNewLine _
                                             & "AND OUTM2.OUTKA_NO_L = OUTL.OUTKA_NO_L                                                                                         " & vbNewLine _
                                             & "AND OUTM2.OUTKA_NO_M = OUTM_MIN.OUTKA_NO_M                                                                                     " & vbNewLine _
                                             & "AND OUTM2.SYS_DEL_FLG = '0'                                                                                                    " & vbNewLine _
                                             & "--★★★追加終了--------------------------------                                                                                     " & vbNewLine _
                                             & "--出荷S                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..C_OUTKA_S OUTS                                                                                             " & vbNewLine _
                                             & "ON  OUTS.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "AND OUTS.OUTKA_NO_L = OUTL.OUTKA_NO_L                                                                                          " & vbNewLine _
                                             & "AND OUTS.OUTKA_NO_M = OUTM.OUTKA_NO_M                                                                                          " & vbNewLine _
                                             & "AND OUTS.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--出荷EDIL                                                                                                                     " & vbNewLine _
                                             & "--(2012.09.06)要望番号1412対応  --- START ---                                                                                  " & vbNewLine _
                                             & "--LEFT JOIN                                                                                                                    " & vbNewLine _
                                             & "--(                                                                                                                            " & vbNewLine _
                                             & "--SELECT                                                                                                                       " & vbNewLine _
                                             & "--NRS_BR_CD                                                                                                                    " & vbNewLine _
                                             & "--,OUTKA_CTL_NO                                                                                                                " & vbNewLine _
                                             & "--,CUST_CD_L                                                                                                                   " & vbNewLine _
                                             & "--,SHIP_NM_L                                                                                                                   " & vbNewLine _
                                             & "--,MIN(DEST_CD)     AS DEST_CD                                                                                                 " & vbNewLine _
                                             & "--,MIN(DEST_NM)     AS DEST_NM                                                                                                 " & vbNewLine _
                                             & "--,MIN(DEST_AD_1)   AS DEST_AD_1                                                                                               " & vbNewLine _
                                             & "--,MIN(DEST_AD_2)   AS DEST_AD_2                                                                                               " & vbNewLine _
                                             & "----(2012.04.11)【Notes】№923  DEST_JIS_CDはMINで抽出 -- START --                                                             " & vbNewLine _
                                             & "----,DEST_JIS_CD                                                                                                               " & vbNewLine _
                                             & "--,MIN(DEST_JIS_CD) AS DEST_JIS_CD                                                                                             " & vbNewLine _
                                             & "----(2012.04.11)【Notes】№923  DEST_JIS_CDはMINで抽出 --  END  --                                                             " & vbNewLine _
                                             & "--,SYS_DEL_FLG                                                                                                                 " & vbNewLine _
                                             & "--FROM                                                                                                                         " & vbNewLine _
                                             & "--$LM_TRN$..H_OUTKAEDI_L                                                                                                       " & vbNewLine _
                                             & "--GROUP BY                                                                                                                     " & vbNewLine _
                                             & "--NRS_BR_CD                                                                                                                    " & vbNewLine _
                                             & "--,OUTKA_CTL_NO                                                                                                                " & vbNewLine _
                                             & "--,CUST_CD_L                                                                                                                   " & vbNewLine _
                                             & "--,SHIP_NM_L                                                                                                                   " & vbNewLine _
                                             & "----(2012.04.11)【Notes】№923  DEST_JIS_CDはMINで抽出のためコメント -- START --                                               " & vbNewLine _
                                             & "----,DEST_JIS_CD                                                                                                               " & vbNewLine _
                                             & "----(2012.04.11)【Notes】№923  DEST_JIS_CDはMINで抽出のためコメント --  END  --                                               " & vbNewLine _
                                             & "--,SYS_DEL_FLG                                                                                                                 " & vbNewLine _
                                             & "--) EDIL                                                                                                                       " & vbNewLine _
                                             & "--ON  EDIL.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                          " & vbNewLine _
                                             & "--AND EDIL.OUTKA_CTL_NO = OUTL.OUTKA_NO_L                                                                                      " & vbNewLine _
                                             & "--AND EDIL.SYS_DEL_FLG = '0'                                                                                                   " & vbNewLine _
                                             & "--下記の内容に変更                                                                                                             " & vbNewLine _
                                             & " LEFT JOIN (                                                                                                                   " & vbNewLine _
                                             & "            SELECT                                                                                                             " & vbNewLine _
                                             & "                   NRS_BR_CD                                                                                                   " & vbNewLine _
                                             & "                 , EDI_CTL_NO                                                                                                  " & vbNewLine _
                                             & "                 , OUTKA_CTL_NO                                                                                                " & vbNewLine _
                                             & "             FROM (                                                                                                            " & vbNewLine _
                                             & "                    SELECT                                                                                                     " & vbNewLine _
                                             & "                           EDIOUTL.NRS_BR_CD                                                                                   " & vbNewLine _
                                             & "                         , EDIOUTL.EDI_CTL_NO                                                                                  " & vbNewLine _
                                             & "                         , EDIOUTL.OUTKA_CTL_NO                                                                                " & vbNewLine _
                                             & "                         , CASE WHEN EDIOUTL.OUTKA_CTL_NO = '' THEN 1                                                          " & vbNewLine _
                                             & "                           ELSE ROW_NUMBER() OVER (PARTITION BY EDIOUTL.NRS_BR_CD                                              " & vbNewLine _
                                             & "                                                              , EDIOUTL.OUTKA_CTL_NO                                           " & vbNewLine _
                                             & "                                                       ORDER BY EDIOUTL.NRS_BR_CD                                              " & vbNewLine _
                                             & "                                                              , EDIOUTL.EDI_CTL_NO                                             " & vbNewLine _
                                             & "                                                  )                                                                            " & vbNewLine _
                                             & "                           END AS IDX                                                                                          " & vbNewLine _
                                             & "                     FROM $LM_TRN$..H_OUTKAEDI_L EDIOUTL                                                                       " & vbNewLine _
                                             & "                    WHERE EDIOUTL.SYS_DEL_FLG  = '0'                                                                           " & vbNewLine _
                                             & "                      AND EDIOUTL.NRS_BR_CD    = @NRS_BR_CD                                                                    " & vbNewLine _
                                             & "                      AND EDIOUTL.OUTKA_CTL_NO = @KANRI_NO_L                                                                   " & vbNewLine _
                                             & "                  ) EBASE                                                                                                      " & vbNewLine _
                                             & "            WHERE EBASE.IDX = 1                                                                                                " & vbNewLine _
                                             & "            ) TOPEDI                                                                                                           " & vbNewLine _
                                             & "        ON TOPEDI.NRS_BR_CD    = OUTL.NRS_BR_CD                                                                                " & vbNewLine _
                                             & "       AND TOPEDI.OUTKA_CTL_NO = OUTL.OUTKA_NO_L                                                                               " & vbNewLine _
                                             & " LEFT JOIN $LM_TRN$..H_OUTKAEDI_L EDIL                                                                                         " & vbNewLine _
                                             & "        ON EDIL.NRS_BR_CD  = TOPEDI.NRS_BR_CD                                                                                  " & vbNewLine _
                                             & "       AND EDIL.EDI_CTL_NO = TOPEDI.EDI_CTL_NO                                                                                 " & vbNewLine _
                                             & "--(2012.09.06)要望番号1412対応  ---  END  ---                                                                                  " & vbNewLine _
                                             & "--入荷L                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..B_INKA_L INL                                                                                               " & vbNewLine _
                                             & "ON  INL.NRS_BR_CD = OUTS.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "AND INL.INKA_NO_L = OUTS.INKA_NO_L                                                                                             " & vbNewLine _
                                             & "AND INL.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--入荷S                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..B_INKA_S INS                                                                                               " & vbNewLine _
                                             & "ON  INS.NRS_BR_CD = OUTS.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "AND INS.INKA_NO_L = OUTS.INKA_NO_L                                                                                             " & vbNewLine _
                                             & "AND INS.INKA_NO_M = OUTS.INKA_NO_M                                                                                             " & vbNewLine _
                                             & "AND INS.INKA_NO_S = OUTS.INKA_NO_S                                                                                             " & vbNewLine _
                                             & "AND INS.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--運送L                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..F_UNSO_L UL                                                                                                " & vbNewLine _
                                             & "ON  UL.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                              " & vbNewLine _
                                             & "AND UL.INOUTKA_NO_L = OUTL.OUTKA_NO_L                                                                                          " & vbNewLine _
                                             & "AND UL.MOTO_DATA_KB = '20'                                                                                                     " & vbNewLine _
                                             & "AND UL.SYS_DEL_FLG = '0'                                                                                                       " & vbNewLine _
                                             & "--在庫テーブル                                                                                                                 " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..D_ZAI_TRS ZAI                                                                                              " & vbNewLine _
                                             & "ON  ZAI.NRS_BR_CD = OUTS.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "AND ZAI.ZAI_REC_NO = OUTS.ZAI_REC_NO                                                                                           " & vbNewLine _
                                             & "AND ZAI.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--マスタテーブル                                                                                                               " & vbNewLine _
                                             & "--営業所M                                                                                                                      " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_NRS_BR MNRS                                                                                              " & vbNewLine _
                                             & "ON MNRS.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "--商品M                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_GOODS MG                                                                                                 " & vbNewLine _
                                             & "ON  MG.NRS_BR_CD = OUTM.NRS_BR_CD                                                                                              " & vbNewLine _
                                             & "AND MG.GOODS_CD_NRS = OUTM.GOODS_CD_NRS                                                                                        " & vbNewLine _
                                             & "--★★★追加開始--------------------------------                                                                                     " & vbNewLine _
                                             & "--商品M(MIN)                                                                                                                   " & vbNewLine _
                                             & "LEFT OUTER JOIN $LM_MST$..M_GOODS M_GOODS_MIN                                                                                  " & vbNewLine _
                                             & "ON M_GOODS_MIN.NRS_BR_CD      = OUTL.NRS_BR_CD                                                                                 " & vbNewLine _
                                             & "AND M_GOODS_MIN.GOODS_CD_NRS   = OUTM2.GOODS_CD_NRS                                                                            " & vbNewLine _
                                             & "--★★★追加終了--------------------------------                                                                                     " & vbNewLine _
                                             & "--荷主M(商品M経由)                                                                                                             " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST MC                                                                                                  " & vbNewLine _
                                             & "ON  MC.NRS_BR_CD = MG.NRS_BR_CD                                                                                                " & vbNewLine _
                                             & "AND MC.CUST_CD_L = MG.CUST_CD_L                                                                                                " & vbNewLine _
                                             & "AND MC.CUST_CD_M = MG.CUST_CD_M                                                                                                " & vbNewLine _
                                             & "AND MC.CUST_CD_S = MG.CUST_CD_S                                                                                                " & vbNewLine _
                                             & "AND MC.CUST_CD_SS = MG.CUST_CD_SS                                                                                              " & vbNewLine _
                                             & "--★★★追加開始--------------------------------                                                                                     " & vbNewLine _
                                             & "--荷主M(商品M経由) 最小の出荷(中)で抽出                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST MC2                                                                                                 " & vbNewLine _
                                             & "ON  MC2.NRS_BR_CD = M_GOODS_MIN.NRS_BR_CD                                                                                      " & vbNewLine _
                                             & "AND MC2.CUST_CD_L = M_GOODS_MIN.CUST_CD_L                                                                                      " & vbNewLine _
                                             & "AND MC2.CUST_CD_M = M_GOODS_MIN.CUST_CD_M                                                                                      " & vbNewLine _
                                             & "AND MC2.CUST_CD_S = M_GOODS_MIN.CUST_CD_S                                                                                      " & vbNewLine _
                                             & "AND MC2.CUST_CD_SS = M_GOODS_MIN.CUST_CD_SS                                                                                    " & vbNewLine _
                                             & "AND MC2.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--★★★追加終了--------------------------------                                                                                     " & vbNewLine _
                                             & "--届先M(届先取得)(出荷L参照)                                                                                                   " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_DEST MDOUT                                                                                               " & vbNewLine _
                                             & "ON  MDOUT.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                           " & vbNewLine _
                                             & "AND MDOUT.CUST_CD_L = OUTL.CUST_CD_L                                                                                           " & vbNewLine _
                                             & "AND MDOUT.DEST_CD = OUTL.DEST_CD                                                                                               " & vbNewLine _
                                             & "--届先M(売上先取得)(出荷L参照)                                                                                                 " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_DEST MDOUTU                                                                                              " & vbNewLine _
                                             & "ON  MDOUTU.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                          " & vbNewLine _
                                             & "AND MDOUTU.CUST_CD_L = OUTL.CUST_CD_L                                                                                          " & vbNewLine _
                                             & "AND MDOUTU.DEST_CD = OUTL.SHIP_CD_L                                                                                            " & vbNewLine _
                                             & "--届先M(届先取得)(出荷EDIL参照)                                                                                                " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_DEST MDEDI                                                                                               " & vbNewLine _
                                             & "ON  MDEDI.NRS_BR_CD = EDIL.NRS_BR_CD                                                                                           " & vbNewLine _
                                             & "AND MDEDI.CUST_CD_L = EDIL.CUST_CD_L                                                                                           " & vbNewLine _
                                             & "AND MDEDI.DEST_CD = EDIL.DEST_CD                                                                                               " & vbNewLine _
                                             & "--運送会社M                                                                                                                    " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_UNSOCO MUCO                                                                                              " & vbNewLine _
                                             & "ON  MUCO.NRS_BR_CD = UL.NRS_BR_CD                                                                                              " & vbNewLine _
                                             & "AND MUCO.UNSOCO_CD = UL.UNSO_CD                                                                                                " & vbNewLine _
                                             & "AND MUCO.UNSOCO_BR_CD = UL.UNSO_BR_CD                                                                                          " & vbNewLine _
                                             & "--倉庫M                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_SOKO MSO                                                                                                 " & vbNewLine _
                                             & "ON  MSO.WH_CD = OUTL.WH_CD                                                                                                     " & vbNewLine _
                                             & "--2014/5/16Start s.kobayashi NotesNo.2183                                                                                      " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN11                                                                                                " & vbNewLine _
                                             & "ON  KBN11.KBN_GROUP_CD = 'U028'  --追加                                                                                        " & vbNewLine _
                                             & "AND UL.SEIQ_TARIFF_CD = KBN11.KBN_NM1                                                                                          " & vbNewLine _
                                             & "--2014/5/16End s.kobayashi NotesNo.2183                                                                                       " & vbNewLine _
                                             & "--距離程M(M_DEST.JIS < M_SOKO.JIS_CD)(出荷L参照)                                                                               " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_KYORI MKY1                                                                                               " & vbNewLine _
                                             & "ON  MKY1.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "--AND MKY1.KYORI_CD = MC.BETU_KYORI_CD                                                                                           " & vbNewLine _
                                             & "AND MKY1.KYORI_CD = (CASE ISNULL(KBN11.KBN_NM2,'') WHEN '' THEN MC.BETU_KYORI_CD ELSE KBN11.KBN_NM2 END)                       " & vbNewLine _
                                             & "AND MKY1.ORIG_JIS_CD = MDOUT.JIS                                                                                               " & vbNewLine _
                                             & "AND MKY1.DEST_JIS_CD = MSO.JIS_CD                                                                                              " & vbNewLine _
                                             & "--距離程M(M_SOKO.JIS_CD < M_DEST.JIS)(出荷L参照)                                                                               " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_KYORI MKY2                                                                                               " & vbNewLine _
                                             & "ON  MKY2.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "--AND MKY2.KYORI_CD = MC.BETU_KYORI_CD                                                                                           " & vbNewLine _
                                             & "AND MKY2.KYORI_CD = (CASE ISNULL(KBN11.KBN_NM2,'') WHEN '' THEN MC.BETU_KYORI_CD ELSE KBN11.KBN_NM2 END)                       " & vbNewLine _
                                             & "AND MKY2.ORIG_JIS_CD = MSO.JIS_CD                                                                                              " & vbNewLine _
                                             & "AND MKY2.DEST_JIS_CD = MDOUT.JIS                                                                                               " & vbNewLine _
                                             & "--距離程M(H_OUTKAEDI_L.DEST_JIS_CD < M_SOKO.JIS_CD)(出荷EDIL参照)                                                              " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_KYORI MKY3                                                                                               " & vbNewLine _
                                             & "ON  MKY3.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "--AND MKY3.KYORI_CD = MC.BETU_KYORI_CD                                                                                           " & vbNewLine _
                                             & "AND MKY3.KYORI_CD = (CASE ISNULL(KBN11.KBN_NM2,'') WHEN '' THEN MC.BETU_KYORI_CD ELSE KBN11.KBN_NM2 END)                       " & vbNewLine _
                                             & "AND MKY3.ORIG_JIS_CD = EDIL.DEST_JIS_CD                                                                                        " & vbNewLine _
                                             & "AND MKY3.DEST_JIS_CD = MSO.JIS_CD                                                                                              " & vbNewLine _
                                             & "--距離程M(M_SOKO.JIS_CD < H_OUTKAEDI_L.DEST_JIS_CD)(出荷EDIL参照)                                                              " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_KYORI MKY4                                                                                               " & vbNewLine _
                                             & "ON  MKY4.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "--AND MKY4.KYORI_CD = MC.BETU_KYORI_CD                                                                                           " & vbNewLine _
                                             & "AND MKY4.KYORI_CD = (CASE ISNULL(KBN11.KBN_NM2,'') WHEN '' THEN MC.BETU_KYORI_CD ELSE KBN11.KBN_NM2 END)                       " & vbNewLine _
                                             & "AND MKY4.ORIG_JIS_CD = MSO.JIS_CD                                                                                              " & vbNewLine _
                                             & "AND MKY4.DEST_JIS_CD = EDIL.DEST_JIS_CD                                                                                        " & vbNewLine _
                                             & "--届先商品M(出荷L参照)                                                                                                         " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_DESTGOODS MDGL                                                                                           " & vbNewLine _
                                             & "ON  MDGL.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "AND MDGL.CUST_CD_L = OUTL.CUST_CD_L                                                                                            " & vbNewLine _
                                             & "AND MDGL.CUST_CD_M = OUTL.CUST_CD_M                                                                                            " & vbNewLine _
                                             & "AND MDGL.CD = OUTL.DEST_CD                                                                                                     " & vbNewLine _
                                             & "AND MDGL.GOODS_CD_NRS = MG.GOODS_CD_NRS                                                                                        " & vbNewLine _
                                             & "AND MDGL.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--届先商品M(出荷EDI参照)                                                                                                       " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_DESTGOODS MDGE                                                                                           " & vbNewLine _
                                             & "ON  MDGE.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "AND MDGE.CUST_CD_L = OUTL.CUST_CD_L                                                                                            " & vbNewLine _
                                             & "AND MDGE.CUST_CD_M = OUTL.CUST_CD_M                                                                                            " & vbNewLine _
                                             & "AND MDGE.CD = EDIL.DEST_CD                                                                                                     " & vbNewLine _
                                             & "AND MDGE.GOODS_CD_NRS = MG.GOODS_CD_NRS                                                                                        " & vbNewLine _
                                             & "AND MDGE.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--区分M(納入予定区分)                                                                                                          " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN1                                                                                                 " & vbNewLine _
                                             & "ON  KBN1.KBN_GROUP_CD = 'N010'                                                                                                 " & vbNewLine _
                                             & "AND KBN1.KBN_CD = OUTL.ARR_PLAN_TIME                                                                                           " & vbNewLine _
                                             & "AND KBN1.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--区分M(日本合成用倉庫名)                                                                                                      " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN2                                                                                                 " & vbNewLine _
                                             & "ON  KBN2.KBN_GROUP_CD = 'P005'                                                                                                 " & vbNewLine _
                                             & "AND KBN2.KBN_CD = '00'                                                                                                         " & vbNewLine _
                                             & "AND KBN2.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--区分M(日本合成用部署名)                                                                                                      " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN3                                                                                                 " & vbNewLine _
                                             & "ON  KBN3.KBN_GROUP_CD = 'P005'                                                                                                 " & vbNewLine _
                                             & "AND KBN3.KBN_CD = '01'                                                                                                         " & vbNewLine _
                                             & "AND KBN3.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--区分M(日本合成用営業署名)                                                                                                    " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN4                                                                                                 " & vbNewLine _
                                             & "ON  KBN4.KBN_GROUP_CD = 'P005'                                                                                                 " & vbNewLine _
                                             & "AND KBN4.KBN_CD = '02'                                                                                                         " & vbNewLine _
                                             & "AND KBN4.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--区分M(荷姿)                                                                                                                  " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN5                                                                                                 " & vbNewLine _
                                             & "ON  KBN5.KBN_GROUP_CD = 'N001'                                                                                                 " & vbNewLine _
                                             & "AND KBN5.KBN_CD = MG.PKG_UT                                                                                                    " & vbNewLine _
                                             & "AND KBN5.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--明細タイトル（小分け）                                                                                                       " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN6                                                                                                 " & vbNewLine _
                                             & "ON  KBN6.KBN_GROUP_CD = 'S041'                                                                                                 " & vbNewLine _
                                             & "AND KBN6.KBN_CD = OUTM.ALCTD_KB                                                                                                " & vbNewLine _
                                             & "AND KBN6.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--区分M(毒劇区分名称)                                                                                                          " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN7                                                                                                 " & vbNewLine _
                                             & "ON  KBN7.KBN_GROUP_CD = 'G001'                                                                                                 " & vbNewLine _
                                             & "AND KBN7.KBN_CD = MG.DOKU_KB                                                                                                   " & vbNewLine _
                                             & "AND KBN7.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--【要望番号995】　2012/04/20　元着払い区分　START                                                                             " & vbNewLine _
                                             & "--区分M(元着払区分名称)                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN9                                                                                                 " & vbNewLine _
                                             & "ON  KBN9.KBN_GROUP_CD = 'M001'                                                                                                 " & vbNewLine _
                                             & "AND KBN9.KBN_CD = OUTL.PC_KB                                                                                                   " & vbNewLine _
                                             & "AND KBN9.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--【要望番号995】　2012/04/20　元着払い区分　 END                                                                              " & vbNewLine _
                                             & "--出荷Lでの荷主帳票パターン取得                                                                                                " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST_RPT MCR1                                                                                            " & vbNewLine _
                                             & "ON  OUTL.NRS_BR_CD = MCR1.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "AND OUTL.CUST_CD_L = MCR1.CUST_CD_L                                                                                            " & vbNewLine _
                                             & "AND OUTL.CUST_CD_M = MCR1.CUST_CD_M                                                                                            " & vbNewLine _
                                             & "AND '00' = MCR1.CUST_CD_S                                                                                                      " & vbNewLine _
                                             & "AND MCR1.PTN_ID = '04'                                                                                                         " & vbNewLine _
                                             & "--帳票パターン取得                                                                                                             " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_RPT MR1                                                                                                  " & vbNewLine _
                                             & "ON  MR1.NRS_BR_CD = MCR1.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "AND MR1.PTN_ID = MCR1.PTN_ID                                                                                                   " & vbNewLine _
                                             & "AND MR1.PTN_CD = MCR1.PTN_CD                                                                                                   " & vbNewLine _
                                             & "AND MR1.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--商品Mの荷主での荷主帳票パターン取得                                                                                          " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST_RPT MCR2                                                                                            " & vbNewLine _
                                             & "ON  MG.NRS_BR_CD = MCR2.NRS_BR_CD                                                                                              " & vbNewLine _
                                             & "AND MG.CUST_CD_L = MCR2.CUST_CD_L                                                                                              " & vbNewLine _
                                             & "AND MG.CUST_CD_M = MCR2.CUST_CD_M                                                                                              " & vbNewLine _
                                             & "AND MG.CUST_CD_S = MCR2.CUST_CD_S                                                                                              " & vbNewLine _
                                             & "AND MCR2.PTN_ID = '04'                                                                                                         " & vbNewLine _
                                             & "--帳票パターン取得                                                                                                             " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_RPT MR2                                                                                                  " & vbNewLine _
                                             & "ON  MR2.NRS_BR_CD = MCR2.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "AND MR2.PTN_ID = MCR2.PTN_ID                                                                                                   " & vbNewLine _
                                             & "AND MR2.PTN_CD = MCR2.PTN_CD                                                                                                   " & vbNewLine _
                                             & "AND MR2.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--存在しない場合の帳票パターン取得                                                                                             " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_RPT MR3                                                                                                  " & vbNewLine _
                                             & "ON  MR3.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "AND MR3.PTN_ID = '04'                                                                                                          " & vbNewLine _
                                             & "AND MR3.STANDARD_FLAG = '01'                                                                                                   " & vbNewLine _
                                             & "AND MR3.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--ユーザM                                                                                                                      " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..S_USER MUSER                                                                                               " & vbNewLine _
                                             & "ON MUSER.USER_CD = OUTL.SYS_ENT_USER                                                                                           " & vbNewLine _
                                             & "AND MUSER.SYS_DEL_FLG = '0'                                                                                                    " & vbNewLine _
                                             & "--商品明細M                                                                                                                    " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_GOODS_DETAILS MGD                                                                                      " & vbNewLine _
                                             & "ON  MGD.NRS_BR_CD = MG.NRS_BR_CD                                                                                               " & vbNewLine _
                                             & "AND MGD.GOODS_CD_NRS = MG.GOODS_CD_NRS                                                                                         " & vbNewLine _
                                             & "AND MGD.SUB_KB = '09'                                                                                                          " & vbNewLine _
                                             & "AND MGD.SYS_DEL_FLG = '0'       --ADD 2019/02/07 依頼番号 : 004605   【LMS】納品書がの梱包個数が2倍になるバグ修正              " & vbNewLine _
                                             & "--棟室M                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_TOU_SITU MTS                                                                                             " & vbNewLine _
                                             & "ON  OUTL.WH_CD = MTS.WH_CD                                                                                                     " & vbNewLine _
                                             & "AND OUTS.TOU_NO = MTS.TOU_NO                                                                                                   " & vbNewLine _
                                             & "AND OUTS.SITU_NO = MTS.SITU_NO                                                                                                 " & vbNewLine _
                                             & "AND MTS.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--商品状態区分名称表示☆                                                                                                       " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN8                                                                                               " & vbNewLine _
                                             & "ON  KBN8.KBN_GROUP_CD = 'S006'                                                                                               " & vbNewLine _
                                             & "AND KBN8.KBN_CD       = ZAI.GOODS_COND_KB_2                                                                                  " & vbNewLine _
                                             & "AND KBN8.SYS_DEL_FLG  = '0'                                                                                                  " & vbNewLine _
                                             & "WHERE                                                                                                                          " & vbNewLine _
                                             & "    OUTL.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "AND OUTL.NRS_BR_CD = @NRS_BR_CD                                                                                                " & vbNewLine _
                                             & "AND OUTL.OUTKA_NO_L = @KANRI_NO_L                                                                                              " & vbNewLine

    ''' <summary>
    ''' 印刷データ抽出用_緊急連絡先
    ''' </summary>
    ''' <remarks></remarks>
    Friend Const SQL_SELECT_OUTKA_SAGYO_3 As String = "--出荷テーブル                                                                                                           " & vbNewLine _
                                             & "SELECT                                                                                                                         " & vbNewLine _
                                             & " CASE WHEN MR2.PTN_CD IS NOT NULL THEN MR2.RPT_ID                                                                              " & vbNewLine _
                                             & "      WHEN MR1.PTN_CD IS NOT NULL THEN MR1.RPT_ID                                                                              " & vbNewLine _
                                             & "      ELSE MR3.RPT_ID                                                                                                          " & vbNewLine _
                                             & " END              AS RPT_ID                                                                                                    " & vbNewLine _
                                             & ",OUTL.NRS_BR_CD   AS NRS_BR_CD                                                                                                 " & vbNewLine _
                                             & ",OUTM.PRINT_SORT  AS PRINT_SORT                                                                                                " & vbNewLine _
                                             & ",CASE WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_CD                                                                     " & vbNewLine _
                                             & "      ELSE OUTL.DEST_CD                                                                                                        " & vbNewLine _
                                             & " END              AS DEST_CD                                                                                                   " & vbNewLine _
                                             & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_NM                                                                               " & vbNewLine _
                                             & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_NM                                                                     " & vbNewLine _
                                             & "      ELSE MDOUT.DEST_NM                                                                                                       " & vbNewLine _
                                             & " END              AS DEST_NM                                                                                                   " & vbNewLine _
                                             & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_AD_1                                                                             " & vbNewLine _
                                             & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_AD_1                                                                   " & vbNewLine _
                                             & "      ELSE MDOUT.AD_1                                                                                                          " & vbNewLine _
                                             & " END              AS DEST_AD_1                                                                                                 " & vbNewLine _
                                             & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_AD_2                                                                             " & vbNewLine _
                                             & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_AD_2                                                                   " & vbNewLine _
                                             & "      ELSE MDOUT.AD_2                                                                                                          " & vbNewLine _
                                             & " END              AS DEST_AD_2                                                                                                 " & vbNewLine _
                                             & ",OUTL.DEST_AD_3   AS DEST_AD_3                                                                                                 " & vbNewLine _
                                             & ",OUTL.DEST_TEL    AS DEST_TEL                                                                                                  " & vbNewLine _
                                             & ",OUTL.OUTKA_PLAN_DATE   AS OUTKA_PLAN_DATE                                                                                     " & vbNewLine _
                                             & ",OUTL.CUST_ORD_NO       AS CUST_ORD_NO                                                                                         " & vbNewLine _
                                             & ",OUTL.BUYER_ORD_NO      AS BUYER_ORD_NO                                                                                        " & vbNewLine _
                                             & ",MUCO.UNSOCO_NM         AS UNSOCO_NM                                                                                           " & vbNewLine _
                                             & ",OUTL.ARR_PLAN_DATE     AS ARR_PLAN_DATE                                                                                       " & vbNewLine _
                                             & ",KBN1.KBN_NM1           AS ARR_PLAN_TIME                                                                                       " & vbNewLine _
                                             & ",OUTL.OUTKA_NO_L        AS OUTKA_NO_L                                                                                          " & vbNewLine _
                                             & ",MDOUTU.DEST_NM         AS URIG_NM                                                                                             " & vbNewLine _
                                             & ",MC.CUST_NM_L           AS CUST_NM_L                                                                                           " & vbNewLine _
                                             & "--(2012.06.15) 要望番号1155 -- START --                                                                                        " & vbNewLine _
                                             & ",MC.CUST_NM_M           AS CUST_NM_M                                                                                           " & vbNewLine _
                                             & "--(2012.06.15) 要望番号1155 --  END  --                                                                                        " & vbNewLine _
                                             & ",MC.AD_1                AS CUST_AD_1                                                                                           " & vbNewLine _
                                             & ",MC.AD_2                AS CUST_AD_2                                                                                           " & vbNewLine _
                                             & ",MC.TEL                 AS CUST_TEL                                                                                            " & vbNewLine _
                                             & ",MC.DENPYO_NM           AS DENPYO_NM                                                                                            " & vbNewLine _
                                             & ",MNRS.NRS_BR_NM         AS NRS_BR_NM                                                                                           " & vbNewLine _
                                             & ",CASE WHEN MSO.WH_KB = '01' THEN MSO.AD_1                                                                             " & vbNewLine _
                                             & "      ELSE MNRS.AD_1                                                                                                          " & vbNewLine _
                                             & " END              AS NRS_BR_AD1                                                                                                 " & vbNewLine _
                                             & ",CASE WHEN MSO.WH_KB = '01' THEN MSO.AD_2                                                                             " & vbNewLine _
                                             & "      ELSE MNRS.AD_2                                                                                                          " & vbNewLine _
                                             & " END              AS NRS_BR_AD2                                                                                                 " & vbNewLine _
                                             & ",CASE WHEN MSO.WH_KB = '01' THEN MSO.TEL                                                                             " & vbNewLine _
                                             & "      ELSE MNRS.TEL                                                                                                          " & vbNewLine _
                                             & " END              AS NRS_BR_TEL                                                                                                 " & vbNewLine _
                                             & ",CASE WHEN MSO.WH_KB = '01' THEN MSO.FAX                                                                             " & vbNewLine _
                                             & "      ELSE MNRS.FAX                                                                                                          " & vbNewLine _
                                             & " END              AS NRS_BR_FAX                                                                                                 " & vbNewLine _
                                             & ",MUSER.USER_NM          AS PIC                                                                                                 " & vbNewLine _
                                             & ",OUTM.OUTKA_NO_M        AS OUTKA_NO_M                                                                                          " & vbNewLine _
                                             & ",OUTS.OUTKA_NO_S        AS OUTKA_NO_S                                                                                          " & vbNewLine _
                                             & ",CASE WHEN MGD.SET_NAIYO = '1' THEN ''                                                                                         " & vbNewLine _
                                             & "      WHEN INL.INKA_STATE_KB < '50' THEN INL.INKA_DATE                                                                         " & vbNewLine _
                                             & "      WHEN INL.INKA_STATE_KB >= '50' THEN ZAI.INKO_DATE                                                                        " & vbNewLine _
                                             & "      ELSE ''                                                                                                                  " & vbNewLine _
                                             & " END                    AS INKA_DATE                                                                                           " & vbNewLine _
                                             & ",ZAI.REMARK_OUT         AS REMARK_OUT                                                                                          " & vbNewLine _
                                             & ",CASE WHEN (MDGE.GOODS_NM IS NOT NULL AND MDGE.GOODS_NM <> '' AND EDIL.OUTKA_CTL_NO IS NOT NULL) THEN MDGE.GOODS_NM            " & vbNewLine _
                                             & "      WHEN (MDGL.GOODS_NM IS NOT NULL AND MDGL.GOODS_NM <> '' AND EDIL.OUTKA_CTL_NO IS NULL) THEN MDGL.GOODS_NM                " & vbNewLine _
                                             & "      ELSE MG.GOODS_NM_1                                                                                                       " & vbNewLine _
                                             & " END                    AS GOODS_NM_1                                                                                          " & vbNewLine _
                                             & ",OUTS.LOT_NO            AS LOT_NO                                                                                              " & vbNewLine _
                                             & ",OUTS.SERIAL_NO         AS SERIAL_NO                                                                                           " & vbNewLine _
                                             & ",OUTS.IRIME             AS IRIME                                                                                               " & vbNewLine _
                                             & ",MG.PKG_NB              AS PKG_NB                                                                                              " & vbNewLine _
                                             & ",OUTS.ALCTD_NB / MG.PKG_NB     AS KONSU                                                                                        " & vbNewLine _
                                             & ",OUTS.ALCTD_NB % MG.PKG_NB     AS HASU                                                                                         " & vbNewLine _
                                             & ",OUTS.ALCTD_NB          AS ALCTD_NB                                                                                            " & vbNewLine _
                                             & ",MG.PKG_UT              AS PKG_UT                                                                                              " & vbNewLine _
                                             & ",KBN5.KBN_NM1           AS PKG_UT_NM                                                                                           " & vbNewLine _
                                             & ",OUTS.ALCTD_QT          AS ALCTD_QT                                                                                            " & vbNewLine _
                                             & ",MG.STD_IRIME_UT        AS IRIME_UT                                                                                            " & vbNewLine _
                                             & "--(2012.10.01)要望番号1445 -- START --                                                                                         " & vbNewLine _
                                             & ",UL.UNSO_WT             AS WT                                                                                                  " & vbNewLine _
                                             & "--,OUTS.BETU_WT * OUTS.ALCTD_NB  AS WT                                                                                         " & vbNewLine _
                                             & "--(2012.10.01)要望番号1445 --  END  --                                                                                         " & vbNewLine _
                                             & ",0                      AS UNSO_WT                                                                                             " & vbNewLine _
                                             & ",OUTS.TOU_NO            AS TOU_NO                                                                                              " & vbNewLine _
                                             & ",OUTS.SITU_NO           AS SITU_NO                                                                                             " & vbNewLine _
                                             & ",RTRIM(OUTS.ZONE_CD)     AS ZONE_CD                                                                                             " & vbNewLine _
                                             & ",OUTS.LOCA              AS LOCA                                                                                                " & vbNewLine _
                                             & ",OUTS.ALCTD_CAN_NB / MG.PKG_NB   AS ZAN_KONSU                                                                                  " & vbNewLine _
                                             & ",OUTS.ALCTD_CAN_NB % MG.PKG_NB   AS ZAN_HASU                                                                                   " & vbNewLine _
                                             & ",MG.GOODS_CD_CUST       AS GOODS_CD_CUST                                                                                       " & vbNewLine _
                                             & ",OUTM.REMARK            AS REMARK_M                                                                                            " & vbNewLine _
                                             & "---★★★変更開始--------------------------------                                                                                     " & vbNewLine _
                                             & ",''  AS CUST_NM_S                                                                                           " & vbNewLine _
                                             & ",''   AS CUST_NM_S_H                                                                                           " & vbNewLine _
                                             & "--★★変更終了--------------------------------                                                                                     " & vbNewLine _
                                             & ",OUTM.CUST_ORD_NO_DTL   AS CUST_ORD_NO_DTL                                                                                     " & vbNewLine _
                                             & ",OUTL.REMARK            AS OUTKA_REMARK                                                                                        " & vbNewLine _
                                             & ",UL.REMARK              AS HAISOU_REMARK                                                                                       " & vbNewLine _
                                             & ",OUTL.NHS_REMARK        AS NHS_REMARK                                                                                          " & vbNewLine _
                                             & "--(2012.08.06) 発JIS、着JISが共に同じJISでも、必ず0㎞になるのを修正  --- START ---                                             " & vbNewLine _
                                             & "--,CASE WHEN (OUTL.DEST_KB = '02' AND MDEDI.KYORI > 0) THEN MDEDI.KYORI                                                        " & vbNewLine _
                                             & "--      WHEN (OUTL.DEST_KB = '02' AND MDEDI.KYORI = 0 AND EDIL.DEST_JIS_CD < MSO.JIS_CD) THEN MKY3.KYORI                       " & vbNewLine _
                                             & "--      WHEN (OUTL.DEST_KB = '02' AND MDEDI.KYORI = 0 AND MSO.JIS_CD < EDIL.DEST_JIS_CD) THEN MKY4.KYORI                       " & vbNewLine _
                                             & "--      WHEN (OUTL.DEST_KB <> '02' AND MDOUT.KYORI > 0) THEN MDOUT.KYORI                                                       " & vbNewLine _
                                             & "--      WHEN (OUTL.DEST_KB <> '02' AND MDOUT.KYORI = 0 AND MDOUT.JIS < MSO.JIS_CD) THEN MKY1.KYORI                             " & vbNewLine _
                                             & "--      WHEN (OUTL.DEST_KB <> '02' AND MDOUT.KYORI = 0 AND MSO.JIS_CD < MDOUT.JIS) THEN MKY2.KYORI                             " & vbNewLine _
                                             & "--      ELSE 0                                                                                                                 " & vbNewLine _
                                             & "-- END                  AS KYORI                                                                                               " & vbNewLine _
                                             & ",CASE WHEN (OUTL.DEST_KB = '02' AND MDEDI.KYORI > 0) THEN MDEDI.KYORI                                                          " & vbNewLine _
                                             & "      WHEN (OUTL.DEST_KB = '02' AND MDEDI.KYORI = 0 AND EDIL.DEST_JIS_CD <= MSO.JIS_CD) THEN MKY3.KYORI                        " & vbNewLine _
                                             & "      WHEN (OUTL.DEST_KB = '02' AND MDEDI.KYORI = 0 AND MSO.JIS_CD <= EDIL.DEST_JIS_CD) THEN MKY4.KYORI                        " & vbNewLine _
                                             & "      WHEN (OUTL.DEST_KB <> '02' AND MDOUT.KYORI > 0) THEN MDOUT.KYORI                                                         " & vbNewLine _
                                             & "      WHEN (OUTL.DEST_KB <> '02' AND MDOUT.KYORI = 0 AND MDOUT.JIS <= MSO.JIS_CD) THEN MKY1.KYORI                              " & vbNewLine _
                                             & "      WHEN (OUTL.DEST_KB <> '02' AND MDOUT.KYORI = 0 AND MSO.JIS_CD <= MDOUT.JIS) THEN MKY2.KYORI                              " & vbNewLine _
                                             & "      ELSE 0                                                                                                                   " & vbNewLine _
                                             & " END                    AS KYORI                                                                                               " & vbNewLine _
                                             & "--(2012.08.06) 発JIS、着JISが共に同じJISでも、必ず0㎞になるのを修正  ---  END  ---                                             " & vbNewLine _
                                             & ",OUTL.OUTKA_PKG_NB      AS OUTKA_PKG_NB_L                                                                                      " & vbNewLine _
                                             & ",KBN2.KBN_NM1           AS SOKO_NM                                                                                             " & vbNewLine _
                                             & ",KBN3.KBN_NM1           AS BUSHO_NM                                                                                            " & vbNewLine _
                                             & ",KBN4.KBN_NM1           AS NRS_BR_NM_NICHI                                                                                     " & vbNewLine _
                                             & ",OUTS.ALCTD_CAN_QT      AS ALCTD_CAN_QT                                                                                        " & vbNewLine _
                                             & ",OUTM.ALCTD_KB          AS ALCTD_KB                                                                                            " & vbNewLine _
                                             & ",'0'                    AS PTN_FLAG                                                                                            " & vbNewLine _
                                             & ",OUTL.CUST_CD_L         AS CUST_CD_L                                                                                           " & vbNewLine _
                                             & ",OUTL.ORDER_TYPE        AS ORDER_TYPE                                                                                          " & vbNewLine _
                                             & ",ZAI.LT_DATE                                                                                                                   " & vbNewLine _
                                             & ",OUTM.BUYER_ORD_NO_DTL AS BUYER_ORD_NO_DTL                                                                                     " & vbNewLine _
                                             & ",ZAI.GOODS_COND_KB_2 AS GOODS_COND_CD                                                                                          " & vbNewLine _
                                             & ",'' AS GOODS_COND_NM  --☆                                                                                        " & vbNewLine _
                                             & ",ZAI.REMARK AS REMARK_ZAI                                                                                                      " & vbNewLine _
                                             & ",KBN6.KBN_NM2 AS TITLE_SMPL                                                                                                    " & vbNewLine _
                                             & ",OUTS.ALCTD_CAN_NB AS ALCTD_CAN_NB                                                                                             " & vbNewLine _
                                             & ",OUTM.BACKLOG_QT                                                                                                               " & vbNewLine _
                                             & ",KBN7.KBN_NM2 AS DOKU_NM                                                                                                       " & vbNewLine _
                                             & ",CASE WHEN MDOUTU.DEST_NM <> ''                                           " & vbNewLine _
                                             & "           AND MDOUTU.DEST_NM IS NOT NULL THEN MDOUTU.DEST_NM                    " & vbNewLine _
                                             & "      WHEN MC.DENPYO_NM   <> ''                                       " & vbNewLine _
                                             & "           AND MC.DENPYO_NM IS NOT NULL   THEN MC.DENPYO_NM              " & vbNewLine _
                                             & "      ELSE MC.CUST_NM_L                                               " & vbNewLine _
                                             & " END                         AS ATSUKAISYA_NM                      " & vbNewLine _
                                             & " --【Notes】№728 作業項目1～5を表示(大阪のみ) START                                                                           " & vbNewLine _
                                             & "--【Notes】№728 作業項目1～5を表示(大阪のみ) START                                                                            " & vbNewLine _
                                             & ",ISNULL((SELECT BASE.SAGYO_REC_NO                                                                                              " & vbNewLine _
                                             & "FROM                                                                                                                           " & vbNewLine _
                                             & "(SELECT                                                                                                                        " & vbNewLine _
                                             & "SAGYO_REC_NO AS SAGYO_REC_NO                                                                                                   " & vbNewLine _
                                             & ",ROW_NUMBER() OVER (PARTITION BY INOUTKA_NO_LM ORDER BY INOUTKA_NO_LM) AS NUM                                                  " & vbNewLine _
                                             & "FROM $LM_TRN$..E_SAGYO E                                                                                                         " & vbNewLine _
                                             & "WHERE E.NRS_BR_CD = OUTL.NRS_BR_CD AND E.INOUTKA_NO_LM = (OUTM.OUTKA_NO_L + OUTM.OUTKA_NO_M) AND E.IOZS_KB = '21'              " & vbNewLine _
                                             & ") AS BASE                                                                                                                      " & vbNewLine _
                                             & "WHERE BASE.NUM = 1),'') AS SAGYO_MEI_REC_NO_1                                                                                  " & vbNewLine _
                                             & ",ISNULL((SELECT BASE.SAGYO_CD                                                                                                  " & vbNewLine _
                                             & "FROM                                                                                                                           " & vbNewLine _
                                             & "(SELECT                                                                                                                        " & vbNewLine _
                                             & "SAGYO_CD AS SAGYO_CD                                                                                                           " & vbNewLine _
                                             & ",ROW_NUMBER() OVER (PARTITION BY INOUTKA_NO_LM ORDER BY INOUTKA_NO_LM) AS NUM                                                  " & vbNewLine _
                                             & "FROM $LM_TRN$..E_SAGYO E                                                                                                         " & vbNewLine _
                                             & "WHERE E.NRS_BR_CD = OUTL.NRS_BR_CD AND E.INOUTKA_NO_LM = (OUTM.OUTKA_NO_L + OUTM.OUTKA_NO_M) AND E.IOZS_KB = '21'              " & vbNewLine _
                                             & ") AS BASE                                                                                                                      " & vbNewLine _
                                             & "WHERE BASE.NUM = 1),'') AS SAGYO_MEI_CD_1                                                                                      " & vbNewLine _
                                             & ",ISNULL((SELECT BASE.SAGYO_NM                                                                                                  " & vbNewLine _
                                             & "FROM                                                                                                                           " & vbNewLine _
                                             & "(SELECT                                                                                                                        " & vbNewLine _
                                             & "M_SAGYO.SAGYO_RYAK AS SAGYO_NM                                                                                                 " & vbNewLine _
                                             & ",ROW_NUMBER() OVER (PARTITION BY INOUTKA_NO_LM ORDER BY INOUTKA_NO_LM) AS NUM                                                  " & vbNewLine _
                                             & "FROM $LM_TRN$..E_SAGYO E                                                                                                         " & vbNewLine _
                                             & "       JOIN $LM_MST$..M_SAGYO M_SAGYO                                                                                            " & vbNewLine _
                                             & "         ON M_SAGYO.NRS_BR_CD = E.NRS_BR_CD                                                                                    " & vbNewLine _
                                             & "        AND M_SAGYO.SAGYO_CD  = E.SAGYO_CD                                                                                     " & vbNewLine _
                                             & "WHERE E.NRS_BR_CD = OUTL.NRS_BR_CD AND E.INOUTKA_NO_LM = (OUTM.OUTKA_NO_L + OUTM.OUTKA_NO_M) AND E.IOZS_KB = '21'              " & vbNewLine _
                                             & ") AS BASE                                                                                                                      " & vbNewLine _
                                             & "WHERE BASE.NUM = 1),'') AS SAGYO_MEI_NM_1                                                                                      " & vbNewLine _
                                             & ",ISNULL((SELECT BASE.SAGYO_REC_NO                                                                                              " & vbNewLine _
                                             & "FROM                                                                                                                           " & vbNewLine _
                                             & "(SELECT                                                                                                                        " & vbNewLine _
                                             & "SAGYO_REC_NO AS SAGYO_REC_NO                                                                                                   " & vbNewLine _
                                             & ",ROW_NUMBER() OVER (PARTITION BY INOUTKA_NO_LM ORDER BY INOUTKA_NO_LM) AS NUM                                                  " & vbNewLine _
                                             & "FROM $LM_TRN$..E_SAGYO E                                                                                                         " & vbNewLine _
                                             & "WHERE E.NRS_BR_CD = OUTL.NRS_BR_CD AND E.INOUTKA_NO_LM = (OUTM.OUTKA_NO_L + OUTM.OUTKA_NO_M) AND E.IOZS_KB = '21'              " & vbNewLine _
                                             & ") AS BASE                                                                                                                      " & vbNewLine _
                                             & "WHERE BASE.NUM = 2),'') AS SAGYO_MEI_REC_NO_2                                                                                  " & vbNewLine _
                                             & ",ISNULL((SELECT BASE.SAGYO_CD                                                                                                  " & vbNewLine _
                                             & "FROM                                                                                                                           " & vbNewLine _
                                             & "(SELECT                                                                                                                        " & vbNewLine _
                                             & "SAGYO_CD AS SAGYO_CD                                                                                                           " & vbNewLine _
                                             & ",ROW_NUMBER() OVER (PARTITION BY INOUTKA_NO_LM ORDER BY INOUTKA_NO_LM) AS NUM                                                  " & vbNewLine _
                                             & "FROM $LM_TRN$..E_SAGYO E                                                                                                         " & vbNewLine _
                                             & "WHERE E.NRS_BR_CD = OUTL.NRS_BR_CD AND E.INOUTKA_NO_LM = (OUTM.OUTKA_NO_L + OUTM.OUTKA_NO_M) AND E.IOZS_KB = '21'              " & vbNewLine _
                                             & ") AS BASE                                                                                                                      " & vbNewLine _
                                             & "WHERE BASE.NUM = 2),'') AS SAGYO_MEI_CD_2                                                                                      " & vbNewLine _
                                             & ",ISNULL((SELECT BASE.SAGYO_NM                                                                                                  " & vbNewLine _
                                             & "FROM                                                                                                                           " & vbNewLine _
                                             & "(SELECT                                                                                                                        " & vbNewLine _
                                             & "M_SAGYO.SAGYO_RYAK AS SAGYO_NM                                                                                                 " & vbNewLine _
                                             & ",ROW_NUMBER() OVER (PARTITION BY INOUTKA_NO_LM ORDER BY INOUTKA_NO_LM) AS NUM                                                  " & vbNewLine _
                                             & "FROM $LM_TRN$..E_SAGYO E                                                                                                         " & vbNewLine _
                                             & "       JOIN $LM_MST$..M_SAGYO M_SAGYO                                                                                            " & vbNewLine _
                                             & "         ON M_SAGYO.NRS_BR_CD = E.NRS_BR_CD                                                                                    " & vbNewLine _
                                             & "        AND M_SAGYO.SAGYO_CD  = E.SAGYO_CD                                                                                     " & vbNewLine _
                                             & "WHERE E.NRS_BR_CD = OUTL.NRS_BR_CD AND E.INOUTKA_NO_LM = (OUTM.OUTKA_NO_L + OUTM.OUTKA_NO_M) AND E.IOZS_KB = '21'              " & vbNewLine _
                                             & ") AS BASE                                                                                                                      " & vbNewLine _
                                             & "WHERE BASE.NUM = 2),'') AS SAGYO_MEI_NM_2                                                                                      " & vbNewLine _
                                             & ",ISNULL((SELECT BASE.SAGYO_REC_NO                                                                                              " & vbNewLine _
                                             & "FROM                                                                                                                           " & vbNewLine _
                                             & "(SELECT                                                                                                                        " & vbNewLine _
                                             & "SAGYO_REC_NO AS SAGYO_REC_NO                                                                                                   " & vbNewLine _
                                             & ",ROW_NUMBER() OVER (PARTITION BY INOUTKA_NO_LM ORDER BY INOUTKA_NO_LM) AS NUM                                                  " & vbNewLine _
                                             & "FROM $LM_TRN$..E_SAGYO E                                                                                                         " & vbNewLine _
                                             & "WHERE E.NRS_BR_CD = OUTL.NRS_BR_CD AND E.INOUTKA_NO_LM = (OUTM.OUTKA_NO_L + OUTM.OUTKA_NO_M) AND E.IOZS_KB = '21'              " & vbNewLine _
                                             & ") AS BASE                                                                                                                      " & vbNewLine _
                                             & "WHERE BASE.NUM = 3),'') AS SAGYO_MEI_REC_NO_3                                                                                  " & vbNewLine _
                                             & ",ISNULL((SELECT BASE.SAGYO_CD                                                                                                  " & vbNewLine _
                                             & "FROM                                                                                                                           " & vbNewLine _
                                             & "(SELECT                                                                                                                        " & vbNewLine _
                                             & "SAGYO_CD AS SAGYO_CD                                                                                                           " & vbNewLine _
                                             & ",ROW_NUMBER() OVER (PARTITION BY INOUTKA_NO_LM ORDER BY INOUTKA_NO_LM) AS NUM                                                  " & vbNewLine _
                                             & "FROM $LM_TRN$..E_SAGYO E                                                                                                         " & vbNewLine _
                                             & "WHERE E.NRS_BR_CD = OUTL.NRS_BR_CD AND E.INOUTKA_NO_LM = (OUTM.OUTKA_NO_L + OUTM.OUTKA_NO_M) AND E.IOZS_KB = '21'              " & vbNewLine _
                                             & ") AS BASE                                                                                                                      " & vbNewLine _
                                             & "WHERE BASE.NUM = 3),'') AS SAGYO_MEI_CD_3                                                                                      " & vbNewLine _
                                             & ",ISNULL((SELECT BASE.SAGYO_NM                                                                                                  " & vbNewLine _
                                             & "FROM                                                                                                                           " & vbNewLine _
                                             & "(SELECT                                                                                                                        " & vbNewLine _
                                             & "M_SAGYO.SAGYO_RYAK AS SAGYO_NM                                                                                                 " & vbNewLine _
                                             & ",ROW_NUMBER() OVER (PARTITION BY INOUTKA_NO_LM ORDER BY INOUTKA_NO_LM) AS NUM                                                  " & vbNewLine _
                                             & "FROM $LM_TRN$..E_SAGYO E                                                                                                         " & vbNewLine _
                                             & "       JOIN $LM_MST$..M_SAGYO M_SAGYO                                                                                            " & vbNewLine _
                                             & "         ON M_SAGYO.NRS_BR_CD = E.NRS_BR_CD                                                                                    " & vbNewLine _
                                             & "        AND M_SAGYO.SAGYO_CD  = E.SAGYO_CD                                                                                     " & vbNewLine _
                                             & "WHERE E.NRS_BR_CD = OUTL.NRS_BR_CD AND E.INOUTKA_NO_LM = (OUTM.OUTKA_NO_L + OUTM.OUTKA_NO_M) AND E.IOZS_KB = '21'              " & vbNewLine _
                                             & ") AS BASE                                                                                                                      " & vbNewLine _
                                             & "WHERE BASE.NUM = 3),'') AS SAGYO_MEI_NM_3                                                                                      " & vbNewLine _
                                             & ",ISNULL((SELECT BASE.SAGYO_REC_NO                                                                                              " & vbNewLine _
                                             & "FROM                                                                                                                           " & vbNewLine _
                                             & "(SELECT                                                                                                                        " & vbNewLine _
                                             & "SAGYO_REC_NO AS SAGYO_REC_NO                                                                                                   " & vbNewLine _
                                             & ",ROW_NUMBER() OVER (PARTITION BY INOUTKA_NO_LM ORDER BY INOUTKA_NO_LM) AS NUM                                                  " & vbNewLine _
                                             & "FROM $LM_TRN$..E_SAGYO E                                                                                                         " & vbNewLine _
                                             & "WHERE E.NRS_BR_CD = OUTL.NRS_BR_CD AND E.INOUTKA_NO_LM = (OUTM.OUTKA_NO_L + OUTM.OUTKA_NO_M) AND E.IOZS_KB = '21'              " & vbNewLine _
                                             & ") AS BASE                                                                                                                      " & vbNewLine _
                                             & "WHERE BASE.NUM = 4),'') AS SAGYO_MEI_REC_NO_4                                                                                  " & vbNewLine _
                                             & ",ISNULL((SELECT BASE.SAGYO_CD                                                                                                  " & vbNewLine _
                                             & "FROM                                                                                                                           " & vbNewLine _
                                             & "(SELECT                                                                                                                        " & vbNewLine _
                                             & "SAGYO_CD AS SAGYO_CD                                                                                                           " & vbNewLine _
                                             & ",ROW_NUMBER() OVER (PARTITION BY INOUTKA_NO_LM ORDER BY INOUTKA_NO_LM) AS NUM                                                  " & vbNewLine _
                                             & "FROM $LM_TRN$..E_SAGYO E                                                                                                         " & vbNewLine _
                                             & "WHERE E.NRS_BR_CD = OUTL.NRS_BR_CD AND E.INOUTKA_NO_LM = (OUTM.OUTKA_NO_L + OUTM.OUTKA_NO_M) AND E.IOZS_KB = '21'              " & vbNewLine _
                                             & ") AS BASE                                                                                                                      " & vbNewLine _
                                             & "WHERE BASE.NUM = 4),'') AS SAGYO_MEI_CD_4                                                                                      " & vbNewLine _
                                             & ",ISNULL((SELECT BASE.SAGYO_NM                                                                                                  " & vbNewLine _
                                             & "FROM                                                                                                                           " & vbNewLine _
                                             & "(SELECT                                                                                                                        " & vbNewLine _
                                             & "M_SAGYO.SAGYO_RYAK AS SAGYO_NM                                                                                                 " & vbNewLine _
                                             & ",ROW_NUMBER() OVER (PARTITION BY INOUTKA_NO_LM ORDER BY INOUTKA_NO_LM) AS NUM                                                  " & vbNewLine _
                                             & "FROM $LM_TRN$..E_SAGYO E                                                                                                         " & vbNewLine _
                                             & "       JOIN $LM_MST$..M_SAGYO M_SAGYO                                                                                            " & vbNewLine _
                                             & "         ON M_SAGYO.NRS_BR_CD = E.NRS_BR_CD                                                                                    " & vbNewLine _
                                             & "        AND M_SAGYO.SAGYO_CD  = E.SAGYO_CD                                                                                     " & vbNewLine _
                                             & "WHERE E.NRS_BR_CD = OUTL.NRS_BR_CD AND E.INOUTKA_NO_LM = (OUTM.OUTKA_NO_L + OUTM.OUTKA_NO_M) AND E.IOZS_KB = '21'              " & vbNewLine _
                                             & ") AS BASE                                                                                                                      " & vbNewLine _
                                             & "WHERE BASE.NUM = 4),'') AS SAGYO_MEI_NM_4                                                                                      " & vbNewLine _
                                             & ",ISNULL((SELECT BASE.SAGYO_REC_NO                                                                                              " & vbNewLine _
                                             & "FROM                                                                                                                           " & vbNewLine _
                                             & "(SELECT                                                                                                                        " & vbNewLine _
                                             & "SAGYO_REC_NO AS SAGYO_REC_NO                                                                                                   " & vbNewLine _
                                             & ",ROW_NUMBER() OVER (PARTITION BY INOUTKA_NO_LM ORDER BY INOUTKA_NO_LM) AS NUM                                                  " & vbNewLine _
                                             & "FROM $LM_TRN$..E_SAGYO E                                                                                                         " & vbNewLine _
                                             & "WHERE E.NRS_BR_CD = OUTL.NRS_BR_CD AND E.INOUTKA_NO_LM = (OUTM.OUTKA_NO_L + OUTM.OUTKA_NO_M) AND E.IOZS_KB = '21'              " & vbNewLine _
                                             & ") AS BASE                                                                                                                      " & vbNewLine _
                                             & "WHERE BASE.NUM = 5),'') AS SAGYO_MEI_REC_NO_5                                                                                  " & vbNewLine _
                                             & ",ISNULL((SELECT BASE.SAGYO_CD                                                                                                  " & vbNewLine _
                                             & "FROM                                                                                                                           " & vbNewLine _
                                             & "(SELECT                                                                                                                        " & vbNewLine _
                                             & "SAGYO_CD AS SAGYO_CD                                                                                                           " & vbNewLine _
                                             & ",ROW_NUMBER() OVER (PARTITION BY INOUTKA_NO_LM ORDER BY INOUTKA_NO_LM) AS NUM                                                  " & vbNewLine _
                                             & "FROM $LM_TRN$..E_SAGYO E                                                                                                         " & vbNewLine _
                                             & "WHERE E.NRS_BR_CD = OUTL.NRS_BR_CD AND E.INOUTKA_NO_LM = (OUTM.OUTKA_NO_L + OUTM.OUTKA_NO_M) AND E.IOZS_KB = '21'              " & vbNewLine _
                                             & ") AS BASE                                                                                                                      " & vbNewLine _
                                             & "WHERE BASE.NUM = 5),'') AS SAGYO_MEI_CD_5                                                                                      " & vbNewLine _
                                             & ",ISNULL((SELECT BASE.SAGYO_NM                                                                                                  " & vbNewLine _
                                             & "FROM                                                                                                                           " & vbNewLine _
                                             & "(SELECT                                                                                                                        " & vbNewLine _
                                             & "M_SAGYO.SAGYO_RYAK AS SAGYO_NM                                                                                                 " & vbNewLine _
                                             & ",ROW_NUMBER() OVER (PARTITION BY INOUTKA_NO_LM ORDER BY INOUTKA_NO_LM) AS NUM                                                  " & vbNewLine _
                                             & "FROM $LM_TRN$..E_SAGYO E                                                                                                         " & vbNewLine _
                                             & "       JOIN $LM_MST$..M_SAGYO M_SAGYO                                                                                            " & vbNewLine _
                                             & "         ON M_SAGYO.NRS_BR_CD = E.NRS_BR_CD                                                                                    " & vbNewLine _
                                             & "        AND M_SAGYO.SAGYO_CD  = E.SAGYO_CD                                                                                     " & vbNewLine _
                                             & "WHERE E.NRS_BR_CD = OUTL.NRS_BR_CD AND E.INOUTKA_NO_LM = (OUTM.OUTKA_NO_L + OUTM.OUTKA_NO_M) AND E.IOZS_KB = '21'              " & vbNewLine _
                                             & ") AS BASE                                                                                                                      " & vbNewLine _
                                             & "WHERE BASE.NUM = 5),'') AS SAGYO_MEI_NM_5                                                                                      " & vbNewLine _
                                             & "--【Notes】№728 作業項目1～5を表示(大阪のみ) END                                                                              " & vbNewLine _
                                             & " --【Notes】№728 作業項目1～5を表示(大阪のみ) END                                                                             " & vbNewLine _
                                             & " ,MCD.SET_NAIYO    AS MCD_SET_NAIYO               " & vbNewLine _
                                             & " ,MCD.SET_NAIYO_2  AS MCD_SET_NAIYO_2             " & vbNewLine _
                                             & " ,MCD.SET_NAIYO_3  AS MCD_SET_NAIYO_3             " & vbNewLine _
                                             & " --2012/03/14 項目追加★★★                      " & vbNewLine _
                                             & " , MTS.TOU_SITU_NM   AS TOU_SITU_NM               " & vbNewLine _
                                             & " , MTS.JISYATASYA_KB AS JISYATASYA_KB             " & vbNewLine _
                                             & " --2012/03/14 項目終了★★★                      " & vbNewLine _
                                             & "--【要望番号995】　2012/04/20　元着払い区分　START                                                                             " & vbNewLine _
                                             & ",KBN9.KBN_NM2 AS PC_KB_NM                                                                                                      " & vbNewLine _
                                             & "--【要望番号995】　2012/04/20　元着払い区分　 END                                                                              " & vbNewLine _
                                             & "--日医工対策開始★                                                                                                             " & vbNewLine _
                                             & ",''                       AS TORI_KB                                                                                           " & vbNewLine _
                                             & "--★追加開始2012/05/11                                                                                                         " & vbNewLine _
                                             & ",''                       AS SHIP_CD_L                                                                                         " & vbNewLine _
                                             & "--★追加終了2012/05/11                                                                                                         " & vbNewLine _
                                             & "--★削除開始2012/05/11                                                                                                         " & vbNewLine _
                                             & "--,''                       AS CHOKUSO_NM1                                                                                     " & vbNewLine _
                                             & "--,''                       AS CHOKUSO_CD                                                                                      " & vbNewLine _
                                             & "--,''                       AS HAKKO_DATE                                                                                      " & vbNewLine _
                                             & "--★削除終了2012/05/11                                                                                                         " & vbNewLine _
                                             & ",''                       AS SET_NAIYO_4                                                                                       " & vbNewLine _
                                             & ",''                       AS SET_NAIYO_5                                                                                       " & vbNewLine _
                                             & ",''                       AS SET_NAIYO_6                                                                                       " & vbNewLine _
                                             & ",''                       AS GOODS_NM_2                                                                                        " & vbNewLine _
                                             & ",''                       AS KICHO_KB                                                                                          " & vbNewLine _
                                             & ",''                       AS SEI_YURAI_KB                                                                                      " & vbNewLine _
                                             & ",''                       AS REMARK_UPPER                                                                                      " & vbNewLine _
                                             & ",''                       AS REMARK_LOWER                                                                                      " & vbNewLine _
                                             & ",''                       AS GOODS_SYUBETU                                                                                     " & vbNewLine _
                                             & ",''                       AS YUKOU_KIGEN                                                                                       " & vbNewLine _
                                             & ",''                       AS GOODS_NM_3         --2012/05/23                                                                   " & vbNewLine _
                                             & ",''                       AS EDISHIP_CD    --2012/05/23                                                                        " & vbNewLine _
                                             & ",''                       AS EDIDEST_CD    --2012/05/23                                                                        " & vbNewLine _
                                             & "--日医工対策終了★                                                                                                             " & vbNewLine _
                                             & "--(2012.06.01) 日本ﾌｧｲﾝ対応 --- START ---　                                                                                    " & vbNewLine _
                                             & ",''                       AS SET_NAIYO_FROM1                                                                                   " & vbNewLine _
                                             & ",''                       AS SET_NAIYO_FROM2                                                                                   " & vbNewLine _
                                             & ",''                       AS SET_NAIYO_FROM3                                                                                   " & vbNewLine _
                                             & "--(2012.06.01) 日本ﾌｧｲﾝ対応 ---  END  ---　                                                                                    " & vbNewLine _
                                             & "--【要望番号1122】埼玉対応 --- START ---                                                                                       " & vbNewLine _
                                             & ",''                       AS CUST_AD_3                                                                                         " & vbNewLine _
                                             & ",''                       AS DEST_REMARK                                                                                       " & vbNewLine _
                                             & ",''                       AS DEST_SALES_CD                                                                                     " & vbNewLine _
                                             & ",''                       AS DEST_SALES_NM                                                                                     " & vbNewLine _
                                             & ",''                       AS DEST_SALES_AD_1                                                                                   " & vbNewLine _
                                             & ",''                       AS DEST_SALES_AD_2                                                                                   " & vbNewLine _
                                             & ",''                       AS DEST_SALES_AD_3                                                                                   " & vbNewLine _
                                             & ",''                       AS DEST_SALES_TEL                                                                                    " & vbNewLine _
                                             & "--【要望番号1122】埼玉対応 ---  END  ---                                                                                       " & vbNewLine _
                                             & "--Notes1331  群馬対応 ---START---                                                                                              " & vbNewLine _
                                             & ",''                       AS SAGYO_RYAK_1                                                                                      " & vbNewLine _
                                             & ",''                       AS SAGYO_RYAK_2                                                                                      " & vbNewLine _
                                             & ",''                       AS SAGYO_RYAK_3                                                                                      " & vbNewLine _
                                             & ",''                       AS SAGYO_RYAK_4                                                                                      " & vbNewLine _
                                             & ",''                       AS SAGYO_RYAK_5                                                                                      " & vbNewLine _
                                             & ",''                       AS DEST_SAGYO_RYAK_1                                                                                 " & vbNewLine _
                                             & ",''                       AS DEST_SAGYO_RYAK_2                                                                                 " & vbNewLine _
                                             & ",''                       AS SZ01_YUSO                                                                                         " & vbNewLine _
                                             & ",''                       AS SZ01_UNSO                                                                                         " & vbNewLine _
                                             & "--Notes1331  群馬対応 --- END ---                                                                                              " & vbNewLine _
                                             & "--出荷L                                                                                                                        " & vbNewLine _
                                             & "FROM                                                                                                                           " & vbNewLine _
                                             & "$LM_TRN$..C_OUTKA_L OUTL                                                                                                       " & vbNewLine _
                                             & "--トランザクションテーブル                                                                                                     " & vbNewLine _
                                             & "--出荷M                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..C_OUTKA_M OUTM                                                                                             " & vbNewLine _
                                             & "ON  OUTM.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "AND OUTM.OUTKA_NO_L = OUTL.OUTKA_NO_L                                                                                          " & vbNewLine _
                                             & "AND OUTM.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--★★★追加開始--------------------------------                                                                               " & vbNewLine _
                                             & "--出荷M(中MIN)                                                                                                                 " & vbNewLine _
                                             & "LEFT OUTER JOIN                                                                                                                " & vbNewLine _
                                             & "       (SELECT                                                                                                                 " & vbNewLine _
                                             & "           NRS_BR_CD                                                                                                           " & vbNewLine _
                                             & "           ,OUTKA_NO_L                                                                                                         " & vbNewLine _
                                             & "           ,MIN(OUTKA_NO_M) AS  OUTKA_NO_M                                                                                     " & vbNewLine _
                                             & "       FROM $LM_TRN$..C_OUTKA_M WHERE SYS_DEL_FLG ='0'                                                                         " & vbNewLine _
                                             & "       GROUP BY NRS_BR_CD,OUTKA_NO_L) OUTM_MIN                                                                                 " & vbNewLine _
                                             & "       ON OUTM_MIN.NRS_BR_CD        = OUTL.NRS_BR_CD                                                                           " & vbNewLine _
                                             & "       AND OUTM_MIN.OUTKA_NO_L      = OUTL.OUTKA_NO_L                                                                          " & vbNewLine _
                                             & "--出荷M(中MIN)                                                                                                                 " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..C_OUTKA_M OUTM2                                                                                            " & vbNewLine _
                                             & "ON  OUTM2.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                           " & vbNewLine _
                                             & "AND OUTM2.OUTKA_NO_L = OUTL.OUTKA_NO_L                                                                                         " & vbNewLine _
                                             & "AND OUTM2.OUTKA_NO_M = OUTM_MIN.OUTKA_NO_M                                                                                     " & vbNewLine _
                                             & "AND OUTM2.SYS_DEL_FLG = '0'                                                                                                    " & vbNewLine _
                                             & "--★★★追加終了--------------------------------                                                                                     " & vbNewLine _
                                             & "--出荷S                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..C_OUTKA_S OUTS                                                                                             " & vbNewLine _
                                             & "ON  OUTS.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "AND OUTS.OUTKA_NO_L = OUTL.OUTKA_NO_L                                                                                          " & vbNewLine _
                                             & "AND OUTS.OUTKA_NO_M = OUTM.OUTKA_NO_M                                                                                          " & vbNewLine _
                                             & "AND OUTS.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--出荷EDIL                                                                                                                     " & vbNewLine _
                                             & "--(2012.09.06)要望番号1412対応  --- START ---                                                                                  " & vbNewLine _
                                             & "--LEFT JOIN                                                                                                                    " & vbNewLine _
                                             & "--(                                                                                                                            " & vbNewLine _
                                             & "--SELECT                                                                                                                       " & vbNewLine _
                                             & "--NRS_BR_CD                                                                                                                    " & vbNewLine _
                                             & "--,OUTKA_CTL_NO                                                                                                                " & vbNewLine _
                                             & "--,CUST_CD_L                                                                                                                   " & vbNewLine _
                                             & "--,SHIP_NM_L                                                                                                                   " & vbNewLine _
                                             & "--,MIN(DEST_CD)     AS DEST_CD                                                                                                 " & vbNewLine _
                                             & "--,MIN(DEST_NM)     AS DEST_NM                                                                                                 " & vbNewLine _
                                             & "--,MIN(DEST_AD_1)   AS DEST_AD_1                                                                                               " & vbNewLine _
                                             & "--,MIN(DEST_AD_2)   AS DEST_AD_2                                                                                               " & vbNewLine _
                                             & "----(2012.04.11)【Notes】№923  DEST_JIS_CDはMINで抽出 -- START --                                                             " & vbNewLine _
                                             & "----,DEST_JIS_CD                                                                                                               " & vbNewLine _
                                             & "--,MIN(DEST_JIS_CD) AS DEST_JIS_CD                                                                                             " & vbNewLine _
                                             & "----(2012.04.11)【Notes】№923  DEST_JIS_CDはMINで抽出 --  END  --                                                             " & vbNewLine _
                                             & "--,SYS_DEL_FLG                                                                                                                 " & vbNewLine _
                                             & "--FROM                                                                                                                         " & vbNewLine _
                                             & "--$LM_TRN$..H_OUTKAEDI_L                                                                                                       " & vbNewLine _
                                             & "--GROUP BY                                                                                                                     " & vbNewLine _
                                             & "--NRS_BR_CD                                                                                                                    " & vbNewLine _
                                             & "--,OUTKA_CTL_NO                                                                                                                " & vbNewLine _
                                             & "--,CUST_CD_L                                                                                                                   " & vbNewLine _
                                             & "--,SHIP_NM_L                                                                                                                   " & vbNewLine _
                                             & "----(2012.04.11)【Notes】№923  DEST_JIS_CDはMINで抽出のためコメント -- START --                                               " & vbNewLine _
                                             & "----,DEST_JIS_CD                                                                                                               " & vbNewLine _
                                             & "----(2012.04.11)【Notes】№923  DEST_JIS_CDはMINで抽出のためコメント --  END  --                                               " & vbNewLine _
                                             & "--,SYS_DEL_FLG                                                                                                                 " & vbNewLine _
                                             & "--) EDIL                                                                                                                       " & vbNewLine _
                                             & "--ON  EDIL.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                          " & vbNewLine _
                                             & "--AND EDIL.OUTKA_CTL_NO = OUTL.OUTKA_NO_L                                                                                      " & vbNewLine _
                                             & "--AND EDIL.SYS_DEL_FLG = '0'                                                                                                   " & vbNewLine _
                                             & "--下記の内容に変更                                                                                                             " & vbNewLine _
                                             & " LEFT JOIN (                                                                                                                   " & vbNewLine _
                                             & "            SELECT                                                                                                             " & vbNewLine _
                                             & "                   NRS_BR_CD                                                                                                   " & vbNewLine _
                                             & "                 , EDI_CTL_NO                                                                                                  " & vbNewLine _
                                             & "                 , OUTKA_CTL_NO                                                                                                " & vbNewLine _
                                             & "             FROM (                                                                                                            " & vbNewLine _
                                             & "                    SELECT                                                                                                     " & vbNewLine _
                                             & "                           EDIOUTL.NRS_BR_CD                                                                                   " & vbNewLine _
                                             & "                         , EDIOUTL.EDI_CTL_NO                                                                                  " & vbNewLine _
                                             & "                         , EDIOUTL.OUTKA_CTL_NO                                                                                " & vbNewLine _
                                             & "                         , CASE WHEN EDIOUTL.OUTKA_CTL_NO = '' THEN 1                                                          " & vbNewLine _
                                             & "                           ELSE ROW_NUMBER() OVER (PARTITION BY EDIOUTL.NRS_BR_CD                                              " & vbNewLine _
                                             & "                                                              , EDIOUTL.OUTKA_CTL_NO                                           " & vbNewLine _
                                             & "                                                       ORDER BY EDIOUTL.NRS_BR_CD                                              " & vbNewLine _
                                             & "                                                              , EDIOUTL.EDI_CTL_NO                                             " & vbNewLine _
                                             & "                                                  )                                                                            " & vbNewLine _
                                             & "                           END AS IDX                                                                                          " & vbNewLine _
                                             & "                     FROM $LM_TRN$..H_OUTKAEDI_L EDIOUTL                                                                       " & vbNewLine _
                                             & "                    WHERE EDIOUTL.SYS_DEL_FLG  = '0'                                                                           " & vbNewLine _
                                             & "                      AND EDIOUTL.NRS_BR_CD    = @NRS_BR_CD                                                                    " & vbNewLine _
                                             & "                      AND EDIOUTL.OUTKA_CTL_NO = @KANRI_NO_L                                                                   " & vbNewLine _
                                             & "                  ) EBASE                                                                                                      " & vbNewLine _
                                             & "            WHERE EBASE.IDX = 1                                                                                                " & vbNewLine _
                                             & "            ) TOPEDI                                                                                                           " & vbNewLine _
                                             & "        ON TOPEDI.NRS_BR_CD    = OUTL.NRS_BR_CD                                                                                " & vbNewLine _
                                             & "       AND TOPEDI.OUTKA_CTL_NO = OUTL.OUTKA_NO_L                                                                               " & vbNewLine _
                                             & " LEFT JOIN $LM_TRN$..H_OUTKAEDI_L EDIL                                                                                         " & vbNewLine _
                                             & "        ON EDIL.NRS_BR_CD  = TOPEDI.NRS_BR_CD                                                                                  " & vbNewLine _
                                             & "       AND EDIL.EDI_CTL_NO = TOPEDI.EDI_CTL_NO                                                                                 " & vbNewLine _
                                             & "--(2012.09.06)要望番号1412対応  ---  END  ---                                                                                  " & vbNewLine _
                                             & "--入荷L                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..B_INKA_L INL                                                                                               " & vbNewLine _
                                             & "ON  INL.NRS_BR_CD = OUTS.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "AND INL.INKA_NO_L = OUTS.INKA_NO_L                                                                                             " & vbNewLine _
                                             & "AND INL.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--入荷S                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..B_INKA_S INS                                                                                               " & vbNewLine _
                                             & "ON  INS.NRS_BR_CD = OUTS.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "AND INS.INKA_NO_L = OUTS.INKA_NO_L                                                                                             " & vbNewLine _
                                             & "AND INS.INKA_NO_M = OUTS.INKA_NO_M                                                                                             " & vbNewLine _
                                             & "AND INS.INKA_NO_S = OUTS.INKA_NO_S                                                                                             " & vbNewLine _
                                             & "AND INS.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--運送L                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..F_UNSO_L UL                                                                                                " & vbNewLine _
                                             & "ON  UL.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                              " & vbNewLine _
                                             & "AND UL.INOUTKA_NO_L = OUTL.OUTKA_NO_L                                                                                          " & vbNewLine _
                                             & "AND UL.MOTO_DATA_KB = '20'                                                                                                     " & vbNewLine _
                                             & "AND UL.SYS_DEL_FLG = '0'                                                                                                       " & vbNewLine _
                                             & "--在庫テーブル                                                                                                                 " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..D_ZAI_TRS ZAI                                                                                              " & vbNewLine _
                                             & "ON  ZAI.NRS_BR_CD = OUTS.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "AND ZAI.ZAI_REC_NO = OUTS.ZAI_REC_NO                                                                                           " & vbNewLine _
                                             & "AND ZAI.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--マスタテーブル                                                                                                               " & vbNewLine _
                                             & "--営業所M                                                                                                                      " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_NRS_BR MNRS                                                                                              " & vbNewLine _
                                             & "ON MNRS.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "--商品M                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_GOODS MG                                                                                                 " & vbNewLine _
                                             & "ON  MG.NRS_BR_CD = OUTM.NRS_BR_CD                                                                                              " & vbNewLine _
                                             & "AND MG.GOODS_CD_NRS = OUTM.GOODS_CD_NRS                                                                                        " & vbNewLine _
                                             & "--★★★追加開始--------------------------------                                                                                     " & vbNewLine _
                                             & "--商品M(MIN)                                                                                                                   " & vbNewLine _
                                             & "LEFT OUTER JOIN $LM_MST$..M_GOODS M_GOODS_MIN                                                                                  " & vbNewLine _
                                             & "ON M_GOODS_MIN.NRS_BR_CD      = OUTL.NRS_BR_CD                                                                                 " & vbNewLine _
                                             & "AND M_GOODS_MIN.GOODS_CD_NRS   = OUTM2.GOODS_CD_NRS                                                                            " & vbNewLine _
                                             & "--★★★追加終了--------------------------------                                                                                     " & vbNewLine _
                                             & "--荷主M(商品M経由)                                                                                                             " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST MC                                                                                                  " & vbNewLine _
                                             & "ON  MC.NRS_BR_CD = MG.NRS_BR_CD                                                                                                " & vbNewLine _
                                             & "AND MC.CUST_CD_L = MG.CUST_CD_L                                                                                                " & vbNewLine _
                                             & "AND MC.CUST_CD_M = MG.CUST_CD_M                                                                                                " & vbNewLine _
                                             & "AND MC.CUST_CD_S = MG.CUST_CD_S                                                                                                " & vbNewLine _
                                             & "AND MC.CUST_CD_SS = MG.CUST_CD_SS                                                                                              " & vbNewLine _
                                             & "--★★★追加開始--------------------------------                                                                                     " & vbNewLine _
                                             & "--荷主M(商品M経由) 最小の出荷(中)で抽出                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST MC2                                                                                                 " & vbNewLine _
                                             & "ON  MC2.NRS_BR_CD = M_GOODS_MIN.NRS_BR_CD                                                                                      " & vbNewLine _
                                             & "AND MC2.CUST_CD_L = M_GOODS_MIN.CUST_CD_L                                                                                      " & vbNewLine _
                                             & "AND MC2.CUST_CD_M = M_GOODS_MIN.CUST_CD_M                                                                                      " & vbNewLine _
                                             & "AND MC2.CUST_CD_S = M_GOODS_MIN.CUST_CD_S                                                                                      " & vbNewLine _
                                             & "AND MC2.CUST_CD_SS = M_GOODS_MIN.CUST_CD_SS                                                                                    " & vbNewLine _
                                             & "AND MC2.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--★★★追加終了--------------------------------                                                                                     " & vbNewLine _
                                             & "--届先M(届先取得)(出荷L参照)                                                                                                   " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_DEST MDOUT                                                                                               " & vbNewLine _
                                             & "ON  MDOUT.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                           " & vbNewLine _
                                             & "AND MDOUT.CUST_CD_L = OUTL.CUST_CD_L                                                                                           " & vbNewLine _
                                             & "AND MDOUT.DEST_CD = OUTL.DEST_CD                                                                                               " & vbNewLine _
                                             & "--届先M(売上先取得)(出荷L参照)                                                                                                 " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_DEST MDOUTU                                                                                              " & vbNewLine _
                                             & "ON  MDOUTU.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                          " & vbNewLine _
                                             & "AND MDOUTU.CUST_CD_L = OUTL.CUST_CD_L                                                                                          " & vbNewLine _
                                             & "AND MDOUTU.DEST_CD = OUTL.SHIP_CD_L                                                                                            " & vbNewLine _
                                             & "--届先M(届先取得)(出荷EDIL参照)                                                                                                " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_DEST MDEDI                                                                                               " & vbNewLine _
                                             & "ON  MDEDI.NRS_BR_CD = EDIL.NRS_BR_CD                                                                                           " & vbNewLine _
                                             & "AND MDEDI.CUST_CD_L = EDIL.CUST_CD_L                                                                                           " & vbNewLine _
                                             & "AND MDEDI.DEST_CD = EDIL.DEST_CD                                                                                               " & vbNewLine _
                                             & "--運送会社M                                                                                                                    " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_UNSOCO MUCO                                                                                              " & vbNewLine _
                                             & "ON  MUCO.NRS_BR_CD = UL.NRS_BR_CD                                                                                              " & vbNewLine _
                                             & "AND MUCO.UNSOCO_CD = UL.UNSO_CD                                                                                                " & vbNewLine _
                                             & "AND MUCO.UNSOCO_BR_CD = UL.UNSO_BR_CD                                                                                          " & vbNewLine _
                                             & "--倉庫M                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_SOKO MSO                                                                                                 " & vbNewLine _
                                             & "ON  MSO.WH_CD = OUTL.WH_CD                                                                                                     " & vbNewLine _
                                             & "--2014/5/16Start s.kobayashi NotesNo.2183                                                                                      " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN11                                                                                                " & vbNewLine _
                                             & "ON  KBN11.KBN_GROUP_CD = 'U028'  --追加                                                                                        " & vbNewLine _
                                             & "AND UL.SEIQ_TARIFF_CD = KBN11.KBN_NM1                                                                                          " & vbNewLine _
                                             & "--2014/5/16End s.kobayashi NotesNo.2183                                                                                       " & vbNewLine _
                                             & "--距離程M(M_DEST.JIS < M_SOKO.JIS_CD)(出荷L参照)                                                                               " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_KYORI MKY1                                                                                               " & vbNewLine _
                                             & "ON  MKY1.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "--AND MKY1.KYORI_CD = MC.BETU_KYORI_CD                                                                                           " & vbNewLine _
                                             & "AND MKY1.KYORI_CD = (CASE ISNULL(KBN11.KBN_NM2,'') WHEN '' THEN MC.BETU_KYORI_CD ELSE KBN11.KBN_NM2 END)                       " & vbNewLine _
                                             & "AND MKY1.ORIG_JIS_CD = MDOUT.JIS                                                                                               " & vbNewLine _
                                             & "AND MKY1.DEST_JIS_CD = MSO.JIS_CD                                                                                              " & vbNewLine _
                                             & "--距離程M(M_SOKO.JIS_CD < M_DEST.JIS)(出荷L参照)                                                                               " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_KYORI MKY2                                                                                               " & vbNewLine _
                                             & "ON  MKY2.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "--AND MKY2.KYORI_CD = MC.BETU_KYORI_CD                                                                                           " & vbNewLine _
                                             & "AND MKY2.KYORI_CD = (CASE ISNULL(KBN11.KBN_NM2,'') WHEN '' THEN MC.BETU_KYORI_CD ELSE KBN11.KBN_NM2 END)                       " & vbNewLine _
                                             & "AND MKY2.ORIG_JIS_CD = MSO.JIS_CD                                                                                              " & vbNewLine _
                                             & "AND MKY2.DEST_JIS_CD = MDOUT.JIS                                                                                               " & vbNewLine _
                                             & "--距離程M(H_OUTKAEDI_L.DEST_JIS_CD < M_SOKO.JIS_CD)(出荷EDIL参照)                                                              " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_KYORI MKY3                                                                                               " & vbNewLine _
                                             & "ON  MKY3.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "--AND MKY3.KYORI_CD = MC.BETU_KYORI_CD                                                                                           " & vbNewLine _
                                             & "AND MKY3.KYORI_CD = (CASE ISNULL(KBN11.KBN_NM2,'') WHEN '' THEN MC.BETU_KYORI_CD ELSE KBN11.KBN_NM2 END)                       " & vbNewLine _
                                             & "AND MKY3.ORIG_JIS_CD = EDIL.DEST_JIS_CD                                                                                        " & vbNewLine _
                                             & "AND MKY3.DEST_JIS_CD = MSO.JIS_CD                                                                                              " & vbNewLine _
                                             & "--距離程M(M_SOKO.JIS_CD < H_OUTKAEDI_L.DEST_JIS_CD)(出荷EDIL参照)                                                              " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_KYORI MKY4                                                                                               " & vbNewLine _
                                             & "ON  MKY4.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "--AND MKY4.KYORI_CD = MC.BETU_KYORI_CD                                                                                           " & vbNewLine _
                                             & "AND MKY4.KYORI_CD = (CASE ISNULL(KBN11.KBN_NM2,'') WHEN '' THEN MC.BETU_KYORI_CD ELSE KBN11.KBN_NM2 END)                       " & vbNewLine _
                                             & "AND MKY4.ORIG_JIS_CD = MSO.JIS_CD                                                                                              " & vbNewLine _
                                             & "AND MKY4.DEST_JIS_CD = EDIL.DEST_JIS_CD                                                                                        " & vbNewLine _
                                             & "--届先商品M(出荷L参照)                                                                                                         " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_DESTGOODS MDGL                                                                                           " & vbNewLine _
                                             & "ON  MDGL.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "AND MDGL.CUST_CD_L = OUTL.CUST_CD_L                                                                                            " & vbNewLine _
                                             & "AND MDGL.CUST_CD_M = OUTL.CUST_CD_M                                                                                            " & vbNewLine _
                                             & "AND MDGL.CD = OUTL.DEST_CD                                                                                                     " & vbNewLine _
                                             & "AND MDGL.GOODS_CD_NRS = MG.GOODS_CD_NRS                                                                                        " & vbNewLine _
                                             & "AND MDGL.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--届先商品M(出荷EDI参照)                                                                                                       " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_DESTGOODS MDGE                                                                                           " & vbNewLine _
                                             & "ON  MDGE.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "AND MDGE.CUST_CD_L = OUTL.CUST_CD_L                                                                                            " & vbNewLine _
                                             & "AND MDGE.CUST_CD_M = OUTL.CUST_CD_M                                                                                            " & vbNewLine _
                                             & "AND MDGE.CD = EDIL.DEST_CD                                                                                                     " & vbNewLine _
                                             & "AND MDGE.GOODS_CD_NRS = MG.GOODS_CD_NRS                                                                                        " & vbNewLine _
                                             & "AND MDGE.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--区分M(納入予定区分)                                                                                                          " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN1                                                                                                 " & vbNewLine _
                                             & "ON  KBN1.KBN_GROUP_CD = 'N010'                                                                                                 " & vbNewLine _
                                             & "AND KBN1.KBN_CD = OUTL.ARR_PLAN_TIME                                                                                           " & vbNewLine _
                                             & "AND KBN1.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--区分M(日本合成用倉庫名)                                                                                                      " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN2                                                                                                 " & vbNewLine _
                                             & "ON  KBN2.KBN_GROUP_CD = 'P005'                                                                                                 " & vbNewLine _
                                             & "AND KBN2.KBN_CD = '00'                                                                                                         " & vbNewLine _
                                             & "AND KBN2.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--区分M(日本合成用部署名)                                                                                                      " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN3                                                                                                 " & vbNewLine _
                                             & "ON  KBN3.KBN_GROUP_CD = 'P005'                                                                                                 " & vbNewLine _
                                             & "AND KBN3.KBN_CD = '01'                                                                                                         " & vbNewLine _
                                             & "AND KBN3.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--区分M(日本合成用営業署名)                                                                                                    " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN4                                                                                                 " & vbNewLine _
                                             & "ON  KBN4.KBN_GROUP_CD = 'P005'                                                                                                 " & vbNewLine _
                                             & "AND KBN4.KBN_CD = '02'                                                                                                         " & vbNewLine _
                                             & "AND KBN4.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--区分M(荷姿)                                                                                                                  " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN5                                                                                                 " & vbNewLine _
                                             & "ON  KBN5.KBN_GROUP_CD = 'N001'                                                                                                 " & vbNewLine _
                                             & "AND KBN5.KBN_CD = MG.PKG_UT                                                                                                    " & vbNewLine _
                                             & "AND KBN5.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--明細タイトル（小分け）                                                                                                       " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN6                                                                                                 " & vbNewLine _
                                             & "ON  KBN6.KBN_GROUP_CD = 'S041'                                                                                                 " & vbNewLine _
                                             & "AND KBN6.KBN_CD = OUTM.ALCTD_KB                                                                                                " & vbNewLine _
                                             & "AND KBN6.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--区分M(毒劇区分名称)                                                                                                           " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN7                                                                                                  " & vbNewLine _
                                             & "ON  KBN7.KBN_GROUP_CD = 'G001'                                                                                                  " & vbNewLine _
                                             & "AND KBN7.KBN_CD = MG.DOKU_KB                                                                                                    " & vbNewLine _
                                             & "AND KBN7.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--【要望番号995】　2012/04/20　元着払い区分　START                                                                             " & vbNewLine _
                                             & "--区分M(元着払区分名称)                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN9                                                                                                 " & vbNewLine _
                                             & "ON  KBN9.KBN_GROUP_CD = 'M001'                                                                                                 " & vbNewLine _
                                             & "AND KBN9.KBN_CD = OUTL.PC_KB                                                                                                   " & vbNewLine _
                                             & "AND KBN9.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--【要望番号995】　2012/04/20　元着払い区分　 END                                                                              " & vbNewLine _
                                             & "--出荷Lでの荷主帳票パターン取得                                                                                                " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST_RPT MCR1                                                                                            " & vbNewLine _
                                             & "ON  OUTL.NRS_BR_CD = MCR1.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "AND OUTL.CUST_CD_L = MCR1.CUST_CD_L                                                                                            " & vbNewLine _
                                             & "AND OUTL.CUST_CD_M = MCR1.CUST_CD_M                                                                                            " & vbNewLine _
                                             & "AND '00' = MCR1.CUST_CD_S                                                                                                      " & vbNewLine _
                                             & "AND MCR1.PTN_ID = '04'                                                                                                         " & vbNewLine _
                                             & "--帳票パターン取得                                                                                                             " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_RPT MR1                                                                                                  " & vbNewLine _
                                             & "ON  MR1.NRS_BR_CD = MCR1.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "AND MR1.PTN_ID = MCR1.PTN_ID                                                                                                   " & vbNewLine _
                                             & "AND MR1.PTN_CD = MCR1.PTN_CD                                                                                                   " & vbNewLine _
                                             & "AND MR1.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--商品Mの荷主での荷主帳票パターン取得                                                                                          " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST_RPT MCR2                                                                                            " & vbNewLine _
                                             & "ON  MG.NRS_BR_CD = MCR2.NRS_BR_CD                                                                                              " & vbNewLine _
                                             & "AND MG.CUST_CD_L = MCR2.CUST_CD_L                                                                                              " & vbNewLine _
                                             & "AND MG.CUST_CD_M = MCR2.CUST_CD_M                                                                                              " & vbNewLine _
                                             & "AND MG.CUST_CD_S = MCR2.CUST_CD_S                                                                                              " & vbNewLine _
                                             & "AND MCR2.PTN_ID = '04'                                                                                                         " & vbNewLine _
                                             & "--帳票パターン取得                                                                                                             " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_RPT MR2                                                                                                  " & vbNewLine _
                                             & "ON  MR2.NRS_BR_CD = MCR2.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "AND MR2.PTN_ID = MCR2.PTN_ID                                                                                                   " & vbNewLine _
                                             & "AND MR2.PTN_CD = MCR2.PTN_CD                                                                                                   " & vbNewLine _
                                             & "AND MR2.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--存在しない場合の帳票パターン取得                                                                                             " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_RPT MR3                                                                                                  " & vbNewLine _
                                             & "ON  MR3.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "AND MR3.PTN_ID = '04'                                                                                                          " & vbNewLine _
                                             & "AND MR3.STANDARD_FLAG = '01'                                                                                                   " & vbNewLine _
                                             & "AND MR3.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--ユーザM                                                                                                                      " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..S_USER MUSER                                                                                               " & vbNewLine _
                                             & "ON MUSER.USER_CD = OUTL.SYS_ENT_USER                                                                                           " & vbNewLine _
                                             & "AND MUSER.SYS_DEL_FLG = '0'                                                                                                    " & vbNewLine _
                                             & "--商品明細M                                                                                                                    " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_GOODS_DETAILS MGD                                                                                        " & vbNewLine _
                                             & "ON  MGD.NRS_BR_CD = MG.NRS_BR_CD                                                                                               " & vbNewLine _
                                             & "AND MGD.GOODS_CD_NRS = MG.GOODS_CD_NRS                                                                                         " & vbNewLine _
                                             & "AND MGD.SUB_KB = '09'                                                                                                          " & vbNewLine _
                                             & "AND MGD.SYS_DEL_FLG = '0'       --ADD 2019/02/07 依頼番号 : 004605   【LMS】納品書がの梱包個数が2倍になるバグ修正              " & vbNewLine _
                                             & "--荷主明細M ★                                                                                                                   " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST_DETAILS MCD                                                                                         " & vbNewLine _
                                             & "ON  MCD.NRS_BR_CD = MG.NRS_BR_CD                                                                                               " & vbNewLine _
                                             & "AND MCD.CUST_CD   = MG.CUST_CD_L                                                                                         " & vbNewLine _
                                             & "AND MCD.SUB_KB = '20'                                                                                                             " & vbNewLine _
                                             & "--棟室M                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_TOU_SITU MTS                                                                                             " & vbNewLine _
                                             & "ON  OUTL.WH_CD = MTS.WH_CD                                                                                                     " & vbNewLine _
                                             & "AND OUTS.TOU_NO = MTS.TOU_NO                                                                                                   " & vbNewLine _
                                             & "AND OUTS.SITU_NO = MTS.SITU_NO                                                                                                 " & vbNewLine _
                                             & "AND MTS.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "WHERE                                                                                                                          " & vbNewLine _
                                             & "    OUTL.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "AND OUTL.NRS_BR_CD = @NRS_BR_CD                                                                                                " & vbNewLine _
                                             & "AND OUTL.OUTKA_NO_L = @KANRI_NO_L                                                                                              " & vbNewLine



    ''' <summary>
    ''' 印刷データ抽出用(出荷テーブル)
    ''' </summary>
    ''' <remarks></remarks>
    Friend Const SQL_SELECT_OUTKA_621 As String = "--★★★SQL_SELECT_OUTKA_621★★★  出荷テーブル                                                                           " & vbNewLine _
                                             & "SELECT                                                                                                                         " & vbNewLine _
                                             & " CASE WHEN MR2.PTN_CD IS NOT NULL THEN MR2.RPT_ID                                                                              " & vbNewLine _
                                             & "      WHEN MR1.PTN_CD IS NOT NULL THEN MR1.RPT_ID                                                                              " & vbNewLine _
                                             & "      ELSE MR3.RPT_ID                                                                                                          " & vbNewLine _
                                             & " END              AS RPT_ID                                                                                                    " & vbNewLine _
                                             & ",OUTL.NRS_BR_CD   AS NRS_BR_CD                                                                                                 " & vbNewLine _
                                             & ",OUTM.PRINT_SORT  AS PRINT_SORT                                                                                                " & vbNewLine _
                                             & ",CASE WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_CD                                                                     " & vbNewLine _
                                             & "      ELSE OUTL.DEST_CD                                                                                                        " & vbNewLine _
                                             & " END              AS DEST_CD                                                                                                   " & vbNewLine _
                                             & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_NM                                                                               " & vbNewLine _
                                             & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_NM                                                                     " & vbNewLine _
                                             & "      ELSE MDOUT.DEST_NM                                                                                                       " & vbNewLine _
                                             & " END              AS DEST_NM                                                                                                   " & vbNewLine _
                                             & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_AD_1                                                                             " & vbNewLine _
                                             & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_AD_1                                                                   " & vbNewLine _
                                             & "      ELSE MDOUT.AD_1                                                                                                          " & vbNewLine _
                                             & " END              AS DEST_AD_1                                                                                                 " & vbNewLine _
                                             & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_AD_2                                                                             " & vbNewLine _
                                             & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_AD_2                                                                   " & vbNewLine _
                                             & "      ELSE MDOUT.AD_2                                                                                                          " & vbNewLine _
                                             & " END              AS DEST_AD_2                                                                                                 " & vbNewLine _
                                             & ",OUTL.DEST_AD_3   AS DEST_AD_3                                                                                                 " & vbNewLine _
                                             & ",OUTL.DEST_TEL    AS DEST_TEL                                                                                                  " & vbNewLine _
                                             & ",OUTL.OUTKA_PLAN_DATE   AS OUTKA_PLAN_DATE                                                                                     " & vbNewLine _
                                             & ",OUTL.CUST_ORD_NO       AS CUST_ORD_NO                                                                                         " & vbNewLine _
                                             & ",OUTL.BUYER_ORD_NO      AS BUYER_ORD_NO                                                                                        " & vbNewLine _
                                             & ",MUCO.UNSOCO_NM         AS UNSOCO_NM                                                                                           " & vbNewLine _
                                             & ",OUTL.ARR_PLAN_DATE     AS ARR_PLAN_DATE                                                                                       " & vbNewLine _
                                             & ",KBN1.KBN_NM1           AS ARR_PLAN_TIME                                                                                       " & vbNewLine _
                                             & ",OUTL.OUTKA_NO_L        AS OUTKA_NO_L                                                                                          " & vbNewLine _
                                             & ",MDOUTU.DEST_NM         AS URIG_NM                                                                                             " & vbNewLine _
                                             & ",MC.CUST_NM_L           AS CUST_NM_L                                                                                           " & vbNewLine _
                                             & "--(2012.06.15) 要望番号1155 -- START --                                                                                        " & vbNewLine _
                                             & ",MC.CUST_NM_M           AS CUST_NM_M                                                                                           " & vbNewLine _
                                             & "--(2012.06.15) 要望番号1155 --  END  --                                                                                        " & vbNewLine _
                                             & ",MC.AD_1                AS CUST_AD_1                                                                                           " & vbNewLine _
                                             & ",MC.AD_2                AS CUST_AD_2                                                                                           " & vbNewLine _
                                             & ",MC.TEL                 AS CUST_TEL                                                                                            " & vbNewLine _
                                             & ",MC.DENPYO_NM           AS DENPYO_NM                                                                                            " & vbNewLine _
                                             & ",MNRS.NRS_BR_NM         AS NRS_BR_NM                                                                                           " & vbNewLine _
                                             & ",CASE WHEN MSO.WH_KB = '01' THEN MSO.AD_1                                                                             " & vbNewLine _
                                             & "      ELSE MNRS.AD_1                                                                                                          " & vbNewLine _
                                             & " END              AS NRS_BR_AD1                                                                                                 " & vbNewLine _
                                             & ",CASE WHEN MSO.WH_KB = '01' THEN MSO.AD_2                                                                             " & vbNewLine _
                                             & "      ELSE MNRS.AD_2                                                                                                          " & vbNewLine _
                                             & " END              AS NRS_BR_AD2                                                                                                 " & vbNewLine _
                                             & ",CASE WHEN MSO.WH_KB = '01' THEN MSO.TEL                                                                             " & vbNewLine _
                                             & "      ELSE MNRS.TEL                                                                                                          " & vbNewLine _
                                             & " END              AS NRS_BR_TEL                                                                                                 " & vbNewLine _
                                             & ",CASE WHEN MSO.WH_KB = '01' THEN MSO.FAX                                                                             " & vbNewLine _
                                             & "      ELSE MNRS.FAX                                                                                                          " & vbNewLine _
                                             & " END              AS NRS_BR_FAX                                                                                                 " & vbNewLine _
                                             & ",MUSER.USER_NM          AS PIC                                                                                                 " & vbNewLine _
                                             & ",OUTM.OUTKA_NO_M        AS OUTKA_NO_M                                                                                          " & vbNewLine _
                                             & ",OUTS.OUTKA_NO_S        AS OUTKA_NO_S                                                                                          " & vbNewLine _
                                             & "--(2012.10.22)MGD.SET_NAIYOによる判定が必要か  -- START --                                                                     " & vbNewLine _
                                             & "--,CASE WHEN MGD.SET_NAIYO = '1' THEN ''                                                                                       " & vbNewLine _
                                             & "--      WHEN INL.INKA_STATE_KB < '50' THEN INL.INKA_DATE                                                                       " & vbNewLine _
                                             & "--      WHEN INL.INKA_STATE_KB >= '50' THEN ZAI.INKO_DATE                                                                      " & vbNewLine _
                                             & "--      ELSE ''                                                                                                                " & vbNewLine _
                                             & "-- END                  AS INKA_DATE                                                                                           " & vbNewLine _
                                             & ",CASE WHEN INL.INKA_STATE_KB < '50' THEN INL.INKA_DATE                                                                         " & vbNewLine _
                                             & "      ELSE ZAI.INKO_DATE                                                                                                       " & vbNewLine _
                                             & " END                    AS INKA_DATE                                                                                           " & vbNewLine _
                                             & "--(2012.10.22)MGD.SET_NAIYOによる判定が必要か  --  END  --                                                                     " & vbNewLine _
                                             & ",ZAI.REMARK_OUT         AS REMARK_OUT                                                                                          " & vbNewLine _
                                             & ",CASE WHEN (MDGE.GOODS_NM IS NOT NULL AND MDGE.GOODS_NM <> '' AND EDIL.OUTKA_CTL_NO IS NOT NULL) THEN MDGE.GOODS_NM            " & vbNewLine _
                                             & "      WHEN (MDGL.GOODS_NM IS NOT NULL AND MDGL.GOODS_NM <> '' AND EDIL.OUTKA_CTL_NO IS NULL) THEN MDGL.GOODS_NM                " & vbNewLine _
                                             & "      ELSE MG.GOODS_NM_1                                                                                                       " & vbNewLine _
                                             & " END                    AS GOODS_NM_1                                                                                          " & vbNewLine _
                                             & ",OUTS.LOT_NO            AS LOT_NO                                                                                              " & vbNewLine _
                                             & ",OUTS.SERIAL_NO         AS SERIAL_NO                                                                                           " & vbNewLine _
                                             & ",OUTS.IRIME             AS IRIME                                                                                               " & vbNewLine _
                                             & ",MG.PKG_NB              AS PKG_NB                                                                                              " & vbNewLine _
                                             & ",OUTS.ALCTD_NB / MG.PKG_NB     AS KONSU                                                                                        " & vbNewLine _
                                             & ",OUTS.ALCTD_NB % MG.PKG_NB     AS HASU                                                                                         " & vbNewLine _
                                             & ",OUTS.ALCTD_NB          AS ALCTD_NB                                                                                            " & vbNewLine _
                                             & ",MG.PKG_UT              AS PKG_UT                                                                                              " & vbNewLine _
                                             & ",KBN5.KBN_NM1           AS PKG_UT_NM                                                                                           " & vbNewLine _
                                             & ",OUTS.ALCTD_QT          AS ALCTD_QT                                                                                            " & vbNewLine _
                                             & ",MG.STD_IRIME_UT        AS IRIME_UT                                                                                            " & vbNewLine _
                                             & "--(2012.10.01)要望番号1445 -- START --                                                                                         " & vbNewLine _
                                             & ",UL.UNSO_WT             AS WT                                                                                                  " & vbNewLine _
                                             & "--,OUTS.BETU_WT * OUTS.ALCTD_NB  AS WT                                                                                         " & vbNewLine _
                                             & "--(2012.10.01)要望番号1445 --  END  --                                                                                         " & vbNewLine _
                                             & ",0                      AS UNSO_WT                                                                                             " & vbNewLine _
                                             & "--(2012.11.21)要望番号1615 -- START --                                                                                         " & vbNewLine _
                                             & ",CASE WHEN ISNUMERIC(MGD16.SET_NAIYO) = 1 THEN CONVERT(NUMERIC(12,3),MGD16.SET_NAIYO)                                          " & vbNewLine _
                                             & "      ELSE 0                                                                                                                   " & vbNewLine _
                                             & " END                    AS PKG_WT                                                                                              " & vbNewLine _
                                             & "--(2012.11.21)要望番号1615 --  END  --                                                                                         " & vbNewLine _
                                             & ",OUTS.TOU_NO            AS TOU_NO                                                                                              " & vbNewLine _
                                             & ",OUTS.SITU_NO           AS SITU_NO                                                                                             " & vbNewLine _
                                             & ",RTRIM(OUTS.ZONE_CD)     AS ZONE_CD                                                                                             " & vbNewLine _
                                             & ",OUTS.LOCA              AS LOCA                                                                                                " & vbNewLine _
                                             & ",OUTS.ALCTD_CAN_NB / MG.PKG_NB   AS ZAN_KONSU                                                                                  " & vbNewLine _
                                             & ",OUTS.ALCTD_CAN_NB % MG.PKG_NB   AS ZAN_HASU                                                                                   " & vbNewLine _
                                             & ",MG.GOODS_CD_CUST       AS GOODS_CD_CUST                                                                                       " & vbNewLine _
                                             & ",OUTM.REMARK            AS REMARK_M                                                                                            " & vbNewLine _
                                             & "--★★★変更開始--------------------------------                                                                                     " & vbNewLine _
                                             & ",MC.CUST_NM_S  AS CUST_NM_S                                                                                           " & vbNewLine _
                                             & ",MC2.CUST_NM_S   AS CUST_NM_S_H                                                                                           " & vbNewLine _
                                             & "--★★★変更終了--------------------------------                                                                                     " & vbNewLine _
                                             & ",OUTM.CUST_ORD_NO_DTL   AS CUST_ORD_NO_DTL                                                                                     " & vbNewLine _
                                             & ",OUTL.REMARK            AS OUTKA_REMARK                                                                                        " & vbNewLine _
                                             & ",UL.REMARK              AS HAISOU_REMARK                                                                                       " & vbNewLine _
                                             & ",OUTL.NHS_REMARK        AS NHS_REMARK                                                                                          " & vbNewLine _
                                             & ",CASE WHEN (OUTL.DEST_KB = '02' AND MDEDI.KYORI > 0) THEN MDEDI.KYORI                                                          " & vbNewLine _
                                             & "      WHEN (OUTL.DEST_KB = '02' AND MDEDI.KYORI = 0 AND EDIL.DEST_JIS_CD <= MSO.JIS_CD) THEN MKY3.KYORI                        " & vbNewLine _
                                             & "      WHEN (OUTL.DEST_KB = '02' AND MDEDI.KYORI = 0 AND MSO.JIS_CD <= EDIL.DEST_JIS_CD) THEN MKY4.KYORI                        " & vbNewLine _
                                             & "      WHEN (OUTL.DEST_KB <> '02' AND MDOUT.KYORI > 0) THEN MDOUT.KYORI                                                         " & vbNewLine _
                                             & "      WHEN (OUTL.DEST_KB <> '02' AND MDOUT.KYORI = 0 AND MDOUT.JIS <= MSO.JIS_CD) THEN MKY1.KYORI                              " & vbNewLine _
                                             & "      WHEN (OUTL.DEST_KB <> '02' AND MDOUT.KYORI = 0 AND MSO.JIS_CD <= MDOUT.JIS) THEN MKY2.KYORI                              " & vbNewLine _
                                             & "      ELSE 0                                                                                                                   " & vbNewLine _
                                             & " END                    AS KYORI                                                                                               " & vbNewLine _
                                             & "--(2012.08.06) 発JIS、着JISが共に同じJISでも、必ず0㎞になるのを修正  ---  END  ---                                             " & vbNewLine _
                                             & ",OUTL.OUTKA_PKG_NB      AS OUTKA_PKG_NB_L                                                                                      " & vbNewLine _
                                             & ",KBN2.KBN_NM1           AS SOKO_NM                                                                                             " & vbNewLine _
                                             & ",KBN3.KBN_NM1           AS BUSHO_NM                                                                                            " & vbNewLine _
                                             & ",KBN4.KBN_NM1           AS NRS_BR_NM_NICHI                                                                                     " & vbNewLine _
                                             & ",OUTS.ALCTD_CAN_QT      AS ALCTD_CAN_QT                                                                                        " & vbNewLine _
                                             & ",OUTM.ALCTD_KB          AS ALCTD_KB                                                                                            " & vbNewLine _
                                             & ",'0'                    AS PTN_FLAG                                                                                            " & vbNewLine _
                                             & ",OUTL.CUST_CD_L         AS CUST_CD_L                                                                                           " & vbNewLine _
                                             & ",OUTL.ORDER_TYPE        AS ORDER_TYPE                                                                                          " & vbNewLine _
                                             & "--(2012.10.19)要望番号1289 -- START --                                                                                         " & vbNewLine _
                                             & ",OUTL.SYS_UPD_PGID      AS SYS_UPD_PGID                                                                                        " & vbNewLine _
                                             & "--(2012.10.19)要望番号1289 --  END  --                                                                                         " & vbNewLine _
                                             & ",ZAI.LT_DATE                                                                                                                   " & vbNewLine _
                                             & ",OUTM.BUYER_ORD_NO_DTL AS BUYER_ORD_NO_DTL                                                                                     " & vbNewLine _
                                             & "--(2012.10.19)要望番号1289 -- START --                                                                                         " & vbNewLine _
                                             & ",ZAI.GOODS_COND_KB_1 AS GOODS_COND_CD_1                                                                                        " & vbNewLine _
                                             & "--(2012.10.19)要望番号1289 --  END  --                                                                                         " & vbNewLine _
                                             & ",ZAI.GOODS_COND_KB_2 AS GOODS_COND_CD                                                                                          " & vbNewLine _
                                             & "--(2012.10.19)要望番号1289 -- START --                                                                                         " & vbNewLine _
                                             & ",ZAI.GOODS_COND_KB_3 AS GOODS_COND_CD_3                                                                                        " & vbNewLine _
                                             & "--(2012.10.19)要望番号1289 --  END  --                                                                                         " & vbNewLine _
                                             & ",ZAI.REMARK AS REMARK_ZAI                                                                                                      " & vbNewLine _
                                             & ",KBN6.KBN_NM2 AS TITLE_SMPL                                                                                                    " & vbNewLine _
                                             & ",OUTS.ALCTD_CAN_NB AS ALCTD_CAN_NB                                                                                             " & vbNewLine _
                                             & ",OUTM.BACKLOG_QT                                                                                                               " & vbNewLine _
                                             & ",KBN7.KBN_NM2 AS DOKU_NM                                                                                                       " & vbNewLine _
                                             & "--【要望番号995】　2012/04/17　元着払い区分　START                                                                             " & vbNewLine _
                                             & " ,MCD.SET_NAIYO    AS MCD_SET_NAIYO                                                                                            " & vbNewLine _
                                             & " ,MCD.SET_NAIYO_2  AS MCD_SET_NAIYO_2                                                                                          " & vbNewLine _
                                             & " ,MCD.SET_NAIYO_3  AS MCD_SET_NAIYO_3                                                                                          " & vbNewLine _
                                             & ",KBN9.KBN_NM2 AS PC_KB_NM                                                                                                      " & vbNewLine _
                                             & "--【要望番号995】　2012/04/17　元着払い区分　 END                                                                              " & vbNewLine _
                                             & "--日医工対策開始                                                                                                               " & vbNewLine _
                                             & ",EDIL.FREE_C01           AS TORI_KB                                                                                            " & vbNewLine _
                                             & "--★追加開始2012/05/11                                                                                                         " & vbNewLine _
                                             & ",OUTL.SHIP_CD_L          AS SHIP_CD_L                                                                                          " & vbNewLine _
                                             & "--★追加終了2012/05/11                                                                                                         " & vbNewLine _
                                             & "--★削除開始2012/05/11                                                                                                         " & vbNewLine _
                                             & "--,EDIL.SHIP_NM_L          AS CHOKUSO_NM1                                                                                      " & vbNewLine _
                                             & "--,EDIL.FREE_C11           AS CHOKUSO_CD                                                                                       " & vbNewLine _
                                             & "--,EDIL.FREE_C08           AS HAKKO_DATE                                                                                       " & vbNewLine _
                                             & "--★削除終了2012/05/11                                                                                                         " & vbNewLine _
                                             & ",MCD_N.SET_NAIYO         AS SET_NAIYO_4                                                                                        " & vbNewLine _
                                             & ",MCD_N.SET_NAIYO_2       AS SET_NAIYO_5                                                                                        " & vbNewLine _
                                             & ",MCD_N.SET_NAIYO_3       AS SET_NAIYO_6                                                                                        " & vbNewLine _
                                             & ",MG.GOODS_NM_2           AS GOODS_NM_2                                                                                         " & vbNewLine _
                                             & ",EDIM.FREE_C02           AS KICHO_KB                                                                                           " & vbNewLine _
                                             & ",EDIM.FREE_C03           AS SEI_YURAI_KB                                                                                       " & vbNewLine _
                                             & ",EDIM.FREE_C04           AS REMARK_UPPER      --群馬篠崎運送利用                                                               " & vbNewLine _
                                             & ",EDIM.FREE_C05           AS REMARK_LOWER                                                                                       " & vbNewLine _
                                             & ",EDIM.FREE_C06           AS GOODS_SYUBETU     --群馬篠崎運送利用                                                               " & vbNewLine _
                                             & "--(2013.11.26) 要望番号2130 修正START                                                                                          " & vbNewLine _
                                             & "--,EDIM.FREE_C01           AS YUKOU_KIGEN                                                                                        " & vbNewLine _
                                             & ",CASE WHEN OUTL.NRS_BR_CD = '10' AND OUTL.CUST_CD_L = '00266' THEN OUTL.DENP_NO                                                " & vbNewLine _
                                             & "      ELSE EDIM.FREE_C01 END YUKOU_KIGEN                                                                                          " & vbNewLine _
                                             & "--(2013.11.26) 要望番号2130 修正END                                                                                            " & vbNewLine _
                                             & ",MG.GOODS_NM_3           AS GOODS_NM_3         --2012/05/23                                                                    " & vbNewLine _
                                             & ",MDOUTU.EDI_CD           AS EDISHIP_CD         --2012/05/23                                                                    " & vbNewLine _
                                             & ",MDOUT.EDI_CD            AS EDIDEST_CD         --2012/05/23                                                                    " & vbNewLine _
                                             & "--日医工対策終了                                                                                                               " & vbNewLine _
                                             & "--(2012.06.01) 日本ﾌｧｲﾝ対応  --- START ---                                                                                     " & vbNewLine _
                                             & ",MCD_F.SET_NAIYO         AS SET_NAIYO_FROM1                                                                                    " & vbNewLine _
                                             & ",MCD_F.SET_NAIYO_2       AS SET_NAIYO_FROM2                                                                                    " & vbNewLine _
                                             & ",MCD_F.SET_NAIYO_3       AS SET_NAIYO_FROM3                                                                                    " & vbNewLine _
                                             & "--(2012.06.01) 日本ﾌｧｲﾝ対応  --- START ---                                                                                     " & vbNewLine _
                                             & "--【要望番号1122】埼玉対応 --- START ---                                                                                       " & vbNewLine _
                                             & ",MC.AD_3                 AS CUST_AD_3                                                                                          " & vbNewLine _
                                             & ",MDOUT.REMARK            AS DEST_REMARK                                                                                        " & vbNewLine _
                                             & ",MDOUT.SALES_CD          AS DEST_SALES_CD                                                                                      " & vbNewLine _
                                             & ",MC_SALES.CUST_NM_L      AS DEST_SALES_NM                                                                                      " & vbNewLine _
                                             & ",MC_SALES.AD_1           AS DEST_SALES_AD_1                                                                                    " & vbNewLine _
                                             & ",MC_SALES.AD_2           AS DEST_SALES_AD_2                                                                                    " & vbNewLine _
                                             & ",MC_SALES.AD_3           AS DEST_SALES_AD_3                                                                                    " & vbNewLine _
                                             & ",MC_SALES.TEL            AS DEST_SALES_TEL                                                                                     " & vbNewLine _
                                             & "--【要望番号1122】埼玉対応 ---  END  ---                                                                                       " & vbNewLine _
                                             & "--群馬篠崎運送向け自由項目対応　開始　                                                                                         " & vbNewLine _
                                             & ",EDIM.FREE_C07           AS SZ01_YUSO --篠崎                                                                                   " & vbNewLine _
                                             & ",EDIM.FREE_C09           AS SZ01_UNSO --篠崎                                                                                   " & vbNewLine _
                                             & "--群馬篠崎運送向け自由項目対応　終了                                                                                         　" & vbNewLine _
                                             & "--(2012.10.19)要望番号1289 -- START --                                                                                         " & vbNewLine _
                                             & "      ,MGD.SET_NAIYO                      AS  SET_NAIYO                                                                        " & vbNewLine _
                                             & "--(2012.10.19)要望番号1289 --  END  --                                                                                         " & vbNewLine _
                                             & ",KBN10.KBN_NM1            AS SHOBO_KBN_NM                                                                                      " & vbNewLine _
                                             & ",MSHOBO.HINMEI            AS HINMEI                                                                                            " & vbNewLine _
                                             & "--(2012.11.28) LMC637対応 -- START --                                                                                          " & vbNewLine _
                                             & ",MG.CUST_CD_M             AS CUST_CD_M                                                                                         " & vbNewLine _
                                             & ",MG.CUST_CD_S             AS CUST_CD_S                                                                                         " & vbNewLine _
                                             & ",MG.CUST_COST_CD2         AS CUST_COST_CD2                                                                                     " & vbNewLine _
                                             & "--(2012.11.28) LMC637対応 --  END  --                                                                                          " & vbNewLine _


    ''' <summary>
    ''' 印刷データ抽出用(出荷テーブル:FROM句)
    ''' </summary>
    ''' <remarks></remarks>
    Friend Const SQL_FROM_OUTKA_621 As String = "--出荷L                                                                                                                        " & vbNewLine _
                                             & "FROM                                                                                                                           " & vbNewLine _
                                             & "$LM_TRN$..C_OUTKA_L OUTL                                                                                                       " & vbNewLine _
                                             & "--トランザクションテーブル                                                                                                     " & vbNewLine _
                                             & "--出荷M                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..C_OUTKA_M OUTM                                                                                             " & vbNewLine _
                                             & "ON  OUTM.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "AND OUTM.OUTKA_NO_L = OUTL.OUTKA_NO_L                                                                                          " & vbNewLine _
                                             & "AND OUTM.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--★★★追加開始--------------------------------                                                                               " & vbNewLine _
                                             & "--出荷M(中MIN)                                                                                                                 " & vbNewLine _
                                             & "LEFT OUTER JOIN                                                                                                                " & vbNewLine _
                                             & "       (SELECT                                                                                                                 " & vbNewLine _
                                             & "           NRS_BR_CD                                                                                                           " & vbNewLine _
                                             & "           ,OUTKA_NO_L                                                                                                         " & vbNewLine _
                                             & "           ,MIN(OUTKA_NO_M) AS  OUTKA_NO_M                                                                                     " & vbNewLine _
                                             & "       FROM $LM_TRN$..C_OUTKA_M WHERE SYS_DEL_FLG ='0'                                                                         " & vbNewLine _
                                             & "        AND NRS_BR_CD = @NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "        AND OUTKA_NO_L = @KANRI_NO_L                                                                                           " & vbNewLine _
                                             & "       GROUP BY NRS_BR_CD,OUTKA_NO_L) OUTM_MIN                                                                                 " & vbNewLine _
                                             & "       ON OUTM_MIN.NRS_BR_CD        = OUTL.NRS_BR_CD                                                                           " & vbNewLine _
                                             & "       AND OUTM_MIN.OUTKA_NO_L      = OUTL.OUTKA_NO_L                                                                          " & vbNewLine _
                                             & "--出荷M(中MIN)                                                                                                                 " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..C_OUTKA_M OUTM2                                                                                            " & vbNewLine _
                                             & "ON  OUTM2.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                           " & vbNewLine _
                                             & "AND OUTM2.OUTKA_NO_L = OUTL.OUTKA_NO_L                                                                                         " & vbNewLine _
                                             & "AND OUTM2.OUTKA_NO_M = OUTM_MIN.OUTKA_NO_M                                                                                     " & vbNewLine _
                                             & "AND OUTM2.SYS_DEL_FLG = '0'                                                                                                    " & vbNewLine _
                                             & "--★★★追加終了--------------------------------                                                                               " & vbNewLine _
                                             & "--出荷S                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..C_OUTKA_S OUTS                                                                                             " & vbNewLine _
                                             & "ON  OUTS.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "AND OUTS.OUTKA_NO_L = OUTL.OUTKA_NO_L                                                                                          " & vbNewLine _
                                             & "AND OUTS.OUTKA_NO_M = OUTM.OUTKA_NO_M                                                                                          " & vbNewLine _
                                             & "AND OUTS.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & " LEFT JOIN (                                                                                                                   " & vbNewLine _
                                             & "            SELECT                                                                                                             " & vbNewLine _
                                             & "                   NRS_BR_CD                                                                                                   " & vbNewLine _
                                             & "                 , EDI_CTL_NO                                                                                                  " & vbNewLine _
                                             & "                 , OUTKA_CTL_NO                                                                                                " & vbNewLine _
                                             & "             FROM (                                                                                                            " & vbNewLine _
                                             & "                    SELECT                                                                                                     " & vbNewLine _
                                             & "                           EDIOUTL.NRS_BR_CD                                                                                   " & vbNewLine _
                                             & "                         , EDIOUTL.EDI_CTL_NO                                                                                  " & vbNewLine _
                                             & "                         , EDIOUTL.OUTKA_CTL_NO                                                                                " & vbNewLine _
                                             & "                         , CASE WHEN EDIOUTL.OUTKA_CTL_NO = '' THEN 1                                                          " & vbNewLine _
                                             & "                           ELSE ROW_NUMBER() OVER (PARTITION BY EDIOUTL.NRS_BR_CD                                              " & vbNewLine _
                                             & "                                                              , EDIOUTL.OUTKA_CTL_NO                                           " & vbNewLine _
                                             & "                                                       ORDER BY EDIOUTL.NRS_BR_CD                                              " & vbNewLine _
                                             & "                                                              , EDIOUTL.EDI_CTL_NO                                             " & vbNewLine _
                                             & "                                                  )                                                                            " & vbNewLine _
                                             & "                           END AS IDX                                                                                          " & vbNewLine _
                                             & "                     FROM $LM_TRN$..H_OUTKAEDI_L EDIOUTL                                                                       " & vbNewLine _
                                             & "                    WHERE EDIOUTL.SYS_DEL_FLG  = '0'                                                                           " & vbNewLine _
                                             & "                      AND EDIOUTL.NRS_BR_CD    = @NRS_BR_CD                                                                    " & vbNewLine _
                                             & "                      AND EDIOUTL.OUTKA_CTL_NO = @KANRI_NO_L                                                                   " & vbNewLine _
                                             & "                  ) EBASE                                                                                                      " & vbNewLine _
                                             & "            WHERE EBASE.IDX = 1                                                                                                " & vbNewLine _
                                             & "            ) TOPEDI                                                                                                           " & vbNewLine _
                                             & "        ON TOPEDI.NRS_BR_CD    = OUTL.NRS_BR_CD                                                                                " & vbNewLine _
                                             & "       AND TOPEDI.OUTKA_CTL_NO = OUTL.OUTKA_NO_L                                                                               " & vbNewLine _
                                             & " LEFT JOIN $LM_TRN$..H_OUTKAEDI_L EDIL                                                                                         " & vbNewLine _
                                             & "        ON EDIL.NRS_BR_CD  = TOPEDI.NRS_BR_CD                                                                                  " & vbNewLine _
                                             & "       AND EDIL.EDI_CTL_NO = TOPEDI.EDI_CTL_NO                                                                                 " & vbNewLine _
                                             & "--(2012.09.06)要望番号1412対応  ---  END  ---                                                                                  " & vbNewLine _
                                             & "--入荷L                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..B_INKA_L INL                                                                                               " & vbNewLine _
                                             & "ON  INL.NRS_BR_CD = OUTS.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "AND INL.INKA_NO_L = OUTS.INKA_NO_L                                                                                             " & vbNewLine _
                                             & "AND INL.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--入荷S                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..B_INKA_S INS                                                                                               " & vbNewLine _
                                             & "ON  INS.NRS_BR_CD = OUTS.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "AND INS.INKA_NO_L = OUTS.INKA_NO_L                                                                                             " & vbNewLine _
                                             & "AND INS.INKA_NO_M = OUTS.INKA_NO_M                                                                                             " & vbNewLine _
                                             & "AND INS.INKA_NO_S = OUTS.INKA_NO_S                                                                                             " & vbNewLine _
                                             & "AND INS.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--運送L                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..F_UNSO_L UL                                                                                                " & vbNewLine _
                                             & "ON  UL.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                              " & vbNewLine _
                                             & "AND UL.INOUTKA_NO_L = OUTL.OUTKA_NO_L                                                                                          " & vbNewLine _
                                             & "AND UL.MOTO_DATA_KB = '20'                                                                                                     " & vbNewLine _
                                             & "AND UL.SYS_DEL_FLG = '0'                                                                                                       " & vbNewLine _
                                             & "--在庫テーブル                                                                                                                 " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..D_ZAI_TRS ZAI                                                                                              " & vbNewLine _
                                             & "ON  ZAI.NRS_BR_CD = OUTS.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "AND ZAI.ZAI_REC_NO = OUTS.ZAI_REC_NO                                                                                           " & vbNewLine _
                                             & "AND ZAI.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--マスタテーブル                                                                                                               " & vbNewLine _
                                             & "--営業所M                                                                                                                      " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_NRS_BR MNRS                                                                                              " & vbNewLine _
                                             & "ON MNRS.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "--商品M                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_GOODS MG                                                                                                 " & vbNewLine _
                                             & "ON  MG.NRS_BR_CD = OUTM.NRS_BR_CD                                                                                              " & vbNewLine _
                                             & "AND MG.GOODS_CD_NRS = OUTM.GOODS_CD_NRS                                                                                        " & vbNewLine _
                                             & "--★★★追加開始--------------------------------                                                                                     " & vbNewLine _
                                             & "--商品M(MIN)                                                                                                                   " & vbNewLine _
                                             & "LEFT OUTER JOIN $LM_MST$..M_GOODS M_GOODS_MIN                                                                                  " & vbNewLine _
                                             & "ON M_GOODS_MIN.NRS_BR_CD      = OUTL.NRS_BR_CD                                                                                 " & vbNewLine _
                                             & "AND M_GOODS_MIN.GOODS_CD_NRS   = OUTM2.GOODS_CD_NRS                                                                            " & vbNewLine _
                                             & "--★★★追加終了--------------------------------                                                                                     " & vbNewLine _
                                             & "--荷主M(商品M経由)                                                                                                             " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST MC                                                                                                  " & vbNewLine _
                                             & "ON  MC.NRS_BR_CD = MG.NRS_BR_CD                                                                                                " & vbNewLine _
                                             & "AND MC.CUST_CD_L = MG.CUST_CD_L                                                                                                " & vbNewLine _
                                             & "AND MC.CUST_CD_M = MG.CUST_CD_M                                                                                                " & vbNewLine _
                                             & "AND MC.CUST_CD_S = MG.CUST_CD_S                                                                                                " & vbNewLine _
                                             & "AND MC.CUST_CD_SS = MG.CUST_CD_SS                                                                                              " & vbNewLine _
                                             & "--★★★追加開始--------------------------------                                                                               " & vbNewLine _
                                             & "--荷主M(商品M経由) 最小の出荷(中)で抽出                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST MC2                                                                                                 " & vbNewLine _
                                             & "ON  MC2.NRS_BR_CD = M_GOODS_MIN.NRS_BR_CD                                                                                      " & vbNewLine _
                                             & "AND MC2.CUST_CD_L = M_GOODS_MIN.CUST_CD_L                                                                                      " & vbNewLine _
                                             & "AND MC2.CUST_CD_M = M_GOODS_MIN.CUST_CD_M                                                                                      " & vbNewLine _
                                             & "AND MC2.CUST_CD_S = M_GOODS_MIN.CUST_CD_S                                                                                      " & vbNewLine _
                                             & "AND MC2.CUST_CD_SS = M_GOODS_MIN.CUST_CD_SS                                                                                    " & vbNewLine _
                                             & "AND MC2.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--★★★追加終了--------------------------------                                                                               " & vbNewLine _
                                             & "--届先M(届先取得)(出荷L参照)                                                                                                   " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_DEST MDOUT                                                                                               " & vbNewLine _
                                             & "ON  MDOUT.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                           " & vbNewLine _
                                             & "AND MDOUT.CUST_CD_L = OUTL.CUST_CD_L                                                                                           " & vbNewLine _
                                             & "AND MDOUT.DEST_CD = OUTL.DEST_CD                                                                                               " & vbNewLine _
                                             & "--届先M(売上先取得)(出荷L参照)                                                                                                 " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_DEST MDOUTU                                                                                              " & vbNewLine _
                                             & "ON  MDOUTU.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                          " & vbNewLine _
                                             & "AND MDOUTU.CUST_CD_L = OUTL.CUST_CD_L                                                                                          " & vbNewLine _
                                             & "AND MDOUTU.DEST_CD = OUTL.SHIP_CD_L                                                                                            " & vbNewLine _
                                             & "--届先M(届先取得)(出荷EDIL参照)                                                                                                " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_DEST MDEDI                                                                                               " & vbNewLine _
                                             & "ON  MDEDI.NRS_BR_CD = EDIL.NRS_BR_CD                                                                                           " & vbNewLine _
                                             & "AND MDEDI.CUST_CD_L = EDIL.CUST_CD_L                                                                                           " & vbNewLine _
                                             & "AND MDEDI.DEST_CD = EDIL.DEST_CD                                                                                               " & vbNewLine _
                                             & "--【要望番号1122】埼玉対応 --- START ---                                                                                       " & vbNewLine _
                                             & "--届先M(納品書荷主名義名取得)(届先M参照)                                                                                       " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST MC_SALES                                                                                            " & vbNewLine _
                                             & "       ON MC_SALES.NRS_BR_CD  = MDOUT.NRS_BR_CD                                                                                " & vbNewLine _
                                             & "      AND MC_SALES.CUST_CD_L  = MDOUT.SALES_CD                                                                                 " & vbNewLine _
                                             & "      AND MC_SALES.CUST_CD_M  = '00'                                                                                           " & vbNewLine _
                                             & "      AND MC_SALES.CUST_CD_S  = '00'                                                                                           " & vbNewLine _
                                             & "      AND MC_SALES.CUST_CD_SS = '00'                                                                                           " & vbNewLine _
                                             & "--【要望番号1122】埼玉対応 ---  END  ---                                                                                       " & vbNewLine _
                                             & "--運送会社M                                                                                                                    " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_UNSOCO MUCO                                                                                              " & vbNewLine _
                                             & "ON  MUCO.NRS_BR_CD = UL.NRS_BR_CD                                                                                              " & vbNewLine _
                                             & "AND MUCO.UNSOCO_CD = UL.UNSO_CD                                                                                                " & vbNewLine _
                                             & "AND MUCO.UNSOCO_BR_CD = UL.UNSO_BR_CD                                                                                          " & vbNewLine _
                                             & "--倉庫M                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_SOKO MSO                                                                                                 " & vbNewLine _
                                             & "ON  MSO.NRS_BR_CD = OUTL.NRS_BR_CD  --追加                                                                                     " & vbNewLine _
                                             & "AND MSO.WH_CD     = OUTL.WH_CD                                                                                                 " & vbNewLine _
                                             & "--2014/5/16Start s.kobayashi NotesNo.2183                                                                                      " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN11                                                                                                " & vbNewLine _
                                             & "ON  KBN11.KBN_GROUP_CD = 'U028'  --追加                                                                                        " & vbNewLine _
                                             & "AND UL.SEIQ_TARIFF_CD = KBN11.KBN_NM1                                                                                          " & vbNewLine _
                                             & "--2014/5/16End s.kobayashi NotesNo.2183                                                                                       " & vbNewLine _
                                             & "--距離程M(M_DEST.JIS < M_SOKO.JIS_CD)(出荷L参照)                                                                               " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_KYORI MKY1                                                                                               " & vbNewLine _
                                             & "ON  MKY1.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "--AND MKY1.KYORI_CD = MC.BETU_KYORI_CD                                                                                           " & vbNewLine _
                                             & "AND MKY1.KYORI_CD = (CASE ISNULL(KBN11.KBN_NM2,'') WHEN '' THEN MC.BETU_KYORI_CD ELSE KBN11.KBN_NM2 END)                       " & vbNewLine _
                                             & "AND MKY1.ORIG_JIS_CD = MDOUT.JIS                                                                                               " & vbNewLine _
                                             & "AND MKY1.DEST_JIS_CD = MSO.JIS_CD                                                                                              " & vbNewLine _
                                             & "--距離程M(M_SOKO.JIS_CD < M_DEST.JIS)(出荷L参照)                                                                               " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_KYORI MKY2                                                                                               " & vbNewLine _
                                             & "ON  MKY2.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "--AND MKY2.KYORI_CD = MC.BETU_KYORI_CD                                                                                           " & vbNewLine _
                                             & "AND MKY2.KYORI_CD = (CASE ISNULL(KBN11.KBN_NM2,'') WHEN '' THEN MC.BETU_KYORI_CD ELSE KBN11.KBN_NM2 END)                       " & vbNewLine _
                                             & "AND MKY2.ORIG_JIS_CD = MSO.JIS_CD                                                                                              " & vbNewLine _
                                             & "AND MKY2.DEST_JIS_CD = MDOUT.JIS                                                                                               " & vbNewLine _
                                             & "--距離程M(H_OUTKAEDI_L.DEST_JIS_CD < M_SOKO.JIS_CD)(出荷EDIL参照)                                                              " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_KYORI MKY3                                                                                               " & vbNewLine _
                                             & "ON  MKY3.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "--AND MKY3.KYORI_CD = MC.BETU_KYORI_CD                                                                                           " & vbNewLine _
                                             & "AND MKY3.KYORI_CD = (CASE ISNULL(KBN11.KBN_NM2,'') WHEN '' THEN MC.BETU_KYORI_CD ELSE KBN11.KBN_NM2 END)                       " & vbNewLine _
                                             & "AND MKY3.ORIG_JIS_CD = EDIL.DEST_JIS_CD                                                                                        " & vbNewLine _
                                             & "AND MKY3.DEST_JIS_CD = MSO.JIS_CD                                                                                              " & vbNewLine _
                                             & "--距離程M(M_SOKO.JIS_CD < H_OUTKAEDI_L.DEST_JIS_CD)(出荷EDIL参照)                                                              " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_KYORI MKY4                                                                                               " & vbNewLine _
                                             & "ON  MKY4.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "--AND MKY4.KYORI_CD = MC.BETU_KYORI_CD                                                                                           " & vbNewLine _
                                             & "AND MKY4.KYORI_CD = (CASE ISNULL(KBN11.KBN_NM2,'') WHEN '' THEN MC.BETU_KYORI_CD ELSE KBN11.KBN_NM2 END)                       " & vbNewLine _
                                             & "AND MKY4.ORIG_JIS_CD = MSO.JIS_CD                                                                                              " & vbNewLine _
                                             & "AND MKY4.DEST_JIS_CD = EDIL.DEST_JIS_CD                                                                                        " & vbNewLine _
                                             & "--届先商品M(出荷L参照)                                                                                                         " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_DESTGOODS MDGL                                                                                           " & vbNewLine _
                                             & "ON  MDGL.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "AND MDGL.CUST_CD_L = OUTL.CUST_CD_L                                                                                            " & vbNewLine _
                                             & "AND MDGL.CUST_CD_M = OUTL.CUST_CD_M                                                                                            " & vbNewLine _
                                             & "AND MDGL.CD = OUTL.DEST_CD                                                                                                     " & vbNewLine _
                                             & "AND MDGL.GOODS_CD_NRS = MG.GOODS_CD_NRS                                                                                        " & vbNewLine _
                                             & "AND MDGL.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--届先商品M(出荷EDI参照)                                                                                                       " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_DESTGOODS MDGE                                                                                           " & vbNewLine _
                                             & "ON  MDGE.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "AND MDGE.CUST_CD_L = OUTL.CUST_CD_L                                                                                            " & vbNewLine _
                                             & "AND MDGE.CUST_CD_M = OUTL.CUST_CD_M                                                                                            " & vbNewLine _
                                             & "AND MDGE.CD = EDIL.DEST_CD                                                                                                     " & vbNewLine _
                                             & "AND MDGE.GOODS_CD_NRS = MG.GOODS_CD_NRS                                                                                        " & vbNewLine _
                                             & "AND MDGE.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--消防M★                                                                                                      " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_SHOBO MSHOBO                                                                                           " & vbNewLine _
                                             & "ON  MSHOBO.SHOBO_CD = MG.SHOBO_CD                                                                                            " & vbNewLine _
                                             & "AND MSHOBO.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--区分M(納入予定区分)                                                                                                          " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN1                                                                                                 " & vbNewLine _
                                             & "ON  KBN1.KBN_GROUP_CD = 'N010'                                                                                                 " & vbNewLine _
                                             & "AND KBN1.KBN_CD = OUTL.ARR_PLAN_TIME                                                                                           " & vbNewLine _
                                             & "AND KBN1.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--区分M(日本合成用倉庫名)                                                                                                      " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN2                                                                                                 " & vbNewLine _
                                             & "ON  KBN2.KBN_GROUP_CD = 'P005'                                                                                                 " & vbNewLine _
                                             & "AND KBN2.KBN_CD = '00'                                                                                                         " & vbNewLine _
                                             & "AND KBN2.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--区分M(日本合成用部署名)                                                                                                      " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN3                                                                                                 " & vbNewLine _
                                             & "ON  KBN3.KBN_GROUP_CD = 'P005'                                                                                                 " & vbNewLine _
                                             & "AND KBN3.KBN_CD = '01'                                                                                                         " & vbNewLine _
                                             & "AND KBN3.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--区分M(日本合成用営業署名)                                                                                                    " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN4                                                                                                 " & vbNewLine _
                                             & "ON  KBN4.KBN_GROUP_CD = 'P005'                                                                                                 " & vbNewLine _
                                             & "AND KBN4.KBN_CD = '02'                                                                                                         " & vbNewLine _
                                             & "AND KBN4.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--区分M(荷姿)                                                                                                                  " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN5                                                                                                 " & vbNewLine _
                                             & "ON  KBN5.KBN_GROUP_CD = 'N001'                                                                                                 " & vbNewLine _
                                             & "AND KBN5.KBN_CD = MG.PKG_UT                                                                                                    " & vbNewLine _
                                             & "AND KBN5.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--明細タイトル（小分け）                                                                                                       " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN6                                                                                                 " & vbNewLine _
                                             & "ON  KBN6.KBN_GROUP_CD = 'S041'                                                                                                 " & vbNewLine _
                                             & "AND KBN6.KBN_CD = OUTM.ALCTD_KB                                                                                                " & vbNewLine _
                                             & "AND KBN6.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--区分M(毒劇区分名称)                                                                                                           " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN7                                                                                                  " & vbNewLine _
                                             & "ON  KBN7.KBN_GROUP_CD = 'G001'                                                                                                  " & vbNewLine _
                                             & "AND KBN7.KBN_CD = MG.DOKU_KB                                                                                                    " & vbNewLine _
                                             & "AND KBN7.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--【要望番号995】　2012/04/17　元着払い区分　START                                                                             " & vbNewLine _
                                             & "--区分M(元着払区分名称)                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN9                                                                                                 " & vbNewLine _
                                             & "ON  KBN9.KBN_GROUP_CD = 'M001'                                                                                                 " & vbNewLine _
                                             & "AND KBN9.KBN_CD = OUTL.PC_KB                                                                                                   " & vbNewLine _
                                             & "AND KBN9.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--【要望番号995】　2012/04/17　元着払い区分　 END                                                                              " & vbNewLine _
                                             & "--区分M(消防区分名称)★                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN10                                                                                                " & vbNewLine _
                                             & "ON  KBN10.KBN_GROUP_CD = 'S004'                                                                                                " & vbNewLine _
                                             & "AND KBN10.KBN_CD = MSHOBO.RUI                                                                                                  " & vbNewLine _
                                             & "AND KBN10.SYS_DEL_FLG = '0'                                                                                                    " & vbNewLine _
                                             & "--日医工対策開始                                                                                                               " & vbNewLine _
                                             & "--★出荷EDI M(日医工)                                                                                                          " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..H_OUTKAEDI_M EDIM                                                                                            " & vbNewLine _
                                             & "ON  EDIM.NRS_BR_CD        = OUTM.NRS_BR_CD                                                                                     " & vbNewLine _
                                             & "AND EDIM.OUTKA_CTL_NO     = OUTM.OUTKA_NO_L                                                                                    " & vbNewLine _
                                             & "AND EDIM.OUTKA_CTL_NO_CHU = OUTM.OUTKA_NO_M                                                                                    " & vbNewLine _
                                             & "AND EDIM.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--荷主明細M ★                                                                                                                 " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST_DETAILS MCD_N                                                                                       " & vbNewLine _
                                             & "ON  MCD_N.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                           " & vbNewLine _
                                             & "AND MCD_N.CUST_CD   = OUTL.CUST_CD_L                                                                                           " & vbNewLine _
                                             & "AND MCD_N.SUB_KB = '26'                                                                                                        " & vbNewLine _
                                             & "--日医工対策終了                                                                                                               " & vbNewLine _
                                             & "--(2012.06.01) 日本ﾌｧｲﾝ対応  --- START ----                                                                                    " & vbNewLine _
                                             & "--荷主明細M                                                                                                                    " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST_DETAILS MCD_F                                                                                       " & vbNewLine _
                                             & "ON  MCD_F.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                           " & vbNewLine _
                                             & "AND MCD_F.CUST_CD   = OUTL.CUST_CD_L                                                                                           " & vbNewLine _
                                             & "AND MCD_F.SUB_KB = '29'                                                                                                        " & vbNewLine _
                                             & "--(2012.06.01) 日本ﾌｧｲﾝ対応  ---  END  ----                                                                                    " & vbNewLine _
                                             & "--荷主明細M ★                                                                                                                 " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST_DETAILS MCD                                                                                         " & vbNewLine _
                                             & "ON  MCD.NRS_BR_CD = MG.NRS_BR_CD                                                                                               " & vbNewLine _
                                             & "AND MCD.CUST_CD   = MG.CUST_CD_L                                                                                               " & vbNewLine _
                                             & "AND MCD.SUB_KB = '20'                                                                                                          " & vbNewLine _
                                             & "--(2012.11.21)要望番号1615 -- START --                                                                                         " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_GOODS_DETAILS MGD16                                                                                        " & vbNewLine _
                                             & "       ON MGD16.NRS_BR_CD = MG.NRS_BR_CD                                                                                       " & vbNewLine _
                                             & "      AND MGD16.GOODS_CD_NRS = MG.GOODS_CD_NRS                                                                                 " & vbNewLine _
                                             & "      AND MGD16.SUB_KB = '16'                                                                                                  " & vbNewLine _
                                             & "      AND MGD16.SYS_DEL_FLG = '0'                                                                                              " & vbNewLine _
                                             & "--(2012.11.21)要望番号1615 --  END  --                                                                                         " & vbNewLine _
                                             & "--出荷Lでの荷主帳票パターン取得                                                                                                " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST_RPT MCR1                                                                                            " & vbNewLine _
                                             & "ON  OUTL.NRS_BR_CD = MCR1.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "AND OUTL.CUST_CD_L = MCR1.CUST_CD_L                                                                                            " & vbNewLine _
                                             & "AND OUTL.CUST_CD_M = MCR1.CUST_CD_M                                                                                            " & vbNewLine _
                                             & "AND '00' = MCR1.CUST_CD_S                                                                                                      " & vbNewLine _
                                             & "AND MCR1.PTN_ID = '04'                                                                                                         " & vbNewLine _
                                             & "--帳票パターン取得                                                                                                             " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_RPT MR1                                                                                                  " & vbNewLine _
                                             & "ON  MR1.NRS_BR_CD = MCR1.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "AND MR1.PTN_ID = MCR1.PTN_ID                                                                                                   " & vbNewLine _
                                             & "AND MR1.PTN_CD = MCR1.PTN_CD                                                                                                   " & vbNewLine _
                                             & "AND MR1.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--商品Mの荷主での荷主帳票パターン取得                                                                                          " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST_RPT MCR2                                                                                            " & vbNewLine _
                                             & "ON  MG.NRS_BR_CD = MCR2.NRS_BR_CD                                                                                              " & vbNewLine _
                                             & "AND MG.CUST_CD_L = MCR2.CUST_CD_L                                                                                              " & vbNewLine _
                                             & "AND MG.CUST_CD_M = MCR2.CUST_CD_M                                                                                              " & vbNewLine _
                                             & "AND MG.CUST_CD_S = MCR2.CUST_CD_S                                                                                              " & vbNewLine _
                                             & "AND MCR2.PTN_ID = '04'                                                                                                         " & vbNewLine _
                                             & "--帳票パターン取得                                                                                                             " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_RPT MR2                                                                                                  " & vbNewLine _
                                             & "ON  MR2.NRS_BR_CD = MCR2.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "AND MR2.PTN_ID = MCR2.PTN_ID                                                                                                   " & vbNewLine _
                                             & "AND MR2.PTN_CD = MCR2.PTN_CD                                                                                                   " & vbNewLine _
                                             & "AND MR2.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--存在しない場合の帳票パターン取得                                                                                             " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_RPT MR3                                                                                                  " & vbNewLine _
                                             & "ON  MR3.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "AND MR3.PTN_ID = '04'                                                                                                          " & vbNewLine _
                                             & "AND MR3.STANDARD_FLAG = '01'                                                                                                   " & vbNewLine _
                                             & "AND MR3.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--ユーザM                                                                                                                      " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..S_USER MUSER                                                                                               " & vbNewLine _
                                             & "ON MUSER.USER_CD = OUTL.SYS_ENT_USER                                                                                           " & vbNewLine _
                                             & "AND MUSER.SYS_DEL_FLG = '0'                                                                                                    " & vbNewLine _
                                             & "--商品明細M                                                                                                                    " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_GOODS_DETAILS MGD                                                                                        " & vbNewLine _
                                             & "ON  MGD.NRS_BR_CD = MG.NRS_BR_CD                                                                                               " & vbNewLine _
                                             & "AND MGD.GOODS_CD_NRS = MG.GOODS_CD_NRS                                                                                         " & vbNewLine _
                                             & "AND MGD.SUB_KB = '09'                                                                                                          " & vbNewLine _
                                             & "AND MGD.SYS_DEL_FLG = '0'       --ADD 2019/02/07 依頼番号 : 004605   【LMS】納品書がの梱包個数が2倍になるバグ修正              " & vbNewLine



    ''' <summary>
    ''' 印刷データ抽出用(出荷テーブル)
    ''' </summary>
    ''' <remarks>
    ''' SQL_SELECT_OUTKA_621へ分岐(20160722)
    ''' </remarks>
    Friend Const SQL_SELECT_OUTKA_629 As String = "--★★★SQL_SELECT_OUTKA_621★★★  出荷テーブル                                                                           " & vbNewLine _
                                             & "SELECT                                                                                                                         " & vbNewLine _
                                             & " CASE WHEN MR2.PTN_CD IS NOT NULL THEN MR2.RPT_ID                                                                              " & vbNewLine _
                                             & "      WHEN MR1.PTN_CD IS NOT NULL THEN MR1.RPT_ID                                                                              " & vbNewLine _
                                             & "      ELSE MR3.RPT_ID                                                                                                          " & vbNewLine _
                                             & " END              AS RPT_ID                                                                                                    " & vbNewLine _
                                             & ",OUTL.NRS_BR_CD   AS NRS_BR_CD                                                                                                 " & vbNewLine _
                                             & ",OUTM.PRINT_SORT  AS PRINT_SORT                                                                                                " & vbNewLine _
                                             & ",CASE WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_CD                                                                     " & vbNewLine _
                                             & "      ELSE OUTL.DEST_CD                                                                                                        " & vbNewLine _
                                             & " END              AS DEST_CD                                                                                                   " & vbNewLine _
                                             & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_NM                                                                               " & vbNewLine _
                                             & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_NM                                                                     " & vbNewLine _
                                             & "      ELSE MDOUT.DEST_NM                                                                                                       " & vbNewLine _
                                             & " END              AS DEST_NM                                                                                                   " & vbNewLine _
                                             & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_AD_1                                                                             " & vbNewLine _
                                             & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_AD_1                                                                   " & vbNewLine _
                                             & "      ELSE MDOUT.AD_1                                                                                                          " & vbNewLine _
                                             & " END              AS DEST_AD_1                                                                                                 " & vbNewLine _
                                             & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_AD_2                                                                             " & vbNewLine _
                                             & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_AD_2                                                                   " & vbNewLine _
                                             & "      ELSE MDOUT.AD_2                                                                                                          " & vbNewLine _
                                             & " END              AS DEST_AD_2                                                                                                 " & vbNewLine _
                                             & ",OUTL.DEST_AD_3   AS DEST_AD_3                                                                                                 " & vbNewLine _
                                             & ",OUTL.DEST_TEL    AS DEST_TEL                                                                                                  " & vbNewLine _
                                             & ",OUTL.OUTKA_PLAN_DATE   AS OUTKA_PLAN_DATE                                                                                     " & vbNewLine _
                                             & ",OUTL.CUST_ORD_NO       AS CUST_ORD_NO                                                                                         " & vbNewLine _
                                             & ",OUTL.BUYER_ORD_NO      AS BUYER_ORD_NO                                                                                        " & vbNewLine _
                                             & ",MUCO.UNSOCO_NM         AS UNSOCO_NM                                                                                           " & vbNewLine _
                                             & ",OUTL.ARR_PLAN_DATE     AS ARR_PLAN_DATE                                                                                       " & vbNewLine _
                                             & ",KBN1.KBN_NM1           AS ARR_PLAN_TIME                                                                                       " & vbNewLine _
                                             & ",OUTL.OUTKA_NO_L        AS OUTKA_NO_L                                                                                          " & vbNewLine _
                                             & ",MDOUTU.DEST_NM         AS URIG_NM                                                                                             " & vbNewLine _
                                             & ",MC.CUST_NM_L           AS CUST_NM_L                                                                                           " & vbNewLine _
                                             & "--(2012.06.15) 要望番号1155 -- START --                                                                                        " & vbNewLine _
                                             & ",MC.CUST_NM_M           AS CUST_NM_M                                                                                           " & vbNewLine _
                                             & "--(2012.06.15) 要望番号1155 --  END  --                                                                                        " & vbNewLine _
                                             & ",MC.AD_1                AS CUST_AD_1                                                                                           " & vbNewLine _
                                             & ",MC.AD_2                AS CUST_AD_2                                                                                           " & vbNewLine _
                                             & ",MC.TEL                 AS CUST_TEL                                                                                            " & vbNewLine _
                                             & ",MC.DENPYO_NM           AS DENPYO_NM                                                                                            " & vbNewLine _
                                             & ",MNRS.NRS_BR_NM         AS NRS_BR_NM                                                                                           " & vbNewLine _
                                             & ",CASE WHEN MSO.WH_KB = '01' THEN MSO.AD_1                                                                             " & vbNewLine _
                                             & "      ELSE MNRS.AD_1                                                                                                          " & vbNewLine _
                                             & " END              AS NRS_BR_AD1                                                                                                 " & vbNewLine _
                                             & ",CASE WHEN MSO.WH_KB = '01' THEN MSO.AD_2                                                                             " & vbNewLine _
                                             & "      ELSE MNRS.AD_2                                                                                                          " & vbNewLine _
                                             & " END              AS NRS_BR_AD2                                                                                                 " & vbNewLine _
                                             & ",CASE WHEN MSO.WH_KB = '01' THEN MSO.TEL                                                                             " & vbNewLine _
                                             & "      ELSE MNRS.TEL                                                                                                          " & vbNewLine _
                                             & " END              AS NRS_BR_TEL                                                                                                 " & vbNewLine _
                                             & ",CASE WHEN MSO.WH_KB = '01' THEN MSO.FAX                                                                             " & vbNewLine _
                                             & "      ELSE MNRS.FAX                                                                                                          " & vbNewLine _
                                             & " END              AS NRS_BR_FAX                                                                                                 " & vbNewLine _
                                             & ",MUSER.USER_NM          AS PIC                                                                                                 " & vbNewLine _
                                             & ",OUTM.OUTKA_NO_M        AS OUTKA_NO_M                                                                                          " & vbNewLine _
                                             & ",OUTS.OUTKA_NO_S        AS OUTKA_NO_S                                                                                          " & vbNewLine _
                                             & "--(2012.10.22)MGD.SET_NAIYOによる判定が必要か  -- START --                                                                     " & vbNewLine _
                                             & "--,CASE WHEN MGD.SET_NAIYO = '1' THEN ''                                                                                       " & vbNewLine _
                                             & "--      WHEN INL.INKA_STATE_KB < '50' THEN INL.INKA_DATE                                                                       " & vbNewLine _
                                             & "--      WHEN INL.INKA_STATE_KB >= '50' THEN ZAI.INKO_DATE                                                                      " & vbNewLine _
                                             & "--      ELSE ''                                                                                                                " & vbNewLine _
                                             & "-- END                  AS INKA_DATE                                                                                           " & vbNewLine _
                                             & ",CASE WHEN INL.INKA_STATE_KB < '50' THEN INL.INKA_DATE                                                                         " & vbNewLine _
                                             & "      ELSE ZAI.INKO_DATE                                                                                                       " & vbNewLine _
                                             & " END                    AS INKA_DATE                                                                                           " & vbNewLine _
                                             & "--(2012.10.22)MGD.SET_NAIYOによる判定が必要か  --  END  --                                                                     " & vbNewLine _
                                             & ",ZAI.REMARK_OUT         AS REMARK_OUT                                                                                          " & vbNewLine _
                                             & ",CASE WHEN (MDGE.GOODS_NM IS NOT NULL AND MDGE.GOODS_NM <> '' AND EDIL.OUTKA_CTL_NO IS NOT NULL) THEN MDGE.GOODS_NM            " & vbNewLine _
                                             & "      WHEN (MDGL.GOODS_NM IS NOT NULL AND MDGL.GOODS_NM <> '' AND EDIL.OUTKA_CTL_NO IS NULL) THEN MDGL.GOODS_NM                " & vbNewLine _
                                             & "      ELSE MG.GOODS_NM_1                                                                                                       " & vbNewLine _
                                             & " END                    AS GOODS_NM_1                                                                                          " & vbNewLine _
                                             & ",OUTS.LOT_NO            AS LOT_NO                                                                                              " & vbNewLine _
                                             & ",OUTS.SERIAL_NO         AS SERIAL_NO                                                                                           " & vbNewLine _
                                             & ",OUTS.IRIME             AS IRIME                                                                                               " & vbNewLine _
                                             & ",MG.PKG_NB              AS PKG_NB                                                                                              " & vbNewLine _
                                             & ",OUTS.ALCTD_NB / MG.PKG_NB     AS KONSU                                                                                        " & vbNewLine _
                                             & ",OUTS.ALCTD_NB % MG.PKG_NB     AS HASU                                                                                         " & vbNewLine _
                                             & ",OUTS.ALCTD_NB          AS ALCTD_NB                                                                                            " & vbNewLine _
                                             & ",MG.PKG_UT              AS PKG_UT                                                                                              " & vbNewLine _
                                             & ",KBN5.KBN_NM1           AS PKG_UT_NM                                                                                           " & vbNewLine _
                                             & ",OUTS.ALCTD_QT          AS ALCTD_QT                                                                                            " & vbNewLine _
                                             & ",MG.STD_IRIME_UT        AS IRIME_UT                                                                                            " & vbNewLine _
                                             & "--(2012.10.01)要望番号1445 -- START --                                                                                         " & vbNewLine _
                                             & ",UL.UNSO_WT             AS WT                                                                                                  " & vbNewLine _
                                             & "--,OUTS.BETU_WT * OUTS.ALCTD_NB  AS WT                                                                                         " & vbNewLine _
                                             & "--(2012.10.01)要望番号1445 --  END  --                                                                                         " & vbNewLine _
                                             & ",0                      AS UNSO_WT                                                                                             " & vbNewLine _
                                             & "--(2012.11.21)要望番号1615 -- START --                                                                                         " & vbNewLine _
                                             & ",CASE WHEN ISNUMERIC(MGD16.SET_NAIYO) = 1 THEN CONVERT(NUMERIC(12,3),MGD16.SET_NAIYO)                                          " & vbNewLine _
                                             & "      ELSE 0                                                                                                                   " & vbNewLine _
                                             & " END                    AS PKG_WT                                                                                              " & vbNewLine _
                                             & "--(2012.11.21)要望番号1615 --  END  --                                                                                         " & vbNewLine _
                                             & ",OUTS.TOU_NO            AS TOU_NO                                                                                              " & vbNewLine _
                                             & ",OUTS.SITU_NO           AS SITU_NO                                                                                             " & vbNewLine _
                                             & ",RTRIM(OUTS.ZONE_CD)     AS ZONE_CD                                                                                             " & vbNewLine _
                                             & ",OUTS.LOCA              AS LOCA                                                                                                " & vbNewLine _
                                             & ",OUTS.ALCTD_CAN_NB / MG.PKG_NB   AS ZAN_KONSU                                                                                  " & vbNewLine _
                                             & ",OUTS.ALCTD_CAN_NB % MG.PKG_NB   AS ZAN_HASU                                                                                   " & vbNewLine _
                                             & ",MG.GOODS_CD_CUST       AS GOODS_CD_CUST                                                                                       " & vbNewLine _
                                             & ",OUTM.REMARK            AS REMARK_M                                                                                            " & vbNewLine _
                                             & "--★★★変更開始--------------------------------                                                                                     " & vbNewLine _
                                             & ",MC.CUST_NM_S  AS CUST_NM_S                                                                                           " & vbNewLine _
                                             & ",MC2.CUST_NM_S   AS CUST_NM_S_H                                                                                           " & vbNewLine _
                                             & "--★★★変更終了--------------------------------                                                                                     " & vbNewLine _
                                             & ",OUTM.CUST_ORD_NO_DTL   AS CUST_ORD_NO_DTL                                                                                     " & vbNewLine _
                                             & ",OUTL.REMARK            AS OUTKA_REMARK                                                                                        " & vbNewLine _
                                             & ",UL.REMARK              AS HAISOU_REMARK                                                                                       " & vbNewLine _
                                             & ",OUTL.NHS_REMARK        AS NHS_REMARK                                                                                          " & vbNewLine _
                                             & "--(2012.08.06) 発JIS、着JISが共に同じJISでも、必ず0㎞になるのを修正  --- START ---                                             " & vbNewLine _
                                             & "--,CASE WHEN (OUTL.DEST_KB = '02' AND MDEDI.KYORI > 0) THEN MDEDI.KYORI                                                        " & vbNewLine _
                                             & "--      WHEN (OUTL.DEST_KB = '02' AND MDEDI.KYORI = 0 AND EDIL.DEST_JIS_CD < MSO.JIS_CD) THEN MKY3.KYORI                       " & vbNewLine _
                                             & "--      WHEN (OUTL.DEST_KB = '02' AND MDEDI.KYORI = 0 AND MSO.JIS_CD < EDIL.DEST_JIS_CD) THEN MKY4.KYORI                       " & vbNewLine _
                                             & "--      WHEN (OUTL.DEST_KB <> '02' AND MDOUT.KYORI > 0) THEN MDOUT.KYORI                                                       " & vbNewLine _
                                             & "--      WHEN (OUTL.DEST_KB <> '02' AND MDOUT.KYORI = 0 AND MDOUT.JIS < MSO.JIS_CD) THEN MKY1.KYORI                             " & vbNewLine _
                                             & "--      WHEN (OUTL.DEST_KB <> '02' AND MDOUT.KYORI = 0 AND MSO.JIS_CD < MDOUT.JIS) THEN MKY2.KYORI                             " & vbNewLine _
                                             & "--      ELSE 0                                                                                                                 " & vbNewLine _
                                             & "-- END                  AS KYORI                                                                                               " & vbNewLine _
                                             & ",CASE WHEN (OUTL.DEST_KB = '02' AND MDEDI.KYORI > 0) THEN MDEDI.KYORI                                                          " & vbNewLine _
                                             & "      WHEN (OUTL.DEST_KB = '02' AND MDEDI.KYORI = 0 AND EDIL.DEST_JIS_CD <= MSO.JIS_CD) THEN MKY3.KYORI                        " & vbNewLine _
                                             & "      WHEN (OUTL.DEST_KB = '02' AND MDEDI.KYORI = 0 AND MSO.JIS_CD <= EDIL.DEST_JIS_CD) THEN MKY4.KYORI                        " & vbNewLine _
                                             & "      WHEN (OUTL.DEST_KB <> '02' AND MDOUT.KYORI > 0) THEN MDOUT.KYORI                                                         " & vbNewLine _
                                             & "      WHEN (OUTL.DEST_KB <> '02' AND MDOUT.KYORI = 0 AND MDOUT.JIS <= MSO.JIS_CD) THEN MKY1.KYORI                              " & vbNewLine _
                                             & "      WHEN (OUTL.DEST_KB <> '02' AND MDOUT.KYORI = 0 AND MSO.JIS_CD <= MDOUT.JIS) THEN MKY2.KYORI                              " & vbNewLine _
                                             & "      ELSE 0                                                                                                                   " & vbNewLine _
                                             & " END                    AS KYORI                                                                                               " & vbNewLine _
                                             & "--(2012.08.06) 発JIS、着JISが共に同じJISでも、必ず0㎞になるのを修正  ---  END  ---                                             " & vbNewLine _
                                             & ",OUTL.OUTKA_PKG_NB      AS OUTKA_PKG_NB_L                                                                                      " & vbNewLine _
                                             & ",KBN2.KBN_NM1           AS SOKO_NM                                                                                             " & vbNewLine _
                                             & ",KBN3.KBN_NM1           AS BUSHO_NM                                                                                            " & vbNewLine _
                                             & ",KBN4.KBN_NM1           AS NRS_BR_NM_NICHI                                                                                     " & vbNewLine _
                                             & ",OUTS.ALCTD_CAN_QT      AS ALCTD_CAN_QT                                                                                        " & vbNewLine _
                                             & ",OUTM.ALCTD_KB          AS ALCTD_KB                                                                                            " & vbNewLine _
                                             & ",'0'                    AS PTN_FLAG                                                                                            " & vbNewLine _
                                             & ",OUTL.CUST_CD_L         AS CUST_CD_L                                                                                           " & vbNewLine _
                                             & ",OUTL.ORDER_TYPE        AS ORDER_TYPE                                                                                          " & vbNewLine _
                                             & "--(2012.10.19)要望番号1289 -- START --                                                                                         " & vbNewLine _
                                             & ",OUTL.SYS_UPD_PGID      AS SYS_UPD_PGID                                                                                        " & vbNewLine _
                                             & "--(2012.10.19)要望番号1289 --  END  --                                                                                         " & vbNewLine _
                                             & ",ZAI.LT_DATE                                                                                                                   " & vbNewLine _
                                             & ",OUTM.BUYER_ORD_NO_DTL AS BUYER_ORD_NO_DTL                                                                                     " & vbNewLine _
                                             & "--(2012.10.19)要望番号1289 -- START --                                                                                         " & vbNewLine _
                                             & ",ZAI.GOODS_COND_KB_1 AS GOODS_COND_CD_1                                                                                        " & vbNewLine _
                                             & "--(2012.10.19)要望番号1289 --  END  --                                                                                         " & vbNewLine _
                                             & ",ZAI.GOODS_COND_KB_2 AS GOODS_COND_CD                                                                                          " & vbNewLine _
                                             & "--(2012.10.19)要望番号1289 -- START --                                                                                         " & vbNewLine _
                                             & ",ZAI.GOODS_COND_KB_3 AS GOODS_COND_CD_3                                                                                        " & vbNewLine _
                                             & "--(2012.10.19)要望番号1289 --  END  --                                                                                         " & vbNewLine _
                                             & ",ZAI.REMARK AS REMARK_ZAI                                                                                                      " & vbNewLine _
                                             & ",KBN6.KBN_NM2 AS TITLE_SMPL                                                                                                    " & vbNewLine _
                                             & ",OUTS.ALCTD_CAN_NB AS ALCTD_CAN_NB                                                                                             " & vbNewLine _
                                             & ",OUTM.BACKLOG_QT                                                                                                               " & vbNewLine _
                                             & ",KBN7.KBN_NM2 AS DOKU_NM                                                                                                       " & vbNewLine _
                                             & "--【要望番号995】　2012/04/17　元着払い区分　START                                                                             " & vbNewLine _
                                             & " ,MCD.SET_NAIYO    AS MCD_SET_NAIYO                                                                                            " & vbNewLine _
                                             & " ,MCD.SET_NAIYO_2  AS MCD_SET_NAIYO_2                                                                                          " & vbNewLine _
                                             & " ,MCD.SET_NAIYO_3  AS MCD_SET_NAIYO_3                                                                                          " & vbNewLine _
                                             & ",KBN9.KBN_NM2 AS PC_KB_NM                                                                                                      " & vbNewLine _
                                             & "--【要望番号995】　2012/04/17　元着払い区分　 END                                                                              " & vbNewLine _
                                             & "--日医工対策開始                                                                                                               " & vbNewLine _
                                             & ",EDIL.FREE_C01           AS TORI_KB                                                                                            " & vbNewLine _
                                             & "--★追加開始2012/05/11                                                                                                         " & vbNewLine _
                                             & ",OUTL.SHIP_CD_L          AS SHIP_CD_L                                                                                          " & vbNewLine _
                                             & "--★追加終了2012/05/11                                                                                                         " & vbNewLine _
                                             & "--★削除開始2012/05/11                                                                                                         " & vbNewLine _
                                             & "--,EDIL.SHIP_NM_L          AS CHOKUSO_NM1                                                                                      " & vbNewLine _
                                             & "--,EDIL.FREE_C11           AS CHOKUSO_CD                                                                                       " & vbNewLine _
                                             & "--,EDIL.FREE_C08           AS HAKKO_DATE                                                                                       " & vbNewLine _
                                             & "--★削除終了2012/05/11                                                                                                         " & vbNewLine _
                                             & ",MCD_N.SET_NAIYO         AS SET_NAIYO_4                                                                                        " & vbNewLine _
                                             & ",MCD_N.SET_NAIYO_2       AS SET_NAIYO_5                                                                                        " & vbNewLine _
                                             & ",MCD_N.SET_NAIYO_3       AS SET_NAIYO_6                                                                                        " & vbNewLine _
                                             & ",MG.GOODS_NM_2           AS GOODS_NM_2                                                                                         " & vbNewLine _
                                             & ",EDIM.FREE_C02           AS KICHO_KB                                                                                           " & vbNewLine _
                                             & ",EDIM.FREE_C03           AS SEI_YURAI_KB                                                                                       " & vbNewLine _
                                             & ",EDIM.FREE_C04           AS REMARK_UPPER      --群馬篠崎運送利用                                                               " & vbNewLine _
                                             & ",EDIM.FREE_C05           AS REMARK_LOWER                                                                                       " & vbNewLine _
                                             & ",EDIM.FREE_C06           AS GOODS_SYUBETU     --群馬篠崎運送利用                                                               " & vbNewLine _
                                             & "--(2013.11.26) 要望番号2130 修正START                                                                                          " & vbNewLine _
                                             & "--,EDIM.FREE_C01           AS YUKOU_KIGEN                                                                                        " & vbNewLine _
                                             & ",CASE WHEN OUTL.NRS_BR_CD = '10' AND OUTL.CUST_CD_L = '00266' THEN OUTL.DENP_NO                                                " & vbNewLine _
                                             & "      ELSE EDIM.FREE_C01 END YUKOU_KIGEN                                                                                          " & vbNewLine _
                                             & "--(2013.11.26) 要望番号2130 修正END                                                                                            " & vbNewLine _
                                             & ",MG.GOODS_NM_3           AS GOODS_NM_3         --2012/05/23                                                                    " & vbNewLine _
                                             & ",MDOUTU.EDI_CD           AS EDISHIP_CD         --2012/05/23                                                                    " & vbNewLine _
                                             & ",MDOUT.EDI_CD            AS EDIDEST_CD         --2012/05/23                                                                    " & vbNewLine _
                                             & "--日医工対策終了                                                                                                               " & vbNewLine _
                                             & "--(2012.06.01) 日本ﾌｧｲﾝ対応  --- START ---                                                                                     " & vbNewLine _
                                             & ",MCD_F.SET_NAIYO         AS SET_NAIYO_FROM1                                                                                    " & vbNewLine _
                                             & ",MCD_F.SET_NAIYO_2       AS SET_NAIYO_FROM2                                                                                    " & vbNewLine _
                                             & ",MCD_F.SET_NAIYO_3       AS SET_NAIYO_FROM3                                                                                    " & vbNewLine _
                                             & "--(2012.06.01) 日本ﾌｧｲﾝ対応  --- START ---                                                                                     " & vbNewLine _
                                             & "--【要望番号1122】埼玉対応 --- START ---                                                                                       " & vbNewLine _
                                             & ",MC.AD_3                 AS CUST_AD_3                                                                                          " & vbNewLine _
                                             & ",MDOUT.REMARK            AS DEST_REMARK                                                                                        " & vbNewLine _
                                             & ",MDOUT.SALES_CD          AS DEST_SALES_CD                                                                                      " & vbNewLine _
                                             & ",MC_SALES.CUST_NM_L      AS DEST_SALES_NM                                                                                      " & vbNewLine _
                                             & ",MC_SALES.AD_1           AS DEST_SALES_AD_1                                                                                    " & vbNewLine _
                                             & ",MC_SALES.AD_2           AS DEST_SALES_AD_2                                                                                    " & vbNewLine _
                                             & ",MC_SALES.AD_3           AS DEST_SALES_AD_3                                                                                    " & vbNewLine _
                                             & ",MC_SALES.TEL            AS DEST_SALES_TEL                                                                                     " & vbNewLine _
                                             & "--【要望番号1122】埼玉対応 ---  END  ---                                                                                       " & vbNewLine _
                                             & "--群馬(合算)端数行分割版向け対応(作業略称) 開始20120731                                                                        " & vbNewLine _
                                             & "--1ここから                                                                                                                    " & vbNewLine _
                                             & ",ISNULL((SELECT BASE.SAGYO_RYAK                                                                                                " & vbNewLine _
                                             & "FROM                                                                                                                           " & vbNewLine _
                                             & "(SELECT                                                                                                                        " & vbNewLine _
                                             & "M_SAGYO.SAGYO_RYAK AS SAGYO_RYAK                                                                                               " & vbNewLine _
                                             & ",ROW_NUMBER() OVER (PARTITION BY INOUTKA_NO_LM ORDER BY INOUTKA_NO_LM) AS NUM                                                  " & vbNewLine _
                                             & "FROM $LM_TRN$..E_SAGYO E                                                                                                       " & vbNewLine _
                                             & "       JOIN $LM_MST$..M_SAGYO M_SAGYO                                                                                          " & vbNewLine _
                                             & "         ON M_SAGYO.NRS_BR_CD = E.NRS_BR_CD                                                                                    " & vbNewLine _
                                             & "        AND M_SAGYO.SAGYO_CD  = E.SAGYO_CD                                                                                     " & vbNewLine _
                                             & "WHERE E.NRS_BR_CD = OUTL.NRS_BR_CD AND E.INOUTKA_NO_LM = (OUTM.OUTKA_NO_L + OUTM.OUTKA_NO_M) AND E.IOZS_KB = '21'              " & vbNewLine _
                                             & ") AS BASE                                                                                                                      " & vbNewLine _
                                             & "WHERE BASE.NUM = 1),'') AS SAGYO_RYAK_1                                                                                        " & vbNewLine _
                                             & "--1ここまで                                                                                                                    " & vbNewLine _
                                             & "--2ここから                                                                                                                    " & vbNewLine _
                                             & ",ISNULL((SELECT BASE.SAGYO_RYAK                                                                                                " & vbNewLine _
                                             & "FROM                                                                                                                           " & vbNewLine _
                                             & "(SELECT                                                                                                                        " & vbNewLine _
                                             & "M_SAGYO.SAGYO_RYAK AS SAGYO_RYAK                                                                                               " & vbNewLine _
                                             & ",ROW_NUMBER() OVER (PARTITION BY INOUTKA_NO_LM ORDER BY INOUTKA_NO_LM) AS NUM                                                  " & vbNewLine _
                                             & "FROM $LM_TRN$..E_SAGYO E                                                                                                       " & vbNewLine _
                                             & "       JOIN $LM_MST$..M_SAGYO M_SAGYO                                                                                          " & vbNewLine _
                                             & "         ON M_SAGYO.NRS_BR_CD = E.NRS_BR_CD                                                                                    " & vbNewLine _
                                             & "        AND M_SAGYO.SAGYO_CD  = E.SAGYO_CD                                                                                     " & vbNewLine _
                                             & "WHERE E.NRS_BR_CD = OUTL.NRS_BR_CD AND E.INOUTKA_NO_LM = (OUTM.OUTKA_NO_L + OUTM.OUTKA_NO_M) AND E.IOZS_KB = '21'              " & vbNewLine _
                                             & ") AS BASE                                                                                                                      " & vbNewLine _
                                             & "WHERE BASE.NUM = 2),'') AS SAGYO_RYAK_2                                                                                        " & vbNewLine _
                                             & "--2ここまで                                                                                                                    " & vbNewLine _
                                             & "--3ここから                                                                                                                    " & vbNewLine _
                                             & ",ISNULL((SELECT BASE.SAGYO_RYAK                                                                                                " & vbNewLine _
                                             & "FROM                                                                                                                           " & vbNewLine _
                                             & "(SELECT                                                                                                                        " & vbNewLine _
                                             & "M_SAGYO.SAGYO_RYAK AS SAGYO_RYAK                                                                                               " & vbNewLine _
                                             & ",ROW_NUMBER() OVER (PARTITION BY INOUTKA_NO_LM ORDER BY INOUTKA_NO_LM) AS NUM                                                  " & vbNewLine _
                                             & "FROM $LM_TRN$..E_SAGYO E                                                                                                       " & vbNewLine _
                                             & "       JOIN $LM_MST$..M_SAGYO M_SAGYO                                                                                          " & vbNewLine _
                                             & "         ON M_SAGYO.NRS_BR_CD = E.NRS_BR_CD                                                                                    " & vbNewLine _
                                             & "        AND M_SAGYO.SAGYO_CD  = E.SAGYO_CD                                                                                     " & vbNewLine _
                                             & "WHERE E.NRS_BR_CD = OUTL.NRS_BR_CD AND E.INOUTKA_NO_LM = (OUTM.OUTKA_NO_L + OUTM.OUTKA_NO_M) AND E.IOZS_KB = '21'              " & vbNewLine _
                                             & ") AS BASE                                                                                                                      " & vbNewLine _
                                             & "WHERE BASE.NUM = 3),'') AS SAGYO_RYAK_3                                                                                        " & vbNewLine _
                                             & "--3ここまで                                                                                                                    " & vbNewLine _
                                             & "--4ここから                                                                                                                    " & vbNewLine _
                                             & ",ISNULL((SELECT BASE.SAGYO_RYAK                                                                                                " & vbNewLine _
                                             & "FROM                                                                                                                           " & vbNewLine _
                                             & "(SELECT                                                                                                                        " & vbNewLine _
                                             & "M_SAGYO.SAGYO_RYAK AS SAGYO_RYAK                                                                                               " & vbNewLine _
                                             & ",ROW_NUMBER() OVER (PARTITION BY INOUTKA_NO_LM ORDER BY INOUTKA_NO_LM) AS NUM                                                  " & vbNewLine _
                                             & "FROM $LM_TRN$..E_SAGYO E                                                                                                       " & vbNewLine _
                                             & "       JOIN $LM_MST$..M_SAGYO M_SAGYO                                                                                          " & vbNewLine _
                                             & "         ON M_SAGYO.NRS_BR_CD = E.NRS_BR_CD                                                                                    " & vbNewLine _
                                             & "        AND M_SAGYO.SAGYO_CD  = E.SAGYO_CD                                                                                     " & vbNewLine _
                                             & "WHERE E.NRS_BR_CD = OUTL.NRS_BR_CD AND E.INOUTKA_NO_LM = (OUTM.OUTKA_NO_L + OUTM.OUTKA_NO_M) AND E.IOZS_KB = '21'              " & vbNewLine _
                                             & ") AS BASE                                                                                                                      " & vbNewLine _
                                             & "WHERE BASE.NUM = 4),'') AS SAGYO_RYAK_4                                                                                        " & vbNewLine _
                                             & "--4ここまで                                                                                                                    " & vbNewLine _
                                             & "--5ここから                                                                                                                    " & vbNewLine _
                                             & ",ISNULL((SELECT BASE.SAGYO_RYAK                                                                                                " & vbNewLine _
                                             & "FROM                                                                                                                           " & vbNewLine _
                                             & "(SELECT                                                                                                                        " & vbNewLine _
                                             & "M_SAGYO.SAGYO_RYAK AS SAGYO_RYAK                                                                                               " & vbNewLine _
                                             & ",ROW_NUMBER() OVER (PARTITION BY INOUTKA_NO_LM ORDER BY INOUTKA_NO_LM) AS NUM                                                  " & vbNewLine _
                                             & "FROM $LM_TRN$..E_SAGYO E                                                                                                       " & vbNewLine _
                                             & "       JOIN $LM_MST$..M_SAGYO M_SAGYO                                                                                          " & vbNewLine _
                                             & "         ON M_SAGYO.NRS_BR_CD = E.NRS_BR_CD                                                                                    " & vbNewLine _
                                             & "        AND M_SAGYO.SAGYO_CD  = E.SAGYO_CD                                                                                     " & vbNewLine _
                                             & "WHERE E.NRS_BR_CD = OUTL.NRS_BR_CD AND E.INOUTKA_NO_LM = (OUTM.OUTKA_NO_L + OUTM.OUTKA_NO_M) AND E.IOZS_KB = '21'              " & vbNewLine _
                                             & ") AS BASE                                                                                                                      " & vbNewLine _
                                             & "WHERE BASE.NUM = 5),'') AS SAGYO_RYAK_5                                                                                        " & vbNewLine _
                                             & "--5ここまで                                                                                                                    " & vbNewLine _
                                             & "--届け先1ここから                                                                                                              " & vbNewLine _
                                             & ",ISNULL((SELECT BASE.SAGYO_RYAK                                                                                                " & vbNewLine _
                                             & "FROM                                                                                                                           " & vbNewLine _
                                             & "(SELECT                                                                                                                        " & vbNewLine _
                                             & "M_SAGYO.SAGYO_RYAK AS SAGYO_RYAK                                                                                               " & vbNewLine _
                                             & ",ROW_NUMBER() OVER (PARTITION BY INOUTKA_NO_LM ORDER BY INOUTKA_NO_LM) AS NUM                                                  " & vbNewLine _
                                             & "FROM $LM_TRN$..E_SAGYO E                                                                                                       " & vbNewLine _
                                             & "       JOIN $LM_MST$..M_SAGYO M_SAGYO                                                                                          " & vbNewLine _
                                             & "         ON M_SAGYO.NRS_BR_CD = E.NRS_BR_CD                                                                                    " & vbNewLine _
                                             & "        AND M_SAGYO.SAGYO_CD  = E.SAGYO_CD                                                                                     " & vbNewLine _
                                             & "WHERE E.NRS_BR_CD = OUTL.NRS_BR_CD AND E.INOUTKA_NO_LM = (OUTM.OUTKA_NO_L + OUTM.OUTKA_NO_M) AND E.IOZS_KB = '21'              " & vbNewLine _
                                             & ") AS BASE                                                                                                                      " & vbNewLine _
                                             & "WHERE BASE.NUM = 6),'') AS DEST_SAGYO_RYAK_1                                                                                   " & vbNewLine _
                                             & "--届け先1ここまで                                                                                                              " & vbNewLine _
                                             & "--届け先2ここから                                                                                                              " & vbNewLine _
                                             & ",ISNULL((SELECT BASE.SAGYO_RYAK                                                                                                " & vbNewLine _
                                             & "FROM                                                                                                                           " & vbNewLine _
                                             & "(SELECT                                                                                                                        " & vbNewLine _
                                             & "M_SAGYO.SAGYO_RYAK AS SAGYO_RYAK                                                                                               " & vbNewLine _
                                             & ",ROW_NUMBER() OVER (PARTITION BY INOUTKA_NO_LM ORDER BY INOUTKA_NO_LM) AS NUM                                                  " & vbNewLine _
                                             & "FROM $LM_TRN$..E_SAGYO E                                                                                                       " & vbNewLine _
                                             & "       JOIN $LM_MST$..M_SAGYO M_SAGYO                                                                                          " & vbNewLine _
                                             & "         ON M_SAGYO.NRS_BR_CD = E.NRS_BR_CD                                                                                    " & vbNewLine _
                                             & "        AND M_SAGYO.SAGYO_CD  = E.SAGYO_CD                                                                                     " & vbNewLine _
                                             & "WHERE E.NRS_BR_CD = OUTL.NRS_BR_CD AND E.INOUTKA_NO_LM = (OUTM.OUTKA_NO_L + OUTM.OUTKA_NO_M) AND E.IOZS_KB = '21'              " & vbNewLine _
                                             & ") AS BASE                                                                                                                      " & vbNewLine _
                                             & "WHERE BASE.NUM = 7),'') AS DEST_SAGYO_RYAK_2                                                                                   " & vbNewLine _
                                             & "--届け先ここまで                                                                                                               " & vbNewLine _
                                             & "--群馬(合算)端数行分割版向け対応(作業略称) 終了20120731                                                                        " & vbNewLine _
                                             & "--群馬篠崎運送向け自由項目対応　開始　                                                                                         " & vbNewLine _
                                             & ",EDIM.FREE_C07           AS SZ01_YUSO --篠崎                                                                                   " & vbNewLine _
                                             & ",EDIM.FREE_C09           AS SZ01_UNSO --篠崎                                                                                   " & vbNewLine _
                                             & "--群馬篠崎運送向け自由項目対応　終了                                                                                         　" & vbNewLine _
                                             & "--(2012.10.19)要望番号1289 -- START --                                                                                         " & vbNewLine _
                                             & "      ,MGD.SET_NAIYO                      AS  SET_NAIYO                                                                        " & vbNewLine _
                                             & "--(2012.10.19)要望番号1289 --  END  --                                                                                         " & vbNewLine _
                                             & ",KBN10.KBN_NM1            AS SHOBO_KBN_NM                                                                                      " & vbNewLine _
                                             & ",MSHOBO.HINMEI            AS HINMEI                                                                                            " & vbNewLine _
                                             & "--(2012.11.28) LMC637対応 -- START --                                                                                          " & vbNewLine _
                                             & ",MG.CUST_CD_M             AS CUST_CD_M                                                                                         " & vbNewLine _
                                             & ",MG.CUST_CD_S             AS CUST_CD_S                                                                                         " & vbNewLine _
                                             & ",MG.CUST_COST_CD2         AS CUST_COST_CD2                                                                                     " & vbNewLine _
                                             & "--(2012.11.28) LMC637対応 --  END  --                                                                                          " & vbNewLine _
                                             & "--(2016.7.13) LMC629:製造日表示 -- START --                                                                                    " & vbNewLine _
                                             & ",ZAI.GOODS_CRT_DATE       AS GOODS_CRT_DATE                                                                                    " & vbNewLine _
                                             & "--(2016.7.13) LMC629:製造日表示 --  END  --                                                                                    " & vbNewLine _
                                             & "--出荷L                                                                                                                        " & vbNewLine _
                                             & "FROM                                                                                                                           " & vbNewLine _
                                             & "$LM_TRN$..C_OUTKA_L OUTL                                                                                                       " & vbNewLine _
                                             & "--トランザクションテーブル                                                                                                     " & vbNewLine _
                                             & "--出荷M                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..C_OUTKA_M OUTM                                                                                             " & vbNewLine _
                                             & "ON  OUTM.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "AND OUTM.OUTKA_NO_L = OUTL.OUTKA_NO_L                                                                                          " & vbNewLine _
                                             & "AND OUTM.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--★★★追加開始--------------------------------                                                                               " & vbNewLine _
                                             & "--出荷M(中MIN)                                                                                                                 " & vbNewLine _
                                             & "LEFT OUTER JOIN                                                                                                                " & vbNewLine _
                                             & "       (SELECT                                                                                                                 " & vbNewLine _
                                             & "           NRS_BR_CD                                                                                                           " & vbNewLine _
                                             & "           ,OUTKA_NO_L                                                                                                         " & vbNewLine _
                                             & "           ,MIN(OUTKA_NO_M) AS  OUTKA_NO_M                                                                                     " & vbNewLine _
                                             & "       FROM $LM_TRN$..C_OUTKA_M WHERE SYS_DEL_FLG ='0'                                                                         " & vbNewLine _
                                             & "        AND NRS_BR_CD = @NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "        AND OUTKA_NO_L = @KANRI_NO_L                                                                                           " & vbNewLine _
                                             & "       GROUP BY NRS_BR_CD,OUTKA_NO_L) OUTM_MIN                                                                                 " & vbNewLine _
                                             & "       ON OUTM_MIN.NRS_BR_CD        = OUTL.NRS_BR_CD                                                                           " & vbNewLine _
                                             & "       AND OUTM_MIN.OUTKA_NO_L      = OUTL.OUTKA_NO_L                                                                          " & vbNewLine _
                                             & "--出荷M(中MIN)                                                                                                                 " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..C_OUTKA_M OUTM2                                                                                            " & vbNewLine _
                                             & "ON  OUTM2.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                           " & vbNewLine _
                                             & "AND OUTM2.OUTKA_NO_L = OUTL.OUTKA_NO_L                                                                                         " & vbNewLine _
                                             & "AND OUTM2.OUTKA_NO_M = OUTM_MIN.OUTKA_NO_M                                                                                     " & vbNewLine _
                                             & "AND OUTM2.SYS_DEL_FLG = '0'                                                                                                    " & vbNewLine _
                                             & "--★★★追加終了--------------------------------                                                                               " & vbNewLine _
                                             & "--出荷S                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..C_OUTKA_S OUTS                                                                                             " & vbNewLine _
                                             & "ON  OUTS.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "AND OUTS.OUTKA_NO_L = OUTL.OUTKA_NO_L                                                                                          " & vbNewLine _
                                             & "AND OUTS.OUTKA_NO_M = OUTM.OUTKA_NO_M                                                                                          " & vbNewLine _
                                             & "AND OUTS.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--出荷EDIL                                                                                                                     " & vbNewLine _
                                             & "--(2012.09.06)要望番号1412対応  --- START ---                                                                                  " & vbNewLine _
                                             & "--LEFT JOIN                                                                                                                    " & vbNewLine _
                                             & "--(                                                                                                                            " & vbNewLine _
                                             & "--SELECT                                                                                                                       " & vbNewLine _
                                             & "-- --20120730 MIN化　開始(20120803取りやめ)                                                                                    " & vbNewLine _
                                             & "-- --MIN(NRS_BR_CD)    AS NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "-- --,MIN(OUTKA_CTL_NO) AS OUTKA_CTL_NO                                                                                        " & vbNewLine _
                                             & "-- --,MIN(CUST_CD_L)    AS CUST_CD_L                                                                                           " & vbNewLine _
                                             & "-- NRS_BR_CD                                                                                                                   " & vbNewLine _
                                             & "--,OUTKA_CTL_NO                                                                                                                " & vbNewLine _
                                             & "--,CUST_CD_L                                                                                                                   " & vbNewLine _
                                             & "-- --20120730 MIN化　終了                                                                                                      " & vbNewLine _
                                             & "----★削除開始2012/05/11                                                                                                       " & vbNewLine _
                                             & "----,SHIP_NM_L                                                                                                                 " & vbNewLine _
                                             & "----★削除終了2012/05/11                                                                                                       " & vbNewLine _
                                             & "--,MIN(DEST_CD)     AS DEST_CD                                                                                                 " & vbNewLine _
                                             & "--,MIN(DEST_NM)     AS DEST_NM                                                                                                 " & vbNewLine _
                                             & "--,MIN(DEST_AD_1)   AS DEST_AD_1                                                                                               " & vbNewLine _
                                             & "--,MIN(DEST_AD_2)   AS DEST_AD_2                                                                                               " & vbNewLine _
                                             & "----(2012.04.11)【Notes】№923  DEST_JIS_CDはMINで抽出 -- START --                                                             " & vbNewLine _
                                             & "----,DEST_JIS_CD                                                                                                               " & vbNewLine _
                                             & "--,MIN(DEST_JIS_CD) AS DEST_JIS_CD                                                                                             " & vbNewLine _
                                             & "----(2012.04.11)【Notes】№923  DEST_JIS_CDはMINで抽出 --  END  --                                                             " & vbNewLine _
                                             & "-- --20120730 MIN化　開始                                                                                                      " & vbNewLine _
                                             & "--,MIN(FREE_C01)   AS FREE_C01                                                                                                 " & vbNewLine _
                                             & "--,MIN(FREE_C08)   AS FREE_C08                                                                                                 " & vbNewLine _
                                             & "--,MIN(FREE_C11)   AS FREE_C11                                                                                                 " & vbNewLine _
                                             & "-- --20120730 MIN化　終了                                                                                                      " & vbNewLine _
                                             & "--,SYS_DEL_FLG                                                                                                                 " & vbNewLine _
                                             & "--FROM                                                                                                                         " & vbNewLine _
                                             & "--$LM_TRN$..H_OUTKAEDI_L                                                                                                       " & vbNewLine _
                                             & "--GROUP BY                                                                                                                     " & vbNewLine _
                                             & "-- --20120730 MIN化によるコメントアウト　開始 (20120803取りやめ)                                                               " & vbNewLine _
                                             & "-- NRS_BR_CD                                                                                                                   " & vbNewLine _
                                             & "--,OUTKA_CTL_NO                                                                                                                " & vbNewLine _
                                             & "--,CUST_CD_L                                                                                                                   " & vbNewLine _
                                             & "-- --20120730 MIN化によるコメントアウト　終了                                                                                  " & vbNewLine _
                                             & "----★削除開始2012/05/11                                                                                                       " & vbNewLine _
                                             & "----,SHIP_NM_L                                                                                                                 " & vbNewLine _
                                             & "----★削除開始2012/05/11                                                                                                       " & vbNewLine _
                                             & "----(2012.04.11) Notes№923  DEST_JIS_CDはMINで抽出のためコメント -- START --                                                  " & vbNewLine _
                                             & "----,DEST_JIS_CD                                                                                                               " & vbNewLine _
                                             & "----(2012.04.11) Notes№923  DEST_JIS_CDはMINで抽出のためコメント --  END  --                                                  " & vbNewLine _
                                             & "-- --20120730 MIN化によるコメントアウト　開始                                                                                  " & vbNewLine _
                                             & "----,FREE_C01                                                                                                                  " & vbNewLine _
                                             & "----,FREE_C08                                                                                                                  " & vbNewLine _
                                             & "----,FREE_C11                                                                                                                  " & vbNewLine _
                                             & "-- --20120730 MIN化によるコメントアウト　終了 ↓SYS_DEL_FLGのカンマ除去↓                                                      " & vbNewLine _
                                             & "--,SYS_DEL_FLG                                                                                                                 " & vbNewLine _
                                             & "--) EDIL                                                                                                                       " & vbNewLine _
                                             & "--ON  EDIL.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                          " & vbNewLine _
                                             & "--下記の内容に変更                                                                                                             " & vbNewLine _
                                             & " LEFT JOIN (                                                                                                                   " & vbNewLine _
                                             & "            SELECT                                                                                                             " & vbNewLine _
                                             & "                   NRS_BR_CD                                                                                                   " & vbNewLine _
                                             & "                 , EDI_CTL_NO                                                                                                  " & vbNewLine _
                                             & "                 , OUTKA_CTL_NO                                                                                                " & vbNewLine _
                                             & "             FROM (                                                                                                            " & vbNewLine _
                                             & "                    SELECT                                                                                                     " & vbNewLine _
                                             & "                           EDIOUTL.NRS_BR_CD                                                                                   " & vbNewLine _
                                             & "                         , EDIOUTL.EDI_CTL_NO                                                                                  " & vbNewLine _
                                             & "                         , EDIOUTL.OUTKA_CTL_NO                                                                                " & vbNewLine _
                                             & "                         , CASE WHEN EDIOUTL.OUTKA_CTL_NO = '' THEN 1                                                          " & vbNewLine _
                                             & "                           ELSE ROW_NUMBER() OVER (PARTITION BY EDIOUTL.NRS_BR_CD                                              " & vbNewLine _
                                             & "                                                              , EDIOUTL.OUTKA_CTL_NO                                           " & vbNewLine _
                                             & "                                                       ORDER BY EDIOUTL.NRS_BR_CD                                              " & vbNewLine _
                                             & "                                                              , EDIOUTL.EDI_CTL_NO                                             " & vbNewLine _
                                             & "                                                  )                                                                            " & vbNewLine _
                                             & "                           END AS IDX                                                                                          " & vbNewLine _
                                             & "                     FROM $LM_TRN$..H_OUTKAEDI_L EDIOUTL                                                                       " & vbNewLine _
                                             & "                    WHERE EDIOUTL.SYS_DEL_FLG  = '0'                                                                           " & vbNewLine _
                                             & "                      AND EDIOUTL.NRS_BR_CD    = @NRS_BR_CD                                                                    " & vbNewLine _
                                             & "                      AND EDIOUTL.OUTKA_CTL_NO = @KANRI_NO_L                                                                   " & vbNewLine _
                                             & "                  ) EBASE                                                                                                      " & vbNewLine _
                                             & "            WHERE EBASE.IDX = 1                                                                                                " & vbNewLine _
                                             & "            ) TOPEDI                                                                                                           " & vbNewLine _
                                             & "        ON TOPEDI.NRS_BR_CD    = OUTL.NRS_BR_CD                                                                                " & vbNewLine _
                                             & "       AND TOPEDI.OUTKA_CTL_NO = OUTL.OUTKA_NO_L                                                                               " & vbNewLine _
                                             & " LEFT JOIN $LM_TRN$..H_OUTKAEDI_L EDIL                                                                                         " & vbNewLine _
                                             & "        ON EDIL.NRS_BR_CD  = TOPEDI.NRS_BR_CD                                                                                  " & vbNewLine _
                                             & "       AND EDIL.EDI_CTL_NO = TOPEDI.EDI_CTL_NO                                                                                 " & vbNewLine _
                                             & "--(2012.09.06)要望番号1412対応  ---  END  ---                                                                                  " & vbNewLine _
                                             & "--入荷L                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..B_INKA_L INL                                                                                               " & vbNewLine _
                                             & "ON  INL.NRS_BR_CD = OUTS.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "AND INL.INKA_NO_L = OUTS.INKA_NO_L                                                                                             " & vbNewLine _
                                             & "AND INL.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--入荷S                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..B_INKA_S INS                                                                                               " & vbNewLine _
                                             & "ON  INS.NRS_BR_CD = OUTS.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "AND INS.INKA_NO_L = OUTS.INKA_NO_L                                                                                             " & vbNewLine _
                                             & "AND INS.INKA_NO_M = OUTS.INKA_NO_M                                                                                             " & vbNewLine _
                                             & "AND INS.INKA_NO_S = OUTS.INKA_NO_S                                                                                             " & vbNewLine _
                                             & "AND INS.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--運送L                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..F_UNSO_L UL                                                                                                " & vbNewLine _
                                             & "ON  UL.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                              " & vbNewLine _
                                             & "AND UL.INOUTKA_NO_L = OUTL.OUTKA_NO_L                                                                                          " & vbNewLine _
                                             & "AND UL.MOTO_DATA_KB = '20'                                                                                                     " & vbNewLine _
                                             & "AND UL.SYS_DEL_FLG = '0'                                                                                                       " & vbNewLine _
                                             & "--在庫テーブル                                                                                                                 " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..D_ZAI_TRS ZAI                                                                                              " & vbNewLine _
                                             & "ON  ZAI.NRS_BR_CD = OUTS.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "AND ZAI.ZAI_REC_NO = OUTS.ZAI_REC_NO                                                                                           " & vbNewLine _
                                             & "AND ZAI.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--マスタテーブル                                                                                                               " & vbNewLine _
                                             & "--営業所M                                                                                                                      " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_NRS_BR MNRS                                                                                              " & vbNewLine _
                                             & "ON MNRS.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "--商品M                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_GOODS MG                                                                                                 " & vbNewLine _
                                             & "ON  MG.NRS_BR_CD = OUTM.NRS_BR_CD                                                                                              " & vbNewLine _
                                             & "AND MG.GOODS_CD_NRS = OUTM.GOODS_CD_NRS                                                                                        " & vbNewLine _
                                             & "--★★★追加開始--------------------------------                                                                                     " & vbNewLine _
                                             & "--商品M(MIN)                                                                                                                   " & vbNewLine _
                                             & "LEFT OUTER JOIN $LM_MST$..M_GOODS M_GOODS_MIN                                                                                  " & vbNewLine _
                                             & "ON M_GOODS_MIN.NRS_BR_CD      = OUTL.NRS_BR_CD                                                                                 " & vbNewLine _
                                             & "AND M_GOODS_MIN.GOODS_CD_NRS   = OUTM2.GOODS_CD_NRS                                                                            " & vbNewLine _
                                             & "--★★★追加終了--------------------------------                                                                                     " & vbNewLine _
                                             & "--荷主M(商品M経由)                                                                                                             " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST MC                                                                                                  " & vbNewLine _
                                             & "ON  MC.NRS_BR_CD = MG.NRS_BR_CD                                                                                                " & vbNewLine _
                                             & "AND MC.CUST_CD_L = MG.CUST_CD_L                                                                                                " & vbNewLine _
                                             & "AND MC.CUST_CD_M = MG.CUST_CD_M                                                                                                " & vbNewLine _
                                             & "AND MC.CUST_CD_S = MG.CUST_CD_S                                                                                                " & vbNewLine _
                                             & "AND MC.CUST_CD_SS = MG.CUST_CD_SS                                                                                              " & vbNewLine _
                                             & "--★★★追加開始--------------------------------                                                                               " & vbNewLine _
                                             & "--荷主M(商品M経由) 最小の出荷(中)で抽出                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST MC2                                                                                                 " & vbNewLine _
                                             & "ON  MC2.NRS_BR_CD = M_GOODS_MIN.NRS_BR_CD                                                                                      " & vbNewLine _
                                             & "AND MC2.CUST_CD_L = M_GOODS_MIN.CUST_CD_L                                                                                      " & vbNewLine _
                                             & "AND MC2.CUST_CD_M = M_GOODS_MIN.CUST_CD_M                                                                                      " & vbNewLine _
                                             & "AND MC2.CUST_CD_S = M_GOODS_MIN.CUST_CD_S                                                                                      " & vbNewLine _
                                             & "AND MC2.CUST_CD_SS = M_GOODS_MIN.CUST_CD_SS                                                                                    " & vbNewLine _
                                             & "AND MC2.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--★★★追加終了--------------------------------                                                                               " & vbNewLine _
                                             & "--届先M(届先取得)(出荷L参照)                                                                                                   " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_DEST MDOUT                                                                                               " & vbNewLine _
                                             & "ON  MDOUT.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                           " & vbNewLine _
                                             & "AND MDOUT.CUST_CD_L = OUTL.CUST_CD_L                                                                                           " & vbNewLine _
                                             & "AND MDOUT.DEST_CD = OUTL.DEST_CD                                                                                               " & vbNewLine _
                                             & "--届先M(売上先取得)(出荷L参照)                                                                                                 " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_DEST MDOUTU                                                                                              " & vbNewLine _
                                             & "ON  MDOUTU.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                          " & vbNewLine _
                                             & "AND MDOUTU.CUST_CD_L = OUTL.CUST_CD_L                                                                                          " & vbNewLine _
                                             & "AND MDOUTU.DEST_CD = OUTL.SHIP_CD_L                                                                                            " & vbNewLine _
                                             & "--届先M(届先取得)(出荷EDIL参照)                                                                                                " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_DEST MDEDI                                                                                               " & vbNewLine _
                                             & "ON  MDEDI.NRS_BR_CD = EDIL.NRS_BR_CD                                                                                           " & vbNewLine _
                                             & "AND MDEDI.CUST_CD_L = EDIL.CUST_CD_L                                                                                           " & vbNewLine _
                                             & "AND MDEDI.DEST_CD = EDIL.DEST_CD                                                                                               " & vbNewLine _
                                             & "--【要望番号1122】埼玉対応 --- START ---                                                                                       " & vbNewLine _
                                             & "--届先M(納品書荷主名義名取得)(届先M参照)                                                                                       " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST MC_SALES                                                                                            " & vbNewLine _
                                             & "       ON MC_SALES.NRS_BR_CD  = MDOUT.NRS_BR_CD                                                                                " & vbNewLine _
                                             & "      AND MC_SALES.CUST_CD_L  = MDOUT.SALES_CD                                                                                 " & vbNewLine _
                                             & "      AND MC_SALES.CUST_CD_M  = '00'                                                                                           " & vbNewLine _
                                             & "      AND MC_SALES.CUST_CD_S  = '00'                                                                                           " & vbNewLine _
                                             & "      AND MC_SALES.CUST_CD_SS = '00'                                                                                           " & vbNewLine _
                                             & "--【要望番号1122】埼玉対応 ---  END  ---                                                                                       " & vbNewLine _
                                             & "--運送会社M                                                                                                                    " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_UNSOCO MUCO                                                                                              " & vbNewLine _
                                             & "ON  MUCO.NRS_BR_CD = UL.NRS_BR_CD                                                                                              " & vbNewLine _
                                             & "AND MUCO.UNSOCO_CD = UL.UNSO_CD                                                                                                " & vbNewLine _
                                             & "AND MUCO.UNSOCO_BR_CD = UL.UNSO_BR_CD                                                                                          " & vbNewLine _
                                             & "--倉庫M                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_SOKO MSO                                                                                                 " & vbNewLine _
                                             & "ON  MSO.NRS_BR_CD = OUTL.NRS_BR_CD  --追加                                                                                     " & vbNewLine _
                                             & "AND MSO.WH_CD     = OUTL.WH_CD                                                                                                 " & vbNewLine _
                                             & "--2014/5/16Start s.kobayashi NotesNo.2183                                                                                      " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN11                                                                                                " & vbNewLine _
                                             & "ON  KBN11.KBN_GROUP_CD = 'U028'  --追加                                                                                        " & vbNewLine _
                                             & "AND UL.SEIQ_TARIFF_CD = KBN11.KBN_NM1                                                                                          " & vbNewLine _
                                             & "--2014/5/16End s.kobayashi NotesNo.2183                                                                                       " & vbNewLine _
                                             & "--距離程M(M_DEST.JIS < M_SOKO.JIS_CD)(出荷L参照)                                                                               " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_KYORI MKY1                                                                                               " & vbNewLine _
                                             & "ON  MKY1.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "--AND MKY1.KYORI_CD = MC.BETU_KYORI_CD                                                                                           " & vbNewLine _
                                             & "AND MKY1.KYORI_CD = (CASE ISNULL(KBN11.KBN_NM2,'') WHEN '' THEN MC.BETU_KYORI_CD ELSE KBN11.KBN_NM2 END)                       " & vbNewLine _
                                             & "AND MKY1.ORIG_JIS_CD = MDOUT.JIS                                                                                               " & vbNewLine _
                                             & "AND MKY1.DEST_JIS_CD = MSO.JIS_CD                                                                                              " & vbNewLine _
                                             & "--距離程M(M_SOKO.JIS_CD < M_DEST.JIS)(出荷L参照)                                                                               " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_KYORI MKY2                                                                                               " & vbNewLine _
                                             & "ON  MKY2.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "--AND MKY2.KYORI_CD = MC.BETU_KYORI_CD                                                                                           " & vbNewLine _
                                             & "AND MKY2.KYORI_CD = (CASE ISNULL(KBN11.KBN_NM2,'') WHEN '' THEN MC.BETU_KYORI_CD ELSE KBN11.KBN_NM2 END)                       " & vbNewLine _
                                             & "AND MKY2.ORIG_JIS_CD = MSO.JIS_CD                                                                                              " & vbNewLine _
                                             & "AND MKY2.DEST_JIS_CD = MDOUT.JIS                                                                                               " & vbNewLine _
                                             & "--距離程M(H_OUTKAEDI_L.DEST_JIS_CD < M_SOKO.JIS_CD)(出荷EDIL参照)                                                              " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_KYORI MKY3                                                                                               " & vbNewLine _
                                             & "ON  MKY3.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "--AND MKY3.KYORI_CD = MC.BETU_KYORI_CD                                                                                           " & vbNewLine _
                                             & "AND MKY3.KYORI_CD = (CASE ISNULL(KBN11.KBN_NM2,'') WHEN '' THEN MC.BETU_KYORI_CD ELSE KBN11.KBN_NM2 END)                       " & vbNewLine _
                                             & "AND MKY3.ORIG_JIS_CD = EDIL.DEST_JIS_CD                                                                                        " & vbNewLine _
                                             & "AND MKY3.DEST_JIS_CD = MSO.JIS_CD                                                                                              " & vbNewLine _
                                             & "--距離程M(M_SOKO.JIS_CD < H_OUTKAEDI_L.DEST_JIS_CD)(出荷EDIL参照)                                                              " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_KYORI MKY4                                                                                               " & vbNewLine _
                                             & "ON  MKY4.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "--AND MKY4.KYORI_CD = MC.BETU_KYORI_CD                                                                                           " & vbNewLine _
                                             & "AND MKY4.KYORI_CD = (CASE ISNULL(KBN11.KBN_NM2,'') WHEN '' THEN MC.BETU_KYORI_CD ELSE KBN11.KBN_NM2 END)                       " & vbNewLine _
                                             & "AND MKY4.ORIG_JIS_CD = MSO.JIS_CD                                                                                              " & vbNewLine _
                                             & "AND MKY4.DEST_JIS_CD = EDIL.DEST_JIS_CD                                                                                        " & vbNewLine _
                                             & "--届先商品M(出荷L参照)                                                                                                         " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_DESTGOODS MDGL                                                                                           " & vbNewLine _
                                             & "ON  MDGL.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "AND MDGL.CUST_CD_L = OUTL.CUST_CD_L                                                                                            " & vbNewLine _
                                             & "AND MDGL.CUST_CD_M = OUTL.CUST_CD_M                                                                                            " & vbNewLine _
                                             & "AND MDGL.CD = OUTL.DEST_CD                                                                                                     " & vbNewLine _
                                             & "AND MDGL.GOODS_CD_NRS = MG.GOODS_CD_NRS                                                                                        " & vbNewLine _
                                             & "AND MDGL.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--届先商品M(出荷EDI参照)                                                                                                       " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_DESTGOODS MDGE                                                                                           " & vbNewLine _
                                             & "ON  MDGE.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "AND MDGE.CUST_CD_L = OUTL.CUST_CD_L                                                                                            " & vbNewLine _
                                             & "AND MDGE.CUST_CD_M = OUTL.CUST_CD_M                                                                                            " & vbNewLine _
                                             & "AND MDGE.CD = EDIL.DEST_CD                                                                                                     " & vbNewLine _
                                             & "AND MDGE.GOODS_CD_NRS = MG.GOODS_CD_NRS                                                                                        " & vbNewLine _
                                             & "AND MDGE.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--消防M★                                                                                                      " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_SHOBO MSHOBO                                                                                           " & vbNewLine _
                                             & "ON  MSHOBO.SHOBO_CD = MG.SHOBO_CD                                                                                            " & vbNewLine _
                                             & "AND MSHOBO.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--区分M(納入予定区分)                                                                                                          " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN1                                                                                                 " & vbNewLine _
                                             & "ON  KBN1.KBN_GROUP_CD = 'N010'                                                                                                 " & vbNewLine _
                                             & "AND KBN1.KBN_CD = OUTL.ARR_PLAN_TIME                                                                                           " & vbNewLine _
                                             & "AND KBN1.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--区分M(日本合成用倉庫名)                                                                                                      " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN2                                                                                                 " & vbNewLine _
                                             & "ON  KBN2.KBN_GROUP_CD = 'P005'                                                                                                 " & vbNewLine _
                                             & "AND KBN2.KBN_CD = '00'                                                                                                         " & vbNewLine _
                                             & "AND KBN2.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--区分M(日本合成用部署名)                                                                                                      " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN3                                                                                                 " & vbNewLine _
                                             & "ON  KBN3.KBN_GROUP_CD = 'P005'                                                                                                 " & vbNewLine _
                                             & "AND KBN3.KBN_CD = '01'                                                                                                         " & vbNewLine _
                                             & "AND KBN3.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--区分M(日本合成用営業署名)                                                                                                    " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN4                                                                                                 " & vbNewLine _
                                             & "ON  KBN4.KBN_GROUP_CD = 'P005'                                                                                                 " & vbNewLine _
                                             & "AND KBN4.KBN_CD = '02'                                                                                                         " & vbNewLine _
                                             & "AND KBN4.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--区分M(荷姿)                                                                                                                  " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN5                                                                                                 " & vbNewLine _
                                             & "ON  KBN5.KBN_GROUP_CD = 'N001'                                                                                                 " & vbNewLine _
                                             & "AND KBN5.KBN_CD = MG.PKG_UT                                                                                                    " & vbNewLine _
                                             & "AND KBN5.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--明細タイトル（小分け）                                                                                                       " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN6                                                                                                 " & vbNewLine _
                                             & "ON  KBN6.KBN_GROUP_CD = 'S041'                                                                                                 " & vbNewLine _
                                             & "AND KBN6.KBN_CD = OUTM.ALCTD_KB                                                                                                " & vbNewLine _
                                             & "AND KBN6.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--区分M(毒劇区分名称)                                                                                                           " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN7                                                                                                  " & vbNewLine _
                                             & "ON  KBN7.KBN_GROUP_CD = 'G001'                                                                                                  " & vbNewLine _
                                             & "AND KBN7.KBN_CD = MG.DOKU_KB                                                                                                    " & vbNewLine _
                                             & "AND KBN7.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--【要望番号995】　2012/04/17　元着払い区分　START                                                                             " & vbNewLine _
                                             & "--区分M(元着払区分名称)                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN9                                                                                                 " & vbNewLine _
                                             & "ON  KBN9.KBN_GROUP_CD = 'M001'                                                                                                 " & vbNewLine _
                                             & "AND KBN9.KBN_CD = OUTL.PC_KB                                                                                                   " & vbNewLine _
                                             & "AND KBN9.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--【要望番号995】　2012/04/17　元着払い区分　 END                                                                              " & vbNewLine _
                                             & "--区分M(消防区分名称)★                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN10                                                                                                " & vbNewLine _
                                             & "ON  KBN10.KBN_GROUP_CD = 'S004'                                                                                                " & vbNewLine _
                                             & "AND KBN10.KBN_CD = MSHOBO.RUI                                                                                                  " & vbNewLine _
                                             & "AND KBN10.SYS_DEL_FLG = '0'                                                                                                    " & vbNewLine _
                                             & "--日医工対策開始                                                                                                               " & vbNewLine _
                                             & "--★出荷EDI M(日医工)                                                                                                          " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..H_OUTKAEDI_M EDIM                                                                                            " & vbNewLine _
                                             & "ON  EDIM.NRS_BR_CD        = OUTM.NRS_BR_CD                                                                                     " & vbNewLine _
                                             & "AND EDIM.OUTKA_CTL_NO     = OUTM.OUTKA_NO_L                                                                                    " & vbNewLine _
                                             & "AND EDIM.OUTKA_CTL_NO_CHU = OUTM.OUTKA_NO_M                                                                                    " & vbNewLine _
                                             & "AND EDIM.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--日医工_出荷指示EDIデータ                                                                                                     " & vbNewLine _
                                             & "--LEFT JOIN $LM_TRN$..H_OUTKAEDI_DTL_NIK EDIN                                                                                    " & vbNewLine _
                                             & "--ON   OUTL.NRS_BR_CD      = EDIN.NRS_BR_CD                                                                                      " & vbNewLine _
                                             & "--AND  EDIL.EDI_CTL_NO     = EDIN.EDI_CTL_NO                                                                                     " & vbNewLine _
                                             & "--AND  EDIM.EDI_CTL_NO_CHU = EDIN.EDI_CTL_NO_CHU                                                                                 " & vbNewLine _
                                             & "--AND  EDIN.SYS_DEL_FLG    = '0'                                                                                                 " & vbNewLine _
                                             & "                                                                                                                               " & vbNewLine _
                                             & "--荷主明細M ★                                                                                                                 " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST_DETAILS MCD_N                                                                                       " & vbNewLine _
                                             & "ON  MCD_N.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                           " & vbNewLine _
                                             & "AND MCD_N.CUST_CD   = OUTL.CUST_CD_L                                                                                           " & vbNewLine _
                                             & "AND MCD_N.SUB_KB = '26'                                                                                                        " & vbNewLine _
                                             & "--日医工対策終了                                                                                                               " & vbNewLine _
                                             & "--(2012.06.01) 日本ﾌｧｲﾝ対応  --- START ----                                                                                    " & vbNewLine _
                                             & "--荷主明細M                                                                                                                    " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST_DETAILS MCD_F                                                                                       " & vbNewLine _
                                             & "ON  MCD_F.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                           " & vbNewLine _
                                             & "AND MCD_F.CUST_CD   = OUTL.CUST_CD_L                                                                                           " & vbNewLine _
                                             & "AND MCD_F.SUB_KB = '29'                                                                                                        " & vbNewLine _
                                             & "--(2012.06.01) 日本ﾌｧｲﾝ対応  ---  END  ----                                                                                    " & vbNewLine _
                                             & "--荷主明細M ★                                                                                                                 " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST_DETAILS MCD                                                                                         " & vbNewLine _
                                             & "ON  MCD.NRS_BR_CD = MG.NRS_BR_CD                                                                                               " & vbNewLine _
                                             & "AND MCD.CUST_CD   = MG.CUST_CD_L                                                                                               " & vbNewLine _
                                             & "AND MCD.SUB_KB = '20'                                                                                                          " & vbNewLine _
                                             & "--(2012.11.21)要望番号1615 -- START --                                                                                         " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_GOODS_DETAILS MGD16                                                                                        " & vbNewLine _
                                             & "       ON MGD16.NRS_BR_CD = MG.NRS_BR_CD                                                                                       " & vbNewLine _
                                             & "      AND MGD16.GOODS_CD_NRS = MG.GOODS_CD_NRS                                                                                 " & vbNewLine _
                                             & "      AND MGD16.SUB_KB = '16'                                                                                                  " & vbNewLine _
                                             & "      AND MGD16.SYS_DEL_FLG = '0'                                                                                              " & vbNewLine _
                                             & "--(2012.11.21)要望番号1615 --  END  --                                                                                         " & vbNewLine _
                                             & "--出荷Lでの荷主帳票パターン取得                                                                                                " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST_RPT MCR1                                                                                            " & vbNewLine _
                                             & "ON  OUTL.NRS_BR_CD = MCR1.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "AND OUTL.CUST_CD_L = MCR1.CUST_CD_L                                                                                            " & vbNewLine _
                                             & "AND OUTL.CUST_CD_M = MCR1.CUST_CD_M                                                                                            " & vbNewLine _
                                             & "AND '00' = MCR1.CUST_CD_S                                                                                                      " & vbNewLine _
                                             & "AND MCR1.PTN_ID = '04'                                                                                                         " & vbNewLine _
                                             & "--帳票パターン取得                                                                                                             " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_RPT MR1                                                                                                  " & vbNewLine _
                                             & "ON  MR1.NRS_BR_CD = MCR1.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "AND MR1.PTN_ID = MCR1.PTN_ID                                                                                                   " & vbNewLine _
                                             & "AND MR1.PTN_CD = MCR1.PTN_CD                                                                                                   " & vbNewLine _
                                             & "AND MR1.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--商品Mの荷主での荷主帳票パターン取得                                                                                          " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST_RPT MCR2                                                                                            " & vbNewLine _
                                             & "ON  MG.NRS_BR_CD = MCR2.NRS_BR_CD                                                                                              " & vbNewLine _
                                             & "AND MG.CUST_CD_L = MCR2.CUST_CD_L                                                                                              " & vbNewLine _
                                             & "AND MG.CUST_CD_M = MCR2.CUST_CD_M                                                                                              " & vbNewLine _
                                             & "AND MG.CUST_CD_S = MCR2.CUST_CD_S                                                                                              " & vbNewLine _
                                             & "AND MCR2.PTN_ID = '04'                                                                                                         " & vbNewLine _
                                             & "--帳票パターン取得                                                                                                             " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_RPT MR2                                                                                                  " & vbNewLine _
                                             & "ON  MR2.NRS_BR_CD = MCR2.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "AND MR2.PTN_ID = MCR2.PTN_ID                                                                                                   " & vbNewLine _
                                             & "AND MR2.PTN_CD = MCR2.PTN_CD                                                                                                   " & vbNewLine _
                                             & "AND MR2.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--存在しない場合の帳票パターン取得                                                                                             " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_RPT MR3                                                                                                  " & vbNewLine _
                                             & "ON  MR3.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "AND MR3.PTN_ID = '04'                                                                                                          " & vbNewLine _
                                             & "AND MR3.STANDARD_FLAG = '01'                                                                                                   " & vbNewLine _
                                             & "AND MR3.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--ユーザM                                                                                                                      " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..S_USER MUSER                                                                                               " & vbNewLine _
                                             & "ON MUSER.USER_CD = OUTL.SYS_ENT_USER                                                                                           " & vbNewLine _
                                             & "AND MUSER.SYS_DEL_FLG = '0'                                                                                                    " & vbNewLine _
                                             & "--商品明細M                                                                                                                    " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_GOODS_DETAILS MGD                                                                                        " & vbNewLine _
                                             & "ON  MGD.NRS_BR_CD = MG.NRS_BR_CD                                                                                               " & vbNewLine _
                                             & "AND MGD.GOODS_CD_NRS = MG.GOODS_CD_NRS                                                                                         " & vbNewLine _
                                             & "AND MGD.SUB_KB = '09'                                                                                                          " & vbNewLine _
                                             & "AND MGD.SYS_DEL_FLG = '0'       --ADD 2019/02/07 依頼番号 : 004605   【LMS】納品書がの梱包個数が2倍になるバグ修正              " & vbNewLine _
                                             & "WHERE                                                                                                                          " & vbNewLine _
                                             & "    OUTL.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "AND OUTL.NRS_BR_CD = @NRS_BR_CD                                                                                                " & vbNewLine _
                                             & "AND OUTL.OUTKA_NO_L = @KANRI_NO_L "

    Friend Const SQL_SELECT_OUTKA_753 As String = "--★★★SQL_SELECT_OUTKA_753★★★  出荷テーブル                                                                           " & vbNewLine _
                                                 & "SELECT                                                                                                                         " & vbNewLine _
                                                 & " CASE WHEN MR2.PTN_CD IS NOT NULL THEN MR2.RPT_ID                                                                              " & vbNewLine _
                                                 & "      WHEN MR1.PTN_CD IS NOT NULL THEN MR1.RPT_ID                                                                              " & vbNewLine _
                                                 & "      ELSE MR3.RPT_ID                                                                                                          " & vbNewLine _
                                                 & " END              AS RPT_ID                                                                                                    " & vbNewLine _
                                                 & ",OUTL.NRS_BR_CD   AS NRS_BR_CD                                                                                                 " & vbNewLine _
                                                 & ",OUTM.PRINT_SORT  AS PRINT_SORT                                                                                                " & vbNewLine _
                                                 & ",CASE WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_CD                                                                     " & vbNewLine _
                                                 & "      ELSE OUTL.DEST_CD                                                                                                        " & vbNewLine _
                                                 & " END              AS DEST_CD                                                                                                   " & vbNewLine _
                                                 & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_NM                                                                               " & vbNewLine _
                                                 & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_NM                                                                     " & vbNewLine _
                                                 & "      ELSE MDOUT.DEST_NM                                                                                                       " & vbNewLine _
                                                 & " END              AS DEST_NM                                                                                                   " & vbNewLine _
                                                 & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_AD_1                                                                             " & vbNewLine _
                                                 & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_AD_1                                                                   " & vbNewLine _
                                                 & "      ELSE MDOUT.AD_1                                                                                                          " & vbNewLine _
                                                 & " END              AS DEST_AD_1                                                                                                 " & vbNewLine _
                                                 & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_AD_2                                                                             " & vbNewLine _
                                                 & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_AD_2                                                                   " & vbNewLine _
                                                 & "      ELSE MDOUT.AD_2                                                                                                          " & vbNewLine _
                                                 & " END              AS DEST_AD_2                                                                                                 " & vbNewLine _
                                                 & ",OUTL.DEST_AD_3   AS DEST_AD_3                                                                                                 " & vbNewLine _
                                                 & ",OUTL.DEST_TEL    AS DEST_TEL                                                                                                  " & vbNewLine _
                                                 & ",OUTL.OUTKA_PLAN_DATE   AS OUTKA_PLAN_DATE                                                                                     " & vbNewLine _
                                                 & ",OUTL.CUST_ORD_NO       AS CUST_ORD_NO                                                                                         " & vbNewLine _
                                                 & ",OUTL.BUYER_ORD_NO      AS BUYER_ORD_NO                                                                                        " & vbNewLine _
                                                 & ",MUCO.UNSOCO_NM         AS UNSOCO_NM                                                                                           " & vbNewLine _
                                                 & ",OUTL.ARR_PLAN_DATE     AS ARR_PLAN_DATE                                                                                       " & vbNewLine _
                                                 & ",KBN1.KBN_NM1           AS ARR_PLAN_TIME                                                                                       " & vbNewLine _
                                                 & ",OUTL.OUTKA_NO_L        AS OUTKA_NO_L                                                                                          " & vbNewLine _
                                                 & ",MDOUTU.DEST_NM         AS URIG_NM                                                                                             " & vbNewLine _
                                                 & ",MC.CUST_NM_L           AS CUST_NM_L                                                                                           " & vbNewLine _
                                                 & "--(2012.06.15) 要望番号1155 -- START --                                                                                        " & vbNewLine _
                                                 & ",MC.CUST_NM_M           AS CUST_NM_M                                                                                           " & vbNewLine _
                                                 & "--(2012.06.15) 要望番号1155 --  END  --                                                                                        " & vbNewLine _
                                                 & ",MC.AD_1                AS CUST_AD_1                                                                                           " & vbNewLine _
                                                 & ",MC.AD_2                AS CUST_AD_2                                                                                           " & vbNewLine _
                                                 & ",MC.TEL                 AS CUST_TEL                                                                                            " & vbNewLine _
                                                 & ",MC.DENPYO_NM           AS DENPYO_NM                                                                                            " & vbNewLine _
                                                 & ",MNRS.NRS_BR_NM         AS NRS_BR_NM                                                                                           " & vbNewLine _
                                                 & ",CASE WHEN MSO.WH_KB = '01' THEN MSO.AD_1                                                                             " & vbNewLine _
                                                 & "      ELSE MNRS.AD_1                                                                                                          " & vbNewLine _
                                                 & " END              AS NRS_BR_AD1                                                                                                 " & vbNewLine _
                                                 & ",CASE WHEN MSO.WH_KB = '01' THEN MSO.AD_2                                                                             " & vbNewLine _
                                                 & "      ELSE MNRS.AD_2                                                                                                          " & vbNewLine _
                                                 & " END              AS NRS_BR_AD2                                                                                                 " & vbNewLine _
                                                 & ",CASE WHEN MSO.WH_KB = '01' THEN MSO.TEL                                                                             " & vbNewLine _
                                                 & "      ELSE MNRS.TEL                                                                                                          " & vbNewLine _
                                                 & " END              AS NRS_BR_TEL                                                                                                 " & vbNewLine _
                                                 & ",CASE WHEN MSO.WH_KB = '01' THEN MSO.FAX                                                                             " & vbNewLine _
                                                 & "      ELSE MNRS.FAX                                                                                                          " & vbNewLine _
                                                 & " END              AS NRS_BR_FAX                                                                                                 " & vbNewLine _
                                                 & ",MUSER.USER_NM          AS PIC                                                                                                 " & vbNewLine _
                                                 & ",OUTM.OUTKA_NO_M        AS OUTKA_NO_M                                                                                          " & vbNewLine _
                                                 & ",OUTS.OUTKA_NO_S        AS OUTKA_NO_S                                                                                          " & vbNewLine _
                                                 & "--(2012.10.22)MGD.SET_NAIYOによる判定が必要か  -- START --                                                                     " & vbNewLine _
                                                 & "--,CASE WHEN MGD.SET_NAIYO = '1' THEN ''                                                                                       " & vbNewLine _
                                                 & "--      WHEN INL.INKA_STATE_KB < '50' THEN INL.INKA_DATE                                                                       " & vbNewLine _
                                                 & "--      WHEN INL.INKA_STATE_KB >= '50' THEN ZAI.INKO_DATE                                                                      " & vbNewLine _
                                                 & "--      ELSE ''                                                                                                                " & vbNewLine _
                                                 & "-- END                  AS INKA_DATE                                                                                           " & vbNewLine _
                                                 & ",CASE WHEN INL.INKA_STATE_KB < '50' THEN INL.INKA_DATE                                                                         " & vbNewLine _
                                                 & "      ELSE ZAI.INKO_DATE                                                                                                       " & vbNewLine _
                                                 & " END                    AS INKA_DATE                                                                                           " & vbNewLine _
                                                 & "--(2012.10.22)MGD.SET_NAIYOによる判定が必要か  --  END  --                                                                     " & vbNewLine _
                                                 & ",ZAI.REMARK_OUT         AS REMARK_OUT                                                                                          " & vbNewLine _
                                                 & ",CASE WHEN (MDGE.GOODS_NM IS NOT NULL AND MDGE.GOODS_NM <> '' AND EDIL.OUTKA_CTL_NO IS NOT NULL) THEN MDGE.GOODS_NM            " & vbNewLine _
                                                 & "      WHEN (MDGL.GOODS_NM IS NOT NULL AND MDGL.GOODS_NM <> '' AND EDIL.OUTKA_CTL_NO IS NULL) THEN MDGL.GOODS_NM                " & vbNewLine _
                                                 & "      ELSE MG.GOODS_NM_1                                                                                                       " & vbNewLine _
                                                 & " END                    AS GOODS_NM_1                                                                                          " & vbNewLine _
                                                 & ",OUTS.LOT_NO            AS LOT_NO                                                                                              " & vbNewLine _
                                                 & ",OUTS.SERIAL_NO         AS SERIAL_NO                                                                                           " & vbNewLine _
                                                 & ",OUTS.IRIME             AS IRIME                                                                                               " & vbNewLine _
                                                 & ",MG.PKG_NB              AS PKG_NB                                                                                              " & vbNewLine _
                                                 & ",OUTS.ALCTD_NB / MG.PKG_NB     AS KONSU                                                                                        " & vbNewLine _
                                                 & ",OUTS.ALCTD_NB % MG.PKG_NB     AS HASU                                                                                         " & vbNewLine _
                                                 & ",OUTS.ALCTD_NB          AS ALCTD_NB                                                                                            " & vbNewLine _
                                                 & ",MG.PKG_UT              AS PKG_UT                                                                                              " & vbNewLine _
                                                 & ",KBN5.KBN_NM1           AS PKG_UT_NM                                                                                           " & vbNewLine _
                                                 & ",OUTS.ALCTD_QT          AS ALCTD_QT                                                                                            " & vbNewLine _
                                                 & ",MG.STD_IRIME_UT        AS IRIME_UT                                                                                            " & vbNewLine _
                                                 & "--(2012.10.01)要望番号1445 -- START --                                                                                         " & vbNewLine _
                                                 & ",UL.UNSO_WT             AS WT                                                                                                  " & vbNewLine _
                                                 & "--,OUTS.BETU_WT * OUTS.ALCTD_NB  AS WT                                                                                         " & vbNewLine _
                                                 & "--(2012.10.01)要望番号1445 --  END  --                                                                                         " & vbNewLine _
                                                 & ",0                      AS UNSO_WT                                                                                             " & vbNewLine _
                                                 & "--(2012.11.21)要望番号1615 -- START --                                                                                         " & vbNewLine _
                                                 & ",CASE WHEN ISNUMERIC(MGD16.SET_NAIYO) = 1 THEN CONVERT(NUMERIC(12,3),MGD16.SET_NAIYO)                                          " & vbNewLine _
                                                 & "      ELSE 0                                                                                                                   " & vbNewLine _
                                                 & " END                    AS PKG_WT                                                                                              " & vbNewLine _
                                                 & "--(2012.11.21)要望番号1615 --  END  --                                                                                         " & vbNewLine _
                                                 & ",OUTS.TOU_NO            AS TOU_NO                                                                                              " & vbNewLine _
                                                 & ",OUTS.SITU_NO           AS SITU_NO                                                                                             " & vbNewLine _
                                                 & ",RTRIM(OUTS.ZONE_CD)     AS ZONE_CD                                                                                             " & vbNewLine _
                                                 & ",OUTS.LOCA              AS LOCA                                                                                                " & vbNewLine _
                                                 & ",OUTS.ALCTD_CAN_NB / MG.PKG_NB   AS ZAN_KONSU                                                                                  " & vbNewLine _
                                                 & ",OUTS.ALCTD_CAN_NB % MG.PKG_NB   AS ZAN_HASU                                                                                   " & vbNewLine _
                                                 & ",MG.GOODS_CD_CUST       AS GOODS_CD_CUST                                                                                       " & vbNewLine _
                                                 & ",OUTM.REMARK            AS REMARK_M                                                                                            " & vbNewLine _
                                                 & "--★★★変更開始--------------------------------                                                                                     " & vbNewLine _
                                                 & ",MC.CUST_NM_S  AS CUST_NM_S                                                                                           " & vbNewLine _
                                                 & ",MC2.CUST_NM_S   AS CUST_NM_S_H                                                                                           " & vbNewLine _
                                                 & "--★★★変更終了--------------------------------                                                                                     " & vbNewLine _
                                                 & ",OUTM.CUST_ORD_NO_DTL   AS CUST_ORD_NO_DTL                                                                                     " & vbNewLine _
                                                 & ",OUTL.REMARK            AS OUTKA_REMARK                                                                                        " & vbNewLine _
                                                 & ",UL.REMARK              AS HAISOU_REMARK                                                                                       " & vbNewLine _
                                                 & ",OUTL.NHS_REMARK        AS NHS_REMARK                                                                                          " & vbNewLine _
                                                 & "--(2012.08.06) 発JIS、着JISが共に同じJISでも、必ず0㎞になるのを修正  --- START ---                                             " & vbNewLine _
                                                 & "--,CASE WHEN (OUTL.DEST_KB = '02' AND MDEDI.KYORI > 0) THEN MDEDI.KYORI                                                        " & vbNewLine _
                                                 & "--      WHEN (OUTL.DEST_KB = '02' AND MDEDI.KYORI = 0 AND EDIL.DEST_JIS_CD < MSO.JIS_CD) THEN MKY3.KYORI                       " & vbNewLine _
                                                 & "--      WHEN (OUTL.DEST_KB = '02' AND MDEDI.KYORI = 0 AND MSO.JIS_CD < EDIL.DEST_JIS_CD) THEN MKY4.KYORI                       " & vbNewLine _
                                                 & "--      WHEN (OUTL.DEST_KB <> '02' AND MDOUT.KYORI > 0) THEN MDOUT.KYORI                                                       " & vbNewLine _
                                                 & "--      WHEN (OUTL.DEST_KB <> '02' AND MDOUT.KYORI = 0 AND MDOUT.JIS < MSO.JIS_CD) THEN MKY1.KYORI                             " & vbNewLine _
                                                 & "--      WHEN (OUTL.DEST_KB <> '02' AND MDOUT.KYORI = 0 AND MSO.JIS_CD < MDOUT.JIS) THEN MKY2.KYORI                             " & vbNewLine _
                                                 & "--      ELSE 0                                                                                                                 " & vbNewLine _
                                                 & "-- END                  AS KYORI                                                                                               " & vbNewLine _
                                                 & ",CASE WHEN (OUTL.DEST_KB = '02' AND MDEDI.KYORI > 0) THEN MDEDI.KYORI                                                          " & vbNewLine _
                                                 & "      WHEN (OUTL.DEST_KB = '02' AND MDEDI.KYORI = 0 AND EDIL.DEST_JIS_CD <= MSO.JIS_CD) THEN MKY3.KYORI                        " & vbNewLine _
                                                 & "      WHEN (OUTL.DEST_KB = '02' AND MDEDI.KYORI = 0 AND MSO.JIS_CD <= EDIL.DEST_JIS_CD) THEN MKY4.KYORI                        " & vbNewLine _
                                                 & "      WHEN (OUTL.DEST_KB <> '02' AND MDOUT.KYORI > 0) THEN MDOUT.KYORI                                                         " & vbNewLine _
                                                 & "      WHEN (OUTL.DEST_KB <> '02' AND MDOUT.KYORI = 0 AND MDOUT.JIS <= MSO.JIS_CD) THEN MKY1.KYORI                              " & vbNewLine _
                                                 & "      WHEN (OUTL.DEST_KB <> '02' AND MDOUT.KYORI = 0 AND MSO.JIS_CD <= MDOUT.JIS) THEN MKY2.KYORI                              " & vbNewLine _
                                                 & "      ELSE 0                                                                                                                   " & vbNewLine _
                                                 & " END                    AS KYORI                                                                                               " & vbNewLine _
                                                 & "--(2012.08.06) 発JIS、着JISが共に同じJISでも、必ず0㎞になるのを修正  ---  END  ---                                             " & vbNewLine _
                                                 & ",OUTL.OUTKA_PKG_NB      AS OUTKA_PKG_NB_L                                                                                      " & vbNewLine _
                                                 & ",KBN2.KBN_NM1           AS SOKO_NM                                                                                             " & vbNewLine _
                                                 & ",KBN3.KBN_NM1           AS BUSHO_NM                                                                                            " & vbNewLine _
                                                 & ",KBN4.KBN_NM1           AS NRS_BR_NM_NICHI                                                                                     " & vbNewLine _
                                                 & ",OUTS.ALCTD_CAN_QT      AS ALCTD_CAN_QT                                                                                        " & vbNewLine _
                                                 & ",OUTM.ALCTD_KB          AS ALCTD_KB                                                                                            " & vbNewLine _
                                                 & ",'0'                    AS PTN_FLAG                                                                                            " & vbNewLine _
                                                 & ",OUTL.CUST_CD_L         AS CUST_CD_L                                                                                           " & vbNewLine _
                                                 & ",OUTL.ORDER_TYPE        AS ORDER_TYPE                                                                                          " & vbNewLine _
                                                 & "--(2012.10.19)要望番号1289 -- START --                                                                                         " & vbNewLine _
                                                 & ",OUTL.SYS_UPD_PGID      AS SYS_UPD_PGID                                                                                        " & vbNewLine _
                                                 & "--(2012.10.19)要望番号1289 --  END  --                                                                                         " & vbNewLine _
                                                 & ",ZAI.LT_DATE                                                                                                                   " & vbNewLine _
                                                 & ",OUTM.BUYER_ORD_NO_DTL AS BUYER_ORD_NO_DTL                                                                                     " & vbNewLine _
                                                 & "--(2012.10.19)要望番号1289 -- START --                                                                                         " & vbNewLine _
                                                 & ",ZAI.GOODS_COND_KB_1 AS GOODS_COND_CD_1                                                                                        " & vbNewLine _
                                                 & "--(2012.10.19)要望番号1289 --  END  --                                                                                         " & vbNewLine _
                                                 & ",ZAI.GOODS_COND_KB_2 AS GOODS_COND_CD                                                                                          " & vbNewLine _
                                                 & "--(2012.10.19)要望番号1289 -- START --                                                                                         " & vbNewLine _
                                                 & ",ZAI.GOODS_COND_KB_3 AS GOODS_COND_CD_3                                                                                        " & vbNewLine _
                                                 & "--(2012.10.19)要望番号1289 --  END  --                                                                                         " & vbNewLine _
                                                 & "--(2014.05.29)要望番号2193 -- START --                                                                                         " & vbNewLine _
                                                 & ",CUSTCOND.JOTAI_NM AS GOODS_COND_NM                                                                                            " & vbNewLine _
                                                 & "--(2012.05.29)要望番号2193 --  END  --                                                                                         " & vbNewLine _
                                                 & ",ZAI.REMARK AS REMARK_ZAI                                                                                                      " & vbNewLine _
                                                 & ",KBN6.KBN_NM2 AS TITLE_SMPL                                                                                                    " & vbNewLine _
                                                 & ",OUTS.ALCTD_CAN_NB AS ALCTD_CAN_NB                                                                                             " & vbNewLine _
                                                 & ",OUTM.BACKLOG_QT                                                                                                               " & vbNewLine _
                                                 & ",KBN7.KBN_NM2 AS DOKU_NM                                                                                                       " & vbNewLine _
                                                 & "--【要望番号995】　2012/04/17　元着払い区分　START                                                                             " & vbNewLine _
                                                 & " ,MCD.SET_NAIYO    AS MCD_SET_NAIYO                                                                                            " & vbNewLine _
                                                 & " ,MCD.SET_NAIYO_2  AS MCD_SET_NAIYO_2                                                                                          " & vbNewLine _
                                                 & " ,MCD.SET_NAIYO_3  AS MCD_SET_NAIYO_3                                                                                          " & vbNewLine _
                                                 & ",KBN9.KBN_NM2 AS PC_KB_NM                                                                                                      " & vbNewLine _
                                                 & "--【要望番号995】　2012/04/17　元着払い区分　 END                                                                              " & vbNewLine _
                                                 & "--日医工対策開始                                                                                                               " & vbNewLine _
                                                 & ",EDIL.FREE_C01           AS TORI_KB                                                                                            " & vbNewLine _
                                                 & "--★追加開始2012/05/11                                                                                                         " & vbNewLine _
                                                 & ",OUTL.SHIP_CD_L          AS SHIP_CD_L                                                                                          " & vbNewLine _
                                                 & "--★追加終了2012/05/11                                                                                                         " & vbNewLine _
                                                 & "--★削除開始2012/05/11                                                                                                         " & vbNewLine _
                                                 & "--,EDIL.SHIP_NM_L          AS CHOKUSO_NM1                                                                                      " & vbNewLine _
                                                 & "--,EDIL.FREE_C11           AS CHOKUSO_CD                                                                                       " & vbNewLine _
                                                 & "--,EDIL.FREE_C08           AS HAKKO_DATE                                                                                       " & vbNewLine _
                                                 & "--★削除終了2012/05/11                                                                                                         " & vbNewLine _
                                                 & ",MCD_N.SET_NAIYO         AS SET_NAIYO_4                                                                                        " & vbNewLine _
                                                 & ",MCD_N.SET_NAIYO_2       AS SET_NAIYO_5                                                                                        " & vbNewLine _
                                                 & ",MCD_N.SET_NAIYO_3       AS SET_NAIYO_6                                                                                        " & vbNewLine _
                                                 & ",MG.GOODS_NM_2           AS GOODS_NM_2                                                                                         " & vbNewLine _
                                                 & ",EDIM.FREE_C02           AS KICHO_KB                                                                                           " & vbNewLine _
                                                 & ",EDIM.FREE_C03           AS SEI_YURAI_KB                                                                                       " & vbNewLine _
                                                 & ",EDIM.FREE_C04           AS REMARK_UPPER      --群馬篠崎運送利用                                                               " & vbNewLine _
                                                 & ",EDIM.FREE_C05           AS REMARK_LOWER                                                                                       " & vbNewLine _
                                                 & ",EDIM.FREE_C06           AS GOODS_SYUBETU     --群馬篠崎運送利用                                                               " & vbNewLine _
                                                 & "--(2013.11.26) 要望番号2130 修正START                                                                                          " & vbNewLine _
                                                 & "--,EDIM.FREE_C01           AS YUKOU_KIGEN                                                                                        " & vbNewLine _
                                                 & ",CASE WHEN OUTL.NRS_BR_CD = '10' AND (OUTL.CUST_CD_L = '00266' OR OUTL.CUST_CD_L = '00759') THEN OUTL.DENP_NO                                                " & vbNewLine _
                                                 & "      ELSE EDIM.FREE_C01 END YUKOU_KIGEN                                                                                          " & vbNewLine _
                                                 & "--(2013.11.26) 要望番号2130 修正END                                                                                            " & vbNewLine _
                                                 & ",MG.GOODS_NM_3           AS GOODS_NM_3         --2012/05/23                                                                    " & vbNewLine _
                                                 & ",MDOUTU.EDI_CD           AS EDISHIP_CD         --2012/05/23                                                                    " & vbNewLine _
                                                 & ",MDOUT.EDI_CD            AS EDIDEST_CD         --2012/05/23                                                                    " & vbNewLine _
                                                 & "--日医工対策終了                                                                                                               " & vbNewLine _
                                                 & "--(2012.06.01) 日本ﾌｧｲﾝ対応  --- START ---                                                                                     " & vbNewLine _
                                                 & ",MCD_F.SET_NAIYO         AS SET_NAIYO_FROM1                                                                                    " & vbNewLine _
                                                 & ",MCD_F.SET_NAIYO_2       AS SET_NAIYO_FROM2                                                                                    " & vbNewLine _
                                                 & ",MCD_F.SET_NAIYO_3       AS SET_NAIYO_FROM3                                                                                    " & vbNewLine _
                                                 & "--(2012.06.01) 日本ﾌｧｲﾝ対応  --- START ---                                                                                     " & vbNewLine _
                                                 & "--【要望番号1122】埼玉対応 --- START ---                                                                                       " & vbNewLine _
                                                 & ",MC.AD_3                 AS CUST_AD_3                                                                                          " & vbNewLine _
                                                 & ",MDOUT.REMARK            AS DEST_REMARK                                                                                        " & vbNewLine _
                                                 & ",MDOUT.SALES_CD          AS DEST_SALES_CD                                                                                      " & vbNewLine _
                                                 & ",MC_SALES.CUST_NM_L      AS DEST_SALES_NM                                                                                      " & vbNewLine _
                                                 & ",MC_SALES.AD_1           AS DEST_SALES_AD_1                                                                                    " & vbNewLine _
                                                 & ",MC_SALES.AD_2           AS DEST_SALES_AD_2                                                                                    " & vbNewLine _
                                                 & ",MC_SALES.AD_3           AS DEST_SALES_AD_3                                                                                    " & vbNewLine _
                                                 & ",MC_SALES.TEL            AS DEST_SALES_TEL                                                                                     " & vbNewLine _
                                                 & "--【要望番号1122】埼玉対応 ---  END  ---                                                                                       " & vbNewLine _
                                                 & "--群馬篠崎運送向け自由項目対応　開始　                                                                                         " & vbNewLine _
                                                 & ",EDIM.FREE_C07           AS SZ01_YUSO --篠崎                                                                                   " & vbNewLine _
                                                 & ",EDIM.FREE_C09           AS SZ01_UNSO --篠崎                                                                                   " & vbNewLine _
                                                 & "--群馬篠崎運送向け自由項目対応　終了                                                                                         　" & vbNewLine _
                                                 & "--(2012.10.19)要望番号1289 -- START --                                                                                         " & vbNewLine _
                                                 & "      ,MGD.SET_NAIYO                      AS  SET_NAIYO                                                                        " & vbNewLine _
                                                 & "--(2012.10.19)要望番号1289 --  END  --                                                                                         " & vbNewLine _
                                                 & ",KBN10.KBN_NM1            AS SHOBO_KBN_NM                                                                                      " & vbNewLine _
                                                 & ",MSHOBO.HINMEI            AS HINMEI                                                                                            " & vbNewLine _
                                                 & "--(2012.11.28) LMC637対応 -- START --                                                                                          " & vbNewLine _
                                                 & ",MG.CUST_CD_M             AS CUST_CD_M                                                                                         " & vbNewLine _
                                                 & ",MG.CUST_CD_S             AS CUST_CD_S                                                                                         " & vbNewLine _
                                                 & ",MG.CUST_COST_CD2         AS CUST_COST_CD2                                                                                     " & vbNewLine _
                                                 & "--(2012.11.28) LMC637対応 --  END  --                                                                                          " & vbNewLine

    Friend Const SQL_FROM_OUTKA_753 As String = "--出荷L                                                                                                                        " & vbNewLine _
                                             & "FROM                                                                                                                           " & vbNewLine _
                                             & "$LM_TRN$..C_OUTKA_L OUTL                                                                                                       " & vbNewLine _
                                             & "--トランザクションテーブル                                                                                                     " & vbNewLine _
                                             & "--出荷M                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..C_OUTKA_M OUTM                                                                                             " & vbNewLine _
                                             & "ON  OUTM.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "AND OUTM.OUTKA_NO_L = OUTL.OUTKA_NO_L                                                                                          " & vbNewLine _
                                             & "AND OUTM.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--★★★追加開始--------------------------------                                                                               " & vbNewLine _
                                             & "--出荷M(中MIN)                                                                                                                 " & vbNewLine _
                                             & "LEFT OUTER JOIN                                                                                                                " & vbNewLine _
                                             & "       (SELECT                                                                                                                 " & vbNewLine _
                                             & "           NRS_BR_CD                                                                                                           " & vbNewLine _
                                             & "           ,OUTKA_NO_L                                                                                                         " & vbNewLine _
                                             & "           ,MIN(OUTKA_NO_M) AS  OUTKA_NO_M                                                                                     " & vbNewLine _
                                             & "       FROM $LM_TRN$..C_OUTKA_M WHERE SYS_DEL_FLG ='0'                                                                         " & vbNewLine _
                                             & "        AND NRS_BR_CD = @NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "        AND OUTKA_NO_L = @KANRI_NO_L                                                                                           " & vbNewLine _
                                             & "       GROUP BY NRS_BR_CD,OUTKA_NO_L) OUTM_MIN                                                                                 " & vbNewLine _
                                             & "       ON OUTM_MIN.NRS_BR_CD        = OUTL.NRS_BR_CD                                                                           " & vbNewLine _
                                             & "       AND OUTM_MIN.OUTKA_NO_L      = OUTL.OUTKA_NO_L                                                                          " & vbNewLine _
                                             & "--出荷M(中MIN)                                                                                                                 " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..C_OUTKA_M OUTM2                                                                                            " & vbNewLine _
                                             & "ON  OUTM2.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                           " & vbNewLine _
                                             & "AND OUTM2.OUTKA_NO_L = OUTL.OUTKA_NO_L                                                                                         " & vbNewLine _
                                             & "AND OUTM2.OUTKA_NO_M = OUTM_MIN.OUTKA_NO_M                                                                                     " & vbNewLine _
                                             & "AND OUTM2.SYS_DEL_FLG = '0'                                                                                                    " & vbNewLine _
                                             & "--★★★追加終了--------------------------------                                                                               " & vbNewLine _
                                             & "--出荷S                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..C_OUTKA_S OUTS                                                                                             " & vbNewLine _
                                             & "ON  OUTS.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "AND OUTS.OUTKA_NO_L = OUTL.OUTKA_NO_L                                                                                          " & vbNewLine _
                                             & "AND OUTS.OUTKA_NO_M = OUTM.OUTKA_NO_M                                                                                          " & vbNewLine _
                                             & "AND OUTS.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & " LEFT JOIN (                                                                                                                   " & vbNewLine _
                                             & "            SELECT                                                                                                             " & vbNewLine _
                                             & "                   NRS_BR_CD                                                                                                   " & vbNewLine _
                                             & "                 , EDI_CTL_NO                                                                                                  " & vbNewLine _
                                             & "                 , OUTKA_CTL_NO                                                                                                " & vbNewLine _
                                             & "             FROM (                                                                                                            " & vbNewLine _
                                             & "                    SELECT                                                                                                     " & vbNewLine _
                                             & "                           EDIOUTL.NRS_BR_CD                                                                                   " & vbNewLine _
                                             & "                         , EDIOUTL.EDI_CTL_NO                                                                                  " & vbNewLine _
                                             & "                         , EDIOUTL.OUTKA_CTL_NO                                                                                " & vbNewLine _
                                             & "                         , CASE WHEN EDIOUTL.OUTKA_CTL_NO = '' THEN 1                                                          " & vbNewLine _
                                             & "                           ELSE ROW_NUMBER() OVER (PARTITION BY EDIOUTL.NRS_BR_CD                                              " & vbNewLine _
                                             & "                                                              , EDIOUTL.OUTKA_CTL_NO                                           " & vbNewLine _
                                             & "                                                       ORDER BY EDIOUTL.NRS_BR_CD                                              " & vbNewLine _
                                             & "                                                              , EDIOUTL.EDI_CTL_NO                                             " & vbNewLine _
                                             & "                                                  )                                                                            " & vbNewLine _
                                             & "                           END AS IDX                                                                                          " & vbNewLine _
                                             & "                     FROM $LM_TRN$..H_OUTKAEDI_L EDIOUTL                                                                       " & vbNewLine _
                                             & "                    WHERE EDIOUTL.SYS_DEL_FLG  = '0'                                                                           " & vbNewLine _
                                             & "                      AND EDIOUTL.NRS_BR_CD    = @NRS_BR_CD                                                                    " & vbNewLine _
                                             & "                      AND EDIOUTL.OUTKA_CTL_NO = @KANRI_NO_L                                                                   " & vbNewLine _
                                             & "                  ) EBASE                                                                                                      " & vbNewLine _
                                             & "            WHERE EBASE.IDX = 1                                                                                                " & vbNewLine _
                                             & "            ) TOPEDI                                                                                                           " & vbNewLine _
                                             & "        ON TOPEDI.NRS_BR_CD    = OUTL.NRS_BR_CD                                                                                " & vbNewLine _
                                             & "       AND TOPEDI.OUTKA_CTL_NO = OUTL.OUTKA_NO_L                                                                               " & vbNewLine _
                                             & " LEFT JOIN $LM_TRN$..H_OUTKAEDI_L EDIL                                                                                         " & vbNewLine _
                                             & "        ON EDIL.NRS_BR_CD  = TOPEDI.NRS_BR_CD                                                                                  " & vbNewLine _
                                             & "       AND EDIL.EDI_CTL_NO = TOPEDI.EDI_CTL_NO                                                                                 " & vbNewLine _
                                             & "--(2012.09.06)要望番号1412対応  ---  END  ---                                                                                  " & vbNewLine _
                                             & "--入荷L                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..B_INKA_L INL                                                                                               " & vbNewLine _
                                             & "ON  INL.NRS_BR_CD = OUTS.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "AND INL.INKA_NO_L = OUTS.INKA_NO_L                                                                                             " & vbNewLine _
                                             & "AND INL.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--入荷S                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..B_INKA_S INS                                                                                               " & vbNewLine _
                                             & "ON  INS.NRS_BR_CD = OUTS.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "AND INS.INKA_NO_L = OUTS.INKA_NO_L                                                                                             " & vbNewLine _
                                             & "AND INS.INKA_NO_M = OUTS.INKA_NO_M                                                                                             " & vbNewLine _
                                             & "AND INS.INKA_NO_S = OUTS.INKA_NO_S                                                                                             " & vbNewLine _
                                             & "AND INS.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--運送L                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..F_UNSO_L UL                                                                                                " & vbNewLine _
                                             & "ON  UL.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                              " & vbNewLine _
                                             & "AND UL.INOUTKA_NO_L = OUTL.OUTKA_NO_L                                                                                          " & vbNewLine _
                                             & "AND UL.MOTO_DATA_KB = '20'                                                                                                     " & vbNewLine _
                                             & "AND UL.SYS_DEL_FLG = '0'                                                                                                       " & vbNewLine _
                                             & "--在庫テーブル                                                                                                                 " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..D_ZAI_TRS ZAI                                                                                              " & vbNewLine _
                                             & "ON  ZAI.NRS_BR_CD = OUTS.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "AND ZAI.ZAI_REC_NO = OUTS.ZAI_REC_NO                                                                                           " & vbNewLine _
                                             & "AND ZAI.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--マスタテーブル                                                                                                               " & vbNewLine _
                                             & "--営業所M                                                                                                                      " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_NRS_BR MNRS                                                                                              " & vbNewLine _
                                             & "ON MNRS.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "--商品M                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_GOODS MG                                                                                                 " & vbNewLine _
                                             & "ON  MG.NRS_BR_CD = OUTM.NRS_BR_CD                                                                                              " & vbNewLine _
                                             & "AND MG.GOODS_CD_NRS = OUTM.GOODS_CD_NRS                                                                                        " & vbNewLine _
                                             & "--★★★追加開始--------------------------------                                                                                     " & vbNewLine _
                                             & "--商品M(MIN)                                                                                                                   " & vbNewLine _
                                             & "LEFT OUTER JOIN $LM_MST$..M_GOODS M_GOODS_MIN                                                                                  " & vbNewLine _
                                             & "ON M_GOODS_MIN.NRS_BR_CD      = OUTL.NRS_BR_CD                                                                                 " & vbNewLine _
                                             & "AND M_GOODS_MIN.GOODS_CD_NRS   = OUTM2.GOODS_CD_NRS                                                                            " & vbNewLine _
                                             & "--★★★追加終了--------------------------------                                                                                     " & vbNewLine _
                                             & "--荷主M(商品M経由)                                                                                                             " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST MC                                                                                                  " & vbNewLine _
                                             & "ON  MC.NRS_BR_CD = MG.NRS_BR_CD                                                                                                " & vbNewLine _
                                             & "AND MC.CUST_CD_L = MG.CUST_CD_L                                                                                                " & vbNewLine _
                                             & "AND MC.CUST_CD_M = MG.CUST_CD_M                                                                                                " & vbNewLine _
                                             & "AND MC.CUST_CD_S = MG.CUST_CD_S                                                                                                " & vbNewLine _
                                             & "AND MC.CUST_CD_SS = MG.CUST_CD_SS                                                                                              " & vbNewLine _
                                             & "--★★★追加開始--------------------------------                                                                               " & vbNewLine _
                                             & "--荷主M(商品M経由) 最小の出荷(中)で抽出                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST MC2                                                                                                 " & vbNewLine _
                                             & "ON  MC2.NRS_BR_CD = M_GOODS_MIN.NRS_BR_CD                                                                                      " & vbNewLine _
                                             & "AND MC2.CUST_CD_L = M_GOODS_MIN.CUST_CD_L                                                                                      " & vbNewLine _
                                             & "AND MC2.CUST_CD_M = M_GOODS_MIN.CUST_CD_M                                                                                      " & vbNewLine _
                                             & "AND MC2.CUST_CD_S = M_GOODS_MIN.CUST_CD_S                                                                                      " & vbNewLine _
                                             & "AND MC2.CUST_CD_SS = M_GOODS_MIN.CUST_CD_SS                                                                                    " & vbNewLine _
                                             & "AND MC2.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--★★★追加終了--------------------------------                                                                               " & vbNewLine _
                                             & "--届先M(届先取得)(出荷L参照)                                                                                                   " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_DEST MDOUT                                                                                               " & vbNewLine _
                                             & "ON  MDOUT.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                           " & vbNewLine _
                                             & "AND MDOUT.CUST_CD_L = OUTL.CUST_CD_L                                                                                           " & vbNewLine _
                                             & "AND MDOUT.DEST_CD = OUTL.DEST_CD                                                                                               " & vbNewLine _
                                             & "--届先M(売上先取得)(出荷L参照)                                                                                                 " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_DEST MDOUTU                                                                                              " & vbNewLine _
                                             & "ON  MDOUTU.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                          " & vbNewLine _
                                             & "AND MDOUTU.CUST_CD_L = OUTL.CUST_CD_L                                                                                          " & vbNewLine _
                                             & "AND MDOUTU.DEST_CD = OUTL.SHIP_CD_L                                                                                            " & vbNewLine _
                                             & "--届先M(届先取得)(出荷EDIL参照)                                                                                                " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_DEST MDEDI                                                                                               " & vbNewLine _
                                             & "ON  MDEDI.NRS_BR_CD = EDIL.NRS_BR_CD                                                                                           " & vbNewLine _
                                             & "AND MDEDI.CUST_CD_L = EDIL.CUST_CD_L                                                                                           " & vbNewLine _
                                             & "AND MDEDI.DEST_CD = EDIL.DEST_CD                                                                                               " & vbNewLine _
                                             & "--【要望番号1122】埼玉対応 --- START ---                                                                                       " & vbNewLine _
                                             & "--届先M(納品書荷主名義名取得)(届先M参照)                                                                                       " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST MC_SALES                                                                                            " & vbNewLine _
                                             & "       ON MC_SALES.NRS_BR_CD  = MDOUT.NRS_BR_CD                                                                                " & vbNewLine _
                                             & "      AND MC_SALES.CUST_CD_L  = MDOUT.SALES_CD                                                                                 " & vbNewLine _
                                             & "      AND MC_SALES.CUST_CD_M  = '00'                                                                                           " & vbNewLine _
                                             & "      AND MC_SALES.CUST_CD_S  = '00'                                                                                           " & vbNewLine _
                                             & "      AND MC_SALES.CUST_CD_SS = '00'                                                                                           " & vbNewLine _
                                             & "--【要望番号1122】埼玉対応 ---  END  ---                                                                                       " & vbNewLine _
                                             & "--運送会社M                                                                                                                    " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_UNSOCO MUCO                                                                                              " & vbNewLine _
                                             & "ON  MUCO.NRS_BR_CD = UL.NRS_BR_CD                                                                                              " & vbNewLine _
                                             & "AND MUCO.UNSOCO_CD = UL.UNSO_CD                                                                                                " & vbNewLine _
                                             & "AND MUCO.UNSOCO_BR_CD = UL.UNSO_BR_CD                                                                                          " & vbNewLine _
                                             & "--倉庫M                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_SOKO MSO                                                                                                 " & vbNewLine _
                                             & "ON  MSO.NRS_BR_CD = OUTL.NRS_BR_CD  --追加                                                                                     " & vbNewLine _
                                             & "AND MSO.WH_CD     = OUTL.WH_CD                                                                                                 " & vbNewLine _
                                             & "--2014/5/16Start s.kobayashi NotesNo.2183                                                                                      " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN11                                                                                                " & vbNewLine _
                                             & "ON  KBN11.KBN_GROUP_CD = 'U028'  --追加                                                                                        " & vbNewLine _
                                             & "AND UL.SEIQ_TARIFF_CD = KBN11.KBN_NM1                                                                                          " & vbNewLine _
                                             & "--2014/5/16End s.kobayashi NotesNo.2183                                                                                       " & vbNewLine _
                                             & "--距離程M(M_DEST.JIS < M_SOKO.JIS_CD)(出荷L参照)                                                                               " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_KYORI MKY1                                                                                               " & vbNewLine _
                                             & "ON  MKY1.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "--AND MKY1.KYORI_CD = MC.BETU_KYORI_CD                                                                                           " & vbNewLine _
                                             & "AND MKY1.KYORI_CD = (CASE ISNULL(KBN11.KBN_NM2,'') WHEN '' THEN MC.BETU_KYORI_CD ELSE KBN11.KBN_NM2 END)                       " & vbNewLine _
                                             & "AND MKY1.ORIG_JIS_CD = MDOUT.JIS                                                                                               " & vbNewLine _
                                             & "AND MKY1.DEST_JIS_CD = MSO.JIS_CD                                                                                              " & vbNewLine _
                                             & "--距離程M(M_SOKO.JIS_CD < M_DEST.JIS)(出荷L参照)                                                                               " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_KYORI MKY2                                                                                               " & vbNewLine _
                                             & "ON  MKY2.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "--AND MKY2.KYORI_CD = MC.BETU_KYORI_CD                                                                                           " & vbNewLine _
                                             & "AND MKY2.KYORI_CD = (CASE ISNULL(KBN11.KBN_NM2,'') WHEN '' THEN MC.BETU_KYORI_CD ELSE KBN11.KBN_NM2 END)                       " & vbNewLine _
                                             & "AND MKY2.ORIG_JIS_CD = MSO.JIS_CD                                                                                              " & vbNewLine _
                                             & "AND MKY2.DEST_JIS_CD = MDOUT.JIS                                                                                               " & vbNewLine _
                                             & "--距離程M(H_OUTKAEDI_L.DEST_JIS_CD < M_SOKO.JIS_CD)(出荷EDIL参照)                                                              " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_KYORI MKY3                                                                                               " & vbNewLine _
                                             & "ON  MKY3.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "--AND MKY3.KYORI_CD = MC.BETU_KYORI_CD                                                                                           " & vbNewLine _
                                             & "AND MKY3.KYORI_CD = (CASE ISNULL(KBN11.KBN_NM2,'') WHEN '' THEN MC.BETU_KYORI_CD ELSE KBN11.KBN_NM2 END)                       " & vbNewLine _
                                             & "AND MKY3.ORIG_JIS_CD = EDIL.DEST_JIS_CD                                                                                        " & vbNewLine _
                                             & "AND MKY3.DEST_JIS_CD = MSO.JIS_CD                                                                                              " & vbNewLine _
                                             & "--距離程M(M_SOKO.JIS_CD < H_OUTKAEDI_L.DEST_JIS_CD)(出荷EDIL参照)                                                              " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_KYORI MKY4                                                                                               " & vbNewLine _
                                             & "ON  MKY4.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "--AND MKY4.KYORI_CD = MC.BETU_KYORI_CD                                                                                           " & vbNewLine _
                                             & "AND MKY4.KYORI_CD = (CASE ISNULL(KBN11.KBN_NM2,'') WHEN '' THEN MC.BETU_KYORI_CD ELSE KBN11.KBN_NM2 END)                       " & vbNewLine _
                                             & "AND MKY4.ORIG_JIS_CD = MSO.JIS_CD                                                                                              " & vbNewLine _
                                             & "AND MKY4.DEST_JIS_CD = EDIL.DEST_JIS_CD                                                                                        " & vbNewLine _
                                             & "--届先商品M(出荷L参照)                                                                                                         " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_DESTGOODS MDGL                                                                                           " & vbNewLine _
                                             & "ON  MDGL.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "AND MDGL.CUST_CD_L = OUTL.CUST_CD_L                                                                                            " & vbNewLine _
                                             & "AND MDGL.CUST_CD_M = OUTL.CUST_CD_M                                                                                            " & vbNewLine _
                                             & "AND MDGL.CD = OUTL.DEST_CD                                                                                                     " & vbNewLine _
                                             & "AND MDGL.GOODS_CD_NRS = MG.GOODS_CD_NRS                                                                                        " & vbNewLine _
                                             & "AND MDGL.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--届先商品M(出荷EDI参照)                                                                                                       " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_DESTGOODS MDGE                                                                                           " & vbNewLine _
                                             & "ON  MDGE.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "AND MDGE.CUST_CD_L = OUTL.CUST_CD_L                                                                                            " & vbNewLine _
                                             & "AND MDGE.CUST_CD_M = OUTL.CUST_CD_M                                                                                            " & vbNewLine _
                                             & "AND MDGE.CD = EDIL.DEST_CD                                                                                                     " & vbNewLine _
                                             & "AND MDGE.GOODS_CD_NRS = MG.GOODS_CD_NRS                                                                                        " & vbNewLine _
                                             & "AND MDGE.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--消防M★                                                                                                      " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_SHOBO MSHOBO                                                                                           " & vbNewLine _
                                             & "ON  MSHOBO.SHOBO_CD = MG.SHOBO_CD                                                                                            " & vbNewLine _
                                             & "AND MSHOBO.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--区分M(納入予定区分)                                                                                                          " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN1                                                                                                 " & vbNewLine _
                                             & "ON  KBN1.KBN_GROUP_CD = 'N010'                                                                                                 " & vbNewLine _
                                             & "AND KBN1.KBN_CD = OUTL.ARR_PLAN_TIME                                                                                           " & vbNewLine _
                                             & "AND KBN1.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--区分M(日本合成用倉庫名)                                                                                                      " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN2                                                                                                 " & vbNewLine _
                                             & "ON  KBN2.KBN_GROUP_CD = 'P005'                                                                                                 " & vbNewLine _
                                             & "AND KBN2.KBN_CD = '00'                                                                                                         " & vbNewLine _
                                             & "AND KBN2.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--区分M(日本合成用部署名)                                                                                                      " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN3                                                                                                 " & vbNewLine _
                                             & "ON  KBN3.KBN_GROUP_CD = 'P005'                                                                                                 " & vbNewLine _
                                             & "AND KBN3.KBN_CD = '01'                                                                                                         " & vbNewLine _
                                             & "AND KBN3.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--区分M(日本合成用営業署名)                                                                                                    " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN4                                                                                                 " & vbNewLine _
                                             & "ON  KBN4.KBN_GROUP_CD = 'P005'                                                                                                 " & vbNewLine _
                                             & "AND KBN4.KBN_CD = '02'                                                                                                         " & vbNewLine _
                                             & "AND KBN4.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--区分M(荷姿)                                                                                                                  " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN5                                                                                                 " & vbNewLine _
                                             & "ON  KBN5.KBN_GROUP_CD = 'N001'                                                                                                 " & vbNewLine _
                                             & "AND KBN5.KBN_CD = MG.PKG_UT                                                                                                    " & vbNewLine _
                                             & "AND KBN5.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--明細タイトル（小分け）                                                                                                       " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN6                                                                                                 " & vbNewLine _
                                             & "ON  KBN6.KBN_GROUP_CD = 'S041'                                                                                                 " & vbNewLine _
                                             & "AND KBN6.KBN_CD = OUTM.ALCTD_KB                                                                                                " & vbNewLine _
                                             & "AND KBN6.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--区分M(毒劇区分名称)                                                                                                           " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN7                                                                                                  " & vbNewLine _
                                             & "ON  KBN7.KBN_GROUP_CD = 'G001'                                                                                                  " & vbNewLine _
                                             & "AND KBN7.KBN_CD = MG.DOKU_KB                                                                                                    " & vbNewLine _
                                             & "AND KBN7.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--【要望番号995】　2012/04/17　元着払い区分　START                                                                             " & vbNewLine _
                                             & "--区分M(元着払区分名称)                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN9                                                                                                 " & vbNewLine _
                                             & "ON  KBN9.KBN_GROUP_CD = 'M001'                                                                                                 " & vbNewLine _
                                             & "AND KBN9.KBN_CD = OUTL.PC_KB                                                                                                   " & vbNewLine _
                                             & "AND KBN9.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--【要望番号995】　2012/04/17　元着払い区分　 END                                                                              " & vbNewLine _
                                             & "--区分M(消防区分名称)★                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN10                                                                                                " & vbNewLine _
                                             & "ON  KBN10.KBN_GROUP_CD = 'S004'                                                                                                " & vbNewLine _
                                             & "AND KBN10.KBN_CD = MSHOBO.RUI                                                                                                  " & vbNewLine _
                                             & "AND KBN10.SYS_DEL_FLG = '0'                                                                                                    " & vbNewLine _
                                             & "--日医工対策開始                                                                                                               " & vbNewLine _
                                             & "--★出荷EDI M(日医工)                                                                                                          " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..H_OUTKAEDI_M EDIM                                                                                            " & vbNewLine _
                                             & "ON  EDIM.NRS_BR_CD        = OUTM.NRS_BR_CD                                                                                     " & vbNewLine _
                                             & "AND EDIM.OUTKA_CTL_NO     = OUTM.OUTKA_NO_L                                                                                    " & vbNewLine _
                                             & "AND EDIM.OUTKA_CTL_NO_CHU = OUTM.OUTKA_NO_M                                                                                    " & vbNewLine _
                                             & "AND EDIM.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--日医工_出荷指示EDIデータ                                                                                                     " & vbNewLine _
                                             & "--LEFT JOIN $LM_TRN$..H_OUTKAEDI_DTL_NIK EDIN                                                                                    " & vbNewLine _
                                             & "--ON   OUTL.NRS_BR_CD      = EDIN.NRS_BR_CD                                                                                      " & vbNewLine _
                                             & "--AND  EDIL.EDI_CTL_NO     = EDIN.EDI_CTL_NO                                                                                     " & vbNewLine _
                                             & "--AND  EDIM.EDI_CTL_NO_CHU = EDIN.EDI_CTL_NO_CHU                                                                                 " & vbNewLine _
                                             & "--AND  EDIN.SYS_DEL_FLG    = '0'                                                                                                 " & vbNewLine _
                                             & "                                                                                                                               " & vbNewLine _
                                             & "--荷主明細M ★                                                                                                                 " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST_DETAILS MCD_N                                                                                       " & vbNewLine _
                                             & "ON  MCD_N.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                           " & vbNewLine _
                                             & "AND MCD_N.CUST_CD   = OUTL.CUST_CD_L                                                                                           " & vbNewLine _
                                             & "AND MCD_N.SUB_KB = '26'                                                                                                        " & vbNewLine _
                                             & "--日医工対策終了                                                                                                               " & vbNewLine _
                                             & "--(2012.06.01) 日本ﾌｧｲﾝ対応  --- START ----                                                                                    " & vbNewLine _
                                             & "--荷主明細M                                                                                                                    " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST_DETAILS MCD_F                                                                                       " & vbNewLine _
                                             & "ON  MCD_F.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                           " & vbNewLine _
                                             & "AND MCD_F.CUST_CD   = OUTL.CUST_CD_L                                                                                           " & vbNewLine _
                                             & "AND MCD_F.SUB_KB = '29'                                                                                                        " & vbNewLine _
                                             & "--(2012.06.01) 日本ﾌｧｲﾝ対応  ---  END  ----                                                                                    " & vbNewLine _
                                             & "--荷主明細M ★                                                                                                                 " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST_DETAILS MCD                                                                                         " & vbNewLine _
                                             & "ON  MCD.NRS_BR_CD = MG.NRS_BR_CD                                                                                               " & vbNewLine _
                                             & "AND MCD.CUST_CD   = MG.CUST_CD_L                                                                                               " & vbNewLine _
                                             & "AND MCD.SUB_KB = '20'                                                                                                          " & vbNewLine _
                                             & "--(2012.11.21)要望番号1615 -- START --                                                                                         " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_GOODS_DETAILS MGD16                                                                                        " & vbNewLine _
                                             & "       ON MGD16.NRS_BR_CD = MG.NRS_BR_CD                                                                                       " & vbNewLine _
                                             & "      AND MGD16.GOODS_CD_NRS = MG.GOODS_CD_NRS                                                                                 " & vbNewLine _
                                             & "      AND MGD16.SUB_KB = '16'                                                                                                  " & vbNewLine _
                                             & "      AND MGD16.SYS_DEL_FLG = '0'                                                                                              " & vbNewLine _
                                             & "--(2012.11.21)要望番号1615 --  END  --                                                                                         " & vbNewLine _
                                             & "--出荷Lでの荷主帳票パターン取得                                                                                                " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST_RPT MCR1                                                                                            " & vbNewLine _
                                             & "ON  OUTL.NRS_BR_CD = MCR1.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "AND OUTL.CUST_CD_L = MCR1.CUST_CD_L                                                                                            " & vbNewLine _
                                             & "AND OUTL.CUST_CD_M = MCR1.CUST_CD_M                                                                                            " & vbNewLine _
                                             & "AND '00' = MCR1.CUST_CD_S                                                                                                      " & vbNewLine _
                                             & "AND MCR1.PTN_ID = '04'                                                                                                         " & vbNewLine _
                                             & "--帳票パターン取得                                                                                                             " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_RPT MR1                                                                                                  " & vbNewLine _
                                             & "ON  MR1.NRS_BR_CD = MCR1.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "AND MR1.PTN_ID = MCR1.PTN_ID                                                                                                   " & vbNewLine _
                                             & "AND MR1.PTN_CD = MCR1.PTN_CD                                                                                                   " & vbNewLine _
                                             & "AND MR1.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--商品Mの荷主での荷主帳票パターン取得                                                                                          " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST_RPT MCR2                                                                                            " & vbNewLine _
                                             & "ON  MG.NRS_BR_CD = MCR2.NRS_BR_CD                                                                                              " & vbNewLine _
                                             & "AND MG.CUST_CD_L = MCR2.CUST_CD_L                                                                                              " & vbNewLine _
                                             & "AND MG.CUST_CD_M = MCR2.CUST_CD_M                                                                                              " & vbNewLine _
                                             & "AND MG.CUST_CD_S = MCR2.CUST_CD_S                                                                                              " & vbNewLine _
                                             & "AND MCR2.PTN_ID = '04'                                                                                                         " & vbNewLine _
                                             & "--帳票パターン取得                                                                                                             " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_RPT MR2                                                                                                  " & vbNewLine _
                                             & "ON  MR2.NRS_BR_CD = MCR2.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "AND MR2.PTN_ID = MCR2.PTN_ID                                                                                                   " & vbNewLine _
                                             & "AND MR2.PTN_CD = MCR2.PTN_CD                                                                                                   " & vbNewLine _
                                             & "AND MR2.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--存在しない場合の帳票パターン取得                                                                                             " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_RPT MR3                                                                                                  " & vbNewLine _
                                             & "ON  MR3.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "AND MR3.PTN_ID = '04'                                                                                                          " & vbNewLine _
                                             & "AND MR3.STANDARD_FLAG = '01'                                                                                                   " & vbNewLine _
                                             & "AND MR3.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--ユーザM                                                                                                                      " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..S_USER MUSER                                                                                               " & vbNewLine _
                                             & "ON MUSER.USER_CD = OUTL.SYS_ENT_USER                                                                                           " & vbNewLine _
                                             & "AND MUSER.SYS_DEL_FLG = '0'                                                                                                    " & vbNewLine _
                                             & "--商品明細M                                                                                                                    " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_GOODS_DETAILS MGD                                                                                        " & vbNewLine _
                                             & "ON  MGD.NRS_BR_CD = MG.NRS_BR_CD                                                                                               " & vbNewLine _
                                             & "AND MGD.GOODS_CD_NRS = MG.GOODS_CD_NRS                                                                                         " & vbNewLine _
                                             & "AND MGD.SUB_KB = '09'                                                                                                          " & vbNewLine _
                                             & "AND MGD.SYS_DEL_FLG = '0'       --ADD 2019/02/07 依頼番号 : 004605   【LMS】納品書がの梱包個数が2倍になるバグ修正              " & vbNewLine _
                                             & "--CUST_COND M                                                                                                                  " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUSTCOND CUSTCOND                                                                                        " & vbNewLine _
                                             & "ON  CUSTCOND.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                        " & vbNewLine _
                                             & "AND CUSTCOND.CUST_CD_L = OUTL.CUST_CD_L                                                                                        " & vbNewLine _
                                             & "AND CUSTCOND.JOTAI_CD = ZAI.GOODS_COND_KB_3                                                                                    " & vbNewLine _
                                             & "AND CUSTCOND.SYS_DEL_FLG = '0'                                                                                                 " & vbNewLine

    '(2012.10.30) 納品書(千葉・富士フィルム用) -- START --
    ''' <summary>
    ''' 印刷データ抽出用(出荷テーブル)(富士フィルム用)
    ''' </summary>
    ''' <remarks></remarks>
    Friend Const SQL_SELECT_OUTKA_631 As String = "--★★★SQL_SELECT_OUTKA_631★★★  出荷テーブル                                                                           " & vbNewLine _
                                             & "SELECT                                                                                                                         " & vbNewLine _
                                             & " CASE WHEN MR2.PTN_CD IS NOT NULL THEN MR2.RPT_ID                                                                              " & vbNewLine _
                                             & "      WHEN MR1.PTN_CD IS NOT NULL THEN MR1.RPT_ID                                                                              " & vbNewLine _
                                             & "      ELSE MR3.RPT_ID                                                                                                          " & vbNewLine _
                                             & " END              AS RPT_ID                                                                                                    " & vbNewLine _
                                             & ",OUTL.NRS_BR_CD   AS NRS_BR_CD                                                                                                 " & vbNewLine _
                                             & ",OUTM.PRINT_SORT  AS PRINT_SORT                                                                                                " & vbNewLine _
                                             & ",CASE WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_CD                                                                               " & vbNewLine _
                                             & "      ELSE OUTL.DEST_CD                                                                                                        " & vbNewLine _
                                             & " END              AS DEST_CD                                                                                                   " & vbNewLine _
                                             & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_NM                                                                               " & vbNewLine _
                                             & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_NM                                                                               " & vbNewLine _
                                             & "      ELSE MDOUT.DEST_NM                                                                                                       " & vbNewLine _
                                             & " END              AS DEST_NM                                                                                                   " & vbNewLine _
                                             & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_AD_1                                                                             " & vbNewLine _
                                             & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_AD_1                                                                             " & vbNewLine _
                                             & "      ELSE MDOUT.AD_1                                                                                                          " & vbNewLine _
                                             & " END              AS DEST_AD_1                                                                                                 " & vbNewLine _
                                             & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_AD_2                                                                             " & vbNewLine _
                                             & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_AD_2                                                                             " & vbNewLine _
                                             & "      ELSE MDOUT.AD_2                                                                                                          " & vbNewLine _
                                             & " END              AS DEST_AD_2                                                                                                 " & vbNewLine _
                                             & "--,OUTL.DEST_AD_3   AS DEST_AD_3                                                                                               " & vbNewLine _
                                             & ",OUTL.DEST_AD_3                                                                                                                " & vbNewLine _
                                             & "+ CASE WHEN (CHARINDEX('|', FJF.ZFVYDTEKIYO) = 0) OR CHARINDEX('|', ZFVYDTEKIYO, CHARINDEX('|', ZFVYDTEKIYO) + 1) = 0          " & vbNewLine _
                                             & "       THEN ''                                                                                                                 " & vbNewLine _
                                             & "       ELSE ISNULL(LEFT(FJF.ZFVYDTEKIYO, CHARINDEX('|', FJF.ZFVYDTEKIYO) - 1), '')                                             " & vbNewLine _
                                             & "          + ' '                                                                                                                " & vbNewLine _
                                             & "          + ISNULL(SUBSTRING(ZFVYDTEKIYO                                                                                       " & vbNewLine _
                                             & "                           , CHARINDEX('|', ZFVYDTEKIYO) + 1                                                                   " & vbNewLine _
                                             & "                           , CHARINDEX('|', ZFVYDTEKIYO, CHARINDEX('|', ZFVYDTEKIYO) + 1)                                      " & vbNewLine _
                                             & "                           - CHARINDEX('|', ZFVYDTEKIYO) - 1 ), '')                                                            " & vbNewLine _
                                             & "          + IIF(LEN(SUBSTRING(ZFVYDTEKIYO                                                                                      " & vbNewLine _
                                             & "                            , CHARINDEX('|', ZFVYDTEKIYO) + 1                                                                  " & vbNewLine _
                                             & "                            , CHARINDEX('|', ZFVYDTEKIYO, CHARINDEX('|', ZFVYDTEKIYO) + 1)                                     " & vbNewLine _
                                             & "                            - CHARINDEX('|', ZFVYDTEKIYO) - 1 )) > 0, '様', '')                                                " & vbNewLine _
                                             & "  END AS DEST_AD_3                                                                                                             " & vbNewLine _
                                             & ",OUTL.DEST_TEL    AS DEST_TEL                                                                                                  " & vbNewLine _
                                             & ",OUTL.OUTKA_PLAN_DATE   AS OUTKA_PLAN_DATE                                                                                     " & vbNewLine _
                                             & ",OUTL.CUST_ORD_NO       AS CUST_ORD_NO                                                                                         " & vbNewLine _
                                             & ",OUTL.BUYER_ORD_NO      AS BUYER_ORD_NO                                                                                        " & vbNewLine _
                                             & ",MUCO.UNSOCO_NM         AS UNSOCO_NM                                                                                           " & vbNewLine _
                                             & ",OUTL.ARR_PLAN_DATE     AS ARR_PLAN_DATE                                                                                       " & vbNewLine _
                                             & ",KBN1.KBN_NM1           AS ARR_PLAN_TIME                                                                                       " & vbNewLine _
                                             & ",OUTL.OUTKA_NO_L        AS OUTKA_NO_L                                                                                          " & vbNewLine _
                                             & ",MDOUTU.DEST_NM         AS URIG_NM                                                                                             " & vbNewLine _
                                             & ",MC.CUST_NM_L           AS CUST_NM_L                                                                                           " & vbNewLine _
                                             & "--(2012.06.15) 要望番号1155 -- START --                                                                                        " & vbNewLine _
                                             & ",MC.CUST_NM_M           AS CUST_NM_M                                                                                           " & vbNewLine _
                                             & "--(2012.06.15) 要望番号1155 --  END  --                                                                                        " & vbNewLine _
                                             & ",MC.AD_1                AS CUST_AD_1                                                                                           " & vbNewLine _
                                             & ",MC.AD_2                AS CUST_AD_2                                                                                           " & vbNewLine _
                                             & ",MC.TEL                 AS CUST_TEL                                                                                            " & vbNewLine _
                                             & ",MC.DENPYO_NM           AS DENPYO_NM                                                                                           " & vbNewLine _
                                             & ",MNRS.NRS_BR_NM         AS NRS_BR_NM                                                                                           " & vbNewLine _
                                             & ",CASE WHEN MSO.WH_KB = '01' THEN MSO.AD_1                                                                                      " & vbNewLine _
                                             & "      ELSE MNRS.AD_1                                                                                                           " & vbNewLine _
                                             & " END              AS NRS_BR_AD1                                                                                                " & vbNewLine _
                                             & ",CASE WHEN MSO.WH_KB = '01' THEN MSO.AD_2                                                                                      " & vbNewLine _
                                             & "      ELSE MNRS.AD_2                                                                                                           " & vbNewLine _
                                             & " END              AS NRS_BR_AD2                                                                                                " & vbNewLine _
                                             & ",CASE WHEN MSO.WH_KB = '01' THEN MSO.TEL                                                                                       " & vbNewLine _
                                             & "      ELSE MNRS.TEL                                                                                                            " & vbNewLine _
                                             & " END              AS NRS_BR_TEL                                                                                                " & vbNewLine _
                                             & ",CASE WHEN MSO.WH_KB = '01' THEN MSO.FAX                                                                                       " & vbNewLine _
                                             & "      ELSE MNRS.FAX                                                                                                            " & vbNewLine _
                                             & " END              AS NRS_BR_FAX                                                                                                " & vbNewLine _
                                             & ",MUSER.USER_NM          AS PIC                                                                                                 " & vbNewLine _
                                             & ",OUTM.OUTKA_NO_M        AS OUTKA_NO_M                                                                                          " & vbNewLine _
                                             & ",OUTS.OUTKA_NO_S        AS OUTKA_NO_S                                                                                          " & vbNewLine _
                                             & "--(2012.10.22)MGD.SET_NAIYOによる判定が必要か  -- START --                                                                     " & vbNewLine _
                                             & "--,CASE WHEN MGD.SET_NAIYO = '1' THEN ''                                                                                       " & vbNewLine _
                                             & "--      WHEN INL.INKA_STATE_KB < '50' THEN INL.INKA_DATE                                                                       " & vbNewLine _
                                             & "--      WHEN INL.INKA_STATE_KB >= '50' THEN ZAI.INKO_DATE                                                                      " & vbNewLine _
                                             & "--      ELSE ''                                                                                                                " & vbNewLine _
                                             & "-- END                  AS INKA_DATE                                                                                           " & vbNewLine _
                                             & ",CASE WHEN INL.INKA_STATE_KB < '50' THEN INL.INKA_DATE                                                                         " & vbNewLine _
                                             & "      ELSE ZAI.INKO_DATE                                                                                                       " & vbNewLine _
                                             & " END                    AS INKA_DATE                                                                                           " & vbNewLine _
                                             & "--(2012.10.22)MGD.SET_NAIYOによる判定が必要か  --  END  --                                                                     " & vbNewLine _
                                             & ",ZAI.REMARK_OUT         AS REMARK_OUT                                                                                          " & vbNewLine _
                                             & ",CASE WHEN (MDGE.GOODS_NM IS NOT NULL AND MDGE.GOODS_NM <> '' AND EDIL.OUTKA_CTL_NO IS NOT NULL) THEN MDGE.GOODS_NM            " & vbNewLine _
                                             & "      WHEN (MDGL.GOODS_NM IS NOT NULL AND MDGL.GOODS_NM <> '' AND EDIL.OUTKA_CTL_NO IS NULL) THEN MDGL.GOODS_NM                " & vbNewLine _
                                             & "      ELSE MG.GOODS_NM_1                                                                                                       " & vbNewLine _
                                             & " END                    AS GOODS_NM_1                                                                                          " & vbNewLine _
                                             & ",OUTS.LOT_NO            AS LOT_NO                                                                                              " & vbNewLine _
                                             & ",OUTS.SERIAL_NO         AS SERIAL_NO                                                                                           " & vbNewLine _
                                             & ",OUTS.IRIME             AS IRIME                                                                                               " & vbNewLine _
                                             & ",MG.PKG_NB              AS PKG_NB                                                                                              " & vbNewLine _
                                             & ",OUTS.ALCTD_NB / MG.PKG_NB     AS KONSU                                                                                        " & vbNewLine _
                                             & ",OUTS.ALCTD_NB % MG.PKG_NB     AS HASU                                                                                         " & vbNewLine _
                                             & ",OUTS.ALCTD_NB          AS ALCTD_NB                                                                                            " & vbNewLine _
                                             & ",MG.PKG_UT              AS PKG_UT                                                                                              " & vbNewLine _
                                             & ",KBN5.KBN_NM1           AS PKG_UT_NM                                                                                           " & vbNewLine _
                                             & ",OUTS.ALCTD_QT          AS ALCTD_QT                                                                                            " & vbNewLine _
                                             & ",MG.STD_IRIME_UT        AS IRIME_UT                                                                                            " & vbNewLine _
                                             & "--(2012.10.01)要望番号1445 -- START --                                                                                         " & vbNewLine _
                                             & ",UL.UNSO_WT             AS WT                                                                                                  " & vbNewLine _
                                             & "--,OUTS.BETU_WT * OUTS.ALCTD_NB  AS WT                                                                                         " & vbNewLine _
                                             & "--(2012.10.01)要望番号1445 --  END  --                                                                                         " & vbNewLine _
                                             & ",0                      AS UNSO_WT                                                                                             " & vbNewLine _
                                             & ",OUTS.TOU_NO            AS TOU_NO                                                                                              " & vbNewLine _
                                             & ",OUTS.SITU_NO           AS SITU_NO                                                                                             " & vbNewLine _
                                             & ",RTRIM(OUTS.ZONE_CD)     AS ZONE_CD                                                                                            " & vbNewLine _
                                             & ",OUTS.LOCA              AS LOCA                                                                                                " & vbNewLine _
                                             & ",OUTS.ALCTD_CAN_NB / MG.PKG_NB   AS ZAN_KONSU                                                                                  " & vbNewLine _
                                             & ",OUTS.ALCTD_CAN_NB % MG.PKG_NB   AS ZAN_HASU                                                                                   " & vbNewLine _
                                             & ",MG.GOODS_CD_CUST       AS GOODS_CD_CUST                                                                                       " & vbNewLine _
                                             & ",OUTM.REMARK            AS REMARK_M                                                                                            " & vbNewLine _
                                             & "--★★★変更開始--------------------------------                                                                               " & vbNewLine _
                                             & ",''   AS CUST_NM_S                                                                                                             " & vbNewLine _
                                             & ",''   AS CUST_NM_S_H                                                                                                           " & vbNewLine _
                                             & "--★★★変更終了--------------------------------                                                                               " & vbNewLine _
                                             & ",OUTM.CUST_ORD_NO_DTL   AS CUST_ORD_NO_DTL                                                                                     " & vbNewLine _
                                             & ",OUTL.REMARK            AS OUTKA_REMARK                                                                                        " & vbNewLine _
                                             & ",UL.REMARK              AS HAISOU_REMARK                                                                                       " & vbNewLine _
                                             & ",OUTL.NHS_REMARK        AS NHS_REMARK                                                                                          " & vbNewLine _
                                             & "--(2012.08.06) 発JIS、着JISが共に同じJISでも、必ず0㎞になるのを修正  --- START ---                                             " & vbNewLine _
                                             & "--,CASE WHEN (OUTL.DEST_KB = '02' AND MDEDI.KYORI > 0) THEN MDEDI.KYORI                                                        " & vbNewLine _
                                             & "--      WHEN (OUTL.DEST_KB = '02' AND MDEDI.KYORI = 0 AND EDIL.DEST_JIS_CD < MSO.JIS_CD) THEN MKY3.KYORI                       " & vbNewLine _
                                             & "--      WHEN (OUTL.DEST_KB = '02' AND MDEDI.KYORI = 0 AND MSO.JIS_CD < EDIL.DEST_JIS_CD) THEN MKY4.KYORI                       " & vbNewLine _
                                             & "--      WHEN (OUTL.DEST_KB <> '02' AND MDOUT.KYORI > 0) THEN MDOUT.KYORI                                                       " & vbNewLine _
                                             & "--      WHEN (OUTL.DEST_KB <> '02' AND MDOUT.KYORI = 0 AND MDOUT.JIS < MSO.JIS_CD) THEN MKY1.KYORI                             " & vbNewLine _
                                             & "--      WHEN (OUTL.DEST_KB <> '02' AND MDOUT.KYORI = 0 AND MSO.JIS_CD < MDOUT.JIS) THEN MKY2.KYORI                             " & vbNewLine _
                                             & "--      ELSE 0                                                                                                                 " & vbNewLine _
                                             & "-- END                  AS KYORI                                                                                               " & vbNewLine _
                                             & ",CASE WHEN (OUTL.DEST_KB = '02' AND MDEDI.KYORI > 0) THEN MDEDI.KYORI                                                          " & vbNewLine _
                                             & "      WHEN (OUTL.DEST_KB = '02' AND MDEDI.KYORI = 0 AND EDIL.DEST_JIS_CD <= MSO.JIS_CD) THEN MKY3.KYORI                        " & vbNewLine _
                                             & "      WHEN (OUTL.DEST_KB = '02' AND MDEDI.KYORI = 0 AND MSO.JIS_CD <= EDIL.DEST_JIS_CD) THEN MKY4.KYORI                        " & vbNewLine _
                                             & "      WHEN (OUTL.DEST_KB <> '02' AND MDOUT.KYORI > 0) THEN MDOUT.KYORI                                                         " & vbNewLine _
                                             & "      WHEN (OUTL.DEST_KB <> '02' AND MDOUT.KYORI = 0 AND MDOUT.JIS <= MSO.JIS_CD) THEN MKY1.KYORI                              " & vbNewLine _
                                             & "      WHEN (OUTL.DEST_KB <> '02' AND MDOUT.KYORI = 0 AND MSO.JIS_CD <= MDOUT.JIS) THEN MKY2.KYORI                              " & vbNewLine _
                                             & "      ELSE 0                                                                                                                   " & vbNewLine _
                                             & " END                    AS KYORI                                                                                               " & vbNewLine _
                                             & "--(2012.08.06) 発JIS、着JISが共に同じJISでも、必ず0㎞になるのを修正  ---  END  ---                                             " & vbNewLine _
                                             & ",OUTL.OUTKA_PKG_NB      AS OUTKA_PKG_NB_L                                                                                      " & vbNewLine _
                                             & ",KBN2.KBN_NM1           AS SOKO_NM                                                                                             " & vbNewLine _
                                             & ",KBN3.KBN_NM1           AS BUSHO_NM                                                                                            " & vbNewLine _
                                             & ",KBN4.KBN_NM1           AS NRS_BR_NM_NICHI                                                                                     " & vbNewLine _
                                             & ",OUTS.ALCTD_CAN_QT      AS ALCTD_CAN_QT                                                                                        " & vbNewLine _
                                             & ",OUTM.ALCTD_KB          AS ALCTD_KB                                                                                            " & vbNewLine _
                                             & ",'0'                    AS PTN_FLAG                                                                                            " & vbNewLine _
                                             & ",OUTL.CUST_CD_L         AS CUST_CD_L                                                                                           " & vbNewLine _
                                             & ",OUTL.ORDER_TYPE        AS ORDER_TYPE                                                                                          " & vbNewLine _
                                             & "--(2012.10.19)要望番号1289 -- START --                                                                                         " & vbNewLine _
                                             & ",OUTL.SYS_UPD_PGID      AS SYS_UPD_PGID                                                                                        " & vbNewLine _
                                             & "--(2012.10.19)要望番号1289 --  END  --                                                                                         " & vbNewLine _
                                             & ",ZAI.LT_DATE                                                                                                                   " & vbNewLine _
                                             & ",OUTM.BUYER_ORD_NO_DTL AS BUYER_ORD_NO_DTL                                                                                     " & vbNewLine _
                                             & "--(2012.10.19)要望番号1289 -- START --                                                                                         " & vbNewLine _
                                             & ",ZAI.GOODS_COND_KB_1 AS GOODS_COND_CD_1                                                                                        " & vbNewLine _
                                             & "--(2012.10.19)要望番号1289 --  END  --                                                                                         " & vbNewLine _
                                             & ",ZAI.GOODS_COND_KB_2 AS GOODS_COND_CD                                                                                          " & vbNewLine _
                                             & "--(2012.10.19)要望番号1289 -- START --                                                                                         " & vbNewLine _
                                             & ",ZAI.GOODS_COND_KB_3 AS GOODS_COND_CD_3                                                                                        " & vbNewLine _
                                             & "--(2012.10.19)要望番号1289 --  END  --                                                                                         " & vbNewLine _
                                             & ",ZAI.REMARK AS REMARK_ZAI                                                                                                      " & vbNewLine _
                                             & ",KBN6.KBN_NM2 AS TITLE_SMPL                                                                                                    " & vbNewLine _
                                             & ",OUTS.ALCTD_CAN_NB AS ALCTD_CAN_NB                                                                                             " & vbNewLine _
                                             & ",OUTM.BACKLOG_QT                                                                                                               " & vbNewLine _
                                             & ",KBN7.KBN_NM2 AS DOKU_NM                                                                                                       " & vbNewLine _
                                             & "--【要望番号995】　2012/04/17　元着払い区分　START                                                                             " & vbNewLine _
                                             & " ,MCD.SET_NAIYO    AS MCD_SET_NAIYO                                                                                            " & vbNewLine _
                                             & " ,MCD.SET_NAIYO_2  AS MCD_SET_NAIYO_2                                                                                          " & vbNewLine _
                                             & " ,MCD.SET_NAIYO_3  AS MCD_SET_NAIYO_3                                                                                          " & vbNewLine _
                                             & ",KBN9.KBN_NM2 AS PC_KB_NM                                                                                                      " & vbNewLine _
                                             & "--【要望番号995】　2012/04/17　元着払い区分　 END                                                                              " & vbNewLine _
                                             & "--日医工対策開始                                                                                                               " & vbNewLine _
                                             & ",EDIL.FREE_C01           AS TORI_KB                                                                                            " & vbNewLine _
                                             & "--★追加開始2012/05/11                                                                                                         " & vbNewLine _
                                             & ",OUTL.SHIP_CD_L          AS SHIP_CD_L                                                                                          " & vbNewLine _
                                             & "--★追加終了2012/05/11                                                                                                         " & vbNewLine _
                                             & "--★削除開始2012/05/11                                                                                                         " & vbNewLine _
                                             & "--,EDIL.SHIP_NM_L          AS CHOKUSO_NM1                                                                                      " & vbNewLine _
                                             & "--,EDIL.FREE_C11           AS CHOKUSO_CD                                                                                       " & vbNewLine _
                                             & "--,EDIL.FREE_C08           AS HAKKO_DATE                                                                                       " & vbNewLine _
                                             & "--★削除終了2012/05/11                                                                                                         " & vbNewLine _
                                             & ",MCD_N.SET_NAIYO         AS SET_NAIYO_4                                                                                        " & vbNewLine _
                                             & ",MCD_N.SET_NAIYO_2       AS SET_NAIYO_5                                                                                        " & vbNewLine _
                                             & ",MCD_N.SET_NAIYO_3       AS SET_NAIYO_6                                                                                        " & vbNewLine _
                                             & ",MG.GOODS_NM_2           AS GOODS_NM_2                                                                                         " & vbNewLine _
                                             & ",EDIM.FREE_C02           AS KICHO_KB                                                                                           " & vbNewLine _
                                             & ",EDIM.FREE_C03           AS SEI_YURAI_KB                                                                                       " & vbNewLine _
                                             & ",EDIM.FREE_C04           AS REMARK_UPPER      --群馬篠崎運送利用                                                               " & vbNewLine _
                                             & ",EDIM.FREE_C05           AS REMARK_LOWER                                                                                       " & vbNewLine _
                                             & ",EDIM.FREE_C06           AS GOODS_SYUBETU     --群馬篠崎運送利用                                                               " & vbNewLine _
                                             & ",EDIM.FREE_C01           AS YUKOU_KIGEN                                                                                        " & vbNewLine _
                                             & ",MG.GOODS_NM_3           AS GOODS_NM_3         --2012/05/23                                                                    " & vbNewLine _
                                             & ",MDOUTU.EDI_CD           AS EDISHIP_CD         --2012/05/23                                                                    " & vbNewLine _
                                             & ",MDOUT.EDI_CD            AS EDIDEST_CD         --2012/05/23                                                                    " & vbNewLine _
                                             & "--日医工対策終了                                                                                                               " & vbNewLine _
                                             & "--(2012.06.01) 日本ﾌｧｲﾝ対応  --- START ---                                                                                     " & vbNewLine _
                                             & ",MCD_F.SET_NAIYO         AS SET_NAIYO_FROM1                                                                                    " & vbNewLine _
                                             & ",MCD_F.SET_NAIYO_2       AS SET_NAIYO_FROM2                                                                                    " & vbNewLine _
                                             & ",MCD_F.SET_NAIYO_3       AS SET_NAIYO_FROM3                                                                                    " & vbNewLine _
                                             & "--(2012.06.01) 日本ﾌｧｲﾝ対応  --- START ---                                                                                     " & vbNewLine _
                                             & "--(2012.10.30) 富士フィルム対応  --- START ---                                                                                 " & vbNewLine _
                                             & ",MGD_FJF.SET_NAIYO       AS FJF_SET_NAIYO                                                                                      " & vbNewLine _
                                             & "--(2012.10.30) 富士フィルム対応  ---  END  ---                                                                                 " & vbNewLine _
                                             & "--【要望番号1122】埼玉対応 --- START ---                                                                                       " & vbNewLine _
                                             & ",MC.AD_3                 AS CUST_AD_3                                                                                          " & vbNewLine _
                                             & ",MDOUT.REMARK            AS DEST_REMARK                                                                                        " & vbNewLine _
                                             & ",MDOUT.SALES_CD          AS DEST_SALES_CD                                                                                      " & vbNewLine _
                                             & ",MC_SALES.CUST_NM_L      AS DEST_SALES_NM                                                                                      " & vbNewLine _
                                             & ",MC_SALES.AD_1           AS DEST_SALES_AD_1                                                                                    " & vbNewLine _
                                             & ",MC_SALES.AD_2           AS DEST_SALES_AD_2                                                                                    " & vbNewLine _
                                             & ",MC_SALES.AD_3           AS DEST_SALES_AD_3                                                                                    " & vbNewLine _
                                             & ",MC_SALES.TEL            AS DEST_SALES_TEL                                                                                     " & vbNewLine _
                                             & "--【要望番号1122】埼玉対応 ---  END  ---                                                                                       " & vbNewLine _
                                             & "--群馬篠崎運送向け自由項目対応　開始　                                                                                         " & vbNewLine _
                                             & ",EDIM.FREE_C07           AS SZ01_YUSO --篠崎                                                                                   " & vbNewLine _
                                             & ",EDIM.FREE_C09           AS SZ01_UNSO --篠崎                                                                                   " & vbNewLine _
                                             & "--群馬篠崎運送向け自由項目対応　終了                                                                                         　" & vbNewLine _
                                             & "--(2012.10.19)要望番号1289 -- START --                                                                                         " & vbNewLine _
                                             & "      ,MGD.SET_NAIYO                      AS  SET_NAIYO                                                                        " & vbNewLine _
                                             & "--(2012.10.19)要望番号1289 --  END  --                                                                                         " & vbNewLine _
                                             & ",KBN10.KBN_NM1            AS SHOBO_KBN_NM                                                                                      " & vbNewLine _
                                             & ",MSHOBO.HINMEI            AS HINMEI                                                                                            " & vbNewLine

    Friend Const SQL_FROM_OUTKA_631 As String = "--出荷L                                                                                                                      " & vbNewLine _
                                             & "FROM                                                                                                                           " & vbNewLine _
                                             & "$LM_TRN$..C_OUTKA_L OUTL                                                                                                       " & vbNewLine _
                                             & "--トランザクションテーブル                                                                                                     " & vbNewLine _
                                             & "--出荷M                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..C_OUTKA_M OUTM                                                                                             " & vbNewLine _
                                             & "ON  OUTM.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "AND OUTM.OUTKA_NO_L = OUTL.OUTKA_NO_L                                                                                          " & vbNewLine _
                                             & "AND OUTM.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--★★★追加開始--------------------------------                                                                               " & vbNewLine _
                                             & "--出荷M(中MIN)                                                                                                                 " & vbNewLine _
                                             & "LEFT OUTER JOIN                                                                                                                " & vbNewLine _
                                             & "       (SELECT                                                                                                                 " & vbNewLine _
                                             & "           NRS_BR_CD                                                                                                           " & vbNewLine _
                                             & "           ,OUTKA_NO_L                                                                                                         " & vbNewLine _
                                             & "           ,MIN(OUTKA_NO_M) AS  OUTKA_NO_M                                                                                     " & vbNewLine _
                                             & "       FROM $LM_TRN$..C_OUTKA_M WHERE SYS_DEL_FLG ='0'                                                                         " & vbNewLine _
                                             & "        AND NRS_BR_CD = @NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "        AND OUTKA_NO_L = @KANRI_NO_L                                                                                           " & vbNewLine _
                                             & "       GROUP BY NRS_BR_CD,OUTKA_NO_L) OUTM_MIN                                                                                 " & vbNewLine _
                                             & "       ON OUTM_MIN.NRS_BR_CD        = OUTL.NRS_BR_CD                                                                           " & vbNewLine _
                                             & "       AND OUTM_MIN.OUTKA_NO_L      = OUTL.OUTKA_NO_L                                                                          " & vbNewLine _
                                             & "--出荷M(中MIN)                                                                                                                 " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..C_OUTKA_M OUTM2                                                                                            " & vbNewLine _
                                             & "ON  OUTM2.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                           " & vbNewLine _
                                             & "AND OUTM2.OUTKA_NO_L = OUTL.OUTKA_NO_L                                                                                         " & vbNewLine _
                                             & "AND OUTM2.OUTKA_NO_M = OUTM_MIN.OUTKA_NO_M                                                                                     " & vbNewLine _
                                             & "AND OUTM2.SYS_DEL_FLG = '0'                                                                                                    " & vbNewLine _
                                             & "--★★★追加終了--------------------------------                                                                               " & vbNewLine _
                                             & "--出荷S                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..C_OUTKA_S OUTS                                                                                             " & vbNewLine _
                                             & "ON  OUTS.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "AND OUTS.OUTKA_NO_L = OUTL.OUTKA_NO_L                                                                                          " & vbNewLine _
                                             & "AND OUTS.OUTKA_NO_M = OUTM.OUTKA_NO_M                                                                                          " & vbNewLine _
                                             & "AND OUTS.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--出荷EDIL                                                                                                                     " & vbNewLine _
                                             & " LEFT JOIN (                                                                                                                   " & vbNewLine _
                                             & "            SELECT                                                                                                             " & vbNewLine _
                                             & "                   NRS_BR_CD                                                                                                   " & vbNewLine _
                                             & "                 , EDI_CTL_NO                                                                                                  " & vbNewLine _
                                             & "                 , OUTKA_CTL_NO                                                                                                " & vbNewLine _
                                             & "             FROM (                                                                                                            " & vbNewLine _
                                             & "                    SELECT                                                                                                     " & vbNewLine _
                                             & "                           EDIOUTL.NRS_BR_CD                                                                                   " & vbNewLine _
                                             & "                         , EDIOUTL.EDI_CTL_NO                                                                                  " & vbNewLine _
                                             & "                         , EDIOUTL.OUTKA_CTL_NO                                                                                " & vbNewLine _
                                             & "                         , CASE WHEN EDIOUTL.OUTKA_CTL_NO = '' THEN 1                                                          " & vbNewLine _
                                             & "                           ELSE ROW_NUMBER() OVER (PARTITION BY EDIOUTL.NRS_BR_CD                                              " & vbNewLine _
                                             & "                                                              , EDIOUTL.OUTKA_CTL_NO                                           " & vbNewLine _
                                             & "                                                       ORDER BY EDIOUTL.NRS_BR_CD                                              " & vbNewLine _
                                             & "                                                              , EDIOUTL.EDI_CTL_NO                                             " & vbNewLine _
                                             & "                                                  )                                                                            " & vbNewLine _
                                             & "                           END AS IDX                                                                                          " & vbNewLine _
                                             & "                     FROM $LM_TRN$..H_OUTKAEDI_L EDIOUTL                                                                       " & vbNewLine _
                                             & "                    WHERE EDIOUTL.SYS_DEL_FLG  = '0'                                                                           " & vbNewLine _
                                             & "                      AND EDIOUTL.NRS_BR_CD    = @NRS_BR_CD                                                                    " & vbNewLine _
                                             & "                      AND EDIOUTL.OUTKA_CTL_NO = @KANRI_NO_L                                                                   " & vbNewLine _
                                             & "                  ) EBASE                                                                                                      " & vbNewLine _
                                             & "            WHERE EBASE.IDX = 1                                                                                                " & vbNewLine _
                                             & "            ) TOPEDI                                                                                                           " & vbNewLine _
                                             & "        ON TOPEDI.NRS_BR_CD    = OUTL.NRS_BR_CD                                                                                " & vbNewLine _
                                             & "       AND TOPEDI.OUTKA_CTL_NO = OUTL.OUTKA_NO_L                                                                               " & vbNewLine _
                                             & " LEFT JOIN $LM_TRN$..H_OUTKAEDI_L EDIL                                                                                         " & vbNewLine _
                                             & "        ON EDIL.NRS_BR_CD  = TOPEDI.NRS_BR_CD                                                                                  " & vbNewLine _
                                             & "       AND EDIL.EDI_CTL_NO = TOPEDI.EDI_CTL_NO                                                                                 " & vbNewLine _
                                             & "--(2012.09.06)要望番号1412対応  ---  END  ---                                                                                  " & vbNewLine _
                                             & "--入荷L                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..B_INKA_L INL                                                                                               " & vbNewLine _
                                             & "ON  INL.NRS_BR_CD = OUTS.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "AND INL.INKA_NO_L = OUTS.INKA_NO_L                                                                                             " & vbNewLine _
                                             & "AND INL.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--入荷S                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..B_INKA_S INS                                                                                               " & vbNewLine _
                                             & "ON  INS.NRS_BR_CD = OUTS.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "AND INS.INKA_NO_L = OUTS.INKA_NO_L                                                                                             " & vbNewLine _
                                             & "AND INS.INKA_NO_M = OUTS.INKA_NO_M                                                                                             " & vbNewLine _
                                             & "AND INS.INKA_NO_S = OUTS.INKA_NO_S                                                                                             " & vbNewLine _
                                             & "AND INS.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--運送L                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..F_UNSO_L UL                                                                                                " & vbNewLine _
                                             & "ON  UL.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                              " & vbNewLine _
                                             & "AND UL.INOUTKA_NO_L = OUTL.OUTKA_NO_L                                                                                          " & vbNewLine _
                                             & "AND UL.MOTO_DATA_KB = '20'                                                                                                     " & vbNewLine _
                                             & "AND UL.SYS_DEL_FLG = '0'                                                                                                       " & vbNewLine _
                                             & "--在庫テーブル                                                                                                                 " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..D_ZAI_TRS ZAI                                                                                              " & vbNewLine _
                                             & "ON  ZAI.NRS_BR_CD = OUTS.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "AND ZAI.ZAI_REC_NO = OUTS.ZAI_REC_NO                                                                                           " & vbNewLine _
                                             & "AND ZAI.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--マスタテーブル                                                                                                               " & vbNewLine _
                                             & "--営業所M                                                                                                                      " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_NRS_BR MNRS                                                                                              " & vbNewLine _
                                             & "ON MNRS.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "--商品M                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_GOODS MG                                                                                                 " & vbNewLine _
                                             & "ON  MG.NRS_BR_CD = OUTM.NRS_BR_CD                                                                                              " & vbNewLine _
                                             & "AND MG.GOODS_CD_NRS = OUTM.GOODS_CD_NRS                                                                                        " & vbNewLine _
                                             & "--★★★追加開始--------------------------------                                                                               " & vbNewLine _
                                             & "--商品M(MIN)                                                                                                                   " & vbNewLine _
                                             & "LEFT OUTER JOIN $LM_MST$..M_GOODS M_GOODS_MIN                                                                                  " & vbNewLine _
                                             & "ON M_GOODS_MIN.NRS_BR_CD      = OUTL.NRS_BR_CD                                                                                 " & vbNewLine _
                                             & "AND M_GOODS_MIN.GOODS_CD_NRS   = OUTM2.GOODS_CD_NRS                                                                            " & vbNewLine _
                                             & "--★★★追加終了--------------------------------                                                                               " & vbNewLine _
                                             & "--荷主M(商品M経由)                                                                                                             " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST MC                                                                                                  " & vbNewLine _
                                             & "ON  MC.NRS_BR_CD = MG.NRS_BR_CD                                                                                                " & vbNewLine _
                                             & "AND MC.CUST_CD_L = MG.CUST_CD_L                                                                                                " & vbNewLine _
                                             & "AND MC.CUST_CD_M = MG.CUST_CD_M                                                                                                " & vbNewLine _
                                             & "AND MC.CUST_CD_S = MG.CUST_CD_S                                                                                                " & vbNewLine _
                                             & "AND MC.CUST_CD_SS = MG.CUST_CD_SS                                                                                              " & vbNewLine _
                                             & "--★★★追加開始--------------------------------                                                                               " & vbNewLine _
                                             & "--荷主M(商品M経由) 最小の出荷(中)で抽出                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST MC2                                                                                                 " & vbNewLine _
                                             & "ON  MC2.NRS_BR_CD = M_GOODS_MIN.NRS_BR_CD                                                                                      " & vbNewLine _
                                             & "AND MC2.CUST_CD_L = M_GOODS_MIN.CUST_CD_L                                                                                      " & vbNewLine _
                                             & "AND MC2.CUST_CD_M = M_GOODS_MIN.CUST_CD_M                                                                                      " & vbNewLine _
                                             & "AND MC2.CUST_CD_S = M_GOODS_MIN.CUST_CD_S                                                                                      " & vbNewLine _
                                             & "AND MC2.CUST_CD_SS = M_GOODS_MIN.CUST_CD_SS                                                                                    " & vbNewLine _
                                             & "AND MC2.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--★★★追加終了--------------------------------                                                                               " & vbNewLine _
                                             & "--届先M(届先取得)(出荷L参照)                                                                                                   " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_DEST MDOUT                                                                                               " & vbNewLine _
                                             & "ON  MDOUT.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                           " & vbNewLine _
                                             & "AND MDOUT.CUST_CD_L = OUTL.CUST_CD_L                                                                                           " & vbNewLine _
                                             & "AND MDOUT.DEST_CD = OUTL.DEST_CD                                                                                               " & vbNewLine _
                                             & "--届先M(売上先取得)(出荷L参照)                                                                                                 " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_DEST MDOUTU                                                                                              " & vbNewLine _
                                             & "ON  MDOUTU.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                          " & vbNewLine _
                                             & "AND MDOUTU.CUST_CD_L = OUTL.CUST_CD_L                                                                                          " & vbNewLine _
                                             & "AND MDOUTU.DEST_CD = OUTL.SHIP_CD_L                                                                                            " & vbNewLine _
                                             & "--届先M(届先取得)(出荷EDIL参照)                                                                                                " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_DEST MDEDI                                                                                               " & vbNewLine _
                                             & "ON  MDEDI.NRS_BR_CD = EDIL.NRS_BR_CD                                                                                           " & vbNewLine _
                                             & "AND MDEDI.CUST_CD_L = EDIL.CUST_CD_L                                                                                           " & vbNewLine _
                                             & "AND MDEDI.DEST_CD = EDIL.DEST_CD                                                                                               " & vbNewLine _
                                             & "--【要望番号1122】埼玉対応 --- START ---                                                                                       " & vbNewLine _
                                             & "--届先M(納品書荷主名義名取得)(届先M参照)                                                                                       " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST MC_SALES                                                                                            " & vbNewLine _
                                             & "       ON MC_SALES.NRS_BR_CD  = MDOUT.NRS_BR_CD                                                                                " & vbNewLine _
                                             & "      AND MC_SALES.CUST_CD_L  = MDOUT.SALES_CD                                                                                 " & vbNewLine _
                                             & "      AND MC_SALES.CUST_CD_M  = '00'                                                                                           " & vbNewLine _
                                             & "      AND MC_SALES.CUST_CD_S  = '00'                                                                                           " & vbNewLine _
                                             & "      AND MC_SALES.CUST_CD_SS = '00'                                                                                           " & vbNewLine _
                                             & "--【要望番号1122】埼玉対応 ---  END  ---                                                                                       " & vbNewLine _
                                             & "--運送会社M                                                                                                                    " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_UNSOCO MUCO                                                                                              " & vbNewLine _
                                             & "ON  MUCO.NRS_BR_CD = UL.NRS_BR_CD                                                                                              " & vbNewLine _
                                             & "AND MUCO.UNSOCO_CD = UL.UNSO_CD                                                                                                " & vbNewLine _
                                             & "AND MUCO.UNSOCO_BR_CD = UL.UNSO_BR_CD                                                                                          " & vbNewLine _
                                             & "--倉庫M                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_SOKO MSO                                                                                                 " & vbNewLine _
                                             & "ON  MSO.NRS_BR_CD = OUTL.NRS_BR_CD  --追加                                                                                     " & vbNewLine _
                                             & "AND MSO.WH_CD     = OUTL.WH_CD                                                                                                 " & vbNewLine _
                                             & "--2014/5/16Start s.kobayashi NotesNo.2183                                                                                      " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN11                                                                                                " & vbNewLine _
                                             & "ON  KBN11.KBN_GROUP_CD = 'U028'  --追加                                                                                        " & vbNewLine _
                                             & "AND UL.SEIQ_TARIFF_CD = KBN11.KBN_NM1                                                                                          " & vbNewLine _
                                             & "--2014/5/16End s.kobayashi NotesNo.2183                                                                                       " & vbNewLine _
                                             & "--距離程M(M_DEST.JIS < M_SOKO.JIS_CD)(出荷L参照)                                                                               " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_KYORI MKY1                                                                                               " & vbNewLine _
                                             & "ON  MKY1.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "--AND MKY1.KYORI_CD = MC.BETU_KYORI_CD                                                                                           " & vbNewLine _
                                             & "AND MKY1.KYORI_CD = (CASE ISNULL(KBN11.KBN_NM2,'') WHEN '' THEN MC.BETU_KYORI_CD ELSE KBN11.KBN_NM2 END)                       " & vbNewLine _
                                             & "AND MKY1.ORIG_JIS_CD = MDOUT.JIS                                                                                               " & vbNewLine _
                                             & "AND MKY1.DEST_JIS_CD = MSO.JIS_CD                                                                                              " & vbNewLine _
                                             & "--距離程M(M_SOKO.JIS_CD < M_DEST.JIS)(出荷L参照)                                                                               " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_KYORI MKY2                                                                                               " & vbNewLine _
                                             & "ON  MKY2.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "--AND MKY2.KYORI_CD = MC.BETU_KYORI_CD                                                                                           " & vbNewLine _
                                             & "AND MKY2.KYORI_CD = (CASE ISNULL(KBN11.KBN_NM2,'') WHEN '' THEN MC.BETU_KYORI_CD ELSE KBN11.KBN_NM2 END)                       " & vbNewLine _
                                             & "AND MKY2.ORIG_JIS_CD = MSO.JIS_CD                                                                                              " & vbNewLine _
                                             & "AND MKY2.DEST_JIS_CD = MDOUT.JIS                                                                                               " & vbNewLine _
                                             & "--距離程M(H_OUTKAEDI_L.DEST_JIS_CD < M_SOKO.JIS_CD)(出荷EDIL参照)                                                              " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_KYORI MKY3                                                                                               " & vbNewLine _
                                             & "ON  MKY3.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "--AND MKY3.KYORI_CD = MC.BETU_KYORI_CD                                                                                           " & vbNewLine _
                                             & "AND MKY3.KYORI_CD = (CASE ISNULL(KBN11.KBN_NM2,'') WHEN '' THEN MC.BETU_KYORI_CD ELSE KBN11.KBN_NM2 END)                       " & vbNewLine _
                                             & "AND MKY3.ORIG_JIS_CD = EDIL.DEST_JIS_CD                                                                                        " & vbNewLine _
                                             & "AND MKY3.DEST_JIS_CD = MSO.JIS_CD                                                                                              " & vbNewLine _
                                             & "--距離程M(M_SOKO.JIS_CD < H_OUTKAEDI_L.DEST_JIS_CD)(出荷EDIL参照)                                                              " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_KYORI MKY4                                                                                               " & vbNewLine _
                                             & "ON  MKY4.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "--AND MKY4.KYORI_CD = MC.BETU_KYORI_CD                                                                                           " & vbNewLine _
                                             & "AND MKY4.KYORI_CD = (CASE ISNULL(KBN11.KBN_NM2,'') WHEN '' THEN MC.BETU_KYORI_CD ELSE KBN11.KBN_NM2 END)                       " & vbNewLine _
                                             & "AND MKY4.ORIG_JIS_CD = MSO.JIS_CD                                                                                              " & vbNewLine _
                                             & "AND MKY4.DEST_JIS_CD = EDIL.DEST_JIS_CD                                                                                        " & vbNewLine _
                                             & "--届先商品M(出荷L参照)                                                                                                         " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_DESTGOODS MDGL                                                                                           " & vbNewLine _
                                             & "ON  MDGL.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "AND MDGL.CUST_CD_L = OUTL.CUST_CD_L                                                                                            " & vbNewLine _
                                             & "AND MDGL.CUST_CD_M = OUTL.CUST_CD_M                                                                                            " & vbNewLine _
                                             & "AND MDGL.CD = OUTL.DEST_CD                                                                                                     " & vbNewLine _
                                             & "AND MDGL.GOODS_CD_NRS = MG.GOODS_CD_NRS                                                                                        " & vbNewLine _
                                             & "AND MDGL.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--届先商品M(出荷EDI参照)                                                                                                       " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_DESTGOODS MDGE                                                                                           " & vbNewLine _
                                             & "ON  MDGE.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "AND MDGE.CUST_CD_L = OUTL.CUST_CD_L                                                                                            " & vbNewLine _
                                             & "AND MDGE.CUST_CD_M = OUTL.CUST_CD_M                                                                                            " & vbNewLine _
                                             & "AND MDGE.CD = EDIL.DEST_CD                                                                                                     " & vbNewLine _
                                             & "AND MDGE.GOODS_CD_NRS = MG.GOODS_CD_NRS                                                                                        " & vbNewLine _
                                             & "AND MDGE.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--消防M★                                                                                                                      " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_SHOBO MSHOBO                                                                                             " & vbNewLine _
                                             & "ON  MSHOBO.SHOBO_CD = MG.SHOBO_CD                                                                                              " & vbNewLine _
                                             & "AND MSHOBO.SYS_DEL_FLG = '0'                                                                                                   " & vbNewLine _
                                             & "--区分M(納入予定区分)                                                                                                          " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN1                                                                                                 " & vbNewLine _
                                             & "ON  KBN1.KBN_GROUP_CD = 'N010'                                                                                                 " & vbNewLine _
                                             & "AND KBN1.KBN_CD = OUTL.ARR_PLAN_TIME                                                                                           " & vbNewLine _
                                             & "AND KBN1.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--区分M(日本合成用倉庫名)                                                                                                      " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN2                                                                                                 " & vbNewLine _
                                             & "ON  KBN2.KBN_GROUP_CD = 'P005'                                                                                                 " & vbNewLine _
                                             & "AND KBN2.KBN_CD = '00'                                                                                                         " & vbNewLine _
                                             & "AND KBN2.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--区分M(日本合成用部署名)                                                                                                      " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN3                                                                                                 " & vbNewLine _
                                             & "ON  KBN3.KBN_GROUP_CD = 'P005'                                                                                                 " & vbNewLine _
                                             & "AND KBN3.KBN_CD = '01'                                                                                                         " & vbNewLine _
                                             & "AND KBN3.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--区分M(日本合成用営業署名)                                                                                                    " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN4                                                                                                 " & vbNewLine _
                                             & "ON  KBN4.KBN_GROUP_CD = 'P005'                                                                                                 " & vbNewLine _
                                             & "AND KBN4.KBN_CD = '02'                                                                                                         " & vbNewLine _
                                             & "AND KBN4.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--区分M(荷姿)                                                                                                                  " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN5                                                                                                 " & vbNewLine _
                                             & "ON  KBN5.KBN_GROUP_CD = 'N001'                                                                                                 " & vbNewLine _
                                             & "AND KBN5.KBN_CD = MG.PKG_UT                                                                                                    " & vbNewLine _
                                             & "AND KBN5.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--明細タイトル（小分け）                                                                                                       " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN6                                                                                                 " & vbNewLine _
                                             & "ON  KBN6.KBN_GROUP_CD = 'S041'                                                                                                 " & vbNewLine _
                                             & "AND KBN6.KBN_CD = OUTM.ALCTD_KB                                                                                                " & vbNewLine _
                                             & "AND KBN6.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--区分M(毒劇区分名称)                                                                                                          " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN7                                                                                                 " & vbNewLine _
                                             & "ON  KBN7.KBN_GROUP_CD = 'G001'                                                                                                 " & vbNewLine _
                                             & "AND KBN7.KBN_CD = MG.DOKU_KB                                                                                                   " & vbNewLine _
                                             & "AND KBN7.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--【要望番号995】　2012/04/17　元着払い区分　START                                                                             " & vbNewLine _
                                             & "--区分M(元着払区分名称)                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN9                                                                                                 " & vbNewLine _
                                             & "ON  KBN9.KBN_GROUP_CD = 'M001'                                                                                                 " & vbNewLine _
                                             & "AND KBN9.KBN_CD = OUTL.PC_KB                                                                                                   " & vbNewLine _
                                             & "AND KBN9.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--【要望番号995】　2012/04/17　元着払い区分　 END                                                                              " & vbNewLine _
                                             & "--区分M(消防区分名称)★                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN10                                                                                                " & vbNewLine _
                                             & "ON  KBN10.KBN_GROUP_CD = 'S004'                                                                                                " & vbNewLine _
                                             & "AND KBN10.KBN_CD = MSHOBO.RUI                                                                                                  " & vbNewLine _
                                             & "AND KBN10.SYS_DEL_FLG = '0'                                                                                                    " & vbNewLine _
                                             & "--日医工対策開始                                                                                                               " & vbNewLine _
                                             & "--★出荷EDI M(日医工)                                                                                                          " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..H_OUTKAEDI_M EDIM                                                                                          " & vbNewLine _
                                             & "ON  EDIM.NRS_BR_CD        = OUTM.NRS_BR_CD                                                                                     " & vbNewLine _
                                             & "AND EDIM.OUTKA_CTL_NO     = OUTM.OUTKA_NO_L                                                                                    " & vbNewLine _
                                             & "AND EDIM.OUTKA_CTL_NO_CHU = OUTM.OUTKA_NO_M                                                                                    " & vbNewLine _
                                             & "AND EDIM.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--日医工_出荷指示EDIデータ                                                                                                     " & vbNewLine _
                                             & "--LEFT JOIN $LM_TRN$..H_OUTKAEDI_DTL_NIK EDIN                                                                                  " & vbNewLine _
                                             & "--ON   OUTL.NRS_BR_CD      = EDIN.NRS_BR_CD                                                                                    " & vbNewLine _
                                             & "--AND  EDIL.EDI_CTL_NO     = EDIN.EDI_CTL_NO                                                                                   " & vbNewLine _
                                             & "--AND  EDIM.EDI_CTL_NO_CHU = EDIN.EDI_CTL_NO_CHU                                                                               " & vbNewLine _
                                             & "--AND  EDIN.SYS_DEL_FLG    = '0'                                                                                               " & vbNewLine _
                                             & "                                                                                                                               " & vbNewLine _
                                             & "--荷主明細M ★                                                                                                                 " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST_DETAILS MCD_N                                                                                       " & vbNewLine _
                                             & "ON  MCD_N.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                           " & vbNewLine _
                                             & "AND MCD_N.CUST_CD   = OUTL.CUST_CD_L                                                                                           " & vbNewLine _
                                             & "AND MCD_N.SUB_KB = '26'                                                                                                        " & vbNewLine _
                                             & "--日医工対策終了                                                                                                               " & vbNewLine _
                                             & "--(2012.06.01) 日本ﾌｧｲﾝ対応  --- START ----                                                                                    " & vbNewLine _
                                             & "--荷主明細M                                                                                                                    " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST_DETAILS MCD_F                                                                                       " & vbNewLine _
                                             & "ON  MCD_F.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                           " & vbNewLine _
                                             & "AND MCD_F.CUST_CD   = OUTL.CUST_CD_L                                                                                           " & vbNewLine _
                                             & "AND MCD_F.SUB_KB = '29'                                                                                                        " & vbNewLine _
                                             & "--(2012.06.01) 日本ﾌｧｲﾝ対応  ---  END  ----                                                                                    " & vbNewLine _
                                             & "--(2012.10.30) 富士フィルム対応  --- START ---                                                                                 " & vbNewLine _
                                             & "--商品明細M                                                                                                                    " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_GOODS_DETAILS MGD_FJF                                                                                      " & vbNewLine _
                                             & "ON  MGD_FJF.NRS_BR_CD    = OUTM.NRS_BR_CD                                                                                      " & vbNewLine _
                                             & "AND MGD_FJF.GOODS_CD_NRS = OUTM.GOODS_CD_NRS                                                                                   " & vbNewLine _
                                             & "AND MGD_FJF.SUB_KB = '13'                                                                                                      " & vbNewLine _
                                             & "--(2012.10.30) 富士フィルム対応  ---  END  ---                                                                                 " & vbNewLine _
                                             & "--荷主明細M ★                                                                                                                 " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST_DETAILS MCD                                                                                         " & vbNewLine _
                                             & "ON  MCD.NRS_BR_CD = MG.NRS_BR_CD                                                                                               " & vbNewLine _
                                             & "AND MCD.CUST_CD   = MG.CUST_CD_L                                                                                               " & vbNewLine _
                                             & "AND MCD.SUB_KB = '20'                                                                                                          " & vbNewLine _
                                             & "--出荷Lでの荷主帳票パターン取得                                                                                                " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST_RPT MCR1                                                                                            " & vbNewLine _
                                             & "ON  OUTL.NRS_BR_CD = MCR1.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "AND OUTL.CUST_CD_L = MCR1.CUST_CD_L                                                                                            " & vbNewLine _
                                             & "AND OUTL.CUST_CD_M = MCR1.CUST_CD_M                                                                                            " & vbNewLine _
                                             & "AND '00' = MCR1.CUST_CD_S                                                                                                      " & vbNewLine _
                                             & "AND MCR1.PTN_ID = '04'                                                                                                         " & vbNewLine _
                                             & "--帳票パターン取得                                                                                                             " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_RPT MR1                                                                                                  " & vbNewLine _
                                             & "ON  MR1.NRS_BR_CD = MCR1.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "AND MR1.PTN_ID = MCR1.PTN_ID                                                                                                   " & vbNewLine _
                                             & "AND MR1.PTN_CD = MCR1.PTN_CD                                                                                                   " & vbNewLine _
                                             & "AND MR1.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--商品Mの荷主での荷主帳票パターン取得                                                                                          " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST_RPT MCR2                                                                                            " & vbNewLine _
                                             & "ON  MG.NRS_BR_CD = MCR2.NRS_BR_CD                                                                                              " & vbNewLine _
                                             & "AND MG.CUST_CD_L = MCR2.CUST_CD_L                                                                                              " & vbNewLine _
                                             & "AND MG.CUST_CD_M = MCR2.CUST_CD_M                                                                                              " & vbNewLine _
                                             & "AND MG.CUST_CD_S = MCR2.CUST_CD_S                                                                                              " & vbNewLine _
                                             & "AND MCR2.PTN_ID = '04'                                                                                                         " & vbNewLine _
                                             & "--帳票パターン取得                                                                                                             " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_RPT MR2                                                                                                  " & vbNewLine _
                                             & "ON  MR2.NRS_BR_CD = MCR2.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "AND MR2.PTN_ID = MCR2.PTN_ID                                                                                                   " & vbNewLine _
                                             & "AND MR2.PTN_CD = MCR2.PTN_CD                                                                                                   " & vbNewLine _
                                             & "AND MR2.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--存在しない場合の帳票パターン取得                                                                                             " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_RPT MR3                                                                                                  " & vbNewLine _
                                             & "ON  MR3.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "AND MR3.PTN_ID = '04'                                                                                                          " & vbNewLine _
                                             & "AND MR3.STANDARD_FLAG = '01'                                                                                                   " & vbNewLine _
                                             & "AND MR3.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--ユーザM                                                                                                                      " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..S_USER MUSER                                                                                               " & vbNewLine _
                                             & "ON MUSER.USER_CD = OUTL.SYS_ENT_USER                                                                                           " & vbNewLine _
                                             & "AND MUSER.SYS_DEL_FLG = '0'                                                                                                    " & vbNewLine _
                                             & "--商品明細M                                                                                                                    " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_GOODS_DETAILS MGD                                                                                        " & vbNewLine _
                                             & "ON  MGD.NRS_BR_CD = MG.NRS_BR_CD                                                                                               " & vbNewLine _
                                             & "AND MGD.GOODS_CD_NRS = MG.GOODS_CD_NRS                                                                                         " & vbNewLine _
                                             & "AND MGD.SUB_KB = '09'                                                                                                          " & vbNewLine _
                                             & "AND MGD.SYS_DEL_FLG = '0'       --ADD 2019/02/07 依頼番号 : 004605   【LMS】納品書がの梱包個数が2倍になるバグ修正              " & vbNewLine _
                                             & "-- FFEM摘要取得                                                                                                          " & vbNewLine _
                                             & "LEFT JOIN (                                                                                                          " & vbNewLine _
                                             & "            SELECT                                                                                                          " & vbNewLine _
                                             & "                   NRS_BR_CD         AS NRS_BR_CD                                                                                                          " & vbNewLine _
                                             & "                 , OUTKA_CTL_NO      AS OUTKA_CTL_NO                                                                                                          " & vbNewLine _
                                             & "                 , MAX(ZFVYDTEKIYO)  AS ZFVYDTEKIYO                                                                                                          " & vbNewLine _
                                             & "              FROM $LM_TRN$..H_INOUTKAEDI_HED_FJF                                                                                                          " & vbNewLine _
                                             & "             WHERE SYS_DEL_FLG     = '0'                                                                                                          " & vbNewLine _
                                             & "               AND DEL_KB          = '0'                                                                                                          " & vbNewLine _
                                             & "               AND INOUT_KB        = '0'                                                                                                          " & vbNewLine _
                                             & "               AND NRS_BR_CD       = @NRS_BR_CD                                                                                                          " & vbNewLine _
                                             & "               AND OUTKA_CTL_NO    = @KANRI_NO_L                                                                                                          " & vbNewLine _
                                             & "             GROUP BY NRS_BR_CD                                                                                                            " & vbNewLine _
                                             & "                    , OUTKA_CTL_NO                                                                                                          " & vbNewLine _
                                             & "           ) AS FJF                                                                                                          " & vbNewLine _
                                             & "  ON FJF.NRS_BR_CD    = OUTL.NRS_BR_CD                                                                                                          " & vbNewLine _
                                             & " AND FJF.OUTKA_CTL_NO = OUTL.OUTKA_NO_L                                                                                                           " & vbNewLine
    '(2012.10.30) 納品書(千葉・富士フィルム用) -- END --

    ''' <summary>
    ''' 印刷データ抽出用(出荷テーブル)
    ''' </summary>
    ''' <remarks></remarks>
    Friend Const SQL_SELECT_OUTKA_731 As String = "--★★★SQL_SELECT_OUTKA_731★★★  出荷テーブル                                                                           " & vbNewLine _
                                             & "SELECT                                                                                                                         " & vbNewLine _
                                             & " CASE WHEN MR2.PTN_CD IS NOT NULL THEN MR2.RPT_ID                                                                              " & vbNewLine _
                                             & "      WHEN MR1.PTN_CD IS NOT NULL THEN MR1.RPT_ID                                                                              " & vbNewLine _
                                             & "      ELSE MR3.RPT_ID                                                                                                          " & vbNewLine _
                                             & " END              AS RPT_ID                                                                                                    " & vbNewLine _
                                             & ",OUTL.NRS_BR_CD   AS NRS_BR_CD                                                                                                 " & vbNewLine _
                                             & ",OUTM.PRINT_SORT  AS PRINT_SORT                                                                                                " & vbNewLine _
                                             & ",CASE WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_CD                                                                     " & vbNewLine _
                                             & "      ELSE OUTL.DEST_CD                                                                                                        " & vbNewLine _
                                             & " END              AS DEST_CD                                                                                                   " & vbNewLine _
                                             & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_NM                                                                               " & vbNewLine _
                                             & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_NM                                                                     " & vbNewLine _
                                             & "      ELSE MDOUT.DEST_NM                                                                                                       " & vbNewLine _
                                             & " END              AS DEST_NM                                                                                                   " & vbNewLine _
                                             & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_AD_1                                                                             " & vbNewLine _
                                             & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_AD_1                                                                   " & vbNewLine _
                                             & "      ELSE MDOUT.AD_1                                                                                                          " & vbNewLine _
                                             & " END              AS DEST_AD_1                                                                                                 " & vbNewLine _
                                             & ",CASE WHEN OUTL.DEST_KB = '01' THEN OUTL.DEST_AD_2                                                                             " & vbNewLine _
                                             & "      WHEN OUTL.DEST_KB = '02' THEN EDIL.DEST_AD_2                                                                   " & vbNewLine _
                                             & "      ELSE MDOUT.AD_2                                                                                                          " & vbNewLine _
                                             & " END              AS DEST_AD_2                                                                                                 " & vbNewLine _
                                             & ",OUTL.DEST_AD_3   AS DEST_AD_3                                                                                                 " & vbNewLine _
                                             & ",OUTL.DEST_TEL    AS DEST_TEL                                                                                                  " & vbNewLine _
                                             & ",OUTL.OUTKA_PLAN_DATE   AS OUTKA_PLAN_DATE                                                                                     " & vbNewLine _
                                             & ",OUTL.CUST_ORD_NO       AS CUST_ORD_NO                                                                                         " & vbNewLine _
                                             & ",OUTL.BUYER_ORD_NO      AS BUYER_ORD_NO                                                                                        " & vbNewLine _
                                             & ",MUCO.UNSOCO_NM         AS UNSOCO_NM                                                                                           " & vbNewLine _
                                             & ",OUTL.ARR_PLAN_DATE     AS ARR_PLAN_DATE                                                                                       " & vbNewLine _
                                             & ",KBN1.KBN_NM1           AS ARR_PLAN_TIME                                                                                       " & vbNewLine _
                                             & ",OUTL.OUTKA_NO_L        AS OUTKA_NO_L                                                                                          " & vbNewLine _
                                             & ",MDOUTU.DEST_NM         AS URIG_NM                                                                                             " & vbNewLine _
                                             & ",MC.CUST_NM_L           AS CUST_NM_L                                                                                           " & vbNewLine _
                                             & "--(2012.06.15) 要望番号1155 -- START --                                                                                        " & vbNewLine _
                                             & ",MC.CUST_NM_M           AS CUST_NM_M                                                                                           " & vbNewLine _
                                             & "--(2012.06.15) 要望番号1155 --  END  --                                                                                        " & vbNewLine _
                                             & ",MC.AD_1                AS CUST_AD_1                                                                                           " & vbNewLine _
                                             & ",MC.AD_2                AS CUST_AD_2                                                                                           " & vbNewLine _
                                             & ",MC.TEL                 AS CUST_TEL                                                                                            " & vbNewLine _
                                             & ",MC.DENPYO_NM           AS DENPYO_NM                                                                                            " & vbNewLine _
                                             & ",MNRS.NRS_BR_NM         AS NRS_BR_NM                                                                                           " & vbNewLine _
                                             & ",CASE WHEN MSO.WH_KB = '01' THEN MSO.AD_1                                                                             " & vbNewLine _
                                             & "      ELSE MNRS.AD_1                                                                                                          " & vbNewLine _
                                             & " END              AS NRS_BR_AD1                                                                                                 " & vbNewLine _
                                             & ",CASE WHEN MSO.WH_KB = '01' THEN MSO.AD_2                                                                             " & vbNewLine _
                                             & "      ELSE MNRS.AD_2                                                                                                          " & vbNewLine _
                                             & " END              AS NRS_BR_AD2                                                                                                 " & vbNewLine _
                                             & ",CASE WHEN MSO.WH_KB = '01' THEN MSO.TEL                                                                             " & vbNewLine _
                                             & "      ELSE MNRS.TEL                                                                                                          " & vbNewLine _
                                             & " END              AS NRS_BR_TEL                                                                                                 " & vbNewLine _
                                             & ",CASE WHEN MSO.WH_KB = '01' THEN MSO.FAX                                                                             " & vbNewLine _
                                             & "      ELSE MNRS.FAX                                                                                                          " & vbNewLine _
                                             & " END              AS NRS_BR_FAX                                                                                                 " & vbNewLine _
                                             & ",MUSER.USER_NM          AS PIC                                                                                                 " & vbNewLine _
                                             & ",OUTM.OUTKA_NO_M        AS OUTKA_NO_M                                                                                          " & vbNewLine _
                                             & ",OUTS.OUTKA_NO_S        AS OUTKA_NO_S                                                                                          " & vbNewLine _
                                             & "--(2012.10.22)MGD.SET_NAIYOによる判定が必要か  -- START --                                                                     " & vbNewLine _
                                             & "--,CASE WHEN MGD.SET_NAIYO = '1' THEN ''                                                                                       " & vbNewLine _
                                             & "--      WHEN INL.INKA_STATE_KB < '50' THEN INL.INKA_DATE                                                                       " & vbNewLine _
                                             & "--      WHEN INL.INKA_STATE_KB >= '50' THEN ZAI.INKO_DATE                                                                      " & vbNewLine _
                                             & "--      ELSE ''                                                                                                                " & vbNewLine _
                                             & "-- END                  AS INKA_DATE                                                                                           " & vbNewLine _
                                             & ",CASE WHEN INL.INKA_STATE_KB < '50' THEN INL.INKA_DATE                                                                         " & vbNewLine _
                                             & "      ELSE ZAI.INKO_DATE                                                                                                       " & vbNewLine _
                                             & " END                    AS INKA_DATE                                                                                           " & vbNewLine _
                                             & "--(2012.10.22)MGD.SET_NAIYOによる判定が必要か  --  END  --                                                                     " & vbNewLine _
                                             & ",ZAI.REMARK_OUT         AS REMARK_OUT                                                                                          " & vbNewLine _
                                             & ",CASE WHEN (MDGE.GOODS_NM IS NOT NULL AND MDGE.GOODS_NM <> '' AND EDIL.OUTKA_CTL_NO IS NOT NULL) THEN MDGE.GOODS_NM            " & vbNewLine _
                                             & "      WHEN (MDGL.GOODS_NM IS NOT NULL AND MDGL.GOODS_NM <> '' AND EDIL.OUTKA_CTL_NO IS NULL) THEN MDGL.GOODS_NM                " & vbNewLine _
                                             & "      ELSE MG.GOODS_NM_1                                                                                                       " & vbNewLine _
                                             & " END                    AS GOODS_NM_1                                                                                          " & vbNewLine _
                                             & ",OUTS.LOT_NO            AS LOT_NO                                                                                              " & vbNewLine _
                                             & ",OUTS.SERIAL_NO         AS SERIAL_NO                                                                                           " & vbNewLine _
                                             & ",OUTS.IRIME             AS IRIME                                                                                               " & vbNewLine _
                                             & ",MG.PKG_NB              AS PKG_NB                                                                                              " & vbNewLine _
                                             & ",OUTS.ALCTD_NB / MG.PKG_NB     AS KONSU                                                                                        " & vbNewLine _
                                             & ",OUTS.ALCTD_NB % MG.PKG_NB     AS HASU                                                                                         " & vbNewLine _
                                             & ",OUTS.ALCTD_NB          AS ALCTD_NB                                                                                            " & vbNewLine _
                                             & ",MG.PKG_UT              AS PKG_UT                                                                                              " & vbNewLine _
                                             & ",KBN5.KBN_NM1           AS PKG_UT_NM                                                                                           " & vbNewLine _
                                             & ",OUTS.ALCTD_QT          AS ALCTD_QT                                                                                            " & vbNewLine _
                                             & ",MG.STD_IRIME_UT        AS IRIME_UT                                                                                            " & vbNewLine _
                                             & "--(2012.10.01)要望番号1445 -- START --                                                                                         " & vbNewLine _
                                             & ",UL.UNSO_WT             AS WT                                                                                                  " & vbNewLine _
                                             & "--,OUTS.BETU_WT * OUTS.ALCTD_NB  AS WT                                                                                         " & vbNewLine _
                                             & "--(2012.10.01)要望番号1445 --  END  --                                                                                         " & vbNewLine _
                                             & ",0                      AS UNSO_WT                                                                                             " & vbNewLine _
                                             & "--(2012.11.21)要望番号1615 -- START --                                                                                         " & vbNewLine _
                                             & ",CASE WHEN ISNUMERIC(MGD16.SET_NAIYO) = 1 THEN CONVERT(NUMERIC(12,3),MGD16.SET_NAIYO)                                          " & vbNewLine _
                                             & "      ELSE 0                                                                                                                   " & vbNewLine _
                                             & " END                    AS PKG_WT                                                                                              " & vbNewLine _
                                             & "--(2012.11.21)要望番号1615 --  END  --                                                                                         " & vbNewLine _
                                             & ",OUTS.TOU_NO            AS TOU_NO                                                                                              " & vbNewLine _
                                             & ",OUTS.SITU_NO           AS SITU_NO                                                                                             " & vbNewLine _
                                             & ",RTRIM(OUTS.ZONE_CD)     AS ZONE_CD                                                                                             " & vbNewLine _
                                             & ",OUTS.LOCA              AS LOCA                                                                                                " & vbNewLine _
                                             & ",OUTS.ALCTD_CAN_NB / MG.PKG_NB   AS ZAN_KONSU                                                                                  " & vbNewLine _
                                             & ",OUTS.ALCTD_CAN_NB % MG.PKG_NB   AS ZAN_HASU                                                                                   " & vbNewLine _
                                             & ",MG.GOODS_CD_CUST       AS GOODS_CD_CUST                                                                                       " & vbNewLine _
                                             & ",OUTM.REMARK            AS REMARK_M                                                                                            " & vbNewLine _
                                             & "--★★★変更開始--------------------------------                                                                                     " & vbNewLine _
                                             & ",MC.CUST_NM_S  AS CUST_NM_S                                                                                           " & vbNewLine _
                                             & ",MC2.CUST_NM_S   AS CUST_NM_S_H                                                                                           " & vbNewLine _
                                             & "--★★★変更終了--------------------------------                                                                                     " & vbNewLine _
                                             & ",OUTM.CUST_ORD_NO_DTL   AS CUST_ORD_NO_DTL                                                                                     " & vbNewLine _
                                             & ",OUTL.REMARK            AS OUTKA_REMARK                                                                                        " & vbNewLine _
                                             & ",UL.REMARK              AS HAISOU_REMARK                                                                                       " & vbNewLine _
                                             & ",OUTL.NHS_REMARK        AS NHS_REMARK                                                                                          " & vbNewLine _
                                             & "--(2012.08.06) 発JIS、着JISが共に同じJISでも、必ず0㎞になるのを修正  --- START ---                                             " & vbNewLine _
                                             & "--,CASE WHEN (OUTL.DEST_KB = '02' AND MDEDI.KYORI > 0) THEN MDEDI.KYORI                                                        " & vbNewLine _
                                             & "--      WHEN (OUTL.DEST_KB = '02' AND MDEDI.KYORI = 0 AND EDIL.DEST_JIS_CD < MSO.JIS_CD) THEN MKY3.KYORI                       " & vbNewLine _
                                             & "--      WHEN (OUTL.DEST_KB = '02' AND MDEDI.KYORI = 0 AND MSO.JIS_CD < EDIL.DEST_JIS_CD) THEN MKY4.KYORI                       " & vbNewLine _
                                             & "--      WHEN (OUTL.DEST_KB <> '02' AND MDOUT.KYORI > 0) THEN MDOUT.KYORI                                                       " & vbNewLine _
                                             & "--      WHEN (OUTL.DEST_KB <> '02' AND MDOUT.KYORI = 0 AND MDOUT.JIS < MSO.JIS_CD) THEN MKY1.KYORI                             " & vbNewLine _
                                             & "--      WHEN (OUTL.DEST_KB <> '02' AND MDOUT.KYORI = 0 AND MSO.JIS_CD < MDOUT.JIS) THEN MKY2.KYORI                             " & vbNewLine _
                                             & "--      ELSE 0                                                                                                                 " & vbNewLine _
                                             & "-- END                  AS KYORI                                                                                               " & vbNewLine _
                                             & ",CASE WHEN (OUTL.DEST_KB = '02' AND MDEDI.KYORI > 0) THEN MDEDI.KYORI                                                          " & vbNewLine _
                                             & "      WHEN (OUTL.DEST_KB = '02' AND MDEDI.KYORI = 0 AND EDIL.DEST_JIS_CD <= MSO.JIS_CD) THEN MKY3.KYORI                        " & vbNewLine _
                                             & "      WHEN (OUTL.DEST_KB = '02' AND MDEDI.KYORI = 0 AND MSO.JIS_CD <= EDIL.DEST_JIS_CD) THEN MKY4.KYORI                        " & vbNewLine _
                                             & "      WHEN (OUTL.DEST_KB <> '02' AND MDOUT.KYORI > 0) THEN MDOUT.KYORI                                                         " & vbNewLine _
                                             & "      WHEN (OUTL.DEST_KB <> '02' AND MDOUT.KYORI = 0 AND MDOUT.JIS <= MSO.JIS_CD) THEN MKY1.KYORI                              " & vbNewLine _
                                             & "      WHEN (OUTL.DEST_KB <> '02' AND MDOUT.KYORI = 0 AND MSO.JIS_CD <= MDOUT.JIS) THEN MKY2.KYORI                              " & vbNewLine _
                                             & "      ELSE 0                                                                                                                   " & vbNewLine _
                                             & " END                    AS KYORI                                                                                               " & vbNewLine _
                                             & "--(2012.08.06) 発JIS、着JISが共に同じJISでも、必ず0㎞になるのを修正  ---  END  ---                                             " & vbNewLine _
                                             & ",OUTL.OUTKA_PKG_NB      AS OUTKA_PKG_NB_L                                                                                      " & vbNewLine _
                                             & ",KBN2.KBN_NM1           AS SOKO_NM                                                                                             " & vbNewLine _
                                             & ",KBN3.KBN_NM1           AS BUSHO_NM                                                                                            " & vbNewLine _
                                             & ",KBN4.KBN_NM1           AS NRS_BR_NM_NICHI                                                                                     " & vbNewLine _
                                             & ",OUTS.ALCTD_CAN_QT      AS ALCTD_CAN_QT                                                                                        " & vbNewLine _
                                             & ",OUTM.ALCTD_KB          AS ALCTD_KB                                                                                            " & vbNewLine _
                                             & ",'0'                    AS PTN_FLAG                                                                                            " & vbNewLine _
                                             & ",OUTL.CUST_CD_L         AS CUST_CD_L                                                                                           " & vbNewLine _
                                             & ",OUTL.ORDER_TYPE        AS ORDER_TYPE                                                                                          " & vbNewLine _
                                             & "--(2012.10.19)要望番号1289 -- START --                                                                                         " & vbNewLine _
                                             & ",OUTL.SYS_UPD_PGID      AS SYS_UPD_PGID                                                                                        " & vbNewLine _
                                             & "--(2012.10.19)要望番号1289 --  END  --                                                                                         " & vbNewLine _
                                             & ",ZAI.LT_DATE                                                                                                                   " & vbNewLine _
                                             & ",OUTM.BUYER_ORD_NO_DTL AS BUYER_ORD_NO_DTL                                                                                     " & vbNewLine _
                                             & "--(2012.10.19)要望番号1289 -- START --                                                                                         " & vbNewLine _
                                             & ",ZAI.GOODS_COND_KB_1 AS GOODS_COND_CD_1                                                                                        " & vbNewLine _
                                             & "--(2012.10.19)要望番号1289 --  END  --                                                                                         " & vbNewLine _
                                             & ",ZAI.GOODS_COND_KB_2 AS GOODS_COND_CD                                                                                          " & vbNewLine _
                                             & "--(2012.10.19)要望番号1289 -- START --                                                                                         " & vbNewLine _
                                             & ",ZAI.GOODS_COND_KB_3 AS GOODS_COND_CD_3                                                                                        " & vbNewLine _
                                             & "--(2012.10.19)要望番号1289 --  END  --                                                                                         " & vbNewLine _
                                             & ",ZAI.REMARK AS REMARK_ZAI                                                                                                      " & vbNewLine _
                                             & ",KBN6.KBN_NM2 AS TITLE_SMPL                                                                                                    " & vbNewLine _
                                             & ",OUTS.ALCTD_CAN_NB AS ALCTD_CAN_NB                                                                                             " & vbNewLine _
                                             & ",OUTM.BACKLOG_QT                                                                                                               " & vbNewLine _
                                             & ",KBN7.KBN_NM2 AS DOKU_NM                                                                                                       " & vbNewLine _
                                             & "--【要望番号995】　2012/04/17　元着払い区分　START                                                                             " & vbNewLine _
                                             & " ,MCD.SET_NAIYO    AS MCD_SET_NAIYO                                                                                            " & vbNewLine _
                                             & " ,MCD.SET_NAIYO_2  AS MCD_SET_NAIYO_2                                                                                          " & vbNewLine _
                                             & " ,MCD.SET_NAIYO_3  AS MCD_SET_NAIYO_3                                                                                          " & vbNewLine _
                                             & ",KBN9.KBN_NM2 AS PC_KB_NM                                                                                                      " & vbNewLine _
                                             & "--【要望番号995】　2012/04/17　元着払い区分　 END                                                                              " & vbNewLine _
                                             & "--日医工対策開始                                                                                                               " & vbNewLine _
                                             & ",EDIL.FREE_C01           AS TORI_KB                                                                                            " & vbNewLine _
                                             & "--★追加開始2012/05/11                                                                                                         " & vbNewLine _
                                             & ",OUTL.SHIP_CD_L          AS SHIP_CD_L                                                                                          " & vbNewLine _
                                             & "--★追加終了2012/05/11                                                                                                         " & vbNewLine _
                                             & "--★削除開始2012/05/11                                                                                                         " & vbNewLine _
                                             & "--,EDIL.SHIP_NM_L          AS CHOKUSO_NM1                                                                                      " & vbNewLine _
                                             & "--,EDIL.FREE_C11           AS CHOKUSO_CD                                                                                       " & vbNewLine _
                                             & "--,EDIL.FREE_C08           AS HAKKO_DATE                                                                                       " & vbNewLine _
                                             & "--★削除終了2012/05/11                                                                                                         " & vbNewLine _
                                             & ",MCD_N.SET_NAIYO         AS SET_NAIYO_4                                                                                        " & vbNewLine _
                                             & ",MCD_N.SET_NAIYO_2       AS SET_NAIYO_5                                                                                        " & vbNewLine _
                                             & ",MCD_N.SET_NAIYO_3       AS SET_NAIYO_6                                                                                        " & vbNewLine _
                                             & ",MG.GOODS_NM_2           AS GOODS_NM_2                                                                                         " & vbNewLine _
                                             & ",EDIM.FREE_C02           AS KICHO_KB                                                                                           " & vbNewLine _
                                             & ",EDIM.FREE_C03           AS SEI_YURAI_KB                                                                                       " & vbNewLine _
                                             & ",EDIM.FREE_C04           AS REMARK_UPPER      --群馬篠崎運送利用                                                               " & vbNewLine _
                                             & ",EDIM.FREE_C05           AS REMARK_LOWER                                                                                       " & vbNewLine _
                                             & ",EDIM.FREE_C06           AS GOODS_SYUBETU     --群馬篠崎運送利用                                                               " & vbNewLine _
                                             & ",EDIM.FREE_C01           AS YUKOU_KIGEN                                                                                        " & vbNewLine _
                                             & ",MG.GOODS_NM_3           AS GOODS_NM_3         --2012/05/23                                                                    " & vbNewLine _
                                             & ",MDOUTU.EDI_CD           AS EDISHIP_CD         --2012/05/23                                                                    " & vbNewLine _
                                             & ",MDOUT.EDI_CD            AS EDIDEST_CD         --2012/05/23                                                                    " & vbNewLine _
                                             & "--日医工対策終了                                                                                                               " & vbNewLine _
                                             & "--(2012.06.01) 日本ﾌｧｲﾝ対応  --- START ---                                                                                     " & vbNewLine _
                                             & ",MCD_F.SET_NAIYO         AS SET_NAIYO_FROM1                                                                                    " & vbNewLine _
                                             & ",MCD_F.SET_NAIYO_2       AS SET_NAIYO_FROM2                                                                                    " & vbNewLine _
                                             & ",MCD_F.SET_NAIYO_3       AS SET_NAIYO_FROM3                                                                                    " & vbNewLine _
                                             & "--(2012.06.01) 日本ﾌｧｲﾝ対応  --- START ---                                                                                     " & vbNewLine _
                                             & "--【要望番号1122】埼玉対応 --- START ---                                                                                       " & vbNewLine _
                                             & ",MC.AD_3                 AS CUST_AD_3                                                                                          " & vbNewLine _
                                             & ",MDOUT.REMARK            AS DEST_REMARK                                                                                        " & vbNewLine _
                                             & ",MDOUT.SALES_CD          AS DEST_SALES_CD                                                                                      " & vbNewLine _
                                             & ",MC_SALES.CUST_NM_L      AS DEST_SALES_NM                                                                                      " & vbNewLine _
                                             & ",MC_SALES.AD_1           AS DEST_SALES_AD_1                                                                                    " & vbNewLine _
                                             & ",MC_SALES.AD_2           AS DEST_SALES_AD_2                                                                                    " & vbNewLine _
                                             & ",MC_SALES.AD_3           AS DEST_SALES_AD_3                                                                                    " & vbNewLine _
                                             & ",MC_SALES.TEL            AS DEST_SALES_TEL                                                                                     " & vbNewLine _
                                             & "--【要望番号1122】埼玉対応 ---  END  ---                                                                                       " & vbNewLine _
                                             & "--群馬(合算)端数行分割版向け対応(作業略称) 開始20120731                                                                        " & vbNewLine _
                                             & "--1ここから                                                                                                                    " & vbNewLine _
                                             & ",ISNULL((SELECT BASE.SAGYO_RYAK                                                                                                " & vbNewLine _
                                             & "FROM                                                                                                                           " & vbNewLine _
                                             & "(SELECT                                                                                                                        " & vbNewLine _
                                             & "M_SAGYO.SAGYO_RYAK AS SAGYO_RYAK                                                                                               " & vbNewLine _
                                             & ",ROW_NUMBER() OVER (PARTITION BY INOUTKA_NO_LM ORDER BY INOUTKA_NO_LM) AS NUM                                                  " & vbNewLine _
                                             & "FROM $LM_TRN$..E_SAGYO E                                                                                                       " & vbNewLine _
                                             & "       JOIN $LM_MST$..M_SAGYO M_SAGYO                                                                                          " & vbNewLine _
                                             & "         ON M_SAGYO.NRS_BR_CD = E.NRS_BR_CD                                                                                    " & vbNewLine _
                                             & "        AND M_SAGYO.SAGYO_CD  = E.SAGYO_CD                                                                                     " & vbNewLine _
                                             & "WHERE E.NRS_BR_CD = OUTL.NRS_BR_CD AND E.INOUTKA_NO_LM = (OUTM.OUTKA_NO_L + OUTM.OUTKA_NO_M) AND E.IOZS_KB = '21'              " & vbNewLine _
                                             & ") AS BASE                                                                                                                      " & vbNewLine _
                                             & "WHERE BASE.NUM = 1),'') AS SAGYO_RYAK_1                                                                                        " & vbNewLine _
                                             & "--1ここまで                                                                                                                    " & vbNewLine _
                                             & "--2ここから                                                                                                                    " & vbNewLine _
                                             & ",ISNULL((SELECT BASE.SAGYO_RYAK                                                                                                " & vbNewLine _
                                             & "FROM                                                                                                                           " & vbNewLine _
                                             & "(SELECT                                                                                                                        " & vbNewLine _
                                             & "M_SAGYO.SAGYO_RYAK AS SAGYO_RYAK                                                                                               " & vbNewLine _
                                             & ",ROW_NUMBER() OVER (PARTITION BY INOUTKA_NO_LM ORDER BY INOUTKA_NO_LM) AS NUM                                                  " & vbNewLine _
                                             & "FROM $LM_TRN$..E_SAGYO E                                                                                                       " & vbNewLine _
                                             & "       JOIN $LM_MST$..M_SAGYO M_SAGYO                                                                                          " & vbNewLine _
                                             & "         ON M_SAGYO.NRS_BR_CD = E.NRS_BR_CD                                                                                    " & vbNewLine _
                                             & "        AND M_SAGYO.SAGYO_CD  = E.SAGYO_CD                                                                                     " & vbNewLine _
                                             & "WHERE E.NRS_BR_CD = OUTL.NRS_BR_CD AND E.INOUTKA_NO_LM = (OUTM.OUTKA_NO_L + OUTM.OUTKA_NO_M) AND E.IOZS_KB = '21'              " & vbNewLine _
                                             & ") AS BASE                                                                                                                      " & vbNewLine _
                                             & "WHERE BASE.NUM = 2),'') AS SAGYO_RYAK_2                                                                                        " & vbNewLine _
                                             & "--2ここまで                                                                                                                    " & vbNewLine _
                                             & "--3ここから                                                                                                                    " & vbNewLine _
                                             & ",ISNULL((SELECT BASE.SAGYO_RYAK                                                                                                " & vbNewLine _
                                             & "FROM                                                                                                                           " & vbNewLine _
                                             & "(SELECT                                                                                                                        " & vbNewLine _
                                             & "M_SAGYO.SAGYO_RYAK AS SAGYO_RYAK                                                                                               " & vbNewLine _
                                             & ",ROW_NUMBER() OVER (PARTITION BY INOUTKA_NO_LM ORDER BY INOUTKA_NO_LM) AS NUM                                                  " & vbNewLine _
                                             & "FROM $LM_TRN$..E_SAGYO E                                                                                                       " & vbNewLine _
                                             & "       JOIN $LM_MST$..M_SAGYO M_SAGYO                                                                                          " & vbNewLine _
                                             & "         ON M_SAGYO.NRS_BR_CD = E.NRS_BR_CD                                                                                    " & vbNewLine _
                                             & "        AND M_SAGYO.SAGYO_CD  = E.SAGYO_CD                                                                                     " & vbNewLine _
                                             & "WHERE E.NRS_BR_CD = OUTL.NRS_BR_CD AND E.INOUTKA_NO_LM = (OUTM.OUTKA_NO_L + OUTM.OUTKA_NO_M) AND E.IOZS_KB = '21'              " & vbNewLine _
                                             & ") AS BASE                                                                                                                      " & vbNewLine _
                                             & "WHERE BASE.NUM = 3),'') AS SAGYO_RYAK_3                                                                                        " & vbNewLine _
                                             & "--3ここまで                                                                                                                    " & vbNewLine _
                                             & "--4ここから                                                                                                                    " & vbNewLine _
                                             & ",ISNULL((SELECT BASE.SAGYO_RYAK                                                                                                " & vbNewLine _
                                             & "FROM                                                                                                                           " & vbNewLine _
                                             & "(SELECT                                                                                                                        " & vbNewLine _
                                             & "M_SAGYO.SAGYO_RYAK AS SAGYO_RYAK                                                                                               " & vbNewLine _
                                             & ",ROW_NUMBER() OVER (PARTITION BY INOUTKA_NO_LM ORDER BY INOUTKA_NO_LM) AS NUM                                                  " & vbNewLine _
                                             & "FROM $LM_TRN$..E_SAGYO E                                                                                                       " & vbNewLine _
                                             & "       JOIN $LM_MST$..M_SAGYO M_SAGYO                                                                                          " & vbNewLine _
                                             & "         ON M_SAGYO.NRS_BR_CD = E.NRS_BR_CD                                                                                    " & vbNewLine _
                                             & "        AND M_SAGYO.SAGYO_CD  = E.SAGYO_CD                                                                                     " & vbNewLine _
                                             & "WHERE E.NRS_BR_CD = OUTL.NRS_BR_CD AND E.INOUTKA_NO_LM = (OUTM.OUTKA_NO_L + OUTM.OUTKA_NO_M) AND E.IOZS_KB = '21'              " & vbNewLine _
                                             & ") AS BASE                                                                                                                      " & vbNewLine _
                                             & "WHERE BASE.NUM = 4),'') AS SAGYO_RYAK_4                                                                                        " & vbNewLine _
                                             & "--4ここまで                                                                                                                    " & vbNewLine _
                                             & "--5ここから                                                                                                                    " & vbNewLine _
                                             & ",ISNULL((SELECT BASE.SAGYO_RYAK                                                                                                " & vbNewLine _
                                             & "FROM                                                                                                                           " & vbNewLine _
                                             & "(SELECT                                                                                                                        " & vbNewLine _
                                             & "M_SAGYO.SAGYO_RYAK AS SAGYO_RYAK                                                                                               " & vbNewLine _
                                             & ",ROW_NUMBER() OVER (PARTITION BY INOUTKA_NO_LM ORDER BY INOUTKA_NO_LM) AS NUM                                                  " & vbNewLine _
                                             & "FROM $LM_TRN$..E_SAGYO E                                                                                                       " & vbNewLine _
                                             & "       JOIN $LM_MST$..M_SAGYO M_SAGYO                                                                                          " & vbNewLine _
                                             & "         ON M_SAGYO.NRS_BR_CD = E.NRS_BR_CD                                                                                    " & vbNewLine _
                                             & "        AND M_SAGYO.SAGYO_CD  = E.SAGYO_CD                                                                                     " & vbNewLine _
                                             & "WHERE E.NRS_BR_CD = OUTL.NRS_BR_CD AND E.INOUTKA_NO_LM = (OUTM.OUTKA_NO_L + OUTM.OUTKA_NO_M) AND E.IOZS_KB = '21'              " & vbNewLine _
                                             & ") AS BASE                                                                                                                      " & vbNewLine _
                                             & "WHERE BASE.NUM = 5),'') AS SAGYO_RYAK_5                                                                                        " & vbNewLine _
                                             & "--5ここまで                                                                                                                    " & vbNewLine _
                                             & "--届け先1ここから                                                                                                              " & vbNewLine _
                                             & ",ISNULL((SELECT BASE.SAGYO_RYAK                                                                                                " & vbNewLine _
                                             & "FROM                                                                                                                           " & vbNewLine _
                                             & "(SELECT                                                                                                                        " & vbNewLine _
                                             & "M_SAGYO.SAGYO_RYAK AS SAGYO_RYAK                                                                                               " & vbNewLine _
                                             & ",ROW_NUMBER() OVER (PARTITION BY INOUTKA_NO_LM ORDER BY INOUTKA_NO_LM) AS NUM                                                  " & vbNewLine _
                                             & "FROM $LM_TRN$..E_SAGYO E                                                                                                       " & vbNewLine _
                                             & "       JOIN $LM_MST$..M_SAGYO M_SAGYO                                                                                          " & vbNewLine _
                                             & "         ON M_SAGYO.NRS_BR_CD = E.NRS_BR_CD                                                                                    " & vbNewLine _
                                             & "        AND M_SAGYO.SAGYO_CD  = E.SAGYO_CD                                                                                     " & vbNewLine _
                                             & "WHERE E.NRS_BR_CD = OUTL.NRS_BR_CD AND E.INOUTKA_NO_LM = (OUTM.OUTKA_NO_L + OUTM.OUTKA_NO_M) AND E.IOZS_KB = '21'              " & vbNewLine _
                                             & ") AS BASE                                                                                                                      " & vbNewLine _
                                             & "WHERE BASE.NUM = 6),'') AS DEST_SAGYO_RYAK_1                                                                                   " & vbNewLine _
                                             & "--届け先1ここまで                                                                                                              " & vbNewLine _
                                             & "--届け先2ここから                                                                                                              " & vbNewLine _
                                             & ",ISNULL((SELECT BASE.SAGYO_RYAK                                                                                                " & vbNewLine _
                                             & "FROM                                                                                                                           " & vbNewLine _
                                             & "(SELECT                                                                                                                        " & vbNewLine _
                                             & "M_SAGYO.SAGYO_RYAK AS SAGYO_RYAK                                                                                               " & vbNewLine _
                                             & ",ROW_NUMBER() OVER (PARTITION BY INOUTKA_NO_LM ORDER BY INOUTKA_NO_LM) AS NUM                                                  " & vbNewLine _
                                             & "FROM $LM_TRN$..E_SAGYO E                                                                                                       " & vbNewLine _
                                             & "       JOIN $LM_MST$..M_SAGYO M_SAGYO                                                                                          " & vbNewLine _
                                             & "         ON M_SAGYO.NRS_BR_CD = E.NRS_BR_CD                                                                                    " & vbNewLine _
                                             & "        AND M_SAGYO.SAGYO_CD  = E.SAGYO_CD                                                                                     " & vbNewLine _
                                             & "WHERE E.NRS_BR_CD = OUTL.NRS_BR_CD AND E.INOUTKA_NO_LM = (OUTM.OUTKA_NO_L + OUTM.OUTKA_NO_M) AND E.IOZS_KB = '21'              " & vbNewLine _
                                             & ") AS BASE                                                                                                                      " & vbNewLine _
                                             & "WHERE BASE.NUM = 7),'') AS DEST_SAGYO_RYAK_2                                                                                   " & vbNewLine _
                                             & "--届け先ここまで                                                                                                               " & vbNewLine _
                                             & "--群馬(合算)端数行分割版向け対応(作業略称) 終了20120731                                                                        " & vbNewLine _
                                             & "--群馬篠崎運送向け自由項目対応　開始　                                                                                         " & vbNewLine _
                                             & ",EDIM.FREE_C07           AS SZ01_YUSO --篠崎                                                                                   " & vbNewLine _
                                             & ",EDIM.FREE_C09           AS SZ01_UNSO --篠崎                                                                                   " & vbNewLine _
                                             & "--群馬篠崎運送向け自由項目対応　終了                                                                                         　" & vbNewLine _
                                             & "--(2012.10.19)要望番号1289 -- START --                                                                                         " & vbNewLine _
                                             & "      ,MGD.SET_NAIYO                      AS  SET_NAIYO                                                                        " & vbNewLine _
                                             & "--(2012.10.19)要望番号1289 --  END  --                                                                                         " & vbNewLine _
                                             & ",KBN10.KBN_NM1            AS SHOBO_KBN_NM                                                                                      " & vbNewLine _
                                             & ",MSHOBO.HINMEI            AS HINMEI                                                                                            " & vbNewLine _
                                             & "--(2012.11.28) LMC637対応 -- START --                                                                                          " & vbNewLine _
                                             & ",MG.CUST_CD_M             AS CUST_CD_M                                                                                         " & vbNewLine _
                                             & ",MG.CUST_CD_S             AS CUST_CD_S                                                                                         " & vbNewLine _
                                             & ",MG.CUST_COST_CD2         AS CUST_COST_CD2                                                                                     " & vbNewLine _
                                             & "--(2012.11.28) LMC637対応 --  END  --                                                                                          " & vbNewLine _
                                             & "--(2012.12.17) LMC731対応 -- START --                                                                                          " & vbNewLine _
                                             & ",MG.SEARCH_KEY_2          AS SEARCH_KEY_2                                                                                      " & vbNewLine _
                                             & "--(2012.12.17) LMC731対応 --  END  --                                                                                          " & vbNewLine _
                                             & "--出荷L                                                                                                                        " & vbNewLine _
                                             & "FROM                                                                                                                           " & vbNewLine _
                                             & "$LM_TRN$..C_OUTKA_L OUTL                                                                                                       " & vbNewLine _
                                             & "--トランザクションテーブル                                                                                                     " & vbNewLine _
                                             & "--出荷M                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..C_OUTKA_M OUTM                                                                                             " & vbNewLine _
                                             & "ON  OUTM.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "AND OUTM.OUTKA_NO_L = OUTL.OUTKA_NO_L                                                                                          " & vbNewLine _
                                             & "AND OUTM.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--★★★追加開始--------------------------------                                                                               " & vbNewLine _
                                             & "--出荷M(中MIN)                                                                                                                 " & vbNewLine _
                                             & "LEFT OUTER JOIN                                                                                                                " & vbNewLine _
                                             & "       (SELECT                                                                                                                 " & vbNewLine _
                                             & "           NRS_BR_CD                                                                                                           " & vbNewLine _
                                             & "           ,OUTKA_NO_L                                                                                                         " & vbNewLine _
                                             & "           ,MIN(OUTKA_NO_M) AS  OUTKA_NO_M                                                                                     " & vbNewLine _
                                             & "       FROM $LM_TRN$..C_OUTKA_M WHERE SYS_DEL_FLG ='0'                                                                         " & vbNewLine _
                                             & "        AND NRS_BR_CD = @NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "        AND OUTKA_NO_L = @KANRI_NO_L                                                                                           " & vbNewLine _
                                             & "       GROUP BY NRS_BR_CD,OUTKA_NO_L) OUTM_MIN                                                                                 " & vbNewLine _
                                             & "       ON OUTM_MIN.NRS_BR_CD        = OUTL.NRS_BR_CD                                                                           " & vbNewLine _
                                             & "       AND OUTM_MIN.OUTKA_NO_L      = OUTL.OUTKA_NO_L                                                                          " & vbNewLine _
                                             & "--出荷M(中MIN)                                                                                                                 " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..C_OUTKA_M OUTM2                                                                                            " & vbNewLine _
                                             & "ON  OUTM2.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                           " & vbNewLine _
                                             & "AND OUTM2.OUTKA_NO_L = OUTL.OUTKA_NO_L                                                                                         " & vbNewLine _
                                             & "AND OUTM2.OUTKA_NO_M = OUTM_MIN.OUTKA_NO_M                                                                                     " & vbNewLine _
                                             & "AND OUTM2.SYS_DEL_FLG = '0'                                                                                                    " & vbNewLine _
                                             & "--★★★追加終了--------------------------------                                                                               " & vbNewLine _
                                             & "--出荷S                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..C_OUTKA_S OUTS                                                                                             " & vbNewLine _
                                             & "ON  OUTS.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "AND OUTS.OUTKA_NO_L = OUTL.OUTKA_NO_L                                                                                          " & vbNewLine _
                                             & "AND OUTS.OUTKA_NO_M = OUTM.OUTKA_NO_M                                                                                          " & vbNewLine _
                                             & "AND OUTS.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--出荷EDIL                                                                                                                     " & vbNewLine _
                                             & "--(2012.09.06)要望番号1412対応  --- START ---                                                                                  " & vbNewLine _
                                             & "--LEFT JOIN                                                                                                                    " & vbNewLine _
                                             & "--(                                                                                                                            " & vbNewLine _
                                             & "--SELECT                                                                                                                       " & vbNewLine _
                                             & "-- --20120730 MIN化　開始(20120803取りやめ)                                                                                    " & vbNewLine _
                                             & "-- --MIN(NRS_BR_CD)    AS NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "-- --,MIN(OUTKA_CTL_NO) AS OUTKA_CTL_NO                                                                                        " & vbNewLine _
                                             & "-- --,MIN(CUST_CD_L)    AS CUST_CD_L                                                                                           " & vbNewLine _
                                             & "-- NRS_BR_CD                                                                                                                   " & vbNewLine _
                                             & "--,OUTKA_CTL_NO                                                                                                                " & vbNewLine _
                                             & "--,CUST_CD_L                                                                                                                   " & vbNewLine _
                                             & "-- --20120730 MIN化　終了                                                                                                      " & vbNewLine _
                                             & "----★削除開始2012/05/11                                                                                                       " & vbNewLine _
                                             & "----,SHIP_NM_L                                                                                                                 " & vbNewLine _
                                             & "----★削除終了2012/05/11                                                                                                       " & vbNewLine _
                                             & "--,MIN(DEST_CD)     AS DEST_CD                                                                                                 " & vbNewLine _
                                             & "--,MIN(DEST_NM)     AS DEST_NM                                                                                                 " & vbNewLine _
                                             & "--,MIN(DEST_AD_1)   AS DEST_AD_1                                                                                               " & vbNewLine _
                                             & "--,MIN(DEST_AD_2)   AS DEST_AD_2                                                                                               " & vbNewLine _
                                             & "----(2012.04.11)【Notes】№923  DEST_JIS_CDはMINで抽出 -- START --                                                             " & vbNewLine _
                                             & "----,DEST_JIS_CD                                                                                                               " & vbNewLine _
                                             & "--,MIN(DEST_JIS_CD) AS DEST_JIS_CD                                                                                             " & vbNewLine _
                                             & "----(2012.04.11)【Notes】№923  DEST_JIS_CDはMINで抽出 --  END  --                                                             " & vbNewLine _
                                             & "-- --20120730 MIN化　開始                                                                                                      " & vbNewLine _
                                             & "--,MIN(FREE_C01)   AS FREE_C01                                                                                                 " & vbNewLine _
                                             & "--,MIN(FREE_C08)   AS FREE_C08                                                                                                 " & vbNewLine _
                                             & "--,MIN(FREE_C11)   AS FREE_C11                                                                                                 " & vbNewLine _
                                             & "-- --20120730 MIN化　終了                                                                                                      " & vbNewLine _
                                             & "--,SYS_DEL_FLG                                                                                                                 " & vbNewLine _
                                             & "--FROM                                                                                                                         " & vbNewLine _
                                             & "--$LM_TRN$..H_OUTKAEDI_L                                                                                                       " & vbNewLine _
                                             & "--GROUP BY                                                                                                                     " & vbNewLine _
                                             & "-- --20120730 MIN化によるコメントアウト　開始 (20120803取りやめ)                                                               " & vbNewLine _
                                             & "-- NRS_BR_CD                                                                                                                   " & vbNewLine _
                                             & "--,OUTKA_CTL_NO                                                                                                                " & vbNewLine _
                                             & "--,CUST_CD_L                                                                                                                   " & vbNewLine _
                                             & "-- --20120730 MIN化によるコメントアウト　終了                                                                                  " & vbNewLine _
                                             & "----★削除開始2012/05/11                                                                                                       " & vbNewLine _
                                             & "----,SHIP_NM_L                                                                                                                 " & vbNewLine _
                                             & "----★削除開始2012/05/11                                                                                                       " & vbNewLine _
                                             & "----(2012.04.11) Notes№923  DEST_JIS_CDはMINで抽出のためコメント -- START --                                                  " & vbNewLine _
                                             & "----,DEST_JIS_CD                                                                                                               " & vbNewLine _
                                             & "----(2012.04.11) Notes№923  DEST_JIS_CDはMINで抽出のためコメント --  END  --                                                  " & vbNewLine _
                                             & "-- --20120730 MIN化によるコメントアウト　開始                                                                                  " & vbNewLine _
                                             & "----,FREE_C01                                                                                                                  " & vbNewLine _
                                             & "----,FREE_C08                                                                                                                  " & vbNewLine _
                                             & "----,FREE_C11                                                                                                                  " & vbNewLine _
                                             & "-- --20120730 MIN化によるコメントアウト　終了 ↓SYS_DEL_FLGのカンマ除去↓                                                      " & vbNewLine _
                                             & "--,SYS_DEL_FLG                                                                                                                 " & vbNewLine _
                                             & "--) EDIL                                                                                                                       " & vbNewLine _
                                             & "--ON  EDIL.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                          " & vbNewLine _
                                             & "--下記の内容に変更                                                                                                             " & vbNewLine _
                                             & " LEFT JOIN (                                                                                                                   " & vbNewLine _
                                             & "            SELECT                                                                                                             " & vbNewLine _
                                             & "                   NRS_BR_CD                                                                                                   " & vbNewLine _
                                             & "                 , EDI_CTL_NO                                                                                                  " & vbNewLine _
                                             & "                 , OUTKA_CTL_NO                                                                                                " & vbNewLine _
                                             & "             FROM (                                                                                                            " & vbNewLine _
                                             & "                    SELECT                                                                                                     " & vbNewLine _
                                             & "                           EDIOUTL.NRS_BR_CD                                                                                   " & vbNewLine _
                                             & "                         , EDIOUTL.EDI_CTL_NO                                                                                  " & vbNewLine _
                                             & "                         , EDIOUTL.OUTKA_CTL_NO                                                                                " & vbNewLine _
                                             & "                         , CASE WHEN EDIOUTL.OUTKA_CTL_NO = '' THEN 1                                                          " & vbNewLine _
                                             & "                           ELSE ROW_NUMBER() OVER (PARTITION BY EDIOUTL.NRS_BR_CD                                              " & vbNewLine _
                                             & "                                                              , EDIOUTL.OUTKA_CTL_NO                                           " & vbNewLine _
                                             & "                                                       ORDER BY EDIOUTL.NRS_BR_CD                                              " & vbNewLine _
                                             & "                                                              , EDIOUTL.EDI_CTL_NO                                             " & vbNewLine _
                                             & "                                                  )                                                                            " & vbNewLine _
                                             & "                           END AS IDX                                                                                          " & vbNewLine _
                                             & "                     FROM $LM_TRN$..H_OUTKAEDI_L EDIOUTL                                                                       " & vbNewLine _
                                             & "                    WHERE EDIOUTL.SYS_DEL_FLG  = '0'                                                                           " & vbNewLine _
                                             & "                      AND EDIOUTL.NRS_BR_CD    = @NRS_BR_CD                                                                    " & vbNewLine _
                                             & "                      AND EDIOUTL.OUTKA_CTL_NO = @KANRI_NO_L                                                                   " & vbNewLine _
                                             & "                  ) EBASE                                                                                                      " & vbNewLine _
                                             & "            WHERE EBASE.IDX = 1                                                                                                " & vbNewLine _
                                             & "            ) TOPEDI                                                                                                           " & vbNewLine _
                                             & "        ON TOPEDI.NRS_BR_CD    = OUTL.NRS_BR_CD                                                                                " & vbNewLine _
                                             & "       AND TOPEDI.OUTKA_CTL_NO = OUTL.OUTKA_NO_L                                                                               " & vbNewLine _
                                             & " LEFT JOIN $LM_TRN$..H_OUTKAEDI_L EDIL                                                                                         " & vbNewLine _
                                             & "        ON EDIL.NRS_BR_CD  = TOPEDI.NRS_BR_CD                                                                                  " & vbNewLine _
                                             & "       AND EDIL.EDI_CTL_NO = TOPEDI.EDI_CTL_NO                                                                                 " & vbNewLine _
                                             & "--(2012.09.06)要望番号1412対応  ---  END  ---                                                                                  " & vbNewLine _
                                             & "--入荷L                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..B_INKA_L INL                                                                                               " & vbNewLine _
                                             & "ON  INL.NRS_BR_CD = OUTS.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "AND INL.INKA_NO_L = OUTS.INKA_NO_L                                                                                             " & vbNewLine _
                                             & "AND INL.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--入荷S                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..B_INKA_S INS                                                                                               " & vbNewLine _
                                             & "ON  INS.NRS_BR_CD = OUTS.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "AND INS.INKA_NO_L = OUTS.INKA_NO_L                                                                                             " & vbNewLine _
                                             & "AND INS.INKA_NO_M = OUTS.INKA_NO_M                                                                                             " & vbNewLine _
                                             & "AND INS.INKA_NO_S = OUTS.INKA_NO_S                                                                                             " & vbNewLine _
                                             & "AND INS.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--運送L                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..F_UNSO_L UL                                                                                                " & vbNewLine _
                                             & "ON  UL.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                              " & vbNewLine _
                                             & "AND UL.INOUTKA_NO_L = OUTL.OUTKA_NO_L                                                                                          " & vbNewLine _
                                             & "AND UL.MOTO_DATA_KB = '20'                                                                                                     " & vbNewLine _
                                             & "AND UL.SYS_DEL_FLG = '0'                                                                                                       " & vbNewLine _
                                             & "--在庫テーブル                                                                                                                 " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..D_ZAI_TRS ZAI                                                                                              " & vbNewLine _
                                             & "ON  ZAI.NRS_BR_CD = OUTS.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "AND ZAI.ZAI_REC_NO = OUTS.ZAI_REC_NO                                                                                           " & vbNewLine _
                                             & "AND ZAI.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--マスタテーブル                                                                                                               " & vbNewLine _
                                             & "--営業所M                                                                                                                      " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_NRS_BR MNRS                                                                                              " & vbNewLine _
                                             & "ON MNRS.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "--商品M                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_GOODS MG                                                                                                 " & vbNewLine _
                                             & "ON  MG.NRS_BR_CD = OUTM.NRS_BR_CD                                                                                              " & vbNewLine _
                                             & "AND MG.GOODS_CD_NRS = OUTM.GOODS_CD_NRS                                                                                        " & vbNewLine _
                                             & "--★★★追加開始--------------------------------                                                                                     " & vbNewLine _
                                             & "--商品M(MIN)                                                                                                                   " & vbNewLine _
                                             & "LEFT OUTER JOIN $LM_MST$..M_GOODS M_GOODS_MIN                                                                                  " & vbNewLine _
                                             & "ON M_GOODS_MIN.NRS_BR_CD      = OUTL.NRS_BR_CD                                                                                 " & vbNewLine _
                                             & "AND M_GOODS_MIN.GOODS_CD_NRS   = OUTM2.GOODS_CD_NRS                                                                            " & vbNewLine _
                                             & "--★★★追加終了--------------------------------                                                                                     " & vbNewLine _
                                             & "--荷主M(商品M経由)                                                                                                             " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST MC                                                                                                  " & vbNewLine _
                                             & "ON  MC.NRS_BR_CD = MG.NRS_BR_CD                                                                                                " & vbNewLine _
                                             & "AND MC.CUST_CD_L = MG.CUST_CD_L                                                                                                " & vbNewLine _
                                             & "AND MC.CUST_CD_M = MG.CUST_CD_M                                                                                                " & vbNewLine _
                                             & "AND MC.CUST_CD_S = MG.CUST_CD_S                                                                                                " & vbNewLine _
                                             & "AND MC.CUST_CD_SS = MG.CUST_CD_SS                                                                                              " & vbNewLine _
                                             & "--★★★追加開始--------------------------------                                                                               " & vbNewLine _
                                             & "--荷主M(商品M経由) 最小の出荷(中)で抽出                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST MC2                                                                                                 " & vbNewLine _
                                             & "ON  MC2.NRS_BR_CD = M_GOODS_MIN.NRS_BR_CD                                                                                      " & vbNewLine _
                                             & "AND MC2.CUST_CD_L = M_GOODS_MIN.CUST_CD_L                                                                                      " & vbNewLine _
                                             & "AND MC2.CUST_CD_M = M_GOODS_MIN.CUST_CD_M                                                                                      " & vbNewLine _
                                             & "AND MC2.CUST_CD_S = M_GOODS_MIN.CUST_CD_S                                                                                      " & vbNewLine _
                                             & "AND MC2.CUST_CD_SS = M_GOODS_MIN.CUST_CD_SS                                                                                    " & vbNewLine _
                                             & "AND MC2.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--★★★追加終了--------------------------------                                                                               " & vbNewLine _
                                             & "--届先M(届先取得)(出荷L参照)                                                                                                   " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_DEST MDOUT                                                                                               " & vbNewLine _
                                             & "ON  MDOUT.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                           " & vbNewLine _
                                             & "AND MDOUT.CUST_CD_L = OUTL.CUST_CD_L                                                                                           " & vbNewLine _
                                             & "AND MDOUT.DEST_CD = OUTL.DEST_CD                                                                                               " & vbNewLine _
                                             & "--届先M(売上先取得)(出荷L参照)                                                                                                 " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_DEST MDOUTU                                                                                              " & vbNewLine _
                                             & "ON  MDOUTU.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                          " & vbNewLine _
                                             & "AND MDOUTU.CUST_CD_L = OUTL.CUST_CD_L                                                                                          " & vbNewLine _
                                             & "AND MDOUTU.DEST_CD = OUTL.SHIP_CD_L                                                                                            " & vbNewLine _
                                             & "--届先M(届先取得)(出荷EDIL参照)                                                                                                " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_DEST MDEDI                                                                                               " & vbNewLine _
                                             & "ON  MDEDI.NRS_BR_CD = EDIL.NRS_BR_CD                                                                                           " & vbNewLine _
                                             & "AND MDEDI.CUST_CD_L = EDIL.CUST_CD_L                                                                                           " & vbNewLine _
                                             & "AND MDEDI.DEST_CD = EDIL.DEST_CD                                                                                               " & vbNewLine _
                                             & "--【要望番号1122】埼玉対応 --- START ---                                                                                       " & vbNewLine _
                                             & "--届先M(納品書荷主名義名取得)(届先M参照)                                                                                       " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST MC_SALES                                                                                            " & vbNewLine _
                                             & "       ON MC_SALES.NRS_BR_CD  = MDOUT.NRS_BR_CD                                                                                " & vbNewLine _
                                             & "      AND MC_SALES.CUST_CD_L  = MDOUT.SALES_CD                                                                                 " & vbNewLine _
                                             & "      AND MC_SALES.CUST_CD_M  = '00'                                                                                           " & vbNewLine _
                                             & "      AND MC_SALES.CUST_CD_S  = '00'                                                                                           " & vbNewLine _
                                             & "      AND MC_SALES.CUST_CD_SS = '00'                                                                                           " & vbNewLine _
                                             & "--【要望番号1122】埼玉対応 ---  END  ---                                                                                       " & vbNewLine _
                                             & "--運送会社M                                                                                                                    " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_UNSOCO MUCO                                                                                              " & vbNewLine _
                                             & "ON  MUCO.NRS_BR_CD = UL.NRS_BR_CD                                                                                              " & vbNewLine _
                                             & "AND MUCO.UNSOCO_CD = UL.UNSO_CD                                                                                                " & vbNewLine _
                                             & "AND MUCO.UNSOCO_BR_CD = UL.UNSO_BR_CD                                                                                          " & vbNewLine _
                                             & "--倉庫M                                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_SOKO MSO                                                                                                 " & vbNewLine _
                                             & "ON  MSO.NRS_BR_CD = OUTL.NRS_BR_CD  --追加                                                                                     " & vbNewLine _
                                             & "AND MSO.WH_CD     = OUTL.WH_CD                                                                                                 " & vbNewLine _
                                             & "--2014/5/16Start s.kobayashi NotesNo.2183                                                                                      " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN11                                                                                                " & vbNewLine _
                                             & "ON  KBN11.KBN_GROUP_CD = 'U028'  --追加                                                                                        " & vbNewLine _
                                             & "AND UL.SEIQ_TARIFF_CD = KBN11.KBN_NM1                                                                                          " & vbNewLine _
                                             & "--2014/5/16End s.kobayashi NotesNo.2183                                                                                       " & vbNewLine _
                                             & "--距離程M(M_DEST.JIS < M_SOKO.JIS_CD)(出荷L参照)                                                                               " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_KYORI MKY1                                                                                               " & vbNewLine _
                                             & "ON  MKY1.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "--AND MKY1.KYORI_CD = MC.BETU_KYORI_CD                                                                                           " & vbNewLine _
                                             & "AND MKY1.KYORI_CD = (CASE ISNULL(KBN11.KBN_NM2,'') WHEN '' THEN MC.BETU_KYORI_CD ELSE KBN11.KBN_NM2 END)                       " & vbNewLine _
                                             & "AND MKY1.ORIG_JIS_CD = MDOUT.JIS                                                                                               " & vbNewLine _
                                             & "AND MKY1.DEST_JIS_CD = MSO.JIS_CD                                                                                              " & vbNewLine _
                                             & "--距離程M(M_SOKO.JIS_CD < M_DEST.JIS)(出荷L参照)                                                                               " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_KYORI MKY2                                                                                               " & vbNewLine _
                                             & "ON  MKY2.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "--AND MKY2.KYORI_CD = MC.BETU_KYORI_CD                                                                                           " & vbNewLine _
                                             & "AND MKY2.KYORI_CD = (CASE ISNULL(KBN11.KBN_NM2,'') WHEN '' THEN MC.BETU_KYORI_CD ELSE KBN11.KBN_NM2 END)                       " & vbNewLine _
                                             & "AND MKY2.ORIG_JIS_CD = MSO.JIS_CD                                                                                              " & vbNewLine _
                                             & "AND MKY2.DEST_JIS_CD = MDOUT.JIS                                                                                               " & vbNewLine _
                                             & "--距離程M(H_OUTKAEDI_L.DEST_JIS_CD < M_SOKO.JIS_CD)(出荷EDIL参照)                                                              " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_KYORI MKY3                                                                                               " & vbNewLine _
                                             & "ON  MKY3.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "--AND MKY3.KYORI_CD = MC.BETU_KYORI_CD                                                                                           " & vbNewLine _
                                             & "AND MKY3.KYORI_CD = (CASE ISNULL(KBN11.KBN_NM2,'') WHEN '' THEN MC.BETU_KYORI_CD ELSE KBN11.KBN_NM2 END)                       " & vbNewLine _
                                             & "AND MKY3.ORIG_JIS_CD = EDIL.DEST_JIS_CD                                                                                        " & vbNewLine _
                                             & "AND MKY3.DEST_JIS_CD = MSO.JIS_CD                                                                                              " & vbNewLine _
                                             & "--距離程M(M_SOKO.JIS_CD < H_OUTKAEDI_L.DEST_JIS_CD)(出荷EDIL参照)                                                              " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_KYORI MKY4                                                                                               " & vbNewLine _
                                             & "ON  MKY4.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "--AND MKY4.KYORI_CD = MC.BETU_KYORI_CD                                                                                           " & vbNewLine _
                                             & "AND MKY4.KYORI_CD = (CASE ISNULL(KBN11.KBN_NM2,'') WHEN '' THEN MC.BETU_KYORI_CD ELSE KBN11.KBN_NM2 END)                       " & vbNewLine _
                                             & "AND MKY4.ORIG_JIS_CD = MSO.JIS_CD                                                                                              " & vbNewLine _
                                             & "AND MKY4.DEST_JIS_CD = EDIL.DEST_JIS_CD                                                                                        " & vbNewLine _
                                             & "--届先商品M(出荷L参照)                                                                                                         " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_DESTGOODS MDGL                                                                                           " & vbNewLine _
                                             & "ON  MDGL.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "AND MDGL.CUST_CD_L = OUTL.CUST_CD_L                                                                                            " & vbNewLine _
                                             & "AND MDGL.CUST_CD_M = OUTL.CUST_CD_M                                                                                            " & vbNewLine _
                                             & "AND MDGL.CD = OUTL.DEST_CD                                                                                                     " & vbNewLine _
                                             & "AND MDGL.GOODS_CD_NRS = MG.GOODS_CD_NRS                                                                                        " & vbNewLine _
                                             & "AND MDGL.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--届先商品M(出荷EDI参照)                                                                                                       " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_DESTGOODS MDGE                                                                                           " & vbNewLine _
                                             & "ON  MDGE.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "AND MDGE.CUST_CD_L = OUTL.CUST_CD_L                                                                                            " & vbNewLine _
                                             & "AND MDGE.CUST_CD_M = OUTL.CUST_CD_M                                                                                            " & vbNewLine _
                                             & "AND MDGE.CD = EDIL.DEST_CD                                                                                                     " & vbNewLine _
                                             & "AND MDGE.GOODS_CD_NRS = MG.GOODS_CD_NRS                                                                                        " & vbNewLine _
                                             & "AND MDGE.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--消防M★                                                                                                      " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_SHOBO MSHOBO                                                                                           " & vbNewLine _
                                             & "ON  MSHOBO.SHOBO_CD = MG.SHOBO_CD                                                                                            " & vbNewLine _
                                             & "AND MSHOBO.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--区分M(納入予定区分)                                                                                                          " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN1                                                                                                 " & vbNewLine _
                                             & "ON  KBN1.KBN_GROUP_CD = 'N010'                                                                                                 " & vbNewLine _
                                             & "AND KBN1.KBN_CD = OUTL.ARR_PLAN_TIME                                                                                           " & vbNewLine _
                                             & "AND KBN1.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--区分M(日本合成用倉庫名)                                                                                                      " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN2                                                                                                 " & vbNewLine _
                                             & "ON  KBN2.KBN_GROUP_CD = 'P005'                                                                                                 " & vbNewLine _
                                             & "AND KBN2.KBN_CD = '00'                                                                                                         " & vbNewLine _
                                             & "AND KBN2.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--区分M(日本合成用部署名)                                                                                                      " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN3                                                                                                 " & vbNewLine _
                                             & "ON  KBN3.KBN_GROUP_CD = 'P005'                                                                                                 " & vbNewLine _
                                             & "AND KBN3.KBN_CD = '01'                                                                                                         " & vbNewLine _
                                             & "AND KBN3.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--区分M(日本合成用営業署名)                                                                                                    " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN4                                                                                                 " & vbNewLine _
                                             & "ON  KBN4.KBN_GROUP_CD = 'P005'                                                                                                 " & vbNewLine _
                                             & "AND KBN4.KBN_CD = '02'                                                                                                         " & vbNewLine _
                                             & "AND KBN4.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--区分M(荷姿)                                                                                                                  " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN5                                                                                                 " & vbNewLine _
                                             & "ON  KBN5.KBN_GROUP_CD = 'N001'                                                                                                 " & vbNewLine _
                                             & "AND KBN5.KBN_CD = MG.PKG_UT                                                                                                    " & vbNewLine _
                                             & "AND KBN5.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--明細タイトル（小分け）                                                                                                       " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN6                                                                                                 " & vbNewLine _
                                             & "ON  KBN6.KBN_GROUP_CD = 'S041'                                                                                                 " & vbNewLine _
                                             & "AND KBN6.KBN_CD = OUTM.ALCTD_KB                                                                                                " & vbNewLine _
                                             & "AND KBN6.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--区分M(毒劇区分名称)                                                                                                           " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN7                                                                                                  " & vbNewLine _
                                             & "ON  KBN7.KBN_GROUP_CD = 'G001'                                                                                                  " & vbNewLine _
                                             & "AND KBN7.KBN_CD = MG.DOKU_KB                                                                                                    " & vbNewLine _
                                             & "AND KBN7.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--【要望番号995】　2012/04/17　元着払い区分　START                                                                             " & vbNewLine _
                                             & "--区分M(元着払区分名称)                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN9                                                                                                 " & vbNewLine _
                                             & "ON  KBN9.KBN_GROUP_CD = 'M001'                                                                                                 " & vbNewLine _
                                             & "AND KBN9.KBN_CD = OUTL.PC_KB                                                                                                   " & vbNewLine _
                                             & "AND KBN9.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--【要望番号995】　2012/04/17　元着払い区分　 END                                                                              " & vbNewLine _
                                             & "--区分M(消防区分名称)★                                                                                                        " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..Z_KBN KBN10                                                                                                " & vbNewLine _
                                             & "ON  KBN10.KBN_GROUP_CD = 'S004'                                                                                                " & vbNewLine _
                                             & "AND KBN10.KBN_CD = MSHOBO.RUI                                                                                                  " & vbNewLine _
                                             & "AND KBN10.SYS_DEL_FLG = '0'                                                                                                    " & vbNewLine _
                                             & "--日医工対策開始                                                                                                               " & vbNewLine _
                                             & "--★出荷EDI M(日医工)                                                                                                          " & vbNewLine _
                                             & "LEFT JOIN $LM_TRN$..H_OUTKAEDI_M EDIM                                                                                            " & vbNewLine _
                                             & "ON  EDIM.NRS_BR_CD        = OUTM.NRS_BR_CD                                                                                     " & vbNewLine _
                                             & "AND EDIM.OUTKA_CTL_NO     = OUTM.OUTKA_NO_L                                                                                    " & vbNewLine _
                                             & "AND EDIM.OUTKA_CTL_NO_CHU = OUTM.OUTKA_NO_M                                                                                    " & vbNewLine _
                                             & "AND EDIM.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "--日医工_出荷指示EDIデータ                                                                                                     " & vbNewLine _
                                             & "--LEFT JOIN $LM_TRN$..H_OUTKAEDI_DTL_NIK EDIN                                                                                    " & vbNewLine _
                                             & "--ON   OUTL.NRS_BR_CD      = EDIN.NRS_BR_CD                                                                                      " & vbNewLine _
                                             & "--AND  EDIL.EDI_CTL_NO     = EDIN.EDI_CTL_NO                                                                                     " & vbNewLine _
                                             & "--AND  EDIM.EDI_CTL_NO_CHU = EDIN.EDI_CTL_NO_CHU                                                                                 " & vbNewLine _
                                             & "--AND  EDIN.SYS_DEL_FLG    = '0'                                                                                                 " & vbNewLine _
                                             & "                                                                                                                               " & vbNewLine _
                                             & "--荷主明細M ★                                                                                                                 " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST_DETAILS MCD_N                                                                                       " & vbNewLine _
                                             & "ON  MCD_N.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                           " & vbNewLine _
                                             & "AND MCD_N.CUST_CD   = OUTL.CUST_CD_L                                                                                           " & vbNewLine _
                                             & "AND MCD_N.SUB_KB = '26'                                                                                                        " & vbNewLine _
                                             & "--日医工対策終了                                                                                                               " & vbNewLine _
                                             & "--(2012.06.01) 日本ﾌｧｲﾝ対応  --- START ----                                                                                    " & vbNewLine _
                                             & "--荷主明細M                                                                                                                    " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST_DETAILS MCD_F                                                                                       " & vbNewLine _
                                             & "ON  MCD_F.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                           " & vbNewLine _
                                             & "AND MCD_F.CUST_CD   = OUTL.CUST_CD_L                                                                                           " & vbNewLine _
                                             & "AND MCD_F.SUB_KB = '29'                                                                                                        " & vbNewLine _
                                             & "--(2012.06.01) 日本ﾌｧｲﾝ対応  ---  END  ----                                                                                    " & vbNewLine _
                                             & "--荷主明細M ★                                                                                                                 " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST_DETAILS MCD                                                                                         " & vbNewLine _
                                             & "ON  MCD.NRS_BR_CD = MG.NRS_BR_CD                                                                                               " & vbNewLine _
                                             & "AND MCD.CUST_CD   = MG.CUST_CD_L                                                                                               " & vbNewLine _
                                             & "AND MCD.SUB_KB = '20'                                                                                                          " & vbNewLine _
                                             & "--(2012.11.21)要望番号1615 -- START --                                                                                         " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_GOODS_DETAILS MGD16                                                                                        " & vbNewLine _
                                             & "       ON MGD16.NRS_BR_CD = MG.NRS_BR_CD                                                                                       " & vbNewLine _
                                             & "      AND MGD16.GOODS_CD_NRS = MG.GOODS_CD_NRS                                                                                 " & vbNewLine _
                                             & "      AND MGD16.SUB_KB = '16'                                                                                                  " & vbNewLine _
                                             & "      AND MGD16.SYS_DEL_FLG = '0'                                                                                              " & vbNewLine _
                                             & "--(2012.11.21)要望番号1615 --  END  --                                                                                         " & vbNewLine _
                                             & "--出荷Lでの荷主帳票パターン取得                                                                                                " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST_RPT MCR1                                                                                            " & vbNewLine _
                                             & "ON  OUTL.NRS_BR_CD = MCR1.NRS_BR_CD                                                                                            " & vbNewLine _
                                             & "AND OUTL.CUST_CD_L = MCR1.CUST_CD_L                                                                                            " & vbNewLine _
                                             & "AND OUTL.CUST_CD_M = MCR1.CUST_CD_M                                                                                            " & vbNewLine _
                                             & "AND '00' = MCR1.CUST_CD_S                                                                                                      " & vbNewLine _
                                             & "AND MCR1.PTN_ID = '04'                                                                                                         " & vbNewLine _
                                             & "--帳票パターン取得                                                                                                             " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_RPT MR1                                                                                                  " & vbNewLine _
                                             & "ON  MR1.NRS_BR_CD = MCR1.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "AND MR1.PTN_ID = MCR1.PTN_ID                                                                                                   " & vbNewLine _
                                             & "AND MR1.PTN_CD = MCR1.PTN_CD                                                                                                   " & vbNewLine _
                                             & "AND MR1.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--商品Mの荷主での荷主帳票パターン取得                                                                                          " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_CUST_RPT MCR2                                                                                            " & vbNewLine _
                                             & "ON  MG.NRS_BR_CD = MCR2.NRS_BR_CD                                                                                              " & vbNewLine _
                                             & "AND MG.CUST_CD_L = MCR2.CUST_CD_L                                                                                              " & vbNewLine _
                                             & "AND MG.CUST_CD_M = MCR2.CUST_CD_M                                                                                              " & vbNewLine _
                                             & "AND MG.CUST_CD_S = MCR2.CUST_CD_S                                                                                              " & vbNewLine _
                                             & "AND MCR2.PTN_ID = '04'                                                                                                         " & vbNewLine _
                                             & "--帳票パターン取得                                                                                                             " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_RPT MR2                                                                                                  " & vbNewLine _
                                             & "ON  MR2.NRS_BR_CD = MCR2.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "AND MR2.PTN_ID = MCR2.PTN_ID                                                                                                   " & vbNewLine _
                                             & "AND MR2.PTN_CD = MCR2.PTN_CD                                                                                                   " & vbNewLine _
                                             & "AND MR2.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--存在しない場合の帳票パターン取得                                                                                             " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_RPT MR3                                                                                                  " & vbNewLine _
                                             & "ON  MR3.NRS_BR_CD = OUTL.NRS_BR_CD                                                                                             " & vbNewLine _
                                             & "AND MR3.PTN_ID = '04'                                                                                                          " & vbNewLine _
                                             & "AND MR3.STANDARD_FLAG = '01'                                                                                                   " & vbNewLine _
                                             & "AND MR3.SYS_DEL_FLG = '0'                                                                                                      " & vbNewLine _
                                             & "--ユーザM                                                                                                                      " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..S_USER MUSER                                                                                               " & vbNewLine _
                                             & "ON MUSER.USER_CD = OUTL.SYS_ENT_USER                                                                                           " & vbNewLine _
                                             & "AND MUSER.SYS_DEL_FLG = '0'                                                                                                    " & vbNewLine _
                                             & "--商品明細M                                                                                                                    " & vbNewLine _
                                             & "LEFT JOIN $LM_MST$..M_GOODS_DETAILS MGD                                                                                        " & vbNewLine _
                                             & "ON  MGD.NRS_BR_CD = MG.NRS_BR_CD                                                                                               " & vbNewLine _
                                             & "AND MGD.GOODS_CD_NRS = MG.GOODS_CD_NRS                                                                                         " & vbNewLine _
                                             & "AND MGD.SUB_KB = '09'                                                                                                          " & vbNewLine _
                                             & "AND MGD.SYS_DEL_FLG = '0'       --ADD 2019/02/07 依頼番号 : 004605   【LMS】納品書がの梱包個数が2倍になるバグ修正              " & vbNewLine _
                                             & "WHERE                                                                                                                          " & vbNewLine _
                                             & "    OUTL.SYS_DEL_FLG = '0'                                                                                                     " & vbNewLine _
                                             & "AND OUTL.NRS_BR_CD = @NRS_BR_CD                                                                                                " & vbNewLine _
                                             & "AND OUTL.OUTKA_NO_L = @KANRI_NO_L                                                                                              " & vbNewLine

#End Region

#End Region

End Class

